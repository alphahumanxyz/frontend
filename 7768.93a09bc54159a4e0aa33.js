"use strict";(self.webpackChunkalphahuman_telegram=self.webpackChunkalphahuman_telegram||[]).push([[7768],{25404(e,t,a){a.d(t,{A:()=>p});var s=a(84051),o=a(13439),n=a(31481),i=a(85982),r=a(17663),d=a(80140),c=a(39351),l=a(17712),u=a(59030),h=a(24433),m=a(20021);const p=(0,s.ph)(({peerId:e,canManage:t,gift:a,currentUserEmojiStatus:p,collectibleEmojiStatuses:g})=>{const{showNotification:f,openChatWithDraft:I,openGiftTransferModal:v,openGiftResalePriceComposerModal:b,openGiftStatusInfoModal:S,setEmojiStatus:y,toggleSavedGiftPinned:w,changeGiftVisibility:A,updateStarGiftPrice:M,closeGiftInfoModal:C}=(0,o.ko)(),P=(0,c.A)(),k=(0,u.A)(),T=a&&"gift"in a,F=T?a:void 0,B=T?a.gift:a,U="starGiftUnique"===B?.type?B.slug:void 0,x=(0,s.Kr)(()=>{if(U)return`${n.jsp}nft/${U}`},[U]),N=(0,s.Kr)(()=>{if(U)return g?.find(e=>"collectible"===e.type&&e.slug===U)},[U,g]),R="collectible"===p?.type?p.slug:void 0,J=B&&"starGiftUnique"===B.type,Y=J&&R===B.slug,E=N&&!Y,D=J?B.resellPrice:void 0,O=t&&F&&!F.isUnsaved&&J,L=(0,l.A)(()=>{const{inputGift:e,isUnsaved:t}=F;A({gift:e,shouldUnsave:!t})}),G=(0,l.A)(()=>{x&&((0,i.eM)(x),f({message:P("LinkCopied")}))}),V=(0,l.A)(()=>{x&&I({text:{text:x}})}),j=(0,l.A)(()=>{F&&"starGiftUnique"===F?.gift.type&&(F.canTransferAt&&F.canTransferAt>(0,d.Fm)()?f({message:{key:"NotificationGiftCanTransferAt",variables:{date:(0,r.U)(k,1e3*F.canTransferAt)}}}):v({gift:F}))}),q=(0,l.A)(()=>{F&&(F.canResellAt&&F.canResellAt>(0,d.Fm)()?f({message:{key:"NotificationGiftCanResellAt",variables:{date:(0,r.U)(k,1e3*F.canResellAt)}}}):b({peerId:e,gift:F}))}),z=(0,l.A)(()=>{F&&"starGiftUnique"===F.gift.type&&F.inputGift&&(C(),M({gift:F.inputGift,price:{currency:n.OUy,amount:0,nanos:0}}),f({icon:"unlist-outline",message:{key:"NotificationGiftIsUnlist",variables:{gift:P("GiftUnique",{title:F.gift.title,number:F.gift.number})}}}))}),H=(0,l.A)(()=>{"starGiftUnique"===B?.type&&N&&S({emojiStatus:N})}),K=(0,l.A)(()=>{Y&&y({emojiStatus:{type:"regular",documentId:n.zNY}})}),W=(0,l.A)(()=>{w({peerId:e,gift:F})});return(0,m.FD)(m.FK,{children:[O&&(0,m.Y)(h.A,{icon:F.isPinned?"unpin":"pin",onClick:W,children:P(F.isPinned?"ChatListUnpinFromTop":"ChatListPinToTop")}),(0,m.Y)(h.A,{icon:"link-badge",onClick:G,children:P("CopyLink")}),(0,m.Y)(h.A,{icon:"forward",onClick:V,children:P("Share")}),t&&J&&(0,m.Y)(h.A,{icon:"diamond",onClick:j,children:P("GiftInfoTransfer")}),t&&J&&!D&&(0,m.Y)(h.A,{icon:"sell-outline",onClick:q,children:P("Sell")}),t&&J&&Boolean(D)&&(0,m.Y)(h.A,{icon:"unlist-outline",onClick:z,children:P("GiftInfoUnlist")}),t&&F&&(0,m.Y)(h.A,{icon:F.isUnsaved?"eye-outline":"eye-crossed-outline",onClick:L,children:P(F.isUnsaved?"GiftActionShow":"GiftActionHide")}),E&&(0,m.Y)(h.A,{icon:"crown-wear-outline",onClick:H,children:P("GiftInfoWear")}),Y&&(0,m.Y)(h.A,{icon:"crown-take-off-outline",onClick:K,children:P("GiftInfoTakeOff")})]})})},78010(e,t,a){a.r(t),a.d(t,{LockScreen:()=>Od,Main:()=>Yd});var s=a(31481),o=(a(48544),a(42347)),n=a(23174),i=a(89925),r=a(24585),d=a(96454),c=a(85982),l=a(46275),u=a(14487),h=a(87894),m=a(60343),p=a(43044),g=a(48775),f=a(6e4),I=a(37836),v=a(80140),b=a(24021),S=a(90709),y=a(70636),w=a(13439),A=a(68873),M=a(32989),C=a(91048),P=a(22986),k=a(9716),T=a(5560),F=a(26129),B=a(43503),U=a(76023);const x=32*U.$,N=45.5*U.$,R=26.5*U.$,J=16*U.$,Y=16.125*U.$;var E=a(16350),D=a(82150),O=a(43874);function L(e,t){return t-((0,C.nTw)(e).isLeftColumnShown&&!(0,O.Ny)()?e.leftColumnWidth||((a=B.A.get().width)>s.gQx?Math.min(Math.max(.25*a,J),.33*a):a>s.j7z?Math.min(Math.max(.33*a,J),.4*a):R):0);var a}function G(e,t,a){const s=(0,C.nZ4)(e,t.chatId),o=t.reactions||{results:[],areTags:s},n=(0,C.VF$)(e,t.chatId),i=(0,S.AK)(o.results,a);let{recentReactions:r=[]}=o;return r.length&&(r=r.filter(({isOwn:t,peerId:a})=>!t&&a!==e.currentUserId)),a.forEach(t=>{const{currentUserId:a}=e;"paid"!==t.type&&r.unshift({peerId:n?.id||a,reaction:t,addedDate:Math.floor(Date.now()/1e3),isOwn:!0})}),(0,D.r3)(e,t.chatId,t.id,{reactions:{...o,results:i,recentReactions:r}})}function V(e,t,a){return(0,E.wi)(e,t,a,!0)}const j=350,q=1e3;let z=0;function H(e,t,a,s,o,n,i,r){const d=r?.reactions;if(d&&(0,P.T)(o,d))return e;const c=d?.results.find(e=>e.localAmount);if(c?.localAmount){const{localIsPrivate:e,localAmount:t,localPeerId:a}=c;o.results=(0,S.Ny)(o.results,t,e,a)}if(e=(0,A.r3y)(e,a,s,{reactions:o}),!i)return e;const{reaction:l,isOwn:h,isUnread:p}=o.recentReactions?.[0]??{};if((0,C.xYJ)(e,"reactionEffects")&&r&&l&&p&&!h){const e=(0,m.bj)(r);t.startActiveReaction({containerId:e,reaction:l,tabId:(0,u.g0)()})}const g=n.unreadReactions?.includes(s),f=(0,S.pU)(e,o);if(f&&!g){e=V(e,a,{unreadReactionsCount:(n?.unreadReactionsCount||0)+1,unreadReactions:[...n?.unreadReactions||[],s].sort((e,t)=>t-e)});const t=(0,C.O5q)(e,a,s);if(!n||!t)return e;(0,I.aj)(()=>{(0,T.Oq)({chat:n,message:t,isReaction:!0})})}return!f&&g&&(e=V(e,a,{unreadReactionsCount:(n?.unreadReactionsCount||1)-1,unreadReactions:n?.unreadReactions?.filter(e=>e!==s)})),e}function K(e,t,a,s,o,n=!1){const i=n?(0,C.Jl6)(e,t,a):(0,C.O5q)(e,t,a);if(!i&&!s)return e;if(i&&o.content&&!(0,m.iL)(a)){const{photo:e,video:t,sticker:a,document:s}=(0,S.r_)(i);e&&o.content.photo?(o.content.photo.blobUrl??=e.blobUrl,o.content.photo.thumbnail??=e.thumbnail):t&&o.content.video?o.content.video.blobUrl??=t.blobUrl:a&&o.content.sticker?o.content.sticker.isPreloadedGlobally??=a.isPreloadedGlobally:s&&o.content.document&&(o.content.document.previewBlobUrl??=s.previewBlobUrl)}const r=i?{...i,...o}:o;return n?(0,A.Egm)(e,t,a,r):(0,A.r3y)(e,t,a,r)}function W(e,t,a,s){const{chatId:o}=a,n=(0,F.Q)(a),{threadInfo:i}=(0,C.Tac)(e,a)||{};if(!i&&n?.replyToMsgId){const i=(0,C.O5q)(e,o,n.replyToMsgId);i?e=(0,A.Wwn)(e,i,o,a.id,s):t.loadMessage({chatId:o,messageId:n.replyToMsgId,threadUpdate:{isDeleting:s,lastMessageId:a.id}})}return e}function _(e,t,a){const{id:s,chatId:o}=a,i=(0,C.QP5)(e,a),{threadInfo:r}=(0,C.Tac)(e,a)||{},d=(0,C.hds)(e,o),c=d?.unreadCount&&!(0,C.gCU)(e,o,n.l3);e=W(e,t,a);const{threadId:l}=r??{threadId:i};return l&&(e=(0,A.d4w)(e,o,l,[s]),Object.values(e.byTabId).forEach(({id:t})=>{if((0,C.haw)(e,o,l,t)){const a=(0,C.RjD)(e,o,l),n=(0,A.fgD)(e,o,l,s,t),i=(0,C.rA3)(n,o,l,t);a&&!i.includes(a)||(e=n)}}),r&&(e=(0,A.eww)(e,o,l,"threadInfo",{...r,lastMessageId:a.id}),(0,S.Nb)(a)||(0,S._P)(a)||(e=(0,A.eAk)(e,o,l,{messagesCount:(r.messagesCount||0)+1})))),c||(e=(0,A.d4w)(e,o,n.l3,[s]),Object.values(e.byTabId).forEach(({id:t})=>{if((0,C.haw)(e,o,n.l3,t)){const a=(0,C.RjD)(e,o,n.l3),i=(0,A.fgD)(e,o,n.l3,s,t),r=(0,C.rA3)(i,o,n.l3,t);a&&!r.includes(a)||(e=i)}})),e}function X(e,t,a,s=!1){const{chats:o}=e,n=o.byId[t],i=(0,C.ZZX)(e,t),r=n?.isForum?(0,C.nkm)(e,a):void 0;r&&(e=(0,A.TwA)(e,t,r.id,{lastMessageId:a.id}));const d=(0,C.L_2)(e,a);e=(0,A.eAk)(e,t,d,{lastMessageId:a.id});const c=(0,C.QP5)(e,a);return c&&(e=(0,A.yKC)(e,c,a.id,"saved")),!i||s||i===a.id||i===a.previousLocalId||a.id>i?(0,A.yKC)(e,t,a.id):e}function $(e,t,a=n.l3){const s=(0,C.zeq)(e,t),o=(0,C.gCU)(e,t,a);if(!s||!o)return;let i=o.length;for(;i--;){const e=s[o[i]];if(e&&!e.isDeleting)return e}}function Q(e,t,a,s){if(t){const o=(0,C.hds)(e,t);if(!o)return;const i=new Set;i.add(n.l3),a.forEach(a=>{e=(0,A.r3y)(e,t,a,{isDeleting:!0}),(0,C.S0q)(e,t,a)&&(e=(0,A.do9)(e,t,a));const o=(0,C.O5q)(e,t,a);if(!o)return;"chatEditPhoto"===o.content.action?.type&&o.content.action.photo&&(e=(0,A.sol)(e,t,o.content.action.photo.id,!0)),e=W(e,s,o,!0);const n=(0,C.L_2)(e,o);n&&i.add(n)}),s.requestChatUpdate({chatId:t});const r=new Set(a);i.forEach(a=>{const i=(0,C.Vw0)(e,t,a);if(!i?.lastMessageId||!r.has(i.lastMessageId))return;const d=$(e,t,a);d?(a===n.l3&&(e=X(e,t,d,!0)),e=(0,A.eAk)(e,t,a,{lastMessageId:d.id}),o.isForum&&(e=(0,A.TwA)(e,t,Number(a),{lastMessageId:d.id}))):o.isForum&&a!==n.l3&&s.loadTopicById({chatId:t,topicId:Number(a)})}),(0,w.UF)(e);const d=(0,C.Rwe)(e);return void setTimeout(()=>{e=(0,w.mS)();const s=a.filter(a=>(0,C.O5q)(e,t,a)?.isDeleting);e=(0,A.AH0)(e,t,s),(0,w.UF)(e)},d?q:j)}const o=[];a.forEach(t=>{const a=(0,C.Egn)(e,t);if(a){o.push(a);const n=$(e=(0,A.r3y)(e,a,t,{isDeleting:!0}),a);n&&(e=X(e,a,n,!0));const i=(0,C.O5q)(e,a,t);if((0,C.nZ4)(e,a)&&i){const t=(0,C.L_2)(e,i);if((0,S.cG)(a,t,e.currentUserId)){const o=$(e,a,t);s.requestSavedDialogUpdate({chatId:String(t)}),o&&(e=(0,A.yKC)(e,a,o.id,"saved"))}}"chatEditPhoto"===i?.content.action?.type&&i.content.action.photo&&(e=(0,A.sol)(e,a,i.content.action.photo.id,!0));const r=(0,C.Rwe)(e);setTimeout(()=>{e=(0,w.mS)(),e=(0,A.AH0)(e,a,[t]),(0,w.UF)(e)},r?q:j)}}),(0,w.UF)(e),(0,h.Am)(o).forEach(e=>{s.requestChatUpdate({chatId:e})})}(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"newMessage":{const{chatId:s,id:o,message:n,shouldForceReply:i,wasDrafted:r,poll:d,webPage:c}=a;e=_(e=K(e,s,o,!0,n),t,n);const l=(0,C.O5q)(e,s,o),u=(0,F.Q)(l),h=(0,F.W)(l),m=(0,C.hds)(e,s);m?.isForum&&u?.isForumTopic&&!(0,C.nkm)(e,l)&&u.replyToMsgId&&t.loadTopicById({chatId:s,topicId:u.replyToMsgId});const p=(0,S.Nb)(n);if(Object.values(e.byTabId).forEach(({id:a})=>{p&&r&&(e=X(e,s,l));const d=(0,C.L_2)(e,l);if(e=(0,A.PKO)(e,l,s,d,a),(0,C.fo$)(e,s,n,a)){if(p&&n.isOutgoing&&!n.content?.action&&!h?.storyId&&!n.content?.storyData){const o=(0,C.Xf0)(e,a);o&&t.focusMessage({chatId:s,threadId:o.threadId,messageId:n.id,noHighlight:!0,isResizingContainer:!0,tabId:a})}p||setTimeout(()=>{e=(0,w.mS)(),i&&t.updateDraftReplyInfo({replyToMsgId:o,tabId:a}),e=X(e,s,l),(0,w.UF)(e)},j)}else e=X(e,s,l)}),d&&(e=(0,A.J81)(e,d.id,d)),c&&(e=(0,A.o7c)(e,c.id,c)),n.reportDeliveryUntilDate&&n.reportDeliveryUntilDate>(0,v.Fm)()&&t.reportMessageDelivery({chatId:s,messageId:o}),m?.isBotForum&&!l.isOutgoing&&!p){const t=(0,C.L_2)(e,l),a=(0,C.C5H)(e,s,t,"typingDraftIdByRandomId"),o=Object.values(a||{});e=(0,A.AH0)(e,s,o),e=(0,A.eww)(e,s,t,"typingDraftIdByRandomId",void 0)}if((0,w.UF)(e),p||m?.isNotJoined||(0,C.mJZ)(e,s)||t.loadTopChats(),!p&&(0,C.nZ4)(e,s)){const a=(0,C.QP5)(e,l);a&&!(0,C.mJZ)(e,a,"saved")&&t.requestSavedDialogUpdate({chatId:a})}break}case"updateChatLastMessage":{const{id:t,lastMessage:s}=a;e=X(e,t,s,!0),e=(0,A.KcS)(e,[s]),(0,w.UF)(e);break}case"updateStartEmojiInteraction":Object.values(e.byTabId).forEach(({id:t})=>{const{chatId:s}=(0,C.Xf0)(e,t)||{};if(s!==a.id)return;const o=(0,C.O5q)(e,s,a.messageId);if(!o)return;if((0,S.P5)(o)?.text!==a.emoji)return;const n=(0,C.nTw)(e,t);e=(0,M.w)(e,{activeEmojiInteractions:[...n.activeEmojiInteractions||[],{id:Math.random(),animatedEffect:a.emoji,messageId:a.messageId}]},t)}),(0,w.UF)(e);break;case"newScheduledMessage":{const{chatId:t,id:s,message:o,poll:i,webPage:r}=a;e=K(e,t,s,!0,o,!0);const d=(0,C.K3w)(e,t,n.l3)||[];e=(0,A.eww)(e,t,n.l3,"scheduledIds",(0,h.Am)([...d,s]));const c=(0,C.L_2)(e,o);if(c!==n.l3){const a=(0,C.K3w)(e,t,c)||[];e=(0,A.eww)(e,t,c,"scheduledIds",(0,h.Am)([...a,s]))}i&&(e=(0,A.J81)(e,i.id,i)),r&&(e=(0,A.o7c)(e,r.id,r)),e=(0,A.zTz)(e,t,{hasScheduledMessages:!0}),(0,w.UF)(e);break}case"updateScheduledMessage":{const{chatId:s,id:o,message:i,poll:r,webPage:d,isFromNew:c}=a,l=(0,C.Jl6)(e,s,o);if(!l)return void(c&&t.apiUpdate({"@type":"newScheduledMessage",id:a.id,chatId:a.chatId,message:a.message,poll:a.poll,webPage:a.webPage}));e=K(e,s,o,!1,i,!0);const u=Object.keys((0,C.yFI)(e,s)||{}).map(Number).sort((e,t)=>t-e);e=(0,A.eww)(e,s,n.l3,"scheduledIds",u);const h=(0,C.L_2)(e,l);if(h!==n.l3){const t=(0,C.K3w)(e,s,h)||[];e=(0,A.eww)(e,s,h,"scheduledIds",t.sort((e,t)=>t-e))}r&&(e=(0,A.J81)(e,r.id,r)),d&&(e=(0,A.o7c)(e,d.id,d)),(0,w.UF)(e);break}case"updateMessage":{const{chatId:s,id:o,message:n,poll:i,webPage:r,isFromNew:d,shouldForceReply:c}=a,l=(0,C.O5q)(e,s,o);if(!l)return void(d&&t.apiUpdate({"@type":"newMessage",id:a.id,chatId:a.chatId,message:a.message,poll:a.poll,webPage:a.webPage,shouldForceReply:c}));const u=(0,C.hds)(e,s);e=K(e,s,o,!1,n);const h=(0,C.O5q)(e,s,o);n.reactions&&u&&(e=H(e,t,s,o,n.reactions,u,h.isOutgoing,l)),n.content?.text?.text!==l?.content?.text?.text&&(e=(0,A.gt4)(e,s,o)),i&&(e=(0,A.J81)(e,i.id,i)),r&&(e=(0,A.o7c)(e,r.id,r)),(0,w.UF)(e);break}case"updateQuickReplyMessage":{const{id:t,message:s,poll:o,webPage:n}=a;e=(0,A.QNR)(e,t,s),o&&(e=(0,A.J81)(e,o.id,o)),n&&(e=(0,A.o7c)(e,n.id,n)),(0,w.UF)(e);break}case"deleteQuickReplyMessages":{const{messageIds:t}=a;e=(0,A.vad)(e,t),(0,w.UF)(e);break}case"updateQuickReplies":{const{quickReplies:t}=a,s=(0,h.dU)(t,"id");e=(0,A.xAV)(e,s),(0,w.UF)(e);break}case"deleteQuickReply":e=(0,A.hjk)(e,a.quickReplyId),(0,w.UF)(e);break;case"updateVideoProcessingPending":{const{chatId:s,localId:o,newScheduledMessageId:n}=a;e=(0,A.AH0)(e,s,[o]),e=(0,A.zTz)(e,s,{hasScheduledMessages:!0}),(0,w.UF)(e),Object.values(e.byTabId).forEach(({id:a})=>{const o=(0,C.Xf0)(e,a);if(o?.chatId!==s)return;const i=Date.now();i-z<1e3||(z=i,t.showNotification({message:{key:"VideoConversionText"},title:{key:"VideoConversionTitle"},tabId:a}),t.focusMessage({chatId:s,messageId:n,messageListType:"scheduled",tabId:a}))});break}case"updateMessageSendSucceeded":{const{chatId:s,localId:o,message:i,poll:r}=a;e=_(e,t,i);const d=(0,C.O5q)(e,s,o);e=(0,A.AH0)(e,s,[o]),i.isScheduled&&(e=(0,A.XAm)(e,s,[o])),e=(0,A.r3y)(e,s,i.id,{...d,...i,previousLocalId:o,isDeleting:void 0}),r&&(e=(0,A.J81)(e,r.id,r)),e={...e,fileUploads:{byMessageKey:(0,h.cJ)(e.fileUploads.byMessageKey,[(0,m.bj)(i)])}};const c=(0,C.O5q)(e,s,i.id);e=X(e,s,c);const l=(0,C.Tac)(e,i);Object.values(e.byTabId).forEach(({id:a})=>{const{chatId:o,threadId:r}=(0,C.Xf0)(e,a)||{};o===s&&(l?.threadInfo?.threadId||n.l3)===r&&t.markMessageListRead({maxId:i.id,tabId:a})}),l?.threadInfo?.threadId&&(e=(0,A.eww)(e,s,l.threadInfo.threadId,"threadInfo",{...l.threadInfo,lastMessageId:i.id,lastReadInboxMessageId:i.id})),e=(0,A.wix)(e,s,{lastReadInboxMessageId:i.id});const u=(0,C.hds)(e,s);if(u?.isNotJoined||(0,C.mJZ)(e,s)||t.loadTopChats(),(0,C.nZ4)(e,s)){const a=(0,C.QP5)(e,c);a&&!(0,C.mJZ)(e,a,"saved")&&t.requestSavedDialogUpdate({chatId:a})}(0,w.UF)(e);break}case"updateScheduledMessageSendSucceeded":{const{chatId:t,localId:s,message:o,poll:i}=a,r=(0,C.K3w)(e,t,n.l3)||[];e=(0,A.eww)(e,t,n.l3,"scheduledIds",[...r,o.id]);const d=(0,C.L_2)(e,o);if(d!==n.l3){const a=(0,C.K3w)(e,t,d)||[];e=(0,A.eww)(e,t,d,"scheduledIds",[...a,o.id])}const c=(0,C.Jl6)(e,t,s);e=(0,A.XAm)(e,t,[s]),e=(0,A.Egm)(e,t,o.id,{...c,...o,previousLocalId:s,isDeleting:void 0}),i&&(e=(0,A.J81)(e,i.id,i)),(0,w.UF)(e);break}case"updatePinnedIds":{const{chatId:t,isPinned:s,messageIds:o}=a,i=(0,h._E)((0,C.zeq)(e,t),o),r={[n.l3]:o};Object.values(i).forEach(a=>{const o=(0,C.L_2)(e,a);if(e=(0,A.r3y)(e,t,a.id,{isPinned:s}),o===n.l3)return;const i=r[o]||[];i.push(a.id),r[o]=i}),Object.entries(r).forEach(([a,o])=>{const i=(0,C.fcC)(e,t,n.l3)||[],r=s?(0,h.Am)(i.concat(o)).sort((e,t)=>t-e):i.filter(e=>!o.includes(e));e=(0,A.eww)(e,t,Number(a),"pinnedIds",r)}),(0,w.UF)(e);break}case"updateThreadInfo":{const{threadInfo:s}=a;e=(0,A.Ng8)(e,[s]),(0,w.UF)(e),e=(0,w.mS)();const{chatId:o,threadId:n}=s;if(!o||!n)return;const i=(0,C.hds)(e,o),r=(0,C.Vw0)(e,o,n),d=(0,C.S0q)(e,o,n);if(i?.isForum&&(d&&d.lastMessageId===r?.lastReadInboxMessageId?e=(0,A.TwA)(e,o,Number(n),{unreadCount:0}):t.loadTopicById({chatId:o,topicId:Number(n)})),!i?.isForum){const t=i?.lastReadInboxMessageId,a=s.lastReadInboxMessageId||t;t&&a&&(e=(0,A.eAk)(e,o,n,{lastReadInboxMessageId:Math.max(a,t)}))}(0,w.UF)(e);break}case"resetMessages":{const{id:s}=a,o=(0,C.zeq)(e,s);if(o&&!(0,k.L8)(s)){const a=(0,u.g0)();e=(0,A.AH0)(e,s,Object.keys(o).map(Number)),(0,w.UF)(e),t.loadFullChat({chatId:s,force:!0}),t.loadViewportMessages({chatId:s,threadId:n.l3,tabId:a})}break}case"deleteMessages":{const{ids:s,chatId:o}=a;Q(e,o,s,t);break}case"deleteScheduledMessages":{const{ids:s,newIds:o,chatId:i}=a,r=s?.some(t=>(0,C.Jl6)(e,i,t)?.isVideoProcessingPending),d=o?.find(t=>{const a=(0,C.O5q)(e,i,t);return a?.content.video});r&&d&&Object.values(e.byTabId).forEach(({id:e})=>{t.showNotification({message:{key:"VideoConversionDone"},actionText:{key:"VideoConversionView"},action:{action:"focusMessage",payload:{chatId:i,messageId:d,tabId:e}},tabId:e})}),function(e,t,a,s){t.forEach(t=>{s=(0,A.Egm)(s,e,t,{isDeleting:!0})}),(0,w.UF)(s);const o=(0,C.Rwe)(s);setTimeout(()=>{s=(0,w.mS)(),s=(0,A.XAm)(s,e,t);const a=(0,C.yFI)(s,e);s=(0,A.eww)(s,e,n.l3,"scheduledIds",Object.keys(a||{}).map(Number)),(0,w.UF)(s)},o?q:j)}(i,s,0,e);break}case"deleteHistory":{const{chatId:o}=a,n=e.messages.byChatId[o];if(o===s.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>({...e,isDeleted:!0}))},(0,w.UF)(e)),n){const a=Object.keys(n.byId).map(Number);Q(e=(0,w.mS)(),o,a,t)}else t.requestChatUpdate({chatId:o});e=(0,w.mS)(),e=(0,A.SJu)(e,o),(0,w.UF)(e);break}case"deleteSavedHistory":{const{chatId:s}=a,o=e.currentUserId;e=(0,A.SJu)(e,s,"saved"),(0,w.UF)(e),function(e,t,a,s){const o=(0,C.zeq)(e,t);if(!o)return;const n=Object.values(o).filter(t=>(0,C.L_2)(e,t)===a).map(e=>e.id);n.length&&Q(e,t,n,s)}(e=(0,w.mS)(),o,s,t);break}case"deleteParticipantHistory":{const{chatId:s,peerId:o}=a;!function(e,t,a,s){const o=(0,C.zeq)(e,t),n=Object.values(o).filter(e=>e.senderId===a).map(e=>e.id);n.length&&Q(e,t,n,s)}(e=(0,w.mS)(),s,o,t);break}case"updateCommonBoxMessages":{const{ids:t,messageUpdate:s}=a;t.forEach(t=>{const a=(0,C.Egn)(e,t);a&&(e=(0,A.r3y)(e,a,t,s))}),(0,w.UF)(e);break}case"updateChannelMessages":{const{channelId:t,ids:s,messageUpdate:o}=a;s.forEach(a=>{e=(0,A.r3y)(e,t,a,o)}),(0,w.UF)(e);break}case"updateMessagePoll":{const{pollId:t,pollUpdate:s}=a;e=(0,A.J81)(e,t,s),(0,w.UF)(e);break}case"updateMessagePollVote":{const{pollId:t,peerId:s,options:o}=a;e=(0,A.DLl)(e,t,s,o),(0,w.UF)(e);break}case"updateServiceNotification":{const{message:s}=a;(0,C.dqr)(e)&&t.createServiceNotification({message:s});break}case"updateMessageReactions":{const{chatId:s,id:o,reactions:n}=a,i=(0,C.O5q)(e,s,o),r=(0,C.hds)(e,a.chatId);if(!r||!i)return;e=H(e,t,s,o,n,r,i.isOutgoing,i),(0,w.UF)(e);break}case"updateMessageExtendedMedia":{const{chatId:t,id:s,extendedMedia:o,isBought:n}=a,i=(0,C.O5q)(e,t,s);if(!(0,C.hds)(e,a.chatId)||!i)return;if(i.content.invoice){const a=o[0];if("mediaType"in a&&"extendedMediaPreview"===a.mediaType){if(!i.content.invoice)return;e=(0,A.r3y)(e,t,s,{content:{...i.content,invoice:{...i.content.invoice,extendedMedia:a}}}),(0,w.UF)(e)}else{const o=a;e=(0,A.r3y)(e,t,s,{content:{...o}}),(0,w.UF)(e)}}if(i.content.paidMedia){const a=n?{isBought:n,extendedMedia:o}:{extendedMedia:o,isBought:void 0};e=(0,A.r3y)(e,t,s,{content:{...i.content,paidMedia:{...i.content.paidMedia,...a}}}),(0,w.UF)(e)}break}case"updateTranscribedAudio":{const{transcriptionId:t,text:s,isPending:o}=a;e={...e,transcriptions:{...e.transcriptions,[t]:{...e.transcriptions[t]||{},transcriptionId:t,text:s,isPending:o}}},(0,w.UF)(e);break}case"updateMessageSendFailed":{const{chatId:s,localId:o,error:n}=a;n.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach(({id:e})=>{t.showAllowedMessageTypesNotification({chatId:s,tabId:e})}),e=(0,A.r3y)(e,s,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateScheduledMessageSendFailed":{const{chatId:s,localId:o,error:n}=a;n.match(/CHAT_SEND_.+?FORBIDDEN/)&&Object.values(e.byTabId).forEach(({id:e})=>{t.showAllowedMessageTypesNotification({chatId:s,tabId:e})}),e=(0,A.Egm)(e,s,o,{sendingState:"messageSendingStateFailed"}),(0,w.UF)(e);break}case"updateMessageTranslations":{const{chatId:t,messageIds:s,toLanguageCode:o,translations:n}=a;e=(0,A.rmT)(e,t,s,o,n),(0,w.UF)(e);break}case"failedMessageTranslations":{const{chatId:t,messageIds:s,toLanguageCode:o}=a;e=(0,A.rmT)(e,t,s,o,[]),(0,w.UF)(e);break}case"updateChatTypingDraft":{const{id:s,chatId:o,threadId:i=n.l3,text:r}=a;if(!(0,C.$jd)(e,o,i))return;let d=(0,C.C5H)(e,o,i,"typingDraftIdByRandomId");const c=d?.[s],l=Boolean(c),u=l?(0,C.O5q)(e,o,c):void 0,m=()=>{setTimeout(()=>{e=(0,w.mS)();const t=(0,C.C5H)(e,o,i,"typingDraftIdByRandomId");if(t?.[s]){const a=t[s],n=(0,C.O5q)(e,o,a);if(!n||(0,v.Fm)()-n.editDate<e.appConfig.typingDraftTtl)return;const r=(0,h.cJ)(t,[s]);e=(0,A.eww)(e,o,i,"typingDraftIdByRandomId",r),e=(0,A.AH0)(e,o,[a]),(0,w.UF)(e)}},1e3*e.appConfig.typingDraftTtl)};if(l&&u)return e=(0,A.r3y)(e,o,c,{content:{text:r},editDate:(0,v.Fm)()}),m(),e;(0,b.px)("incrementLocalMessagesCounter");const p=(0,C.ZZX)(e,o),g=(0,S.Yh)({lastMessageId:p||0,chatId:o,threadId:i,text:r});return t.apiUpdate({"@type":"newMessage",chatId:o,id:g.id,message:g}),d={...d,[s]:g.id},e=(0,A.eww)(e,o,i,"typingDraftIdByRandomId",d),m(),e}}});const Z=new Map,ee=(0,I.sg)(e=>e(),500,!1);async function te({global:e,chatId:t,threadId:a,draft:s,isLocalOnly:o,noLocalTimeUpdate:n}){const i=(0,C.hds)(e,t),r=(0,C.mBe)(e,t);if(!i||r&&(0,S.PL)(r))return;const d=(0,C.OEv)(e,t,a,s?.replyInfo),c=s?{...s,replyInfo:d,date:Math.floor(Date.now()/1e3),isLocal:!0}:void 0;e=(0,A.eww)(e,t,a,"draft",c),n||(e=(0,A.wix)(e,t,{draftDate:c?.date})),(0,w.UF)(e),o||(await(0,b.px)("saveDraft",{chat:i,draft:c})&&c&&(c.isLocal=!1),e=(0,w.mS)(),e=(0,A.eww)(e,t,a,"draft",c),e=(0,A.wix)(e,t,{draftDate:c?.date}),(0,w.UF)(e))}async function ae(e,t,a){const{fromChatId:s,messageIds:o,toChatId:i,withMyScore:r,noAuthors:d,noCaptions:c,toThreadId:l=n.l3}=(0,C.nTw)(e,a).forwardMessages,{messagePriceInStars:u,isSilent:m,scheduledAt:p,scheduleRepeatPeriod:g,effectId:f,attachments:I}=t,v=t.text||I?.length?void 0:f,y=(0,C.g29)(e),A=l===n.l3,P=s?(0,C.hds)(e,s):void 0,k=i?(0,C.hds)(e,i):void 0,T=s&&o?o.sort((e,t)=>e-t).map(t=>(0,C.O5q)(e,s,t)).filter(Boolean):void 0;if(!P||!k||!T||l&&!A&&!k.isForum)return;const F=(0,C.VF$)(e,i),B=(0,C.GA4)(e,i,l||n.l3),U=(0,C.ZZX)(e,k.id),x=[],[N,R]=(0,h.jB)(T,e=>!(0,S.u7)(e)),J=N.filter(t=>(0,C.R4s)(e,t));if(J.length){const a=e.config?.maxForwardedCount?(0,S.v$)(J,e.config.maxForwardedCount):[J];for(const e of a){const a={fromChat:P,toChat:k,toThreadId:l,messages:e,isSilent:m,scheduledAt:p,scheduleRepeatPeriod:g,sendAs:F,withMyScore:r,noAuthors:d,noCaptions:c,isCurrentUserPremium:y,wasDrafted:Boolean(B),lastMessageId:U,messagePriceInStars:u,effectId:v};if(u){const e=await(0,b.px)("forwardMessagesLocal",a);x.push({...t,forwardParams:{...a,forwardedLocalMessagesSlice:e},forwardedLocalMessagesSlice:e})}else(0,b.px)("forwardMessages",a)}}for(const t of R){const{text:a,entities:s}=t.content.text||{},{sticker:o}=t.content,n={chat:k,replyInfo:(0,C.OEv)(e,k.id,l),text:a,entities:s,sticker:o,isSilent:m,scheduledAt:p,scheduleRepeatPeriod:g,sendAs:F,lastMessageId:U};await ie(e,n,x)}return e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},a),(0,w.UF)(e),x}async function se(e,t,a,o,r,d=!1,c=!1,l,...[m=(0,u.g0)()]){const p=t.id;let g,f=s.yo2;switch(r){case i.TN.Backwards:o?(g=-1,f+=1):g=void 0;break;case i.TN.Around:g=-(Math.round(s.yo2/2)+1);break;case i.TN.Forwards:g=-(s.yo2+1),o&&(f+=1)}const I=(e=(0,w.mS)()).currentUserId,v=(0,S.cG)(p,a,I),y=v?String(a):p,M=await(0,b.px)("fetchMessages",{chat:(0,C.hds)(e,y),offsetId:o,addOffset:g,limit:f,threadId:a,isSavedDialog:v});if(!M)return;const{messages:P,count:k}=M;e=(0,w.mS)();const T=(0,C.C5H)(e,p,a,"typingDraftIdByRandomId"),F=T?Object.values(T).map(t=>(0,C.O5q)(e,p,t)).filter(Boolean):[],B=p===s.zv8?e.serviceNotifications.filter(({isDeleted:e})=>!e).map(({message:e})=>e):F,U=[].concat(P,B),x=(0,h.dU)(U,"id"),N=Object.keys(x).map(Number);if(a!==n.l3&&!(0,S.cG)(p,a,e.currentUserId)){const t=(0,C.dU3)(e,p,a);N[0]&&t!==N[0]||t===a||N.unshift(Number(a))}e=(0,A.o4A)(e,p,x),e=d?(0,A.E0b)(e,p,a,N):(0,A.d4w)(e,p,a,N);let R=(0,C.gCU)(e,p,a);const J=o?(0,C.Lzh)(e,p,a,o):void 0;if(d&&R&&J&&(J.length&&!(0,h.h8)(R,J)||(e=(0,A.d4w)(e,p,a,J),R=(0,C.gCU)(e,p,a),e=(0,A.qKm)(e,p,a,J),d=!1)),!c){const t=d&&J?J:R;if(t){const{newViewportIds:s}=oe(t,o,r);e=(0,A.s3Z)(e,p,a,s,m)}}k&&(e=(0,A.eAk)(e,t.id,a,{messagesCount:k})),(0,w.UF)(e),l?.()}function oe(e,t,a){const{length:o}=e,n=t?function(e,t){return t<e[0]?0:t>e[e.length-1]?e.length-1:e.findIndex((a,s)=>a===t||a<t&&e[s+1]>t)}(e,t):-1,r=a===i.TN.Backwards?n:n+1||o,d=a===i.TN.Around?Math.round(s.yo2/2):s.yo2,c=r-d,l=r+d-1,u=e.slice(Math.max(0,c),l+1);let h,m;switch(a){case i.TN.Backwards:h=r>=0,m=c>=0;break;case i.TN.Forwards:h=r<o,m=l<=o-1;break;case i.TN.Around:default:h=u.length>0,m=u.length===s.yo2}return{newViewportIds:u,areSomeLocal:h,areAllLocal:m}}async function ne(e,t){const a=(0,C.PVB)(e,t);if(!a)return;if((0,y.vj)(a)){if((0,C.ODG)(e,t))return;return a.paidMessagesStars}if(!a?.paidMessagesStars)return;const s=(0,C.vGo)(e,a.id);return s?s.paidMessagesStars:await(0,b.px)("fetchPaidMessagesStarsAmount",a)}async function ie(e,t,a){if(t.messagePriceInStars){const e=await(0,b.px)("sendMessageLocal",t);e&&a.push({...t,localMessage:e})}else re(e,t)}async function re(e,t){let a;(t.replyInfo||d.pz)&&await(0,I.P_)();const s=t.attachment?(t,o)=>{Z.has(o)||(a=o,Z.set(o,s)),e=(0,w.mS)(),e=(0,A.mR)(e,o,t),(0,w.UF)(e)}:void 0;await(0,b.px)("sendMessage",t,s),s&&a&&(e=(0,w.mS)(),e=(0,A.mR)(e,a,void 0),(0,w.UF)(e),Z.delete(a))}async function de(e,t,a){const s=(0,C.hds)(e,t);if(!s)return;const o=await(0,b.px)("fetchUnreadMentions",{chat:s,offsetId:a});if(!o)return;const{messages:n}=o,i=(0,h.dU)(n,"id"),r=Object.keys(i).map(Number);e=(0,w.mS)(),e=(0,A.o4A)(e,s.id,i),e=(0,A.Wez)(e,t,s,r),(0,w.UF)(e)}(0,w.aJ)("loadViewportMessages",(e,t,a)=>{const{direction:s=i.TN.Around,isBudgetPreload:o=!1,shouldForceRender:n=!1,forceLastSlice:r=!1,onLoaded:d,onError:c,tabId:l=(0,u.g0)()}=a||{};let{chatId:h,threadId:p}=a||{};if(!h||!p){const t=(0,C.Xf0)(e,l);if(!t)return void c?.();h=t.chatId,p=t.threadId}const g=(0,C.hds)(e,h),f=(0,C._ls)(e,h);if(!g||f)return void c?.();const v=(0,C.rA3)(e,h,p,l),b=(0,C.gCU)(e,h,p);if(v&&v.length&&s!==i.TN.Around){const a=r?void 0:s===i.TN.Backwards?v[0]:v[v.length-1];if(a&&(0,m.iL)(a))return;if(a===p&&s===i.TN.Backwards)return;const n=Boolean(b&&a&&!b.includes(a)),c=n?(0,C.Lzh)(e,h,p,a):b;if(c?.length){const{newViewportIds:i,areSomeLocal:r,areAllLocal:m}=oe(c,a,s);r&&(e=(0,A.s3Z)(e,h,p,i,l)),(0,I.aj)(()=>{!async function(e,t,a,s,o,n,i,r,d,c,...[l=(0,u.g0)()]){a||await se(e,n,i,d,r,s,o,c,l),o||t.loadViewportMessages({chatId:n.id,threadId:i,direction:r,isBudgetPreload:!0,onLoaded:c,tabId:l})}(e,t,m,n,o,g,p,s,a,d,l)})}if(o)return}else{const t=r?void 0:(0,C.kdX)(e,h,l)||(0,C.EHH)(e,h,p),a=Boolean(t&&b&&!b.includes(t)),s=(a?(0,C.Lzh)(e,h,p,t):b)||[],{newViewportIds:n,areSomeLocal:c,areAllLocal:u}=oe(s,t,i.TN.Around);c&&(e=(0,A.s3Z)(e,h,p,n,l)),u?d?.():(0,I.aj)(()=>{se(e,g,p,t,i.TN.Around,a,o,d,l)})}(0,w.UF)(e,{forceOnHeavyAnimation:n})}),(0,w.aJ)("loadMessage",async(e,t,a)=>{const{chatId:s,messageId:o,replyOriginForId:i,threadUpdate:r}=a,d=(0,C.hds)(e,s);if(!d)return;const c=await async function(e,t,a,s){const o=await(0,b.px)("fetchMessage",{chat:t,messageId:a});if(o){if(o!==n.K1)return e=(0,w.mS)(),e=(0,A.r3y)(e,t.id,a,o.message),(0,w.UF)(e),o.message;if(s){e=(0,w.mS)();const a=(0,C.O5q)(e,t.id,s);e=(0,A.r3y)(e,t.id,s,{...a,replyInfo:void 0}),(0,w.UF)(e)}}}(e,d,o,i);if(c&&r){const{lastMessageId:t,isDeleting:a}=r;e=(0,w.mS)(),e=(0,A.Wwn)(e,c,s,t,a),(0,w.UF)(e)}}),(0,w.aJ)("loadMessagesById",async(e,t,a)=>{const{chatId:s,messageIds:o}=a,n=(0,C.hds)(e,s);if(!n)return;const i=await(0,b.px)("fetchMessagesById",{chat:n,messageIds:o});i&&(e=(0,w.mS)(),e=(0,A.o4A)(e,s,(0,h.dU)(i,"id")),(0,w.UF)(e))}),(0,w.aJ)("sendMessage",async(e,t,a)=>{const{messageList:o,tabId:i=(0,u.g0)()}=a,{storyId:r,peerId:d}=(0,C.V9I)(e,i),c=Boolean(r&&d);if(!o&&!c)return;let{chatId:l,threadId:f,type:I}=o||{};if(c&&(l=d,f=n.l3,I="thread"),a=(0,h.cJ)(a,["tabId"]),"scheduled"===I&&!a.scheduledAt)return e=(0,M.w)(e,{contentToBeScheduled:a},i),void(0,w.UF)(e);const v=(0,C.hds)(e,l),S=(0,C.GA4)(e,l,f),y=(0,C.nTw)(e,i).forwardMessages?.messageIds?.length,A=y||c?void 0:S?.replyInfo,P=y||c?void 0:S?.suggestedPostInfo,k=c?{type:"story",peerId:d,storyId:r}:void 0,T=(0,C.OEv)(e,l,f,A),F=k||T,B=(0,C.Vw0)(e,l,f),U=f===n.l3?(0,C.ZZX)(e,l):B?.lastMessageId,x=await ne(e,l),N=P?.price,R=N?.currency||s.OUy,J=N?.amount||0;if(J&&!A)if(R===s.OUy){if(J>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:J},tabId:i})}else if(R===s.ykW&&J>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:s.ykW,tabId:i});const Y=A&&P?(0,C.O5q)(e,l,A.replyToMsgId):void 0;let E;if(P&&Y?.content&&(E=Y.content),v.isBotForum&&f===n.l3&&"message"===F?.type){const a=(0,C.O5q)(e,l,F.replyToMsgId),s=a&&(0,C.L_2)(e,a);t.openThread({chatId:l,threadId:s||F?.replyToTopId||F?.replyToMsgId,tabId:i})}const D={...a,chat:v,replyInfo:F,suggestedPostInfo:P,suggestedMedia:E,noWebPage:(0,C.rQx)(e,l,f),sendAs:(0,C.VF$)(e,l),lastMessageId:U,messagePriceInStars:x,isStoryReply:c,isPending:!!x||void 0,...Y&&{isInvertedMedia:Y?.isInvertedMedia}};if(c||t.clearWebPagePreview({tabId:i}),v.isBotForum&&f===n.l3&&"message"!==F?.type){const e=D.text??(0,p.Yw)()("BotForumTopicTitlePlaceholder"),t=e.length>12?`${e.slice(0,12)}...`:e,a=await(0,b.px)("createTopic",{chat:v,title:t,isTitleMissing:!0,sendAs:D.sendAs});a&&(D.replyInfo="message"===D.replyInfo?.type?{...D.replyInfo,replyToTopId:a}:{type:"message",replyToMsgId:a,replyToTopId:a},(0,w.ko)().openThread({chatId:v.id,threadId:a}))}const O=(!a.attachments||a.attachments.length<=1)&&!y,L=!O&&a.shouldGroupMessages,G=[];if(O){const{attachments:t,...a}=D,s={...a,attachment:t?t[0]:void 0,wasDrafted:Boolean(S)};await ie(e,s,G)}else if(L){const{text:t,entities:a,attachments:o,...n}=D,i=function(e){return e.reduce((e,t,a,s)=>0===a?(e.push([t]),e):(pe(t)===pe(s[a-1])?e[e.length-1].push(t):e.push([t]),e),[])}(o);let r=!1;for(let o=0;o<i.length;o++){const d=i[o],c=(0,h.lD)(d,s.ynd);for(let s=0;s<c.length;s++){const l=`${Date.now()}${o}${s}`,u=0===s&&0===o,h=s===c.length-1&&o===i.length-1;if(d[0].quick&&!d[0].shouldSendAsFile){const[o,...i]=c[s];let d={...n,text:u&&!r?t:void 0,entities:u&&!r?a:void 0,attachment:o,groupedId:i.length>0?l:void 0,wasDrafted:Boolean(S)};await ie(e,d,G),r=!0;for(const t of i)d={...n,attachment:t,groupedId:l},await ie(e,d,G)}else{const o=c[s].slice(0,-1),i=c[s][c[s].length-1];for(const t of o){const a={...n,attachment:t,groupedId:l};await ie(e,a,G)}const d={...n,text:h&&!r?t:void 0,entities:h&&!r?a:void 0,attachment:i,groupedId:o.length>0?l:void 0,wasDrafted:Boolean(S)};await ie(e,d,G),r=!0}}}}else{const{text:t,entities:a,attachments:s,replyInfo:o,...n}=D;if(t){const s={...n,text:t,entities:a,replyInfo:o,wasDrafted:Boolean(S)};await ie(e,s,G)}if(s)for(const t of s){const a={...n,attachment:t};await ie(e,a,G)}}if(y){const t=await ae(e,D,i);t&&G.push(...t)}G?.length&&async function(e,t){const a=t[0]?.chat;if(!a||!t.length)return;const s=await ne(e,a.id);if(!s)return void(0,w.ko)().sendMessages({sendParams:t});const o=t.reduce((e,t)=>{if(t.localMessage?.id)e.push(t.localMessage.id);else if(t.forwardedLocalMessagesSlice?.localMessages){const a=Object.values(t.forwardedLocalMessagesSlice.localMessages).map(e=>e.id).filter(Boolean);e.push(...a)}return e},[]),n=t[0]?.forwardedLocalMessagesSlice?.localMessages,i=t[0]?.localMessage||n&&Object.values(n)[0];if(!i)return;const r=o.length,d=t[0];let c;if(1===t.length&&d.isStoryReply){const{gif:e,sticker:t,isReaction:a}=d;e?c={key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}}:t?c={key:"StoryTooltipStickerSent"}:a&&(c={key:"StoryTooltipReactionSent"})}const l=c||{key:"MessageSentPaidToastTitle",variables:{count:r},options:{pluralValue:r}};(0,w.ko)().sendMessages({sendParams:t}),(0,w.ko)().showNotification({localId:(0,m.bj)(i),title:l,message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.Kk)((0,p.Yw)(),s*r)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage"})}(e,G)}),(0,w.aJ)("sendInviteMessages",async(e,t,a)=>{const{chatId:s,userIds:o,tabId:n=(0,u.g0)()}=a,i=(0,C.AWZ)(e,s);if(!i?.inviteLink)return;const r=[];return await Promise.all(o.map(t=>{const a=(0,C.hds)(e,t);if(!a)return Promise.resolve(void 0);const s=(0,S.Yg)((0,C.mBe)(e,t));return s&&r.push(s),re(e,{chat:a,text:i.inviteLink})})),t.showNotification({message:(0,f.yE)("Conversation.ShareLinkTooltip.Chat.One",r.join(", ")),tabId:n})}),(0,w.aJ)("editMessage",(e,t,a)=>{const{messageList:s,text:o,entities:n,attachments:i,tabId:r=(0,u.g0)()}=a;if(!s)return;let d;const c=i?(t,a)=>{Z.has(a)||(d=a,Z.set(a,c)),e=(0,w.mS)(),e=(0,A.mR)(e,a,t),(0,w.UF)(e)}:void 0,{chatId:l,threadId:h,type:m}=s,p=(0,C.hds)(e,l),g=(0,C.KLw)(e,l,h,m);p&&g&&(t.setEditingId({messageId:void 0,tabId:r}),(async()=>{await(0,b.px)("editMessage",{chat:p,message:g,attachment:i?i[0]:void 0,text:o,entities:n,noWebPage:(0,C.rQx)(e,l,h)},c),c&&d&&(e=(0,w.mS)(),e=(0,A.mR)(e,d,void 0),(0,w.UF)(e),Z.delete(d))})())}),(0,w.aJ)("editTodo",(e,t,a)=>{const{chatId:s,todo:o,messageId:n}=a,i=(0,C.hds)(e,s),r=(0,C.O5q)(e,s,n);i&&r&&(0,b.px)("editTodo",{chat:i,message:r,todo:o})}),(0,w.aJ)("cancelUploadMedia",(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.O5q)(e,s,o);if(!n)return;const i=n&&Z.get((0,m.bj)(n));i&&(0,b.om)(i),(0,S.Nb)(n)&&t.apiUpdate({"@type":"deleteMessages",ids:[o],chatId:s})}),(0,w.aJ)("saveDraft",(e,t,a)=>{const{chatId:s,threadId:o,text:n}=a,i=(0,C.hds)(e,s);if(!n||!i)return;const r=(0,C.GA4)(e,s,o);(!i.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:s,threadId:o,draft:{text:n,replyInfo:r?.replyInfo,effectId:r?.effectId,suggestedPostInfo:r?.suggestedPostInfo}})}),(0,w.aJ)("clearDraft",(e,t,a)=>{const{chatId:s,threadId:o=n.l3,isLocalOnly:i,shouldKeepReply:r,shouldKeepSuggestedPost:d}=a,c=(0,C.GA4)(e,s,o);if(!c)return;const l=c.replyInfo;te({global:e,chatId:s,threadId:o,draft:r&&l||d&&c.suggestedPostInfo?{replyInfo:r?l:void 0,suggestedPostInfo:d?c.suggestedPostInfo:void 0}:void 0,isLocalOnly:i})}),(0,w.aJ)("updateDraftReplyInfo",(e,t,a)=>{const{tabId:s=(0,u.g0)(),...o}=a,n=(0,C.Xf0)(e,s);if(!n)return;const{chatId:i,threadId:r}=n,d=(0,C.GA4)(e,i,r),c={type:"message",...d?.replyInfo,...o};c.replyToMsgId&&te({global:e,chatId:i,threadId:r,draft:{...d,replyInfo:c,suggestedPostInfo:void 0},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftReplyInfo",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.Xf0)(e,s);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.hds)(e,n),d=(0,C.GA4)(e,n,i);if(r?.isMonoforum&&!d?.replyInfo&&!d?.suggestedPostInfo)return;const c=d?.text?{...d,replyInfo:void 0}:void 0;te({global:e,chatId:n,threadId:i,draft:c,isLocalOnly:Boolean(c)})}),(0,w.aJ)("updateDraftSuggestedPostInfo",(e,t,a)=>{const{tabId:s=(0,u.g0)(),...o}=a,n=(0,C.Xf0)(e,s);if(!n)return;const{chatId:i,threadId:r}=n,d=(0,C.GA4)(e,i,r),c={...d?.suggestedPostInfo,...o};te({global:e,chatId:i,threadId:r,draft:{...d,suggestedPostInfo:c},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("resetDraftSuggestedPostInfo",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.Xf0)(e,s);if(!o)return;const{chatId:n,threadId:i}=o;te({global:e,chatId:n,threadId:i,draft:void 0,isLocalOnly:!1})}),(0,w.aJ)("initDraftFromSuggestedMessage",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.O5q)(e,s,o);if(!i)return;const r=(0,C.Xf0)(e,n);if(!r)return;const{threadId:d}=r;if(t.clearDraft({chatId:s,threadId:d,isLocalOnly:!0}),t.updateDraftReplyInfo({replyToMsgId:o,monoforumPeerId:(0,C.QP5)(e,i),tabId:n}),i.suggestedPostInfo){const{scheduleDate:a,...s}=i.suggestedPostInfo,o=(0,v.Fm)(),r=e.appConfig.starsSuggestedPostFutureMin,d=a&&a>o+r?a:void 0;t.updateDraftSuggestedPostInfo({...s,scheduleDate:d,tabId:n})}t.saveDraft({chatId:s,threadId:d,text:i.content.text})}),(0,w.aJ)("saveEffectInDraft",(e,t,a)=>{const{chatId:s,threadId:o,effectId:n}=a,i=(0,C.hds)(e,s),r=(0,C.GA4)(e,s,o);(!i?.isMonoforum||r?.replyInfo||r?.suggestedPostInfo)&&te({global:e,chatId:s,threadId:o,draft:{...r,effectId:n},isLocalOnly:!0,noLocalTimeUpdate:!0})}),(0,w.aJ)("updateInsertingPeerIdMention",(e,t,a)=>{const{peerId:s,tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{insertingPeerIdMention:s},o)}),(0,w.aJ)("toggleMessageWebPage",(e,t,a)=>{const{chatId:s,threadId:o,noWebPage:n}=a;return(0,A.eww)(e,s,o,"noWebPage",n)}),(0,w.aJ)("pinMessage",(e,t,a)=>{const{chatId:s,messageId:o,isUnpin:n,isOneSide:i,isSilent:r}=a,d=(0,C.hds)(e,s);d&&(0,b.px)("pinMessage",{chat:d,messageId:o,isUnpin:n,isOneSide:i,isSilent:r})}),(0,w.aJ)("unpinAllMessages",async(e,t,a)=>{const{chatId:s,threadId:o}=a,i=(0,C.hds)(e,s);if(!i)return;await(0,b.px)("unpinAllMessages",{chat:i,threadId:o}),e=(0,w.mS)();const r=(0,C.fcC)(e,s,o);r?.forEach(t=>{e=(0,A.r3y)(e,s,t,{isPinned:!1})}),e=(0,A.eww)(e,i.id,n.l3,"pinnedIds",[]),(0,w.UF)(e)}),(0,w.aJ)("deleteMessages",(e,t,a)=>{const{messageIds:s,shouldDeleteForAll:o,messageList:n,tabId:i=(0,u.g0)()}=a,r=(0,C.Xf0)(e,i),d=n||r;if(!d)return;const{chatId:c,threadId:l}=d,h=(0,C.hds)(e,c),m=s.filter(t=>{const a=(0,C.O5q)(e,c,t);return a&&!(0,S.Nb)(a)});if(!m.length&&s.length)return void Q(e,(0,S.WX)(h)||(0,S.Vs)(h)?c:void 0,s,t);(0,b.px)("deleteMessages",{chat:h,messageIds:m,shouldDeleteForAll:o});const p=(0,C.Ys6)(e,c,l);p&&s.includes(p)&&t.setEditingId({messageId:void 0,tabId:i})}),(0,w.aJ)("resetLocalPaidMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).notifications;return o&&o.length?(o.forEach(e=>{if("paidMessage"===e.type){const a=e.dismissAction;a&&!Array.isArray(a)&&t[a.action](a.payload),t.dismissNotification({localId:e.localId,tabId:s})}}),e):e}),(0,w.aJ)("deleteParticipantHistory",(e,t,a)=>{const{chatId:s,peerId:o}=a,n=(0,C.hds)(e,s),i=(0,C.PVB)(e,o);(0,b.px)("deleteParticipantHistory",{chat:n,peer:i})}),(0,w.aJ)("deleteScheduledMessages",(e,t,a)=>{const{messageIds:s,tabId:o=(0,u.g0)()}=a,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i}=n,r=(0,C.hds)(e,i);(0,b.px)("deleteScheduledMessages",{chat:r,messageIds:s});const d=(0,C.VlN)(e,i);d&&s.includes(d)&&t.setEditingId({messageId:void 0,tabId:o})}),(0,w.aJ)("deleteHistory",async(e,t,a)=>{const{chatId:s,shouldDeleteForAll:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s);if(!i)return;await(0,b.px)("deleteHistory",{chat:i,shouldDeleteForAll:o}),e=(0,w.mS)();const r=(0,C.Xf0)(e,n);r&&r.chatId===s&&t.openChat({id:void 0,tabId:n});const d=e.chatFolders.byId;Object.values(d).forEach(e=>{if(e.includedChatIds.includes(s)||e.pinnedChatIds?.includes(s)){const t=e.includedChatIds.filter(e=>e!==s),a=e.pinnedChatIds?.filter(e=>e!==s),o={...e,includedChatIds:t,pinnedChatIds:a};(0,b.px)("editChatFolder",{id:e.id,folderUpdate:o})}})}),(0,w.aJ)("deleteSavedHistory",async(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.hds)(e,s);if(!n)return;await(0,b.px)("deleteSavedHistory",{chat:n}),e=(0,w.mS)();const i=(0,C.Xf0)(e,o);i&&i.threadId===s&&t.openChat({id:void 0,tabId:o})}),(0,w.aJ)("reportMessages",async(e,t,a)=>{const{messageIds:o,description:n="",option:i="",chatId:r,tabId:d=(0,u.g0)()}=a,c=(0,C.hds)(e,r),l=await(0,b.px)("reportMessages",{peer:c,messageIds:o,description:n,option:i});if(!l)return;const{result:h,error:m}=l;if(m===s.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,a=t?.[t.length-1]?.options?.find(e=>e.option===i),s={title:h.title,options:h.options,subtitle:a?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,s]:[s]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,a=t?.[t.length-1]?.options?.find(e=>e.option===i),s={isOptional:h.isOptional,option:h.option,title:a?.text};e=(0,M.w)(e,{reportModal:{chatId:r,messageIds:o,description:n,subject:"message",sections:t?[...t,s]:[s]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("sendMessageAction",async(e,t,a)=>{const{action:s,chatId:o,threadId:n}=a;if("connectionStateReady"!==e.connectionState)return;if((0,C.nZ4)(e,o))return;const i=(0,C.hds)(e,o);if(!i||i.isMonoforum)return;const r=(0,C.mBe)(e,o);r&&((0,S.tv)(r)||(0,S.PL)(r))||await(0,b.px)("sendMessageAction",{peer:i,threadId:n,action:s})}),(0,w.aJ)("reportChannelSpam",(e,t,a)=>{const{participantId:s,chatId:o,messageIds:n}=a,i=(0,C.PVB)(e,s),r=(0,C.hds)(e,o);i&&r&&(0,b.px)("reportChannelSpam",{peer:i,chat:r,messageIds:n})}),(0,w.aJ)("markMessageListRead",(e,t,a)=>{if((0,C.trm)(e))return;const{maxId:o,tabId:i=(0,u.g0)()}=a,r=(0,C.Xf0)(e,i);if(!r)return;const{chatId:d,threadId:c}=r,l=(0,C.hds)(e,d);if(!l||(0,S.cG)(d,c,e.currentUserId))return;ee(()=>{(0,b.px)("markMessageListRead",{chat:l,threadId:c,maxId:o})}),d===s.zv8&&(e={...e,serviceNotifications:e.serviceNotifications.map(e=>e.isUnread&&e.id<=o?{...e,isUnread:!1}:e)});const h=(0,C.rA3)(e,d,c,i),m=(0,C.RjD)(e,d,c),p=(0,C.S0q)(e,d,c);if(c!==n.l3&&!l.isForum)return(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});if(!h||!m||!l.unreadCount&&!p?.unreadCount)return e;const g=function(e,t,a){if(0===e.length||t<e[0]||a>e[e.length-1])return;let s=0;for(let o=0,n=e.length;o<n&&(e[o]>=t&&e[o]<=a&&s++,!(e[o]>=a));o++);return s}(h,m,o);if(!g)return e;if(l.isForum&&p){e=(0,A.eAk)(e,d,c,{lastReadInboxMessageId:o});const t=Math.max(0,p.unreadCount-g);return 0===t&&!l.isBotForum&&l.unreadCount&&(e=(0,A.wix)(e,d,{unreadCount:Math.max(0,l.unreadCount-1)})),(0,A.TwA)(e,d,Number(c),{unreadCount:t})}return(0,A.wix)(e,d,{lastReadInboxMessageId:o,unreadCount:Math.max(0,(l.unreadCount||0)-g)})}),(0,w.aJ)("markMessagesRead",(e,t,a)=>{const{messageIds:s,tabId:o=(0,u.g0)(),shouldFetchUnreadReactions:n}=a,i=(0,C.meB)(e,o);i&&(0,b.px)("markMessagesRead",{chat:i,messageIds:s}).then(()=>{n&&t.fetchUnreadReactions({chatId:i.id})})}),(0,w.aJ)("loadWebPagePreview",async(e,t,a)=>{const{text:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("fetchWebPagePreview",{text:s});e=(0,w.mS)(),e=(0,M.w)(e,{webPagePreviewId:n?.id},o),(0,w.UF)(e),n&&t.apiUpdate({"@type":"updateWebPage",webPage:n})}),(0,w.aJ)("clearWebPagePreview",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{webPagePreviewId:void 0},s)}),(0,w.aJ)("sendPollVote",(e,t,a)=>{const{chatId:s,messageId:o,options:n}=a,i=(0,C.hds)(e,s);i&&(0,b.px)("sendPollVote",{chat:i,messageId:o,options:n})}),(0,w.aJ)("toggleTodoCompleted",(e,t,a)=>{const{chatId:s,messageId:o,completedIds:n,incompletedIds:i}=a,r=(0,C.hds)(e,s),d=(0,C.O5q)(e,s,o),c=e.currentUserId,l=d?.content.todo;if(!l||!c||!r)return;const u=l.completions||[],h=u.map(e=>e.itemId),m=[...u],p=(0,v.Fm)();n.forEach(e=>{h.includes(e)||m.push({itemId:e,completedBy:c,completedAt:p})});const g=m.filter(e=>!i.includes(e.itemId)),f={...d.content,todo:{...l,completions:g}},I={...d,content:f};e=K(e,s,d.id,!1,I),(0,w.UF)(e),(0,b.px)("toggleTodoCompleted",{chat:r,messageId:d.id,completedIds:n,incompletedIds:i})}),(0,w.aJ)("appendTodoList",(e,t,a)=>{const{chatId:s,items:o,messageId:n}=a,i=(0,C.hds)(e,s),r=(0,C.O5q)(e,s,n);i&&r&&(0,b.px)("appendTodoList",{chat:i,message:r,items:o})}),(0,w.aJ)("cancelPollVote",(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.hds)(e,s);n&&(0,b.px)("sendPollVote",{chat:n,messageId:o,options:[]})}),(0,w.aJ)("closePoll",(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.hds)(e,s),i=(0,C.O5q)(e,s,o),r=i&&(0,C.zcZ)(e,i);n&&r&&(0,b.px)("closePoll",{chat:n,messageId:o,poll:r})}),(0,w.aJ)("loadPollOptionResults",async(e,t,a)=>{const{chat:s,messageId:o,option:n,offset:i,limit:r,shouldResetVoters:d,tabId:c=(0,u.g0)()}=a,l=await(0,b.px)("loadPollOptionResults",{chat:s,messageId:o,option:n,offset:i,limit:r});if(!l)return;e=(0,w.mS)();const m=(0,C.nTw)(e,c),{pollResults:p}=m,{voters:g}=m.pollResults;e=(0,M.w)(e,{pollResults:{...p,voters:{...g,[n]:(0,h.Am)([...!d&&g?.[n]?g[n]:[],...l.votes.map(e=>e.peerId)])},offsets:{...p.offsets?p.offsets:{},[n]:l.nextOffset||""}}},c),(0,w.UF)(e)}),(0,w.aJ)("loadExtendedMedia",(e,t,a)=>{const{chatId:s,ids:o}=a,n=(0,C.hds)(e,s);n&&(0,b.px)("fetchExtendedMedia",{chat:n,ids:o})}),(0,w.aJ)("loadScheduledHistory",async(e,t,a)=>{if((0,C.trm)(e))return;const{chatId:s}=a,o=(0,C.hds)(e,s);if(!o)return;const i=await(0,b.px)("fetchScheduledHistory",{chat:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);if(e=(0,w.mS)(),e=(0,A.Ffw)(e,o.id,d),e=(0,A.eww)(e,o.id,n.l3,"scheduledIds",c),c.length||(e=(0,A.zTz)(e,o.id,{hasScheduledMessages:!1})),o?.isForum){const t={};r.forEach(a=>{const s=(0,C.L_2)(e,a),o=t[s]||[];o.push(a.id),t[s]=o}),Object.entries(t).forEach(([t,a])=>{e=(0,A.eww)(e,o.id,Number(t),"scheduledIds",a)})}(0,w.UF)(e)}),(0,w.aJ)("sendScheduledMessages",(e,t,a)=>{const{chatId:s,id:o}=a,n=(0,C.hds)(e,s);n&&(0,b.px)("sendScheduledMessages",{chat:n,ids:[o]})}),(0,w.aJ)("rescheduleMessage",(e,t,a)=>{const{chatId:s,messageId:o,scheduledAt:n,scheduleRepeatPeriod:i}=a,r=(0,C.hds)(e,s),d=r&&(0,C.Jl6)(e,r.id,o);r&&d&&(0,b.px)("rescheduleMessage",{chat:r,message:d,scheduledAt:n,scheduleRepeatPeriod:i})}),(0,w.aJ)("transcribeAudio",async(e,t,a)=>{const{messageId:s,chatId:o}=a,n=(0,C.hds)(e,o);if(!n)return;e=(0,A.r3y)(e,o,s,{transcriptionId:""}),(0,w.UF)(e);const i=await(0,b.px)("transcribeAudio",{chat:n,messageId:s});e=(0,w.mS)(),e=(0,A.r3y)(e,o,s,{transcriptionId:i,isTranscriptionError:!i}),(0,w.UF)(e)}),(0,w.aJ)("loadCustomEmojis",async(e,t,a)=>{const{ids:s,ignoreCache:o}=a,n=o?s:(0,h.Am)(s.filter(t=>!(0,C.O8F)(e,t))),i=await(0,b.px)("fetchCustomEmoji",{documentId:n});i&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,byId:{...e.customEmojis.byId,...(0,h.dU)(i,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("forwardMessages",(e,t,a)=>{const{isSilent:s,scheduledAt:o,scheduleRepeatPeriod:n,tabId:i=(0,u.g0)()}=a,{toChatId:r}=(0,C.nTw)(e,i).forwardMessages,d=r?(0,C.hds)(e,r):void 0;d&&ae(e,{chat:d,isSilent:s,scheduledAt:o,scheduleRepeatPeriod:n},i)}),(0,w.aJ)("sendMessages",async(e,t,a)=>{const{sendParams:s}=a;await Promise.all(s.map(async t=>{t.forwardedLocalMessagesSlice&&t.forwardParams?(await(0,I.P_)(),await(0,b.px)("forwardApiMessages",t.forwardParams)):await re(e,t)})),s.length>0&&s[0].messagePriceInStars&&t.loadStarStatus()}),(0,w.aJ)("loadPinnedMessages",async(e,t,a)=>{const{chatId:s,threadId:o}=a,n=(0,C.hds)(e,s);if(!n||(0,S.cG)(s,o,e.currentUserId))return;const i=await(0,b.px)("fetchPinnedMessages",{chat:n,threadId:o});if(!i)return;const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number).sort((e,t)=>t-e);e=(0,w.mS)(),e=(0,A.o4A)(e,n.id,d),e=(0,A.gz3)(e,n.id,o,c),(0,w.UF)(e)}),(0,w.aJ)("loadSeenBy",async(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.hds)(e,s);if(!n)return;const i=await(0,b.px)("fetchSeenBy",{chat:n,messageId:o});i&&(e=(0,w.mS)(),e=(0,A.r3y)(e,s,o,{seenByDates:i}),(0,w.UF)(e))}),(0,w.aJ)("saveDefaultSendAs",(e,t,a)=>{const{chatId:s,sendAsId:o}=a,n=(0,C.hds)(e,s),i=(0,C.hds)(e,o)||(0,C.mBe)(e,o);if(n&&i)return(0,b.px)("saveDefaultSendAs",{sendAs:i,chat:n}),(0,A.ltr)(e,s,{sendAsId:o})}),(0,w.aJ)("loadSendAs",async(e,t,a)=>{const{chatId:s}=a,o=(0,C.hds)(e,s);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o});if(!n)return e=(0,w.mS)(),e=(0,A.wix)(e,s,{sendAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,s,{sendAsPeerIds:n}),(0,w.UF)(e)}),(0,w.aJ)("loadSendPaidReactionsAs",async(e,t,a)=>{const{chatId:s}=a,o=(0,C.hds)(e,s);if(!o)return;const n=await(0,b.px)("fetchSendAs",{chat:o,isForPaidReactions:!0});if(!n)return e=(0,w.mS)(),e=(0,A.wix)(e,s,{sendPaidReactionsAsPeerIds:[]}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,s,{sendPaidReactionsAsPeerIds:n}),(0,w.UF)(e)}),(0,w.aJ)("loadSponsoredMessages",async(e,t,a)=>{if((0,C.trm)(e))return;const{peerId:s}=a,o=(0,C.PVB)(e,s);if(!o)return;if((0,y.mO)(o)&&(0,C.I_m)(e,o.id))return;const n=await(0,b.px)("fetchSponsoredMessages",{peer:o});n&&(e=(0,w.mS)(),e=(0,A.EKx)(e,s,n.messages[0]),(0,w.UF)(e))}),(0,w.aJ)("viewSponsored",(e,t,a)=>{const{randomId:s}=a;(0,b.px)("viewSponsoredMessage",{random:s})}),(0,w.aJ)("clickSponsored",(e,t,a)=>{const{randomId:s,isMedia:o,isFullscreen:n}=a;(0,b.px)("clickSponsoredMessage",{random:s,isMedia:o,isFullscreen:n})}),(0,w.aJ)("reportSponsored",async(e,t,a)=>{const{peerId:s,randomId:o,option:n="",tabId:i=(0,u.g0)()}=a,r=await(0,b.px)("reportSponsoredMessage",{randomId:o,option:n});if(r){if("premiumRequired"===r.type)return t.openPremiumModal({initialSection:"no_ads",tabId:i}),void t.closeReportAdModal({tabId:i});if("reported"===r.type||"hidden"===r.type)return t.showNotification({message:(0,f.yE)("reported"===r.type?"AdReported":"AdHidden"),tabId:i}),t.closeReportAdModal({tabId:i}),e=(0,w.mS)(),e=s?(0,A.Itk)(e,s):(0,A.b8O)(e,{sponsoredPeer:void 0},i),void(0,w.UF)(e);if("selectOption"===r.type){e=(0,w.mS)();const t=(0,C.nTw)(e,i).reportAdModal?.sections,a=t?.[t.length-1]?.options.find(e=>e.option===n),d={title:r.title,options:r.options,subtitle:a?.text};e=(0,M.w)(e,{reportAdModal:{chatId:s,randomId:o,sections:t?[...t,d]:[d]}},i),(0,w.UF)(e)}}}),(0,w.aJ)("hideSponsored",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};(0,C.g29)(e)?await(0,b.px)("toggleSponsoredMessages",{enabled:!1})&&(e=(0,w.mS)(),e=(0,A.weB)(e,e.currentUserId,{areAdsEnabled:!1}),(0,w.UF)(e),t.showNotification({message:(0,f.yE)("AdHidden"),tabId:s})):t.openPremiumModal({initialSection:"no_ads",tabId:s})}),(0,w.aJ)("fetchUnreadMentions",async(e,t,a)=>{const{chatId:s,offsetId:o}=a;await de(e,s,o)}),(0,w.aJ)("approveSuggestedPost",async(e,t,a)=>{const{chatId:o,messageId:n,scheduleDate:i,tabId:r=(0,u.g0)()}=a,d=(0,C.hds)(e,o);if(!d)return;const c=(0,C.O5q)(e,o,n);if(!(0,C.ODG)(e,o)&&c?.suggestedPostInfo?.price?.amount){const a=c.suggestedPostInfo.price.amount;if(c.suggestedPostInfo.price.currency===s.OUy){if(a>(e.stars?.balance?.amount||0))return void t.openStarsBalanceModal({topup:{balanceNeeded:a},tabId:r})}else if(a>(e.ton?.balance?.amount||0))return void t.openStarsBalanceModal({currency:s.ykW,tabId:r})}await(0,b.px)("toggleSuggestedPostApproval",{chat:d,messageId:n,reject:!1,scheduleDate:i})&&t.showNotification({message:{key:"SuggestedPostApproved"},tabId:r})}),(0,w.aJ)("rejectSuggestedPost",async(e,t,a)=>{const{chatId:s,messageId:o,rejectComment:n,tabId:i=(0,u.g0)()}=a,r=(0,C.hds)(e,s);r&&await(0,b.px)("toggleSuggestedPostApproval",{chat:r,messageId:o,reject:!0,rejectComment:n})&&t.showNotification({message:{key:"SuggestedPostRejectedNotification"},tabId:i})}),(0,w.aJ)("markMentionsRead",(e,t,a)=>{const{chatId:s,messageIds:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s);i&&(e=(0,A.pWt)(e,s,i,o,!0),(0,w.UF)(e),t.markMessagesRead({messageIds:o,tabId:n}))}),(0,w.aJ)("focusNextMention",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};let o=(0,C.meB)(e,s);if(o){if(!o.unreadMentions){await de(e,o.id),e=(0,w.mS)();const t=o.id;if(o=(0,C.meB)(e,s),!o?.unreadMentions||t!==o.id)return}t.focusMessage({chatId:o.id,messageId:o.unreadMentions[0],tabId:s})}}),(0,w.aJ)("readAllMentions",(e,t,a)=>{const{chatId:s,threadId:o=n.l3}=a,i=(0,C.hds)(e,s);if(i)return(0,b.px)("readAllMentions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?(0,A.wix)(e,i.id,{unreadMentionsCount:void 0,unreadMentions:void 0}):void 0}),(0,w.aJ)("openUrl",(e,t,a)=>{const{url:o,shouldSkipModal:n,ignoreDeepLinks:i,linkContext:d,tabId:c=(0,u.g0)()}=a,h=(0,r.Tc)(o),m=new URL(h),p=(0,r._G)(h);if(!i&&(0,l.zq)(h))return t.closeStoryViewer({tabId:c}),t.closePaymentModal({tabId:c}),void t.openTelegramLink({url:o,linkContext:d,tabId:c});const{appConfig:g,config:f}=e;if(f?.autologinToken&&g.autologinDomains.includes(m.hostname))return m.searchParams.set("autologin_token",f.autologinToken),void window.open(m.href,"_blank","noopener");if(g.urlAuthDomains.includes(m.hostname))return t.closeStoryViewer({tabId:c}),void t.requestLinkUrlAuth({url:o,tabId:c});const I=g.whitelistedDomains.includes(m.hostname);h.match(s.H_r)||n||I?window.open(m,"_blank","noopener"):t.toggleSafeLinkModal({url:p?m.toString():h,tabId:c})}),(0,w.aJ)("openChatOrTopicWithReplyInDraft",(e,t,a)=>{const{chatId:s,topicId:o,tabId:i=(0,u.g0)()}=a;e=(0,w.mS)();const r=(0,C.nTw)(e,i).replyingMessage;e=(0,M.w)(e,{isShareMessageModalShown:!1,replyingMessage:{}},i),(0,w.UF)(e),e=(0,w.mS)();const d=(0,C.meB)(e,i),c=(0,C.Xf0)(e,i)?.threadId;if(!d||!c)return;const l=o||n.l3,h=d.id,m={type:"message",replyToMsgId:r.messageId,replyToTopId:r.toThreadId,replyToPeerId:h,monoforumPeerId:r.toThreadId,quoteText:r.quoteText,quoteOffset:r.quoteOffset},p=r.messageId?m:(0,C.GA4)(e,h,c)?.replyInfo;if(!p)return;if(!(0,C.Vz3)(e,s,h,p))return void t.showNotification({message:(0,f.yE)("Chat.SendNotAllowedText"),tabId:i});if(!p.replyToPeerId&&s===d.id)return;const g=p?.replyToPeerId?p.replyToPeerId===s?void 0:p.replyToPeerId:h;!function(e,t,a,s){const o=(0,C.GA4)(e,s,t);a.replyToMsgId&&te({global:e,chatId:s,threadId:t,draft:{...o,replyInfo:a},isLocalOnly:!0,noLocalTimeUpdate:!0})}(e,l,{...p,replyToPeerId:g,type:"message"},s),t.openThread({chatId:s,threadId:l,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i}),t.clearDraft({chatId:h,threadId:c})}),(0,w.aJ)("setForwardChatOrTopic",async(e,t,a)=>{const{chatId:s,topicId:o,tabId:i=(0,u.g0)()}=a,r=(0,C.mBe)(e,s);(0,C.lC)(e,i)&&r&&!await async function(e,t,a){let s=(0,C.vGo)(e,a);if(!s){const{accessHash:e}=t,o=await(0,b.px)("fetchFullUser",{id:a,accessHash:e});s=o?.fullInfo}return Boolean(!s?.noVoiceMessages)}(e,r,s)?t.showDialog({data:{message:(0,f.yE)("VoiceMessagesRestrictedByPrivacy",(0,S.Yg)(r))},tabId:i}):(e=(0,w.mS)(),(0,C.DI)(e,s,i)?(e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,i).forwardMessages,toChatId:s,toThreadId:o},isShareMessageModalShown:!1},i),(0,w.UF)(e),t.openThread({chatId:s,threadId:o||n.l3,tabId:i}),t.closeMediaViewer({tabId:i}),t.exitMessageSelectMode({tabId:i})):t.showAllowedMessageTypesNotification({chatId:s,tabId:i}))}),(0,w.aJ)("forwardToSavedMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};e=(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,s).forwardMessages,toChatId:e.currentUserId}},s),(0,w.UF)(e),t.exitMessageSelectMode({tabId:s}),t.forwardMessages({isSilent:!0,tabId:s})}),(0,w.aJ)("forwardStory",(e,t,a)=>{const{toChatId:s,tabId:o=(0,u.g0)()}=a||{},{fromChatId:n,storyId:i}=(0,C.nTw)(e,o).forwardMessages,r=n?(0,C.hds)(e,n):void 0,d=s?(0,C.hds)(e,s):void 0,c=n&&i?(0,C.Msb)(e,n,i):void 0;if(!r||!d||!c||"isDeleted"in c)return;const l=(0,C.ZZX)(e,s),{text:h,entities:m}=c.content.text||{};re(e,{chat:d,text:h,entities:m,story:c,lastMessageId:l}),e=(0,w.mS)(),e=(0,M.w)(e,{forwardMessages:{},isShareMessageModalShown:!1},o),(0,w.UF)(e)}),(0,w.aJ)("requestMessageTranslation",(e,t,a)=>{const{chatId:s,id:o,toLanguageCode:n=(0,C.Qq_)(e),tabId:i=(0,u.g0)()}=a;return e=(0,A._Bm)(e,s,o,n,i),(0,A.qpc)(e,{translationLanguage:n})}),(0,w.aJ)("showOriginalMessage",(e,t,a)=>{const{chatId:s,id:o,tabId:n=(0,u.g0)()}=a;return(0,A.xGf)(e,s,o,n)}),(0,w.aJ)("markMessagesTranslationPending",(e,t,a)=>{const{chatId:s,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=a;return o.forEach(t=>{e=(0,A.oeN)(e,s,t,n,{isPending:!0})}),e}),(0,w.aJ)("translateMessages",(e,t,a)=>{const{chatId:s,messageIds:o,toLanguageCode:n=(0,C.wmb)(e)}=a,i=(0,C.hds)(e,s);if(i)return t.markMessagesTranslationPending({chatId:s,messageIds:o,toLanguageCode:n}),(0,b.px)("translateText",{chat:i,messageIds:o,toLanguageCode:n}),e});let ce,le={};function ue(){ce&&(clearTimeout(ce),ce=void 0);const{loadMessageViews:e}=(0,w.ko)();Object.entries(le).forEach(([t,a])=>{e({chatId:t,ids:Array.from(a),shouldIncrement:!0})}),le={}}(0,w.aJ)("scheduleForViewsIncrement",(e,t,a)=>{const{ids:s,chatId:o}=a;ce||setTimeout(ue,1e3),le[o]||(le[o]=new Set),s.forEach(e=>{le[o].add(e)})}),(0,w.aJ)("loadMessageViews",async(e,t,a)=>{const{chatId:s,ids:o,shouldIncrement:n}=a;if((0,C.trm)(e))return;const i=(0,C.hds)(e,s);if(!i)return;const r=await(0,b.px)("fetchMessageViews",{chat:i,ids:o,shouldIncrement:n});r&&(e=(0,w.mS)(),r.viewsInfo.forEach(t=>{e=(0,A.r3y)(e,s,t.id,{viewsCount:t.views,forwardsCount:t.forwards},!0),t.threadInfo&&(e=(0,A.eAk)(e,s,t.id,t.threadInfo))}),(0,w.UF)(e))}),(0,w.aJ)("loadFactChecks",async(e,t,a)=>{const{chatId:s,ids:o}=a,n=(0,C.hds)(e,s);if(!n)return;const i=await(0,b.px)("fetchFactChecks",{chat:n,ids:o});i&&(e=(0,w.mS)(),i.forEach((t,a)=>{e=(0,A.r3y)(e,s,o[a],{factCheck:t})}),(0,w.UF)(e))}),(0,w.aJ)("loadPaidReactionPrivacy",()=>{(0,b.px)("fetchPaidReactionPrivacy")}),(0,w.aJ)("loadOutboxReadDate",async(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.hds)(e,s);if(n)try{const t=await(0,b.px)("fetchOutboxReadDate",{chat:n,messageId:o});t?.date&&(e=(0,w.mS)(),e=(0,A.r3y)(e,s,o,{readDate:t.date}),(0,w.UF)(e))}catch(t){const{message:a}=t;if("USER_PRIVACY_RESTRICTED"===a||"YOUR_PRIVACY_RESTRICTED"===a){if(e=(0,w.mS)(),!(0,C.mBe)(e,s))return;const t=(0,C.K0y)(e,s);if(!t)return;const n="USER_PRIVACY_RESTRICTED"===a?{isReadDateRestricted:!0}:{isReadDateRestrictedByMe:!0};e=(0,A.wWy)(e,{[s]:{...t,...n}}),e=(0,A.r3y)(e,s,o,{readDate:void 0}),(0,w.UF)(e)}}}),(0,w.aJ)("loadQuickReplies",async e=>{const t=await(0,b.px)("fetchQuickReplies");t&&(e=(0,w.mS)(),e=(0,A.tMr)(e,(0,h.dU)(t.messages,"id")),e=(0,A.xAV)(e,t.quickReplies),(0,w.UF)(e))}),(0,w.aJ)("sendQuickReply",(e,t,a)=>{const{chatId:s,quickReplyId:o}=a,n=(0,C.hds)(e,s);return n?((0,b.px)("sendQuickReply",{chat:n,shortcutId:o}),e):e}),(0,w.aJ)("copyMessageLink",async(e,t,a)=>{const{chatId:s,messageId:o,shouldIncludeThread:n,shouldIncludeGrouped:i,tabId:r=(0,u.g0)()}=a,d=(0,C.hds)(e,s);if(!d)return void t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});const l=()=>t.showNotification({message:(0,f.yE)("ErrorOccurred"),tabId:r});if(!(0,S.WX)(d)&&!(0,S.Vs)(d))return void l();const h=(0,b.px)("exportMessageLink",{chat:d,id:o,shouldIncludeThread:n,shouldIncludeGrouped:i});await(0,c.LD)(h,()=>t.showNotification({message:(0,f.yE)("LinkCopied"),tabId:r}),l)});const he=new Map;let me;function pe(e){const{shouldSendAsFile:t,mimeType:a}=e;return s.IH3.has(a)?"audio":t?"file":a===s.Vz3?"gif":s.gex.has(a)||s.fNs.has(a)?"media":e.voice?"voice":"file"}(0,w.aJ)("reportMessageDelivery",(e,t,a)=>{const{chatId:s,messageId:o}=a,n=he.get(s)||[];n.push(o),he.set(s,n),me||(me=window.setTimeout(()=>{me=void 0,he.forEach((t,a)=>{const s=(0,C.hds)(e,a);s&&(0,b.px)("reportMessagesDelivery",{chat:s,messageIds:t})}),he.clear()},500))}),(0,w.aJ)("openPreparedInlineMessageModal",async(e,t,a)=>{const{botId:s,messageId:o,webAppKey:n,tabId:i=(0,u.g0)()}=a,r=(0,C.mBe)(e,s);if(!r)return;const d=await(0,b.px)("fetchPreparedInlineMessage",{bot:r,id:o});d?(e=(0,w.mS)(),e=(0,M.w)(e,{preparedMessageModal:{message:d,webAppKey:n,botId:s}},i),(0,w.UF)(e)):t.sendWebAppEvent({webAppKey:n,event:{eventType:"prepared_message_failed",eventData:{error:"MESSAGE_EXPIRED"}},tabId:i})}),(0,w.aJ)("openSharePreparedMessageModal",(e,t,a)=>{const{webAppKey:s,message:o,tabId:n=(0,u.g0)()}=a,i=o.peerTypes?.filter(e=>"self"!==e);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{webAppKey:s,filter:i,message:o}},n),(0,w.UF)(e)});var ge=a(529),fe=a(64520);const Ie=(0,I.nF)(e=>e(),500,!1);async function ve(e,t){const a=await(0,b.px)("fetchRecentStickers",{hash:t});a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:a}},(0,w.UF)(e))}async function be(e,t,a){let s;try{s=await(0,b.px)("fetchStickers",{stickerSetInfo:a})}catch(s){if("STICKERSET_INVALID"===s.message)return void Object.values(e.byTabId).forEach(({id:s})=>{t.showNotification({message:(0,f.yE)("StickerPack.ErrorNotFound"),tabId:s}),"shortName"in a&&(0,C.nTw)(e,s).openedStickerSetShortName===a.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:void 0},s),(0,w.UF)(e))})}if(e=(0,w.mS)(),!s)return;const{set:o,stickers:n,packs:i}=s,r=(e=(0,A.v9P)(e,o.id,{...o,stickers:n,packs:i})).stickers.forEmoji.emoji;r&&i[r]&&(e=(0,A.PcY)(e)),(0,w.UF)(e)}async function Se(e,t,a,s,...[o=(0,u.g0)()]){const n=await(0,b.px)("searchGifs",{query:t,offset:s,username:a});n&&(e=(0,w.mS)(),e=(0,A.Mel)(e,!s,n.gifs,n.nextOffset,o),(0,w.UF)(e))}(0,w.aJ)("loadStickerSets",async(e,t)=>{const[a,s]=await Promise.all([(0,b.px)("fetchStickerSets",{hash:e.stickers.added.hash}),(0,b.px)("fetchCustomEmojiSets",{hash:e.customEmojis.added.hash})]);s&&a&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"added",a.hash,a.sets),e=(0,A.E24)(e,s.hash,s.sets),(0,w.UF)(e),t.loadCustomEmojis({ids:e.recentCustomEmojis}))}),(0,w.aJ)("loadAddedStickers",async(e,t)=>{const{added:{setIds:a=[]},setsById:s}=e.stickers,{added:{setIds:o=[]}}=e.customEmojis,n=[...a,...o];if(n.length)for(let e=0;e<n.length;e++){const a=n[e];s[a]?.stickers||(t.loadStickers({stickerSetInfo:{id:a,accessHash:s[a].accessHash}}),e%10==0&&e>0&&await(0,I.v7)(200))}}),(0,w.aJ)("loadRecentStickers",e=>{const{hash:t}=e.stickers.recent||{};ve(e,t)}),(0,w.aJ)("loadFavoriteStickers",async e=>{const{hash:t}=e.stickers.favorite||{},a=await(0,b.px)("fetchFavoriteStickers",{hash:t});a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:a}},(0,w.UF)(e))}),(0,w.aJ)("loadPremiumStickers",async e=>{const{hash:t}=e.stickers.premium||{};if((0,C.trm)(e))return;const a=await(0,b.px)("fetchStickersForEmoji",{emoji:"",hash:t});a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,premium:{hash:a.hash,stickers:a.stickers}}},(0,w.UF)(e))}),(0,w.aJ)("loadGreetingStickers",async e=>{const{hash:t}=e.stickers.greeting||{};if((0,C.trm)(e))return;const a=await(0,b.px)("fetchStickersForEmoji",{emoji:"",hash:t});a&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,greeting:{hash:a.hash,stickers:a.stickers.filter(e=>""===e.emoji)}}},(0,w.UF)(e))}),(0,w.aJ)("loadFeaturedStickers",async e=>{const{hash:t}=e.stickers.featured||{},a=await(0,b.px)("fetchFeaturedStickers",{hash:t});a&&(e=(0,w.mS)(),e=(0,A.MkE)(e,"featured",a.hash,a.sets),(0,w.UF)(e))}),(0,w.aJ)("loadPremiumGifts",async e=>{const t=await(0,b.px)("fetchPremiumGifts");if(!t)return;const{set:a,stickers:s}=t;e=(0,w.mS)(),e={...e,premiumGifts:{...a,stickers:s}},(0,w.UF)(e)}),(0,w.aJ)("loadTonGifts",async e=>{const t=await(0,b.px)("fetchTonGifts");if(!t)return;const{set:a,stickers:s}=t;e=(0,w.mS)(),e={...e,tonGifts:{...a,stickers:s}},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultTopicIcons",async e=>{const t=await(0,b.px)("fetchDefaultTopicIcons");if(!t)return;e=(0,w.mS)();const{set:a,stickers:s}=t,o={...a,stickers:s};e=(0,A.v9P)(e,o.id,o),e={...e,defaultTopicIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadDefaultStatusIcons",async e=>{const t=await(0,b.px)("fetchDefaultStatusEmojis");if(!t)return;e=(0,w.mS)();const{set:a,stickers:s}=t,o={...a,stickers:s};e=(0,A.v9P)(e,o.id,o),e={...e,defaultStatusIconsId:o.id},(0,w.UF)(e)}),(0,w.aJ)("loadUserCollectibleStatuses",async(e,t)=>{(0,w.UF)(e);const{hash:a}=e.collectibleEmojiStatuses||{},s=await(0,b.px)("fetchCollectibleEmojiStatuses",{hash:a});if(!s)return;e=(0,w.mS)(),e={...e,collectibleEmojiStatuses:{hash:s.hash,statuses:s.statuses}},(0,w.UF)(e);const o=s.statuses.map(({documentId:e})=>e);t.loadCustomEmojis({ids:o})}),(0,w.aJ)("loadStickers",(e,t,a)=>{const{stickerSetInfo:s}=a,o=(0,C.ycM)(e,s);o&&o.count===o?.stickers?.length||be(e,t,s)}),(0,w.aJ)("loadAnimatedEmojis",async e=>{const[t,a]=await Promise.all([(0,b.px)("fetchAnimatedEmojis"),(0,b.px)("fetchAnimatedEmojiEffects")]);t&&a&&(e=(0,w.mS)(),e=(0,A.$nQ)(e,{...t.set,stickers:t.stickers}),e={...e,animatedEmojiEffects:{...a.set,stickers:a.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadBirthdayNumbersStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:s.OVC}});t&&(e=(0,w.mS)(),e={...e,birthdayNumbers:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadRestrictedEmojiStickers",async e=>{const t=await(0,b.px)("fetchStickers",{stickerSetInfo:{shortName:s.Kh8}});t&&(e=(0,w.mS)(),e={...e,restrictedEmoji:{...t.set,stickers:t.stickers}},(0,w.UF)(e))}),(0,w.aJ)("loadGenericEmojiEffects",async e=>{const t=await(0,b.px)("fetchGenericEmojiEffects");if(!t)return;e=(0,w.mS)();const{set:a,stickers:s}=t;e={...e,genericEmojiEffects:{...a,stickers:s}},(0,w.UF)(e)}),(0,w.aJ)("loadSavedGifs",async e=>{const{hash:t}=e.gifs.saved,a=await(0,b.px)("fetchSavedGifs",{hash:t});a&&(e=(0,w.mS)(),e={...e,gifs:{...e.gifs,saved:a}},(0,w.UF)(e))}),(0,w.aJ)("saveGif",async(e,t,a)=>{const{gif:s,shouldUnsave:o,tabId:n=(0,u.g0)()}=a,i=e.gifs.saved.gifs?.length,r=(0,fe.d)(e,"savedGifs"),d=(0,fe.B)(e,"savedGifs"),c=(0,C.g29)(e);if(!o&&i&&i>=r&&t.showNotification({title:f.yE("LimitReachedFavoriteGifs",r.toString()),message:c?f.yE("LimitReachedFavoriteGifsSubtitlePremium"):f.yE("LimitReachedFavoriteGifsSubtitle",d.toString()),...!c&&{action:{action:"openPremiumModal",payload:{tabId:n}}},className:"bold-link",tabId:n}),!await(0,b.px)("saveGif",{gif:s,shouldUnsave:o}))return;e=(0,w.mS)();const l=e.gifs.saved.gifs?.filter(({id:e})=>e!==s.id)||[],h=o?l:[s,...l];e={...e,gifs:{...e.gifs,saved:{...e.gifs.saved,gifs:h}}},(0,w.UF)(e)}),(0,w.aJ)("faveSticker",(e,t,a)=>{const{sticker:s,tabId:o=(0,u.g0)()}=a,n=e.stickers.favorite.stickers.length,i=(0,fe.d)(e,"stickersFaved"),r=(0,fe.B)(e,"stickersFaved"),d=(0,C.g29)(e);n>=i&&t.showNotification({title:f.yE("LimitReachedFavoriteStickers",i.toString()),message:d?f.yE("LimitReachedFavoriteStickersSubtitlePremium"):f.yE("LimitReachedFavoriteStickersSubtitle",r.toString()),...!d&&{action:{action:"openPremiumModal",payload:{tabId:o}}},className:"bold-link",tabId:o}),s&&(0,b.px)("faveSticker",{sticker:s})}),(0,w.aJ)("unfaveSticker",(e,t,a)=>{const{sticker:s}=a;s&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,favorite:{...e.stickers.favorite,stickers:e.stickers.favorite.stickers.filter(({id:e})=>e!==s.id)}}},(0,w.UF)(e),(0,b.px)("faveSticker",{sticker:s,unfave:!0}))}),(0,w.aJ)("removeRecentSticker",async(e,t,a)=>{const{sticker:s}=a;await(0,b.px)("removeRecentSticker",{sticker:s})&&ve((0,w.mS)())}),(0,w.aJ)("clearRecentStickers",async e=>{await(0,b.px)("clearRecentStickers")&&(e=(0,w.mS)(),e={...e,stickers:{...e.stickers,recent:{stickers:[]}}},(0,w.UF)(e))}),(0,w.aJ)("toggleStickerSet",(e,t,a)=>{const{stickerSetId:s}=a,o=(0,C.ycM)(e,s);if(!o)return;const{accessHash:n,installedDate:i,isArchived:r}=o,d=!r&&Boolean(i);(0,b.px)(d?"uninstallStickerSet":"installStickerSet",{stickerSetId:s,accessHash:n})}),(0,w.aJ)("loadEmojiKeywords",async(e,t,a)=>{const{language:s}=a;let o=e.emojiKeywords[s];if(o?.isLoading)return;e={...e,emojiKeywords:{...e.emojiKeywords,[s]:{...o,isLoading:!0}}},(0,w.UF)(e);const n=await(0,b.px)("fetchEmojiKeywords",{language:s,fromVersion:o?o.version:0});if(o=(e=(0,w.mS)()).emojiKeywords[s],!n)return e={...e,emojiKeywords:{...e.emojiKeywords,[s]:{...o,isLoading:!1}}},void(0,w.UF)(e);e={...e,emojiKeywords:{...e.emojiKeywords,[s]:{isLoading:!1,version:n.version,keywords:{...o?.keywords,...n.keywords}}}},(0,w.UF)(e)}),(0,w.aJ)("setStickerSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;s&&Ie(async()=>{const t=await(0,b.px)("searchStickers",{query:s});if(!t)return;e=(0,w.mS)();const{setsById:a,added:n}=e.stickers,i=t.sets.map(({id:e})=>e);n.setIds&&n.setIds.forEach(e=>{if(!i.includes(e)){const{title:t}=a[e]||{};t&&(0,ge.A)(t,s)&&i.unshift(e)}}),e=(0,A.MkE)(e,"search",t.hash,t.sets),e=(0,A.bG)(e,t.hash,i,o),(0,w.UF)(e)})}),(0,w.aJ)("setGifSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;"string"==typeof s&&Ie(()=>{Se(e=(0,w.mS)(),s,e.config?.gifSearchUsername,void 0,o)})}),(0,w.aJ)("searchMoreGifs",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{query:o,offset:n}=(0,C.nTw)(e,s).gifSearch;"string"==typeof o&&Ie(()=>{Se(e=(0,w.mS)(),o,e.config?.gifSearchUsername,n,s)})}),(0,w.aJ)("loadStickersForEmoji",(e,t,a)=>{const{emoji:s}=a,{hash:o}=e.stickers.forEmoji;Ie(async()=>{e=(0,w.mS)(),e={...e,stickers:{...e.stickers,forEmoji:{...e.stickers.forEmoji,emoji:s}}},(0,w.UF)(e);const t=await(0,b.px)("fetchStickersForEmoji",{emoji:s,hash:o});e=(0,w.mS)(),t&&e.stickers.forEmoji.emoji===s&&(e=(0,A.f_N)(e,s,t.stickers,t.hash),(0,w.UF)(e))})}),(0,w.aJ)("clearStickersForEmoji",e=>({...e,stickers:{...e.stickers,forEmoji:{}}})),(0,w.aJ)("loadCustomEmojiForEmoji",(e,t,a)=>{const{emoji:s}=a;return(0,A.G4z)(e,s)}),(0,w.aJ)("clearCustomEmojiForEmoji",e=>({...e,customEmojis:{...e.customEmojis,forEmoji:{}}})),(0,w.aJ)("loadFeaturedEmojiStickers",async e=>{const t=await(0,b.px)("fetchFeaturedEmojiStickers",{});t&&(e=(0,w.mS)(),e={...e,customEmojis:{...e.customEmojis,featuredIds:t.sets.map(({id:e})=>e),byId:{...e.customEmojis.byId,...(0,h.dU)(t.sets.flatMap(e=>e.stickers||[]),"id")}},stickers:{...e.stickers,setsById:{...e.stickers.setsById,...(0,h.dU)(t.sets,"id")}}},(0,w.UF)(e))}),(0,w.aJ)("openStickerSet",async(e,t,a)=>{const{stickerSetInfo:s,shouldIgnoreCache:o,tabId:n=(0,u.g0)()}=a;!o&&(0,C.ycM)(e,s)||await be(e,t,s),e=(0,w.mS)();const i=(0,C.ycM)(e,s);i?.shortName&&(e=(0,M.w)(e,{openedStickerSetShortName:i.shortName},n),(0,w.UF)(e))}),(0,w.aJ)("loadRecentEmojiStatuses",async e=>{const t=await(0,b.px)("fetchRecentEmojiStatuses");t&&(e=(0,w.mS)(),e=(0,A.T3R)(e,t.hash,t.emojiStatuses),(0,w.UF)(e))});var ye=a(17663),we=a(62214);const Ae=(0,I.nF)(e=>e(),500,!1);async function Me(e,t,a){if(!(0,we.YE)(t)&&!(0,we.WX)(t))return;const s=(0,C.O5q)(e,t.id,a);if(s)return s;const o=await(0,b.px)("fetchMessage",{chat:t,messageId:a});return"MESSAGE_DELETED"===o?void 0:o?.message}(0,w.aJ)("setGlobalSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a,{chatId:n}=(0,C.nTw)(e,o).globalSearch;s&&!n&&Ae(async()=>{const[t,a]=await Promise.all([(0,b.px)("searchChats",{query:s}),(0,b.px)("fetchSponsoredPeer",{query:s})]);e=(0,w.mS)();const n=(0,C.xT4)(e,o);if(!t||!n||s!==n)return e=(0,A.RgT)(e,{chats:!1},o),void(0,w.UF)(e);const{accountResultIds:i,globalResultIds:r}=t;e=(0,A.RgT)(e,{chats:!1},o),e=(0,A.b8O)(e,{localResults:{peerIds:i},globalResults:{...(0,C.nTw)(e,o).globalSearch.globalResults,peerIds:r},sponsoredPeer:a},o),(0,w.UF)(e)})}),(0,w.aJ)("setGlobalSearchDate",(e,t,a)=>{const{date:s,tabId:o=(0,u.g0)()}=a,n=s?(0,ye.TI)(s):s;e=(0,A.b8O)(e,{minDate:s,maxDate:n,query:"",resultsByType:{...(0,C.nTw)(e,o).globalSearch.resultsByType,text:{totalCount:void 0,foundIds:[],nextOffsetId:0}}},o),(0,w.UF)(e),t.searchMessagesGlobal({type:"text",tabId:o})}),(0,w.aJ)("searchMessagesGlobal",(e,t,a)=>{const{type:o,context:n,shouldResetResultsByType:i,shouldCheckFetchingMessagesStatus:r,tabId:d=(0,u.g0)()}=a;r&&(e=(0,A.RgT)(e,{messages:!0},d),(0,w.UF)(e),e=(0,w.mS)());const{query:c,resultsByType:h,chatId:m}=(0,C.nTw)(e,d).globalSearch,{totalCount:f,foundIds:I,nextOffsetId:v,nextOffsetPeerId:S,nextOffsetRate:M}=!i&&h?.[o]||{};if(void 0!==f&&(!f||I&&I.length>=f))return;const P=m?(0,C.PVB)(e,m):void 0;!async function(e,t){const{query:a="",type:o,context:n,offsetRate:i,offsetId:r,offsetPeer:d,peer:c,maxDate:h,minDate:m,shouldResetResultsByType:f,tabId:I=(0,u.g0)()}=t;let v,S;"publicPosts"===o&&(e=(0,A.RgT)(e,{publicPosts:!0},I),(0,w.UF)(e));const M=(0,C.nTw)(e,I).globalSearch.searchFlood;if(c){const e=(0,b.px)("searchMessagesInChat",{peer:c,query:a,type:o,limit:s.wAs,offsetId:r,minDate:m,maxDate:h}),t=(0,y.vj)(c)&&c.isForum?(0,b.px)("fetchTopics",{chat:c,query:a,limit:s.mH$}):void 0,[n,i]=await Promise.all([e,t]);if(n){const{messages:e,totalCount:t,nextOffsetId:a}=n,{topics:s,count:o}=i||{};v={topics:s,totalTopicsCount:o,messages:e,totalCount:t,nextOffsetId:a}}}else if(v=await(0,b.px)("searchMessagesGlobal",{query:a,offsetRate:i,offsetId:r,offsetPeer:d,limit:s.wAs,type:o,context:n,maxDate:h,minDate:m}),(0,l.zq)(a)){const t=(0,l.vG)(a);"publicMessageLink"===t?.type?S=await async function(e,t){const{username:a,messageId:s}=t,o=(0,C.qn$)(e,a);if(o)return Me(e,o,s);const{chat:n}=await(0,b.px)("getChatByUsername",a)??{};return n?Me(e,n,s):void 0}(e,t):"privateMessageLink"===t?.type&&(S=await function(e,t){const{channelId:a,messageId:s}=t,o=(0,k.QE)(a),n=(0,C.hds)(e,o);if(n)return Me(e,n,s)}(e,t))}e=(0,w.mS)(),f&&(e=(0,A.b8O)(e,{resultsByType:{...((0,C.nTw)(e,I).globalSearch||{}).resultsByType,[o]:void 0}},I));const P=(0,C.xT4)(e,I);if(!v||""!==a&&a!==P)return e=(0,A.RgT)(e,{messages:!1,publicPosts:!1},I),void(0,w.UF)(e);S&&(v.totalCount=v.messages.unshift(S));const{messages:T,userStatusesById:F,totalCount:B,nextOffsetRate:U,nextOffsetId:x,nextOffsetPeerId:N}=v,R=v.searchFlood||M;F&&(e=(0,A.d2X)(e,F)),T.length&&(e=(0,A.KcS)(e,T)),e=(0,A.HyB)(e,T,B,o,U,x,N,R,I),v.topics&&(e=(0,A.mIA)(e,c.id,v.totalTopicsCount,v.topics));const J=v.topics?.map(({id:e})=>e).sort((e,t)=>t-e);if(e=(0,A.b8O)(e,{foundTopicIds:J},I),(0,w.UF)(e),"publicPosts"===o&&R&&!R.queryIsFree&&!r&&0===M?.remains){const e=(0,p.Yw)();(0,w.ko)().showNotification({icon:"star",message:{key:"NotificationPaidExtraSearch",variables:{stars:(0,g.Kk)(e,R.starsAmount)}}})}}(e,{query:c,type:o,context:n,shouldResetResultsByType:i,offsetRate:M,offsetId:v,offsetPeer:S?(0,C.PVB)(e,S):void 0,peer:P,tabId:d})}),(0,w.aJ)("searchPopularBotApps",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).globalSearch.popularBotApps,n=o?.nextOffset;if(o?.peerIds&&!n)return;e=(0,A.RgT)(e,{botApps:!0},s),(0,w.UF)(e);const i=await(0,b.px)("fetchPopularAppBots",{offset:n});if(e=(0,w.mS)(),!i)return e=(0,A.RgT)(e,{botApps:!1},s),void(0,w.UF)(e);e=(0,A.b8O)(e,{popularBotApps:{peerIds:[...o?.peerIds||[],...i.peerIds],nextOffset:i.nextOffset}},s),e=(0,A.RgT)(e,{botApps:!1},s),(0,w.UF)(e)}),(0,w.aJ)("checkSearchPostsFlood",async(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("checkSearchPostsFlood",s);e=(0,w.mS)(),n&&(e=(0,A.b8O)(e,{searchFlood:n},o),(0,w.UF)(e))});var Ce=a(57309);async function Pe(e,t,a,o,n,i=!1,r,...[d=(0,u.g0)()]){const c=r?e.currentUserId:t.id,l=await(0,b.px)("searchMessagesInChat",{peer:t,type:o,limit:2*s.Um,threadId:a,offsetId:n,isSavedDialog:r});if(!l)return;const{userStatusesById:m,messages:p,totalCount:g,nextOffsetId:f}=l,I=(0,h.dU)(p,"id"),v=Object.keys(I).map(Number);e=(0,w.mS)(),(0,C.BU_)(e,d)&&(e=(0,A.d2X)(e,m),e=(0,A.o4A)(e,c,I),e=(0,A.jU1)(e,c,a,o,v,g,f,d),(0,w.UF)(e),i||Pe(e,t,a,o,f,!0,r,d))}(0,w.aJ)("performMiddleSearch",async(e,t,a)=>{const{query:o,chatId:i,threadId:r=n.l3,tabId:d=(0,u.g0)()}=a||{};if(!i)return;const c=e.currentUserId,l=(0,S.cG)(i,r,c),h=l?String(r):i,m=h?(0,C.PVB)(e,h):void 0;let p=(0,C.TCk)(e,d);if(!m)return;p||(e=(0,A.$RI)(e,h,r,{},d),(0,w.UF)(e),e=(0,w.mS)()),p=(0,C.TCk)(e,d);const{results:g,savedTag:f,type:I,isHashtag:v}=p,y=g?.query===o,M=y?g?.nextOffsetId:void 0,P=y?g?.nextOffsetRate:void 0,k=y?g?.nextOffsetPeerId:void 0,T=y&&k?(0,C.hds)(e,k):void 0;if((v||!f)&&!o)return e=(0,A.$RI)(e,h,r,{fetchingQuery:void 0},d),void(0,w.UF)(e);let F;if(e=(0,A.$RI)(e,h,r,{fetchingQuery:o},d),(0,w.UF)(e),"chat"===I&&(F=await(0,b.px)("searchMessagesInChat",{peer:m,type:"text",query:v?`#${o}`:o,threadId:r,limit:s.gXr,offsetId:M,isSavedDialog:l,savedTag:f})),"myChats"===I&&(F=await(0,b.px)("searchMessagesGlobal",{type:"text",query:v?`#${o}`:o,limit:s.gXr,offsetId:M,offsetRate:P,offsetPeer:T})),"channels"===I&&(F=await(0,b.px)("searchPublicPosts",{hashtag:o,limit:s.gXr,offsetId:M,offsetPeer:T,offsetRate:P})),!F)return;const{userStatusesById:B,messages:U,totalCount:x,nextOffsetId:N,nextOffsetRate:R,nextOffsetPeerId:J}=F,Y=U.map(Ce.D);e=(0,w.mS)(),p=(0,C.TCk)(e,d);const E=p?.savedTag&&!(0,S.a0)(f,p.savedTag);if(!p||p?.fetchingQuery!==o||E)return;const D=l?c:m.id;e=(0,A.d2X)(e,B),e=(0,A.KcS)(e,U),e=(0,A.$RI)(e,D,r,{fetchingQuery:void 0},d),e=(0,A.VmW)(e,D,r,{foundIds:Y,totalCount:x,nextOffsetId:N,nextOffsetRate:R,nextOffsetPeerId:J,query:o||""},d),(0,w.UF)(e)}),(0,w.aJ)("searchHashtag",(e,t,a)=>{const{hashtag:s,tabId:o=(0,u.g0)()}=a,n=(0,C.Xf0)(e,o);if(!n)return;const i=s.replace(/^#/,"");t.updateMiddleSearch({chatId:n.chatId,threadId:n.threadId,update:{isHashtag:!0,requestedQuery:i},tabId:o})}),(0,w.aJ)("searchSharedMediaMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,s)||{};if(!o||!n)return;const i=(0,S.cG)(o,n,e.currentUserId),r=i?String(n):o,d=(0,C.PVB)(e,r),c=(0,C.BU_)(e,s);if(!d||!c)return;const{currentType:l,resultsByType:h}=c,m=l&&h&&h[l],p=m?.nextOffsetId;l&&Pe(e,d,n,l,p,void 0,i,s)}),(0,w.aJ)("searchChatMediaMessages",(e,t,a)=>{const{chatId:o,threadId:n,currentMediaMessageId:r,limit:d,direction:c,tabId:l=(0,u.g0)()}=a;if(!o||!n||!r)return;const m=(0,S.cG)(o,n,e.currentUserId),p=m?String(n):o,g=(0,C.hds)(e,p);if(!g)return;let f=(0,C.CuV)(e,l);if(!f){if(e=(0,A.tXQ)(e,o,n,l),(0,w.UF)(e),f=(0,C.CuV)(e,l),!f)return;e=(0,w.mS)()}!async function(e,t,a,o,n,r,d,c=s.laV,...[l=(0,u.g0)()]){const{isSynced:m}=e;if(!m||n.isLoading)return;let p=function(e,t){if((0,h.OX)(t,e.currentSegment.foundIds))return e.currentSegment;const a=e.segments.findIndex(e=>(0,h.OX)(t,e.foundIds));if(-1===a)return void(e.currentSegment&&e.currentSegment.foundIds.length&&e.segments.push(e.currentSegment));const s=e.segments.splice(a,1)[0];return e.segments.push(e.currentSegment),s}(n,o);if(void 0===r&&(r=function(e,t){if(!t)return i.TN.Around;const a=t.foundIds.length,s=t.foundIds.indexOf(e);if(-1===s)return i.TN.Around;if(t.loadingState.areAllItemsLoadedBackwards&&t.loadingState.areAllItemsLoadedForwards)return;const o=9>Math.floor(a/2)?0:9,n=a-1;if(s<=o){if(t.loadingState.areAllItemsLoadedBackwards)return;return i.TN.Backwards}if(s>=n-o){if(t.loadingState.areAllItemsLoadedForwards)return;return i.TN.Forwards}}(o,p)),void 0===r)return;const g=function(e,t,a){return a?e===i.TN.Backwards?a.foundIds[0]:e===i.TN.Forwards?a.foundIds[a.foundIds.length-1]:t:t}(r,o,p),f=function(e,t){return e===i.TN.Backwards?0:e===i.TN.Forwards?-(t+1):-(Math.round(t/2)+1)}(r,c),I=d?e.currentUserId:t.id;e=(0,A.lwK)(e,I,a,!0,l),(0,w.UF)(e);const v=await(0,b.px)("searchMessagesInChat",{peer:t,type:"media",limit:c,threadId:a,offsetId:g,isSavedDialog:d,addOffset:f});if(e=(0,w.mS)(),!v)return e=(0,A.lwK)(e,I,a,!1,l),void(0,w.UF)(e);const{messages:y,userStatusesById:M}=v,C=(0,h.dU)(y,"id"),P=Object.keys(C).map(Number);e=(0,A.d2X)(e,M),e=(0,A.o4A)(e,I,C);const k=function(e,t,a,s){let o=Boolean(s?.loadingState.areAllItemsLoadedForwards),n=Boolean(s?.loadingState.areAllItemsLoadedBackwards);return a<t&&(e===i.TN.Forwards?o=!0:e===i.TN.Backwards&&(n=!0)),{areAllItemsLoadedForwards:o,areAllItemsLoadedBackwards:n}}(r,c,P.length,p),T=(0,S.lH)(C,P,"media");p=(0,A.olz)(T,k,p),e=(0,A.Qb2)(e,I,a,p,n,l),e=(0,A.lwK)(e,I,a,!1,l),(0,w.UF)(e)}(e,g,n,r,f,c,m,d,l)}),(0,w.aJ)("searchMessagesByDate",async(e,t,a)=>{const{timestamp:s,tabId:o=(0,u.g0)()}=a,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.hds)(e,n);if(!i)return;const r=await(0,b.px)("findFirstMessageIdAfterDate",{chat:i,timestamp:s});r&&t.focusMessage({chatId:i.id,messageId:r,tabId:o})}),(0,w.aJ)("checkPublicLink",async(e,t,a)=>{const{username:s,tabId:o=(0,u.g0)()}=a,{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;if((0,C.nTw)(e,o).management.progress===i.TD.InProgress)return;e=(0,A.H6X)(e,n,{isUsernameAvailable:void 0,checkedUsername:void 0},o),(0,w.UF)(e);const{result:r,error:d}=await(0,b.px)("checkChatUsername",{username:s});e=(0,w.mS)(),e=(0,A.G42)(e,!0===r?i.TD.Complete:i.TD.Error,o),e=(0,A.H6X)(e,n,{isUsernameAvailable:!0===r,checkedUsername:s,error:d},o),(0,w.UF)(e),void 0===r&&t.openLimitReachedModal({limit:"channelsPublic",tabId:o})}),(0,w.aJ)("updatePublicLink",async(e,t,a)=>{const{username:s,shouldDisableUsernames:n,tabId:r=(0,u.g0)()}=a,{chatId:d}=(0,C.Xf0)(e,r)||{};if(!d)return;const c=await(0,o.Jm)(e,t,d,r);if(!c)return;e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e);const l=await(0,b.px)("setChatUsername",{chat:c,username:s});n&&await(0,b.px)("deactivateAllUsernames",{chat:c}),e=(0,w.mS)(),e=(0,A.G42)(e,l?i.TD.Complete:i.TD.Error,r),e=(0,A.H6X)(e,c.id,{isUsernameAvailable:void 0,checkedUsername:void 0,error:void 0},r),(0,w.UF)(e)}),(0,w.aJ)("updatePrivateLink",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o}=(0,C.Xf0)(e,s)||{},n=o&&(0,C.hds)(e,o);o&&n&&(0,b.px)("updatePrivateLink",{chat:n})}),(0,w.aJ)("setEditingExportedInvite",(e,t,a)=>{const{chatId:s,invite:o,tabId:n=(0,u.g0)()}=a;e=(0,A.H6X)(e,s,{editingInvite:o},n),(0,w.UF)(e)}),(0,w.aJ)("setOpenedInviteInfo",(e,t,a)=>{const{chatId:s,invite:o,tabId:n=(0,u.g0)()}=a,i=o?{inviteInfo:{invite:o}}:{inviteInfo:void 0};e=(0,A.H6X)(e,s,i,n),(0,w.UF)(e)}),(0,w.aJ)("loadExportedChatInvites",async(e,t,a)=>{if((0,C.trm)(e))return;const{chatId:s,adminId:o,isRevoked:n,limit:i,tabId:r=(0,u.g0)()}=a,d=(0,C.hds)(e,s),c=(0,C.mBe)(e,o||e.currentUserId);if(!d||!c)return;const l=await(0,b.px)("fetchExportedChatInvites",{peer:d,admin:c,isRevoked:n,limit:i});if(!l)return;e=(0,w.mS)();const{invites:h}=l,m=n?{revokedInvites:h}:{invites:h};e=(0,A.H6X)(e,s,m,r),(0,w.UF)(e)}),(0,w.aJ)("editExportedChatInvite",async(e,t,a)=>{const{chatId:s,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c,tabId:l=(0,u.g0)()}=a,h=(0,C.hds)(e,s);if(!h)return;const m=await(0,b.px)("editExportedChatInvite",{peer:h,link:o,isRevoked:n,expireDate:i,usageLimit:r,isRequestNeeded:d,title:c});if(!m)return;const{oldInvite:p,newInvite:g}=m;e=(0,w.mS)();const{management:f}=(0,C.nTw)(e,l),I=(f.byChatId[s].invites||[]).filter(e=>e.link!==p.link),v=[...f.byChatId[s].revokedInvites||[]];g.isRevoked?v.unshift(g):I.push(g),e=(0,A.H6X)(e,s,{invites:I,revokedInvites:v},l),(0,w.UF)(e)}),(0,w.aJ)("exportChatInvite",async(e,t,a)=>{const{chatId:s,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r,tabId:d=(0,u.g0)()}=a,c=(0,C.hds)(e,s);if(!c)return;const l=await(0,b.px)("exportChatInvite",{peer:c,expireDate:o,usageLimit:n,isRequestNeeded:i,title:r});if(!l)return;e=(0,w.mS)();const h=(0,C.nTw)(e,d).management.byChatId[s].invites||[];e=(0,A.H6X)(e,s,{invites:[...h,l]},d),(0,w.UF)(e)}),(0,w.aJ)("deleteExportedChatInvite",async(e,t,a)=>{const{chatId:s,link:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s);if(!i)return;if(!await(0,b.px)("deleteExportedChatInvite",{peer:i,link:o}))return;e=(0,w.mS)();const r=(0,C.nTw)(e,n).management.byChatId[s];e=(0,A.H6X)(e,s,{invites:r?.invites?.filter(e=>e.link!==o),revokedInvites:r?.revokedInvites?.filter(e=>e.link!==o)},n),(0,w.UF)(e)}),(0,w.aJ)("deleteRevokedExportedChatInvites",async(e,t,a)=>{const{chatId:s,adminId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.mBe)(e,o||e.currentUserId);i&&r&&await(0,b.px)("deleteRevokedExportedChatInvites",{peer:i,admin:r})&&(e=(0,w.mS)(),e=(0,A.H6X)(e,s,{revokedInvites:[]},n),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteImporters",async(e,t,a)=>{const{chatId:s,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=a,c=(0,C.hds)(e,s),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r});if(!h)return;const{importers:m}=h;e=(0,w.mS)();const p=(0,C.nTw)(e,d).management.byChatId[s]?.inviteInfo;p?.invite&&p.invite.link===o&&(e=(0,A.H6X)(e,s,{inviteInfo:{...p,importers:m}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatInviteRequesters",async(e,t,a)=>{const{chatId:s,link:o,offsetDate:n,offsetUserId:i,limit:r,tabId:d=(0,u.g0)()}=a,c=(0,C.hds)(e,s),l=i?(0,C.mBe)(e,i):void 0;if(!c||i&&!l)return;const h=await(0,b.px)("fetchChatInviteImporters",{peer:c,link:o,offsetDate:n,offsetUser:l,limit:r,isRequested:!0});if(!h)return;const{importers:m}=h;e=(0,w.mS)();const p=(0,C.nTw)(e,d).management.byChatId[s]?.inviteInfo;p?.invite&&p.invite.link===o&&(e=(0,A.H6X)(e,s,{inviteInfo:{...p,requesters:m}},d),(0,w.UF)(e))}),(0,w.aJ)("loadChatJoinRequests",async(e,t,a)=>{const{chatId:s,offsetDate:o=0,offsetUserId:n,limit:i=0}=a,r=(0,C.hds)(e,s),d=n?(0,C.mBe)(e,n):void 0;if(!r||n&&!d)return;const c=await(0,b.px)("fetchChatInviteImporters",{peer:r,offsetDate:o,offsetUser:d,limit:i,isRequested:!0});if(!c)return;const{importers:l}=c;e=(0,w.mS)(),e=(0,A.wix)(e,s,{joinRequests:l}),(0,w.UF)(e)}),(0,w.aJ)("hideChatJoinRequest",async(e,t,a)=>{const{chatId:s,userId:o,isApproved:n}=a,i=(0,C.hds)(e,s),r=(0,C.mBe)(e,o);if(!i||!r)return;if(!await(0,b.px)("hideChatJoinRequest",{peer:i,user:r,isApproved:n}))return;e=(0,w.mS)();const d=(0,C.hds)(e,s);d&&(e=(0,A.wix)(e,s,{joinRequests:d.joinRequests?.filter(e=>e.userId!==o)}),(0,w.UF)(e))}),(0,w.aJ)("hideAllChatJoinRequests",async(e,t,a)=>{const{chatId:s,isApproved:o,link:n}=a,i=(0,C.hds)(e,s);i&&await(0,b.px)("hideAllChatJoinRequests",{peer:i,isApproved:o,link:n})&&(e=(0,w.mS)(),(0,C.hds)(e,s)&&(e=(0,A.wix)(e,s,{joinRequests:[]}),e=(0,A.ltr)(e,s,{recentRequesterIds:[],requestsPending:0}),(0,w.UF)(e)))}),(0,w.aJ)("hidePeerSettingsBar",async(e,t,a)=>{const{peerId:s}=a,o=(0,C.mBe)(e,s);o&&await(0,b.px)("hidePeerSettingsBar",o)&&(e=(0,w.mS)(),e=(0,A.weB)(e,s,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("uploadContactProfilePhoto",async(e,t,a)=>{const{userId:s,file:o,isSuggest:n,tabId:r=(0,u.g0)()}=a,d=(0,C.mBe)(e,s);if(!d)return;if(e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),!await(0,b.px)("uploadContactProfilePhoto",{user:d,file:o,isSuggest:n}))return e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Error,r),void(0,w.UF)(e);e=(0,w.mS)(),(0,w.UF)(e);const{id:c,accessHash:l}=d;if(!await(0,b.px)("fetchFullUser",{id:c,accessHash:l}))return e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Error,r),void(0,w.UF)(e);t.loadMoreProfilePhotos({peerId:s,shouldInvalidateCache:!0}),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,r),(0,w.UF)(e),o&&!n&&t.showNotification({message:f.yE("UserInfo.SetCustomPhoto.SuccessPhotoText",(0,S.u0)(d)),tabId:r})}),(0,w.aJ)("resetManagementError",(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a||{};return(0,A.H6X)(e,s,{error:void 0},o)});var ke=a(37932),Te=a(49763);let Fe,Be;function Ue(e,t,a){const o=e.currentUserId,n=(0,S.cG)(t,a,o),i=n?String(a):t,r=(0,C.hds)(e,i);return(0,b.px)("fetchMessages",{chat:r,threadId:a,offsetId:n?void 0:r.lastReadInboxMessageId,addOffset:-(Math.round(s.yo2/2)+1),limit:s.yo2,isSavedDialog:n})}(0,w.aJ)("sync",(e,t)=>{s.Oig&&console.log(">>> START SYNC"),Fe&&clearTimeout(Fe),e=(0,w.mS)(),e={...e,isSyncing:!0},(0,w.UF)(e),Fe=window.setTimeout(()=>{e=(0,w.mS)(),e={...e,isSyncing:!1},(0,w.UF)(e),Fe=void 0},15e3);const{loadAllChats:a,preloadTopChatMessages:o}=t;(0,Te.Ts)(),a({listType:"active",whenFirstBatchDone:async()=>{await async function(e,t){let a=!1;e=(0,w.mS)();let o=!1;const i=Object.keys(e.messages.byChatId).reduce((t,a)=>(t[a]=Object.keys(e.messages.byChatId[a].threadsById).reduce((t,s)=>(t[Number(s)]=(0,h.Oy)({draft:(0,C.GA4)(e,a,Number(s)),editingId:(0,C.Ys6)(e,a,Number(s)),editingDraft:(0,C.U0A)(e,a,Number(s))}),t),{}),t),{}),r=Object.entries(e.chats.lastMessageIds.all||{}).map(([t,a])=>(0,C.O5q)(e,t,Number(a))).filter(Boolean),d=Object.values(e.chats.lastMessageIds.saved||{}).map(t=>(0,C.O5q)(e,e.currentUserId,Number(t))).filter(Boolean),c=[];r.forEach(t=>{const a=(0,C.Vw0)(e,t.chatId,t.id);a&&c.push({chatId:t.chatId,messageId:t.id,threadInfo:a})});for(const{id:i}of Object.values(e.byTabId)){e=(0,w.mS)();const{chatId:r,threadId:d}=(0,C.Xf0)(e,i)||{},c=d||n.l3,l=r&&d?(0,C.Vw0)(e,r,d):void 0,u=r?e.chats.byId[r]:void 0;if(r&&u){const[t,d]=await Promise.all([Ue(e,r,c),c===n.l3||u.isForum||(0,S.cG)(u.id,c,e.currentUserId)?void 0:(0,b.px)("fetchDiscussionMessage",{chat:u,messageId:Number(c)})]);e=(0,w.mS)();const{chatId:m}=(0,C.Xf0)(e,i)||{};if(t&&m===r){const i=(0,C.zeq)(e,r),u=r===s.zv8?e.serviceNotifications.filter(({isDeleted:e})=>!e).map(({message:e})=>e):[],m=(0,C.pSx)(e,r),p=m?Object.values(m).map(({lastMessageId:e})=>i[e]).filter(Boolean):[],g=t.messages.map(({id:e})=>e),f=(0,h.Up)(e.messages.byChatId[r].threadsById,g),I=((!t.messages.length||t.messages.some(({id:e})=>e===d?.firstMessageId))&&d?.topMessages||[]).concat(t.messages,u),v=I.concat(p),b=(0,h.dU)(v,"id"),S=(0,h.Am)(I.map(({id:e})=>e));o||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(({id:t})=>{e=(0,M.w)(e,{tabThreads:{}},t)}),o=!0),e=(0,A.o4A)(e,r,b),e=(0,A.d4w)(e,r,c,S),Object.entries(f).forEach(([t,a])=>{a?.threadInfo&&(e=(0,A.eAk)(e,r,t,a.threadInfo))}),l&&!l.isCommentsInfo&&c!==n.l3&&(e=(0,A.eAk)(e,r,c,{...(0,h.Up)(l,["fromChannelId","fromMessageId"])})),Object.values(e.byTabId).forEach(({id:t})=>{const{chatId:a,threadId:s}=(0,C.Xf0)(e,t)||{};a===r&&s===c&&(e=(0,A.s3Z)(e,r,c,S,t))}),e=(0,A.h7P)(e,(0,h.dU)(t.chats,"id")),e=(0,A.CKT)(e,(0,h.dU)(t.users,"id")),a=!0}}(0,w.UF)(e),u?.isForum&&(t.loadTopics({chatId:r,force:!0}),d&&d!==n.l3&&t.loadTopicById({chatId:r,topicId:Number(d),shouldCloseChatOnError:!0}))}e=(0,w.mS)(),a||(e={...e,messages:{...e.messages,byChatId:{}}},Object.values(e.byTabId).forEach(({id:t})=>{e=(0,M.w)(e,{tabThreads:{}},t)})),Object.keys(i).forEach(t=>{const a=i[t];Object.keys(a).forEach(a=>{e=(0,A.e49)(e,t,Number(a),i[t][Number(a)])})}),c.forEach(({chatId:t,messageId:a,threadInfo:s})=>{(0,C.Vw0)(e,t,a)||(e=(0,A.eAk)(e,t,String(a),s))}),e=(0,A.KcS)(e,r),e=(0,A.KcS)(e,d),(0,w.UF)(e),Object.values(e.byTabId).forEach(({id:a})=>{const{chatId:s,messageId:o}=(0,C.nTw)(e,a).audioPlayer;s&&o&&!(0,C.O5q)(e,s,o)&&t.closeAudioPlayer({tabId:a})})}(e,t),e=(0,w.mS)(),e={...e,isSyncing:!1,isSynced:!0,isFetchingDifference:!1},(0,w.UF)(e),s.Oig&&console.log(">>> FINISH SYNC"),a({listType:"archived"}),o()}})}),(0,ke.DW)(e=>{const{connectionState:t,auth:a,isSynced:s}=e,{isMasterTab:o}=(0,C.nTw)(e);!o||s||Be?.connectionState===t&&Be?.auth.state===a.state||"connectionStateReady"===t&&"authorizationStateReady"===a.state&&(0,w.ko)().sync(),Be=e}),(0,w.aJ)("reportPeer",async(e,t,a)=>{const{chatId:s,reason:o,description:n,tabId:i=(0,u.g0)()}=a;if(!s)return;const r=(0,C.hds)(e,s);if(!r)return;const d=await(0,b.px)("reportPeer",{peer:r,reason:o,description:n});t.showNotification({message:d?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:i})}),(0,w.aJ)("reportProfilePhoto",async(e,t,a)=>{const{chatId:s,reason:o,description:n,photo:i,tabId:r=(0,u.g0)()}=a;if(!s)return;const d=(0,C.hds)(e,s);if(!d||!i)return;const c=await(0,b.px)("reportProfilePhoto",{peer:d,photo:i,reason:o,description:n});t.showNotification({message:c?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:r})}),(0,w.aJ)("loadAuthorizations",async e=>{const t=await(0,b.px)("fetchAuthorizations");t&&(e=(0,w.mS)(),e={...e,activeSessions:{byHash:t.authorizations,orderedHashes:Object.keys(t.authorizations),ttlDays:t.ttlDays}},(0,w.UF)(e))}),(0,w.aJ)("terminateAuthorization",async(e,t,a)=>{const{hash:s}=a;if(!await(0,b.px)("terminateAuthorization",s))return;e=(0,w.mS)();const{[s]:o,...n}=e.activeSessions.byHash;e={...e,activeSessions:{byHash:n,orderedHashes:e.activeSessions.orderedHashes.filter(e=>e!==s)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllAuthorizations",async e=>{if(!await(0,b.px)("terminateAllAuthorizations"))return;const t=(e=(0,w.mS)()).activeSessions.orderedHashes.find(t=>e.activeSessions.byHash[t].isCurrent);if(!t)return;const a=e.activeSessions.byHash[t];e={...e,activeSessions:{byHash:{[t]:a},orderedHashes:[t]}},(0,w.UF)(e)}),(0,w.aJ)("changeSessionSettings",async(e,t,a)=>{const{hash:s,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i}=a;await(0,b.px)("changeSessionSettings",{hash:s,areCallsEnabled:o,areSecretChatsEnabled:n,isConfirmed:i})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,byHash:{...e.activeSessions.byHash,[s]:{...e.activeSessions.byHash[s],...void 0!==o?{areCallsEnabled:o}:void 0,...void 0!==n?{areSecretChatsEnabled:n}:void 0,...i&&{isUnconfirmed:void 0}}}}},(0,w.UF)(e))}),(0,w.aJ)("changeSessionTtl",async(e,t,a)=>{const{days:s}=a;await(0,b.px)("changeSessionTtl",{days:s})&&(e=(0,w.mS)(),e={...e,activeSessions:{...e.activeSessions,ttlDays:s}},(0,w.UF)(e))}),(0,w.aJ)("loadWebAuthorizations",async e=>{const t=await(0,b.px)("fetchWebAuthorizations");if(!t)return;const{webAuthorizations:a}=t;e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:a,orderedHashes:Object.keys(a)}},(0,w.UF)(e)}),(0,w.aJ)("terminateWebAuthorization",async(e,t,a)=>{const{hash:s}=a;if(!await(0,b.px)("terminateWebAuthorization",s))return;e=(0,w.mS)();const{[s]:o,...n}=e.activeWebSessions.byHash;e={...e,activeWebSessions:{byHash:n,orderedHashes:e.activeWebSessions.orderedHashes.filter(e=>e!==s)}},(0,w.UF)(e)}),(0,w.aJ)("terminateAllWebAuthorizations",async e=>{await(0,b.px)("terminateAllWebAuthorizations")&&(e=(0,w.mS)(),e={...e,activeWebSessions:{byHash:{},orderedHashes:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadAccountDaysTtl",async(e,t,a)=>{const s=await(0,b.px)("fetchAccountTTL");s&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:s.days}},(0,w.UF)(e))}),(0,w.aJ)("setAccountTTL",async(e,t,a)=>{const{days:s,tabId:o=(0,u.g0)()}=a||{};s&&await(0,b.px)("setAccountTTL",{days:s})&&(e=(0,w.mS)(),e={...e,settings:{...e.settings,accountDaysTtl:s}},(0,w.UF)(e),t.closeDeleteAccountModal({tabId:o}))});const xe=(0,I.nF)(e=>e(),500,!1);(0,w.aJ)("loadFullUser",async(e,t,a)=>{const{userId:s,withPhotos:o}=a,n=(0,C.mBe)(e,s);if(!n)return;const{id:i,accessHash:r}=n,d=await(0,b.px)("fetchFullUser",{id:i,accessHash:r});if(!d?.user)return;e=(0,w.mS)();const c=(0,C.vGo)(e,s),{user:l,fullInfo:u}=d,m=(0,C.IVq)(e,s),p=n.avatarPhotoId!==l.avatarPhotoId||c?.profilePhoto?.id!==u?.profilePhoto?.id||c?.fallbackPhoto?.id!==u?.fallbackPhoto?.id||c?.personalPhoto?.id!==u?.personalPhoto?.id;e=(0,A.TKu)(e,s,d.user),e=(0,A.weB)(e,s,d.fullInfo),e=(0,A.CKT)(e,(0,h.dU)(d.users,"id")),e=(0,A.h7P)(e,(0,h.dU)(d.chats,"id")),e=(0,A.d2X)(e,d.userStatusesById),(0,w.UF)(e),(o||m?.count&&p)&&t.loadMoreProfilePhotos({peerId:s,shouldInvalidateCache:!0})}),(0,w.aJ)("loadUser",async(e,t,a)=>{const{userId:s}=a,o=(0,C.mBe)(e,s);if(!o)return;const n=await(0,b.px)("fetchUsers",{users:[o]});if(!n)return;const{users:i,userStatusesById:r}=n;e=(0,w.mS)(),e=(0,A.CKT)(e,(0,h.dU)(i,"id")),e=(0,A.wWy)(e,{...e.users.statusesById,...r}),(0,w.UF)(e)}),(0,w.aJ)("loadTopUsers",async e=>{const{topPeers:{lastRequestedAt:t}}=e;if(t&&!((0,v.Fm)()-t>60))return;const a=await(0,b.px)("fetchTopUsers");if(!a)return;const{ids:s}=a;e=(0,w.mS)(),e={...e,topPeers:{...e.topPeers,userIds:s,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadContactList",async e=>{const t=await(0,b.px)("fetchContactList");if(!t)return;e=(0,w.mS)(),e=(0,A.d2X)(e,t.userStatusesById);const a=e=>e.lastName||e.firstName||"",s=new Intl.Collator("en-US"),o=t.users.sort((e,t)=>s.compare(a(e),a(t))).filter(e=>!e.isSelf);e={...e,contactList:{userIds:o.map(e=>e.id)}},(0,w.UF)(e)}),(0,w.aJ)("loadCurrentUser",()=>{(0,b.px)("fetchCurrentUser")}),(0,w.aJ)("loadCommonChats",async(e,t,a)=>{const{userId:s}=a;if((0,C.trm)(e))return;const o=(0,C.mBe)(e,s),n=(0,C.Ua4)(e,s);if(!o||(0,S.tv)(o)||n?.isFullyLoaded)return;const i=await(0,b.px)("fetchCommonChats",{user:o,maxId:n?.maxId});if(!i)return;const{chatIds:r,count:d}=i,c=(0,h.Am)((n?.ids||[]).concat(r));e=(0,w.mS)(),e=(0,A.lWl)(e,o.id,{maxId:r.length?r[r.length-1]:void 0,ids:c,isFullyLoaded:c.length>=d}),(0,w.UF)(e)}),(0,w.aJ)("toggleNoPaidMessagesException",async(e,t,a)=>{const{userId:s,shouldRefundCharged:o}=a,n=(0,C.mBe)(e,s);n&&await(0,b.px)("toggleNoPaidMessagesException",{user:n,shouldRefundCharged:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,s,{settings:void 0}),(0,w.UF)(e))}),(0,w.aJ)("openChatRefundModal",async(e,t,a)=>{const{userId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.mBe)(e,s);if(!n)return;const i=await(0,b.px)("fetchPaidMessagesRevenue",{user:n});void 0!==i&&(e=(0,w.mS)(),e=(0,M.w)(e,{chatRefundModal:{userId:s,starsToRefund:i}},o),(0,w.UF)(e))}),(0,w.aJ)("updateContact",async(e,t,a)=>{const{userId:s,firstName:o,lastName:n,shouldSharePhoneNumber:r,note:d,tabId:c=(0,u.g0)()}=a,l=(0,C.mBe)(e,s);if(!l)return;let h;if(e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,c),(0,w.UF)(e),l.isContact||!l.phoneNumber||d){const{id:e,accessHash:t}=l;h=await(0,b.px)("updateContact",{id:e,accessHash:t,phoneNumber:"",firstName:o,lastName:n,shouldSharePhoneNumber:r,note:d})}else h=await(0,b.px)("importContact",{phone:l.phoneNumber,firstName:o,lastName:n});h&&(t.loadPeerSettings({peerId:s}),t.loadPeerStories({peerId:s}),e=(0,w.mS)(),e=(0,A.TKu)(e,l.id,{firstName:o,lastName:n}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,c),e=(0,A.BOn)(e,c),(0,w.UF)(e)}),(0,w.aJ)("updateContactNote",async(e,t,a)=>{const{userId:s,note:o,tabId:n=(0,u.g0)()}=a,r=(0,C.mBe)(e,s);if(!r)return;e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,n),(0,w.UF)(e);const d=await(0,b.px)("updateContactNote",r,o);e=(0,w.mS)(),d&&(e=(0,A.weB)(e,s,{note:o})),e=(0,A.G42)(e,i.TD.Complete,n),(0,w.UF)(e)}),(0,w.aJ)("deleteContact",async(e,t,a)=>{const{userId:s}=a,o=(0,C.mBe)(e,s);if(!o)return;const{id:n,accessHash:i}=o;await(0,b.px)("deleteContact",{id:n,accessHash:i})}),(0,w.aJ)("loadMoreProfilePhotos",async(e,t,a)=>{if((0,C.trm)(e))return;const{peerId:s,shouldInvalidateCache:o,isPreload:n}=a,i=(0,k.L8)(s),r=i?(0,C.mBe)(e,s):void 0,d=i?void 0:(0,C.hds)(e,s),c=r||d;if(d&&(0,C._ls)(e,s))return;const l=(0,C.IVq)(e,s);if(!c?.avatarPhotoId)return;if(l&&!o&&(n||!l.nextOffset))return;e=(0,A.Tqk)(e,s,!0),(0,w.UF)(e),e=(0,w.mS)();let u=(0,C.vGo)(e,s),h=(0,C.AWZ)(e,s);if(r&&!u){const{id:e,accessHash:t}=r,a=await(0,b.px)("fetchFullUser",{id:e,accessHash:t});if(!a?.user)return;u=a.fullInfo}if(d&&!h){const e=await(0,b.px)("fetchFullChat",d);if(!e?.fullInfo)return;h=e.fullInfo}const m=u||h;if(!m)return;const p=l?.nextOffset,g=!p||n||o?10:void 0,f=await(0,b.px)("fetchProfilePhotos",{peer:c,offset:p,limit:g});if(!f||!f.photos)return;e=(0,w.mS)();const{photos:I,count:v,nextOffsetId:S}=f;e=(0,A.LZP)(e,s,{newPhotos:I,count:v,nextOffset:S,fullInfo:m,shouldInvalidateCache:o}),(0,w.UF)(e)}),(0,w.aJ)("setUserSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;s&&xe(async()=>{const t=await(0,b.px)("searchChats",{query:s});e=(0,w.mS)();const a=(0,C.nTw)(e,o).userSearch.query;if(!t||!a||s!==a)return e=(0,A.Z0S)(e,!1,o),void(0,w.UF)(e);const{accountResultIds:n,globalResultIds:i}=t,r=n.filter(k.L8),d=i.filter(k.L8);e=(0,A.Z0S)(e,!1,o),e=(0,A.BFh)(e,{localUserIds:r,globalUserIds:d},o),(0,w.UF)(e)})}),(0,w.aJ)("importContact",async(e,t,a)=>{const{phoneNumber:s,firstName:o,lastName:n,tabId:i=(0,u.g0)()}=a,r=await(0,b.px)("importContact",{phone:s,firstName:o,lastName:n});r?(t.openChat({id:r,tabId:i}),e=(0,w.mS)(),e=(0,A.BOn)(e,i),(0,w.UF)(e)):t.showNotification({message:f.yE("Contacts.PhoneNumber.NotRegistred"),tabId:i})}),(0,w.aJ)("reportSpam",(e,t,a)=>{const{chatId:s}=a,o=(0,C.PVB)(e,s);o&&(0,b.px)("reportSpam",o)}),(0,w.aJ)("setEmojiStatus",async(e,t,a)=>{const{emojiStatus:s,referrerWebAppKey:o,tabId:n=(0,u.g0)()}=a;if(!(0,C.g29)(e))return o&&t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"USER_DECLINED"}},tabId:n}),void t.openPremiumModal({initialSection:"emoji_status",tabId:n});const i=await(0,b.px)("updateEmojiStatus",s);if(o){if(!i)return void t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_failed",eventData:{error:"SERVER_ERROR"}},tabId:n});t.sendWebAppEvent({webAppKey:o,event:{eventType:"emoji_status_set"},tabId:n}),t.showNotification({message:{key:"BotSuggestedStatusUpdated"},customEmojiIconId:s.documentId,tabId:n})}}),(0,w.aJ)("saveCloseFriends",async(e,t,a)=>{const{userIds:s}=a;await(0,b.px)("saveCloseFriends",s)&&(e=(0,w.mS)(),e.contactList?.userIds.forEach(t=>{const{isCloseFriend:a}=e.users.byId[t]||{};a&&!s.includes(t)&&(e=(0,A.TKu)(e,t,{isCloseFriend:void 0}))}),s.forEach(t=>{e=(0,A.TKu)(e,t,{isCloseFriend:!0})}),(0,w.UF)(e))}),(0,w.aJ)("openSuggestedStatusModal",async(e,t,a)=>{const{customEmojiId:s,duration:o,botId:n,webAppKey:i,tabId:r=(0,u.g0)()}=a,d=await(0,b.px)("fetchCustomEmoji",{documentId:[s]});d?.[0]?(e=(0,w.mS)(),e=(0,M.w)(e,{suggestedStatusModal:{customEmojiId:s,duration:o,webAppKey:i,botId:n}},r),(0,w.UF)(e)):i&&t.sendWebAppEvent({webAppKey:i,event:{eventType:"emoji_status_failed",eventData:{error:"SUGGESTED_EMOJI_INVALID"}},tabId:r})}),(0,w.aJ)("loadPeerSettings",async(e,t,a)=>{const{peerId:s}=a;if((0,C.trm)(e))return;if(!(0,C.vGo)(e,s))return void t.loadFullUser({userId:s});const o=(0,C.mBe)(e,s);if(!o)return;const n=await(0,b.px)("fetchPeerSettings",o);if(!n)return;const{settings:i}=n;e=(0,w.mS)(),e=(0,A.weB)(e,s,{settings:i}),(0,w.UF)(e)}),(0,w.aJ)("markBotVerificationInfoShown",(e,t,a)=>{const{peerId:o}=a,n=e.settings.botVerificationShownPeerIds,i=(0,h.Am)([o,...n]).slice(0,s.qLe);e={...e,settings:{...e.settings,botVerificationShownPeerIds:i}},(0,w.UF)(e)});var Ne=a(33204),Re=a(59852),Je=a(20179);function Ye(e,t,a,...[s=(0,u.g0)()]){const o=(0,C.nTw)(e,s);return(0,M.w)(e,{inlineBots:{...o.inlineBots,byUsername:{...o.inlineBots.byUsername,[t]:a}}},s)}function Ee(e,t,...[a=(0,u.g0)()]){return(0,M.w)(e,{inlineBots:{...(0,C.nTw)(e,a).inlineBots,isLoading:t}},a)}function De(e,t,a,...[s=(0,u.g0)()]){const o=(0,C.nTw)(e,s),n=o.webApps.openedWebApps,i=n[t];if(!i)return e;const r={...i,...a},d=(0,Je.rp)(r);return d?e=(0,M.w)(e,{webApps:{...o.webApps,openedWebApps:{...n,[d]:r}}},s):e}function Oe(e,t,a=!0,s=!0,...[o=(0,u.g0)()]){const n=(0,C.nTw)(e,o),i=(0,Je.rp)(t);if(!i)return e;const r=[...n.webApps.openedOrderedKeys];r.includes(i)||r.push(i);const d=[...n.webApps.sessionKeys];d.includes(i)||d.push(i);const c=n.webApps.openedWebApps;return(0,M.w)(e,{webApps:{...n.webApps,...a&&{activeWebAppKey:i},isMoreAppsTabActive:!1,isModalOpen:s,modalState:"maximized",openedWebApps:{...c,[i]:t},openedOrderedKeys:r,sessionKeys:d}},o)}function Le(e,t,a,...[s=(0,u.g0)()]){const o=(0,C.nTw)(e,s),{openedWebApps:n,openedOrderedKeys:i,activeWebAppKey:r}=o.webApps,d=n[t];if(!d)return e;if(!a&&d.shouldConfirmClosing)return De(e,t,{isCloseModalOpen:!0},s);const c={...n},l=(0,Je.rp)(d);let h=i;l&&(delete c[l],h=i.filter(e=>e!==l));const m=r===(0,Je.rp)(d),p=Object.keys(c),g=p.length;return(0,M.w)(e,{webApps:{...o.webApps,...m&&{activeWebAppKey:g?p[g-1]:void 0},openedWebApps:c,openedOrderedKeys:h,...!g&&{sessionKeys:[]}}},s)}function Ge(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>0}function Ve(e,t,...[a=(0,u.g0)()]){const s=(0,C.nTw)(e,a);return(0,M.w)(e,{webApps:{...s.webApps,isModalOpen:t}},a)}var je=a(30708);const qe=(0,I.sg)(e=>e(),500,!1);let ze;function He(e,t,a,s,o){const n={botId:t,requestUrl:s,webAppName:o};if(function(e,t,a){const s=(0,C.nTw)(e,a).webApps.openedWebApps,o=(0,S.rp)(t);return!!o&&s[o]}(e,n,a)){const t=(0,S.rp)(n);return t&&(e=function(e,t,...[a=(0,u.g0)()]){const s=(0,C.nTw)(e,a);return s.webApps.openedWebApps[t]?e=(0,M.w)(e,{webApps:{...s.webApps,isMoreAppsTabActive:!1,activeWebAppKey:t,modalState:"maximized"}},a):e}(e,t,a),(0,w.UF)(e)),!0}return!1}function Ke(e,t,a,s,...[o=(0,u.g0)()]){if("request"===s.type){e=(0,w.mS)();const t=(0,C.nTw)(e,o);if(!t.urlAuth)return;const{domain:a,bot:n,shouldRequestWriteAccess:i}=s;return e=(0,M.w)(e,{urlAuth:{...t.urlAuth,request:{domain:a,botId:n.id,shouldRequestWriteAccess:i}}},o),void(0,w.UF)(e)}const n="accepted"===s.type?s.url:a;window.open(n,"_blank","noopener"),t.closeUrlAuthModal({tabId:o})}async function We(e,t,a,s,o){await(0,b.px)("sendMessage",{chat:e,replyInfo:a,text:t,sendAs:s,lastMessageId:o})}async function _e(e,t,a,s,o,n,i=!1,...[r=(0,u.g0)()]){const{showDialog:d,showNotification:c,openUrl:l,openGame:h}=t,m=await(0,b.px)("answerCallbackButton",{chatId:a.id,accessHash:a.accessHash,messageId:s,data:n,isGame:i});if(!m)return;const{message:p,alert:g,url:f}=m;g?d({data:{message:p||"Error"},tabId:r}):p?c({message:p,tabId:r}):f&&(i?h({url:f,chatId:a.id,messageId:s,tabId:r}):l({url:f,tabId:r,linkContext:{type:"message",chatId:a.id,messageId:s,threadId:o}}))}(0,w.aJ)("clickSuggestedMessageButton",(e,t,a)=>{const{chatId:s,messageId:o,button:n,tabId:i=(0,u.g0)()}=a,{buttonType:r}=n,d=(0,C.O5q)(e,s,o);switch(r){case"suggestChanges":if(!d)break;t.initDraftFromSuggestedMessage({chatId:s,messageId:o,tabId:i})}}),(0,w.aJ)("clickBotInlineButton",(e,t,a)=>{const{chatId:s,messageId:o,threadId:n,button:i,tabId:r=(0,u.g0)()}=a,d=(0,C.hds)(e,s),l=(0,C.O5q)(e,s,o);if(d&&l)switch(i.type){case"command":t.sendBotCommand({command:i.text,tabId:r});break;case"url":{const{url:e}=i;t.openUrl({url:e,tabId:r,linkContext:{type:"message",chatId:s,messageId:o,threadId:n}});break}case"copy":(0,c.eM)(i.copyText),t.showNotification({message:(0,f.yE)("ExactTextCopied",i.copyText),tabId:r});break;case"callback":_e(0,t,d,o,n,i.data,void 0,r);break;case"requestPoll":t.openPollModal({isQuiz:i.isQuiz,tabId:r});break;case"requestPhone":{const a=e.currentUserId?(0,C.mBe)(e,e.currentUserId):void 0;if(!a)return;t.showDialog({data:{phoneNumber:a.phoneNumber,firstName:a.firstName||"",lastName:a.lastName||"",userId:a.id},tabId:r});break}case"receipt":{const{receiptMessageId:e}=i;t.getReceipt({chatId:d.id,messageId:e,tabId:r});break}case"buy":t.openInvoice({type:"message",chatId:d.id,messageId:o,tabId:r});break;case"game":_e(0,t,d,o,n,void 0,!0,r);break;case"switchBotInline":{const{query:e,isSamePeer:a}=i;t.switchBotInline({query:e,isSamePeer:a,messageId:o,tabId:r});break}case"userProfile":{const{userId:e}=i;t.openChatWithInfo({id:e,tabId:r});break}case"simpleWebView":{const{url:a}=i,s=(0,C.Y7C)(e,l);if(!s)return;const o=(0,Re.A)();t.requestSimpleWebView({url:a,botId:s.id,theme:o,buttonText:i.text,tabId:r});break}case"webView":{const{url:a}=i,s=(0,C.Y7C)(e,l),o=l.viaBotId||s?.id;if(!o)return;const n=(0,Re.A)();t.requestWebView({url:a,botId:o,peerId:d.id,theme:n,buttonText:i.text,tabId:r});break}case"urlAuth":{const{url:e}=i;t.requestBotUrlAuth({chatId:d.id,messageId:o,buttonId:i.buttonId,url:e,tabId:r});break}}}),(0,w.aJ)("sendBotCommand",(e,t,a)=>{const{command:s,chatId:o,tabId:n=(0,u.g0)()}=a,i=o?(0,C.hds)(e,o):(0,C.meB)(e,n),r=(0,C.Xf0)(e,n);if(!i||!r)return;const{threadId:d}=r;t.resetDraftReplyInfo({tabId:n}),t.clearWebPagePreview({tabId:n});const c=(0,C.ZZX)(e,i.id);We(i,s,(0,C.GA4)(e,i.id,d)?.replyInfo,(0,C.VF$)(e,i.id),c)}),(0,w.aJ)("restartBot",async(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a,{currentUserId:n}=e,i=(0,C.meB)(e,o),r=n&&(0,C.yps)(e,s);if(!n||!i||!r)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("unblockUser",{user:r})&&(e=(0,w.mS)(),e=(0,A.OW3)(e,r.id),(0,w.UF)(e),We(i,"/start",void 0,(0,C.VF$)(e,s),d))}),(0,w.aJ)("loadTopInlineBots",async e=>{const{lastRequestedAt:t}=e.topInlineBots;if(t&&(0,v.Fm)()-t<60)return;const a=await(0,b.px)("fetchTopInlineBots");if(!a)return;const{ids:s}=a;e=(0,w.mS)(),e={...e,topInlineBots:{...e.topInlineBots,userIds:s,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("loadTopBotApps",async e=>{const{lastRequestedAt:t}=e.topBotApps;if(t&&(0,v.Fm)()-t<60)return;const a=await(0,b.px)("fetchTopBotApps");if(!a)return;const{ids:s}=a;e=(0,w.mS)(),e={...e,topBotApps:{...e.topBotApps,userIds:s,lastRequestedAt:(0,v.Fm)()}},(0,w.UF)(e)}),(0,w.aJ)("queryInlineBot",async(e,t,a)=>{const{chatId:s,username:o,query:n,offset:i,tabId:r=(0,u.g0)()}=a;let d=(0,C.nTw)(e,r).inlineBots.byUsername[o];if(!1!==d){if(void 0===d){const{user:t,chat:a}=await(0,b.px)("fetchInlineBot",{username:o})||{};if(e=(0,w.mS)(),!t||!a)return e=Ye(e,o,!1,r),void(0,w.UF)(e);d={id:t.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ye(e,o,d,r),(0,w.UF)(e)}(n!==d.query||d.canLoadMore)&&qe(()=>{!async function(e,{username:t,inlineBotData:a,chatId:s,query:o,offset:n},...[i=(0,u.g0)()]){e=(0,w.mS)();const r=(0,C.mBe)(e,a.id),d=(0,C.hds)(e,s);if(!r||!d)return;const c=a.query!==o;e=Ye(e=Ee(e,!0,i),t,{...a,query:o,...c&&{offset:void 0,results:[]}},i),(0,w.UF)(e);const l=await(0,b.px)("fetchInlineBotResults",{bot:r,chat:d,query:o,offset:c?void 0:n});e=(0,w.mS)();const m=(0,C.nTw)(e,i).inlineBots.byUsername[t];if(e=Ee(e,!1,i),!l||!m||o!==m.query)return void(0,w.UF)(e);const p=new Set((m.results||[]).map(e=>e.id)),g=l.results.filter(e=>!p.has(e.id));e=Ye(e,t,{...m,...(0,h.Up)(l,["help","switchPm","switchWebview"]),cacheTime:Date.now()+1e3*l.cacheTime,...g.length&&{isGallery:l.isGallery},canLoadMore:l.results.length>0&&Boolean(l.nextOffset),results:""===m.offset||m.offset===l.nextOffset?l.results:(m.results||[]).concat(g),offset:g.length?l.nextOffset:""},i),(0,w.UF)(e)}(e,{username:o,inlineBotData:d,chatId:s,query:n,offset:i},r)})}}),(0,w.aJ)("switchBotInline",(e,t,a)=>{const{query:s,isSamePeer:o,messageId:n,filter:i,tabId:r=(0,u.g0)()}=a;let{botId:d}=a;const c=(0,C.meB)(e,r);if(!c)return;if(!d&&n){const t=(0,C.O5q)(e,c.id,n);if(!t)return;const a=(0,C.Y7C)(e,t);d=t.viaBotId||a?.id}if(!d)return;const l=(0,C.mBe)(e,d);l&&t.openChatWithDraft({text:{text:`@${(0,S.Kl)(l)} ${s}`},chatId:o?c.id:void 0,filter:i,tabId:r})}),(0,w.aJ)("sendInlineBotApiResult",async(e,t,a)=>{const{chat:s,id:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduledAt:c,allowPaidStars:l}=a;await(0,b.px)("sendInlineBotResult",{chat:s,resultId:o,queryId:n,replyInfo:i,sendAs:r,isSilent:d,scheduleDate:c,allowPaidStars:l}),l&&t.loadStarStatus()}),(0,w.aJ)("sendInlineBotResult",async(e,t,a)=>{const{id:s,queryId:o,isSilent:n,scheduledAt:i,threadId:r,chatId:d,tabId:c=(0,u.g0)()}=a;if(!s)return;const l=(0,C.hds)(e,d),h=(0,C.GA4)(e,d,r)?.replyInfo,m=(0,C.OEv)(e,d,r,h);t.resetDraftReplyInfo({tabId:c}),t.clearWebPagePreview({tabId:c});const f=await ne(e,d),I={chat:l,id:s,queryId:o,replyInfo:m,sendAs:(0,C.VF$)(e,d),isSilent:n,scheduledAt:i,allowPaidStars:f};f?(t.sendInlineBotApiResult({...I}),t.showNotification({localId:o,title:{key:"MessageSentPaidToastTitle",variables:{count:1},options:{pluralValue:1}},message:{key:"MessageSentPaidToastText",variables:{amount:(0,g.Kk)((0,p.Yw)(),f)}},icon:"star",shouldUseCustomIcon:!0,type:"paidMessage",tabId:c})):t.sendInlineBotApiResult(I)}),(0,w.aJ)("resetInlineBot",(e,t,a)=>{const{username:s,force:o,tabId:n=(0,u.g0)()}=a;let i=(0,C.nTw)(e,n).inlineBots.byUsername[s];i&&(!o&&Date.now()<i.cacheTime||(i={id:i.id,query:"",offset:"",switchPm:void 0,canLoadMore:!0,results:[],cacheTime:0},e=Ye(e,s,i,n),(0,w.UF)(e)))}),(0,w.aJ)("resetAllInlineBots",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).inlineBots.byUsername;Object.keys(o).forEach(e=>{t.resetInlineBot({username:e,tabId:s})})}),(0,w.aJ)("startBot",async(e,t,a)=>{const{botId:s,param:o}=a,n=(0,C.mBe)(e,s);if(!n)return;let i=(0,C.vGo)(e,s);if(!i){const e=await(0,b.px)("fetchFullUser",{id:n.id,accessHash:n.accessHash});i=e?.fullInfo}i?.isBlocked&&await(0,b.px)("unblockUser",{user:n}),await(0,b.px)("startBot",{bot:n,startParam:o})}),(0,w.aJ)("sharePhoneWithBot",async(e,t,a)=>{const{botId:s}=a,o=(0,C.mBe)(e,s);if(!o)return;let n=(0,C.vGo)(e,s);if(!n){const e=await(0,b.px)("fetchFullUser",{id:o.id,accessHash:o.accessHash});n=e?.fullInfo}n?.isBlocked&&await(0,b.px)("unblockUser",{user:o}),e=(0,w.mS)();const i=(0,C.hds)(e,s),r=(0,C.mBe)(e,e.currentUserId);if(!i)return;const d=(0,C.ZZX)(e,i.id);await(0,b.px)("sendMessage",{chat:i,contact:{mediaType:"contact",firstName:r.firstName||"",lastName:r.lastName||"",phoneNumber:r.phoneNumber||"",userId:r.id},lastMessageId:d})}),(0,w.aJ)("requestSimpleWebView",async(e,t,a)=>{const{url:s,botId:o,theme:n,buttonText:i,isFromSideMenu:r,isFromSwitchWebView:d,startParam:c,tabId:l=(0,u.g0)()}=a;if(He(e,o,l,s))return;const h=(0,C.mBe)(e,o);if(!h)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestSimpleWebView",payload:a}}},l),void(0,w.UF)(e);const m=await(0,b.px)("requestSimpleWebView",{url:s,bot:h,theme:n,startParam:c,isFromSideMenu:r,isFromSwitchWebView:d});m&&(e=Oe(e=(0,w.mS)(),{requestUrl:s,appName:h.firstName,url:m,botId:o,buttonText:i},!0,!0,l),(0,w.UF)(e))}),(0,w.aJ)("requestWebView",async(e,t,a)=>{const{url:s,botId:o,peerId:i,theme:r,isSilent:d,buttonText:c,isFromBotMenu:l,startParam:h,isFullscreen:m,tabId:p=(0,u.g0)()}=a;if(He(e,o,p,s))return;const g=(0,C.mBe)(e,o);if(!g)return;const f=(0,C.PVB)(e,i);if(!f)return;if(!(0,C.nTL)(e,o))return e=(0,M.w)(e,{botTrustRequest:{botId:o,type:"webApp",onConfirm:{action:"requestWebView",payload:a}}},p),void(0,w.UF)(e);const I=(0,C.Xf0)(e,p),{chatId:v,threadId:S=n.l3}=I||{},y=v?(0,C.GA4)(e,v,S)?.replyInfo:void 0,A=v?(0,C.OEv)(e,v,S,y):void 0,P=v?(0,C.VF$)(e,v):void 0,k=await(0,b.px)("requestWebView",{url:s,bot:g,peer:f,theme:r,isSilent:d,replyInfo:A,isFromBotMenu:l,startParam:h,sendAs:P,isFullscreen:m});if(!k)return;const{url:T,queryId:F,isFullScreen:B}=k;e=Oe(e=(0,w.mS)(),{requestUrl:s,url:T,appName:g.firstName,botId:o,peerId:i,queryId:F,replyInfo:A,buttonText:c},!0,!0,p),(0,w.UF)(e),B&&(0,O.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:p})}),(0,w.aJ)("requestMainWebView",async(e,t,a)=>{const{botId:s,peerId:o,theme:n,startParam:i,mode:r,shouldMarkBotTrusted:d,tabId:c=(0,u.g0)()}=a;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:c});if(He(e,s,c))return;const l=(0,C.mBe)(e,s);if(!l)return;const h=(0,C.PVB)(e,o);if(!h)return;if(!(0,C.nTL)(e,s)){if(!d)return e=(0,M.w)(e,{botTrustRequest:{botId:s,type:"webApp",onConfirm:{action:"requestMainWebView",payload:a}}},c),void(0,w.UF)(e);t.markBotTrusted({botId:s,isWriteAllowed:!0,tabId:c})}const m=await(0,b.px)("requestMainWebView",{bot:l,peer:h,theme:n,startParam:i,mode:r});if(!m)return;const{url:p,queryId:g,isFullscreen:f}=m;e=Oe(e=(0,w.mS)(),{url:p,appName:l.firstName,botId:s,peerId:o,queryId:g,buttonText:""},!0,!0,c),(0,w.UF)(e),f&&(0,O.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:c})}),(0,w.aJ)("loadPreviewMedias",async(e,t,a)=>{const{botId:s}=a,o=(0,C.mBe)(e,s);if(!o)return;const n=await(0,b.px)("fetchPreviewMedias",{bot:o});e=(0,w.mS)(),n&&(e={...e,users:{...e.users,previewMediaByBotId:{...e.users.previewMediaByBotId,[s]:n}}},(0,w.UF)(e))}),(0,w.aJ)("openWebAppsCloseConfirmationModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:!0},s)}),(0,w.aJ)("closeWebAppsCloseConfirmationModal",(e,t,a)=>{const{shouldSkipInFuture:s,tabId:o=(0,u.g0)()}=a||{};return e=(0,A.qoo)(e,{shouldSkipWebAppCloseConfirmation:Boolean(s)}),(0,M.w)(e,{isWebAppsCloseConfirmationModalOpen:void 0},o)}),(0,w.aJ)("requestAppWebView",async(e,t,a)=>{const{botId:s,appName:o,startApp:n,mode:i,theme:r,isWriteAllowed:d,isFromConfirm:c,shouldSkipBotTrustRequest:l,tabId:h=(0,u.g0)()}=a;if(He(e,s,h,o))return;const m=(0,C.mBe)(e,s);if(!m)return;const p=Boolean(e.attachMenu.bots[m.id]);if(m.isAttachBot&&!c&&!p){const t=await(0,b.px)("loadAttachBot",{bot:m});if(t){e=(0,w.mS)();const s=t.bot;if(s.isDisclaimerNeeded||s.isForAttachMenu||s.isForSideMenu)return e=(0,M.w)(e,{requestedAttachBotInstall:{bot:s,onConfirm:{action:"requestAppWebView",payload:{...a,isFromConfirm:!0}}}},h),void(0,w.UF)(e)}}const g=await(0,b.px)("fetchBotApp",{bot:m,appName:o});if(e=(0,w.mS)(),!g)return void t.showNotification({message:(0,f.yE)("lng_username_app_not_found"),tabId:h});if(!l&&(g.isInactive||!(0,C.nTL)(e,s)))return a.shouldSkipBotTrustRequest=!0,e=(0,M.w)(e,{botTrustRequest:{botId:s,shouldRequestWriteAccess:g.shouldRequestWriteAccess,type:"botApp",onConfirm:{action:"requestAppWebView",payload:a}}},h),void(0,w.UF)(e);const I=(0,C.meB)(e,h),{url:v,isFullscreen:S}=await(0,b.px)("requestAppWebView",{peer:I||m,app:g,startParam:n,mode:i,isWriteAllowed:d,theme:r});if(e=(0,w.mS)(),!v)return;e=(0,w.mS)();const y=I?I.id:m.id;e=Oe(e,{url:v,appName:o&&m.firstName,peerId:y,botId:s,buttonText:""},!0,!0,h),(0,w.UF)(e),S&&(0,O.cB)()&&t.changeWebAppModalState({state:"fullScreen",tabId:h})}),(0,w.aJ)("prolongWebView",async(e,t,a)=>{const{botId:s,peerId:o,isSilent:n,replyInfo:i,queryId:r,tabId:d=(0,u.g0)()}=a,c=(0,C.mBe)(e,s);if(!c)return;const l=(0,C.hds)(e,o);if(!l)return;const h=(0,C.VF$)(e,o);await(0,b.px)("prolongWebView",{bot:c,peer:l,isSilent:n,replyInfo:i,queryId:r,sendAs:h})||t.closeActiveWebApp({tabId:d})}),(0,w.aJ)("sendWebViewData",(e,t,a)=>{const{bot:s,data:o,buttonText:n}=a;(0,b.px)("sendWebViewData",{bot:s,data:o,buttonText:n})}),(0,w.aJ)("loadAttachBots",async e=>{await async function(e){const t=await(0,b.px)("loadAttachBots",{hash:void 0});if(t)return e=(0,w.mS)(),e={...e,attachMenu:{hash:t.hash,bots:t.bots}},(0,w.UF)(e),t}(e),(0,Ne.A)({action:"loadAttachBots",payload:void 0},s.npx)}),(0,w.aJ)("toggleAttachBot",async(e,t,a)=>{const{botId:s,isWriteAllowed:o,isEnabled:n}=a,i=(0,C.mBe)(e,s);i&&await(0,b.px)("toggleAttachBot",{bot:i,isWriteAllowed:o,isEnabled:n})}),(0,w.aJ)("callAttachBot",(e,t,a)=>{const{bot:s,startParam:o,isFromConfirm:i,tabId:r=(0,u.g0)()}=a,d="isFromSideMenu"in a&&a.isFromSideMenu,c=!s,l=!c&&!e.attachMenu.bots[s.id]||s?.isInactive||s?.isDisclaimerNeeded;if(!i&&l)return(0,M.w)(e,{requestedAttachBotInstall:{bot:s,onConfirm:{action:"callAttachBot",payload:{...a,isFromConfirm:!0}}}},r);const h=(0,Re.A)();if(d&&t.requestSimpleWebView({botId:s.id,buttonText:"",isFromSideMenu:!0,startParam:o,theme:h,tabId:r}),"chatId"in a){const{chatId:e,threadId:i=n.l3,url:d}=a;t.openThread({chatId:e,threadId:i,tabId:r}),t.requestWebView({url:d,peerId:e,botId:c?e:s.id,theme:h,buttonText:"",isFromBotMenu:c,startParam:o,tabId:r})}}),(0,w.aJ)("confirmAttachBotInstall",async(e,t,a)=>{const{isWriteAllowed:s,tabId:o=(0,u.g0)()}=a,{requestedAttachBotInstall:n}=(0,C.nTw)(e,o),{bot:i,onConfirm:r}=n;e=(0,M.w)(e,{requestedAttachBotInstall:void 0},o),(0,w.UF)(e);const d=(0,C.mBe)(e,i.id);if(d&&(t.markBotTrusted({botId:i.id,isWriteAllowed:s,tabId:o}),await(0,b.px)("toggleAttachBot",{bot:d,isWriteAllowed:s,isEnabled:!0}),r)){const{action:e,payload:a}=r;t[e](a)}}),(0,w.aJ)("requestBotUrlAuth",async(e,t,a)=>{const{chatId:s,buttonId:o,messageId:n,url:i,tabId:r=(0,u.g0)()}=a,d=(0,C.hds)(e,s);if(!d)return;const c=await(0,b.px)("requestBotUrlAuth",{chat:d,buttonId:o,messageId:n});c&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:i,button:{buttonId:o,messageId:n,chatId:d.id}}},r),(0,w.UF)(e),Ke(e,t,i,c,r))}),(0,w.aJ)("acceptBotUrlAuth",async(e,t,a)=>{const{isWriteAllowed:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);if(!n.urlAuth?.button)return;const{button:i,url:r}=n.urlAuth,{chatId:d,messageId:c,buttonId:l}=i,h=(0,C.hds)(e,d);if(!h)return;const m=await(0,b.px)("acceptBotUrlAuth",{chat:h,messageId:c,buttonId:l,isWriteAllowed:s});m&&Ke(e=(0,w.mS)(),t,r,m,o)}),(0,w.aJ)("requestLinkUrlAuth",async(e,t,a)=>{const{url:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("requestLinkUrlAuth",{url:s});n&&(e=(0,w.mS)(),e=(0,M.w)(e,{urlAuth:{url:s}},o),(0,w.UF)(e),Ke(e,t,s,n,o))}),(0,w.aJ)("acceptLinkUrlAuth",async(e,t,a)=>{const{isWriteAllowed:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);if(!n.urlAuth?.url)return;const{url:i}=n.urlAuth,r=await(0,b.px)("acceptLinkUrlAuth",{url:i,isWriteAllowed:s});r&&Ke(e=(0,w.mS)(),t,i,r,o)}),(0,w.aJ)("closeUrlAuthModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{urlAuth:void 0},s)}),(0,w.aJ)("setBotInfo",async(e,t,a)=>{const{bot:s,name:o,description:n,tabId:r=(0,u.g0)()}=a;let{langCode:d}=a;d||(d=(0,je.lS)(e).language);const{currentUserId:c}=e;c&&s&&(e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.InProgress,r),(0,w.UF)(e),(o||n)&&await(0,b.px)("setBotInfo",{bot:s,langCode:d,name:o,about:n})&&(e=(0,w.mS)(),e=(0,A.TKu)(e,s.id,{firstName:o}),e=(0,A.weB)(e,s.id,{bio:n}),(0,w.UF)(e)),e=(0,w.mS)(),e=(0,A.G42)(e,i.TD.Complete,r),(0,w.UF)(e))}),(0,w.aJ)("toggleUserEmojiStatusPermission",async(e,t,a)=>{const{botId:s,isEnabled:o,isBotAccessEmojiGranted:n}=a,i=(0,C.yps)(e,s);s&&i&&await(0,b.px)("toggleUserEmojiStatusPermission",{bot:i,isEnabled:o})&&(e=(0,w.mS)(),e=(0,A.weB)(e,s,{isBotCanManageEmojiStatus:o,isBotAccessEmojiGranted:n}),(0,w.UF)(e))}),(0,w.aJ)("toggleUserLocationPermission",(e,t,a)=>{const{botId:s,isAccessGranted:o}=a,n=(0,C.mBe)(e,s);n&&(e=(0,w.mS)(),e=(0,A.cxc)(e,n.id,{geolocation:o}),(0,w.UF)(e))}),(0,w.aJ)("startBotFatherConversation",async(e,t,a)=>{const{param:n,tabId:i=(0,u.g0)()}=a;if(!ze){const t=await(0,o.A$)(e,s.aFH);if(!t)return;ze=t.id}n&&t.startBot({botId:ze,param:n}),t.openChat({id:ze,tabId:i})}),(0,w.aJ)("loadBotFreezeAppeal",async e=>{const t=e.appConfig.freezeAppealUrl;if(!t)return;const a=t?(0,l.l8)(t):void 0;if(!a)return;const s=await(0,o.A$)(e,a);e=(0,w.mS)(),e={...e,botFreezeAppealId:s?.id},(0,w.UF)(e)}),a(26943),(0,w.aJ)("loadPasswordInfo",async e=>{const t=await(0,b.px)("getPasswordInfo");t&&(e=(0,w.mS)(),e=(0,A.qpc)(e,{hasPassword:t.hasPassword}),e=(0,A.keG)(e,{hint:t.hint}),(0,w.UF)(e))}),(0,w.aJ)("checkPassword",async(e,t,a)=>{const{currentPassword:s,onSuccess:o}=a;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("checkPassword",s);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()}),(0,w.aJ)("clearPassword",async(e,t,a)=>{const{currentPassword:s,onSuccess:o}=a;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const n=await(0,b.px)("clearPassword",s);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),n&&o()}),(0,w.aJ)("updatePassword",async(e,t,a)=>{const{currentPassword:s,password:o,hint:n,email:i,onSuccess:r}=a;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),(0,w.UF)(e);const d=await(0,b.px)("updatePassword",s,o,n,i);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1}),(0,w.UF)(e),d&&r()}),(0,w.aJ)("updateRecoveryEmail",async(e,t,a)=>{const{currentPassword:s,email:o,onSuccess:n,tabId:i=(0,u.g0)()}=a;e=(0,A.keG)(e,{isLoading:!0,errorKey:void 0}),e=(0,M.w)(e,{recoveryEmail:o},i),(0,w.UF)(e);const r=await(0,b.px)("updateRecoveryEmail",s,o);e=(0,w.mS)(),e=(0,A.keG)(e,{isLoading:!1,waitingEmailCodeLength:void 0}),e=(0,M.w)(e,{recoveryEmail:void 0},i),(0,w.UF)(e),r&&n()}),(0,w.aJ)("provideTwoFaEmailCode",(e,t,a)=>{const{code:s}=a;(0,b.px)("provideRecoveryEmailCode",s)}),(0,w.aJ)("clearTwoFaError",e=>(0,A.keG)(e,{errorKey:void 0}));const Xe={missing_payment_information:{field:"cardNumber",message:"Incorrect card number"},invalid_number:{field:"cardNumber",message:"Incorrect card number"},number:{field:"cardNumber",message:"Incorrect card number"},exp_year:{field:"expiry",message:"Incorrect year"},exp_month:{field:"expiry",message:"Incorrect month"},invalid_expiry_year:{field:"expiry",message:"Incorrect year"},invalid_expiry_month:{field:"expiry",message:"Incorrect month"},cvc:{field:"cvv",message:"Incorrect CVV"},invalid_cvc:{field:"cvv",message:"Incorrect CVV"}};var $e=a(86046);async function Qe(e,t,a,...[o=(0,u.g0)()]){const n=(0,w.ko)(),i="stargiftResale"===t.type&&t.currency===s.ykW,r=i?e.ton?.balance:e.stars?.balance,d=i?s.ykW:s.OUy;if(void 0===r)return;if(r.amount<a)return void n.openStarsBalanceModal({currency:d,tabId:o});const c=(0,$e.jA)(e,t);if(!c)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},o),(0,w.UF)(e);const l=(0,Re.A)(),h=await(0,b.px)("getPaymentForm",c,l);if(!h)return;if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},o),(0,w.UF)(e),"error"in h)return void Ze(h.error,o);const m=h.invoice.totalAmount;m===a?n.sendStarPaymentForm({directInfo:{inputInvoice:t,formId:h.formId},tabId:o}):n.openPriceConfirmModal({originalAmount:a,newAmount:m,currency:d,directInfo:{inputInvoice:t,formId:h.formId},tabId:o})}function Ze(e,t){"SLUG_INVALID"!==e?(0,w.ko)().showDialog({data:{message:e,hasErrorKey:!0},tabId:t}):(0,w.ko)().showNotification({message:{key:"PaymentInvoiceNotFound"},tabId:t})}(0,w.aJ)("validateRequestedInfo",(e,t,a)=>{const{requestInfo:s,saveInfo:o,tabId:n=(0,u.g0)()}=a,r=(0,C.aF2)(e,n);if(!r)return;const d=(0,$e.jA)(e,r);d&&async function(e,t,a,s,...[o=(0,u.g0)()]){const n=await(0,b.px)("validateRequestedInfo",{inputInvoice:t,requestInfo:a,shouldSave:s});if(!n)return;const{id:r,shippingOptions:d}=n;e=(0,w.mS)(),e=(0,A.bbG)(e,r,o),d?.length?(e=(0,A.oFy)(e,d,o),e=(0,A.lwH)(e,i.tn.Shipping,o)):e=(0,A.lwH)(e,i.tn.Checkout,o),(0,w.UF)(e)}(e,d,s,o,n)}),(0,w.aJ)("openInvoice",async(e,t,a)=>{const{tabId:s=(0,u.g0)(),...o}=a,n=(0,$e.jA)(e,o);if(!n)return;e=(0,M.w)(e,{isPaymentFormLoading:!0},s),(0,w.UF)(e);const r=(0,Re.A)(),d=await(0,b.px)("getPaymentForm",n,r);if(d){if(e=(0,w.mS)(),e=(0,M.w)(e,{isPaymentFormLoading:!1},s),"error"in d)return(0,w.UF)(e),void Ze(d.error,s);"regular"===d.type&&(e=(0,A._$X)(e,{inputInvoice:a,form:d,isPaymentModalOpen:!0,isExtendedMedia:a.isExtendedMedia,status:void 0},s),e=(0,A.lwH)(e,i.tn.Checkout,s)),"stars"===d.type&&(e=(0,M.w)(e,{starsPayment:{inputInvoice:o,form:d,status:"pending"}},s)),(0,w.UF)(e)}}),(0,w.aJ)("sendStarGift",(e,t,a)=>{const{gift:s,peerId:o,message:n,shouldHideName:i,shouldUpgrade:r,tabId:d=(0,u.g0)()}=a;Qe(e,{type:"stargift",peerId:o,giftId:s.id,message:n,shouldHideName:i,shouldUpgrade:r||void 0},s.stars,d)}),(0,w.aJ)("buyStarGift",(e,t,a)=>{const{slug:s,peerId:o,price:n,tabId:i=(0,u.g0)()}=a;Qe(e,{type:"stargiftResale",slug:s,peerId:o,currency:n.currency},n.amount,i)}),(0,w.aJ)("sendPremiumGiftByStars",(e,t,a)=>{const{userId:s,months:o,amount:n,message:i,tabId:r=(0,u.g0)()}=a;Qe(e,{type:"premiumGiftStars",userId:s,months:o,message:i},n,r)}),(0,w.aJ)("getReceipt",async(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=s&&(0,C.hds)(e,s);if(!o||!i)return;const r=await(0,b.px)("getReceipt",i,o);r&&(e=(0,w.mS)(),e="stars"===r.receipt.type?(0,A.MeL)(e,r.receipt,n):(0,A.lEm)(e,r.receipt,n),(0,w.UF)(e))}),(0,w.aJ)("clearPaymentError",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,s).payment,error:void 0}},s),(0,w.UF)(e)}),(0,w.aJ)("clearReceipt",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{payment:{...(0,C.nTw)(e,s).payment,receipt:void 0}},s)}),(0,w.aJ)("sendCredentialsInfo",(e,t,a)=>{const{credentials:o,tabId:n=(0,u.g0)()}=a,{nativeProvider:r}=(0,C.nTw)(e,n).payment.form,{data:d}=o;if("stripe"===r){const t=(0,C.EGt)(e,n);if(!t)return;!async function(e,t,a,...[s=(0,u.g0)()]){const o=function(e){const t=Object.keys(e).map(t=>`${t}=${e[t]}`).join("&");return t.length>0?`?${t}`:""}({"card[number]":t.cardNumber,"card[exp_month]":t.expiryMonth,"card[exp_year]":t.expiryYear,"card[cvc]":t.cvv,"card[address_zip]":t.zip,"card[address_country]":t.country}),n=await fetch(`https://api.stripe.com/v1/tokens${o}`,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Bearer ${a}`}}),r=await n.json();if(r.error){const t=function(e){const{message:t,code:a,param:s}=e,{field:o,message:n}=s?Xe[s]:Xe[a];return{field:o,message:n,description:t}}(r.error);return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,s).payment,status:"failed",error:{...t}}},s),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.yQW)(e,{type:r.type,id:r.id},s),e=(0,A.lwH)(e,i.tn.Checkout,s),(0,w.UF)(e)}(e,d,t,n)}else if("smartglocal"===r){const t=(0,C.Kt9)(e,n);if(!t)return;!async function(e,t,a,...[o=(0,u.g0)()]){const n={card:{number:t.cardNumber.replace(/\D+/g,""),expiration_month:t.expiryMonth,expiration_year:t.expiryYear,security_code:t.cvv.replace(/\D+/g,"")}},r=(0,C.nTw)(e,o).payment.form?.nativeParams.tokenizeUrl;let d;d=s.qKY?"https://tgb-playground.smart-glocal.com/cds/v1/tokenize/card":"https://tgb.smart-glocal.com/cds/v1/tokenize/card",r?.startsWith("https://")&&r.endsWith(".smart-glocal.com/cds/v1/tokenize/card")&&(d=r);const c=await fetch(d,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-PUBLIC-TOKEN":a},body:JSON.stringify(n)}),l=await c.json();if("ok"!==l.status){const t={descriptionKey:{key:"ErrorUnexpected"}};return e=(0,w.mS)(),e=(0,M.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:{...t}}},o),void(0,w.UF)(e)}e=(0,w.mS)(),e=(0,A.Mac)(e,{type:"card",token:l.data.token},o),e=(0,A.lwH)(e,i.tn.Checkout,o),(0,w.UF)(e)}(e,d,t,n)}}),(0,w.aJ)("sendPaymentForm",async(e,t,a)=>{const{shippingOptionId:s,saveCredentials:o,savedCredentialId:n,tipAmount:i,tabId:r=(0,u.g0)()}=a,d=(0,C.PGw)(e,r),c=(0,C.nTw)(e,r).payment,{form:l,temporaryPassword:h,inputInvoice:m}=c;if(!m||!l)return;const{nativeProvider:p,formId:g}=l,f=(0,$e.jA)(e,m);if(!f)return;e=(0,A._$X)(e,{status:"pending"},r),(0,w.UF)(e);const I={save:o,data:"stripe"===p?(0,C.e7$)(e,r):(0,C.G4m)(e,r)};await(0,b.px)("sendPaymentForm",{inputInvoice:f,formId:g,credentials:I,requestedInfoId:d,shippingOptionId:s,savedCredentialId:n,temporaryPassword:h?.value,tipAmount:i})&&(e=(0,w.mS)(),e=(0,A._$X)(e,{status:"paid"},r),e=(0,A.cYc)(e,r),(0,w.UF)(e),t.apiUpdate({"@type":"updatePaymentStateCompleted",paymentState:c,tabId:r}))}),(0,w.aJ)("sendStarPaymentForm",async(e,t,a)=>{const{directInfo:s,tabId:o=(0,u.g0)()}=a,n=(0,C.Osl)(e,o),i=n?.inputInvoice||s?.inputInvoice;if(!i)return;const r=(0,$e.jA)(e,i);if(!r)return;const d=n.form?.formId||n.subscriptionInfo?.subscriptionFormId||s?.formId;e=(0,A.nv6)(e,{status:"pending"},o),(0,w.UF)(e);const c=await(0,b.px)("sendStarPaymentForm",{inputInvoice:r,formId:d});if(!c)return e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"failed"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),void t.closeGiftModal({tabId:o});e=(0,w.mS)(),e=(0,A.nv6)(e,{status:"paid"},o),(0,w.UF)(e),t.closeStarsPaymentModal({tabId:o}),"channelId"in c&&t.openChat({id:c.channelId,tabId:o}),t.apiUpdate({"@type":"updateStarPaymentStateCompleted",paymentState:s?{inputInvoice:i}:n,tabId:o}),t.loadStarStatus()}),(0,w.aJ)("setSmartGlocalCardInfo",(e,t,a)=>{const{tabId:s=(0,u.g0)(),type:o,token:n}=a;return(0,A.Mac)(e,{type:o,token:n},s)}),(0,w.aJ)("setPaymentStep",(e,t,a)=>{const{step:s,tabId:o=(0,u.g0)()}=a;return(0,A.lwH)(e,s??i.tn.Checkout,o)}),(0,w.aJ)("closePremiumModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);if(o.premiumModal)return(0,M.w)(e,{premiumModal:{promo:o.premiumModal.promo,isOpen:!1}},s)}),(0,w.aJ)("openPremiumModal",async(e,t,a)=>{const{initialSection:s,fromUserId:o,isSuccess:n,isGift:i,daysAmount:r,toUserId:d,gift:c,tabId:l=(0,u.g0)()}=a||{};t.loadPremiumStickers();const h=await(0,b.px)("fetchPremiumPromo");h&&(e=(0,w.mS)(),e=(0,M.w)(e,{premiumModal:{promo:h.promo,initialSection:s,isOpen:!0,fromUserId:o,toUserId:d,isGift:i,daysAmount:r,isSuccess:n,gift:c}},l),(0,w.UF)(e),t.closeReactionPicker({tabId:l}))}),(0,w.aJ)("openGiveawayModal",async(e,t,a)=>{const{chatId:s,prepaidGiveaway:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s);if(!i)return;const r=await(0,b.px)("getPremiumGiftCodeOptions",{chat:i}),d=await(0,b.px)("fetchStarsGiveawayOptions");r&&d&&(e=(0,w.mS)(),e=(0,M.w)(e,{giveawayModal:{chatId:s,gifts:r,isOpen:!0,prepaidGiveaway:o,starOptions:d}},n),(0,w.UF)(e))}),(0,w.aJ)("checkCanSendGift",async(e,t,a)=>{const{gift:s,onSuccess:o,tabId:n=(0,u.g0)()}=a;if("starGift"!==s.type||!s.lockedUntilDate)return void o();const i=await(0,b.px)("fetchCheckCanSendGift",{giftId:s.id});i&&(i?.canSend?o():t.openLockedGiftModalInfo({untilDate:"starGift"===s.type?s.lockedUntilDate:void 0,reason:i.reason,tabId:n}))}),(0,w.aJ)("openGiftModal",async(e,t,a)=>{const{forUserId:s,selectedGift:o,selectedResaleGift:n,tabId:i=(0,u.g0)()}=a;if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:i});const r=await(0,b.px)("getPremiumGiftCodeOptions",{});r&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftModal:{forPeerId:s,gifts:r,selectedResaleGift:n,selectedGift:o}},i),(0,w.UF)(e))}),(0,w.aJ)("openStarsGiftModal",async(e,t,a)=>{const{forUserId:s,tabId:o=(0,u.g0)()}=a||{};if((0,C.trm)(e))return void t.openFrozenAccountModal({tabId:o});const n=s?(0,C.hds)(e,s):void 0;if(s&&!n)return;const i=await(0,b.px)("fetchStarsGiftOptions",{chat:n});e=(0,w.mS)(),e=(0,M.w)(e,{starsGiftModal:{isOpen:!0,forUserId:s,starsGiftOptions:i}},o),(0,w.UF)(e)}),(0,w.aJ)("validatePaymentPassword",async(e,t,a)=>{const{password:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("fetchTemporaryPaymentPassword",s);e=(0,w.mS)(),e=n?"error"in n?(0,A._$X)(e,{error:{messageKey:n.messageKey,field:"password"}},o):(0,A._$X)(e,{temporaryPassword:n,step:i.tn.Checkout},o):(0,A._$X)(e,{error:{messageKey:{key:"ErrorUnexpected"},field:"password"}},o),(0,w.UF)(e)}),(0,w.aJ)("openBoostModal",async(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.hds)(e,s);if(!n||!(0,S.WX)(n)&&!(0,S.Vs)(n))return;e=(0,M.w)(e,{boostModal:{chatId:s}},o),(0,w.UF)(e);const i=await(0,b.px)("fetchBoostStatus",{chat:n});if(!i)return void t.closeBoostModal({tabId:o});e=(0,w.mS)(),e=(0,M.w)(e,{boostModal:{chatId:s,boostStatus:i}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchMyBoosts");if(!r)return;e=(0,w.mS)();const d=(0,C.nTw)(e,o);d.boostModal&&(e=(0,M.w)(e,{boostModal:{...d.boostModal,myBoosts:r.boosts}},o),(0,w.UF)(e))}),(0,w.aJ)("openBoostStatistics",async(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.hds)(e,s);if(!n)return;e=(0,M.w)(e,{boostStatistics:{chatId:s}},o),(0,w.UF)(e);const[i,r,d]=await Promise.all([(0,b.px)("fetchBoostList",{chat:n}),(0,b.px)("fetchBoostList",{chat:n,isGifts:!0}),(0,b.px)("fetchBoostStatus",{chat:n})]);if(e=(0,w.mS)(),!i||!r||!d)return e=(0,M.w)(e,{boostStatistics:void 0},o),void(0,w.UF)(e);e=(0,M.w)(e,{boostStatistics:{chatId:s,boostStatus:d,nextOffset:i.nextOffset,boosts:{count:i.count,list:i.boostList},giftedBoosts:{count:r?.count,list:r?.boostList}}},o),(0,w.UF)(e)}),(0,w.aJ)("openMonetizationStatistics",(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a;(0,C.hds)(e,s)&&(e=(0,M.w)(e,{monetizationStatistics:{chatId:s}},o),(0,w.UF)(e))}),(0,w.aJ)("loadMoreBoosters",async(e,t,a)=>{const{isGifts:s,tabId:o=(0,u.g0)()}=a||{};let n=(0,C.nTw)(e,o);if(!n.boostStatistics)return;const i=(0,C.hds)(e,n.boostStatistics.chatId);if(!i)return;e=(0,M.w)(e,{boostStatistics:{...n.boostStatistics,isLoadingBoosters:!0}},o),(0,w.UF)(e);const r=await(0,b.px)("fetchBoostList",{chat:i,offset:n.boostStatistics.nextOffset,isGifts:s});if(!r)return;if(e=(0,w.mS)(),n=(0,C.nTw)(e,o),!n.boostStatistics)return;const d=(s?n.boostStatistics.giftedBoosts?.list||[]:n.boostStatistics.boosts?.list||[]).concat(r.boostList);e=(0,M.w)(e,{boostStatistics:{...n.boostStatistics,nextOffset:r.nextOffset,isLoadingBoosters:!1,[s?"giftedBoosts":"boosts"]:{count:r.count,list:d}}},o),(0,w.UF)(e)}),(0,w.aJ)("applyBoost",async(e,t,a)=>{const{chatId:s,slots:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s);if(!i)return;const r=(0,C.AWZ)(e,s),d=r?.boostsApplied||0,c=o.length;let l=(0,C.nTw)(e,n);const h=l.boostModal?.boostStatus;if(h){const t=h.nextLevelBoosts?h.nextLevelBoosts-h.currentLevelBoosts:1,a=h.boosts+c,s=h.nextLevelBoosts&&a>=h.nextLevelBoosts,o=s?h.nextLevelBoosts:h.currentLevelBoosts,i=s?h.nextLevelBoosts+t:h.nextLevelBoosts;e=(0,M.w)(e,{boostModal:{...l.boostModal,boostStatus:{...h,level:s?h.level+1:h.level,currentLevelBoosts:o,nextLevelBoosts:i,hasMyBoost:!0,boosts:a}}},n),(0,w.UF)(e)}e=(0,w.mS)(),l=(0,C.nTw)(e,n);const m=l.boostModal?.myBoosts;if(m){const t=(0,v.Fm)(),a=m.map(e=>o.includes(e.slot)?{...e,chatId:s,date:t,cooldownUntil:t+86400}:e);e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:a}},n),(0,w.UF)(e)}const p=await(0,b.px)("applyBoost",{slots:o,chat:i});if(e=(0,w.mS)(),!p){const t=(0,C.nTw)(e,n).boostModal;return void(t&&(e=(0,M.w)(e,{boostModal:{...t,boostStatus:h,myBoosts:m}},n),(0,w.UF)(e)))}l=(0,C.nTw)(e,n),r&&(e=(0,A.ltr)(e,s,{boostsApplied:d+o.length})),l.boostModal&&(e=(0,M.w)(e,{boostModal:{...l.boostModal,myBoosts:p.boosts}},n)),(0,w.UF)(e)}),(0,w.aJ)("checkGiftCode",async(e,t,a)=>{const{slug:s,message:o,tabId:n=(0,u.g0)()}=a,i=await(0,b.px)("checkGiftCode",{slug:s});i?(e=(0,w.mS)(),e=(0,M.w)(e,{giftCodeModal:{slug:s,info:i.code,message:o}},n),(0,w.UF)(e)):t.showNotification({message:f.yE("lng_gift_link_expired"),tabId:n})}),(0,w.aJ)("applyGiftCode",async(e,t,a)=>{const{slug:s,tabId:o=(0,u.g0)()}=a;await(0,b.px)("applyGiftCode",{slug:s})&&(t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftCodeModal({tabId:o}))}),(0,w.aJ)("launchPrepaidGiveaway",async(e,t,a)=>{const{chatId:s,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=a,r=(0,C.hds)(e,s);if(!r)return;const d=n?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"giveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount}})&&t.openBoostStatistics({chatId:s,tabId:i})}),(0,w.aJ)("launchPrepaidStarsGiveaway",async(e,t,a)=>{const{chatId:s,giveawayId:o,paymentPurpose:n,tabId:i=(0,u.g0)()}=a,r=(0,C.hds)(e,s);if(!r)return;const d=n?.additionalChannelIds?.map(t=>(0,C.hds)(e,t)).filter(Boolean);await(0,b.px)("launchPrepaidGiveaway",{chat:r,giveawayId:o,paymentPurpose:{type:"starsgiveaway",chat:r,areWinnersVisible:n?.areWinnersVisible,additionalChannels:d,countries:n?.countries,prizeDescription:n.prizeDescription,untilDate:n.untilDate,currency:n.currency,amount:n.amount,stars:n.stars,users:n.users}})&&t.openBoostStatistics({chatId:s,tabId:i})}),(0,w.aJ)("upgradeGift",async(e,t,a)=>{const{gift:s,shouldKeepOriginalDetails:o,upgradeStars:n,tabId:i=(0,u.g0)()}=a,r=(0,$e.HT)(e,s);if(r){if(e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftUpgradeModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),!n){const a=await(0,b.px)("upgradeStarGift",{inputSavedGift:r,shouldKeepOriginalDetails:o||void 0});return e=(0,w.mS)(),void(a&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId}))}Qe(e,{type:"stargiftUpgrade",inputSavedGift:s,shouldKeepOriginalDetails:o||void 0},n,i)}}),(0,w.aJ)("transferGift",(e,t,a)=>{const{gift:s,recipientId:o,transferStars:n,tabId:i=(0,u.g0)()}=a,r=(0,C.hds)(e,o),d=(0,$e.HT)(e,s);r&&d&&(e=(0,M.w)(e,{isWaitingForStarGiftTransfer:!0},i),(0,w.UF)(e),e=(0,w.mS)(),t.closeGiftTransferModal({tabId:i}),t.closeGiftInfoModal({tabId:i}),n?Qe(e,{type:"stargiftTransfer",inputSavedGift:s,recipientId:o},n,i):(0,b.px)("transferStarGift",{inputSavedGift:d,toPeer:r}))}),(0,w.aJ)("removeGiftDescription",(e,t,a)=>{const{gift:s,price:o,tabId:n=(0,u.g0)()}=a;Qe(e,{type:"stargiftDropOriginalDetails",inputSavedGift:s},o,n)}),(0,w.aJ)("upgradePrepaidGift",(e,t,a)=>{const{peerId:s,hash:o,stars:n,tabId:i=(0,u.g0)()}=a;Qe(e,{type:"stargiftPrepaidUpgrade",peerId:s,hash:o},n,i)}),(0,w.aJ)("sendStarGiftAuctionBid",(e,t,a)=>{const{giftId:s,bidAmount:o,peerId:n,message:i,shouldHideName:r,isUpdateBid:d,tabId:c=(0,u.g0)()}=a;Qe(e,{type:"stargiftAuctionBid",giftId:s,bidAmount:o,peerId:n,message:i,shouldHideName:r,isUpdateBid:d},o,c)}),(0,w.aJ)("openUniqueGiftBySlug",async(e,t,a)=>{const{slug:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("fetchUniqueStarGift",{slug:s});n?t.openGiftInfoModal({gift:n,tabId:o}):t.showNotification({message:{key:"GiftWasNotFound"},tabId:o})}),(0,w.aJ)("openGiftAuctionBySlug",async(e,t,a)=>{const{slug:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("fetchStarGiftAuctionState",{slug:s});n?t.openGiftAuctionModal({gift:n.gift,tabId:o}):t.showNotification({message:{key:"GiftWasNotFound"},tabId:o})}),(0,w.aJ)("processStarGiftWithdrawal",async(e,t,a)=>{const{gift:s,password:o,tabId:n=(0,u.g0)()}=a;let i=(0,C.nTw)(e,n).giftWithdrawModal;if(!i)return;e=(0,M.w)(e,{giftWithdrawModal:{...i,isLoading:!0,errorKey:void 0}},n),(0,w.UF)(e);const r=(0,$e.HT)(e,s);if(!r)return;const d=await(0,b.px)("fetchStarGiftWithdrawalUrl",{inputGift:r,password:o});if(d&&(e=(0,w.mS)(),i=(0,C.nTw)(e,n).giftWithdrawModal,i)){if("error"in d)return e=(0,M.w)(e,{giftWithdrawModal:{...i,isLoading:!1,errorKey:d.messageKey}},n),void(0,w.UF)(e);t.openUrl({url:d.url,tabId:n}),t.closeGiftWithdrawModal({tabId:n})}});var et=a(13235);(0,w.aJ)("loadStarStatus",async e=>{const t=e.stars,a=!t?.topupOptions,[o,n,i]=await Promise.all([(0,b.px)("fetchStarsStatus"),(0,b.px)("fetchStarsStatus",{isTon:!0}),a?(0,b.px)("fetchStarsTopupOptions"):void 0]);!o&&!n||a&&!i||(e=(0,w.mS)(),o&&o.balance.currency===s.OUy&&(e={...e,stars:{...t,balance:o.balance,topupOptions:i||t.topupOptions,history:{all:void 0,inbound:void 0,outbound:void 0},subscriptions:void 0}},o.history&&(e=(0,A.Psh)(e,"all",o.history,o.nextHistoryOffset)),o.subscriptions&&(e=(0,A.qEh)(e,o.subscriptions,o.nextSubscriptionOffset))),n?.balance.currency===s.ykW&&(e={...e,ton:{...n,balance:n.balance,history:{all:void 0,inbound:void 0,outbound:void 0}}},e=(0,A.L_F)(e,n.balance),n.history&&(e=(0,A.Psh)(e,"all",n.history,n.nextHistoryOffset,!0))),(0,w.UF)(e))}),(0,w.aJ)("loadStarsTransactions",async(e,t,a)=>{const{type:s,isTon:o}=a,n=o?e.ton?.history[s]:e.stars?.history[s],i=n?.nextOffset;if(n&&!i)return;const r=await(0,b.px)("fetchStarsTransactions",{isInbound:"inbound"===s,isOutbound:"outbound"===s,offset:i||"",isTon:o});r&&(e=(0,w.mS)(),e=(0,A.L_F)(e,r.balance),r.history&&(e=(0,A.Psh)(e,s,r.history,r.nextOffset,o)),(0,w.UF)(e))}),(0,w.aJ)("loadStarGifts",async e=>{const t=await(0,b.px)("fetchStarGifts");if(!t)return;e=(0,w.mS)();const a=(0,h.dU)(t.gifts,"id"),s=Object.keys(a),o=Object.values(a).map(e=>e.availabilityResale||e.isLimited&&!e.isSoldOut?e.id:void 0).filter(Boolean);e={...e,starGifts:{byId:a,idsByCategory:{all:s,collectible:o,myUnique:[]}}},(0,w.UF)(e)}),(0,w.aJ)("loadMyUniqueGifts",async(e,t,a)=>{const{shouldRefresh:s}=a||{},o=e.currentUserId;if(!o)return;const n=e.myUniqueGifts,i=n?.nextOffset;if(n&&!i&&!s)return;const r=(0,C.PVB)(e,o);if(!r)return;const d=await(0,b.px)("fetchSavedStarGifts",{peer:r,offset:s?void 0:i,filter:{sortType:"byDate",shouldIncludeUnique:!0,shouldIncludeUnlimited:!1,shouldIncludeUpgradable:!1,shouldIncludeLimited:!1,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0}});if(!d)return;e=(0,w.mS)();const c=d.gifts,l=(0,h.pA)(c,e=>[e.gift.id,e]),u=c.map(e=>e.gift.id);e={...e,myUniqueGifts:{byId:{...!s&&(e.myUniqueGifts?.byId||{}),...l},ids:[...s?[]:e.myUniqueGifts?.ids||[],...u],nextOffset:d.nextOffset}},(0,w.UF)(e)}),(0,w.aJ)("updateResaleGiftsFilter",(e,t,a)=>{const{filter:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);e=(0,M.w)(e,{resaleGifts:{...n.resaleGifts,filter:s}},o),n.resaleGifts.giftId&&t.loadResaleGifts({giftId:n.resaleGifts.giftId,shouldRefresh:!0,tabId:o}),(0,w.UF)(e)}),(0,w.aJ)("loadResaleGifts",async(e,t,a)=>{const{giftId:s,shouldRefresh:o,tabId:n=(0,u.g0)()}=a;let i=(0,C.nTw)(e,n);if(i.resaleGifts.isLoading||i.resaleGifts.isAllLoaded&&!o)return;e=(0,M.w)(e,{resaleGifts:{...i.resaleGifts,isLoading:!0,...o&&{count:0,nextOffset:void 0,isAllLoaded:!1}}},n),(0,w.UF)(e),e=(0,w.mS)(),i=(0,C.nTw)(e,n);const r=i.resaleGifts.nextOffset,d=i.resaleGifts.attributesHash,c=i.resaleGifts.filter,l=await(0,b.px)("fetchResaleGifts",{giftId:s,offset:r,limit:et.bc,attributesHash:d,filter:c});if(!l)return;const{chats:m,users:p}=l;e=(0,w.mS)(),i=(0,C.nTw)(e,n);const g=i.resaleGifts.gifts,f=o?l.gifts:g.concat(l.gifts),I=i.resaleGifts.updateIteration,v=i.resaleGifts.giftId!==s||o?I+1:I;e=(0,M.w)(e,{resaleGifts:{...i.resaleGifts,giftId:s,count:l.count||i.resaleGifts.count,gifts:f,attributes:l.attributes||i.resaleGifts.attributes,counters:l.counters||i.resaleGifts.counters,attributesHash:l.attributesHash,nextOffset:l.nextOffset,isLoading:!1,isAllLoaded:!l.nextOffset,updateIteration:v}},n),e=(0,A.CKT)(e,(0,h.dU)(p,"id")),e=(0,A.h7P)(e,(0,h.dU)(m,"id")),(0,w.UF)(e)}),(0,w.aJ)("resetResaleGifts",(e,t,a)=>{const{tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o);return(0,M.w)(e,{resaleGifts:{updateIteration:n.resaleGifts.updateIteration+1,filter:s.hYe,count:0,gifts:[]}},o)}),(0,w.aJ)("loadPeerSavedGifts",async(e,t,a)=>{const{peerId:s,shouldRefresh:o,tabId:n=(0,u.g0)()}=a,i=(0,C.PVB)(e,s);if(!i)return;e=(0,w.mS)();const r=(0,C.B59)(e,s,n),d=(0,C.HS0)(e,s,r,n),c=d?.nextOffset;if(!o&&d&&!c)return;const l=(0,C.w0X)(e,s,n),h=await(0,b.px)("fetchSavedStarGifts",{peer:i,offset:o?"":c,filter:l,collectionId:"all"===r?void 0:r});e=(0,w.mS)();const m=(0,C.w0X)(e,s,n),p=(0,C.B59)(e,s,n);if(!h||p!==r||m!==l)return;const g=d&&!o?d.gifts.concat(h.gifts):h.gifts;e=(0,A.xOA)(e,s,g,h.nextOffset,n),(0,w.UF)(e)}),(0,w.aJ)("reloadPeerSavedGifts",(e,t,a)=>{const{peerId:s}=a;Object.values(e.byTabId).forEach(a=>{const o=(0,C.B59)(e,s,a.id);(0,C.HS0)(e,s,o,a.id)&&t.loadPeerSavedGifts({peerId:s,shouldRefresh:!0,tabId:a.id})}),s===e.currentUserId&&t.loadMyUniqueGifts({shouldRefresh:!0})}),(0,w.aJ)("loadStarsSubscriptions",async e=>{const t=e.stars?.subscriptions,a=t?.nextOffset;if(t&&!a)return;e=(0,A.Yzx)(e,!0),(0,w.UF)(e);const o=await(0,b.px)("fetchStarsSubscriptions",{offset:a||""});o&&o.balance.currency===s.OUy&&(e=(0,w.mS)(),e=(0,A.L_F)(e,o.balance),e=(0,A.qEh)(e,o.subscriptions,o.nextOffset),(0,w.UF)(e))}),(0,w.aJ)("changeStarsSubscription",async(e,t,a)=>{const{peerId:s,id:o,isCancelled:n}=a,i=s?(0,C.PVB)(e,s):void 0;s&&!i||(await(0,b.px)("changeStarsSubscription",{peer:i,subscriptionId:o,isCancelled:n}),t.loadStarStatus())}),(0,w.aJ)("fulfillStarsSubscription",async(e,t,a)=>{const{peerId:s,id:o}=a,n=s?(0,C.PVB)(e,s):void 0;s&&!n||(await(0,b.px)("fulfillStarsSubscription",{peer:n,subscriptionId:o}),t.loadStarStatus())}),(0,w.aJ)("changeGiftVisibility",async(e,t,a)=>{const{gift:s,shouldUnsave:o,tabId:n=(0,u.g0)()}=a,i="user"===s.type?e.currentUserId:s.chatId,r=(0,$e.HT)(e,s);if(!r)return;const d=(0,C.B59)(e,i,n),c=(0,C.nTw)(e,n).savedGifts.collectionsByPeerId[i]?.[d];if(c?.gifts?.length){const t=c.gifts.map(e=>e.inputGift&&(0,$e.j6)(e.inputGift,s)?{...e,isUnsaved:o}:e);e=(0,A.xOA)(e,i,t,c.nextOffset,n),(0,w.UF)(e)}const l=await(0,b.px)("saveStarGift",{inputGift:r,shouldUnsave:o});if(e=(0,w.mS)(),!l)return e=(0,A.xOA)(e,i,c.gifts,c.nextOffset,n),void(0,w.UF)(e);t.reloadPeerSavedGifts({peerId:i})}),(0,w.aJ)("convertGiftToStars",async(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a,n=(0,$e.HT)(e,s);if(!n)return;if(!await(0,b.px)("convertStarGift",{inputSavedGift:n}))return;const i="user"===s.type?e.currentUserId:s.chatId;t.reloadPeerSavedGifts({peerId:i}),t.openStarsBalanceModal({tabId:o})}),(0,w.aJ)("openGiftUpgradeModal",async(e,t,a)=>{const{giftId:s,gift:o,peerId:n,tabId:i=(0,u.g0)()}=a,r=await(0,b.px)("fetchStarGiftUpgradePreview",{giftId:s});if(!r)return;const d=(0,v.Fm)(),c=r.prices.filter(e=>e.date>d),l=r.nextPrices.filter(e=>e.date>d),h=r.nextPrices.filter(e=>e.date<=d),m="starGift"===o?.gift.type?o.gift:void 0,p=h.length?h[h.length-1].upgradeStars:m?.upgradeStars,g=r.prices[0]?.upgradeStars,f=r.prices.at(-1)?.upgradeStars;e=(0,w.mS)(),e=(0,M.w)(e,{giftUpgradeModal:{recipientId:n,gift:o,sampleAttributes:r.sampleAttributes,prices:c,nextPrices:l,currentUpgradeStars:p,minPrice:f,maxPrice:g}},i),(0,w.UF)(e)}),(0,w.aJ)("shiftGiftUpgradeNextPrice",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s),n=o?.giftUpgradeModal;if(!n?.nextPrices?.length)return;const i=n.nextPrices[0].upgradeStars,r=n.nextPrices.slice(1);if(r.length)return e=(0,M.w)(e,{giftUpgradeModal:{...n,nextPrices:r,currentUpgradeStars:i}},s),void(0,w.UF)(e);const d=n.gift?.gift,c="starGift"===d?.type?d.id:void 0;if(!c)return;const l=await(0,b.px)("fetchStarGiftUpgradePreview",{giftId:c});if(!l)return;const h=(0,v.Fm)(),m=l.nextPrices.filter(e=>e.date>h);e=(0,w.mS)();const p=(0,C.nTw)(e,s),g=p?.giftUpgradeModal;g&&(e=(0,M.w)(e,{giftUpgradeModal:{...g,nextPrices:m,currentUpgradeStars:i}},s),(0,w.UF)(e))}),(0,w.aJ)("openGiftAuctionModal",async(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a;await(0,w.pv)().loadActiveGiftAuction({giftId:s.id,tabId:o}),e=(0,w.mS)(),e=(0,M.w)(e,{giftAuctionModal:{isOpen:!0}},o),(0,w.UF)(e)}),(0,w.aJ)("loadActiveGiftAuction",async(e,t,a)=>{const{giftId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o).activeGiftAuction,i="active"===n?.state.type?n.state.version:0,r=await(0,b.px)("fetchStarGiftAuctionState",{giftId:s,version:i});r&&(e=(0,w.mS)(),e=(0,A.laC)(e,r,o),(0,w.UF)(e))}),(0,w.aJ)("clearActiveGiftAuction",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{activeGiftAuction:void 0},s)}),(0,w.aJ)("toggleSavedGiftPinned",async(e,t,a)=>{const{gift:s,peerId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.PVB)(e,o);if(!i)return;const r=(0,C.FDg)(e,o,n);if(!r)return;const d=e.appConfig.savedGiftPinLimit,c=r.gifts.filter(e=>e.isPinned),l=s.isPinned?c.filter(e=>e.gift.slug!==s.gift.slug):[...c,s],h=(d?l.slice(-d):l).map(t=>(0,$e.HT)(e,t.inputGift)).filter(Boolean);await(0,b.px)("toggleSavedGiftPinned",{inputSavedGifts:h,peer:i})&&t.reloadPeerSavedGifts({peerId:o})}),(0,w.aJ)("updateStarGiftPrice",async(e,t,a)=>{const{gift:s,price:o}=a,n=(0,$e.HT)(e,s);n&&await(0,b.px)("updateStarGiftPrice",{inputSavedGift:n,price:o})&&t.reloadPeerSavedGifts({peerId:e.currentUserId})}),(0,w.aJ)("loadStarGiftCollections",async(e,t,a)=>{const{peerId:s,hash:o}=a,n=(0,C.PVB)(e,s);if(!n)return;const i=await(0,b.px)("fetchStarGiftCollections",{peer:n,hash:o});i&&(e=(0,w.mS)(),e=(0,A.thC)(e,s,i.collections),(0,w.UF)(e))}),(0,w.aJ)("openGiftAuctionAcquiredModal",async(e,t,a)=>{const{giftId:s,giftTitle:o,giftSticker:n,tabId:i=(0,u.g0)()}=a,r=await(0,b.px)("fetchStarGiftAuctionAcquiredGifts",{giftId:s});r&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftAuctionAcquiredModal:{giftId:s,giftTitle:o,giftSticker:n,acquiredGifts:r.gifts}},i),(0,w.UF)(e))});var tt=a(58554);let at=0;(0,w.aJ)("loadAvailableReactions",async e=>{const t=await(0,b.px)("fetchAvailableReactions");t&&(t.forEach(e=>{e.aroundAnimation&&tt.hd(`sticker${e.aroundAnimation.id}`,n.qZ.BlobUrl),e.centerIcon&&tt.hd(`sticker${e.centerIcon.id}`,n.qZ.BlobUrl),e.appearAnimation&&tt.hd(`sticker${e.appearAnimation.id}`,n.qZ.BlobUrl),e.selectAnimation&&tt.hd((0,S.mr)(e.selectAnimation,"full"),n.qZ.BlobUrl)}),e=(0,w.mS)(),e={...e,reactions:{...e.reactions,availableReactions:t}},(0,w.UF)(e),(0,Ne.A)({action:"loadAvailableReactions",payload:void 0},s.npx))}),(0,w.aJ)("loadAvailableEffects",async e=>{const t=await(0,b.px)("fetchAvailableEffects");if(!t)return;const{effects:a,emojis:s,stickers:o}=t,n=[],i=(0,h.dU)(a,"id");for(const e of a)if(e.effectAnimationId){const t={type:"emoji",emoticon:e.emoticon};n.push(t)}e=(0,w.mS)(),e={...e,availableEffectById:i,stickers:{...e.stickers,effect:{stickers:o,emojis:s}},reactions:{...e.reactions,effectReactions:n}},(0,w.UF)(e)}),(0,w.aJ)("interactWithAnimatedEmoji",(e,t,a)=>{const{emoji:s,x:o,y:n,startSize:i,isReversed:r,tabId:d=(0,u.g0)()}=a,c={id:at++,animatedEffect:s,x:L(e,o)+40*Math.random()-20,y:n+40*Math.random()-20,startSize:i,isReversed:r};return(0,M.w)(e,{activeEmojiInteractions:[...(0,C.nTw)(e,d).activeEmojiInteractions||[],c]},d)}),(0,w.aJ)("sendEmojiInteraction",(e,t,a)=>{const{messageId:s,chatId:o,emoji:n,interactions:i}=a;if("connectionStateReady"!==e.connectionState)return;const r=(0,C.hds)(e,o);r&&n&&!(0,C.nZ4)(e,o)&&(0,b.px)("sendEmojiInteraction",{chat:r,messageId:s,emoticon:n,timestamps:i})}),(0,w.aJ)("sendDefaultReaction",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.nTJ)(e,s),r=(0,C.O5q)(e,s,o);i&&r&&!(0,S.Nb)(r)&&t.toggleReaction({chatId:s,messageId:o,reaction:i,tabId:n})}),(0,w.aJ)("toggleReaction",async(e,t,a)=>{const{chatId:s,reaction:o,shouldAddToRecent:n,tabId:i=(0,u.g0)()}=a;let{messageId:r}=a;const d=(0,C.hds)(e,s);let c=(0,C.O5q)(e,s,r);if(!d||!c)return;const l=(0,C.nZ4)(e,s),p=Boolean(c.groupedId)&&!c.isInAlbum,g=p?(0,C.D_S)(e,s,c.groupedId)[0]:void 0;c=p&&(0,C.O5q)(e,s,g)||c,r=c?.id||r;const f=(0,S.uC)(c),I=f.some(e=>(0,S.a0)(e,o)),v=I?f.filter(e=>!(0,S.a0)(e,o)):[...f,o],y=(0,C.cO5)(e),[A,M]=(0,h.jB)(v,e=>"paid"===e.type),P=M.slice(-y),k=[...A,...P],T=(0,m.bj)(c);(0,C.xYJ)(e,"reactionEffects")&&(I?t.stopActiveReaction({containerId:T,reaction:o,tabId:i}):t.startActiveReaction({containerId:T,reaction:o,tabId:i})),e=G(e,c,k),(0,w.UF)(e);try{await(0,b.px)("sendReaction",{chat:d,messageId:r,reactions:P,shouldAddToRecent:n}),l&&t.loadSavedReactionTags()}catch(t){e=G(e=(0,w.mS)(),c,f),(0,w.UF)(e)}}),(0,w.aJ)("addLocalPaidReaction",(e,t,a)=>{const{chatId:s,messageId:o,count:n,shouldIgnoreDefaultPrivacy:i=!1,tabId:r=(0,u.g0)()}=a,d=e.settings.paidReactionPrivacy,c=i?a.isPrivate:"anonymous"===d?.type,l=i?a.peerId:"peer"===d?.type?d.peerId:void 0,h=(0,C.hds)(e,s),p=(0,C.O5q)(e,s,o);if(!h||!p)return;const g=p.reactions?.results||[],f=(0,S.Ny)(g,n,c,l);e=(0,A.r3y)(e,p.chatId,p.id,{reactions:{...g,results:f}}),(0,w.UF)(e);const I=(0,m.bj)(p);(0,C.xYJ)(e,"reactionEffects")&&t.startActiveReaction({containerId:I,reaction:{type:"paid"},tabId:r})}),(0,w.aJ)("sendPaidReaction",async(e,t,a)=>{const{chatId:s,messageId:o,forcedAmount:n,tabId:i=(0,u.g0)()}=a,r=(0,C.hds)(e,s),d=(0,C.O5q)(e,s,o);if(!r||!d)return;const c=d.reactions?.results?.find(e=>"paid"===e.reaction.type),l=n||c?.localAmount||0;if(l){t.resetLocalPaidReactions({chatId:s,messageId:o});try{await(0,b.px)("sendPaidReaction",{chat:r,messageId:o,count:l,isPrivate:c?.localIsPrivate,peerId:c?.localPeerId})}catch(e){"BALANCE_TOO_LOW"===e.message&&t.openStarsBalanceModal({originReaction:{chatId:s,messageId:o,amount:l},tabId:i})}}}),(0,w.aJ)("startActiveReaction",(e,t,a)=>{const{containerId:s,reaction:o,tabId:n=(0,u.g0)()}=a,i=(0,C.nTw)(e,n);if(!(0,C.xYJ)(e,"reactionEffects"))return;const r=i.activeReactions[s]||[];if(r.some(e=>(0,S.a0)(e,o)))return;const d=r.concat(o);return(0,M.w)(e,{activeReactions:{...i.activeReactions,[s]:d}},n)}),(0,w.aJ)("stopActiveReaction",(e,t,a)=>{const{containerId:s,reaction:o,tabId:n=(0,u.g0)()}=a,i=(0,C.nTw)(e,n),r=i.activeReactions[s]||[],d=o?r.filter(e=>!(0,S.a0)(e,o)):[],c=d.length?{...i.activeReactions,[s]:d}:(0,h.cJ)(i.activeReactions,[s]);return(0,M.w)(e,{activeReactions:c},n)}),(0,w.aJ)("setDefaultReaction",async(e,t,a)=>{const{reaction:s}=a;await(0,b.px)("setDefaultReaction",{reaction:s})&&((e=(0,w.mS)()).config?(e={...e,config:{...e.config,defaultReaction:s}},(0,w.UF)(e)):t.loadConfig())}),(0,w.aJ)("stopActiveEmojiInteraction",(e,t,a)=>{const{id:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{activeEmojiInteractions:(0,C.nTw)(e,o).activeEmojiInteractions?.filter(e=>e.id!==s)},o)}),(0,w.aJ)("loadReactors",async(e,t,a)=>{if((0,C.trm)(e))return;const{chatId:s,messageId:o,reaction:n}=a,i=(0,C.hds)(e,s),r=(0,C.O5q)(e,s,o);if(!i||!r)return;const d=r.reactors?.nextOffset,c=await(0,b.px)("fetchMessageReactionsList",{reaction:n,chat:i,messageId:o,offset:d});c&&(e=(0,w.mS)(),e=(0,A.r3y)(e,s,o,{reactors:c}),(0,w.UF)(e))}),(0,w.aJ)("loadMessageReactions",(e,t,a)=>{if((0,C.trm)(e))return;const{ids:s,chatId:o}=a,n=(0,C.hds)(e,o);n&&"connectionStateReady"===e.connectionState&&(0,b.px)("fetchMessageReactions",{ids:s,chat:n})}),(0,w.aJ)("sendWatchingEmojiInteraction",(e,t,a)=>{const{chatId:s,emoticon:o,x:n,y:i,startSize:r,isReversed:d,id:c,tabId:l=(0,u.g0)()}=a,h=(0,C.hds)(e,s),m=(0,C.nTw)(e,l);if(h&&m.activeEmojiInteractions?.some(e=>e.id===c)&&!(0,C.nZ4)(e,s))return"connectionStateReady"===e.connectionState&&(0,b.px)("sendWatchingEmojiInteraction",{chat:h,emoticon:o}),(0,M.w)(e,{activeEmojiInteractions:m.activeEmojiInteractions.map(t=>t.id===c?{...t,x:L(e,n),y:i,startSize:r,isReversed:d}:t)},l)}),(0,w.aJ)("fetchUnreadReactions",async(e,t,a)=>{const{chatId:s,offsetId:o}=a,n=(0,C.hds)(e,s);if(!n)return;const i=await(0,b.px)("fetchUnreadReactions",{chat:n,offsetId:o,addOffset:o?-1:void 0});if(!i||!i.messages.length)return e=V(e=(0,w.mS)(),s,{unreadReactionsCount:0}),void(0,w.UF)(e);const{messages:r}=i,d=(0,h.dU)(r,"id"),c=Object.keys(d).map(Number);e=(0,w.mS)(),e=V(e=(0,A.o4A)(e,n.id,d),s,{unreadReactions:(0,h.Am)([...n.unreadReactions||[],...c]).sort((e,t)=>t-e)}),(0,w.UF)(e)}),(0,w.aJ)("animateUnreadReaction",(e,t,a)=>{const{messageIds:s,tabId:o=(0,u.g0)()}=a,n=(0,C.meB)(e,o);if(!n)return;if(!n.unreadReactionsCount)return V(e,n.id,{unreadReactions:[]});const i=Math.max(n.unreadReactionsCount-s.length,0),r=(n.unreadReactions||[]).filter(e=>!s.includes(e));e=V(e,n.id,{unreadReactions:r,unreadReactionsCount:i}),(0,w.UF)(e),t.markMessagesRead({messageIds:s,shouldFetchUnreadReactions:!0,tabId:o}),(0,C.xYJ)(e,"reactionEffects")&&(e=(0,w.mS)(),s.forEach(a=>{const s=(0,C.O5q)(e,n.id,a);if(!s)return;const{reaction:o,isOwn:i,isUnread:r}=s.reactions?.recentReactions?.[0]??{};if(o&&r&&!i){const e=(0,m.bj)(s);t.startActiveReaction({containerId:e,reaction:o,tabId:(0,u.g0)()})}}))}),(0,w.aJ)("focusNextReaction",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.meB)(e,s);if(!o?.unreadReactions)return o?.unreadReactionsCount?(0,A.wix)(e,o.id,{unreadReactionsCount:0}):void 0;t.focusMessage({chatId:o.id,messageId:o.unreadReactions[0],tabId:s,scrollTargetPosition:"end"}),t.markMessagesRead({messageIds:[o.unreadReactions[0]],tabId:s})}),(0,w.aJ)("readAllReactions",(e,t,a)=>{const{chatId:s,threadId:o=n.l3}=a,i=(0,C.hds)(e,s);if(i)return(0,b.px)("readAllReactions",{chat:i,threadId:o===n.l3?void 0:o}),o===n.l3?V(e,i.id,{unreadReactionsCount:void 0,unreadReactions:void 0}):void 0}),(0,w.aJ)("loadTopReactions",async e=>{const t=await(0,b.px)("fetchTopReactions",{hash:e.reactions.hash.topReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,topReactions:t.reactions,hash:{...e.reactions.hash,topReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadRecentReactions",async e=>{const t=await(0,b.px)("fetchRecentReactions",{hash:e.reactions.hash.recentReactions});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:t.reactions,hash:{...e.reactions.hash,recentReactions:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("clearRecentReactions",async e=>{await(0,b.px)("clearRecentReactions")&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,recentReactions:[]}},(0,w.UF)(e))}),(0,w.aJ)("loadDefaultTagReactions",async e=>{const t=await(0,b.px)("fetchDefaultTagReactions",{hash:e.reactions.hash.defaultTags});t&&(e=(0,w.mS)(),e={...e,reactions:{...e.reactions,defaultTags:t.reactions,hash:{...e.reactions.hash,defaultTags:t.hash}}},(0,w.UF)(e))}),(0,w.aJ)("loadSavedReactionTags",async e=>{const{hash:t}=e.savedReactionTags||{},a=await(0,b.px)("fetchSavedReactionTags",{hash:t});if(!a)return;e=(0,w.mS)();const s=(0,h.pA)(a.tags,e=>[(0,S.Jj)(e.reaction),e]);e={...e,savedReactionTags:{hash:a.hash,byKey:s}},(0,w.UF)(e)}),(0,w.aJ)("editSavedReactionTag",async(e,t,a)=>{const{reaction:s,title:o}=a;if(!await(0,b.px)("updateSavedReactionTag",{reaction:s,title:o}))return;e=(0,w.mS)();const n=e.savedReactionTags?.byKey;if(!n)return;const i=(0,S.Jj)(s),r={...n[i],title:o};e={...e,savedReactionTags:{...e.savedReactionTags,byKey:{...n,[i]:r}}},(0,w.UF)(e)}),(0,w.aJ)("loadStatistics",async(e,t,a)=>{const{chatId:s,isGroup:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.AWZ)(e,s);if(!i||!r)return;const d=await(0,b.px)(o?"fetchGroupStatistics":"fetchChannelStatistics",{chat:i,dcId:r.statisticsDcId});if(!d)return;const{stats:c}=d;if(e=(0,w.mS)(),e=(0,A.n8l)(e,s,c,n),(0,w.UF)(e),"channel"===c.type){const e=c.recentPosts.filter(e=>"message"===e.type),a=c.recentPosts.filter(e=>"story"===e.type);e.length>0&&t.loadMessagesById({chatId:s,messageIds:e.map(e=>e.msgId)}),a.length>0&&t.loadPeerStoriesByIds({peerId:s,storyIds:a.map(e=>e.storyId)})}}),(0,w.aJ)("loadChannelMonetizationStatistics",async(e,t,a)=>{const{peerId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.PVB)(e,s),i=(0,C.AWZ)(e,s);if(!n)return;const r=i?.statisticsDcId,d=await(0,b.px)("fetchChannelMonetizationStatistics",{peer:n,dcId:r});d&&(e=(0,w.mS)(),e=(0,A.$ry)(e,d,o),(0,w.UF)(e))}),(0,w.aJ)("loadMessageStatistics",async(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.AWZ)(e,s);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchMessageStatistics",{chat:i,messageId:o,dcId:d});c||(c={}),e=(0,w.mS)();const{viewsCount:l,forwardsCount:h,reactions:m}=(0,C.zeq)(e,s)[o]||{};c.viewsCount=l,c.forwardsCount=h,c.reactionsCount=m?.results?m?.results.reduce((e,t)=>e+t.count,0):void 0,e=(0,A.gJI)(e,c,n),(0,w.UF)(e),t.loadMessagePublicForwards({chatId:s,messageId:o,tabId:n})}),(0,w.aJ)("loadMessagePublicForwards",async(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.AWZ)(e,s);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentMessage||{};if(c?.publicForwards&&!c.nextOffset)return;const l=await(0,b.px)("fetchMessagePublicForwards",{chat:i,messageId:o,dcId:d,offset:c.nextOffset}),{forwards:h,nextOffset:m,count:p}=l||{};e=(0,w.mS)(),e=(0,A.gJI)(e,{...c,publicForwards:p||h?.length,publicForwardsData:(c.publicForwardsData||[]).concat(h||[]),nextOffset:m},n),(0,w.UF)(e)}),(0,w.aJ)("loadStatisticsAsyncGraph",async(e,t,a)=>{const{chatId:s,token:o,name:n,isPercentage:i,tabId:r=(0,u.g0)()}=a,d=(0,C.AWZ)(e,s);if(!d)return;const c=d.statisticsDcId,l=await(0,b.px)("fetchStatisticsAsyncGraph",{token:o,dcId:c,isPercentage:i});l&&(e=(0,w.mS)(),e=(0,A.RoI)(e,s,n,l,r),(0,w.UF)(e))}),(0,w.aJ)("loadStoryStatistics",async(e,t,a)=>{const{chatId:s,storyId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.AWZ)(e,s);if(!i||!r)return;const d=r.statisticsDcId;let c=await(0,b.px)("fetchStoryStatistics",{chat:i,storyId:o,dcId:d});c||(c={}),e=(0,w.mS)();const l=(0,C.Msb)(e,s,o),{forwardsCount:h=0,viewsCount:m=0,reactionsCount:p=0}=l&&"views"in l&&l.views?l.views:{};c.viewsCount=m,c.forwardsCount=h,c.reactionsCount=p,e=(0,w.mS)(),e=(0,A.KXe)(e,c,n),(0,w.UF)(e),t.loadStoryPublicForwards({chatId:s,storyId:o,tabId:n})}),(0,w.aJ)("loadStoryPublicForwards",async(e,t,a)=>{const{chatId:s,storyId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.hds)(e,s),r=(0,C.AWZ)(e,s);if(!i||!r)return;const d=r.statisticsDcId,c=(0,C.nTw)(e,n).statistics.currentStory||{};if(c?.publicForwards&&!c.nextOffset)return;const{publicForwards:l,count:h,nextOffset:m}=await(0,b.px)("fetchStoryPublicForwards",{chat:i,storyId:o,dcId:d,offset:c.nextOffset})||{};e=(0,w.mS)(),e=(0,A.KXe)(e,{...c,publicForwards:h||l?.length,publicForwardsData:(c.publicForwardsData||[]).concat(l||[]),nextOffset:m},n),(0,w.UF)(e)}),(0,w.aJ)("processMonetizationRevenueWithdrawalUrl",async(e,t,a)=>{const{peerId:s,currentPassword:o,tabId:n=(0,u.g0)()}=a;e=(0,A.Zct)(e,{isLoading:!0},n),(0,w.UF)(e);const i=(0,C.PVB)(e,s);if(!i)return;const r=await(0,b.px)("fetchMonetizationRevenueWithdrawalUrl",{peer:i,currentPassword:o});r&&(e=(0,w.mS)(),e=(0,A.Zct)(e,{isLoading:!1,errorKey:"error"in r?r.messageKey:void 0},n),(0,w.UF)(e),"url"in r&&(t.openUrl({url:r.url,tabId:n,ignoreDeepLinks:!0}),t.closeMonetizationVerificationModal({tabId:n})))});var st=a(1903);function ot(e){const t=(0,w.mS)(),a=(0,C.zeq)(t,e);if(!a)return 0;const s=Date.now()-2592e5;return Object.values(a).filter(e=>1e3*e.date>=s).length}async function nt(e,t,a){const s=[];if(0===a.length)return{paragraphs:[],actionItems:[],messageLinks:[]};const o=(0,C.hds)(e,t),n=o?.title||"Chat",i=a.map(e=>{const t=(0,S.P5)(e);return t?.text||""}).filter(e=>e.length>0).join(" ");if(i.length>0){const e=`In ${n}, the team discussed various topics over the past few days. ${i.substring(0,500)}...`;s.push(e)}return{paragraphs:s,actionItems:[],messageLinks:[]}}(0,w.aJ)("loadAllStories",async e=>{let t=0;for(;e.stories.hasNext;){if(t++>=100)return void(s.Oig&&console.error("`actions/loadAllStories`: Infinite loop detected"));e=(0,w.mS)();const{stateHash:a,hasNext:o}=e.stories;if(a&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!a,stateHash:a});if(!n)return;(e=(0,w.mS)()).stories.stateHash=n.state,"peerStories"in n&&(e=(0,A.Niu)(e,n.peerStories),e=(0,A.Gzl)(e,n.peerStories),(e=(0,A.qsx)(e,n.stealthMode)).stories.hasNext=n.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadAllHiddenStories",async e=>{let t=0;for(;e.stories.hasNextInArchive;){if(t++>=100)return void(s.Oig&&console.error("`actions/loadAllHiddenStories`: Infinite loop detected"));e=(0,w.mS)();const{archiveStateHash:a,hasNextInArchive:o}=e.stories;if(a&&!o)return;const n=await(0,b.px)("fetchAllStories",{isFirstRequest:!a,stateHash:a,isHidden:!0});if(!n)return;(e=(0,w.mS)()).stories.archiveStateHash=n.state,"peerStories"in n&&(e=(0,A.Niu)(e,n.peerStories),e=(0,A.Gzl)(e,n.peerStories),(e=(0,A.qsx)(e,n.stealthMode)).stories.hasNextInArchive=n.hasMore),(0,w.UF)(e)}}),(0,w.aJ)("loadPeerSkippedStories",async(e,t,a)=>{const{peerId:s}=a,o=(0,C.PVB)(e,s),n=(0,C._bp)(e,s);if(!o||!n)return;const i=Object.values(n.byId).reduce((e,t)=>("content"in t||e.push(t.id),e),[]);if(0===i.length)return;const r=await(0,b.px)("fetchPeerStoriesByIds",{peer:o,ids:i});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("viewStory",async(e,t,a)=>{const{peerId:s,storyId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.PVB)(e,s),r=(0,C.Msb)(e,s,o);if(!i||!r||!("content"in r))return;e=(0,A.SYp)(e,s,o,n),(0,w.UF)(e);const d=(0,v.Fm)();r.expireDate<d&&r.isInProfile&&(0,b.px)("viewStory",{peer:i,storyId:o}),(e.stories.byPeerId[s].lastReadId||0)<r.id&&await(0,b.px)("markStoryRead",{peer:i,storyId:o})&&(e=(0,w.mS)(),e=(0,A.Ahb)(e,s,o),(0,w.UF)(e))}),(0,w.aJ)("deleteStory",async(e,t,a)=>{const{peerId:s,storyId:o}=a,n=(0,C.PVB)(e,s);n&&await(0,b.px)("deleteStory",{peer:n,storyId:o})&&(e=(0,w.mS)(),e=(0,A.ONz)(e,s,o),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryInProfile",async(e,t,a)=>{const{peerId:s,storyId:o,isInProfile:n}=a,i=(0,C.PVB)(e,s);if(!i)return;const r=(0,C.Msb)(e,s,o),d=r&&"content"in r?r.isInProfile:void 0;e=(0,A.Xzz)(e,s,o,{isInProfile:n}),e=(0,A.KpR)(e,s,o,n),(0,w.UF)(e);const c=await(0,b.px)("toggleStoryInProfile",{peer:i,storyId:o,isInProfile:n});c?.length||(e=(0,w.mS)(),e=(0,A.Xzz)(e,s,o,{isInProfile:d}),e=(0,A.KpR)(e,s,o,d),(0,w.UF)(e))}),(0,w.aJ)("toggleStoryPinnedToTop",async(e,t,a)=>{const{peerId:s,storyId:o}=a,n=(0,C.PVB)(e,s),i=(0,C._bp)(e,s);if(!n||!i)return;const r=(0,C.gVx)(e,s)?.map(e=>e.id)||[],d=r.includes(o)?r.filter(e=>e!==o):[...r,o];e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[s]:{...i,pinnedIds:d.sort((e,t)=>t-e)}}}},(0,w.UF)(e),await(0,b.px)("toggleStoryPinnedToTop",{peer:n,storyIds:d})||(e=(0,w.mS)(),e={...e,stories:{...e.stories,byPeerId:{...e.stories.byPeerId,[s]:{...i,pinnedIds:r}}}},(0,w.UF)(e))}),(0,w.aJ)("loadPeerStories",async(e,t,a)=>{if((0,C.trm)(e))return;const{peerId:s}=a,o=(0,C.PVB)(e,s);if(!o)return;const n=await(0,b.px)("fetchPeerStories",{peer:o});n&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,n.stories),n.lastReadStoryId&&(e=(0,A.Ahb)(e,s,n.lastReadStoryId)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerProfileStories",async(e,t,a)=>{if((0,C.trm)(e))return;const{peerId:s,offsetId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.PVB)(e,s);let r=(0,C._bp)(e,s);if(!i||r?.isFullyLoaded)return;const d=(0,st.tW)(e,n);if("all"!==d){let t=r?.idsByAlbumId?.[d];if(t?.isFullyLoaded)return;const a=await(0,b.px)("fetchAlbumStories",{peer:i,albumId:d,offset:o||0});if(!a)return;return e=(0,w.mS)(),e=(0,A.K4v)(e,s,a.stories,a.pinnedIds,!1,d),r=(0,C._bp)(e,s),t=r?.idsByAlbumId?.[d],(0===Object.values(a.stories).length||t?.ids?.length&&t.ids.length>=a.count)&&(e=(0,A.oeX)(e,s,!0,!1,d)),void(0,w.UF)(e)}const c=await(0,b.px)("fetchPeerProfileStories",{peer:i,offsetId:o});c&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,c.stories,c.pinnedIds),r=(0,C._bp)(e,s),(0===Object.values(c.stories).length||r?.profileIds?.length&&r?.profileIds.length>=c.count)&&(e=(0,A.oeX)(e,s,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesArchive",async(e,t,a)=>{if((0,C.trm)(e))return;const{peerId:s,offsetId:o}=a,n=(0,C.PVB)(e,s);let i=(0,C._bp)(e,s);if(!n||i?.isArchiveFullyLoaded)return;const r=await(0,b.px)("fetchStoriesArchive",{peer:n,offsetId:o});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,r.stories,void 0,!0),i=(0,C._bp)(e,s),(0===Object.values(r.stories).length||i?.archiveIds?.length&&i?.archiveIds.length>=r.count)&&(e=(0,A.oeX)(e,s,!0,!0)),(0,w.UF)(e))}),(0,w.aJ)("loadPeerStoriesByIds",async(e,t,a)=>{const{peerId:s,storyIds:o}=a,n=(0,C.PVB)(e,s);if(!n)return;const i=await(0,b.px)("fetchPeerStoriesByIds",{peer:n,ids:o});i&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,i.stories),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViews",async(e,t,a)=>{const{peerId:s,storyId:o}=a,n=(0,C.PVB)(e,s);if(!n)return;const i=await(0,b.px)("fetchStoriesViews",{peer:n,storyIds:[o]});i&&(e=(0,w.mS)(),e=(0,A.ZCo)(e,s,o,i.views),(0,w.UF)(e))}),(0,w.aJ)("loadStoryViewList",async(e,t,a)=>{const{peerId:s,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,query:d,limit:c,tabId:l=(0,u.g0)()}=a,h=(0,C.PVB)(e,s);if(!h)return;e=(0,A.dxy)(e,!0,l),(0,w.UF)(e);const m=await(0,b.px)("fetchStoryViewList",{peer:h,storyId:o,offset:n,areReactionsFirst:i,areJustContacts:r,limit:c,query:d});if(!m)return e=(0,w.mS)(),e=(0,A.dxy)(e,!1,l),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.X5v)(e,o,m.views,m.nextOffset,l),(0,w.UF)(e)}),(0,w.aJ)("reportStory",async(e,t,a)=>{const{peerId:o,storyId:n,description:i="",option:r="",tabId:d=(0,u.g0)()}=a,c=(0,C.PVB)(e,o);if(!c)return;const l=await(0,b.px)("reportStory",{peer:c,storyId:n,description:i,option:r});if(!l)return;const{result:h,error:m}=l;if(m===s.zLi)return t.showNotification({message:(0,f.yE)("lng_report_please_select_messages"),tabId:d}),void t.closeReportModal({tabId:d});if(h){if("reported"===h.type)return t.showNotification({message:h?(0,f.yE)("ReportPeer.AlertSuccess"):"An error occurred while submitting your report. Please, try again later.",tabId:d}),void t.closeReportModal({tabId:d});if("selectOption"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,a=t?.[t.length-1]?.options?.find(e=>e.option===r),s={title:h.title,options:h.options,subtitle:a?.text};e=(0,M.w)(e,{reportModal:{messageIds:[n],subject:"story",peerId:o,description:i,sections:t?[...t,s]:[s]}},d),(0,w.UF)(e)}if("comment"===h.type){e=(0,w.mS)();const t=(0,C.nTw)(e,d).reportModal?.sections,a=t?.[t.length-1]?.options?.find(e=>e.option===r),s={isOptional:h.isOptional,option:h.option,title:a?.text};e=(0,M.w)(e,{reportModal:{messageIds:[n],description:i,peerId:o,subject:"story",sections:t?[...t,s]:[s]}},d),(0,w.UF)(e)}}}),(0,w.aJ)("editStoryPrivacy",(e,t,a)=>{const{peerId:s,storyId:o,privacy:n}=a,i=(0,C.PVB)(e,s);if(!i)return;const r=[...n.allowUserIds,...n.allowChatIds],d=[...n.blockUserIds,...n.blockChatIds],c=(0,S.wT)(e,{visibility:n.visibility,isUnspecified:n.isUnspecified,allowedIds:r,blockedIds:d,botsPrivacy:"none"});(0,b.px)("editStoryPrivacy",{peer:i,id:o,privacy:c})}),(0,w.aJ)("toggleStoriesHidden",async(e,t,a)=>{const{peerId:s,isHidden:o}=a,n=(0,C.PVB)(e,s);n&&await(0,b.px)("toggleStoriesHidden",{peer:n,isHidden:o})&&(e=(0,w.mS)(),e=(0,A.VWO)(e,s,o),(0,w.UF)(e))}),(0,w.aJ)("loadStoriesMaxIds",async(e,t,a)=>{const{peerIds:s}=a,o=s.map(t=>(0,C.PVB)(e,t)).filter(Boolean);if(!o.length)return;const n=await(0,b.px)("fetchStoriesMaxIds",{peers:o});if(!n)return;const i=[];e=(0,w.mS)(),n.forEach((t,a)=>{const s=o[a];e=(0,A.kTB)(e,s.id,{maxStoryId:t.maxId,hasStories:Boolean(t.maxId)}),t.maxId&&t.maxId>0&&i.push(s.id)}),(0,w.UF)(e),i?.forEach(e=>t.loadPeerStories({peerId:e}))}),(0,w.aJ)("sendStoryReaction",async(e,t,a)=>{const{peerId:s,storyId:o,containerId:n,reaction:i,shouldAddToRecent:r,tabId:d=(0,u.g0)()}=a,c=(0,C.PVB)(e,s);if(!c)return;const l=(0,C.Msb)(e,s,o);if(!l||!("content"in l))return;const h=l.sentReaction;e=(0,A.k31)(e,s,o,i),(0,w.UF)(e),i?t.startActiveReaction({containerId:n,reaction:i,tabId:d}):t.stopActiveReaction({containerId:n,tabId:d});const m=await(0,b.px)("sendStoryReaction",{peer:c,storyId:o,reaction:i,shouldAddToRecent:r});e=(0,w.mS)(),m||(e=(0,A.k31)(e,s,o,h)),(0,w.UF)(e)}),(0,w.aJ)("activateStealthMode",(e,t,a)=>{const{isForPast:s=!0,isForFuture:o=!0}=a||{};(0,b.px)("activateStealthMode",{isForPast:s||!0,isForFuture:o||!0})}),(0,w.aJ)("loadStoryAlbums",async(e,t,a)=>{const{peerId:s}=a,o=(0,C.PVB)(e,s);if(!o)return;const n=await(0,b.px)("fetchAlbums",{peer:o});n&&(e=(0,w.mS)(),e={...e,stories:{...e.stories,albumsByPeerId:{...e.stories.albumsByPeerId,[s]:n}}},(0,w.UF)(e))}),(0,w.aJ)("selectStoryAlbum",(e,t,a)=>{const{peerId:s,albumId:o,tabId:n=(0,u.g0)()}=a;o&&s&&(e=(0,A.oeX)(e,s,!1)),e=(0,M.w)(e,{selectedStoryAlbumId:o||void 0},n),(0,w.UF)(e),t.loadPeerProfileStories({peerId:s,tabId:n})}),(0,w.aJ)("loadAlbumStories",async(e,t,a)=>{const{peerId:s,albumId:o,offsetId:n}=a,i=(0,C.PVB)(e,s);if(!i)return;const r=await(0,b.px)("fetchAlbumStories",{peer:i,albumId:o,offset:n||0});r&&(e=(0,w.mS)(),e=(0,A.K4v)(e,s,r.stories,r.pinnedIds),(0,w.UF)(e))}),(0,w.aJ)("resetSelectedStoryAlbum",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{selectedStoryAlbumId:void 0},s)}),(0,w.aJ)("fetchBusiestChats",async(e,t,a)=>{const{tabId:s=(0,u.g0)(),includeArchived:o}=a||{};e=(0,A.Xe1)(e,!0,s),(0,w.UF)(e);const n=(e=(0,w.mS)()).byTabId[s],i=void 0!==o?o:n?.summarize?.includeArchived??!1,r=Object.keys(e.chats.byId),d=[];for(const t of r){const a=(0,C.hds)(e,t);if(!a)continue;if(!i&&(0,we.TJ)(a))continue;const s=ot(t);if(s>0){const a=(0,C.zeq)(e,t),o=a?Object.values(a).sort((e,t)=>t.date-e.date)[0]:void 0;d.push({chatId:t,messageCount:s,lastMessageDate:o?.date})}}d.sort((e,t)=>t.messageCount-e.messageCount),e=(0,w.mS)(),e=(0,A.hAk)(e,d.slice(0,20),s),(0,w.UF)(e)}),(0,w.aJ)("selectChatsForSummarize",(e,t,a)=>{const{chatIds:s,tabId:o=(0,u.g0)()}=a;return(0,A.akA)(e,s,o)}),(0,w.aJ)("generateSummaries",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=e.byTabId[s];if(!o.summarize)return;const{selectedChatIds:n,isSetupComplete:i}=o.summarize;if(i||(e=(0,A.ob_)(e,s),(0,w.UF)(e),e=(0,w.mS)()),0===n.length)return;e=(0,A.DQu)(e,!0,s),(0,w.UF)(e),e=(0,w.mS)();const r=[],d=new Date;d.setHours(0,0,0,0);const c=Math.floor(d.getTime()/1e3),l=Array.from({length:10},(e,t)=>c-86400*t);for(const t of l)for(const a of n){const s=(0,C.zeq)(e,a);let o,n=[];if(s&&(n=Object.values(s).filter(e=>e.date>=t-259200&&e.date<t+86400).sort((e,t)=>e.date-t.date)),n.length>0)o=await nt(e,a,n);else{const t=(0,C.hds)(e,a);o={paragraphs:[`In ${t?.title||"Chat"}, there was activity on this day. Team members discussed various topics and shared updates.`,"Key highlights from the conversation included important decisions and collaborative discussions.","The team continued to work together effectively, addressing questions and providing support as needed."],actionItems:[],messageLinks:[]}}r.push({chatId:a,date:t,content:o,isRead:!1})}e=(0,w.mS)(),e=(0,A.taX)(e,r,s),(0,w.UF)(e)}),a(88742);var it=a(66414);function rt({global:e,isSameMessageList:t,profileTab:a,forceScrollProfileTab:s,isOwnProfile:o,tabId:n}){const i=(0,C.nTw)(e,n).chatInfo,r=a??(t?i.profileTab:void 0),d=s??(t?i.forceScrollProfileTab:void 0),c=o??(t?i.isOwnProfile:void 0);(0,w.br)(()=>{e=(0,w.mS)(),e=(0,M.w)(e,{...(0,C.nTw)(e,n),chatInfo:{isOpen:!0,profileTab:r,forceScrollProfileTab:d,isOwnProfile:c}},n),e={...e,lastIsChatInfoShown:!0},(0,w.UF)(e)})}(0,w.aJ)("processOpenChatOrThread",(e,t,a)=>{const{chatId:s,threadId:o=n.l3,type:i="thread",shouldReplaceHistory:r=!1,shouldReplaceLast:d=!1,noForumTopicPanel:c,tabId:l=(0,u.g0)()}=a,h=(0,C.Xf0)(e,l),m=(0,C.nTw)(e,l);if(m.premiumModal?.promo&&m.premiumModal?.isOpen&&(e=(0,M.w)(e,{premiumModal:{...m.premiumModal,isOpen:!1}},l)),t.hideEffectInComposer({tabId:l}),t.closeStoryViewer({tabId:l}),t.closeStarsBalanceModal({tabId:l}),t.closeStarsTransactionModal({tabId:l}),t.closeGiftInfoModal({tabId:l}),t.closeSummarizePage({tabId:l}),t.closeAlphaHumanThread({tabId:l}),e=(0,M.w)(e,{middleColumnView:"chat"},l),h&&h.chatId===s&&h.threadId===o&&h.type===i||(s&&(e=(0,A.n4t)(e,s,o,"replyStack",[],l),e=(0,M.w)(e,{activeReactions:{},shouldPreventComposerAnimation:!0},l),e=(0,A._54)(e,s,o,l)),e=(0,A.T4Z)(e,l),e=(0,M.w)(e,{isStatisticsShown:!1,monetizationStatistics:void 0,boostStatistics:void 0,contentToBeScheduled:void 0,...s!==(0,C.nTw)(e,l).forwardMessages.toChatId&&{forwardMessages:{},isShareMessageModalShown:!1},chatInfo:{isOpen:m.chatInfo.isOpen}},l)),s){const a=(0,C.hds)(e,s);a?.isForum&&!c?t.openForumPanel({chatId:s,tabId:l}):s!==(0,C.nTw)(e,l).forumPanelChatId&&t.closeForumPanel({tabId:l})}return t.updatePageTitle({tabId:l}),(0,A.MNF)(e,s,o,i,r,d,l)}),(0,w.aJ)("openChatInNewTab",(e,t,a)=>{const{chatId:s,threadId:o=n.l3}=a,i=(0,it.dk)(s,"thread",o);window.open(i,"_blank")}),(0,w.aJ)("openPreviousChat",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return t.updatePageTitle({tabId:s}),(0,A.MNF)(e,void 0,void 0,void 0,void 0,void 0,s)}),(0,w.aJ)("openChatWithInfo",(e,t,a)=>{const{profileTab:s,forceScrollProfileTab:o,isOwnProfile:i,tabId:r=(0,u.g0)(),...d}=a,c=(0,C.Xf0)(e,r);rt({global:e,isSameMessageList:c?.chatId===d.id&&c?.threadId===n.l3&&c?.type===(d.type||"thread"),profileTab:s,forceScrollProfileTab:o,isOwnProfile:i,tabId:r}),t.openChat({...d,tabId:r})}),(0,w.aJ)("openThreadWithInfo",(e,t,a)=>{const{profileTab:s,forceScrollProfileTab:o,isOwnProfile:n,tabId:i=(0,u.g0)(),...r}=a,d=(0,C.Xf0)(e,i);rt({global:e,isSameMessageList:d?.chatId===r.chatId&&d?.threadId===r.threadId&&d?.type===(r.type||"thread"),profileTab:s,forceScrollProfileTab:o,isOwnProfile:n,tabId:i}),t.openThread({...r,tabId:i})}),(0,w.aJ)("openChatWithDraft",(e,t,a)=>{const{chatId:s,text:o,threadId:i=n.l3,files:r,filter:d,tabId:c=(0,u.g0)()}=a;return s&&t.openThread({chatId:s,threadId:i,tabId:c}),(0,M.w)(e,{requestedDraft:{chatId:s,text:o,files:r,filter:d}},c)}),(0,w.aJ)("resetChatCreation",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{chatCreation:void 0},s)}),(0,w.aJ)("setNewChatMembersDialogState",(e,t,a)=>{const{newChatMembersProgress:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{newChatMembersProgress:s},o)}),(0,w.aJ)("openNextChat",(e,t,a)=>{const{targetIndexDelta:s,orderedIds:o,tabId:n=(0,u.g0)()}=a,{chatId:i}=(0,C.Xf0)(e,n)||{};if(!i)return void t.openChat({id:o[0],tabId:n});const r=o.indexOf(i);if(-1===r)return;const d=o[r+s];t.openChat({id:d,shouldReplaceHistory:!0,tabId:n})}),(0,w.aJ)("closeDeleteChatFolderModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{deleteFolderDialogModal:void 0},s)}),(0,w.aJ)("closeChatlistModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{chatlistModal:void 0},s)}),(0,w.aJ)("requestChatTranslation",(e,t,a)=>{const{chatId:s,toLanguageCode:o,tabId:n=(0,u.g0)()}=a;return(0,A.lcj)(e,s,o,n)}),(0,w.aJ)("closeChatInviteModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{chatInviteModal:void 0},s)}),(0,w.aJ)("openWebAppTab",(e,t,a)=>{const{webApp:s,tabId:o=(0,u.g0)()}=a;s&&(e=Oe(e=(0,w.mS)(),s,!0,!0,o),(0,w.UF)(e))}),(0,w.aJ)("updateWebApp",(e,t,a)=>{const{key:s,update:o,tabId:n=(0,u.g0)()}=a;return De(e,s,o,n)}),(0,w.aJ)("closeActiveWebApp",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return e=function(e,...[t=(0,u.g0)()]){const a=(0,C.nTw)(e,t).webApps.activeWebAppKey;return a?Le(e,a,!1,t):e}(e,s),Ge(e,s)?e:Ve(e,!1,s)}),(0,w.aJ)("openMoreAppsTab",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{webApps:{...o.webApps,activeWebAppKey:void 0,isMoreAppsTabActive:!0}},s)}),(0,w.aJ)("closeMoreAppsTab",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s),n=o.webApps.openedWebApps,i=Object.keys(n),r=i.length;return(0,M.w)(e,{webApps:{...o.webApps,isMoreAppsTabActive:!1,activeWebAppKey:r?i[r-1]:void 0,isModalOpen:r>0}},s)}),(0,w.aJ)("closeWebApp",(e,t,a)=>{const{key:s,skipClosingConfirmation:o,tabId:n=(0,u.g0)()}=a||{};return Ge(e=Le(e,s,o,n),n)?e:Ve(e,!1,n)}),(0,w.aJ)("closeWebAppModal",(e,t,a)=>{const{shouldSkipConfirmation:s,tabId:o=(0,u.g0)()}=a||{},n=!s&&!(0,je.lS)(e).shouldSkipWebAppCloseConfirmation&&function(e,...[t=(0,u.g0)()]){return Object.keys((0,C.nTw)(e,t).webApps.openedWebApps).length>1}(e,o);return n?(t.openWebAppsCloseConfirmationModal({tabId:o}),e):(e=function(e,...[t=(0,u.g0)()]){const a=(0,C.nTw)(e,t),s=Object.fromEntries(Object.entries(a.webApps.openedWebApps).filter(([,e])=>e.shouldConfirmClosing)),o=Object.values(s);if(!(o.length>0))return(0,M.w)(e,{webApps:{...a.webApps,activeWebAppKey:void 0,openedWebApps:{},openedOrderedKeys:[],sessionKeys:[]}},t);const n=(0,C.ES7)(e,t),i=n?.shouldConfirmClosing?n:o[0],r=(0,Je.rp)(i);r&&(s[r]={...i,isCloseModalOpen:!0});const d=a.webApps.openedOrderedKeys.filter(e=>s[e]);return(0,M.w)(e,{webApps:{...a.webApps,activeWebAppKey:r,isMoreAppsTabActive:!1,openedWebApps:s,openedOrderedKeys:d}},t)}(e,o),Ge(e,o)?e:Ve(e,!1,o))}),(0,w.aJ)("changeWebAppModalState",(e,t,a)=>{const{state:s,tabId:o=(0,u.g0)()}=a;return function(e,t,...[a=(0,u.g0)()]){const s=(0,C.nTw)(e,a);return(0,M.w)(e,{webApps:{...s.webApps,modalState:t}},a)}(e,s,o)}),(0,w.aJ)("updateMiniAppCachedPosition",(e,t,a)=>{const{position:s}=a;return(0,A.qoo)(e,{miniAppsCachedPosition:s})}),(0,w.aJ)("updateMiniAppCachedSize",(e,t,a)=>{const{size:s}=a;return(0,A.qoo)(e,{miniAppsCachedSize:s})}),(0,w.aJ)("setWebAppPaymentSlug",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a,o=(0,C.ES7)(e,s);if(o?.url)return De(e,(0,S.rp)(o),{slug:a.slug},s)}),(0,w.aJ)("cancelBotTrustRequest",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{botTrustRequest:void 0},s)}),(0,w.aJ)("markBotTrusted",(e,t,a)=>{const{botId:s,isWriteAllowed:o,tabId:n=(0,u.g0)()}=a,{trustedBotIds:i}=e,r=new Set(i);r.add(s),e={...e,trustedBotIds:Array.from(r)};const d=(0,C.nTw)(e,n);if(d.botTrustRequest?.onConfirm){const{action:e,payload:a}=d.botTrustRequest.onConfirm;t[e]({...a,isWriteAllowed:o})}e=(0,M.w)(e,{botTrustRequest:void 0},n),(0,w.UF)(e)}),(0,w.aJ)("sendWebAppEvent",(e,t,a)=>{const{event:s,webAppKey:o,tabId:n=(0,u.g0)()}=a,i=(0,C.wtp)(e,o,n);if(!i)return e;const r=i.plannedEvents?[...i.plannedEvents,s]:[s];return t.updateWebApp({key:o,update:{plannedEvents:r},tabId:n}),e}),(0,w.aJ)("cancelAttachBotInstall",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{requestedAttachBotInstall:void 0},s)}),(0,w.aJ)("requestAttachBotInChat",(e,t,a)=>{const{bot:s,filter:o,startParam:n,tabId:i=(0,u.g0)()}=a,r=(0,C.Xf0)(e,i)?.chatId,d=s.attachMenuPeerTypes?.filter(e=>"self"!==e&&o.includes(e));d?.length?(e=(0,M.w)(e,{requestedAttachBotInChat:{bot:s,filter:d,startParam:n}},i),(0,w.UF)(e)):t.callAttachBot({chatId:r||s.id,bot:s,startParam:n,tabId:i})}),(0,w.aJ)("cancelAttachBotInChat",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{requestedAttachBotInChat:void 0},s)}),(0,w.aJ)("openEmojiStatusAccessModal",(e,t,a)=>{const{bot:s,webAppKey:o,tabId:n=(0,u.g0)()}=a;s&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{emojiStatusAccessModal:{bot:s,webAppKey:o}},n),(0,w.UF)(e))}),(0,w.aJ)("closeEmojiStatusAccessModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{emojiStatusAccessModal:void 0},s)}),(0,w.aJ)("openLocationAccessModal",(e,t,a)=>{const{bot:s,webAppKey:o,tabId:n=(0,u.g0)()}=a;s&&o&&(e=(0,w.mS)(),e=(0,M.w)(e,{locationAccessModal:{bot:s,webAppKey:o}},n),(0,w.UF)(e))}),(0,w.aJ)("closeLocationAccessModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{locationAccessModal:void 0},s)});var dt=a(81954),ct=a(80539),lt=a(3544),ut=a(188),ht=a(49086),mt=a(86525),pt=a(56494);const gt=s.OzO+s.xB5;let ft;function It(e,t,a){const{type:s,threadId:o}=(0,C.Xf0)(e)||{},n=(0,p.Yw)(),i=(0,C.hds)(e,t),r="scheduled"===s?(0,C.yFI)(e,t):(0,C.zeq)(e,t);if(!i||!r||!o)return;const d=a.map(e=>r[e]).filter(t=>(0,C.WAX)(e,t,o).canCopy).sort((e,t)=>e.id-t.id),l=[],u=[];d.forEach(t=>{const a=(0,S.WX)(i)?i:(0,C.Y7C)(e,t),s=`> ${a?(0,y.F9)(n,a):t.forwardInfo?.hiddenUserName||""}:`,o=(0,S.ni)(e,t);l.push(s),l.push(`${function(e,t){const a=(0,w.mS)(),s=(0,lt.Su)(t),o=s?`${s} `:"",n=(0,ht.V)({message:t,shouldRenderAsHtml:!0})?.join(""),i=(0,mt.ni)(a,t);return`${o}${(0,lt.oL)(e,t,i,n,!0)}`}(n,t)}\n`),u.push(s),u.push(`${(0,lt.dS)(n,t,o,!1,0,!0)}\n`)}),(0,c.A)(l.join("\n"),u.join("\n"))}(0,w.aJ)("setScrollOffset",(e,t,a)=>{const{chatId:s,threadId:o,scrollOffset:n,tabId:i=(0,u.g0)()}=a;return e=(0,A.eww)(e,s,o,"lastScrollOffset",n),(0,A.n4t)(e,s,o,"scrollOffset",n,i)}),(0,w.aJ)("setEditingId",(e,t,a)=>{const{messageId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.Xf0)(e,o);if(!n)return;const{chatId:i,threadId:r,type:d}=n,c="scheduled"===d?"editingScheduledId":"editingId";return(0,A.eww)(e,i,r,c,s)}),(0,w.aJ)("setEditingDraft",(e,t,a)=>{const{text:s,chatId:o,threadId:n,type:i}=a,r="scheduled"===i?"editingScheduledDraft":"editingDraft";return(0,A.eww)(e,o,n,r,s)}),(0,w.aJ)("editLastMessage",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,s)||{};if(!o||!n)return;const i=(0,C.zeq)(e,o),r=(0,C.rA3)(e,o,n,s);if(!i||!r)return;const d=(0,h.Uk)(r,t=>Boolean(i[t]&&(0,C.WAX)(e,i[t],n).canEdit));return d?(0,A.eww)(e,o,n,"editingId",d):void 0}),(0,w.aJ)("replyToNextMessage",(e,t,a)=>{const{targetIndexDelta:s,tabId:o=(0,u.g0)()}=a,{chatId:i,threadId:r}=(0,C.Xf0)(e,o)||{};if(!i||!r)return;const d=(0,C.zeq)(e,i),c=(0,C.rA3)(e,i,r,o);if(!d||!c)return;const l=(0,C.GA4)(e,i,r)?.replyInfo;let h;if((0,C.haw)(e,i,r,o)&&l?.replyToMsgId){const e=Object.keys(d),t=e.indexOf(l.replyToMsgId.toString())+s;h=t<=e.length+1&&t>=0?Number(e[t]):void 0}else if(r===n.l3)h=(0,C.ZZX)(e,i);else{const t=(0,C.Vw0)(e,i,r);h=t?.lastMessageId}t.updateDraftReplyInfo({replyToMsgId:h,replyToPeerId:void 0,quoteText:void 0,tabId:o}),t.focusMessage({chatId:i,threadId:r,messageId:h,tabId:o})}),(0,w.aJ)("openAudioPlayer",(e,t,a)=>{const{chatId:s,threadId:o,messageId:n,origin:i,playbackRate:r,isMuted:d,timestamp:c,tabId:l=(0,u.g0)()}=a,h=(0,C.nTw)(e,l);return(0,M.w)(e,{audioPlayer:{chatId:s,threadId:o,messageId:n,timestamp:c,origin:i??h.audioPlayer.origin,playbackRate:r||h.audioPlayer.playbackRate||e.audioPlayer.lastPlaybackRate,isPlaybackRateActive:void 0===h.audioPlayer.isPlaybackRateActive?e.audioPlayer.isLastPlaybackRateActive:h.audioPlayer.isPlaybackRateActive,isMuted:d||h.audioPlayer.isMuted}},l)}),(0,w.aJ)("setAudioPlayerVolume",(e,t,a)=>{const{volume:s,tabId:o=(0,u.g0)()}=a;return e=(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,isMuted:!1}},o),{...e,audioPlayer:{...e.audioPlayer,volume:s}}}),(0,w.aJ)("setAudioPlayerPlaybackRate",(e,t,a)=>{const{playbackRate:s,isPlaybackRateActive:o,tabId:n=(0,u.g0)()}=a;return e={...e,audioPlayer:{...e.audioPlayer,lastPlaybackRate:s,isLastPlaybackRateActive:o}},(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,n).audioPlayer,playbackRate:s,isPlaybackRateActive:o}},n)}),(0,w.aJ)("setAudioPlayerMuted",(e,t,a)=>{const{isMuted:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,isMuted:s}},o)}),(0,w.aJ)("setAudioPlayerOrigin",(e,t,a)=>{const{origin:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{audioPlayer:{...(0,C.nTw)(e,o).audioPlayer,origin:s}},o)}),(0,w.aJ)("closeAudioPlayer",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{audioPlayer:{playbackRate:o.audioPlayer.playbackRate,isPlaybackRateActive:o.audioPlayer.isPlaybackRateActive,isMuted:o.audioPlayer.isMuted}},s)}),(0,w.aJ)("openPollResults",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.gjV)(e,(0,O.Ny)(),n),r=(0,C.nTw)(e,n);if(i){if(s!==r.pollResults.chatId||o!==r.pollResults.messageId)return(0,M.w)(e,{pollResults:{chatId:s,messageId:o,voters:{}}},n)}else window.setTimeout(()=>{e=(0,w.mS)(),e=(0,M.w)(e,{pollResults:{chatId:s,messageId:o,voters:{}}},n),(0,w.UF)(e)},450)}),(0,w.aJ)("closePollResults",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{pollResults:{}},s)}),(0,w.aJ)("focusNextReply",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.Xf0)(e,s);if(!o)return;const{chatId:n,threadId:i}=o,r=(0,C.jp_)(e,n,i,s);if(r&&0!==r.length){const a=r.pop();e=(0,A.n4t)(e,n,i,"replyStack",[...r],s),(0,w.UF)(e),t.focusMessage({chatId:n,threadId:i,messageId:a,tabId:s,noForumTopicPanel:!0})}else t.scrollMessageListToBottom({tabId:s})}),(0,w.aJ)("focusMessage",(e,t,a)=>{const{chatId:s,threadId:o=n.l3,messageListType:r="thread",noHighlight:d,groupedId:c,groupedChatId:l,replyMessageId:m,isResizingContainer:p,shouldReplaceHistory:g,noForumTopicPanel:f,quote:I,quoteOffset:v,scrollTargetPosition:b,timestamp:S,tabId:y=(0,u.g0)()}=a;let{messageId:M}=a;if(!(0,C.hds)(e,s))return void t.showNotification({message:{key:"ErrorFocusInaccessibleMessage"},tabId:y});const P=S?()=>t.openMediaFromTimestamp({chatId:s,threadId:o,messageId:M,timestamp:S,tabId:y}):void 0;if(void 0!==c){const t=(0,C.VC8)(e,l,c);t?.length&&([M]=(0,h.oE)(t))}const k=(0,C.Xf0)(e,y),T=!k||s!==k.chatId||o!==k.threadId||r!==k.type;if(ft&&(clearTimeout(ft),ft=void 0),ft=window.setTimeout(()=>{e=(0,w.mS)(),e=(0,A.kV7)(e,void 0,y),(0,w.UF)(e)},d?gt:1500),e=(0,A.kV7)(e,{chatId:s,messageId:M,threadId:o,noHighlight:d,isResizingContainer:p,quote:I,quoteOffset:v,scrollTargetPosition:b,direction:void 0},y),m){const t=(0,C.jp_)(e,s,o,y)||[];e=(0,A.n4t)(e,s,o,"replyStack",[...t,m],y)}T&&(e=(0,A.kV7)(e,{direction:i.CC.Static},y));const F=(0,C.rA3)(e,s,o,y);if(F&&F.includes(M))return(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:s,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:f,tabId:y}),void P?.();if(T&&(e=(0,A.n4t)(e,s,o,"viewportIds",void 0,y)),F&&!T){const t=M>F[0]?i.CC.Down:i.CC.Up;e=(0,A.kV7)(e,{direction:t},y)}(0,dt.o8)()&&(0,dt.H$)(),(0,w.UF)(e,{forceOnHeavyAnimation:!0}),t.openThread({chatId:s,threadId:o,type:r,shouldReplaceHistory:g,noForumTopicPanel:f,tabId:y}),t.loadViewportMessages({chatId:s,threadId:o,tabId:y,shouldForceRender:!0,onLoaded:P})}),(0,w.aJ)("scrollMessageListToBottom",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.Xf0)(e,s);if(!o)return;const{chatId:n,threadId:r}=o;e=(0,A.kV7)(e,{chatId:n,threadId:r,messageId:void 0,scrollTargetPosition:"end",direction:i.CC.Down,noHighlight:!0},s),(0,w.UF)(e,{forceOnHeavyAnimation:!0}),ft&&(clearTimeout(ft),ft=void 0),ft=window.setTimeout(()=>{e=(0,w.mS)(),e=(0,A.kV7)(e,void 0,s),(0,w.UF)(e)},gt),(0,dt.o8)()&&(0,dt.H$)(),(0,C.haw)(e,n,r,s)||t.loadViewportMessages({chatId:n,threadId:r,tabId:s,shouldForceRender:!0,forceLastSlice:!0})}),(0,w.aJ)("setShouldPreventComposerAnimation",(e,t,a)=>{const{shouldPreventComposerAnimation:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{shouldPreventComposerAnimation:s},o)}),(0,w.aJ)("openReplyMenu",(e,t,a)=>{const{fromChatId:s,messageId:o,quoteText:n,quoteOffset:i,tabId:r=(0,u.g0)()}=a;return(0,M.w)(e,{replyingMessage:{fromChatId:s,messageId:o,quoteText:n,quoteOffset:i},isShareMessageModalShown:!0},r)}),(0,w.aJ)("openForwardMenu",(e,t,a)=>{const{fromChatId:s,messageIds:o,storyId:n,groupedId:i,withMyScore:r,tabId:d=(0,u.g0)()}=a;let c;return i&&(c=(0,C.D_S)(e,s,i)),(0,M.w)(e,{forwardMessages:{fromChatId:s,messageIds:c||o,storyId:n,withMyScore:r},isShareMessageModalShown:!0},d)}),(0,w.aJ)("changeRecipient",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,s).forwardMessages,toChatId:void 0,noAuthors:!1,noCaptions:!1},isShareMessageModalShown:!0},s)}),(0,w.aJ)("setForwardNoAuthors",(e,t,a)=>{const{noAuthors:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);return(0,M.w)(e,{forwardMessages:{...n.forwardMessages,noAuthors:s,noCaptions:s&&n.forwardMessages.noCaptions}},o)}),(0,w.aJ)("setForwardNoCaptions",(e,t,a)=>{const{noCaptions:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{forwardMessages:{...(0,C.nTw)(e,o).forwardMessages,noCaptions:s,noAuthors:s}},o)}),(0,w.aJ)("exitForwardMode",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};e=(0,M.w)(e,{isShareMessageModalShown:!1,forwardMessages:{},replyingMessage:{}},s),(0,w.UF)(e)}),(0,w.aJ)("openForwardMenuForSelectedMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,r=i.filter(t=>{const a=(0,C.O5q)(e,n,t);return a&&(0,C.R4s)(e,a)});r.length&&t.openForwardMenu({fromChatId:n,messageIds:r,tabId:s})}),(0,w.aJ)("cancelMediaDownload",(e,t,a)=>{const{media:s,tabId:o=(0,u.g0)()}=a,n=(0,S.VO)(s,"download");if(n)return(0,A.IwB)(e,[n],o)}),(0,w.aJ)("cancelMediaHashDownloads",(e,t,a)=>{const{mediaHashes:s,tabId:o=(0,u.g0)()}=a;return(0,A.IwB)(e,s,o)}),(0,w.aJ)("downloadMedia",(e,t,a)=>{const{media:s,originMessage:o,tabId:n=(0,u.g0)()}=a,i=(0,S.VO)(s,"download");if(!i)return;const r={size:"size"in s?s.size:0,format:(0,S.Cz)(s,"download"),filename:(0,S.sd)(s),originChatId:o?.chatId,originMessageId:o?.id};return(0,A.iRS)(e,i,r,n)}),(0,w.aJ)("downloadSelectedMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages,{threadId:r}=(0,C.Xf0)(e,s)||{},d=(0,C.zeq)(e,n);d&&r&&i.map(e=>d[e]).filter(t=>(0,C.WAX)(e,t,r).canDownload).forEach(a=>{const o=(0,pt.iS)(e,a);o&&t.downloadMedia({media:o,originMessage:a,tabId:s})})}),(0,w.aJ)("enterMessageSelectMode",(e,t,a)=>{const{messageId:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.meB)(e,o);return n?(0,A.l3i)(e,n.id,s,o):e}),(0,w.aJ)("toggleMessageSelection",(e,t,a)=>{const{messageId:s,groupedId:o,childMessageIds:n,withShift:i,tabId:r=(0,u.g0)()}=a,c=(0,C.Xf0)(e,r);if(!c)return;const{chatId:l,threadId:h,type:m}=c;e=(0,A.yrN)(e,l,h,m,s,o,n,i,r),(0,w.UF)(e),e.shouldShowContextMenuHint&&(t.disableContextMenuHint(),t.showNotification({message:{key:d.TF?"ContextMenuHintTouch":"ContextMenuHintMouse"},tabId:r}))}),(0,w.aJ)("disableContextMenuHint",e=>{if(e.shouldShowContextMenuHint)return{...e,shouldShowContextMenuHint:!1}}),(0,w.aJ)("exitMessageSelectMode",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,A.T4Z)(e,s)}),(0,w.aJ)("openPollModal",(e,t,a)=>{const{isQuiz:s,tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{pollModal:{isOpen:!0,isQuiz:s}},o)}),(0,w.aJ)("closePollModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{pollModal:{isOpen:!1}},s)}),(0,w.aJ)("openTodoListModal",(e,t,a)=>{const{chatId:s,messageId:o,forNewTask:n,tabId:i=(0,u.g0)()}=a;return(0,M.w)(e,{todoListModal:{chatId:s,messageId:o,forNewTask:n}},i)}),(0,ut.k)("closeTodoListModal","todoListModal"),(0,w.aJ)("checkVersionNotification",(e,t)=>{if(Date.now()>1769717119647)return;const a="12.16.0".split(".").slice(0,2).join("."),{serviceNotifications:o}=e;if(o.find(({version:e})=>e===a))return;const n={chatId:s.zv8,date:(0,v.Fm)(),content:{text:(0,ct.Ay)("**Telegram Web A Digest**\n\nOver the past year, many new features and useful optimisations have been added. Here is a brief overview of the developments that have taken place in Web A during those busy months.\n\n __General__\n A huge number of design fixes across the app.\n Preview chats and mark them as read.\n Video messages can now be transcribed.\n Track your tasks with the help of [checklists](https://telegram.org/blog/checklists-suggested-posts/#checklists).\n Folder tags are now supported with the help of GitHub contributors.\n [Send photos in HD quality](https://telegram.org/blog/direct-to-channel-trim-voice-and-more#send-photos-in-higher-quality).\n [Global search of public posts](https://telegram.org/blog/post-search-story-albums-and-more#public-post-search).\n Support for channels with enabled auto-translate has been added.\n\n __Gifts__\n Added interactions on hover.\n Support for [Gift Marketplace](https://telegram.org/blog/gift-marketplace-and-more).\n Pinned gifts are now displayed in the profile.\n\n __Channels__\n Accept and send direct messages to channels.\n [Suggest your posts to be published by your favourite channels](https://telegram.org/blog/checklists-suggested-posts#suggest-posts-in-channels).\n\n __Profile__\n Full redesign of the profile page.\n [Explore other people's gift collections and story albums](https://telegram.org/blog/post-search-story-albums-and-more#story-albums).\n Keep an eye on all your accounts, just like on mobile and desktop clients, with the multi-account feature.\n\nThere are so many other bugfixes and improvements that it would take forever to describe them all! We're continually working on adding new features and improving the user experience.\n",!0)},isOutgoing:!1};t.createServiceNotification({message:n,version:a})}),(0,w.aJ)("createServiceNotification",(e,t,a)=>{const{message:o,version:n}=a,{serviceNotifications:i}=e,r=Math.max((0,C.ZZX)(e,s.zv8)||0,...i.map(({id:e})=>e)),d=(i.length+1)/1e3,c=Math.floor(r)+d;o.previousLocalId=o.id,o.id=c;const l={id:c,message:o,version:n,isUnread:!0};e={...e,serviceNotifications:[...i.slice(-1e3),l]},(0,w.UF)(e),t.apiUpdate({"@type":"newMessage",id:o.id,chatId:o.chatId,message:o})}),(0,w.aJ)("openReactorListModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{reactorModal:{chatId:s,messageId:o}},n)}),(0,w.aJ)("closeReactorListModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{reactorModal:void 0},s)}),(0,w.aJ)("openSeenByModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{seenByModal:{chatId:s,messageId:o}},n)}),(0,w.aJ)("closeSeenByModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{seenByModal:void 0},s)}),(0,w.aJ)("openPrivacySettingsNoticeModal",(e,t,a)=>{const{chatId:s,isReadDate:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{privacySettingsNoticeModal:{chatId:s,isReadDate:o}},n)}),(0,w.aJ)("closePrivacySettingsNoticeModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{privacySettingsNoticeModal:void 0},s)}),(0,w.aJ)("openChatLanguageModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a,i=o?(0,C.Rny)(e,s,o,n):(0,C.qZq)(e,s,n);return(0,M.w)(e,{chatLanguageModal:{chatId:s,messageId:o,activeLanguage:i}},n)}),(0,w.aJ)("closeChatLanguageModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{chatLanguageModal:void 0},s)}),(0,w.aJ)("copySelectedMessages",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);if(!o.selectedMessages)return;const{chatId:n,messageIds:i}=o.selectedMessages;It(e,n,i)}),(0,w.aJ)("copyMessagesByIds",(e,t,a)=>{const{messageIds:s,tabId:o=(0,u.g0)()}=a,n=(0,C.meB)(e,o);s&&0!==s.length&&n&&It(e,n.id,s)}),(0,w.aJ)("openOneTimeMediaModal",(e,t,a)=>{const{message:s,tabId:o=(0,u.g0)()}=a;e=(0,M.w)(e,{oneTimeMediaModal:{message:s}},o),(0,w.UF)(e)}),(0,w.aJ)("closeOneTimeMediaModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};e=(0,M.w)(e,{oneTimeMediaModal:void 0},s),(0,w.UF)(e)}),(0,w.aJ)("closeReportAdModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{reportAdModal:void 0},s)}),(0,w.aJ)("closeReportModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{reportModal:void 0},s)}),(0,w.aJ)("openPreviousReportAdModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).reportAdModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportAdModal:{...o,sections:o.sections.slice(0,-1)}},s);t.closeReportAdModal({tabId:s})}}),(0,w.aJ)("openPreviousReportModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).reportModal;if(o){if(1!==o.sections.length)return(0,M.w)(e,{reportModal:{...o,sections:o.sections.slice(0,-1)}},s);t.closeReportModal({tabId:s})}}),(0,w.aJ)("openPaidReactionModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{paidReactionModal:{chatId:s,messageId:o}},n)}),(0,w.aJ)("closePaidReactionModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{paidReactionModal:void 0},s)}),(0,w.aJ)("openSuggestMessageModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{suggestMessageModal:{chatId:s,messageId:o}},n)}),(0,w.aJ)("closeSuggestMessageModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{suggestMessageModal:void 0},s)}),(0,w.aJ)("openSuggestedPostApprovalModal",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{suggestedPostApprovalModal:{chatId:s,messageId:o}},n)}),(0,w.aJ)("closeSuggestedPostApprovalModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{suggestedPostApprovalModal:void 0},s)}),(0,w.aJ)("openDeleteMessageModal",(e,t,a)=>{const{chatId:s,messageIds:o,isSchedule:n,tabId:i=(0,u.g0)()}=a;e=(0,w.mS)(),e=(0,M.w)(e,{deleteMessageModal:{chatId:s,messageIds:o,isSchedule:n}},i),(0,w.UF)(e)}),(0,w.aJ)("closeDeleteMessageModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{deleteMessageModal:void 0},s)}),(0,w.aJ)("openAboutAdsModal",(e,t,a)=>{const{randomId:s,additionalInfo:o,canReport:n,sponsorInfo:i,tabId:r=(0,u.g0)()}=a||{};return(0,M.w)(e,{aboutAdsModal:{randomId:s,canReport:n,additionalInfo:o,sponsorInfo:i}},r)}),(0,w.aJ)("closeAboutAdsModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{aboutAdsModal:void 0},s)}),(0,w.aJ)("closePreparedInlineMessageModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{preparedMessageModal:void 0},s)}),(0,w.aJ)("closeSharePreparedMessageModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{sharePreparedMessageModal:void 0},s)}),(0,w.aJ)("updateSharePreparedMessageModalSendArgs",async(e,t,a)=>{const{args:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o);if(!n.sharePreparedMessageModal)return;if(!s)return e=(0,M.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:void 0}},o),void(0,w.UF)(e);const i=await ne(e,s.peerId);e=(0,w.mS)(),e=(0,M.w)(e,{sharePreparedMessageModal:{...n.sharePreparedMessageModal,pendingSendArgs:{peerId:s.peerId,threadId:s.threadId,starsForSendMessage:i}}},o),(0,w.UF)(e)}),(0,w.aJ)("openQuickPreview",(e,t,a)=>{const{id:s,threadId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{quickPreview:{chatId:s,threadId:o}},n)}),(0,w.aJ)("closeQuickPreview",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{quickPreview:void 0},s)}),(0,w.aJ)("setGlobalSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a,{chatId:n,currentContent:r}=(0,C.nTw)(e,o).globalSearch,d=s&&r!==i.$C.BotApps&&r!==i.$C.PublicPosts?{chats:!n,messages:!0}:void 0;return(0,A.b8O)(e,{globalResults:{},localResults:{},resultsByType:void 0,fetchingStatus:d,query:s},o)}),(0,w.aJ)("setGlobalSearchClosing",(e,t,a)=>{const{tabId:s=(0,u.g0)(),isClosing:o}=a||{};return(0,A.b8O)(e,{isClosing:o},s)}),(0,w.aJ)("addRecentlyFoundChatId",(e,t,a)=>{const{id:s}=a,{recentlyFoundChatIds:o}=e;if(!o)return{...e,recentlyFoundChatIds:[s]};const n=o.filter(e=>e!==s);return n.unshift(s),n.length>10&&n.pop(),{...e,recentlyFoundChatIds:n}}),(0,w.aJ)("clearRecentlyFoundChats",e=>({...e,recentlyFoundChatIds:void 0})),(0,w.aJ)("setGlobalSearchContent",(e,t,a)=>{const{content:s,tabId:o=(0,u.g0)()}=a;return(0,A.GQ)(e,s,o)}),(0,w.aJ)("setGlobalSearchChatId",(e,t,a)=>{const{id:s,tabId:o=(0,u.g0)()}=a;return(0,A.b8O)(e,{chatId:s,query:void 0,resultsByType:void 0},o)}),(0,w.aJ)("openMiddleSearch",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,s)||{};if(o&&n)return(0,A.$RI)(e,o,n,{},s)}),(0,w.aJ)("closeMiddleSearch",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,s)||{};if(o&&n)return(0,A._54)(e,o,n,s)}),(0,w.aJ)("updateMiddleSearch",(e,t,a)=>{const{update:s,tabId:o=(0,u.g0)()}=a;let i,r;if(a.chatId)i=a.chatId,r=a.threadId||n.l3;else{const t=(0,C.Xf0)(e,o);if(!t)return;i=t.chatId,r=t.threadId}return(0,A.$RI)(e,i,r,s,o)}),(0,w.aJ)("resetMiddleSearch",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o,threadId:n}=(0,C.Xf0)(e,s)||{};if(o&&n)return(0,A.zde)(e,o,n,s)}),(0,w.aJ)("setSharedMediaSearchType",(e,t,a)=>{const{mediaType:s,tabId:o=(0,u.g0)()}=a,{chatId:n,threadId:i}=(0,C.Xf0)(e,o)||{};if(n&&i)return(0,A.Tu_)(e,n,i,s,o)}),(0,w.aJ)("setStickerSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{stickerSearch:{query:s,resultIds:void 0}},o)}),(0,w.aJ)("setGifSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{gifSearch:{query:s,offset:void 0,results:void 0}},o)}),(0,w.aJ)("openFrozenAccountModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!0},s)}),(0,w.aJ)("closeFrozenAccountModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isFrozenAccountModalOpen:!1},s)}),(0,w.aJ)("openDeleteAccountModal",(e,t,a)=>{const{days:s,tabId:o=(0,u.g0)()}=a||{};s&&(e=(0,M.w)(e,{...(0,C.nTw)(e,o),deleteAccountModal:{selfDestructAccountDays:s}},o),(0,w.UF)(e))}),(0,w.aJ)("closeDeleteAccountModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{deleteAccountModal:void 0},s)}),(0,w.aJ)("openAgeVerificationModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!0},s)}),(0,w.aJ)("closeAgeVerificationModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isAgeVerificationModalOpen:!1},s)}),(0,w.aJ)("setUserSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;return(0,A.BFh)(e,{globalUserIds:void 0,localUserIds:void 0,fetchingStatus:Boolean(s),query:s},o)}),(0,w.aJ)("openAddContactDialog",(e,t,a)=>{const{userId:s,tabId:o=(0,u.g0)()}=a;return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:o}),e):(0,M.w)(e,{newContact:{userId:s}},o)}),(0,w.aJ)("openNewContactDialog",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:s}),e):(0,M.w)(e,{newContact:{isByPhoneNumber:!0}},s)}),(0,w.aJ)("closeNewContactDialog",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,A.BOn)(e,s)}),(0,w.aJ)("closeSuggestedStatusModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{suggestedStatusModal:void 0},s)}),(0,ut.k)("closeChatRefundModal","chatRefundModal"),(0,w.aJ)("openProfileRatingModal",(e,t,a)=>{const{userId:s,level:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{profileRatingModal:{userId:s,level:o}},n)}),(0,ut.k)("closeProfileRatingModal","profileRatingModal"),a(11117);var vt=a(63495);const bt=/^\d+\.\d+(\.\d+)?$/;var St=a(99375);function yt(e){document.querySelectorAll('link[rel="icon"], link[rel="alternate icon"]').forEach(t=>{e?t.href.includes("favicon-unread")||(t.href=t.href.replace("favicon","favicon-unread")):t.href=t.href.replace("favicon-unread","favicon")})}async function wt(e){vt.Vq?await(window.tauri?.setWindowTitle(e)):document.title!==e&&(document.title=e)}const At=(0,I.sg)(wt,200,!1);let Mt,Ct;(0,w.aJ)("toggleChatInfo",(e,t,a)=>{const{force:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o).chatInfo,i=void 0!==s?s:!n.isOpen;return i!==n.isOpen&&(e=(0,M.w)(e,{chatInfo:{...n,isOpen:i}},o)),{...e,lastIsChatInfoShown:i}}),(0,w.aJ)("toggleAgentChat",(e,t,a)=>{const{force:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o).agentChat,i=void 0!==s?s:!n.isOpen;return i!==n.isOpen&&(e=(0,M.w)(e,{agentChat:{...n,isOpen:i}},o)),e}),(0,w.aJ)("toggleThreadHistory",(e,t,a)=>{const{force:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o).threadHistory,i=void 0!==s?s:!n.isOpen;return i!==n.isOpen&&(e=(0,M.w)(e,{threadHistory:{...n,isOpen:i}},o)),e}),(0,w.aJ)("setLeftColumnWidth",(e,t,a)=>{const{leftColumnWidth:s}=a;return{...e,leftColumnWidth:s}}),(0,w.aJ)("resetLeftColumnWidth",e=>({...e,leftColumnWidth:void 0})),(0,w.aJ)("toggleManagement",(e,t,a)=>{const{force:s,tabId:o=(0,u.g0)()}=a||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:void 0!==s?s:!(i.management.byChatId[n]||{}).isActive}}}},o)}),(0,w.aJ)("requestNextManagementScreen",(e,t,a)=>{const{screen:s,tabId:o=(0,u.g0)()}=a||{},{chatId:n}=(0,C.Xf0)(e,o)||{};if(!n)return;const i=(0,C.nTw)(e,o);return(0,M.w)(e,{management:{byChatId:{...i.management.byChatId,[n]:{...i.management.byChatId[n],isActive:!0,nextScreen:s}}}},o)}),(0,w.aJ)("closeManagement",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{chatId:o}=(0,C.Xf0)(e,s)||{};if(!o)return;const n=(0,C.nTw)(e,s);return(0,M.w)(e,{management:{byChatId:{...n.management.byChatId,[o]:{...n.management.byChatId[o],isActive:!1}}}},s)}),(0,w.aJ)("processOpenChatOrThread",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a;if((0,O.Ny)()||(0,O.Bb)())return(0,M.w)(e,{isLeftColumnShown:0===(0,C.nTw)(e,s).messageLists.length},s)}),(0,w.aJ)("changeProfileTab",(e,t,a)=>{const{profileTab:s,shouldScrollTo:o,tabId:n=(0,u.g0)()}=a,{chatId:i}=(0,C.Xf0)(e,n)||{};if(!i)return;const r=(0,C.nTw)(e,n).chatInfo;return(0,M.w)(e,{chatInfo:{...r,isOpen:!0,profileTab:s,forceScrollProfileTab:o}},n)}),(0,w.aJ)("toggleStatistics",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{isStatisticsShown:!o.isStatisticsShown,statistics:{...o.statistics,currentMessageId:void 0,currentStoryId:void 0}},s)}),(0,w.aJ)("toggleMessageStatistics",(e,t,a)=>{const{tabId:s=(0,u.g0)(),messageId:o}=a||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,s).statistics,currentMessageId:o,currentMessage:void 0,currentStoryId:void 0,currentStory:void 0}},s)}),(0,w.aJ)("toggleStoryStatistics",(e,t,a)=>{const{tabId:s=(0,u.g0)(),storyId:o}=a||{};return(0,M.w)(e,{statistics:{...(0,C.nTw)(e,s).statistics,currentStoryId:o,currentMessageId:void 0,currentMessage:void 0,currentStory:void 0}},s)}),(0,w.aJ)("toggleLeftColumn",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isLeftColumnShown:!(0,C.nTw)(e,s).isLeftColumnShown},s)}),(0,w.aJ)("addRecentEmoji",(e,t,a)=>{const{emoji:s}=a,{recentEmojis:o}=e;if(!o)return{...e,recentEmojis:[s]};const n=o.filter(e=>e!==s);return n.unshift(s),n.length>32&&n.pop(),{...e,recentEmojis:n}}),(0,w.aJ)("addRecentSticker",(e,t,a)=>{const{sticker:s}=a,{recent:o}=e.stickers;if(!o)return{...e,stickers:{...e.stickers,recent:{hash:"0",stickers:[s]}}};const n=o.stickers.filter(e=>e.id!==s.id);return n.unshift(s),{...e,stickers:{...e.stickers,recent:{...o,stickers:n}}}}),(0,w.aJ)("addRecentCustomEmoji",(e,t,a)=>{const{documentId:s}=a,{recentCustomEmojis:o}=e;if(!o)return{...e,recentCustomEmojis:[s]};const n=o.filter(e=>e!==s);return n.unshift(s),n.length>32&&n.pop(),{...e,recentCustomEmojis:n}}),(0,w.aJ)("clearRecentCustomEmoji",e=>({...e,recentCustomEmojis:[]})),(0,w.aJ)("reorderStickerSets",(e,t,a)=>{const{order:s,isCustomEmoji:o}=a;return{...e,stickers:{...e.stickers,added:{setIds:o?e.stickers.added.setIds:s}},customEmojis:{...e.customEmojis,added:{setIds:o?s:e.customEmojis.added.setIds}}}}),(0,w.aJ)("showAllowedMessageTypesNotification",(e,t,a)=>{const{chatId:s,messageListType:o,tabId:n=(0,u.g0)()}=a;if((0,C.WA9)(e,s)&&"scheduled"===o)return void t.showNotification({message:{key:"DescriptionScheduledPaidMessagesNotAllowed"},tabId:n});const i=(0,C.hds)(e,s);if(!i)return;const r=(0,C.AWZ)(e,s),d=s?(0,C.nZ4)(e,s):void 0,c=s?(0,C.ALW)(e,i):void 0,{canSendPlainText:l,canSendPhotos:m,canSendVideos:p,canSendDocuments:g,canSendAudios:I,canSendStickers:v,canSendRoundVideos:b,canSendVoices:y}=(0,S.Q_)(i,r,c,d),w=(0,h.oE)([l?"Chat.SendAllowedContentTypeText":void 0,m?"Chat.SendAllowedContentTypePhoto":void 0,p?"Chat.SendAllowedContentTypeVideo":void 0,y?"Chat.SendAllowedContentTypeVoiceMessage":void 0,b?"Chat.SendAllowedContentTypeVideoMessage":void 0,g?"Chat.SendAllowedContentTypeFile":void 0,I?"Chat.SendAllowedContentTypeMusic":void 0,v?"Chat.SendAllowedContentTypeSticker":void 0]).map(e=>f.yE(e));if(!w.length)return void t.showNotification({message:f.yE("Chat.SendNotAllowedText"),tabId:n});const A=f.yE("AutoDownloadSettings.LastDelimeter"),M=w.join(", ").replace(/,([^,]*)$/,`${A}$1`);t.showNotification({message:f.yE("Chat.SendAllowedContentText",M),tabId:n})}),(0,w.aJ)("showDialog",(e,t,a)=>{const{data:s,tabId:o=(0,u.g0)()}=a;if("message"in s&&s.hasErrorKey&&!(0,St.Ay)(s))return e;const n=[...(0,C.nTw)(e,o).dialogs];if("message"in s){const e=n.findIndex(e=>e.message===s.message);-1!==e&&n.splice(e,1)}return n.push(s),(0,M.w)(e,{dialogs:n},o)}),(0,w.aJ)("dismissDialog",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=[...(0,C.nTw)(e,s).dialogs];return o.pop(),(0,M.w)(e,{dialogs:o},s)}),(0,w.aJ)("toggleSafeLinkModal",(e,t,a)=>{const{url:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{safeLinkModalUrl:s},o)}),(0,w.aJ)("openHistoryCalendar",(e,t,a)=>{const{selectedAt:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{historyCalendarSelectedAt:s},o)}),(0,w.aJ)("closeHistoryCalendar",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{historyCalendarSelectedAt:void 0},s)}),(0,w.aJ)("openGame",(e,t,a)=>{const{url:s,chatId:o,messageId:n,tabId:i=(0,u.g0)()}=a,r=(0,C.O5q)(e,o,n);if(!r)return;const d=r.viaBotId||(0,C.Y7C)(e,r)?.id;if(d){if(!(0,C.nTL)(e,d))return e=(0,M.w)(e,{botTrustRequest:{botId:d,type:"game",onConfirm:{action:"openGame",payload:a}}},i),void(0,w.UF)(e);e=(0,M.w)(e,{openedGame:{url:s,chatId:o,messageId:n}},i),(0,w.UF)(e)}}),(0,w.aJ)("closeGame",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{openedGame:void 0},s)}),(0,w.aJ)("requestConfetti",(e,t,a)=>{const{tabId:s=(0,u.g0)(),...o}=a;if((0,C.PKK)(e))return(0,M.w)(e,{confetti:{lastConfettiTime:Date.now(),...o}},s)}),(0,w.aJ)("requestWave",(e,t,a)=>{const{startX:o,startY:n,tabId:i=(0,u.g0)()}=a;if(!d.J6||!(0,C.PKK)(e))return;const r=(0,C.nTw)(e,i),c=r.wave?.lastWaveTime||0;return Date.now()-c<s.S4O?void 0:(0,M.w)(e,{wave:{lastWaveTime:Date.now(),startX:o,startY:n}},i)}),(0,w.aJ)("updateAttachmentSettings",(e,t,a)=>({...e,attachmentSettings:{...e.attachmentSettings,...a}})),(0,w.aJ)("updateShouldSaveAttachmentsCompression",(e,t,a)=>{const{shouldSave:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{shouldSaveAttachmentsCompression:s},o)}),(0,w.aJ)("applyDefaultAttachmentsCompression",e=>{const{defaultAttachmentCompression:t}=e.attachmentSettings,a="compress"===t;return{...e,attachmentSettings:{...e.attachmentSettings,shouldCompress:a}}}),(0,w.aJ)("requestEffectInComposer",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a;return(0,M.w)(e,{shouldPlayEffectInComposer:!0},s)}),(0,w.aJ)("hideEffectInComposer",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a;return(0,M.w)(e,{shouldPlayEffectInComposer:void 0},s)}),(0,w.aJ)("setPaidMessageAutoApprove",e=>({...e,settings:{...e.settings,byKey:{...e.settings.byKey,shouldPaidMessageAutoApprove:!0}}})),(0,w.aJ)("setReactionEffect",(e,t,a)=>{const{chatId:s,threadId:o,reaction:n,tabId:i=(0,u.g0)()}=a,r="emoji"===n?.type&&n.emoticon;if(!r)return;const d=Object.values(e.availableEffectById).find(e=>e.effectAnimationId&&e.emoticon===r),c=d?.id,l=(0,C.g29)(e);!d?.isPremium||l?c&&(t.requestEffectInComposer({tabId:i}),t.saveEffectInDraft({chatId:s,threadId:o,effectId:c})):t.openPremiumModal({initialSection:"effects",tabId:i})}),(0,w.aJ)("openLimitReachedModal",(e,t,a)=>{const{limit:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{limitReachedModal:{limit:s}},o)}),(0,w.aJ)("closeLimitReachedModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{limitReachedModal:void 0},s)}),(0,w.aJ)("closeStickerSetModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{openedStickerSetShortName:void 0},s)}),(0,w.aJ)("openCustomEmojiSets",(e,t,a)=>{const{setIds:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{openedCustomEmojiSetIds:s},o)}),(0,w.aJ)("closeCustomEmojiSets",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{openedCustomEmojiSetIds:void 0},s)}),(0,w.aJ)("updateLastRenderedCustomEmojis",(e,t,a)=>{const{ids:o}=a,{lastRendered:n}=e.customEmojis;return{...e,customEmojis:{...e.customEmojis,lastRendered:(0,h.Am)([...n,...o]).slice(0,s.GW0)}}}),(0,w.aJ)("openCreateTopicPanel",(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a;return(0,C.meB)(e,o)||t.openChat({id:s,tabId:o}),(0,M.w)(e,{createTopicPanel:{chatId:s}},o)}),(0,w.aJ)("closeCreateTopicPanel",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{createTopicPanel:void 0},s)}),(0,w.aJ)("openEditTopicPanel",(e,t,a)=>{const{chatId:s,topicId:o,tabId:n=(0,u.g0)()}=a;return(0,C.meB)(e,n)||t.openChat({id:s,tabId:n}),(0,M.w)(e,{editTopicPanel:{chatId:s,topicId:o}},n)}),(0,w.aJ)("closeEditTopicPanel",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{editTopicPanel:void 0},s)}),(0,w.aJ)("updateArchiveSettings",(e,t,a)=>{const{archiveSettings:s}=e,{isHidden:o=s.isHidden,isMinimized:n=s.isMinimized}=a;return{...e,archiveSettings:{isHidden:o,isMinimized:n}}}),(0,w.aJ)("openMapModal",(e,t,a)=>{const{geoPoint:s,zoom:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{mapModal:{point:s,zoom:o}},n)}),(0,w.aJ)("closeMapModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{mapModal:void 0},s)}),(0,w.aJ)("checkAppVersion",e=>{fetch(`version.txt?${Date.now()}`).then(e=>e.text()).then(t=>{(function(e,t){const a=e.trim();return!!bt.test(a)&&a!==t})(t=t.trim(),"12.16.0")&&(e=(0,w.mS)(),e={...e,isAppUpdateAvailable:!0},(0,w.UF)(e))}).catch(e=>{s.Oig&&console.error("[checkAppVersion failed] ",e)})}),(0,w.aJ)("afterHangUp",e=>{(0,C.nTw)(e,(0,u.g0)()).multitabNextAction&&(0,u.I)()}),(0,w.aJ)("onTabFocusChange",(e,t,a)=>{const{isBlurred:s,tabId:o=(0,u.g0)()}=a;return s?(Mt&&clearInterval(Mt),Mt=window.setInterval(()=>{t.updatePageTitle({tabId:o})},500)):(clearInterval(Mt),Mt=void 0),e=(0,M.w)(e,{isBlurred:s},o),{...e,initialUnreadNotifications:s?(0,Te.vp)():void 0}}),(0,w.aJ)("updatePageTitle",(e,t,a)=>{const{tabId:o=(0,u.g0)()}=a||{},{canDisplayChatInTitle:n}=(0,je.lS)(e),i=e.currentUserId,r=e.config?.isTestServer,d=r?"[T] ":"",c=vt.Vq?s.zGP:s.j0M;if(document.title.includes(s.LaL))return yt(!1),void wt(`${d}${c} ${s.LaL}`);if(!vt.Vq&&e.initialUnreadNotifications&&Math.round(Date.now()/1e3)%2==0){const t=(0,Te.vp)()-e.initialUnreadNotifications;if(t>0)return wt(`${d}${t} notification${t>1?"s":""}`),void yt(!0)}yt(!1);const l=(0,C.Xf0)(e,o);if(l&&n&&!e.passcode.isScreenLocked){const{chatId:t,threadId:a}=l,s=(0,C.hds)(e,t);if(s){const o=(0,S.Js)(f.yE,s,t===i),n=(0,C.S0q)(e,t,a);return s.isForum&&n?void At(`${d}${o}  ${n.title}`):void At(`${d}${o}`)}}wt(`${d}${c}`)}),(0,w.aJ)("closeInviteViaLinkModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a??{};return(0,M.w)(e,{inviteViaLinkModal:void 0},s)}),(0,w.aJ)("closeCollectibleInfoModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a??{};return(0,M.w)(e,{collectibleInfoModal:void 0},s)}),(0,w.aJ)("openBirthdaySetupModal",(e,t,a)=>{const{currentBirthday:s,tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{birthdaySetupModal:{currentBirthday:s}},o)}),(0,ut.k)("closeBirthdaySetupModal","birthdaySetupModal"),(0,w.aJ)("setShouldCloseRightColumn",(e,t,a)=>{const{value:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{shouldCloseRightColumn:s},o)}),(0,w.aJ)("refreshLangPackFromCache",(e,t,a)=>{(0,p.K1)(a.langCode)}),(0,w.aJ)("processPremiumFloodWait",(e,t,a)=>{const{isUpload:s}=a,{bandwidthPremiumDownloadSpeedup:o,bandwidthPremiumUploadSpeedup:n,bandwidthPremiumNotifyPeriod:i}=e.appConfig,{lastPremiumBandwithNotificationDate:r}=e.settings;if(o&&n&&i&&!(r&&Date.now()<r+1e3*i))return Object.values(e.byTabId).filter(e=>!e.isBlurred).map(e=>e.id).forEach(e=>{t.showNotification({title:f.yE(s?"UploadSpeedLimited":"DownloadSpeedLimited"),message:f.yE(s?"UploadSpeedLimitedMessage":"DownloadSpeedLimitedMessage",s?n:o),duration:6e3,tabId:e})}),{...e,settings:{...e.settings,lastPremiumBandwithNotificationDate:Date.now()}}});let Pt,kt=0;(0,ke.DW)(e=>{const{updatePageTitle:t,updateIsOnline:a}=(0,w.ko)(),s=e.passcode.isScreenLocked!==Ct,o=Object.values(e.byTabId).filter(e=>e.isBlurred).length,n=(0,C.nTw)(e,(0,u.g0)()).isMasterTab;s&&t(),o!==kt&&n&&(Pt&&clearTimeout(Pt),Pt=window.setTimeout(()=>{e=(0,w.mS)();const t=Object.values(e.byTabId).filter(e=>e.isBlurred).length;a({isOnline:t!==(0,u.gb)().length})},100)),Ct=e.passcode.isScreenLocked,kt=o}),(0,w.aJ)("closePaymentModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s).payment.status||"cancelled",n=(0,C.nTw)(e,s).starsBalanceModal;return t.processOriginStarsPayment({originData:n,status:o,tabId:s}),e=(0,A.GSI)(e,s),(0,A._$X)(e,{status:o},s)}),(0,w.aJ)("resetPaymentStatus",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return e=(0,A._$X)(e,{status:void 0},s),(0,A.nv6)(e,{status:void 0},s)}),(0,w.aJ)("addPaymentError",(e,t,a)=>{const{error:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{payment:{...(0,C.nTw)(e,o).payment,status:"failed",error:s}},o)}),(0,w.aJ)("closeGiveawayModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{giveawayModal:void 0},s)}),(0,w.aJ)("closeGiftCodeModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftCodeModal:void 0},s)}),(0,w.aJ)("updateGiftProfileFilter",(e,t,a)=>{const{filter:s,peerId:o,tabId:n=(0,u.g0)()}=a||{},i=(0,C.nTw)(e,n),r=i.savedGifts.filter;let d={...r,...s};d.shouldIncludeUnlimited||d.shouldIncludeLimited||d.shouldIncludeUnique||d.shouldIncludeUpgradable||(d={...r,shouldIncludeUnlimited:!0,shouldIncludeLimited:!0,shouldIncludeUnique:!0,shouldIncludeUpgradable:!0,...s}),d.shouldIncludeDisplayed||d.shouldIncludeHidden||(d={...r,shouldIncludeDisplayed:!0,shouldIncludeHidden:!0,...s});const c=(0,C.B59)(e,o,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,collectionsByPeerId:{[o]:{[c]:i.savedGifts.collectionsByPeerId[o]?.[c]}},filter:d}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("resetGiftProfileFilter",(e,t,a)=>{const{peerId:o,tabId:n=(0,u.g0)()}=a||{},i=(0,C.nTw)(e,n),r=(0,C.B59)(e,o,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,collectionsByPeerId:{[o]:{[r]:i.savedGifts.collectionsByPeerId[o]?.[r]}},filter:{...s.tBS}}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:o,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("openPaymentMessageConfirmDialogOpen",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!0},s)}),(0,w.aJ)("closePaymentMessageConfirmDialogOpen",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{isPaymentMessageConfirmDialogOpen:!1},s)}),(0,w.aJ)("openPriceConfirmModal",(e,t,a)=>{const{originalAmount:s,newAmount:o,currency:n,directInfo:i,tabId:r=(0,u.g0)()}=a;return(0,M.w)(e,{priceConfirmModal:{originalAmount:s,newAmount:o,currency:n,directInfo:i}},r)}),(0,w.aJ)("closePriceConfirmModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{priceConfirmModal:void 0},s)});var Tt=a(12859);(0,w.aJ)("openMediaViewer",(e,t,a)=>{const{chatId:s,threadId:o=n.l3,messageId:i,timestamp:r,mediaIndex:d,isAvatarView:c,isSponsoredMessage:l,origin:h,withDynamicLoading:m,standaloneMedia:p,tabId:g=(0,u.g0)()}=a,f=(0,C.nTw)(e,g);return(0,M.w)(e,{mediaViewer:{...f.mediaViewer,chatId:s,threadId:o,messageId:i,mediaIndex:d||0,isAvatarView:c,isSponsoredMessage:l,origin:h,standaloneMedia:p,isHidden:!1,withDynamicLoading:m,timestamp:r},forwardMessages:{},isShareMessageModalShown:!1},g)}),(0,w.aJ)("closeMediaViewer",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{volume:o,isMuted:n,playbackRate:i,isHidden:r}=(0,C.nTw)(e,s).mediaViewer;return(0,M.w)(e,{mediaViewer:{volume:o,isMuted:n,isHidden:r,playbackRate:i}},s)}),(0,w.aJ)("openMediaFromTimestamp",(e,t,a)=>{const{chatId:s,messageId:o,threadId:n,timestamp:r,tabId:d=(0,u.g0)()}=a,c=(0,C.O5q)(e,s,o);if(!c)return;const l=(0,F.Q)(c),h=(0,C.gMr)(e,c),m=(0,pt.ly)(e,c),p=m?.duration;if(p){if(p<=r)return;return"video"===m.mediaType?void t.openMediaViewer({chatId:s,messageId:o,threadId:n,origin:i.TQ.Inline,timestamp:r,tabId:d}):void t.openAudioPlayer({chatId:s,messageId:o,threadId:n,origin:i.d9.Inline,timestamp:r,tabId:d})}const g=h?(0,pt.ly)(e,h):void 0,f=g?.duration;!f||f<=r||("video"!==g.mediaType?t.openAudioPlayer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.d9.Inline,timestamp:r,tabId:d}):t.openMediaViewer({chatId:h.chatId,messageId:h.id,threadId:l?.replyToTopId,origin:i.TQ.Inline,timestamp:r,tabId:d}))}),(0,w.aJ)("updateLastPlaybackTimestamp",(e,t,a)=>{const{chatId:s,messageId:o,timestamp:n}=a,i=e.messages.playbackByChatId[s]?.byId||{};return n?{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[s]:{byId:{...i,[o]:n}}}}}:{...e,messages:{...e.messages,playbackByChatId:{...e.messages.playbackByChatId,[s]:{byId:(0,h.cJ)(i,[o])}}}}}),(0,w.aJ)("setMediaViewerVolume",(e,t,a)=>{const{volume:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,volume:s,isMuted:!1}},o)}),(0,w.aJ)("setMediaViewerPlaybackRate",(e,t,a)=>{const{playbackRate:s,tabId:o=(0,u.g0)()}=a;return e={...e,mediaViewer:{...e.mediaViewer,lastPlaybackRate:s}},(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,playbackRate:s}},o)}),(0,w.aJ)("setMediaViewerMuted",(e,t,a)=>{const{isMuted:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isMuted:s}},o)}),(0,w.aJ)("setMediaViewerHidden",(e,t,a)=>{const{isHidden:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{mediaViewer:{...(0,C.nTw)(e,o).mediaViewer,isHidden:s}},o)});var Ft=a(70934),Bt=a(57751),Ut=a(42385),xt=a(20714);let Nt=!1;(0,I.yu)(()=>{const e=(0,w.mS)();e.isInited&&e.passcode.hasPasscode&&!Nt&&1===Object.keys(e.byTabId).length&&(0,Bt.rE)()}),(0,w.aJ)("setPasscode",async(e,t,a)=>{const{passcode:s,tabId:o=(0,u.g0)()}=a;e=(0,A.Vg3)(e,{isLoading:!0}),(0,w.UF)(e),await(0,Ft.IG)(s);const n=JSON.stringify({...(0,Bt.CX)(),userId:e.currentUserId});e=(0,w.mS)();const r=(0,Ut.Mm)((0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}));try{await(0,Ft.yp)(n,r),(0,u.ZQ)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{hasPasscode:!0,error:void 0,isLoading:!1}),(0,w.UF)(e),(0,Ut.Bo)(!0)}catch(a){(0,Ft.m)(),e=(0,w.mS)(),e=(0,A.Vg3)(e,{isLoading:!1}),(0,w.UF)(e),t.showNotification({message:"Failed to set passcode",tabId:o}),t.openSettingsScreen({screen:i.VS.PasscodeDisabled,tabId:o})}}),(0,w.aJ)("clearPasscode",e=>((0,Ft.WN)(),localStorage.removeItem(s.ozB),(0,A.XQb)(e))),(0,w.aJ)("unlockScreen",(e,t,a)=>{const s=Object.values(e.byTabId),{sessionJson:o,globalJson:n}=a,i=JSON.parse(o);(0,Bt.AA)(i);const r=e;(e=JSON.parse(n)).byTabId=r.byTabId,(0,Ut.e)(e,(0,h.mg)(xt.HB)),e=(0,A.Vg3)(e,{isScreenLocked:!1,error:void 0,invalidAttemptsCount:0}),(0,w.UF)(e),(0,u.ZQ)(),s.forEach(({id:e,isMasterTab:a})=>t.init({tabId:e,isMasterTab:a})),t.initApi()}),(0,w.aJ)("logInvalidUnlockAttempt",e=>{const t=(e.passcode?.invalidAttemptsCount??0)+1;return(0,A.Vg3)(e,{invalidAttemptsCount:t,timeoutUntil:t>=5?Date.now()+15e3:void 0})}),(0,w.aJ)("resetInvalidUnlockAttempts",e=>(0,A.Vg3)(e,{invalidAttemptsCount:0,timeoutUntil:void 0})),(0,w.aJ)("setPasscodeError",(e,t,a)=>{const{error:s}=a;return(0,A.Vg3)(e,{error:s})}),(0,w.aJ)("clearPasscodeError",e=>(0,A.Vg3)(e,{error:void 0})),(0,w.aJ)("skipLockOnUnload",()=>{Nt=!0}),(0,w.aJ)("processOriginStarsPayment",(e,t,a)=>{const{originData:s,status:o,tabId:n=(0,u.g0)()}=a,{originStarsPayment:i,originReaction:r,originGift:d,topup:c}=s||{};if((i||r||d||c)&&(t.closeStarsBalanceModal({tabId:n}),"paid"===o))return i&&(e=(0,M.w)(e,{starsPayment:i},n)),r&&t.sendPaidReaction({chatId:r.chatId,messageId:r.messageId,forcedAmount:r.amount,tabId:n}),d&&t.sendStarGift({...d,tabId:n}),e}),(0,w.aJ)("openGiftRecipientPicker",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,C.trm)(e)?(t.openFrozenAccountModal({tabId:s}),e):(0,M.w)(e,{isGiftRecipientPickerOpen:!0},s)}),(0,ut.k)("closeGiftRecipientPicker","isGiftRecipientPickerOpen"),(0,w.aJ)("openStarsGiftingPickerModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{starsGiftingPickerModal:{isOpen:!0}},s)}),(0,ut.k)("closeStarsGiftingPickerModal","starsGiftingPickerModal"),(0,w.aJ)("openPrizeStarsTransactionFromGiveaway",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a||{},i=(0,C.O5q)(e,s,o);if(!i)return;const r=(0,$e.D5)(i);return r?(0,A.V5q)(e,r,n):void 0}),(0,w.aJ)("openStarsBalanceModal",(e,t,a)=>{const{originStarsPayment:o,originReaction:n,originGift:i,topup:r,shouldIgnoreBalance:d,currency:c=s.OUy,tabId:l=(0,u.g0)()}=a||{},h=e.stars?.balance;if(!(!d&&h&&r&&r.balanceNeeded<=h.amount))return e=(0,A.Y1r)(e,l),t.loadStarStatus(),(0,M.w)(e,{starsBalanceModal:{originStarsPayment:o,originReaction:n,originGift:i,topup:r,currency:c}},l);t.showNotification({message:f.yE("StarsTopupLinkEnough"),actionText:f.yE("StarsTopupLinkTopupAnyway"),action:{action:"openStarsBalanceModal",payload:{topup:r,shouldIgnoreBalance:!0,tabId:l}},icon:"star",tabId:l})}),(0,ut.k)("closeStarsBalanceModal","starsBalanceModal"),(0,w.aJ)("closeStarsPaymentModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.Osl)(e,s);let n=o?.status;return n&&"pending"!==n||(n="cancelled"),(0,M.w)(e,{starsPayment:{status:n}},s)}),(0,w.aJ)("openStarsTransactionModal",(e,t,a)=>{const{transaction:s,tabId:o=(0,u.g0)()}=a;return(0,A.V5q)(e,s,o)}),(0,w.aJ)("openStarsTransactionFromGift",(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a||{},i=(0,C.O5q)(e,s,o);if(!i)return;const r=(0,$e.M6)(i);return r?(0,A.V5q)(e,r,n):void 0}),(0,ut.k)("closeStarsTransactionModal","starsTransactionModal"),(0,w.aJ)("openStarsSubscriptionModal",(e,t,a)=>{const{subscription:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{starsSubscriptionModal:{subscription:s}},o)}),(0,ut.k)("closeStarsSubscriptionModal","starsSubscriptionModal"),(0,ut.k)("closeGiftModal","giftModal"),(0,w.aJ)("setGiftModalSelectedGift",(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o),i=n?.giftModal;if(i)return(0,M.w)(e,{giftModal:{...i,selectedGift:s}},o);s&&"id"in s&&t.openGiftModal({forUserId:e.currentUserId,selectedGift:s,tabId:o})}),(0,w.aJ)("closeStarsGiftModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{starsGiftModal:{isOpen:!1}},s)}),(0,w.aJ)("openGiftInfoModalFromMessage",async(e,t,a)=>{const{chatId:s,messageId:o,tabId:n=(0,u.g0)()}=a;if(!(0,C.hds)(e,s))return;await(0,w.pv)().loadMessage({chatId:s,messageId:o}),e=(0,w.mS)();const i=(0,C.O5q)(e,s,o);if(!i||!i.content.action)return;const r=i.content.action;if("starGift"!==r.type&&"starGiftUnique"!==r.type)return;const d="starGift"===r.type?r:void 0,c="starGiftUnique"===r.type?r:void 0,l=d?.giftMsgId,h=r.peerId||(i.isOutgoing?i.chatId:e.currentUserId),m=l?{type:"user",messageId:l}:r.savedId?{type:"chat",chatId:s,savedId:r.savedId}:{type:"user",messageId:o},p=r.fromId||(i.isOutgoing?e.currentUserId:i.chatId),g={date:i.date,gift:r.gift,message:d?.message,starsToConvert:d?.starsToConvert,isNameHidden:d?.isNameHidden,isUnsaved:!r.isSaved,fromId:p,messageId:i.id,isConverted:d?.isConverted,upgradeMsgId:d?.upgradeMsgId,canUpgrade:d?.canUpgrade,alreadyPaidUpgradeStars:d?.alreadyPaidUpgradeStars,inputGift:m,canExportAt:c?.canExportAt,savedId:r.savedId,transferStars:c?.transferStars,dropOriginalDetailsStars:c?.dropOriginalDetailsStars,prepaidUpgradeHash:d?.prepaidUpgradeHash};t.openGiftInfoModal({peerId:h,gift:g,tabId:n})}),(0,w.aJ)("openGiftInfoModal",(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a,n="peerId"in a?a.peerId:void 0,i="recipientId"in a?a.recipientId:void 0;return(0,M.w)(e,{giftInfoModal:{peerId:n,gift:s,recipientId:i}},o)}),(0,w.aJ)("openLockedGiftModalInfo",(e,t,a)=>{const{untilDate:s,reason:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{lockedGiftModal:{untilDate:s,reason:o}},n)}),(0,ut.k)("closeLockedGiftModal","lockedGiftModal"),(0,w.aJ)("openGiftResalePriceComposerModal",(e,t,a)=>{const{gift:s,peerId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{giftResalePriceComposerModal:{peerId:o,gift:s}},n)}),(0,w.aJ)("openGiftInMarket",(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o).giftModal;return t.closeGiftInfoValueModal({tabId:o}),t.closeGiftInfoModal({tabId:o}),n?(0,M.w)(e,{giftModal:{...n,selectedResaleGift:s}},o):(t.openGiftModal({forUserId:e.currentUserId,selectedResaleGift:s,tabId:o}),e)}),(0,w.aJ)("closeResaleGiftsMarket",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};t.resetResaleGifts({tabId:s});const o=(0,C.nTw)(e,s).giftModal;return o?(0,M.w)(e,{giftModal:{...o,selectedResaleGift:void 0}},s):e}),(0,w.aJ)("openGiftInfoValueModal",async(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a,n=await(0,b.px)("fetchUniqueStarGiftValueInfo",{slug:s.slug});n&&(e=(0,w.mS)(),e=(0,M.w)(e,{giftInfoValueModal:{valueInfo:n,gift:s}},o),(0,w.UF)(e))}),(0,ut.k)("closeGiftInfoModal","giftInfoModal"),(0,ut.k)("closeGiftInfoValueModal","giftInfoValueModal"),(0,ut.k)("closeGiftResalePriceComposerModal","giftResalePriceComposerModal"),(0,ut.k)("closeGiftUpgradeModal","giftUpgradeModal"),(0,w.aJ)("closeGiftAuctionModal",(e,t,a)=>{const{shouldKeepActiveAuction:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o);return(0,M.w)(e,{giftAuctionModal:void 0,activeGiftAuction:s?n?.activeGiftAuction:void 0},o)}),(0,w.aJ)("openGiftAuctionBidModal",(e,t,a)=>{const{peerId:s,message:o,shouldHideName:n,tabId:i=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftAuctionBidModal:{isOpen:!0,peerId:s,message:o,shouldHideName:n}},i)}),(0,ut.k)("closeGiftAuctionBidModal","giftAuctionBidModal"),(0,w.aJ)("openGiftAuctionInfoModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftAuctionInfoModal:{isOpen:!0}},s)}),(0,ut.k)("closeGiftAuctionInfoModal","giftAuctionInfoModal"),(0,w.aJ)("openGiftAuctionChangeRecipientModal",(e,t,a)=>{const{oldPeerId:s,newPeerId:o,message:n,shouldHideName:i,tabId:r=(0,u.g0)()}=a;return(0,M.w)(e,{giftAuctionChangeRecipientModal:{isOpen:!0,oldPeerId:s,newPeerId:o,message:n,shouldHideName:i}},r)}),(0,ut.k)("closeGiftAuctionChangeRecipientModal","giftAuctionChangeRecipientModal"),(0,ut.k)("closeGiftAuctionAcquiredModal","giftAuctionAcquiredModal"),(0,w.aJ)("openStarGiftPriceDecreaseInfoModal",(e,t,a)=>{const{prices:s,currentPrice:o,minPrice:n,maxPrice:i,tabId:r=(0,u.g0)()}=a;return(0,M.w)(e,{starGiftPriceDecreaseInfoModal:{prices:s,currentPrice:o,minPrice:n,maxPrice:i}},r)}),(0,ut.k)("closeStarGiftPriceDecreaseInfoModal","starGiftPriceDecreaseInfoModal"),(0,w.aJ)("openGiftWithdrawModal",(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftWithdrawModal:{gift:s}},o)}),(0,ut.k)("closeGiftWithdrawModal","giftWithdrawModal"),(0,w.aJ)("openGiftStatusInfoModal",(e,t,a)=>{const{emojiStatus:s,tabId:o=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftStatusInfoModal:{emojiStatus:s}},o)}),(0,w.aJ)("closeGiftStatusInfoModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{giftStatusInfoModal:void 0},s)}),(0,w.aJ)("clearGiftWithdrawError",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s),n=o?.giftWithdrawModal;if(n)return(0,M.w)(e,{giftWithdrawModal:{...n,errorKey:void 0}},s)}),(0,w.aJ)("openGiftTransferModal",(e,t,a)=>{const{gift:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{giftTransferModal:{gift:s}},o)}),(0,ut.k)("closeGiftTransferModal","giftTransferModal"),(0,w.aJ)("openGiftTransferConfirmModal",(e,t,a)=>{const{gift:s,recipientId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{giftTransferConfirmModal:{gift:s,recipientId:o}},n)}),(0,ut.k)("closeGiftTransferConfirmModal","giftTransferConfirmModal"),(0,w.aJ)("openGiftDescriptionRemoveModal",(e,t,a)=>{const{gift:s,price:o,details:n,tabId:i=(0,u.g0)()}=a;return(0,M.w)(e,{giftDescriptionRemoveModal:{gift:s,price:o,details:n}},i)}),(0,ut.k)("closeGiftDescriptionRemoveModal","giftDescriptionRemoveModal"),(0,w.aJ)("updateSelectedGiftCollection",(e,t,a)=>{const{peerId:s,collectionId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.nTw)(e,n);e=(0,M.w)(e,{savedGifts:{...i.savedGifts,activeCollectionByPeerId:{...i.savedGifts.activeCollectionByPeerId,[s]:o}}},n),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:s,shouldRefresh:!0,tabId:i.id})}),(0,w.aJ)("resetSelectedGiftCollection",(e,t,a)=>{const{peerId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);e=(0,M.w)(e,{savedGifts:{...n.savedGifts,activeCollectionByPeerId:{...n.savedGifts.activeCollectionByPeerId,[s]:void 0}}},o),(0,w.UF)(e),t.loadPeerSavedGifts({peerId:s,shouldRefresh:!0,tabId:n.id})}),(0,w.aJ)("processOpenChatOrThread",(e,t,a)=>{const{chatId:s,tabId:o=(0,u.g0)()}=a;return s?(0,M.w)(e,{reactionPicker:{chatId:s,messageId:void 0,position:void 0}},o):(0,M.w)(e,{reactionPicker:void 0},o)}),(0,w.aJ)("openMessageReactionPicker",(e,t,a)=>{const{chatId:s,messageId:o,position:n,tabId:i=(0,u.g0)()}=a;return(0,M.w)(e,{reactionPicker:{chatId:s,messageId:o,position:n}},i)}),(0,w.aJ)("openStoryReactionPicker",(e,t,a)=>{const{peerId:s,storyId:o,position:n,sendAsMessage:i,tabId:r=(0,u.g0)()}=a;return(0,M.w)(e,{reactionPicker:{storyPeerId:s,storyId:o,sendAsMessage:i,position:n}},r)}),(0,w.aJ)("openEffectPicker",(e,t,a)=>{const{position:s,chatId:o,tabId:n=(0,u.g0)()}=a;return(0,M.w)(e,{reactionPicker:{position:s,chatId:o,isForEffects:!0}},n)}),(0,w.aJ)("closeReactionPicker",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{reactionPicker:{...o.reactionPicker,messageId:void 0,position:void 0,storyId:void 0,storyPeerId:void 0,isForEffects:void 0}},s)}),(0,w.aJ)("resetLocalPaidReactions",(e,t,a)=>{const{chatId:s,messageId:o}=a,n=(0,C.O5q)(e,s,o);if(!n)return;const{reactions:i}=n;if(!i)return;const r=i.results.map(e=>{if(e.localAmount){if(!e.count)return;return{...e,localAmount:void 0,localPreviousChosenOrder:void 0,chosenOrder:e.localPreviousChosenOrder}}return e}).filter(Boolean);return Object.values(e.byTabId).forEach(({id:e})=>{t.dismissNotification({localId:(0,m.bj)(n),tabId:e})}),(0,A.r3y)(e,s,o,{reactions:{...i,results:r}})}),(0,w.aJ)("openStoryViewer",async(e,t,a)=>{const{peerId:s,storyId:o,isSinglePeer:n,isSingleStory:i,isPrivate:r,isArchive:d,origin:c,tabId:l=(0,u.g0)()}=a,h=(0,C.PVB)(e,s);if(!h)return;const m=(0,C.nTw)(e,l),p=(0,C._bp)(e,s);if(o&&(!p||!p.byId[o])){const t=await(0,b.px)("fetchPeerStoriesByIds",{peer:h,ids:[o]});if(!t)return;e=(0,w.mS)(),e=(0,A.K4v)(e,s,t.stories)}const g=m.storyViewer.storyList||(0,C.R3Q)(e,s,o,i,n,r,d);e=(0,M.w)(e,{storyViewer:{...m.storyViewer,peerId:s,storyId:o||(0,C._$$)(e,s)||(0,C.dNJ)(e,s),isSinglePeer:n,isPrivate:r,isArchive:d,isSingleStory:i,viewModal:void 0,origin:c,storyList:g}},l),(0,w.UF)(e)}),(0,w.aJ)("openStoryViewerByUsername",async(e,t,a)=>{const{username:s,storyId:n,origin:i,tabId:r=(0,u.g0)()}=a,d=await(0,o.A$)(e,s);d&&t.openStoryViewer({peerId:d.id,storyId:n,isSinglePeer:!0,isSingleStory:!0,origin:i,tabId:r})}),(0,w.aJ)("closeStoryViewer",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,storyId:r}=(0,C.nTw)(e,s).storyViewer;return r?e=(0,M.w)(e,{storyViewer:{isMuted:o,isRibbonShown:n,isArchivedRibbonShown:i,lastViewedByPeerId:void 0,storyList:void 0}},s):e}),(0,w.aJ)("setStoryViewerMuted",(e,t,a)=>{const{isMuted:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,o).storyViewer,isMuted:s}},o)}),(0,w.aJ)("toggleStoryRibbon",(e,t,a)=>{const{isShown:s,isArchived:o,tabId:n=(0,u.g0)()}=a,i=e.stories.orderedPeerIds[o?"archived":"active"];return i?.length?(0,M.w)(e,{storyViewer:{...(0,C.nTw)(e,n).storyViewer,[o?"isArchivedRibbonShown":"isRibbonShown"]:s}},n):e}),(0,w.aJ)("openPreviousStory",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:s});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:m}=c,p=(m[n]??[]).indexOf(i);let g,f;if(p>0)g=p-1,f=n;else{const e=h.indexOf(n)-1;if(r||e<0)return;f=h[e],g=(m?.[f]?.length||1)-1}const I=m?.[f]?.[g];return I?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:f,storyId:I}},s):void 0}),(0,w.aJ)("openNextStory",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s),{peerId:n,storyId:i,isSinglePeer:r,isSingleStory:d,storyList:c}=o.storyViewer;if(d||!c)return void t.closeStoryViewer({tabId:s});if(!n||!i)return;const l=(0,C.PVB)(e,n);if(!(0,C._bp)(e,n)||!l)return;const{peerIds:h,storyIdsByPeerId:m}=c,p=m[n]??[],g=p.indexOf(i);let f,I;if(g<p.length-1)f=g+1,I=n;else{const e=h.indexOf(n)+1;if(r||e>h.length-1)return void t.closeStoryViewer({tabId:s});I=h[e],f=0}const v=m?.[I]?.[f];return v?(0,M.w)(e,{storyViewer:{...o.storyViewer,peerId:I,storyId:v}},s):void 0}),(0,w.aJ)("openStoryViewModal",(e,t,a)=>{const{storyId:s,tabId:o=(0,u.g0)()}=a,n=(0,C.nTw)(e,o);return(0,M.w)(e,{storyViewer:{...n.storyViewer,viewModal:{storyId:s,nextOffset:"",isLoading:!0}}},o)}),(0,w.aJ)("closeStoryViewModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{storyViewer:(0,h.cJ)(o.storyViewer,["viewModal"])},s)}),(0,w.aJ)("copyStoryLink",async(e,t,a)=>{const{peerId:s,storyId:o,tabId:n=(0,u.g0)()}=a,i=(0,C.PVB)(e,s);if(!i)return;const r=await(0,b.px)("fetchStoryLink",{peer:i,storyId:o});r&&((0,c.eM)(r),t.showNotification({message:f.yE("LinkCopied"),tabId:n}))}),(0,w.aJ)("sendMessage",async(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a,{storyId:o,peerId:n}=(0,C.V9I)(e,s);if(!Boolean(o&&n))return;if(void 0===await ne(e,n))return;const{gif:i,sticker:r,isReaction:d}=a;let c;c=i?"Story.Tooltip.GifSent":r?"Story.Tooltip.StickerSent":d?"Story.Tooltip.ReactionSent":"Story.Tooltip.MessageSent",t.showNotification({message:f.yE(c),actionText:f.yE("Story.ToastViewInChat"),action:[{action:"closeStoryViewer",payload:void 0},{action:"openChat",payload:{id:n}}],tabId:s})}),(0,w.aJ)("openStoryPrivacyEditor",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!0}},s)}),(0,w.aJ)("closeStoryPrivacyEditor",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);return(0,M.w)(e,{storyViewer:{...o.storyViewer,isPrivacyModalOpen:!1}},s)}),(0,w.aJ)("openStealthModal",(e,t,a)=>{const{targetPeerId:s,tabId:o=(0,u.g0)()}=a;return(0,M.w)(e,{storyStealthModal:{targetPeerId:s}},o)}),(0,ut.k)("closeStealthModal","storyStealthModal"),(0,w.aJ)("clearStoryViews",(e,t,a)=>{const{isLoading:s,tabId:o=(0,u.g0)()}=a||{},n=(0,C.nTw)(e,o);return n.storyViewer.viewModal?(0,M.w)(e,{storyViewer:{...n.storyViewer,viewModal:{...n.storyViewer.viewModal,views:void 0,isLoading:s,nextOffset:""}}},o):e}),(0,w.aJ)("updateStoryView",(e,t,a)=>{const{userId:s,isUserBlocked:o,areStoriesBlocked:n,tabId:i=(0,u.g0)()}=a,r=(0,C.nTw)(e,i),{viewModal:d}=r.storyViewer;if(!d?.storyId)return;const c=d?.views?.map(e=>e.peerId===s?{...e,isUserBlocked:o||void 0,areStoriesBlocked:n||void 0}:e);return(0,M.w)(e,{storyViewer:{...r.storyViewer,viewModal:{...d,views:c}}},i)}),(0,w.aJ)("closeBoostModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{boostModal:void 0},s)}),(0,w.aJ)("closeBoostStatistics",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{boostStatistics:void 0},s)}),(0,w.aJ)("openMonetizationVerificationModal",(e,t,a)=>{const{tabId:s=(0,u.g0)(),chatId:o}=a||{};return(0,M.w)(e,{monetizationVerificationModal:{chatId:o}},s)}),(0,w.aJ)("closeMonetizationVerificationModal",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{monetizationVerificationModal:void 0},s)}),(0,w.aJ)("clearMonetizationVerificationError",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,A.Zct)(e,{errorKey:void 0},s)}),(0,w.aJ)("closeMonetizationStatistics",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return(0,M.w)(e,{monetizationStatistics:void 0},s)});var Rt=a(42368),Jt=a(57941),Yt=a(16841);(0,w.aJ)("updateAlphaHumanSocketState",(e,t,a)=>{const{state:s}=a;return(0,A.sN$)(e,s)}),(0,w.aJ)("onAlphaHumanBackendError",(e,t,a)=>{const{error:s}=a;return(0,Jt.R)("BACKEND ERROR","Backend error:",s),401===s.status||403===s.status?(0,A.sN$)(e,"jwt_invalid"):e}),(0,w.aJ)("onAlphaHumanAgentStreamingUpdate",(e,t,a)=>{const{update:s}=a;(0,Jt.R)("UPDATE","Processing agent update:",{eventType:s.eventType,message:s.message});let o=(0,A.a1u)(e,{...s,eventType:s.eventType});const n=o.alphahuman?.activeThreadId;if(s.message.thread&&n!==s.message.thread&&((0,Jt.R)("REQUEST","Backend returned threadId, selecting thread:",{threadId:s.message.thread}),o=(0,A.u6y)(o,s.message.thread),o=(0,A.teO)(o,s.message.thread),t.openAlphaHumanThread({threadId:s.message.thread.toString(),tabId:(0,u.g0)()}),o=(0,w.mS)()),!s.message.thread)return o;switch(s.eventType){case"complete":s.message.type="text",o=(0,A.VP0)(o,s.message.thread,s.message),o=(0,A.zQ9)(o);break;case"toolStart":case"toolEnd":case"reasoning":o=(0,A.VP0)(o,s.message.thread,s.message);break;case"error":(0,Jt.R)("UPDATE","Agent stream error:",s.message.content),s.message.type="text",o=(0,A.VP0)(o,s.message.thread,s.message),o=(0,A.zQ9)(o),o=(0,A.vib)(o)}return o}),(0,w.aJ)("connectAlphaHumanSocket",(e,t,a)=>{const{jwtToken:s}=a,o=(0,Rt.A)();try{o.updateJwtAndLogin(s)}catch(e){(0,Jt.R)("CONNECTION ERROR","Failed to connect socket:",e),t.updateAlphaHumanSocketState({state:"jwt_invalid"})}}),(0,w.aJ)("disconnectAlphaHumanSocket",(e,t)=>((0,Rt.A)().clear(),(0,A.qqH)(e))),(0,w.aJ)("streamAlphaHumanMessage",async(e,t,a)=>{const{threadId:s,content:o,chatId:n}=a,i=(0,Rt.A)();let r=s||e.alphahuman?.activeThreadId;if((0,Jt.R)("UPDATE","Stream AlphaHuman message:",{threadId:r,content:o}),!r)try{(0,Jt.R)("REQUEST","Creating Alphahuman thread via API");const a=await(0,Yt.J9)(n);(0,Jt.R)("RESPONSE","Alphahuman Thread created:",a),r=a.id,e=(0,w.mS)(),e=(0,A.teO)(e,r),e=(0,A.u6y)(e,r),(0,w.UF)(e),e=(0,w.mS)(),t.openAlphaHumanThread({threadId:r.toString(),tabId:(0,u.g0)()}),e=(0,w.mS)()}catch(e){(0,Jt.R)("STREAM ERROR","Failed to create thread via API, falling back to local thread:",e)}if(r){e=(0,A.Aqj)(e,!0),e=(0,A.KTn)(e,r,o),e=(0,A.zQ9)(e),(0,w.UF)(e);try{(0,Jt.R)("REQUEST","Streaming message:",{threadId:r,content:o});const e=await i.streamMessageForUser({threadId:r,content:o});(0,Jt.R)("RESPONSE","Stream completed, messageId:",e)}catch(t){(0,Jt.R)("STREAM ERROR","Failed to stream message:",t),e=(0,w.mS)(),e=(0,A.zQ9)(e),(0,w.UF)(e)}}else(0,Jt.R)("STREAM ERROR","No threadId available after creation attempt")}),(0,w.aJ)("apiUpdate",async(e,t,a)=>{if("newMessage"!==a["@type"])return;const o=e.alphahuman?.loginToken;if(!o)return;const{chatId:n,message:i}=a,r=(0,C.hds)(e,n),d=r?.usernames?.some(e=>e.username.toLowerCase()===s.XOS.toLowerCase());if(!d||i.isOutgoing)return;const c=(0,S.P5)(i),l=c?.text;if(l&&l.includes("successfully logged into"))try{const t=await(0,Yt.jj)(o);if(!t.jwtToken)return;(0,Rt.A)().updateJwtAndLogin(t.jwtToken),e=(0,w.mS)(),e=(0,A.hcr)(e,{isLoggingIn:!1,loginToken:void 0}),(0,w.UF)(e)}catch(t){(0,Jt.R)("AUTH ERROR","Failed to consume login token:",t),e=(0,w.mS)(),e=(0,A.hcr)(e,{isLoggingIn:!1,loginToken:void 0}),(0,w.UF)(e)}}),(0,w.aJ)("toggleThreadsSidebar",e=>(0,A.WLS)(e)),(0,w.aJ)("selectAlphahumanThreadById",(e,t,a)=>{const{threadId:s}=a;return(0,A.u6y)(e,s)}),(0,w.aJ)("addMessageToAlphahumanThread",(e,t,a)=>{const{threadId:s}=a;return(0,A.VP0)(e,s,a)}),(0,w.aJ)("startAlphaHumanLogin",async(e,t)=>{e=(0,A.hcr)(e,{isLoggingIn:!0}),(0,w.UF)(e),e=(0,w.mS)();const{token:a}=await(0,Yt.bJ)();e=(0,w.mS)(),e=(0,A.hcr)(e,{loginToken:a}),(0,w.UF)(e);const o=s.XOS.startsWith("@")?s.XOS.slice(1):s.XOS;let i=(0,C.hds)(e,s.syL);if(!i){const t=await(0,b.px)("getChatByUsername",o);if(!t?.chat)return(0,Jt.R)("AUTH ERROR","Failed to resolve bot username"),e=(0,w.mS)(),e=(0,A.hcr)(e,{isLoggingIn:!1,loginToken:void 0}),void(0,w.UF)(e);e=(0,w.mS)(),e=(0,A.wix)(e,t.chat.id,t.chat),t.user&&(e=(0,A.TKu)(e,t.user.id,t.user)),(0,w.UF)(e),i=t.chat}t.sendMessage({messageList:{chatId:i.id,threadId:n.l3,type:"thread"},tabId:(0,u.g0)(),text:`/start ${a}`})}),(0,w.aJ)("stopAlphaHumanLogin",e=>(0,A.hcr)(e,{isLoggingIn:!1,loginToken:void 0})),(0,w.aJ)("initAlphaHumanSocket",(e,t)=>{const a=(0,Rt.A)();if(a.isAuthenticated())try{a.login()}catch(e){(0,Jt.R)("CONNECTION ERROR","Failed to initialize socket:",e),t.updateAlphaHumanSocketState({state:"jwt_invalid"})}}),(0,w.aJ)("setAgentColumnState",(e,t,a)=>a?(localStorage.setItem("alphaHuman.agentColumnState",a.state),(0,A.XkY)(e,a.state)):e),(0,w.aJ)("setAgentColumnWidth",(e,t,a)=>{if(!a)return e;const s=Math.max(300,Math.min(580,a.width));return localStorage.setItem("alphaHuman.agentColumnWidth",String(s)),(0,A.Y4P)(e,s)}),(0,w.aJ)("toggleAgentColumn",e=>{const t=(0,A.ea4)(e),a=t.layout.agentColumnState;return localStorage.setItem("alphaHuman.agentColumnState",a),t}),(0,w.aJ)("setContentMode",(e,t,a)=>a?(localStorage.setItem("alphaHuman.contentMode",a.mode),(0,A.vW3)(e,a.mode)):e),(0,w.aJ)("setLayoutPinned",(e,t,a)=>a?(localStorage.setItem("alphaHuman.layoutPinned",String(a.isPinned)),(0,A.X0u)(e,a.isPinned)):e),(0,w.aJ)("loadLayoutPreferences",e=>(0,A.Dq9)(e)),(0,w.aJ)("openAlphaHumanSettings",e=>e),(0,w.aJ)("openUsageStatistics",e=>e),(0,w.aJ)("openOwnProfile",e=>e),(0,w.aJ)("openAgentSidebar",(e,t,a)=>{const s=(0,A.XkY)(e,"expanded");return localStorage.setItem("alphaHuman.agentColumnState","expanded"),s}),(0,w.aJ)("openSummarizePage",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(0,C.nTw)(e,s);t.closeAlphaHumanThread({tabId:s}),e=(0,M.w)(e,{middleColumnView:"summarize"},s),e=(0,D.MN)(e,void 0,void 0,void 0,void 0,void 0,s),o.summarize||(e={...e,byTabId:{...e.byTabId,[s]:{...o,...(0,A.Xr0)(s)}}}),e=(0,A.EEJ)(e,{isOpen:!0},s);const n=(0,C.nTw)(e,s);return n.summarize?.isSetupComplete?n.summarize.selectedChatIds.length>0&&t.generateSummaries({tabId:s}):t.fetchBusiestChats({tabId:s}),e}),(0,w.aJ)("closeSummarizePage",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return e=(0,A.EEJ)(e,{isOpen:!1},s),"summarize"===(0,C.nTw)(e,s).middleColumnView&&(e=(0,M.w)(e,{middleColumnView:void 0},s)),e}),(0,w.aJ)("updateSummarizeSearchQuery",(e,t,a)=>{const{query:s,tabId:o=(0,u.g0)()}=a;return(0,A.l7S)(e,s,o)}),(0,w.aJ)("markSummaryAsRead",(e,t,a)=>{const{chatId:s,date:o,tabId:n=(0,u.g0)()}=a;return(0,A.KiA)(e,s,o,n)}),(0,w.aJ)("setIncludeArchived",(e,t,a)=>{const{includeArchived:s,tabId:o=(0,u.g0)()}=a;return e=(0,A.ZJf)(e,s,o),(0,w.UF)(e),t.fetchBusiestChats({tabId:o,includeArchived:s}),e}),(0,w.aJ)("resetSummarizeSetup",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{};return e=(0,A.cYW)(e,s),t.fetchBusiestChats({tabId:s}),e}),(0,w.aJ)("setSummarizeSelectedDate",(e,t,a)=>{const{date:s,tabId:o=(0,u.g0)()}=a;return(0,A.LxE)(e,s,o)});var Et=a(84748);(0,w.aJ)("openAlphaHumanThread",(e,t,a)=>{const{threadId:s,tabId:o=(0,u.g0)()}=a;t.closeSummarizePage({tabId:o});const n=(0,C.nTw)(e,o),r=n.agentChat.isOpen,d=n.leftColumn.contentKey===i.Bn.Threads;return d?(r&&t.toggleAgentChat({force:!1,tabId:o}),e=(0,M.w)(e,{middleColumnView:"alphaHumanThread"},o),e=(0,D.MN)(e,void 0,void 0,void 0,void 0,void 0,o)):(r||t.toggleAgentChat({force:!0,tabId:o}),r||d||t.openLeftColumnContent({contentKey:i.Bn.Threads,tabId:o}),r||(e=(0,M.w)(e,{middleColumnView:"alphaHumanThread"},o),e=(0,D.MN)(e,void 0,void 0,void 0,void 0,void 0,o))),(0,Et.te)(e,s.toString())}),(0,w.aJ)("closeAlphaHumanThread",(e,t,a)=>{const{tabId:s=(0,u.g0)()}=a||{},o=(e=(0,Et.te)(e,void 0)).byTabId[s];return"alphaHumanThread"===o?.middleColumnView&&(e=(0,M.w)(e,{middleColumnView:void 0},s)),e}),a(48335),a(48073),a(4990);const Dt=new Set(["boostLevel","isForum","isLinkedInDiscussion","fakeType","restrictionReasons","isJoinToSend","isJoinRequest","type"]);(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updateChat":{const s=(0,C.hds)(e,a.id),{isForum:o,lastReadOutboxMessageId:n}=s||{};a.chat.lastReadOutboxMessageId&&n&&a.chat.lastReadOutboxMessageId<n&&(a={...a,chat:(0,h.cJ)(a.chat,["lastReadInboxMessageId"])}),e=(0,A.wix)(e,a.id,a.chat),s?.areStoriesHidden!==a.chat.areStoriesHidden&&(e=(0,A.VWO)(e,a.id,a.chat.areStoriesHidden||!1)),(0,w.UF)(e);const i=(0,C.hds)(e,a.id);if(a.noTopChatsRequest||(0,C.mJZ)(e,a.id)||i?.isNotJoined||t.loadTopChats(),a.chat.id&&(0,T.Kz)({chatId:a.chat.id,lastReadInboxMessageId:a.chat.lastReadInboxMessageId}),Object.values(e.byTabId).forEach(({id:s})=>{const{chatId:n}=(0,C.Xf0)(e,s)||{},i=a;n===i.id&&"isForum"in i.chat&&o!==i.chat.isForum&&(o&&t.closeForumPanel({tabId:s}),t.openChat({id:n,tabId:s}))}),s){const e=a.chat;Object.keys(e).filter(t=>s[t]!==e[t]).some(e=>Dt.has(e))&&t.invalidateFullInfo({peerId:a.id})}return}case"updateChatJoin":{const s=(0,C.P4G)(e,a.id),o=(0,C.hds)(e,a.id);if(e=(0,A.wix)(e,a.id,{isNotJoined:!1}),(0,w.UF)(e),o&&t.requestChatUpdate({chatId:o.id}),t.loadFullChat({chatId:a.id,force:!0}),!s)return;return e=(0,w.mS)(),e=(0,A.ec2)(e,s,[a.id]),void(0,w.UF)(e)}case"updateChatLeave":{e=(0,A.CX_)(e,a.id);const t=(0,C.hds)(e,a.id);if(t&&(0,S.WX)(t)){const s=(0,C.zeq)(e,a.id);if(s){const a=Object.keys(s).map(Number).filter(m.iL);e=(0,A.AH0)(e,t.id,a)}}return e}case"updateChatInbox":{const{id:t,threadId:s,lastReadInboxMessageId:o,unreadCount:n}=a,i=(0,C.hds)(e,t);return i?.isBotForum&&s?(e=(0,A.TwA)(e,t,Number(s),{unreadCount:n}),(0,A.eAk)(e,t,s,{lastReadInboxMessageId:o})):(0,A.wix)(e,t,{lastReadInboxMessageId:o,unreadCount:n})}case"updateChatTypingStatus":{const{id:t,threadId:s=n.l3,typingStatus:o}=a;return e=(0,A.eww)(e,t,s,"typingStatus",o),(0,w.UF)(e),void setTimeout(()=>{e=(0,w.mS)();const a=(0,C.C5H)(e,t,s,"typingStatus");o&&a&&o.timestamp===a.timestamp&&(e=(0,A.eww)(e,t,s,"typingStatus",void 0),(0,w.UF)(e))},6e3)}case"newMessage":{const{message:t}=a;if((t.senderId?t.senderId===e.currentUserId:t.isOutgoing)&&!t.isFromScheduled)return;const o=(0,m.iL)(t.id),n=(0,C.hds)(e,a.chatId);if(!n)return;const i=Boolean(a.message.id&&a.message.hasUnreadMention);if(!o||n.id===s.zv8){e=(0,A.wix)(e,a.chatId,{unreadCount:n.unreadCount?n.unreadCount+1:1}),i&&(e=(0,A.Wez)(e,a.chatId,n,[a.message.id],!0));const s=n.isForum?(0,C.nkm)(e,t):void 0;s&&(e=(0,A.TwA)(e,a.chatId,s.id,{unreadCount:s.unreadCount?s.unreadCount+1:1}))}return(0,w.UF)(e),void(0,T.Oq)({chat:n,message:t})}case"updateCommonBoxMessages":case"updateChannelMessages":{const{ids:t,messageUpdate:s}=a;return t.forEach(t=>{const o="channelId"in a?a.channelId:(0,C.Egn)(e,t),n=(0,C.hds)(e,o);s.reactions&&n?.unreadReactionsCount&&!(0,S.pU)(e,s.reactions)&&(e=V(e,o,{unreadReactionsCount:Math.max(n.unreadReactionsCount-1,0)||void 0,unreadReactions:n.unreadReactions?.filter(e=>e!==t)})),!s.hasUnreadMention&&n?.unreadMentionsCount&&(e=(0,A.pWt)(e,o,n,[t],!0))}),e}case"updateChatFullInfo":return(0,A.ltr)(e,a.id,a.fullInfo);case"updatePinnedChatIds":{const{ids:o,folderId:n}=a,i=n===s._E9?"archived":"active";return o?{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[i]:o.length?o:void 0}}}:(t.loadPinnedDialogs({listType:i}),e)}case"updatePinnedSavedDialogIds":{const{ids:t}=a;return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:t.length?t:void 0}}}}case"updateChatPinned":{const{id:t,isPinned:o}=a,n=(0,C.P4G)(e,t);if(!n)return;const{[n]:i}=e.chats.orderedPinnedIds;let r=i||[];if(o){if(!r.includes(t)){if("active"===n&&r.length>=s.FZw){const t=e.chats.listIds.active;r=r.filter(e=>t&&t.includes(e))}r=[t,...r]}}else r=r.filter(e=>e!==t);return{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,[n]:r.length?r:void 0}}}}case"updateSavedDialogPinned":{const{id:t,isPinned:s}=a,{saved:o}=e.chats.orderedPinnedIds;let n=o||[];return s?n.includes(t)||(n=[t,...n]):n=n.filter(e=>e!==t),{...e,chats:{...e.chats,orderedPinnedIds:{...e.chats.orderedPinnedIds,saved:n.length?n:void 0}}}}case"updateChatListType":{const{id:t,folderId:s}=a;return(0,A.KrP)(e,t,s)}case"updateChatFolder":{const{id:t,folder:s}=a,{byId:o,orderedIds:n}=e.chatFolders,i=void 0===s;Object.values(e.byTabId).forEach(({id:a})=>{const s=(0,C.nTw)(e,a);Object.values(o)[s.activeChatFolder-1]?.id===t&&(e=(0,M.w)(e,{activeChatFolder:0},a))});const r=i?(0,h.cJ)(o,[t]):{...o,[t]:s},d=i?n?.filter(e=>e!==t):n?.includes(t)?n:[...n||[],t];return{...e,chatFolders:{...e.chatFolders,byId:r,orderedIds:d,invites:(0,h.cJ)(e.chatFolders.invites,[t])}}}case"updateChatFoldersOrder":{const{orderedIds:t}=a;return{...e,chatFolders:{...e.chatFolders,orderedIds:t}}}case"updateRecommendedChatFolders":{const{folders:t}=a;return{...e,chatFolders:{...e.chatFolders,recommended:t}}}case"updateChatMembers":{const t=(0,C.AWZ)(e,a.id),{replacedMembers:s,addedMember:o,deletedMemberId:n}=a;if(!t)return;let i=!1,r=t?.members?[...t.members]:[];if(s)r=s,i=!0;else if(o)r.length&&r.some(e=>e.userId===o.userId)||(r.push(o),i=!0);else if(r.length&&n){const e=r.findIndex(e=>e.userId===n);e>-1&&(r.slice(e,1),i=!0)}if(i){const t=r.filter(({isOwner:e,isAdmin:t})=>e||t);return e=(0,A.wix)(e,a.id,{membersCount:r.length}),e=(0,A.ltr)(e,a.id,{members:r,adminMembersById:(0,h.dU)(t,"userId")})}return}case"draftMessage":{const{chatId:t,threadId:s,draft:o}=a;if(!e.chats.byId[t])return;return e=(0,A.eww)(e,t,s||n.l3,"draft",o),e=(0,A.wix)(e,t,{draftDate:o?.date})}case"updatePendingJoinRequests":{const{chatId:s,requestsPending:o,recentRequesterIds:n}=a;if(!e.chats.byId[s])return;return e=(0,A.ltr)(e,s,{requestsPending:o,recentRequesterIds:n}),(0,w.UF)(e),void t.loadChatJoinRequests({chatId:s})}case"updatePinnedTopic":{const{chatId:t,topicId:s,isPinned:o}=a;if(!e.chats.byId[t])return;return e=(0,A.TwA)(e,t,s,{isPinned:o}),void(0,w.UF)(e)}case"updatePinnedTopicsOrder":{const{chatId:t,order:s}=a;if(!e.chats.byId[t])return;return e=(0,A.mPd)(e,t,s),void(0,w.UF)(e)}case"updateTopic":{const{chatId:s,topicId:o}=a,n=(0,C.hds)(e,s);if(!n?.isForum)return;return void t.loadTopicById({chatId:s,topicId:o})}case"updateTopics":{const{chatId:s}=a,o=(0,C.hds)(e,s);if(!o?.isForum)return;return void t.loadTopics({chatId:s,force:!0})}case"updateViewForumAsMessages":{const{chatId:t,isEnabled:s}=a,o=(0,C.hds)(e,t);if(!o?.isForum)return;e=(0,A.wix)(e,t,{isForumAsMessages:s}),(0,w.UF)(e);break}case"updateNewProfilePhoto":{const{peerId:s,photo:o}=a;e=(0,A.wix)(e,s,{avatarPhotoId:o.id}),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:s,shouldInvalidateCache:!0});break}case"updateDeleteProfilePhoto":{const{peerId:s,photoId:o}=a,n=(0,C.PVB)(e,s);if(!n)return;o&&n.avatarPhotoId!==o?e=(0,A.sol)(e,s,o):(e=(0,A.wix)(e,s,{avatarPhotoId:void 0}),e=(0,A.Khb)(e,s,void 0)),(0,w.UF)(e),t.loadMoreProfilePhotos({peerId:s,shouldInvalidateCache:!0});break}}});const Ot=(0,a(8718).By)(function(){let e=(0,w.mS)();e=(0,A.wWy)(e,{...e.users.statusesById,...Lt}),(0,w.UF)(e),Lt={}});let Lt={};(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"deleteContact":return(0,A.MOQ)(e,a.id);case"updateUser":{Object.values(e.byTabId).forEach(({id:s})=>{(0,C.nZ4)(e,a.id)&&a.user.isPremium!==(0,C.g29)(e)&&(a.user.isPremium&&e.byTabId[s].premiumModal&&t.openPremiumModal({isSuccess:!0,tabId:s}),e={...e,translations:{byChatId:{}}})});const s=(0,C.mBe)(e,a.id);return e=(0,A.TKu)(e,a.id,a.user),a.fullInfo&&(e=(0,A.weB)(e,a.id,a.fullInfo)),s?.areStoriesHidden!==a.user.areStoriesHidden&&(e=(0,A.VWO)(e,a.id,a.user.areStoriesHidden||!1)),e}case"updateRequestUserUpdate":t.loadFullUser({userId:a.id});break;case"updateUserEmojiStatus":return e=(0,A.TKu)(e,a.userId,{emojiStatus:a.emojiStatus}),e=(0,A.wix)(e,a.userId,{emojiStatus:a.emojiStatus});case"updateUserStatus":return Lt[a.userId]=a.status,void Ot();case"updateUserFullInfo":{const{id:t,fullInfo:s}=a;return(0,A.weB)(e,t,s)}case"updateBotMenuButton":{const{botId:t,button:s}=a,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,menuButton:s}})}case"updateBotCommands":{const{botId:t,commands:s}=a,o=(0,C.vGo)(e,t);if(!o?.botInfo)return;return(0,A.weB)(e,t,{botInfo:{...o.botInfo,commands:s}})}case"updatePeerSettings":{const{id:s,settings:o}=a,n=(0,C.vGo)(e,s);return n?.botInfo?e=(0,A.weB)(e,s,{settings:o}):void t.loadFullUser({userId:s})}}}),(0,w.aJ)("apiUpdate",(e,t,a)=>{if("updateStickerSet"===a["@type"])return(0,A.v9P)(e,a.id,a.stickerSet)}),(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updateEntities":{const{users:t,chats:s,threadInfos:o,polls:n,webPages:i}=a;t&&(e=(0,A.g18)(e,t)),s&&(e=(0,A.Nl5)(e,s)),o&&(e=(0,A.Ng8)(e,o)),n&&n.forEach(t=>{e=(0,A.J81)(e,t.id,t)}),i&&i.forEach(t=>{e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t)}),(0,w.UF)(e);break}case"updatePeerBlocked":return a.isBlocked?(0,A.P6h)(e,a.id):a.isBlockedFromStories?e:(0,A.OW3)(e,a.id);case"updateResetContactList":e={...e,contactList:{userIds:[]}},(0,w.UF)(e);break;case"updateConfig":t.loadConfig();break;case"updateNewAuthorization":t.loadAuthorizations();break;case"updateFavoriteStickers":t.loadFavoriteStickers();break;case"updateRecentStickers":t.loadRecentStickers();break;case"updateRecentReactions":t.loadRecentReactions();break;case"updateRecentEmojiStatuses":t.loadRecentEmojiStatuses();break;case"updateSavedReactionTags":t.loadSavedReactionTags();break;case"updateMoveStickerSetToTop":{const s=a.isCustomEmoji?e.customEmojis.added.setIds:e.stickers.added.setIds;if(!s?.some(e=>e===a.id))return e;const o=[a.id,...s.filter(e=>e!==a.id)];t.reorderStickerSets({order:o,isCustomEmoji:a.isCustomEmoji});break}case"updateStickerSets":t.loadStickerSets();break;case"updateStickerSetsOrder":{const s=a.order.filter(t=>Boolean(e.stickers.setsById[t]));t.reorderStickerSets({order:s,isCustomEmoji:a.isCustomEmoji});break}case"updateSavedGifs":t.loadSavedGifs();break;case"updatePrivacy":e={...e,settings:{...e.settings,privacy:{...e.settings.privacy,[a.key]:a.rules}}},(0,w.UF)(e);break;case"updatePaymentVerificationNeeded":Object.values(e.byTabId).forEach(({id:t})=>{e=(0,A._te)(e,a.url,t),e=(0,A.lwH)(e,i.tn.ConfirmPayment,t)}),(0,w.UF)(e);break;case"updateWebViewResultSent":Object.values(e.byTabId).forEach(e=>{Object.entries(e.webApps.openedWebApps).forEach(([s,o])=>{o.queryId===a.queryId&&(t.resetDraftReplyInfo({tabId:e.id}),t.closeWebApp({key:s,tabId:e.id}))})});break;case"updateWebPage":{const{webPage:t}=a;e="full"===t.webpageType?(0,A.Cfr)(e,t.id,t):(0,A.o7c)(e,t.id,t),(0,w.UF)(e);break}case"updateStory":e=(0,A.K4v)(e,a.peerId,{[a.story.id]:a.story}),e=(0,A.Gzl)(e,{[a.peerId]:(0,C._bp)(e,a.peerId)}),(0,w.UF)(e);break;case"deleteStory":e=(0,A.ONz)(e,a.peerId,a.storyId),(0,w.UF)(e);break;case"updateReadStories":e=(0,A.Ahb)(e,a.peerId,a.lastReadId),(0,w.UF)(e);break;case"updateSentStoryReaction":{const{peerId:t,storyId:s,reaction:o}=a;if(!(0,C.Msb)(e,t,s))return e;e=(0,A.Xzz)(e,t,s,{sentReaction:o}),(0,w.UF)(e);break}case"updateStealthMode":e=(0,A.qsx)(e,a.stealthMode),(0,w.UF)(e);break;case"updateAttachMenuBots":t.loadAttachBots();break;case"updatePremiumFloodWait":t.processPremiumFloodWait({isUpload:a.isUpload});break;case"updatePaidReactionPrivacy":e={...e,settings:{...e.settings,paidReactionPrivacy:a.private}},(0,w.UF)(e);break;case"updateLangPackTooLong":(0,p.eg)(a.langCode);break;case"updateLangPack":(0,p.DV)(a.version,a.strings,a.keysToRemove);break;case"newMessage":{const o=a.message.content?.action;if("starGift"===o?.type&&a.message.isOutgoing){const{gift:n}=o;if(!n.isAuction||a.message.chatId===s.zv8)return;const{chatId:i,id:r}=a.message;if(!i||!r)return;return void Object.values(e.byTabId).forEach(({id:e})=>{t.focusMessage({chatId:i,messageId:r,tabId:e}),t.closeGiftAuctionBidModal({tabId:e}),t.closeGiftModal({tabId:e}),t.showNotification({icon:"auction-filled",message:{key:"GiftAuctionWonNotification",variables:{gift:n.title}},tabId:e}),t.requestConfetti({withStars:!0,tabId:e})})}if(!a.message.isOutgoing&&a.message.chatId!==s.zv8)return;if("starGiftUnique"!==o?.type)return;const n=o.gift;Object.values(e.byTabId).forEach(({id:s})=>{const o=(0,C.nTw)(e,s);if(o.isWaitingForStarGiftUpgrade&&(t.openUniqueGiftBySlug({slug:n.slug,tabId:s}),t.showNotification({title:{key:"GiftUpgradedTitle"},message:{key:"GiftUpgradedDescription"},tabId:s}),t.requestConfetti({withStars:!0,tabId:s}),e=(0,M.w)(e,{isWaitingForStarGiftUpgrade:void 0},s)),o.isWaitingForStarGiftTransfer){const o=a.message.chatId,i=o?(0,C.PVB)(e,o):void 0;i&&(t.focusMessage({chatId:i.id,messageId:a.message.id,tabId:s}),t.showNotification({message:{key:"GiftTransferSuccessMessage",variables:{gift:{key:"GiftUnique",variables:{title:n.title,number:n.number}},peer:(0,y.F9)((0,p.Yw)(),i)}},tabId:s})),t.requestConfetti({withStars:!0,tabId:s}),e=(0,M.w)(e,{isWaitingForStarGiftTransfer:void 0},s),t.reloadPeerSavedGifts({peerId:e.currentUserId})}}),(0,w.UF)(e)}}}),(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updateDefaultNotifySettings":return(0,A.p92)(e,a.peerType,a.settings);case"updateChatNotifySettings":{const{chatId:t,settings:s}=a;e=(0,A.m1I)(e,t,s),(0,w.UF)(e);break}case"updateTopicNotifySettings":{const{chatId:t,topicId:s,settings:o}=a;e=(0,A.TwA)(e,t,s,{notifySettings:o}),(0,w.UF)(e);break}}}),(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updateTwoFaStateWaitCode":return{...e,twoFaSettings:{...e.twoFaSettings,isLoading:!1,waitingEmailCodeLength:a.length}};case"updateTwoFaError":return{...e,twoFaSettings:{...e.twoFaSettings,errorKey:a.messageKey}}}});var Gt=a(80840),Vt=a(71331);(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updateGroupCall":{if("discarded"===a.call.connectionState)return e.groupCalls.activeGroupCallId?void("leaveGroupCall"in t&&t.leaveGroupCall({shouldRemove:!0,tabId:(0,u.g0)()})):(0,Gt.um)(e,a.call.id);const s=(0,Vt.Ip)(e,a.call.id),o=s?.chatId;return o&&(e=(0,A.wix)(e,o,{isCallNotEmpty:s.participantsCount>0||Boolean(s.participants?.length)})),(0,Gt.h9)(e,a.call.id,(0,h.cJ)(a.call,["connectionState"]),void 0,a.call.participantsCount)}case"updateGroupCallChatId":return(0,C.hds)(e,a.chatId)&&(e=(0,A.ltr)(e,a.chatId,{groupCallId:a.call.id})),e;case"updateGroupCallParticipants":{const{groupCallId:t,participants:s,nextOffset:o}=a,{currentUserId:n}=e;e=(0,w.mS)(),s.forEach(a=>{a.id&&(e=(0,Gt.c5)(e,t,a.id,a,Boolean(o)||n===a.id))}),o&&(e=(0,Gt.h9)(e,t,{nextOffset:o}));const i=(0,Vt.Ip)(e,t),r=i?.chatId;return r&&(e=(0,A.wix)(e,r,{isCallNotEmpty:i.participantsCount>0||Boolean(i.participants?.length)})),e}case"updatePhoneCall":{if(!d.OL)return;const{phoneCall:s,currentUserId:o}=e,{call:n}=a;if(s)return"discarded"===n.state?(t.playGroupCallSound({sound:"end"}),"hangUp"in t&&t.hangUp({tabId:(0,u.g0)()}),{...e,...n.needRating&&{ratingPhoneCall:n}}):void 0;if(n?.adminId!==o&&"requested"===n.state)return(0,I.aj)(()=>{e=(0,w.mS)();const t=(0,Vt.uu)(e);t&&(0,T.DJ)({call:n,user:t})}),(0,Tt.JD)(),(0,Tt.re)(e,t,n.isVideo,(0,u.g0)()),e={...e,phoneCall:n},(0,M.w)(e,{isCallPanelVisible:!1},(0,u.g0)())}}});var jt=a(17142);(0,w.aJ)("apiUpdate",(e,t,a)=>{switch(a["@type"]){case"updatePaymentStateCompleted":{const{paymentState:s,tabId:o}=a,n=s.form,{invoice:i}=n,{totalAmount:r,currency:d}=i,c=s.inputInvoice;if("stars"===c?.type)t.closeStarsBalanceModal({tabId:o}),t.showNotification({message:f.yE("StarsAcquiredInfo",c.stars),title:f.yE("StarsAcquired"),icon:"star",tabId:o}),t.requestConfetti({withStars:!0,tabId:o});else if("giftcode"===c?.type){const a=(0,C.nTw)(e,o).giftModal;a&&c?.userIds[0]===a.forPeerId&&(t.showNotification({message:{key:"GiftSent"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}else t.showNotification({tabId:o,message:f.yE("PaymentInfoHint",[(0,jt.Ad)(r,d,f.Yw().code),n.title])});(0,w.UF)(e);break}case"updateStarPaymentStateCompleted":{const{paymentState:s,tabId:o}=a,{inputInvoice:n,subscriptionInfo:i,form:r}=s;if("chatInviteSubscription"===n?.type&&i){const e=i.subscriptionPricing.amount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,i.title],void 0,e),icon:"star"})}if(r?.invoice.subscriptionPeriod){const e=r.invoice.totalAmount;t.showNotification({tabId:o,title:f.yE("StarsSubscriptionCompleted"),message:f.yE("StarsSubscriptionCompletedText",[e,r.title],void 0,e),icon:"star"})}if("giftcode"===n?.type){if(!n.userIds)return;const a=(0,C.nTw)(e,o).giftModal;a&&n.userIds[0]===a.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("premiumGiftStars"===n?.type){const a=(0,C.nTw)(e,o).giftModal;a&&n.userId===a.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("starsgift"===n?.type){if(!n.userId)return;const t=(0,C.nTw)(e,o).starsGiftModal;t?.isOpen&&n.userId===t.forUserId&&(e=(0,M.w)(e,{starsGiftModal:{...t,isCompleted:!0}},o))}if("stargift"===n?.type){if(!n.peerId)return;const a=(0,C.nTw)(e,o).giftModal;a&&n.peerId===a.forPeerId&&(t.showNotification({message:{key:"StarsGiftCompleted"},tabId:o}),t.reloadPeerSavedGifts({peerId:a.forPeerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftModal({tabId:o}))}if("stargiftResale"===n?.type){const a=(0,C.nTw)(e,o).giftInfoModal;a&&(t.showNotification({message:{key:"StarsGiftBought"},tabId:o}),a.peerId&&t.reloadPeerSavedGifts({peerId:a.peerId}),t.reloadPeerSavedGifts({peerId:n.peerId}),t.requestConfetti({withStars:!0,tabId:o}),t.closeGiftInfoModal({tabId:o}))}if("stargiftUpgrade"===n?.type&&e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId}),"stargiftDropOriginalDetails"===n?.type&&(e=(0,w.mS)(),e=(0,A.OlY)(e,o),(0,w.UF)(e),t.closeGiftDescriptionRemoveModal({tabId:o}),t.showNotification({message:{key:"RemoveGiftDescriptionSuccessMessage"},tabId:o}),e.currentUserId&&t.reloadPeerSavedGifts({peerId:e.currentUserId})),"stargiftPrepaidUpgrade"===n?.type){t.reloadPeerSavedGifts({peerId:n.peerId});const a=f.Yw(),s=(0,C.PVB)(e,n.peerId),i=s?(0,y.F9)(a,s):void 0;t.showNotification({icon:"gift",title:{key:"GiftUpgradeSentTitle"},message:{key:"GiftUpgradeSentMessage",variables:{user:i}},tabId:o})}if("stargiftAuctionBid"===n?.type){const{activeGiftAuction:a}=(0,C.nTw)(e,o),s=a?.gift.giftsPerRound;t.showNotification({icon:"auction-filled",title:{key:n.isUpdateBid?"GiftAuctionBidIncreasedTitle":"GiftAuctionBidPlacedTitle"},message:{key:"GiftAuctionBidPlacedMessage",variables:{count:s}},tabId:o}),a?.gift.id===n.giftId&&t.loadActiveGiftAuction({giftId:n.giftId,tabId:o})}break}case"updateStarsBalance":e=(0,A.L_F)(e,a.balance),(0,w.UF)(e),t.loadStarStatus();break;case"updateStarGiftAuctionState":{const{giftId:t,state:s}=a;Object.keys(e.byTabId).forEach(a=>{const o=Number(a);e=(0,A.w8p)(e,t,s,o)}),(0,w.UF)(e);break}case"updateStarGiftAuctionUserState":{const{giftId:t,userState:s}=a;Object.keys(e.byTabId).forEach(a=>{const o=Number(a);e=(0,A.$AJ)(e,t,s,o)}),(0,w.UF)(e);break}}});var qt=a(84051),zt=a(61433),Ht=a(66644),Kt=a(87357),Wt=a(25903),_t=a(55148),Xt=a(80089),$t=a(32625),Qt=a(14737),Zt=a(30857),ea=a(39351),ta=a(17712);const aa=document.querySelector('meta[name="viewport"]'),sa=aa?.getAttribute("content")||"";function oa(e){e.preventDefault()}var na=a(34201),ia=a(35297),ra=a(61157),da=a(60138),ca=a(90423),la=a(64569),ua=a(26072);const ha=(0,qt.ph)((0,w.EK)(e=>({isAlphaHumanThreadOpen:(0,la.aG)(e),alphaHumanThreadId:(0,la.BM)(e)?.toString()}))(({isAlphaHumanThreadOpen:e,alphaHumanThreadId:t})=>{const{closeAlphaHumanThread:a}=(0,w.ko)(),s=t?`at-${t}`:void 0;(0,ua.A)({isActive:e,hash:s,onBack:a})}));var ma=a(80464),pa=a(20021);const ga=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Calls,"ActiveCallHeader",!t);return a?(0,pa.Y)(a,{}):void 0},fa=e=>{const{groupCallId:t}=e,a=(0,ma.A)(Xt.ar.Calls,"GroupCall",!t);return a?(0,pa.Y)(a,{...e}):void 0},Ia=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Calls,"PhoneCall",!t);return a?(0,pa.Y)(a,{}):void 0},va=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Calls,"RatePhoneCallModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},ba=e=>{const{customEmojiSetIds:t}=e,a=(0,ma.A)(Xt.ar.Extra,"CustomEmojiSetsModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},Sa=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"DeleteMessageModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},ya=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"StickerSetModal",!t);return a?(0,pa.Y)(a,{...e}):void 0};var wa=a(26120),Aa=a(14242),Ma=a(74984);const Ca=(0,qt.ph)(({isForAppBadge:e})=>{(0,Ma.ic)();const t=(0,Te.vp)(),a=(0,ea.A)();if((0,qt.vJ)(()=>{e&&(0,wa.q)(t)},[e,t]),!e&&t)return(0,pa.Y)("div",{className:"unread-count active",children:(0,Aa.Vw)(a,t)})});var Pa=a(11778),ka=a(31460),Ta=a(55994),Fa=a(31880),Ba=a(2178),Ua=a(29886),xa=a(41257),Na=a(41036),Ra=a(52745);const Ja=e=>{const t=(0,ma.A)(Xt.ar.Extra,"AlphahumanSidebar");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},Ya=e=>{const t=(0,ma.A)(Xt.ar.Extra,"ArchivedChats");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})};var Ea=a(11462),Da=a(59030),Oa=a(50680),La=a(64493),Ga=a(18276),Va=a(71429),ja=a(24433);const qa=({isShown:e,onNewPrivateChat:t,onNewChannel:a,onNewGroup:s,isAccountFrozen:o})=>{const[n,i]=(0,qt.J0)(!1),{openFrozenAccountModal:r}=(0,w.ko)();(0,qt.vJ)(()=>{e||i(!1)},[e]);const d=(0,Da.A)(),c=(0,Kt.A)("NewChatButton",e&&"revealed",n&&"menu-is-open"),l=(0,qt.hb)(()=>{o?r():i(!n)},[n,o]),u=(0,qt.hb)(()=>{i(!1)},[]),h=(0,qt.Kr)(()=>(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(ja.A,{icon:"channel",onClick:a,children:d("NewChannel")}),(0,pa.Y)(ja.A,{icon:"group",onClick:s,children:d("NewGroup")}),(0,pa.Y)(ja.A,{icon:"user",onClick:t,children:d("NewMessageTitle")})]}),[d,a,s,t]);return(0,pa.FD)("div",{className:c,dir:d.isRtl?"rtl":void 0,children:[(0,pa.FD)(La.A,{round:!0,color:"primary",className:n?"active":"",onClick:l,ariaLabel:d(n?"Close":"NewMessageTitle"),tabIndex:-1,children:[(0,pa.Y)(Ga.A,{name:"new-chat-filled"}),(0,pa.Y)(Ga.A,{name:"close"})]}),(0,pa.Y)(Va.A,{isOpen:n,positionX:d.isRtl?"left":"right",positionY:"bottom",autoClose:!0,onClose:u,children:h})]})},za=e=>{const t=(0,ma.A)(Xt.ar.Extra,"LeftSearch");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})};var Ha=a(50442),Ka=a(19129),Wa=a(79824),_a=a(18501);const Xa=({sidebarMode:e,orderedFolderIds:t,chatFoldersById:a,maxFolders:o,maxChatLists:r,folderInvitesById:d,maxFolderInvites:c})=>{const l=(0,ea.A)(),{isMobile:u}=(0,O.Ay)(),{openShareChatFolderModal:h,openDeleteChatFolderModal:m,openEditChatFolder:p,openLimitReachedModal:g,markChatMessagesRead:f,openSettingsScreen:I,setSharedSettingOption:v}=(0,w.ko)(),b=(0,qt.Kr)(()=>({id:s.DSF,title:{text:t?.[0]===s.DSF?l("FilterAllChatsShort"):l("FilterAllChats")},includedChatIds:Wa.p,excludedChatIds:Wa.p,emoticon:""}),[t,l]),S=(0,qt.Kr)(()=>t?t.map(e=>e===s.DSF?b:a[e]||{}).filter(Boolean):void 0,[a,b,t]),y=(0,Ma.Jm)(),A=(0,ta.A)(e=>{const t=y[e];t?.length&&t.forEach(e=>{f({id:e})})}),M=(0,Ma.ic)(),P=(0,qt.Kr)(()=>{if(S&&S.length)return S.map((t,f)=>{const{id:b,title:S}=t,P=b!==s.DSF&&f>o-1,k=[];(0,C.w5O)((0,w.mS)(),b)&&k.push({title:l("FilterShare"),icon:"link",handler:()=>{Object.values(a).reduce((e,t)=>e+(t.isChatList?1:0),0)>=r&&!t.isChatList?g({limit:"chatlistJoined"}):d[b]?.length>=c?g({limit:"chatlistInvites"}):h({folderId:b})}}),b===s.DSF?(k.push({title:l("FilterEditFolders"),icon:"edit",handler:()=>{I({screen:i.VS.Folders})}}),y[b]?.length&&k.push({title:l("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>A(t.id)})):(k.push({title:l("EditFolder"),icon:"edit",handler:()=>{p({folderId:b})}}),y[b]?.length&&k.push({title:l("ChatListMarkAllAsRead"),icon:"readchats",handler:()=>A(t.id)}),k.push({title:l("FilterMenuDelete"),icon:"delete",destructive:!0,handler:()=>{m({folderId:b})}})),u||(k.push({isSeparator:!0}),k.push({title:l(e?"TabsPositionTop":"TabsPositionLeft"),icon:"forums",handler:()=>{v({foldersPosition:e?"top":"left"})}}));const T={text:S.text,entities:S.entities,noCustomEmojiPlayback:t.noTitleAnimations};let F=t.emoticon;if(e){T.emojiSize=10;const e=S.entities?.find(e=>e.type===n.C7.CustomEmoji&&0===e.offset);if(e){F=e;const{offset:t,length:a}=e;T.text=S.text.replace(S.text.substring(t,t+a),""),T.entities=S.entities?.filter(e=>e.offset!==t).map(e=>({...e,offset:e.offset-a}))}}const B=(0,_a.fd)(T);return{id:b,title:B,badgeCount:M[b]?.chatsCount,isBadgeActive:Boolean(M[b]?.notificationsCount),isBlocked:P,contextActions:k?.length?k:void 0,emoticon:F,noTitleAnimations:t.noTitleAnimations}})},[S,o,M,l,a,r,d,c,y,I,e,u,v]);return{displayedFolders:S,folderTabs:P}};var $a=a(75343),Qa=a(24680),Za=a(13481);const es=(0,qt.ph)((0,w.EK)(e=>{const{chatFolders:{byId:t,orderedIds:a,invites:s},chats:{listIds:{archived:o}},stories:{orderedPeerIds:{archived:n}},currentUserId:i,archiveSettings:r}=e,{animationLevel:d}=(0,je.lS)(e),{shouldSkipHistoryAnimations:c,activeChatFolder:l}=(0,C.nTw)(e),{storyViewer:{isRibbonShown:u}}=(0,C.nTw)(e);return{chatFoldersById:t,folderInvitesById:s,orderedFolderIds:a,activeChatFolder:l,currentUserId:i,animationLevel:d,shouldSkipHistoryAnimations:c,hasArchivedChats:Boolean(o?.length),hasArchivedStories:Boolean(n?.length),maxFolders:(0,fe.d)(e,"dialogFilters"),maxFolderInvites:(0,fe.d)(e,"chatlistInvites"),maxChatLists:(0,fe.d)(e,"chatlistJoined"),archiveSettings:r,isStoryRibbonShown:u}})(({foldersDispatch:e,chatFoldersById:t,orderedFolderIds:a,activeChatFolder:o,currentUserId:n,isForumPanelOpen:i,animationLevel:r,shouldSkipHistoryAnimations:c,maxFolders:l,maxChatLists:u,shouldHideFolderTabs:h,folderInvitesById:m,maxFolderInvites:p,hasArchivedChats:g,hasArchivedStories:f,archiveSettings:I,isStoryRibbonShown:v,isFoldersSidebarShown:b})=>{const{loadChatFolders:S,setActiveChatFolder:y,openChat:A}=(0,w.ko)(),M=(0,qt.li)(),C=(0,ea.A)();(0,qt.vJ)(()=>{S()},[]);const{ref:P,shouldRender:k,getIsClosing:T}=(0,na.A)({isOpen:v,className:!1,withShouldRender:!0}),F=(0,Ka.A)(T),B=(0,ta.A)(()=>{const e=P.current?.querySelector("#LeftColumn .chat-list.Transition_slide-active");e?.scrollTo({top:0,behavior:"smooth"})}),{displayedFolders:U,folderTabs:x}=Xa({sidebarMode:!1,orderedFolderIds:a,chatFoldersById:t,maxFolders:l,maxChatLists:u,folderInvitesById:m,maxFolderInvites:p}),N=U?.findIndex(e=>e.id===s.DSF),R=N===o,J=0===o,Y=(0,ta.A)(e=>{y({activeChatFolder:e},{forceOnHeavyAnimation:!0}),o===e&&B()});(0,qt.vJ)(()=>{x?.length&&o>=x.length&&y({activeChatFolder:0})},[o,x,y]),(0,qt.vJ)(()=>{if(d.TF&&x?.length&&!i)return(0,Ha.wJ)(M.current,{selectorToPreventScroll:".chat-list",onSwipe:(e,t)=>t===Ha.ez.Left?(y({activeChatFolder:Math.min(o+1,x.length-1)},{forceOnHeavyAnimation:!0}),!0):t===Ha.ez.Right&&(y({activeChatFolder:Math.max(0,o-1)},{forceOnHeavyAnimation:!0}),!0)})},[o,x,i,y]);const E=(0,qt.li)();E.current=!J,(0,qt.vJ)(()=>E.current?(0,Pa.A)(()=>{E.current&&y({activeChatFolder:0})}):void 0,[o,y]),(0,ua.A)({isActive:!J,onBack:()=>y({activeChatFolder:0},{forceOnHeavyAnimation:!0})}),(0,qt.vJ)(()=>{const e=e=>{if(e.ctrlKey&&e.shiftKey&&e.code.startsWith("Digit")&&x){const[,t]=e.code.match(/Digit(\d)/)||[];if(!t)return;if("0"===t)return void A({id:n,shouldReplaceHistory:!0});const a=Number(t)-1;if(a>x.length-1)return;y({activeChatFolder:a},{forceOnHeavyAnimation:!0}),e.preventDefault()}};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[n,x,A,y]);const{ref:D,shouldRender:O}=(0,na.A)({isOpen:!a&&!b,noMountTransition:!0,withShouldRender:!0}),L=x&&x.length>1,G=L&&!b;return(0,pa.FD)("div",{ref:P,className:(0,Kt.A)("ChatFolders",G&&h&&"ChatFolders--tabs-hidden",k&&"with-story-ribbon",b&&"ChatFolders--tabs-sidebar-shown"),children:[k&&(0,pa.Y)($a.A,{isClosing:F}),G?(0,pa.Y)(Qa.A,{contextRootElementSelector:"#LeftColumn",tabs:x,activeTab:o,onSwitchTab:Y}):O?(0,pa.Y)("div",{ref:D,className:"tabs-placeholder"}):void 0,(0,pa.Y)(Na.Ay,{ref:M,name:(0,ka.P)("slideOptimized",r,c,C.isRtl),activeKey:o,renderCount:L?x.length:void 0,children:function(a){const s=Object.values(t).find(({id:e})=>e===x[o].id),n=s&&!R;return(0,pa.Y)(Za.A,{folderType:n?"folder":"all",folderId:n?s.id:void 0,isActive:a,isForumPanelOpen:i,foldersDispatch:e,isMainList:!0,canDisplayArchive:(g||f)&&!I.isHidden,archiveSettings:I,isFoldersSidebarShown:b,isStoryRibbonShown:v,withTags:!0})}})]})})),ts=e=>{const t=(0,ma.A)(Xt.ar.Extra,"ContactList");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})};var as=a(77018),ss=a(76786),os=a(37661),ns=a(24920),is=a(4029),rs=a(19800),ds=a(54639),cs=a(60859),ls=a(63152),us=a(629),hs=a(4350),ms=a(93855),ps=a(21849),gs=a(34431);const fs=(0,qt.ph)(({currentUser:e,totalLimit:t,onSelectCurrent:a})=>{const{showNotification:s}=(0,w.ko)(),o=(0,ea.A)(),n=(0,ms.A)(e),i=(0,S.Em)(),r=(0,S.SM)(),c=(0,qt.Kr)(()=>Object.values(n).find(t=>t.userId===e.id),[n,e.id]),l=i>=r,u=(0,ta.A)(t=>{t.userId!==e.id?d.Yw&&(0,Ut.uw)():a?.()}),h=(0,ta.A)(()=>{l?s({title:o("PremiumLimitAccountsTitle"),message:e.isPremium?o("PremiumLimitAccounts"):o("PremiumLimitAccountsNoPremium"),duration:7e3}):d.Yw&&(0,Ut.uw)()}),m=(0,qt.Kr)(()=>{if(!Object.values(n).length)return;if(i===t)return;let e=1;for(;n[e];)e+=1;return(0,hs.Nv)(e,!0)},[n,i,t]);return(0,pa.FD)(pa.FK,{children:[Object.entries(n||{}).sort(([,t])=>t.userId===e.id?-1:1).map(([t,a],s,o)=>{const n=a.isTest===c?.isTest,i={title:[a.firstName,a.lastName].filter(Boolean).join(" "),isCustomPeer:!0,peerColorId:a.color,emojiStatusId:n?a.emojiStatusId:void 0,isPremium:a.isPremium},r=a.userId===e.id&&(m||o.length>1);return(0,pa.FD)(pa.FK,{children:[(0,pa.FD)(ja.A,{className:"account-menu-item",customIcon:(0,pa.Y)(ps.A,{size:"mini",className:"account-avatar",peer:i,previewUrl:a.avatarUri}),onClick:()=>u(a),href:a.userId!==e.id?(0,hs.Nv)(Number(t)):void 0,children:[a.isTest&&(0,pa.Y)("span",{className:"account-menu-item-test",children:"T"}),(0,pa.Y)(gs.A,{peer:i,withEmojiStatus:!0,emojiStatusSize:U.$})]}),r&&(0,pa.Y)(cs.A,{})]})}),m&&(0,pa.Y)(ja.A,{icon:"add",rel:"noopener",href:l?void 0:m,onClick:h,children:o("MenuAddAccount")})]})}),Is=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{currentUserId:a,archiveSettings:s}=e,{animationLevel:o}=(0,je.lS)(e),n=e.attachMenu.bots;return{currentUserId:a,currentUser:(0,C.mBe)(e,a),theme:(0,C.SJA)(e),animationLevel:o,canInstall:Boolean(t.canInstall),archiveSettings:s,attachBots:n,accountsTotalLimit:(0,fe.B)(e,"moreAccounts")}})(({currentUserId:e,archiveSettings:t,animationLevel:a,theme:o,canInstall:n,attachBots:i,currentUser:r,accountsTotalLimit:d,onSelectArchived:c,onSelectContacts:l,onSelectSettings:u,onBotMenuOpened:h,onBotMenuClosed:m})=>{const{openChat:p,setSharedSettingOption:g,updatePerformanceSettings:f,openChatByUsername:I,openUrl:v,openChatWithInfo:b,openSummarizePage:S}=(0,w.ko)(),y=(0,ea.A)(),A=a!==s.dnp?a===s.zP3?"max":"mid":"min",M=(!vt.Vq&&(window.location.hostname===s.mFn||s.W75),(0,Ma.ic)()[s._E9]?.chatsCount||0),C=(0,qt.Kr)(()=>Object.values(i).filter(e=>e.isForSideMenu),[i]),P=(0,ta.A)(()=>{b({id:e,shouldReplaceHistory:!0,isOwnProfile:!0})}),k=(0,ta.A)(()=>{p({id:e,shouldReplaceHistory:!0})}),T=(0,ta.A)(e=>{e.stopPropagation(),g({theme:"light"===o?"dark":"light"}),g({shouldUseSystemTheme:!1})}),F=(0,ta.A)(e=>{e.stopPropagation();let t=a+1;t>s.zP3&&(t=s.dnp);const o=t===s.dnp?xt.PI:t===s.zP3?xt.LH:xt.tS;g({animationLevel:t,wasAnimationLevelSetManually:!0}),f(o)}),B=((0,ta.A)(()=>{window.open(s.qGQ,"_blank","noopener,noreferrer")}),(0,ta.A)(()=>{(0,rs.Bt)("K")}),(0,ta.A)(()=>{I({username:y("TelegramFeaturesUsername")})})),U=(0,ta.A)(()=>{v({url:s.ukY})}),x=((0,ta.A)(()=>{S()}),(0,ta.A)(()=>{const e=(0,w.mS)().alphahuman?.jwtToken;e&&v({url:"https://github.com/alphahumanxyz/frontend"})}));return(0,pa.FD)(pa.FK,{children:[vt.vM&&r&&(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(fs,{currentUser:r,totalLimit:d,onSelectCurrent:u}),(0,pa.Y)(cs.A,{})]}),(0,pa.Y)(ja.A,{icon:"user",onClick:P,children:y("MenuMyProfile")}),(0,pa.Y)(ja.A,{icon:"saved-messages",onClick:k,children:y("MenuSavedMessages")}),t.isHidden&&(0,pa.FD)(ja.A,{icon:"archive",onClick:c,children:[(0,pa.Y)("span",{className:"menu-item-name",children:y("MenuArchivedChats")}),M>0&&(0,pa.Y)("div",{className:"right-badge",children:M})]}),(0,pa.Y)(ja.A,{icon:"group",onClick:l,children:y("MenuContacts")}),C.map(e=>(0,pa.Y)(ds.A,{bot:e,theme:o,isInSideMenu:!0,canShowNew:!0,onMenuOpened:h,onMenuClosed:m})),(0,pa.Y)(ja.A,{icon:"settings",onClick:u,children:y("MenuSettings")}),(0,pa.FD)(ja.A,{icon:"darkmode",onClick:T,children:[(0,pa.Y)("span",{className:"menu-item-name",children:y("MenuNightMode")}),(0,pa.Y)(ls.A,{id:"darkmode",label:y("dark"===o?"AriaMenuDisableNightMode":"AriaMenuEnableNightMode"),checked:"dark"===o,noAnimation:!0})]}),(0,pa.FD)(ja.A,{icon:"animations",onClick:F,children:[(0,pa.Y)("span",{className:"menu-item-name capitalize",children:y("MenuAnimationsSwitch")}),(0,pa.Y)(us.A,{value:A})]}),(0,pa.Y)(ja.A,{icon:"help",onClick:B,children:y("MenuTelegramFeatures")}),(0,pa.Y)(ja.A,{icon:"document",onClick:x,children:"Star on Github"}),(0,pa.Y)(ja.A,{icon:"bug",onClick:U,children:y("MenuReportBug")}),n&&(0,pa.Y)(ja.A,{icon:"install",onClick:(0,is.S)(),children:y("MenuInstallApp")})]})}));var vs=a(22699);const bs=(0,qt.ph)(({trigger:e,shouldHideSearch:t,className:a})=>{const{openLeftColumnContent:o,closeForumPanel:n,openSettingsScreen:r}=(0,w.ko)(),[d,c,l]=(0,os.A)(),u=(0,ea.A)(),h=s.Cmz?"12.16.0 Beta (master#3898865)":s.Oig?"master#3898865":"12.16.0",{shouldDisableDropdownMenuTransitionRef:m,handleDropdownMenuTransitionEnd:p}=(0,ns.A)(t),g=(0,ta.A)(()=>{r({screen:i.VS.Main})}),f=(0,ta.A)(()=>{o({contentKey:i.Bn.Contacts})}),I=(0,ta.A)(()=>{o({contentKey:i.Bn.Archived}),n()});return(0,pa.Y)(vs.A,{trigger:e,footer:`${s.C39} ${h}`,className:(0,Kt.A)("main-menu",u.isRtl&&"rtl",t&&u.isRtl&&"right-aligned",m.current&&u.isRtl&&"disable-transition",a),forceOpen:d,positionX:t&&u.isRtl?"right":"left",transformOriginX:90,transformOriginY:100,onTransitionEnd:u.isRtl?p:void 0,children:(0,pa.Y)(Is,{onSelectArchived:I,onSelectContacts:f,onSelectSettings:g,onBotMenuOpened:c,onBotMenuClosed:l})})});var Ss=a(10187),ys=a(40175),ws=a(36393),As=a(26607),Ms=a(57474);const Cs=(0,qt.ph)(({connectionStatus:e,connectionStatusText:t,onClick:a})=>{const s=(0,Da.A)();return(0,pa.FD)("div",{id:"ConnectionStatusOverlay",dir:s.isRtl?"rtl":void 0,onClick:a,children:[(0,pa.Y)(Ms.A,{color:"black"}),(0,pa.Y)("div",{className:"state-text",children:(0,pa.Y)(Na.Ay,{activeKey:e,name:"slideFade",children:t})}),(0,pa.Y)(La.A,{round:!0,size:"tiny",color:"translucent-black",iconName:"close"})]})});var Ps=a(82117),ks=a(87412),Ts=a(95773),Fs=a(9267),Bs=a(83594);const Us=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"StatusPickerMenu",!t);return a?(0,pa.Y)(a,{...e}):void 0},xs=(0,qt.ph)((0,w.EK)(e=>{const{currentUserId:t}=e,a=t?(0,C.mBe)(e,t):void 0,s=e.collectibleEmojiStatuses?.statuses,o=(0,C.trm)(e);return{emojiStatus:a?.emojiStatus,collectibleStatuses:s,isAccountFrozen:o}})(({emojiStatus:e,collectibleStatuses:t,isAccountFrozen:a})=>{const{setEmojiStatus:o,loadCurrentUser:n,openFrozenAccountModal:i}=(0,w.ko)(),r=(0,qt.li)(),[d,c,l]=(0,os.A)(!1),[u,h,m]=(0,os.A)(!1),[p,g,f]=(0,os.A)(!1),{isMobile:I}=(0,O.Ay)(),b="collectible"===e?.type?e:void 0,S=e?.until?1e3*(e.until-(0,v.Fm)()):void 0;(0,Qt.A)(n,S),(0,Ps.A)(([t])=>{d&&e&&e.documentId!==t?.documentId&&(h(),l())},[e,d,h,l]);const y=(0,qt.hb)(e=>{const a=t?.find(t=>"collectibleId"in t&&t.documentId===e.id);c(),o({emojiStatus:a||{type:"regular",documentId:e.id}})},[c,o,t]);(0,Qt.A)(m,u?1500:void 0);const A=(0,qt.hb)(()=>{a?i():g()},[g,a]);return(0,pa.FD)("div",{className:"StatusButton extra-spacing",children:[Boolean(u&&e)&&(0,pa.Y)(Bs.A,{reaction:e,isLottie:!0,className:"emoji-status-effect"}),(0,pa.Y)(La.A,{round:!0,ref:r,ripple:!I,size:"smaller",color:"translucent",className:"emoji-status",onClick:A,children:e?(0,pa.Y)(Ts.A,{withSparkles:Boolean(b),sparklesClassName:"statusSparkles",sparklesColor:b?.textColor,children:(0,pa.Y)(ks.A,{documentId:e.documentId,size:24,loopLimit:s.J$1},e.documentId)}):(0,pa.Y)(Fs.A,{})}),(0,pa.Y)(Us,{statusButtonRef:r,isOpen:p,onEmojiStatusSelect:y,onClose:f})]})})),Ns={date:void 0},Rs={id:void 0},Js=vt.Vq&&d.MP,Ys=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{query:a,fetchingStatus:s,chatId:o,minDate:n}=t.globalSearch,{connectionState:i,isSyncing:r,isFetchingDifference:d}=e,{isConnectionStatusMinimized:c}=(0,je.lS)(e),l=(0,C.clw)(e);return{searchQuery:a,isLoading:!!s&&Boolean(s.chats||s.messages||s.publicPosts),globalSearchChatId:o,searchDate:n,theme:(0,C.SJA)(e),connectionState:i,isSyncing:r,isFetchingDifference:d,isMessageListOpen:Boolean((0,C.Xf0)(e)),isConnectionStatusMinimized:c,isCurrentUserPremium:(0,C.g29)(e),areChatsLoaded:Boolean(e.chats.listIds.active),hasPasscode:Boolean(e.passcode.hasPasscode),canSetPasscode:(0,C.Ntz)(e),isForumPanelOpen:l}})(({shouldHideSearch:e,content:t,contactsFilter:a,isClosingSearch:s,searchQuery:o,isLoading:n,isCurrentUserPremium:r,shouldSkipTransition:c,globalSearchChatId:l,searchDate:u,theme:h,connectionState:m,isSyncing:p,isFetchingDifference:g,isMessageListOpen:f,isConnectionStatusMinimized:I,areChatsLoaded:v,hasPasscode:b,canSetPasscode:S,isFoldersSidebarShown:y,isForumPanelOpen:A,onSearchQuery:M,onReset:C})=>{const{setGlobalSearchDate:P,setSharedSettingOption:k,setGlobalSearchChatId:T,lockScreen:F,openSettingsScreen:B,searchMessagesGlobal:U,closeForumPanel:x,openChat:N,openLeftColumnContent:R}=(0,w.ko)(),J=(0,Da.A)(),Y=(0,ea.A)(),{isMobile:E}=(0,O.Ay)(),D=(0,ta.A)(()=>{R({contentKey:i.Bn.Threads})}),L=t===i.Bn.Contacts,G=t===i.Bn.ChatList,V=A&&y&&!Js,j=(0,qt.Kr)(()=>u?(0,ye.A)(new Date(1e3*u)):void 0,[u]),{connectionStatus:q,connectionStatusText:z,connectionStatusPosition:H}=(0,ss.A)(J,m,p||g,f,I,!v),K=(0,ta.A)(e=>{e.preventDefault(),e.stopPropagation(),b?F():B({screen:i.VS.PasscodeDisabled})}),W=(0,ta.A)(()=>{x()});(0,Ba.v)((0,qt.Kr)(()=>S?{"Ctrl+Shift+L":K,"Alt+Shift+L":K,"Meta+Shift+L":K,...d.lE&&{"Mod+L":K}}:void 0,[S]));const _=(0,qt.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,pa.Y)(La.A,{round:!0,ripple:G&&!E,size:"smaller",color:"translucent",className:(0,Kt.A)(t&&"active"),onClick:V?W:G?e:()=>C(),ariaLabel:Y(G?"AriaLabelOpenMenu":"AriaLabelBackChatList"),children:V?(0,pa.Y)(Ga.A,{name:"search"}):(0,pa.Y)("div",{className:(0,Kt.A)("animated-menu-icon",!G&&"state-back",c&&"no-animation")})}),[G,V,E,Y,C,c]),X=(0,ta.A)(()=>{o||M("")}),$=(0,ta.A)(()=>{k({isConnectionStatusMinimized:!I})}),Q=(0,ta.A)(()=>{F()}),Z=(0,ta.A)(()=>{o&&t===i.Bn.GlobalSearch&&U({type:"publicPosts",shouldResetResultsByType:!0})}),ee=Boolean(l)||t===i.Bn.GlobalSearch||t===i.Bn.Contacts,te=E?!f&&ee:ee;(0,qt.vJ)(()=>te?(0,Pa.A)(()=>C()):void 0,[te,C]);const ae=t===i.Bn.Contacts?Y("SearchFriends"):Y("Search"),se=!(te||j||l||L),oe=(0,qt.Kr)(()=>(0,pa.FD)(pa.FK,{children:[j&&(0,pa.Y)(Ss.A,{icon:"calendar",title:j,canClose:!0,isMinimized:Boolean(l),className:"left-search-picker-item",onClick:P,isCloseNonDestructive:!0,clickArg:Ns}),l&&(0,pa.Y)(Ss.A,{className:"left-search-picker-item",peerId:l,onClick:T,canClose:!0,isMinimized:!0,clickArg:Rs})]}),[l,j]);return(0,pa.Y)("div",{className:"LeftMainHeader",children:(0,pa.FD)("div",{id:"LeftMainHeader",className:"left-header","data-tauri-drag-region":!!Js||void 0,children:[Y.isRtl&&(0,pa.Y)("div",{className:"DropdownMenuFiller"}),(0,pa.Y)(bs,{trigger:_,className:(0,Kt.A)(G&&y&&!Js&&!V&&"hide-menu-button",V&&"forum-search-button")}),(0,pa.FD)(ws.A,{inputId:"telegram-search-input",resultsItemSelector:".LeftSearch .ListItem-button",className:(0,Kt.A)(l||u?"with-picker-item":void 0,e&&"SearchInput--hidden",G&&y&&!Js&&"SearchInput--no-left-margin"),value:s?void 0:a||o,focused:te,isLoading:n||"minimized"===H,spinnerColor:"minimized"===H?"yellow":void 0,spinnerBackgroundColor:"minimized"===H&&"light"===h?"light":void 0,placeholder:ae,autoComplete:"off",canClose:Boolean(l||u),onChange:M,onReset:C,onFocus:X,onSpinnerClick:"minimized"===H?$:void 0,onEnter:Z,children:[oe,(0,pa.Y)(ys.A,{canShow:se})]}),r&&(0,pa.Y)(xs,{}),b&&(0,pa.Y)(La.A,{round:!0,ripple:!E,size:"smaller",color:"translucent",ariaLabel:`${J("ShortcutsController.Others.LockByPasscode")} (Ctrl+Shift+L)`,onClick:Q,className:(0,Kt.A)(!r&&"extra-spacing"),iconName:"lock"}),(0,pa.Y)(La.A,{round:!0,ripple:!E,size:"smaller",color:"translucent",className:"home-button",onClick:D,ariaLabel:Y("AriaLabelBackChatList"),iconName:"bots"}),(0,pa.Y)(As.A,{isOpen:"overlay"===H,isCustom:!0,className:"connection-state-wrapper",children:(0,pa.Y)(Cs,{connectionStatus:q,connectionStatusText:z,onClick:$})})]})})})),Es=Object.keys(i.Bn).length/2;let Ds;const Os=(0,qt.ph)(({content:e,searchQuery:t,searchDate:a,isClosingSearch:o,contactsFilter:n,shouldSkipTransition:r,foldersDispatch:c,isAppUpdateAvailable:l,isForumPanelOpen:u,onSearchQuery:h,onReset:m,onTopicSearch:p,isAccountFrozen:g,isFoldersSidebarShown:f})=>{const{openLeftColumnContent:I}=(0,w.ko)(),[v,b]=(0,qt.J0)(d.TF),[S,y]=(0,qt.J0)(),[A,M]=(0,qt.J0)(!1),{shouldRenderForumPanel:C,handleForumPanelAnimationEnd:P,handleForumPanelAnimationStart:k,isAnimationStarted:T}=(0,Ea.A)(u),F=u&&e===i.Bn.ChatList,B=F&&T,{shouldRender:U,transitionClassNames:x}=(0,Oa.A)(l||Boolean(S)),N=(0,qt.li)(!1),R=(0,ta.A)(()=>{e===i.Bn.ChatList&&(N.current=!0,b(!0))}),J=(0,ta.A)(()=>{N.current=!1,Ds&&(clearTimeout(Ds),Ds=void 0),Ds=window.setTimeout(()=>{N.current||b(!1)},250)}),Y=(0,ta.A)(()=>{I({contentKey:i.Bn.Contacts})}),E=(0,ta.A)(async()=>{if(S)try{M(!0),await S.downloadAndInstall(),M(!1),await(window.tauri?.relaunch())}catch(e){console.error("Failed to download and install Tauri update",e)}finally{M(!1)}else window.location.reload()}),D=(0,ta.A)(()=>{I({contentKey:i.Bn.NewChannelStep1})}),O=(0,ta.A)(()=>{I({contentKey:i.Bn.NewGroupStep1})});(0,qt.vJ)(()=>{let t;return e!==i.Bn.ChatList?t=window.setTimeout(()=>{b(!1)},250):(N.current||d.TF)&&b(!0),()=>{t&&(clearTimeout(t),t=void 0)}},[e]);const L=(0,ta.A)(()=>{window.tauri?.checkUpdate().then(e=>y(e??void 0)).catch(e=>{console.error("Tauri update check failed:",e)})});(0,qt.vJ)(()=>{L()},[]),(0,$t.A)(L,vt.Vq&&!s.Oig?6e5:void 0);const G=(0,Da.A)();return(0,pa.FD)("div",{id:"LeftColumn-main",onMouseEnter:d.TF?void 0:R,onMouseLeave:d.TF?void 0:J,children:[(0,pa.Y)(Ys,{shouldHideSearch:B,content:e,contactsFilter:n,onSearchQuery:h,onReset:m,shouldSkipTransition:r,isClosingSearch:o,isFoldersSidebarShown:f}),(0,pa.Y)(Na.Ay,{name:r?"none":"zoomFade",renderCount:Es,activeKey:e,shouldCleanup:!0,cleanupExceptionKey:i.Bn.ChatList,shouldWrap:!0,wrapExceptionKey:i.Bn.ChatList,children:s=>{switch(e){case i.Bn.ChatList:return(0,pa.Y)(es,{shouldHideFolderTabs:B,foldersDispatch:c,isForumPanelOpen:B,isFoldersSidebarShown:f});case i.Bn.GlobalSearch:return(0,pa.Y)(za,{searchQuery:t,searchDate:a,isActive:s,onReset:m});case i.Bn.Contacts:return(0,pa.Y)(ts,{filter:n,isActive:s,onReset:m});default:return}}}),U&&(0,pa.Y)(La.A,{fluid:!0,badge:!0,className:(0,Kt.A)("btn-update",x),onClick:E,isLoading:A,children:G("lng_update_telegram")}),C&&(0,pa.Y)(as.A,{isOpen:u,isHidden:!F,onTopicSearch:p,onOpenAnimationStart:k,onCloseAnimationEnd:P}),(0,pa.Y)(qa,{isShown:v,onNewPrivateChat:Y,onNewChannel:D,onNewGroup:O,isAccountFrozen:g})]})}),Ls=e=>{const t=(0,ma.A)(Xt.ar.Extra,"NewChat");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},Gs=e=>{const t=(0,ma.A)(Xt.ar.Extra,"Settings");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})};var Vs=function(e){return e[e.Main=0]="Main",e[e.Settings=1]="Settings",e[e.Archived=2]="Archived",e[e.Threads=3]="Threads",e[e.NewGroup=4]="NewGroup",e[e.NewChannel=5]="NewChannel",e}(Vs||{});const js=Object.keys(Vs).length/2,qs=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{globalSearch:{query:a,minDate:s},shouldSkipHistoryAnimations:o,activeChatFolder:n,leftColumn:i,nextFoldersAction:r,storyViewer:{isArchivedRibbonShown:d}}=t,{currentUserId:c,passcode:{hasPasscode:l},isAppUpdateAvailable:u,archiveSettings:h}=e,{animationLevel:m}=(0,je.lS)(e),p=(0,C.meB)(e),g=Boolean(p?.id),f=(0,C.clw)(e),I=t.forumPanelChatId,v=(0,C.trm)(e),b=p?.id,S=b?(0,C.eg5)(e,b):void 0;return{searchQuery:a,searchDate:s,isFirstChatFolderActive:0===n,animationLevel:m,shouldSkipHistoryAnimations:o,currentUserId:c,hasPasscode:l,nextFoldersAction:r,isChatOpen:g,isAppUpdateAvailable:u,isForumPanelOpen:f,forumPanelChatId:I,isClosingSearch:t.globalSearch.isClosing,archiveSettings:h,isArchivedStoryRibbonShown:d,isAccountFrozen:v,currentChatId:b,threads:S,contentKey:i.contentKey,settingsScreen:i.settingsScreen}})(function({ref:e,contentKey:t,settingsScreen:a,searchQuery:s,searchDate:o,isFirstChatFolderActive:n,animationLevel:r,shouldSkipHistoryAnimations:c,currentUserId:l,hasPasscode:u,nextFoldersAction:h,isChatOpen:m,isAppUpdateAvailable:p,isForumPanelOpen:g,forumPanelChatId:f,isClosingSearch:I,archiveSettings:v,isArchivedStoryRibbonShown:b,isAccountFrozen:S,isFoldersSidebarShown:y,currentChatId:A,threads:M}){const{setGlobalSearchQuery:C,setGlobalSearchClosing:P,setGlobalSearchChatId:k,resetChatCreation:T,setGlobalSearchDate:F,loadPasswordInfo:B,clearTwoFaError:U,openChat:x,openLeftColumnContent:N,openSettingsScreen:R}=(0,w.ko)(),[J,Y]=(0,qt.J0)(""),[E,D]=(0,Fa.A)(),[O,L]=(0,qt.J0)(0);let G=Vs.Main;switch(t){case i.Bn.Archived:G=Vs.Archived;break;case i.Bn.Settings:G=Vs.Settings;break;case i.Bn.Threads:G=Vs.Threads;break;case i.Bn.NewChannelStep1:case i.Bn.NewChannelStep2:G=Vs.NewChannel;break;case i.Bn.NewGroupStep1:case i.Bn.NewGroupStep2:G=Vs.NewGroup}const V=(0,ta.A)(e=>{function s(){N({contentKey:void 0}),R({screen:void 0}),Y(""),P({isClosing:!0}),T(),setTimeout(()=>{C({query:""}),F({date:void 0}),k({id:void 0}),P({isClosing:!1}),L(Date.now())},250)}if(!0!==e)if(t!==i.Bn.NewGroupStep2)if(t!==i.Bn.NewChannelStep2){if(t===i.Bn.NewGroupStep1){const e=document.getElementById("new-group-picker-search");e&&e.blur()}if(t===i.Bn.Settings)switch(a){case i.VS.EditProfile:case i.VS.Folders:case i.VS.General:case i.VS.Notifications:case i.VS.DataStorage:case i.VS.Privacy:case i.VS.Performance:case i.VS.ActiveSessions:case i.VS.Language:case i.VS.Stickers:case i.VS.Experimental:return void R({screen:i.VS.Main});case i.VS.GeneralChatBackground:return void R({screen:i.VS.General});case i.VS.GeneralChatBackgroundColor:return void R({screen:i.VS.GeneralChatBackground});case i.VS.PrivacyPhoneNumber:case i.VS.PrivacyAddByPhone:case i.VS.PrivacyLastSeen:case i.VS.PrivacyProfilePhoto:case i.VS.PrivacyBio:case i.VS.PrivacyBirthday:case i.VS.PrivacyGifts:case i.VS.PrivacyPhoneCall:case i.VS.PrivacyPhoneP2P:case i.VS.PrivacyForwarding:case i.VS.PrivacyGroupChats:case i.VS.PrivacyVoiceMessages:case i.VS.PrivacyMessages:case i.VS.PrivacyBlockedUsers:case i.VS.ActiveWebsites:case i.VS.TwoFaDisabled:case i.VS.TwoFaEnabled:case i.VS.TwoFaCongratulations:case i.VS.PasscodeDisabled:case i.VS.PasscodeEnabled:case i.VS.PasscodeCongratulations:case i.VS.Passkeys:return void R({screen:i.VS.Privacy});case i.VS.PasscodeNewPasscode:return void R({screen:u?i.VS.PasscodeEnabled:i.VS.PasscodeDisabled});case i.VS.PasscodeChangePasscodeCurrent:case i.VS.PasscodeTurnOff:return void R({screen:i.VS.PasscodeEnabled});case i.VS.PasscodeNewPasscodeConfirm:return void R({screen:i.VS.PasscodeNewPasscode});case i.VS.PasscodeChangePasscodeNew:return void R({screen:i.VS.PasscodeChangePasscodeCurrent});case i.VS.PasscodeChangePasscodeConfirm:return void R({screen:i.VS.PasscodeChangePasscodeNew});case i.VS.PrivacyPhoneNumberAllowedContacts:case i.VS.PrivacyPhoneNumberDeniedContacts:return void R({screen:i.VS.PrivacyPhoneNumber});case i.VS.PrivacyLastSeenAllowedContacts:case i.VS.PrivacyLastSeenDeniedContacts:return void R({screen:i.VS.PrivacyLastSeen});case i.VS.PrivacyProfilePhotoAllowedContacts:case i.VS.PrivacyProfilePhotoDeniedContacts:return void R({screen:i.VS.PrivacyProfilePhoto});case i.VS.PrivacyBioAllowedContacts:case i.VS.PrivacyBioDeniedContacts:return void R({screen:i.VS.PrivacyBio});case i.VS.PrivacyBirthdayAllowedContacts:case i.VS.PrivacyBirthdayDeniedContacts:return void R({screen:i.VS.PrivacyBirthday});case i.VS.PrivacyGiftsAllowedContacts:case i.VS.PrivacyGiftsDeniedContacts:return void R({screen:i.VS.PrivacyGifts});case i.VS.PrivacyPhoneCallAllowedContacts:case i.VS.PrivacyPhoneCallDeniedContacts:return void R({screen:i.VS.PrivacyPhoneCall});case i.VS.PrivacyPhoneP2PAllowedContacts:case i.VS.PrivacyPhoneP2PDeniedContacts:return void R({screen:i.VS.PrivacyPhoneP2P});case i.VS.PrivacyForwardingAllowedContacts:case i.VS.PrivacyForwardingDeniedContacts:return void R({screen:i.VS.PrivacyForwarding});case i.VS.PrivacyVoiceMessagesAllowedContacts:case i.VS.PrivacyVoiceMessagesDeniedContacts:return void R({screen:i.VS.PrivacyVoiceMessages});case i.VS.PrivacyGroupChatsAllowedContacts:case i.VS.PrivacyGroupChatsDeniedContacts:return void R({screen:i.VS.PrivacyGroupChats});case i.VS.TwoFaNewPassword:return void R({screen:i.VS.TwoFaDisabled});case i.VS.TwoFaNewPasswordConfirm:return void R({screen:i.VS.TwoFaNewPassword});case i.VS.TwoFaNewPasswordHint:return void R({screen:i.VS.TwoFaNewPasswordConfirm});case i.VS.TwoFaNewPasswordEmail:return void R({screen:i.VS.TwoFaNewPasswordHint});case i.VS.TwoFaNewPasswordEmailCode:return void R({screen:i.VS.TwoFaNewPasswordEmail});case i.VS.TwoFaChangePasswordCurrent:case i.VS.TwoFaTurnOff:case i.VS.TwoFaRecoveryEmailCurrentPassword:return void R({screen:i.VS.TwoFaEnabled});case i.VS.TwoFaChangePasswordNew:return void R({screen:i.VS.TwoFaChangePasswordCurrent});case i.VS.TwoFaChangePasswordConfirm:return void R({screen:i.VS.TwoFaChangePasswordNew});case i.VS.TwoFaChangePasswordHint:return void R({screen:i.VS.TwoFaChangePasswordConfirm});case i.VS.TwoFaRecoveryEmail:return void R({screen:i.VS.TwoFaRecoveryEmailCurrentPassword});case i.VS.TwoFaRecoveryEmailCode:return void R({screen:i.VS.TwoFaRecoveryEmail});case i.VS.FoldersCreateFolder:case i.VS.FoldersEditFolder:return void R({screen:i.VS.Folders});case i.VS.FoldersShare:return void R({screen:i.VS.FoldersEditFolder});case i.VS.FoldersIncludedChatsFromChatList:case i.VS.FoldersExcludedChatsFromChatList:return void R({screen:i.VS.FoldersEditFolderFromChatList});case i.VS.FoldersEditFolderFromChatList:case i.VS.FoldersEditFolderInvites:return N({contentKey:i.Bn.ChatList}),void R({screen:i.VS.Main});case i.VS.QuickReaction:case i.VS.CustomEmoji:return void R({screen:i.VS.Stickers});case i.VS.DoNotTranslate:return void R({screen:i.VS.Language});case i.VS.PrivacyNoPaidMessages:return void R({screen:i.VS.PrivacyMessages})}t===i.Bn.ChatList&&n?N({contentKey:i.Bn.GlobalSearch}):s()}else N({contentKey:i.Bn.NewChannelStep1});else N({contentKey:i.Bn.NewGroupStep1});else s()}),j=(0,ta.A)(e=>{t!==i.Bn.Contacts?(N({contentKey:i.Bn.GlobalSearch}),e!==s&&C({query:e})):Y(e)}),q=(0,ta.A)(()=>{N({contentKey:i.Bn.GlobalSearch}),C({query:""}),k({id:f})});(0,qt.vJ)(()=>{const e=t===i.Bn.Archived,a=t===i.Bn.ChatList,s=!m&&!g;return e&&s||!a&&!e||n&&s?(0,Pa.A)(()=>{V()}):void 0},[n,t,V,m,g]);const z=(0,ta.A)(e=>{t!==i.Bn.GlobalSearch&&(e.preventDefault(),N({contentKey:i.Bn.GlobalSearch}))}),H=(0,ta.A)(e=>{e.preventDefault(),x({id:l,shouldReplaceHistory:!0})}),K=(0,ta.A)(e=>{e.preventDefault(),N({contentKey:i.Bn.Archived})}),W=(0,ta.A)(e=>{e.preventDefault(),N({contentKey:i.Bn.Settings})});(0,Ba.v)((0,qt.Kr)(()=>({"Mod+Shift+F":z,...!d.$M&&{"Mod+Shift+S":H},...d.lE&&{"Mod+0":H,"Mod+9":K},...d.MP&&d.lE&&{"Mod+,":W}}),[])),(0,qt.vJ)(()=>{U(),a===i.VS.Privacy&&B()},[U,B,a]),(0,ia.A)(()=>{h&&D(h)},[D,h]);const _=(0,xa.i)((0,Ua.A)(G===Vs.Settings?a:-1));return(0,qt.vJ)(()=>{if(d.TF)return(0,Ta.P)(e.current,{excludedClosestSelector:".ProfileInfo, .color-picker, .hue-picker",selectorToPreventScroll:"#Settings .custom-scroll",onSwipeRightStart:V,onCancel:()=>{N({contentKey:i.Bn.Settings}),R({screen:_.current})}})},[_,e]),(0,pa.Y)(Na.Ay,{ref:e,name:(0,ka.P)("layers",r,c),renderCount:js,activeKey:G,shouldCleanup:!0,cleanupExceptionKey:Vs.Main,shouldWrap:!0,wrapExceptionKey:Vs.Main,id:"LeftColumn",withSwipeControl:!0,children:function(e){switch(G){case Vs.Archived:return(0,pa.Y)(Ya,{isActive:e,onReset:V,onTopicSearch:q,foldersDispatch:D,isForumPanelOpen:g,archiveSettings:v,isStoryRibbonShown:b});case Vs.Settings:return(0,pa.Y)(Gs,{isActive:e,currentScreen:a,foldersState:E,foldersDispatch:D,animationLevel:r,shouldSkipTransition:c,onReset:V});case Vs.Threads:return(0,pa.Y)(Ja,{isActive:e,currentChatId:A,onReset:V});case Vs.NewChannel:return(0,pa.Y)(Ls,{isActive:e,isChannel:!0,content:t,animationLevel:r,onReset:V},O);case Vs.NewGroup:return(0,pa.Y)(Ls,{isActive:e,content:t,animationLevel:r,onReset:V},O);default:return(0,pa.Y)(Os,{content:t,isClosingSearch:I,searchQuery:s,searchDate:o,contactsFilter:J,foldersDispatch:D,onSearchQuery:j,onReset:V,shouldSkipTransition:c,isAppUpdateAvailable:p,isForumPanelOpen:g,onTopicSearch:q,isAccountFrozen:S,isFoldersSidebarShown:y})}}})})),zs=({isOpen:e})=>{const t=(0,ma.A)(Xt.ar.Extra,"MediaViewer",!e);return t?(0,pa.Y)(t,{}):void 0},Hs=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ReactionPicker",!t);return a?(0,pa.Y)(a,{...e}):void 0},Ks=({chatId:e,type:t,threadId:a,onBack:s})=>{(0,ua.A)({isActive:!0,hash:(0,it.az)(e,t,a),onBack:s})},Ws=(0,qt.ph)((0,w.EK)(e=>({messageLists:(0,C.nTw)(e).messageLists}))(({messageLists:e})=>{const{openChat:t}=(0,w.ko)(),a=()=>{t({id:void 0},{forceSyncOnIOs:!0})};return(0,pa.Y)("div",{children:e?.map((e,t)=>(0,pa.Y)(Ks,{...e,onBack:a},`${e.chatId}_${e.threadId}_${e.type}_${t}`))})}));var _s=a(95807),Xs=a(65632),$s=a(23565),Qs=a(73767),Zs=a(39751),eo=a(67054),to=a(83414);let ao,so;function oo(e){return Math.max(0,e)}var no=a(48196),io=a(62039),ro=a(4961),co=a(55158);const lo=(0,qt.ph)((0,w.EK)((e,t)=>{const{threadId:a}=t,s=a&&"string"==typeof a?a:void 0,o=s?e.alphahuman?.threadMessages?.[s]:void 0,n=s&&e.alphahuman?.threadMessagesLoading?.[s]||!1,i=s?e.alphahuman?.threads?.find(e=>e.id===s):void 0;return{messages:o?.messages?.map(e=>{let t=e.content||"";if("toolStart"===e.type){const a=e.extraMetadata?.toolName,s=e.extraMetadata?.toolInput||{};if(a)try{t=` ${(0,io.N)(a,s)}`}catch(e){t=`Tool ${a} started`}else t="Tool started"}if("toolEnd"===e.type){const a=e.extraMetadata?.toolName;if(a)try{const s=e.extraMetadata?.toolInput||{};t=` ${(0,io.N)(a,s)}`}catch(e){t=`Tool ${a} completed`}else t="Tool completed"}const a="string"==typeof e.createdAt?e.createdAt:new Date(e.createdAt||Date.now()).toISOString();return{id:e.id,content:t,sender:e.sender,createdAt:a,type:e.type}}).filter(e=>""!==e.content)||[],isLoading:n,threadTitle:i?.title,streamingContent:e.alphahuman?.streamingContent,isStreaming:e.alphahuman?.isStreaming}})(({threadId:e,onClose:t,messages:a=[],isLoading:s=!1,threadTitle:o,streamingContent:n,isStreaming:i=!1,activeTools:r})=>{const{loadAlphahumanThreadMessages:d,streamAlphaHumanMessage:l}=(0,w.ko)(),[u,h]=(0,qt.J0)(""),m=(0,qt.li)(),p=(0,qt.li)(),g=(0,qt.li)(),[f,I]=(0,qt.J0)(""),v=(0,qt.li)(),b=(0,qt.li)(0),[S,y]=(0,qt.J0)(!1),[A,M]=(0,qt.J0)(),[C,P]=(0,qt.J0)(),k=(0,qt.li)(),T=(0,ta.A)(()=>p.current),F=(0,ta.A)(()=>document.body),B=(0,ta.A)(()=>k.current),U=(0,ta.A)(()=>({extraPaddingX:10,shouldAvoidNegativePosition:!0})),x=(0,qt.hb)(()=>{const e=p.current;if(!e)return!1;const{scrollTop:t,scrollHeight:a,clientHeight:s}=e;return a-t-s<100},[]),N=(0,qt.hb)(()=>{const e=p.current;e&&(g.current&&cancelAnimationFrame(g.current),g.current=requestAnimationFrame(()=>{const t=e.scrollHeight;(0,Ht.RK)(()=>{e.scrollTop=t})}))},[]);(0,qt.vJ)(()=>{e&&"string"==typeof e&&d({threadId:e})},[e,d]),(0,qt.vJ)(()=>(v.current&&cancelAnimationFrame(v.current),v.current=requestAnimationFrame(()=>{I(n||"")}),()=>{v.current&&cancelAnimationFrame(v.current)}),[n]),(0,qt.vJ)(()=>{const e=a.length,t=e>b.current,o=!s&&e>0&&0===b.current;if(t||o||i){const t=x();if(i||o||t){const t=setTimeout(()=>{N()},50);return b.current=e,()=>clearTimeout(t)}b.current=e}},[a.length,s,i,N,x]);const R=(0,ta.A)(()=>{const t=u.trim();t&&!i&&(l({threadId:e&&"string"==typeof e?e:void 0,content:t}),h(""),m.current?.focus())}),J=(0,ta.A)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R())}),Y=(0,ta.A)(()=>{if(C){const e=window.getSelection();Boolean(e?.toString().trim()&&e.anchorNode?.parentNode&&e.anchorNode.parentNode.closest(".Message"))?document.execCommand("copy"):(0,c.eM)(C)}y(!1),M(void 0),P(void 0)}),E=(0,ta.A)((e,t)=>{e.preventDefault(),e.stopPropagation(),P(t),M({x:e.clientX,y:e.clientY}),y(!0)}),D=(0,ta.A)(()=>{y(!1)}),O=(0,ta.A)(()=>{M(void 0),P(void 0)});return(0,pa.FD)("div",{className:"AlphaHumanThreadPage",children:[(0,pa.Y)("div",{className:"alpha-human-thread-header",children:(0,pa.Y)("div",{className:"header-content",children:(0,pa.Y)("h3",{className:"header-title",children:o||"New Chat"})})}),(0,pa.Y)("div",{className:"alpha-human-thread-messages",ref:p,children:(0,pa.FD)("div",{className:"messages-container",children:[s&&0===a.length&&(0,pa.FD)("div",{className:"messages-skeleton",children:[(0,pa.Y)("div",{className:"Message message-list-item own first-in-group last-in-group",children:(0,pa.Y)("div",{className:"message-content-wrapper",children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.Y)("div",{className:"text-content with-meta",children:(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:180})})})})}),(0,pa.FD)("div",{className:"Message message-list-item first-in-group last-in-group",children:[(0,pa.Y)(ps.A,{size:"small",previewUrl:"/android-chrome-192x192.png"}),(0,pa.Y)("div",{className:"message-content-wrapper",children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.FD)("div",{className:"text-content with-meta",children:[(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:280}),(0,pa.Y)("div",{style:"height: 8px"}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:240}),(0,pa.Y)("div",{style:"height: 8px"}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:320})]})})})]}),(0,pa.Y)("div",{className:"Message message-list-item own first-in-group last-in-group",children:(0,pa.Y)("div",{className:"message-content-wrapper",children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.Y)("div",{className:"text-content with-meta",children:(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:180})})})})}),(0,pa.FD)("div",{className:"Message message-list-item first-in-group last-in-group",children:[(0,pa.Y)(ps.A,{size:"small",previewUrl:"/android-chrome-192x192.png"}),(0,pa.Y)("div",{className:"message-content-wrapper",children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.FD)("div",{className:"text-content with-meta",children:[(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:300}),(0,pa.Y)("div",{style:"height: 8px"}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:200})]})})})]})]}),a.map((e,t)=>{const s="user"===e.sender,o="agent"===e.sender,{isFirstInGroup:n,isLastInGroup:i}=(e=>{const t=a[e],s=e>0?a[e-1]:void 0,o=e<a.length-1?a[e+1]:void 0;return{isFirstInGroup:!s||s.sender!==t.sender,isLastInGroup:!o||o.sender!==t.sender}})(t),r=o?(0,ro.A)(e.content,["emoji","br","simple_markdown","links"]):e.content;return["text","toolStart","complete"].includes(e.type)?(0,pa.FD)("div",{className:(0,Kt.A)("Message message-list-item",s&&"own",n&&"first-in-group",i&&"last-in-group"),children:[o&&i&&(0,pa.Y)(ps.A,{size:"small",previewUrl:"/android-chrome-192x192.png"}),["complete","text"].includes(e.type)?(0,pa.Y)("div",{className:"message-content-wrapper",onContextMenu:t=>E(t,e.content),children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.Y)("div",{className:"text-content with-meta",dir:"auto",children:r})})}):"toolEnd"!==e.type?(0,pa.Y)("div",{className:"intermediate-step",children:r}):(0,pa.Y)(pa.FK,{})]},e.id):(0,pa.Y)(pa.FK,{})}),i&&(0,pa.FD)("div",{className:(0,Kt.A)("Message message-list-item first-in-group last-in-group"),children:[(0,pa.Y)(ps.A,{size:"small",previewUrl:"/android-chrome-192x192.png"}),(0,pa.Y)("div",{className:"message-content-wrapper",children:(0,pa.Y)("div",{className:"message-content text",children:(0,pa.Y)("div",{className:"text-content with-meta",dir:"auto",children:(0,pa.FD)("div",{className:"analyzing-content",children:[(0,pa.FD)("div",{className:"analyzing-text-container",children:[(0,pa.Y)("span",{className:"analyzing-text",children:"Analyzing your message..."}),(0,pa.FD)("div",{className:"thinking-dots",children:[(0,pa.Y)("span",{className:"dot"}),(0,pa.Y)("span",{className:"dot"}),(0,pa.Y)("span",{className:"dot"})]})]}),f?(0,pa.FD)(pa.FK,{children:[(0,ro.A)(f,["emoji","br","simple_markdown","links"]),(0,pa.Y)("span",{className:"streaming-cursor",children:""})]}):(0,pa.FD)("div",{className:"analyzing-skeleton",children:[(0,pa.Y)(co.A,{variant:"rounded-rect",height:12,width:120}),(0,pa.Y)("div",{style:"height: 4px"}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:12,width:80})]})]})})})})]})]})}),(0,pa.Y)("div",{className:"alpha-human-thread-composer",children:(0,pa.FD)("div",{className:"composer-input-wrapper",children:[(0,pa.Y)("input",{ref:m,type:"text",className:"composer-input",placeholder:"Type a message...",value:u,onChange:e=>h(e.target.value),onKeyDown:J,disabled:i}),(0,pa.Y)(La.A,{round:!0,size:"smaller",color:"primary",className:"send-button",ariaLabel:"Send",onClick:R,disabled:i||!u.trim(),children:(0,pa.Y)(Ga.A,{name:"send"})})]})}),(0,pa.Y)(Va.A,{ref:k,isOpen:S,anchor:A,getTriggerElement:T,getRootElement:F,getMenuElement:B,getLayout:U,withPortal:!0,withMaxHeight:!0,className:"AlphaHumanContextMenu",onClose:D,onCloseAnimationEnd:O,children:(0,pa.Y)(ja.A,{icon:"copy",onClick:Y,children:"Copy Text"})})]})}));var uo=a(22081);const ho=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PrivacySettingsNoticeModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},mo=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SeenByModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},po=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"UnpinAllMessagesModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},go=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ChatLanguageModal",!t);return a?(0,pa.Y)(a,{...e}):void 0};var fo=a(41510);const Io=e=>{const{activeEmojiInteraction:t}=e,a=(0,ma.A)(Xt.ar.Extra,"EmojiInteractionAnimation",!t);return a?(0,pa.Y)(a,{...e}):void 0};var vo=a(10722);const bo=(0,qt.ph)(({icon:e,ariaLabelLang:t,unreadCount:a,onClick:s,onReadAll:o,className:n})=>{const i=(0,Da.A)(),r=(0,ea.A)(),d=(0,qt.li)(),{isContextMenuOpen:c,handleContextMenu:l,handleContextMenuClose:u,handleContextMenuHide:h}=(0,vo.A)(d,!o);return(0,pa.FD)("div",{className:(0,Kt.A)("Y2NKrpKj",n),ref:d,children:[(0,pa.Y)(La.A,{color:"secondary",round:!0,className:"cxwA6gDO",onClick:s,onContextMenu:l,ariaLabel:i(t),iconName:e,iconClassName:"F4zNUFhH"}),Boolean(a)&&(0,pa.Y)("div",{className:"GovSzpfQ",children:(0,Aa.Vw)(r,a)}),o&&(0,pa.Y)(Va.A,{isOpen:c,onClose:u,onCloseAnimationEnd:h,autoClose:!0,positionX:"right",positionY:"bottom",children:(0,pa.Y)(ja.A,{icon:"readchats",onClick:o,children:i("MarkAllAsRead")})})]})}),So="UMXbiYB3",yo=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.Xf0)(e);if(!t)return{};const{chatId:a,threadId:s,type:o}=t,i=(0,C.hds)(e,a),r=Boolean((0,C.TCk)(e)),d=i&&s===n.l3&&"thread"===o&&!r;return{messageListType:o,chatId:a,threadId:s,reactionsCount:d?i.unreadReactionsCount:void 0,unreadReactions:d?i.unreadReactions:void 0,unreadMentions:d?i.unreadMentions:void 0,mentionsCount:d?i.unreadMentionsCount:void 0,unreadCount:d?i.unreadCount:void 0}})(({withScrollDown:e,canPost:t,messageListType:a,chatId:s,threadId:o,unreadCount:n,unreadReactions:i,unreadMentions:r,reactionsCount:d,mentionsCount:c,withExtraShift:l})=>{const{focusNextReply:u,focusNextReaction:h,focusNextMention:m,fetchUnreadReactions:p,readAllMentions:g,readAllReactions:f,fetchUnreadMentions:I,scrollMessageListToBottom:v}=(0,w.ko)(),b=(0,qt.li)(),S=Boolean(d),y=Boolean(c),A=(0,ta.A)(()=>{s&&f({chatId:s,threadId:o})}),M=(0,ta.A)(()=>{s&&g({chatId:s,threadId:o})});(0,qt.vJ)(()=>{S&&s&&!i?.length&&p({chatId:s})},[s,p,S,i?.length]),(0,qt.vJ)(()=>{S&&s&&p({chatId:s})},[s,p,S]),(0,qt.vJ)(()=>{y&&s&&!r?.length&&I({chatId:s})},[s,I,y,r?.length]),(0,qt.vJ)(()=>{y&&s&&I({chatId:s})},[s,I,y]);const C=(0,ta.A)(()=>{e&&("thread"===a?u():v())}),P=(0,Kt.A)("VWoOZCD5",(e||Boolean(d)||Boolean(c))&&"iozW83la",(Boolean(d)||Boolean(c))&&!e&&"UBa5kAK5",!t&&"yzzjqibi",!l&&"wDwOdyQH");return(0,pa.FD)("div",{ref:b,className:P,children:[(0,pa.Y)(bo,{icon:"heart-outline",ariaLabelLang:"AccDescrReactionMentionDown",onClick:h,onReadAll:A,unreadCount:d,className:(0,Kt.A)("eO_Fz8SD",!S&&So,!y&&"gn3iLVq1")}),(0,pa.Y)(bo,{icon:"mention",ariaLabelLang:"AccDescrMentionDown",onClick:m,onReadAll:M,unreadCount:c,className:!y&&So}),(0,pa.Y)(bo,{icon:"arrow-down",ariaLabelLang:"AccDescrPageDown",onClick:C,unreadCount:n,className:"u62x81QI"})]})})),wo=(0,qt.ph)(function(){const e=(0,ea.A)(),{openFrozenAccountModal:t}=(0,w.ko)(),a=(0,ta.A)(()=>{t()});return(0,pa.FD)("div",{className:"GuZke_HG",onClick:a,children:[(0,pa.Y)("div",{className:"oLWeN4mA",children:e("ComposerTitleFrozenAccount")}),(0,pa.Y)("div",{className:"ZxTe54MY",children:e("ComposerSubtitleFrozenAccount")})]})});var Ao=a(46442);const Mo=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"MessageSelectToolbar",!t);return a?(0,pa.Y)(a,{...e}):void 0};var Co=a(38218),Po=a(51083),ko=a(17751),To=a(48553),Fo=a(53827),Bo=a(49642),Uo=a(35749),xo=a(88792),No=a(14),Ro=a(62587),Jo=a(24909),Yo=a(56863);const Eo=a.p+"telegram-logo-filled.67469f6dc5e301e8e0bd.svg",Do={width:200,height:200},Oo=115;var Lo=a(48885),Go=a(82497),Vo=a(42452);const jo={.5:.66,.75:.8,1:1,1.5:1.4,2:1.8},qo=Object.keys(jo).sort().map(Number);function zo(e){const{title:t,performer:a,fileName:s}=e;return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("div",{className:"title",dir:"auto",children:(0,ro.A)(t||s)}),a&&(0,pa.Y)("div",{className:"subtitle",dir:"auto",children:(0,ro.A)(a)})]})}function Ho(e,t){return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("div",{className:"title",dir:"auto",children:t&&(0,ro.A)(t)}),(0,pa.Y)("div",{className:"subtitle",dir:"auto",children:e})]})}const Ko=(0,w.EK)((e,{isHidden:t})=>{const{audioPlayer:a}=(0,C.nTw)(e),{chatId:s,messageId:o}=a,n=!t&&s&&o?(0,C.O5q)(e,s,o):void 0,i=n&&(0,C.Y7C)(e,n),r=n&&(0,C.hds)(e,n.chatId),{playbackRate:d,isMuted:c,isPlaybackRateActive:l,timestamp:u}=(0,C.nTw)(e).audioPlayer,{volume:h}=e.audioPlayer;return{message:n,sender:i,chat:r,volume:h,playbackRate:d,isPlaybackRateActive:l,isMuted:c,timestamp:u,mediaDuration:n?(0,pt.Y9)(e,n):void 0}})(({message:e,mediaDuration:t,className:a,noUi:o,sender:n,chat:i,volume:r,playbackRate:c,isPlaybackRateActive:l,isMuted:u,isFullWidth:h,timestamp:m,onPaneStateChange:p})=>{const{setAudioPlayerVolume:g,setAudioPlayerPlaybackRate:f,setAudioPlayerMuted:I,focusMessage:v,closeAudioPlayer:b}=(0,w.ko)(),A=(0,Da.A)(),{isMobile:M}=(0,O.Ay)(),C=(0,No.A)(e),{audio:P,voice:k,video:T}=C?(0,S.r_)(C):{},F=Boolean(k||T),B=F||(P?.duration||0)>s.CVm,x=n?(0,y.F9)(A,n):void 0,N=k||T||P,R=(0,Uo.A)(C,"inline"),J=N&&(0,S.Cz)(N,"inline"),Y=(0,Ro.A)(R,!1,J),E=((e,t,a)=>{const s=(0,Da.A)(),{audio:o,voice:n}=e?(0,S.r_)(e):{},i=o?o.title||o.fileName:n?"Voice message":"",r=o?.performer||t&&(0,y.F9)(s,t),d=a&&(0,S.Js)(s,a)||"Telegram",c=o&&(0,S.AB)(o)&&(0,S.VO)(o,"pictogram"),l=t&&(0,S.cP)(t,"big"),u=o&&c||n&&l,h=(0,Ro.A)(u),m=(0,qt.Kr)(()=>function(e,t,a){if(!a)return Do;if(e){if(!e.thumbnailSizes?.length)return;const t=e.thumbnailSizes.find(e=>"m"===e.type);return t||e.thumbnailSizes[0]}return t?U.cf:void 0}(o,n,h),[o,h,n]),{result:p}=(0,Yo.A)(()=>function(e,t){if(!e)return Promise.resolve(Eo);if(!t)return(0,Jo.y)(e,Oo,Oo);const a=Math.min(t.width,t.height);if(a<Oo){const t=Oo/a;return(0,Jo.s)(e,t)}return Promise.resolve(e)}(h,m),[h,m],Eo);return(0,qt.Kr)(()=>(0,Bo.wp)({title:i,artist:r,album:d,artwork:[{src:p}]}),[d,r,i,p])})(C,n,i),{playPause:D,stop:L,isPlaying:G,requestNextTrack:V,requestPreviousTrack:j,isFirst:q,isLast:z,setVolume:H,toggleMuted:K,setPlaybackRate:W,setCurrentTime:_}=(0,xo.A)(e&&(0,Fo.dj)(e),t||0,F?"voice":"audio",Y,void 0,E,void 0,!0,void 0,void 0,e&&(0,S.Nb)(e),!0),X=Boolean(e),{ref:$}=(0,na.A)({isOpen:X,shouldForceOpen:h}),{ref:Q,shouldRender:Z}=(0,Lo.A)({isOpen:X,isDisabled:!h,ref:$,onStateChange:p}),{isContextMenuOpen:ee,handleBeforeContextMenu:te,handleContextMenu:ae,handleContextMenuClose:se,handleContextMenuHide:oe}=(0,vo.A)($,!Z);(0,qt.vJ)(()=>{m&&_(m)},[m,_]),(0,qt.vJ)(()=>{G&&e?.isDeleting&&D()},[G,e?.isDeleting,D]);const ne=(0,ta.A)(()=>{const{chatId:e,id:t}=C;v({chatId:e,messageId:t})}),ie=(0,ta.A)(()=>{L&&(G&&D(),b(),(0,Bo.Eg)(),L())}),re=(0,ta.A)(e=>{H&&(g({volume:e/100}),H(e/100))}),de=(0,ta.A)(()=>{d.TF&&!d.pz||K&&(K(),I({isMuted:!u}))}),ce=(0,ta.A)((e,t=!0)=>{if(!W)return;const a=jo[e],s=1!==e&&t;f({playbackRate:a,isPlaybackRateActive:s}),W(s?a:1)}),le=(0,ta.A)(()=>{se();const e=Number(Object.entries(jo).find(([,e])=>e===c)?.[0])||1,t=!l;ce(t&&1===e?2:e,t)}),ue=(0,ta.A)(()=>{const e=Object.entries(jo).find(([,e])=>e===c)?.[0]||1,t=`${1===c?2:e}`;return(0,pa.FD)("div",{className:"playback-wrapper",children:[ee&&(0,pa.Y)("div",{className:"playback-backdrop",onClick:se}),(0,pa.Y)(La.A,{round:!0,className:(0,Kt.A)("playback-button",l&&"applied",ee&&"on-top"),color:"translucent",size:"smaller",ariaLabel:"Playback Rate",ripple:!M,onMouseEnter:ae,onClick:le,onMouseDown:te,onContextMenu:ae,children:(0,pa.Y)("span",{className:(0,Kt.A)("playback-button-inner",4===t.length&&"small",5===t.length&&"tiny"),children:t})})]})}),he=(0,qt.Kr)(()=>0===r||u?"muted":r<.3?"volume-1":r<.6?"volume-2":"volume-3",[r,u]);if(!o&&Z)return(0,pa.FD)("div",{className:(0,Kt.A)("AudioPlayer",h?"full-width-player":"mini-player",a),dir:A.isRtl?"rtl":void 0,ref:Q,children:[(0,pa.FD)("div",{className:"AudioPlayer-content",onClick:ne,children:[P?zo(P):Ho(A("AttachAudio"),x),(0,pa.Y)(Vo.A,{})]}),(0,pa.Y)(La.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:"player-button",disabled:q?.(),onClick:j,ariaLabel:"Previous track",iconName:"skip-previous"}),(0,pa.FD)(La.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:(0,Kt.A)("toggle-play","player-button",G?"pause":"play"),onClick:D,ariaLabel:G?"Pause audio":"Play audio",children:[(0,pa.Y)(Ga.A,{name:"play"}),(0,pa.Y)(Ga.A,{name:"pause"})]}),(0,pa.Y)(La.A,{round:!0,ripple:!M,color:"translucent",size:"smaller",className:"player-button",disabled:z?.(),onClick:V,ariaLabel:"Next track",iconName:"skip-next"}),(0,pa.FD)("div",{className:"volume-button-wrapper",children:[(0,pa.Y)(La.A,{round:!0,className:"player-button volume-button",color:"translucent",size:"smaller",ariaLabel:"Volume",onClick:de,ripple:!M,iconName:he}),!d.pz&&(0,pa.FD)("div",{className:"volume-slider-wrapper",children:[(0,pa.Y)("div",{className:"volume-slider-spacer"}),(0,pa.Y)("div",{className:"volume-slider",children:(0,pa.Y)(Go.A,{bold:!0,value:u?0:100*r,onChange:re})})]})]}),B&&(0,pa.Y)(vs.A,{forceOpen:ee,positionX:"right",positionY:"top",className:"playback-rate-menu",trigger:ue,onClose:se,onHide:oe,onMouseEnterBackdrop:se,children:qo.map(e=>function(e,t,a,s){const o=t===jo[e]&&s||1===e&&!s;return(0,pa.FD)(ja.A,{onClick:()=>a(e),icon:o?"check":void 0,customIcon:o?void 0:(0,pa.Y)(Ga.A,{name:"placeholder"}),children:[e,"X"]},e)}(e,c,ce,l))}),(0,pa.Y)(La.A,{round:!0,className:"player-close",color:"translucent",size:"smaller",onClick:ie,ariaLabel:"Close player",iconName:"close"})]})});var Wo=a(85449),_o=a(2338),Xo=a(49746),$o=a(11217),Qo=a(93809),Zo=a(68292),en=a(27860),tn=a(18653),an=a(94189);const sn={"pinned-message-border":"L5TQCriM",pinnedMessageBorder:"L5TQCriM","pinned-message-border-wrapper-1":"v5sJGzfS",pinnedMessageBorderWrapper1:"v5sJGzfS","pinned-message-border-wrapper":"p6PQhvds",pinnedMessageBorderWrapper:"p6PQhvds","pinned-message-border-mark":"M2PQZgBd",pinnedMessageBorderMark:"M2PQZgBd"};function on(e,t,a,s,o){return`M${e},${t+o}a${o},${o},0,0,1,\n  ${a},0v${s-2*o}a${o},${o},0,0,1,${-a},0Z`}const nn=(0,qt.ph)(({count:e,index:t})=>{const a=(0,qt.li)(),s=(0,qt.Kr)(()=>function(e,t){const a=e-t-1,s=function(e){let t=8;return 1===e?t=36:2===e?t=17:3===e?t=11:(4===e||e>3)&&(t=7.5),t}(e),o=function(e,t){let a=36;return 1===e?a=36:2===e?a=17:3===e?a=1===t?12:11:(4===e||e>3)&&(a=7.5),a}(e,a),n=function(e,t){return e<=3?36:t*e+2*(e-1)}(e,s),i=`clipPath${e}`,r=function(e,t,a){let s="";if(3===a)s=on(0,0,2,t,1)+on(0,12,2,t+1,1)+on(0,25,2,t,1);else for(let e=0;e<a;e++)s+=on(0,(t+2)*e,2,t,1);return`<clipPath id="${e}">\n      <path d="${s}" />\n    </clipPath>`}(i,s,e),d=function(e,t,a){return 1===a?0:2===a?0===e?0:t+2:3===a?0===e?0:1===e?12:25:(t+2)*e}(a,s,e),c=function(e,t,a,s){return t<=4||e<=1?0:e>=t-2?s-36:(a+4)/2+(e-2)*(a+2)}(a,e,s,n);return{markHeight:o,clipPath:r,markTranslateY:d,trackTranslateY:c,trackHeight:n,clipPathId:i}}(e,t),[e,t]);if((0,qt.Nf)(()=>{if(!a.current)return;const{trackHeight:e,trackTranslateY:t,markHeight:o,markTranslateY:n,clipPathId:i,clipPath:r}=s,d=a.current.firstElementChild;if(a?.current){const s=a.current,{style:c}=s;c.height=`${e}px`,c.transform=`translateY(-${t}px)`,c.clipPath=`url("#${i}")`;const l=s.querySelector("svg"),u=s.querySelector("div"),h=s.querySelector("defs");l||d&&(d.innerHTML=`<svg height="0" width="0"><defs> ${r} </defs></svg>`),h&&(h.innerHTML=r),u&&(u.style.height=`${o}px`,u.style.transform=`translateY(${n}px)`)}},[s]),1===e)return(0,pa.Y)("div",{className:sn.pinnedMessageBorder,children:(0,pa.Y)("div",{className:sn.pinnedMessageBorderWrapper1,ref:a})});const{trackHeight:o,trackTranslateY:n,markHeight:i,markTranslateY:r,clipPathId:d}=s;return(0,pa.Y)("div",{className:(0,Kt.A)(sn.pinnedMessageBorder,e>4&&sn.pinnedMessageBorderMask),children:(0,pa.FD)("div",{className:sn.pinnedMessageBorderWrapper,ref:a,style:`clip-path: url("#${d}"); width: 2px;\n          height: ${o}px; transform: translateY(-${n}px);`,children:[(0,pa.Y)("span",{}),(0,pa.Y)("div",{className:sn.pinnedMessageBorderMark,style:`--height: ${i}px; --translate-y: ${r}px; --translate-track: ${n}px;`})]})})}),rn="LFRysfVa",dn="E_C4DXKN",cn="ljzqevcj",ln=1.125*U.$,un=(0,qt.ph)((0,w.EK)((e,{chatId:t,threadId:a,messageListType:s})=>{const o=(0,C.hds)(e,t),i=e.isSynced,r=(0,S.cG)(t,a,e.currentUserId),d=(0,C.zeq)(e,t),c={chat:o,isSynced:i};if("thread"!==s||!d)return c;if(a!==n.l3&&!r&&!o?.isForum){const s=Number(a),o=s?(0,C.O5q)(e,t,s):void 0,n=o?(0,C.Szq)(e,o):void 0;return{...c,pinnedMessageIds:s,messagesById:d,canUnpin:!1,topMessageSender:n}}const l=r?void 0:(0,C.fcC)(e,t,a);if(l?.length){const t=d[l[0]],{canUnpin:s=!1}=t&&1===l.length&&(0,C.WAX)(e,t,a)||{};return{...c,pinnedMessageIds:l,messagesById:d,canUnpin:s}}return c})(({chatId:e,threadId:t,canUnpin:a,getLoadingPinnedId:s,pinnedMessageIds:o,messagesById:i,isFullWidth:r,topMessageSender:c,getCurrentPinnedIndex:l,className:u,chat:h,isSynced:m,shouldHide:p,onPaneStateChange:g,onFocusPinnedMessage:f})=>{const{clickBotInlineButton:I,focusMessage:v,openThread:b,pinMessage:A,loadPinnedMessages:M}=(0,w.ko)(),C=(0,ea.A)(),P=(0,Ka.A)(l),k=Array.isArray(o)?o[P]:o,T=i&&k?i[k]:void 0,F=Array.isArray(o)?o.length:o?1:0,B=Math.max(F-P,1),x=c?(0,y.F9)(C,c):void 0,N=T&&(0,S.zX)(T),R=N?.isGif?N:void 0,J=Boolean(R&&!R.previewPhotoSizes?.length),Y=(0,_o.A)(T),E=(0,Uo.A)(T,J?"full":"pictogram"),D=(0,Ro.A)(E),O=T&&(0,S.y2)(T),L=Boolean((0,Ka.A)(s)),G=(0,Qo.A)([L],450)&&L,V=(0,No.A)(T,!0);(0,qt.vJ)(()=>{m&&(t===n.l3||h?.isForum)&&M({chatId:e,threadId:t})},[e,t,m,h?.isForum]),(0,Xo.A)(e,k,T);const j=Boolean(T)&&!p,{ref:q}=(0,na.A)({isOpen:j,noOpenTransition:!0,shouldForceOpen:r}),{ref:z,shouldRender:H}=(0,Lo.A)({isOpen:j,isDisabled:!r,ref:q,onStateChange:g}),[K,W,_]=(0,os.A)(),X=(0,ta.A)(()=>{_(),A({chatId:e,messageId:T.id,isUnpin:!0})}),$=T&&(0,S.rK)(T),Q=(0,ta.A)(()=>{$&&I({chatId:T.chatId,messageId:T.id,button:$})}),Z=(0,ta.A)(()=>{b({chatId:e,threadId:t,type:"pinned"})}),ee=(0,ta.A)(a=>{const n=a.shiftKey&&Array.isArray(o)?o[(0,eo.A)(o.length,o.indexOf(k)-2)]:k;s()||(v({chatId:e,threadId:t,messageId:n,noForumTopicPanel:!0}),f(n))}),[te,ae,se]=(0,os.A)(),{handleClick:oe,handleMouseDown:ne}=(0,$o.Q)(ee);if(H&&V)return(0,pa.FD)("div",{ref:z,className:(0,Kt.A)("HeaderPinnedMessageWrapper","tE8PJzpv",r?"gutn4asD":"lrBhOgvf",u),children:[(F>1||G)&&(0,pa.FD)(La.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:C("EventLogFilterPinnedMessages"),onClick:G?void 0:Z,children:[L&&(0,pa.Y)(Ms.A,{color:"blue",className:(0,Kt.A)("yvd9_9PF",rn,!G&&dn)}),(0,pa.Y)(Ga.A,{name:"pin-list",className:(0,Kt.A)(rn,G&&dn)})]}),a&&(0,pa.Y)(La.A,{round:!0,size:"smaller",color:"translucent",ariaLabel:C("UnpinMessageAlertTitle"),onClick:W,iconName:"close"}),(0,pa.Y)(an.A,{isOpen:K,onClose:_,text:C("PinnedConfirmUnpin"),confirmLabel:C("DialogUnpin"),confirmHandler:X}),(0,pa.FD)("div",{className:(0,Kt.A)("ayLUtX1S",te&&"WVjde2rq"),onClick:oe,onMouseDown:ne,dir:C.isRtl?"rtl":void 0,children:[(0,pa.Y)(nn,{count:F,index:P}),(0,pa.Y)(Na.Ay,{activeKey:V.id,name:"slideVertical",className:"Gp431jU4",children:function(e,t,a,s){const{width:o,height:n}=(0,U.mr)(),i=t||e,r=a&&t;return(0,pa.FD)("div",{className:"XjjZeOUy",children:[e&&!s&&!r&&(0,pa.Y)("img",{className:cn,src:i,width:o,height:n,alt:"",draggable:!1}),r&&!s&&(0,pa.Y)("video",{src:t,width:o,height:n,playsInline:!0,disablePictureInPicture:!0,className:cn}),e&&(0,pa.Y)(en.A,{thumbDataUri:i,isVisible:Boolean(s),width:o,height:n})]})}(Y,D,J,O)}),(0,pa.FD)("div",{className:(0,Kt.A)("ETMw73qH",Y&&"BWZytkCB"),dir:C.isRtl?"rtl":void 0,children:[(0,pa.FD)("div",{className:"IWpRWVBg",dir:C.isRtl?"rtl":void 0,children:[!x&&(0,pa.Y)(Zo.A,{text:1===F?C("PinnedMessageTitleSingle"):C("PinnedMessageTitle",{index:B},{pluralValue:F})}),x&&(0,ro.A)(x)]}),(0,pa.Y)(Na.Ay,{activeKey:V.id,name:"slideVerticalFade",className:"mA1i07pG",children:(0,pa.Y)("p",{dir:"auto",className:"k19QLKaH",children:(0,pa.Y)(tn.A,{message:V,truncateLength:256,noEmoji:Boolean(Y),emojiSize:ln})})})]}),(0,pa.Y)(Vo.A,{}),$&&(0,pa.Y)(La.A,{size:"tiny",className:"fpQMpARI",onClick:Q,shouldStopPropagation:!0,onMouseEnter:d.TF?void 0:ae,onMouseLeave:d.TF?void 0:se,children:(0,Wo.A)(C,$)})]})]})})),hn=(0,qt.ph)((0,w.EK)((e,{chatId:t,threadId:a,messageListType:s,isMobile:o})=>{const{isLeftColumnShown:i,shouldSkipHistoryAnimations:r,audioPlayer:d,messageLists:c}=(0,C.nTw)(e),l=(0,C.hds)(e,t),u=(0,C.PVB)(e,t),{chatId:h,messageId:m}=d,p=h&&m?(0,C.O5q)(e,h,m):void 0;let g;if("pinned"===s){const s=(0,C.fcC)(e,t,a);g=s?.length}else if("scheduled"===s){const s=(0,C.K3w)(e,t,a);g=s?.length}else if("thread"===s&&a!==n.l3){const s=(0,C.Vw0)(e,t,a);g=s?.messagesCount||0}const f=(0,C.C5H)(e,t,a,"typingStatus"),I=u?.emojiStatus,v=I&&(0,C.O8F)(e,I.documentId),b="collectible"===I?.type?I.slug:void 0,y=(0,S.cG)(t,a,e.currentUserId);return{typingStatus:f,isLeftColumnShown:i,isRightColumnShown:(0,C.gjV)(e,o),isSelectModeActive:(0,C.rTV)(e),audioMessage:p,chat:l,messagesCount:g,isChatWithSelf:(0,C.nZ4)(e,t),shouldSkipHistoryAnimations:r,currentTransitionKey:Math.max(0,c.length-1),connectionState:e.connectionState,isSyncing:e.isSyncing,isFetchingDifference:e.isFetchingDifference,emojiStatusSticker:v,emojiStatusSlug:b,isSavedDialog:y}})(({chatId:e,threadId:t,messageListType:a,isMobile:o,typingStatus:r,isSelectModeActive:c,isLeftColumnShown:l,audioMessage:u,chat:h,messagesCount:m,isComments:p,isChatWithSelf:g,shouldSkipHistoryAnimations:f,currentTransitionKey:I,connectionState:v,isSyncing:b,isFetchingDifference:S,getCurrentPinnedIndex:y,getLoadingPinnedId:A,emojiStatusSticker:M,emojiStatusSlug:C,isSavedDialog:P,onFocusPinnedMessage:T})=>{const{openThreadWithInfo:F,openChat:B,openPreviousChat:U,toggleLeftColumn:x,exitMessageSelectMode:N,openPremiumModal:R,openStickerSet:J,updateMiddleSearch:Y,openUniqueGiftBySlug:E}=(0,w.ko)(),D=(0,Da.A)(),L=(0,qt.li)(!0),{isDesktop:G,isTablet:V}=(0,O.Ay)(),{width:j}=(0,Zs.A)(),q=j<=s.j7z,z=V&&l,H=(0,qt.li)(),K=(0,ta.A)(()=>{Y({chatId:e,threadId:t,update:{}})}),W=(0,ta.A)(a=>{a.target.closest(".title > .custom-emoji")||F({chatId:e,threadId:t,isOwnProfile:!1})}),{onMouseDown:_,onMouseUp:X,onMouseLeave:$,onTouchStart:Q,onTouchEnd:Z}=(0,Co.A)({onStart:K,onClick:W,threshold:500}),ee=(0,ta.A)(()=>{setTimeout(()=>{L.current=!0},450)}),te=(0,ta.A)(()=>{C?E({slug:C}):R({fromUserId:e})}),ae=(0,ta.A)(()=>{C?E({slug:C}):J({stickerSetInfo:M.stickerSetInfo})}),se=(0,ta.A)(e=>{if(L.current){if(L.current=!1,o){const e=document.querySelector(s.m$5);e?.blur()}if(c)return N(),void ee();if("thread"===a&&0===I)return!V||z?(e.stopPropagation(),B({id:void 0},{forceOnHeavyAnimation:!0})):x(),void ee();U(),ee()}}),oe=(0,Qs.A)(I),ne=void 0!==oe&&oe<I?oe:void 0,ie=Boolean(u),re=G&&ie,de=ie||!G,{connectionStatusText:ce}=(0,ss.A)(D,v,b||S,!0);function le(e=!1,t=!1){return(0,pa.FD)("div",{className:"back-button",children:[(0,pa.Y)(La.A,{round:!0,size:"smaller",color:"translucent",onClick:se,ariaLabel:D(e?"Close":"Back"),children:(0,pa.Y)("div",{className:(0,Kt.A)("animated-close-icon",!e&&"state-back")})}),t&&(0,pa.Y)(Ca,{})]})}return(0,pa.FD)("div",{className:"MiddleHeader",ref:H,"data-tauri-drag-region":!(!vt.Vq||!d.MP)||void 0,children:[(0,pa.Y)(Na.Ay,{name:f?"none":"slideFade",activeKey:I,shouldCleanup:!0,cleanupExceptionKey:ne,children:"thread"===a&&(t===n.l3||P||h?.isForum)?function(){const a=P?D("SavedMessages"):void 0,s=P?String(t):e,o=h?.isMonoforum?h.linkedMonoforumId:s;return(0,pa.FD)(pa.FK,{children:[(q||I>0)&&le(z,!P),(0,pa.Y)("div",{className:"chat-info-wrapper",onMouseDown:_,onMouseUp:X,onMouseLeave:$,onTouchStart:Q,onTouchEnd:Z,children:(0,k.L8)(o)?(0,pa.Y)(ko.A,{userId:o,threadId:P?void 0:t,typingStatus:r,status:ce||a,withDots:Boolean(ce),withFullInfo:t===n.l3,withMediaViewer:t===n.l3,withStory:!g,withUpdatingStatus:!0,isSavedDialog:P,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,noRtl:!0,onEmojiStatusClick:te},o):(0,pa.Y)(Po.A,{chatId:o,threadId:P?void 0:t,typingStatus:r,withMonoforumStatus:h?.isMonoforum,status:ce||a,withDots:Boolean(ce),withMediaViewer:t===n.l3,withFullInfo:t===n.l3,withUpdatingStatus:!0,withStory:!0,isSavedDialog:P,storyViewerOrigin:i.G9.MiddleHeaderAvatar,emojiStatusSize:22,onEmojiStatusClick:ae,noRtl:!0},o)})]})}():(0,pa.FD)(pa.FK,{children:[le(),(0,pa.Y)("h3",{children:void 0!==m?"thread"===a?m?D(p?"Comments":"Replies",m,"i"):D(p?"CommentsTitle":"RepliesTitle"):"pinned"===a?D("PinnedMessagesCount",m,"i"):"scheduled"===a?g?D("Reminders"):D("messages",m,"i"):void 0:D("Loading")})]})}),!de&&(0,pa.Y)(un,{chatId:e,threadId:t,messageListType:a,onFocusPinnedMessage:T,getLoadingPinnedId:A,getCurrentPinnedIndex:y},e),(0,pa.FD)("div",{className:"header-tools",children:[re&&(0,pa.Y)(Ko,{}),(0,pa.Y)(To.A,{chatId:e,threadId:t,messageListType:a,isMobile:o,canExpandActions:!re})]})]})}));var mn=a(15283),pn=a(5718),gn=a(63744),fn=a(81949),In=a(86070),vn=a(89873);const bn={root:"yMkfzjus",content:"__w9Ejd3",info:"wdU19Be7",avatar:"AQFE1t4V",title:"u2vIptvT",text:"SVG6BaX3",aboutAd:"SrgXYpPk"},Sn=(0,qt.ph)((0,w.EK)((e,{chatId:t})=>{const a=(0,C.yps)(e,t),s=(0,C.v8U)(e,t);return{isBot:Boolean(a),sponsoredMessage:s}})(({chatId:e,isBot:t,messageListType:a,sponsoredMessage:s,onPaneStateChange:o})=>{const{viewSponsored:n,openUrl:i,clickSponsored:r,openAboutAdsModal:d}=(0,w.ko)(),c=(0,ea.A)(),l=Boolean(t&&s&&"thread"===a),u=(0,No.A)(s),{ref:h,shouldRender:m}=(0,Lo.A)({isOpen:l,withResizeObserver:!0,onStateChange:o}),{isContextMenuOpen:p,contextMenuAnchor:g,handleBeforeContextMenu:f,handleContextMenu:I,handleContextMenuClose:v,handleContextMenuHide:b}=(0,vo.A)(h,!m,!0),S=(0,ta.A)(()=>{s&&(r({randomId:s.randomId}),i({url:s.url,shouldSkipModal:!0}))}),y=(0,ta.A)(e=>{if(!s)return;const{randomId:t,additionalInfo:a,canReport:o,sponsorInfo:n}=s;e.stopPropagation(),d({randomId:t,additionalInfo:a,canReport:o,sponsorInfo:n})});if((0,qt.vJ)(()=>{m&&u&&n({randomId:u.randomId})},[m,u,e]),!m||!u)return;const{randomId:A,canReport:M,additionalInfo:C,sponsorInfo:P}=u,{peerColor:k,content:T,photo:F,title:B}=u;return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("div",{ref:h,className:bn.root,onClick:S,onMouseDown:f,onContextMenu:I,children:(0,pa.FD)(In.A,{peerColor:k,noBar:!0,className:bn.content,children:[F&&(0,pa.Y)(ps.A,{size:"medium",photo:F,className:bn.avatar}),(0,pa.FD)("div",{className:bn.contentInner,children:[(0,pa.FD)("span",{className:bn.info,children:[c("SponsoredMessageAd"),(0,pa.Y)(fn.A,{onClick:y,className:bn.aboutAd,children:c("SponsoredMessageAdWhatIsThis")})]}),(0,pa.Y)("div",{className:bn.title,children:B}),T.text&&(0,pa.Y)("div",{className:bn.text,children:(0,_a.fd)({text:T.text.text,entities:T.text.entities})})]})]})}),g&&(0,pa.Y)(vn.A,{isOpen:p,anchor:g,triggerRef:h,randomId:A,additionalInfo:C,canReport:M,sponsorInfo:P,onClose:v,onCloseAnimationEnd:b})]})})),yn=(0,qt.ph)((0,w.EK)((e,{peerId:t})=>{const a=(0,C.kBv)(e,t),s=a?.botVerification;return{botVerification:s,wasShown:e.settings.botVerificationShownPeerIds.includes(t)}})(({peerId:e,wasShown:t,botVerification:a,onPaneStateChange:s})=>{const o=Boolean(!t&&a),{markBotVerificationInfoShown:n}=(0,w.ko)(),{ref:i,shouldRender:r}=(0,Lo.A)({isOpen:o,onStateChange:s}),d=(0,ta.A)(()=>{n({peerId:e})});if((0,Qt.A)(d,t?void 0:5e3),r&&a)return(0,pa.FD)("div",{ref:i,className:"sAWttcxl",children:[(0,pa.Y)("span",{className:"tK9d2y8u",children:(0,pa.Y)(ks.A,{documentId:a.iconId,size:16})}),a.description]})}));var wn=a(19806);const An=(0,qt.ph)((0,w.EK)((e,{chatId:t})=>({currentUserId:e.currentUserId,peer:(0,C.PVB)(e,t)}))(({chatId:e,className:t,isAutoArchived:a,canReportSpam:s,canAddContact:o,canBlockContact:n,peer:i,currentUserId:r,onPaneStateChange:d})=>{const{openAddContactDialog:c,blockUser:l,reportSpam:u,deleteChat:h,leaveChannel:m,deleteChatUser:p,deleteHistory:g,toggleChatArchived:f,hidePeerSettingsBar:I}=(0,w.ko)(),v=(0,Da.A)(),[b,A,M]=(0,os.A)(),[C,P]=(0,qt.J0)(!0),[k,T]=(0,qt.J0)(!0),F=(0,No.A)(i),B=F&&(0,y.vj)(F)?F:void 0,U=F&&(0,y.mO)(F)?F:void 0,x=B&&(0,S.yn)(B),N=(0,No.A)(o),R=(0,No.A)(n),J=(0,No.A)(s),Y=(0,No.A)(a),E=(0,ta.A)(()=>{c({userId:e}),Y&&f({id:e})}),D=(0,ta.A)(()=>{M(),l({userId:e}),J&&C&&u({chatId:e}),k&&h({chatId:e})}),O=(0,ta.A)(()=>{I({peerId:e})}),L=(0,ta.A)(()=>{M(),u({chatId:e}),x?(p({chatId:e,userId:r}),g({chatId:e,shouldDeleteForAll:!1})):m({chatId:e})}),G=Boolean((o||n||s)&&i);(0,qt.vJ)(()=>{G||M()},[G]);const{ref:V,shouldRender:j}=(0,Lo.A)({isOpen:G,onStateChange:d});if(j)return(0,pa.FD)("div",{ref:V,className:(0,Kt.A)("ChatReportPane",t),dir:v.isRtl?"rtl":void 0,children:[N&&(0,pa.Y)(La.A,{isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:E,children:v("lng_new_contact_add")}),R&&(0,pa.Y)(La.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:v("lng_new_contact_block")}),J&&!R&&(0,pa.Y)(La.A,{color:"danger",isText:!0,fluid:!0,size:"tiny",className:"ChatReportPane--Button",onClick:A,children:v("lng_report_spam_and_leave")}),(0,pa.Y)(La.A,{round:!0,ripple:!0,size:"smaller",color:"translucent",onClick:O,ariaLabel:v("Close"),iconName:"close"}),(0,pa.FD)(an.A,{isOpen:b,onClose:M,title:v("BlockUserTitle",U?(0,S.u0)(U):(0,S.Js)(v,B)),text:U?v("UserInfo.BlockConfirmationTitle",(0,S.Yg)(U)):v("Chat.Confirm.ReportSpam.Channel"),confirmIsDestructive:!0,confirmLabel:v("Block"),confirmHandler:U?D:L,children:[U&&(0,pa.Y)(wn.A,{className:"dialog-checkbox",label:v("DeleteThisChat"),checked:k,onCheck:T}),U&&s&&(0,pa.Y)(wn.A,{className:"ChatReportPane--Checkbox dialog-checkbox",label:v("ReportChat"),checked:C,onCheck:P})]})]})})),Mn={root:"xqcWnBH4",message:"CJhqoyif",messageStars:"sZR8zqEk",messageStarIcon:"AKXOpk8S"},Cn=(0,qt.ph)((0,w.EK)((e,{peerId:t})=>{const a=(0,C.hds)(e,t),s=(0,C.vGo)(e,t),o=s?.settings?.chargedPaidMessageStars;return{chargedPaidMessageStars:o,chat:a}})(({chargedPaidMessageStars:e,chat:t,peerId:a,onPaneStateChange:s})=>{const o=Boolean(e),n=(0,ea.A)(),{openChatRefundModal:i}=(0,w.ko)(),{ref:r,shouldRender:d}=(0,Lo.A)({isOpen:o,onStateChange:s}),c=(0,ta.A)(()=>{i({userId:a})});if(!d||!e)return;const l=n("PaneMessagePaidMessageCharge",{peer:t?(0,y.F9)(n,t):void 0,amount:(0,g.U2)(n,e,{asFont:!0,className:Mn.messageStarIcon,containerClassName:Mn.messageStars})},{withMarkdown:!0,withNodes:!0});return(0,pa.FD)("div",{ref:r,className:Mn.root,children:[(0,pa.Y)("div",{className:Mn.message,children:l}),(0,pa.Y)(La.A,{isText:!0,noForcedUpperCase:!0,pill:!0,fluid:!0,size:"tiny",className:Mn.button,onClick:c,children:n("RemoveFeeTitle")})]})})),Pn={height:0},kn=(0,qt.ph)((0,w.EK)((e,{chatId:t})=>{const{audioPlayer:a}=(0,C.nTw)(e),s=(0,C.hds)(e,t),o=(0,C.vGo)(e,t),{chatId:n,messageId:i}=a,r=n&&i?(0,C.O5q)(e,n,i):void 0,d=Boolean((0,C.TCk)(e));return{chat:s,userFullInfo:o,isAudioPlayerRendered:Boolean(r),isMiddleSearchOpen:d,withRightColumnAnimation:(0,C.MBp)(e)}})(({className:e,chatId:t,threadId:a,messageListType:s,chat:o,userFullInfo:i,getCurrentPinnedIndex:r,getLoadingPinnedId:d,isAudioPlayerRendered:c,isMiddleSearchOpen:l,withRightColumnAnimation:u,onFocusPinnedMessage:h})=>{const{settings:m}=i||{},{isDesktop:p}=(0,O.Ay)(),[g,f]=(0,qt.Ul)(Pn),[I,v]=(0,qt.Ul)(Pn),[b,S]=(0,qt.Ul)(Pn),[y,w]=(0,qt.Ul)(Pn),[A,M]=(0,qt.Ul)(Pn),[C,P]=(0,qt.Ul)(Pn),[k,T]=(0,qt.Ul)(Pn),F=c||!p,B=(0,qt.li)(!0),{shouldRender:U,ref:x}=(0,na.A)({isOpen:!l,withShouldRender:!0,noMountTransition:!0});if((0,mn.A)(()=>{B.current=!1}),(0,pn.R)(()=>{const e=g(),t=C(),a=I(),s=[e,b(),y(),t,a,A(),k()],o=B.current,n=s.reduce((e,t)=>e+t.height,0),i=document.getElementById("MiddleColumn");i&&((0,Lo.S)({list:s,noTransition:o}),(0,zt.Tv)(i,{"--middle-header-panes-height":`${n}px`}))},[g,b,I,y,A,C,k]),U)return(0,pa.FD)("div",{ref:x,className:(0,Kt.A)("oCUr3DTX",u&&"YPrc0luK",e),children:[(0,pa.Y)(Ko,{isFullWidth:!0,onPaneStateChange:f,isHidden:p}),a===n.l3&&!o?.isForum&&(0,pa.Y)(gn.A,{chatId:t,onPaneStateChange:S}),(0,pa.Y)(An,{chatId:t,canAddContact:m?.canAddContact,canBlockContact:m?.canBlockContact,canReportSpam:m?.canReportSpam,isAutoArchived:m?.isAutoArchived,onPaneStateChange:w}),(0,pa.Y)(yn,{peerId:t,onPaneStateChange:P}),(0,pa.Y)(Cn,{peerId:t,onPaneStateChange:T}),(0,pa.Y)(un,{chatId:t,threadId:a,messageListType:s,onFocusPinnedMessage:h,getLoadingPinnedId:d,getCurrentPinnedIndex:r,onPaneStateChange:v,isFullWidth:!0,shouldHide:!F}),(0,pa.Y)(Sn,{chatId:t,messageListType:s,onPaneStateChange:M})]})}));var Tn=a(96530);const Fn=(0,qt.ph)((0,w.EK)((e,{userId:t})=>{const a=(0,C.mBe)(e,t);return{userName:(0,S.u0)(a)}})(function({userName:e}){const t=(0,Da.A)(),{openPremiumModal:a}=(0,w.ko)(),s=(0,ta.A)(()=>a());return(0,pa.FD)("div",{children:[(0,pa.Y)("div",{children:t("Chat.MessagingRestrictedPlaceholder",e)}),(0,pa.Y)(Tn.A,{isPrimary:!0,onClick:s,children:t("Chat.MessagingRestrictedPlaceholderAction")})]})})),Bn=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ReactorListModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},Un=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"MiddleSearch",!t,!0);return a?(0,pa.Y)(a,{...e}):void 0},xn=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SummarizePage",!t,!0);return a?(0,pa.Y)(a,{...e}):void 0},Nn={root:"KbhmK36p",content:"kCvS09qd",greetingText:"lF3eQNBN",welcomePromptCard:"zMqkKose",welcomePromptContainer:"EUM3wEfM",loginPrompt:"ShUxC5rb",loginText:"NkoXBncH",welcomeInput:"v3JmabWu",promptCard:"ffxVvPPS",promptContainer:"S5D3OP1Y",input:"Qo8cfNvR",actionBar:"es7gPJIW",actionBarLeft:"BU27C5Xa",actionBarRight:"l6n85iiN",actionIcon:"fRvYUjOf",modelSelector:"jElBYUZJ",sendButton:"y6axZfaQ",sendButtonActive:"SJWwoV96",summariesCard:"TEv1UL8T",summariesContent:"eiKPCXx9",summariesText:"NV1G3acJ",summariesButton:"bKe6Elfi",toolsCard:"np_tdeGR",suggestions:"dVuJsRZO",suggestionsTitle:"zUKYDoW_",suggestionsList:"YliHv0jd",suggestionItem:"eCzFzEph",toolsText:"Qgb6_sOC",toolsIcons:"E_flBUpH",toolIcon:"xojMp6q5",toolIconLoading:"YT5B7kTZ",spin:"yLmGZFzA",toolIconConnected:"g_BSEU9A",connectedCheck:"KHU0kDyt",historyFab:"o4WXth7e",conversationView:"hgRxhe8Q",conversationContent:"c7lE8AOs",messagesContainer:"Tw1G8Map",messageWrapper:"KMJu8rVd",messageOutgoing:"kdXu50Tm",messageAvatar:"y4ys_zCu",aiAvatar:"g902s37O",messageBubble:"XB0DLrjf",messageBubbleUser:"IyBKD89N",messageContent:"uZkT5BsN",messageTime:"dxTA8DfX",messageBubbleAgent:"eFScSsE3",regenerateButtonContainer:"nw3inIma",regenerateButton:"zSOpozJT",inputWrapper:"zQCzsu0Q",attachButton:"bNbjxtCz",sendButtonPurple:"g8hVKZZ_",timerButton:"T1LjDGIS",toolIndicators:"jBgL5mVH",toolIndicator:"_ES9YIyW",toolName:"i_UTd1xN",toolStatus:"NIM5faWc",loginButtonContainer:"xZniMd8r",loginButton:"prtmQ3iI",benefitIcon:"LgqfTS0b",inputGroup:"XvYfSL8q",errorMessage:"uxJ78Hpz"},Rn=(0,qt.ph)((0,w.EK)(e=>({socketState:e.alphahuman?.socketState,streamingContent:e.alphahuman?.streamingContent,isStreaming:e.alphahuman?.isStreaming,activeTools:e.alphahuman?.activeTools,threads:(0,la.Z)(e)}))(({className:e,socketState:t,streamingContent:a,isStreaming:s,activeTools:o,threads:n})=>{const{streamAlphaHumanMessage:i}=(0,w.ko)(),r=(0,qt.li)(),d=(0,qt.li)(),[c,l]=(0,qt.J0)(""),u=(0,qt.hb)(()=>{const e=r.current;e&&(d.current&&cancelAnimationFrame(d.current),d.current=requestAnimationFrame(()=>{const t=e.scrollHeight;(0,Ht.RK)(()=>{e.scrollTop=t})}))},[]),h=n?.activeThreadId,m=h?n?.byId[h]:void 0,p=(0,qt.Kr)(()=>m?.messages||[],[m?.messages]),g=Boolean(s&&!a),[f,I]=(0,qt.J0)(""),v=(0,qt.li)();(0,qt.vJ)(()=>(v.current&&cancelAnimationFrame(v.current),v.current=requestAnimationFrame(()=>{I(a||"")}),()=>{v.current&&cancelAnimationFrame(v.current)}),[a]);const b=(0,ta.A)(e=>{l(e.target.value)}),S=(0,ta.A)(()=>{if(!c.trim())return;const e=c.trim();l(""),i({threadId:h,content:e})}),y=(0,ta.A)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S())});(0,qt.vJ)(()=>{u()},[p,f,g,u]);const A=(0,qt.hb)(e=>{const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const s=Math.floor(a/60);return s<24?`${s}h ago`:e.toLocaleDateString()},[]);return(0,pa.Y)("div",{className:(0,Kt.A)(Nn.root,Nn.conversationView,e),children:(0,pa.FD)("div",{className:Nn.conversationContent,children:[(0,pa.FD)("div",{ref:r,className:Nn.messagesContainer,children:[p.map(e=>(0,pa.FD)("div",{className:(0,Kt.A)(Nn.messageWrapper,"user"===e.sender&&Nn.messageOutgoing),children:["agent"===e.sender&&(0,pa.Y)("div",{className:Nn.messageAvatar,children:(0,pa.Y)("div",{className:Nn.aiAvatar,children:"AI"})}),(0,pa.FD)("div",{className:(0,Kt.A)(Nn.messageBubble,"user"===e.sender?Nn.messageBubbleUser:Nn.messageBubbleAgent),children:[(0,pa.Y)("div",{className:Nn.messageContent,children:"agent"===e.sender?(0,ro.A)(e.content,["emoji","br","simple_markdown","links"]):e.content}),(0,pa.FD)("div",{className:Nn.messageTime,children:["user"===e.sender&&" ",A(e.timestamp)]})]})]},e.id)),f&&(0,pa.FD)("div",{className:Nn.messageWrapper,children:[(0,pa.Y)("div",{className:Nn.messageAvatar,children:(0,pa.Y)("div",{className:Nn.aiAvatar,children:"AI"})}),(0,pa.Y)("div",{className:(0,Kt.A)(Nn.messageBubble,Nn.messageBubbleAgent),children:(0,pa.Y)("div",{className:Nn.messageContent,children:(0,ro.A)(f,["emoji","br","simple_markdown","links"])})})]}),g&&!f&&(0,pa.FD)("div",{className:Nn.messageWrapper,children:[(0,pa.Y)("div",{className:Nn.messageAvatar,children:(0,pa.Y)("div",{className:Nn.aiAvatar,children:"AI"})}),(0,pa.Y)("div",{className:(0,Kt.A)(Nn.messageBubble,Nn.messageBubbleAgent),children:(0,pa.Y)("div",{className:Nn.messageContent,children:"Thinking..."})})]})]}),(0,pa.Y)("div",{className:Nn.promptCard,children:(0,pa.FD)("div",{className:Nn.promptContainer,children:[(0,pa.Y)("textarea",{className:Nn.input,placeholder:"Message...",value:c,onChange:b,onKeyDown:y,rows:1,disabled:g}),(0,pa.Y)("button",{className:(0,Kt.A)(Nn.sendButton,Nn.sendButtonPurple,c.trim()&&Nn.sendButtonActive),onClick:S,disabled:!c.trim()||g,type:"button","aria-label":"Send",children:(0,pa.Y)("i",{className:"icon icon-send"})})]})})]})})})),Jn=(0,qt.ph)(({currentUserFirstName:e,isLoggingIn:t,onLoginClick:a})=>{const s=(0,ea.A)(),o=(0,ta.A)(()=>{const e=(new Date).getHours();return s(e<12?"MiddleWelcomeGoodMorning":e<17?"MiddleWelcomeGoodAfternoon":"MiddleWelcomeGoodEvening")}),n=e?String(e):s("MiddleWelcomeUser");return(0,pa.FD)("div",{className:Nn.content,children:[(0,pa.Y)("div",{className:Nn.greeting,children:(0,pa.FD)("h1",{className:Nn.greetingText,children:[o(),",",n,"! Let's cook. "]})}),(0,pa.Y)("div",{className:Nn.welcomePromptCard,children:(0,pa.Y)("div",{className:Nn.welcomePromptContainer,children:(0,pa.FD)("div",{className:Nn.loginPrompt,children:[(0,pa.Y)("p",{className:Nn.loginText,children:"Connect your Telegram account to start using AlphaHuman"}),(0,pa.FD)(La.A,{className:Nn.loginButton,onClick:a,color:"primary",disabled:t,children:[(0,pa.Y)(Ga.A,{name:"user"}),(0,pa.Y)("span",{children:t?"Verifying...":"Login"})]})]})})})]})}),Yn=a.p+"notion.8cffeea5f32beb3730c8.png",En=a.p+"google.8f1b29da797222fb6fa1.png",Dn=(0,qt.ph)((0,w.EK)(e=>({notionOAuth:e.alphahuman?.notionOAuth,googleOAuth:e.alphahuman?.googleOAuth}))(({currentUserFirstName:e,chatIds:t,chats:a,inputValue:s,onInputChange:o,onInputSubmit:n,onSuggestionClick:i,onKeyDown:r,notionOAuth:d,googleOAuth:c})=>{const{connectToNotion:l,connectToGoogle:u}=(0,w.ko)(),h=(0,ea.A)(),m=(0,qt.Kr)(()=>{if(!t||0===t.length||!a)return["Help me write a professional email","Summarize my recent conversations","Create a meeting agenda","Draft a project proposal"];const e=[];t.slice(0,20).map(e=>a[e]).filter(Boolean).sort((e,t)=>{const a=(0,S.YE)(e)||(0,S.WX)(e),s=(0,S.YE)(t)||(0,S.WX)(t);return a&&!s?-1:!a&&s?1:0}).slice(0,5).forEach(t=>{if(!t)return;const a=t.title||"this chat";(0,S.YE)(t)||(0,S.WX)(t)?(e.push(`Summarize recent messages in ${a}`),e.push(`What are the key topics discussed in ${a}?`),e.push(`Create action items from ${a}`)):(e.push(`Help me draft a message to ${a}`),e.push(`What should I say to ${a}?`))});const s=["Help me write a professional email","Create a meeting agenda","Draft a project proposal","Summarize my recent conversations"];for(;e.length<4;){const t=s.find(t=>!e.includes(t));if(!t)break;e.push(t)}return e.slice(0,4)},[t,a]),p=(0,ta.A)(()=>{const e=(new Date).getHours();return h(e<12?"MiddleWelcomeGoodMorning":e<17?"MiddleWelcomeGoodAfternoon":"MiddleWelcomeGoodEvening")}),g=(0,ta.A)(()=>{l()}),f=(0,ta.A)(()=>{u()}),I=e?String(e):h("MiddleWelcomeUser");return(0,pa.FD)("div",{className:Nn.content,children:[(0,pa.Y)("div",{className:Nn.greeting,children:(0,pa.FD)("h1",{className:Nn.greetingText,children:[p(),",",I,"! Let's cook. "]})}),(0,pa.Y)("div",{className:Nn.welcomePromptCard,children:(0,pa.FD)("div",{className:Nn.welcomePromptContainer,children:[(0,pa.Y)("textarea",{className:Nn.welcomeInput,placeholder:"What shall we do today?",value:s,onChange:o,onKeyDown:r,rows:1}),(0,pa.FD)("div",{className:Nn.actionBar,children:[(0,pa.Y)("div",{className:Nn.actionBarLeft}),(0,pa.Y)("div",{className:Nn.actionBarRight,children:(0,pa.Y)("button",{className:(0,Kt.A)(Nn.sendButton,s.trim()&&Nn.sendButtonActive),onClick:n,disabled:!s.trim(),type:"button","aria-label":"Send",children:(0,pa.Y)("i",{className:"icon icon-send"})})})]})]})}),(0,pa.FD)("div",{className:Nn.toolsCard,children:[(0,pa.Y)("span",{className:Nn.toolsText,children:"Connect your tools to get more done"}),(0,pa.FD)("div",{className:Nn.toolsIcons,children:[(0,pa.FD)("div",{className:(0,Kt.A)(Nn.toolIcon,d?.isConnecting&&Nn.toolIconLoading,d?.isConnected&&Nn.toolIconConnected),title:d?.isConnected?"Notion - Connected":d?.isConnecting?"Notion - Connecting...":"Connect to Notion",onClick:d?.isConnecting?void 0:g,children:[d?.isConnecting?(0,pa.Y)("i",{className:"icon icon-spinner"}):(0,pa.Y)("img",{src:Yn,alt:"Notion"}),d?.isConnected&&(0,pa.Y)("i",{className:(0,Kt.A)("icon","icon-check",Nn.connectedCheck)})]}),(0,pa.FD)("div",{className:(0,Kt.A)(Nn.toolIcon,c?.isConnecting&&Nn.toolIconLoading,c?.isConnected&&Nn.toolIconConnected),title:c?.isConnected?"Google - Connected":c?.isConnecting?"Google - Connecting...":"Connect to Google",onClick:c?.isConnecting?void 0:f,children:[c?.isConnecting?(0,pa.Y)("i",{className:"icon icon-spinner"}):(0,pa.Y)("img",{src:En,alt:"Google"}),c?.isConnected&&(0,pa.Y)("i",{className:(0,Kt.A)("icon","icon-check",Nn.connectedCheck)})]}),(0,pa.Y)("i",{className:"icon icon-chevron-right"})]})]}),(0,pa.FD)("div",{className:Nn.suggestions,children:[(0,pa.Y)("div",{className:Nn.suggestionsTitle,children:"Here are a few ideas to get you started"}),(0,pa.Y)("div",{className:Nn.suggestionsList,children:m.map((e,t)=>(0,pa.FD)("div",{className:Nn.suggestionItem,onClick:()=>i(e),children:['"',e,'"']},t))})]})]})})),On=(0,qt.ph)(({currentUserFirstName:e,chatIds:t,chats:a,inputValue:s,onInputChange:o,onInputSubmit:n,onSuggestionClick:i,onKeyDown:r,hasJwtToken:d,isLoggingIn:c,onLoginClick:l})=>d?(0,pa.Y)(Dn,{currentUserFirstName:e,chatIds:t,chats:a,inputValue:s,onInputChange:o,onInputSubmit:n,onSuggestionClick:i,onKeyDown:r}):(0,pa.Y)(Jn,{currentUserFirstName:e,isLoggingIn:c,onLoginClick:l})),Ln=(0,qt.ph)((0,w.EK)(e=>{const{currentUserId:t}=e,a=t?(0,C.mBe)(e,t):void 0,s=e.chats.listIds.active?.slice(0,20)||[];return{currentUserId:t,currentUserFirstName:a?.firstName,currentUser:a,chatIds:s,chats:e.chats.byId,socketState:e.alphahuman?.socketState,threads:e.alphahuman?.threads,hasJwtToken:!!e.alphahuman?.jwtToken,isLoggingIn:e.alphahuman?.isLoggingIn||!1}})(({className:e,currentUserFirstName:t,chatIds:a,chats:s,hasJwtToken:o,isLoggingIn:n})=>{const r=(0,w.ko)(),[d,c]=(0,qt.J0)(""),[l,u]=(0,qt.J0)(!1),h=(0,ta.A)(e=>{c(e.target.value)}),m=(0,ta.A)(()=>{if(!d.trim())return;const e=d.trim();u(!0),c(""),r.streamAlphaHumanMessage({threadId:void 0,content:e})}),p=(0,ta.A)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m())}),g=(0,ta.A)(e=>{c(e);const t=document.querySelector(`.${Nn.welcomeInput}`);t&&t.focus()}),f=(0,ta.A)(()=>{r.startAlphaHumanLogin()}),I=(0,w.mS)().alphahuman?.activeThreadId,v=I?(0,w.mS)()?.alphahuman?.threadMessages?.[I]:void 0,b=v?.messages&&v.messages.length>0;return l||b?(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(Rn,{className:e}),(0,pa.Y)("div",{className:Nn.historyFab,children:(0,pa.Y)(La.A,{round:!0,color:"primary",onClick:()=>r.openLeftColumnContent({contentKey:i.Bn.Threads}),ariaLabel:"Show thread history",children:(0,pa.Y)(Ga.A,{name:"clock"})})})]}):(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("div",{className:(0,Kt.A)(Nn.root,e),children:(0,pa.Y)(On,{currentUserFirstName:t,chatIds:a,chats:s,inputValue:d,onInputChange:h,onInputSubmit:m,onSuggestionClick:g,onKeyDown:p,hasJwtToken:o,isLoggingIn:n,onLoginClick:f})}),(0,pa.Y)("div",{className:Nn.historyFab,children:(0,pa.Y)(La.A,{round:!0,color:"primary",onClick:()=>r.openLeftColumnContent({contentKey:i.Bn.Threads}),ariaLabel:"Show thread history",children:(0,pa.Y)(Ga.A,{name:"clock"})})})]})}));var Gn=a(38353);const Vn=450+s.xB5,jn=(0,qt.ph)((0,w.EK)((e,{isMobile:t})=>{const a=(0,C.SJA)(e),{isBlurred:o,background:i,backgroundColor:r,patternColor:d}=(0,C.Gyz)(e,a)||{},{messageLists:c,isLeftColumnShown:l,activeEmojiInteractions:u,seenByModal:h,reactorModal:m,shouldSkipHistoryAnimations:p,chatLanguageModal:g,privacySettingsNoticeModal:f}=(0,C.nTw)(e),I=(0,C.Xf0)(e),{leftColumnWidth:v}=e,b={theme:a,customBackground:i,backgroundColor:r,patternColor:d,actionMessageBg:(0,C.bdt)(e),isLeftColumnShown:l,isRightColumnShown:(0,C.gjV)(e,t),isBackgroundBlurred:o,hasActiveMiddleSearch:Boolean((0,C.TCk)(e)),isSummarizePageOpen:(0,C.bL7)(e),isAlphaHumanThreadOpen:(0,C.aGO)(e),alphaHumanThreadId:(0,C.BMJ)(e),isSelectModeActive:(0,C.rTV)(e),isSeenByModalOpen:Boolean(h),isPrivacySettingsNoticeModalOpen:Boolean(f),isReactorListModalOpen:Boolean(m),isChatLanguageModalOpen:Boolean(g),animationLevel:(0,je.lS)(e).animationLevel,withInterfaceAnimations:(0,C.PKK)(e),withRightColumnAnimation:(0,C.MBp)(e),currentTransitionKey:Math.max(0,c.length-1),activeEmojiInteractions:u,leftColumnWidth:v};if(!I)return b;const{chatId:y,threadId:w,type:A}=I,M=!!y&&(0,k.L8)(y),P=(0,C.hds)(e,y),T=(0,C.yps)(e,y),F=(0,C.fcC)(e,y,w),B=y?(0,C.AWZ)(e,y):void 0,U=y?(0,C.vGo)(e,y):void 0,x=(0,C.Ys6)(e,y,w),N=(0,C.Vw0)(e,y,w),R=Boolean(!N?.isCommentsInfo&&N?.fromChannelId),J=(0,C.S0q)(e,y,w),Y=P&&(0,S.__)(P,J,R,B),E=(0,C.I_m)(e,y),D="pinned"===A,O="thread"===A&&w===n.l3,L=Boolean(P&&(0,S.WX)(P)),G=Boolean(P&&O&&(L||(0,S.Vs)(P))&&P.isNotJoined&&!P.joinRequests&&!P.isMonoforum),V=Boolean(P?.isNotJoined&&P.isJoinToSend),j=Boolean(P?.isNotJoined&&P.isJoinRequest),q=!!M&&(0,C.apd)(e,y),z=Boolean(T&&q),H=!z&&E,K=q&&!T,W=Boolean(P&&(0,S.YE)(P)&&!B),_=(0,C.GA4)(e,y,w)?.replyInfo,X=!!P?.isForum&&w===n.l3&&!_&&(0,C.S0q)(e,y,s.HxB)?.isClosed,$=(0,C.ODG)(e,y),Q=Boolean(P?.isMonoforum&&!_&&$&&!x),Z=(0,C.pSx)(e,y),ee=(0,S.cG)(y,w,e.currentUserId),te=ee&&w!==s.Ckz,ae=P&&(M||P?.isCreator||!L&&!(0,S.Sq)(P,"pinMessages")||(0,S.ub)(P,"pinMessages")),se=y?(0,C.vGo)(e,y):void 0,oe=se?.isContactRequirePremium,ne=y?(0,C.WA9)(e,y):void 0,ie=(0,C.trm)(e),re=e.botFreezeAppealId,de=re?(0,C.hds)(e,re):void 0;return{...b,chatId:y,threadId:w,messageListType:A,chat:P,draftReplyInfo:_,isPrivate:M,arePeerSettingsLoaded:Boolean(U?.settings),isComments:R,canPost:!D&&(!P||Y)&&!E&&!(V&&P?.isNotJoined)&&!X&&!Q&&!ee&&(!ie||de?.id===y),isPinnedMessageList:D,currentUserBannedRights:P?.currentUserBannedRights,defaultBannedRights:P?.defaultBannedRights,pinnedMessagesCount:F?F.length:0,shouldSkipHistoryAnimations:p,isChannel:L,canSubscribe:G,canStartBot:H,canRestartBot:z,shouldJoinToSend:V,shouldSendJoinRequest:j,shouldLoadFullChat:W,pinnedIds:F,canUnpin:ae,canUnblock:K,isSavedDialog:ee,canShowOpenChatButton:te,isContactRequirePremium:oe,topics:Z,paidMessagesStars:ne,isAccountFrozen:ie,freezeAppealChat:de,shouldBlockSendInMonoforum:Q}})(function({leftColumnRef:e,chatId:t,threadId:a,isComments:o,messageListType:n,isMobile:i,chat:r,draftReplyInfo:c,isPrivate:l,isPinnedMessageList:u,canPost:m,currentUserBannedRights:p,defaultBannedRights:g,pinnedMessagesCount:f,customBackground:I,theme:v,backgroundColor:b,patternColor:y,actionMessageBg:A,isLeftColumnShown:M,isRightColumnShown:P,isBackgroundBlurred:k,leftColumnWidth:T,hasActiveMiddleSearch:F,isSummarizePageOpen:B,isAlphaHumanThreadOpen:E,alphaHumanThreadId:D,isSelectModeActive:L,isSeenByModalOpen:G,isPrivacySettingsNoticeModalOpen:V,isReactorListModalOpen:j,isChatLanguageModalOpen:q,animationLevel:z,withInterfaceAnimations:H,withRightColumnAnimation:K,shouldSkipHistoryAnimations:W,currentTransitionKey:_,isChannel:X,arePeerSettingsLoaded:$,canSubscribe:Q,canStartBot:Z,canRestartBot:ee,activeEmojiInteractions:te,shouldJoinToSend:ae,shouldSendJoinRequest:se,shouldLoadFullChat:oe,pinnedIds:ne,canUnpin:ie,canUnblock:re,isSavedDialog:de,canShowOpenChatButton:ce,isContactRequirePremium:le,topics:ue,paidMessagesStars:he,isAccountFrozen:me,freezeAppealChat:pe,shouldBlockSendInMonoforum:ge}){const{openChat:fe,openPreviousChat:Ie,unpinAllMessages:ve,loadUser:be,loadPeerSettings:Se,exitMessageSelectMode:ye,joinChannel:we,sendBotCommand:Ae,restartBot:Me,showNotification:Ce,loadFullChat:Pe,setLeftColumnWidth:ke,resetLeftColumnWidth:Te,unblockUser:Fe}=(0,w.ko)(),{width:Be}=(0,Zs.A)(),{isTablet:Ue,isDesktop:xe}=(0,O.Ay)(),Ne=(0,Da.A)(),Re=(0,ea.A)(),[Je,Ye]=(0,qt.J0)(fo.I.None),[Ee,De]=(0,qt.J0)(!1),Oe=Ee&&(!i||!F),[Le,Ge]=(0,qt.J0)(),[Ve,je]=(0,qt.J0)(!1),{handleIntersectPinnedMessage:qe,handleFocusPinnedMessage:ze,getCurrentPinnedIndex:He,getLoadingPinnedId:Ke}=function(e,t,a){const[s,o]=(0,qt.Ul)({}),[n,i]=(0,qt.Ul)(),r=e?`${e}_${t}`:void 0,d=(0,to.A)(()=>s()[r]??0,[s,r]);return(0,qt.vJ)(()=>{ao=void 0,i(void 0)},[e,o,i,t]),(0,qt.vJ)(()=>{if(!r)return;const e=s()[r],t=a?.length||0;e>=t&&o({...s(),[r]:oo(t-1)})},[s,r,a?.length,o]),{handleIntersectPinnedMessage:(0,ta.A)(({viewportPinnedIdsToAdd:d=[],viewportPinnedIdsToRemove:c=[],shouldCancelWaiting:l})=>{if(!(e&&t&&r&&a?.length))return;if(l)return so=void 0,void i(void 0);const u=n();if(u){const e=a.indexOf(u);o({...s(),[r]:oo(e)}),i(void 0)}ao=(0,h.Am)((ao?.filter(e=>!c.includes(e))??[]).concat(d));const m=(0,C.kdX)((0,w.mS)(),e)||so;if(so&&ao.includes(so)&&(so=void 0),m){const e=a.findIndex(e=>e<m);o({...s(),[r]:oo(e)})}else if(ao.length){const e=Math.max(...ao),t=a.indexOf(e);o({...s(),[r]:oo(t)})}}),handleFocusPinnedMessage:(0,ta.A)(n=>{if(!e||!t||!a?.length)return;so=n;const d=(0,w.mS)(),c=(0,C.gCU)(d,e,t),l=c?.includes(n)||(0,C.Lzh)(d,e,t,n),u=a.indexOf(n),h=(0,eo.A)(a.length,u+1);l?o({...s(),[r]:h}):i(a[h])}),getCurrentPinnedIndex:d,getLoadingPinnedId:n}}(t,a,ne),We=i?Vn:void 0,_e=(0,$s.A)(t,We),Xe=(0,$s.A)(a,We),$e=(0,$s.A)(n,We),Qe=(0,$s.A)(Q,We),Ze=(0,$s.A)(Z,We),et=(0,$s.A)(ee,We),tt=(0,$s.A)(re,We),at=(0,$s.A)(m,We)&&!et&&!Ze&&!Qe&&!tt&&t!==s.Xab&&!le,st=(0,$s.A)(Oe,We)&&t!==s.Xab,ot=(0,$s.A)(X,We),nt=(0,$s.A)(ae,We),it=(0,$s.A)(se,We),rt=(0,$s.A)(t?qe:void 0,We),dt=(0,Qs.A)(_),ct=void 0!==dt&&dt<_?dt:void 0,{isReady:lt,handleCssTransitionEnd:ut,handleSlideTransitionStop:ht}=function(e,t,a,s,o){const[n,i]=(0,qt.J0)(!o),r=(0,Zt.A)(),d=void 0!==a&&a!==t;return d&&(e?(i(!1),setTimeout(()=>{i(!0)},Vn)):r()),(0,ia.A)(()=>{e||i(!0)},[e]),{isReady:n&&!d,handleCssTransitionEnd:e?function(e){"transform"===e.propertyName&&e.target===e.currentTarget&&i(Boolean(s))}:void 0,handleSlideTransitionStop:e?function(){i(!0)}:void 0}}(!W&&H,_,dt,t,i);(0,qt.vJ)(()=>t?(0,Pa.A)(()=>{fe({id:void 0})}):void 0,[t,fe]),(0,ia.A)(()=>{Ye(fo.I.None),Ge(void 0)},[t]),(0,qt.vJ)(()=>{if(!d.pz&&!d.Ni)return;const{visualViewport:e}=window;if(!e)return;const t=()=>{const t=e.height!==document.documentElement.clientHeight;(0,Ht.RK)(()=>{document.body.classList.toggle("keyboard-visible",t),(0,Ht.YS)(()=>{!t&&e.offsetTop&&(0,Ht.RK)(()=>{window.scrollTo({top:0})})})})};return e.addEventListener("resize",t),()=>{e.removeEventListener("resize",t)}},[]),(0,qt.vJ)(()=>{l&&be({userId:t})},[t,l,be]),(0,qt.vJ)(()=>{$||Se({peerId:t})},[t,l,$]),(0,qt.vJ)(()=>{t&&oe&&lt&&Pe({chatId:t})},[oe,t,lt,Pe]);const{initResize:mt,resetResize:pt,handleMouseUp:gt}=function(e,t,a,s,o){const[n,i,r]=(0,os.A)(),[d,c]=(0,qt.J0)(0),[l,u]=(0,qt.J0)(0),h=(0,ta.A)(t=>{(0,Ht.RK)(()=>{if(!e.current)return;const a=t?`${t}px`:"";e.current.style.width=a,o&&e.current.style.setProperty(o,a)})});function m(){(0,Ht.RK)(()=>{document.body.classList.remove("cursor-ew-resize")})}return(0,qt.Nf)(()=>{e.current&&s&&h(s)},[o,e,s,h]),(0,qt.vJ)(()=>{if(!n)return;const a=e=>{const t=Math.ceil(l+e.clientX-d);h(t)};function s(){o(),t(e.current.offsetWidth)}function o(){m(),document.removeEventListener("mousemove",a,!1),document.removeEventListener("mouseup",s,!1),document.removeEventListener("blur",s,!1),r()}return document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",s,!1),document.addEventListener("blur",s,!1),o},[l,d,e,t,n,r,h]),{initResize:function(t){t.preventDefault(),(0,Ht.RK)(()=>{document.body.classList.add("cursor-ew-resize")}),c(t.clientX),u(e.current.offsetWidth),i()},resetResize:function(e){e.preventDefault(),h(void 0),a()},handleMouseUp:m}}(e,e=>ke({leftColumnWidth:e}),Te,T,"--left-column-width"),ft=(0,ta.A)(e=>{const{items:t}=e.dataTransfer||{},a=d.Yw||t&&t.length>0&&Array.from(t).filter(e=>"text/uri-list"!==e.type).every(e=>function(e){return"file"===e.kind&&e.type&&s.gex.has(e.type)}(e)||function(e){return"file"===e.kind&&e.type&&s.fNs.has(e.type)}(e));Ye(a?fo.I.QuickFile:fo.I.Document)}),It=(0,ta.A)(()=>{Ye(fo.I.None)}),bt=(0,ta.A)(()=>{je(!0)}),St=(0,ta.A)(()=>{je(!1)}),yt=(0,ta.A)(()=>{fe({id:String(a)})}),wt=(0,ta.A)(()=>{ve({chatId:t,threadId:a}),St(),Ie()}),At=(0,ta.A)(()=>{fe({id:t})}),Mt=(0,ta.A)(()=>{we({chatId:t}),it&&Ce({message:Ne(X?"RequestToJoinChannelSentDescription":"RequestToJoinGroupSentDescription")})}),Ct=(0,ta.A)(()=>{Ae({command:"/start"})}),Pt=(0,ta.A)(()=>{Me({chatId:t})}),kt=(0,ta.A)(()=>{Fe({userId:t})}),Tt=(0,Xs.A)(v,I),Ft=(0,Kt.A)(d.So?"mask-image-disabled":"mask-image-enabled"),Bt=(0,Kt.A)(Gn.A.background,K&&Gn.A.withTransition,I&&Gn.A.customBgImage,b&&Gn.A.customBgColor,I&&k&&Gn.A.blurred,P&&Gn.A.withRightColumn),Ut=(0,Kt.A)("messaging-disabled",!L&&"shown"),xt=(0,S.gU)(Ne,p,g),Nt=(0,S.zc)(Ne,r,a,ue,Boolean(c)),Rt=xt||Nt||(ge?Re("MonoforumComposerPlaceholder"):void 0)||(le?(0,pa.Y)(Fn,{userId:t}):void 0)||(me&&pe?.id!==t?(0,pa.Y)(wo,{}):void 0),{composerHiddenScale:Jt,toolbarHiddenScale:Yt,composerTranslateX:Et,toolbarTranslateX:Dt,unpinHiddenScale:Ot,toolbarForUnpinHiddenScale:Lt}=(0,qt.Kr)(()=>function(e,t){const a=e<=s.c2m?U.$:2*U.$,o=function(e){if(e>s.gQx){const t=Math.min(Math.max(.25*e,J),R),a=Math.min(.25*e,R);return Math.min(e-t-a,N)}if(e>s.j7z){const t=Math.min(Math.max(.4*e,J),R);return Math.min(e-t,N)}return e>N?N:e}(e),n=3*U.$,i=t?o-a-n:o-a,r=e>s.c2m?Math.min(o-a,x):o-a,d=r/i,c=i/r;return{composerHiddenScale:d,toolbarHiddenScale:c,composerTranslateX:t?n/2*c:0,toolbarTranslateX:t?n/2*-1*d:0,unpinHiddenScale:r/Y,toolbarForUnpinHiddenScale:Y/r}}(Be,at),[at,Be]),Gt=(0,Kt.A)("middle-column-footer",!at&&"no-composer",at&&Le&&!L&&"with-notch");(0,ua.A)({isActive:L,onBack:ye}),(0,no.A)(A);const Vt=Boolean(!u&&!de&&!at&&!et&&!Ze&&!Qe&&Rt)||me&&pe?.id!==t,jt=Boolean(et||Qe||it||Ze||u&&ie||ce||tt),zt=Boolean(Vt||L);return(0,pa.FD)("div",{id:"MiddleColumn",className:Ft,onTransitionEnd:ut,style:(0,_s.A)(`--composer-hidden-scale: ${Jt}`,`--toolbar-hidden-scale: ${Yt}`,`--unpin-hidden-scale: ${Ot}`,`--toolbar-unpin-hidden-scale: ${Lt}`,`--composer-translate-x: ${Et}px`,`--toolbar-translate-x: ${Dt}px`,`--pattern-color: ${y}`,b&&`--theme-background-color: ${b}`),onClick:Ue&&M?At:void 0,children:[xe&&(0,pa.Y)("div",{className:"resize-handle",onMouseDown:mt,onMouseUp:gt,onDoubleClick:pt}),(0,pa.Y)("div",{className:Bt,style:Tt?`--custom-background: ${Tt}`:void 0,"data-tauri-drag-region":!(!vt.Vq||!d.MP||_e&&Xe)||void 0}),(0,pa.Y)("div",{id:"middle-column-portals"}),B?(0,pa.Y)(xn,{isActive:Boolean(B)}):E?(0,pa.Y)(lo,{threadId:D}):(0,pa.FD)(pa.FK,{children:[!_e&&!Xe&&(0,pa.Y)(Ln,{}),Boolean(_e&&Xe)&&(0,pa.FD)(pa.FK,{children:[(0,pa.FD)("div",{className:"messages-layout",onDragEnter:at?ft:void 0,children:[(0,pa.Y)(kn,{chatId:_e,threadId:Xe,messageListType:$e,getCurrentPinnedIndex:He,getLoadingPinnedId:Ke,onFocusPinnedMessage:ze},_e),(0,pa.Y)(hn,{chatId:_e,threadId:Xe,messageListType:$e,isComments:o,isMobile:i,getCurrentPinnedIndex:He,getLoadingPinnedId:Ke,onFocusPinnedMessage:ze}),(0,pa.FD)(Na.Ay,{name:(0,ka.P)("slide",z,W||!H),activeKey:_,shouldCleanup:!0,cleanupExceptionKey:ct,isBlockingAnimation:!0,onStop:ht,children:[(0,pa.Y)(Ao.A,{chatId:_e,threadId:Xe,type:$e,isComments:o,canPost:at,onScrollDownToggle:De,onNotchToggle:Ge,isReady:lt,isContactRequirePremium:le,paidMessagesStars:he,withBottomShift:jt,withDefaultBg:Boolean(!I&&!b),onIntersectPinnedMessage:rt},`${_e}-${Xe}-${$e}`),(0,pa.FD)("div",{className:Gt,children:[(0,pa.Y)(yo,{withScrollDown:st,canPost:at,withExtraShift:zt}),at&&(0,pa.Y)(uo.A,{type:"messageList",chatId:_e,threadId:Xe,messageListType:$e,dropAreaState:Je,onDropHide:It,isReady:lt,isMobile:i,editableInputId:s.CfG,editableInputCssSelector:s.m$5,inputId:"message-input-text"}),u&&ie&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button unpin-all-button",onClick:bt,iconName:"unpin",children:(0,pa.Y)("span",{children:Ne("Chat.Pinned.UnpinAll",f,"i")})})}),ce&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,color:"secondary",className:"composer-button open-chat-button",onClick:yt,children:(0,pa.Y)("span",{children:Ne("SavedOpenChat")})})}),Vt&&(0,pa.Y)("div",{className:Ut,children:(0,pa.Y)("div",{className:"messaging-disabled-inner",children:(0,pa.Y)("span",{children:Rt})})}),i&&(Qe||nt&&!it)&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:Mt,children:Ne(ot?"ProfileJoinChannel":"ProfileJoinGroup")})}),i&&it&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:Mt,children:Ne("ChannelJoinRequest")})}),i&&Ze&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:Ct,children:Ne("BotStart")})}),i&&et&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:Pt,children:Ne("BotRestart")})}),i&&tt&&(0,pa.Y)("div",{className:"middle-column-footer-button-container",dir:Re.isRtl?"rtl":void 0,children:(0,pa.Y)(La.A,{size:"tiny",fluid:!0,ripple:!0,className:"composer-button join-subscribe-button",onClick:kt,children:Ne("Unblock")})}),(0,pa.Y)(Mo,{messageListType:$e,isActive:L,canPost:at}),(0,pa.Y)(mo,{isOpen:G}),(0,pa.Y)(ho,{isOpen:V}),(0,pa.Y)(Bn,{isOpen:j}),d.CM&&(0,pa.Y)(go,{isOpen:q})]})]})]}),(0,pa.Y)(Un,{isActive:Boolean(F)})]})]}),t&&(0,pa.Y)(po,{isOpen:Ve,chatId:t,pinnedMessagesCount:f,onClose:St,onUnpin:wt}),(0,pa.Y)("div",{teactFastList:!0,children:te?.map((e,t)=>(0,pa.Y)(Io,{teactOrderKey:t,activeEmojiInteraction:e},e.id))})]})}));var qn=a(62495);const zn=(0,qt.ph)((0,w.EK)(e=>({isSummarizePageOpen:(0,qn.bL)(e)}))(({isSummarizePageOpen:e})=>{const{closeSummarizePage:t}=(0,w.ko)();(0,ua.A)({isActive:e,hash:"summarize",onBack:t})})),Hn={giftCodeModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"GiftCodeModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},boostModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"BoostModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},chatlistModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ChatlistModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},urlAuth:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"UrlAuthModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},oneTimeMediaModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"OneTimeMediaModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},inviteViaLinkModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"InviteViaLinkModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},requestedAttachBotInstall:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"AttachBotInstallModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},reportAdModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ReportAdModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},reportModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ReportModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},webApps:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"WebAppModal",!t?.isModalOpen);return a?(0,pa.Y)(a,{...e}):void 0},collectibleInfoModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"CollectibleInfoModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},mapModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"MapModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},starsPayment:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarPaymentModal",!t?.inputInvoice);return a?(0,pa.Y)(a,{...e}):void 0},starsBalanceModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarsBalanceModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},starsTransactionModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarsTransactionInfoModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},chatInviteModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ChatInviteModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},paidReactionModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"PaidReactionModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},suggestMessageModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SuggestMessageModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},suggestedPostApprovalModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SuggestedPostApprovalModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},starsSubscriptionModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarsSubscriptionModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},starsGiftModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarsGiftModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},isGiftRecipientPickerOpen:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftRecipientPicker",!t);return a?(0,pa.Y)(a,{...e}):void 0},isWebAppsCloseConfirmationModalOpen:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"WebAppsCloseConfirmationModal",!t);return a?(0,pa.Y)(a,{modal:t}):void 0},giftInfoModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftInfoModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftInfoValueModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftInfoValueModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},lockedGiftModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftLockedModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftResalePriceComposerModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftResalePriceComposerModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},suggestedStatusModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SuggestedStatusModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},emojiStatusAccessModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"EmojiStatusAccessModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},locationAccessModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"LocationAccessModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},aboutAdsModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"AboutAdsModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftUpgradeModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftUpgradeModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftAuctionModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftAuctionModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftAuctionBidModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftAuctionBidModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftAuctionInfoModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftAuctionInfoModal",!t?.isOpen);return a?(0,pa.Y)(a,{...e}):void 0},giftAuctionChangeRecipientModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftAuctionChangeRecipientModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftAuctionAcquiredModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftAuctionAcquiredModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},starGiftPriceDecreaseInfoModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarGiftPriceDecreaseInfoModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},monetizationVerificationModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"VerificationMonetizationModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftWithdrawModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftWithdrawModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftStatusInfoModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftStatusInfoModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},preparedMessageModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PreparedMessageModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},sharePreparedMessageModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SharePreparedMessageModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftTransferModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftTransferModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftTransferConfirmModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftTransferConfirmModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},giftDescriptionRemoveModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"GiftDescriptionRemoveModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},chatRefundModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Stars,"ChatRefundModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},priceConfirmModal:({modal:e})=>{const t=(0,ma.A)(Xt.ar.Stars,"PriceConfirmModal",!e);return t?(0,pa.Y)(t,{modal:e}):void 0},isFrozenAccountModalOpen:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"FrozenAccountModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},deleteAccountModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"DeleteAccountModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},isAgeVerificationModalOpen:(0,qt.ph)(e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"AgeVerificationModal",!t);return a?(0,pa.Y)(a,{...e}):void 0}),profileRatingModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ProfileRatingModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},quickPreview:(0,qt.ph)(e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"QuickPreviewModal",!t);return a?(0,pa.Y)(a,{...e}):void 0}),storyStealthModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"StealthModeModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},isPasskeyModalOpen:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PasskeyModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},birthdaySetupModal:e=>{const{modal:t}=e,a=(0,ma.A)(Xt.ar.Extra,"BirthdaySetupModal",!t);return a?(0,pa.Y)(a,{...e}):void 0}},Kn=Object.keys(Hn),Wn=Object.entries(Hn),_n=(0,qt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),Kn))(e=>Wn.map(([t,a])=>(0,pa.Y)(a,{modal:e[t]},t)))),Xn=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PaymentModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},$n=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ReceiptModal",!t);return a?(0,pa.Y)(a,{...e}):void 0};var Qn=a(37859),Zn=a(60406),ei=a(79582),ti=a(54960),ai=a(12933);const si=(0,qt.ph)((0,w.EK)((e,{chatId:t})=>{const a=(0,C.hds)(e,t),{userIds:s}=e.contactList||{},{newChatMembersProgress:o}=(0,C.nTw)(e),{currentUserId:n}=e,r=a&&(0,S.WX)(a),{query:d,fetchingStatus:c,globalUserIds:l,localUserIds:u}=(0,C.nTw)(e).userSearch;return{isChannel:r,members:(0,C.AWZ)(e,t)?.members,currentUserId:n,localContactIds:s,searchQuery:d,isSearching:c,isLoading:o===i.D7.Loading,globalUserIds:l,localUserIds:u}})(({isChannel:e,members:t,onNextStep:a,currentUserId:s,localContactIds:o,isLoading:n,searchQuery:i,isSearching:r,localUserIds:d,globalUserIds:c,onClose:l,isActive:u})=>{const{setUserSearchQuery:m}=(0,w.ko)(),p=(0,Da.A)(),[g,f]=(0,qt.J0)([]),I=(0,Qs.A)(g)===g;(0,ua.A)({isActive:u,onBack:l});const v=(0,qt.Kr)(()=>t?t.map(e=>e.userId):[],[t]),b=(0,qt.hb)(e=>{m({query:e})},[m]),A=(0,qt.Kr)(()=>{const t=(0,w.mS)().users.byId,a=(0,y.PU)({ids:(0,h.Am)([...o||[],...d||[],...c||[]]),query:i,type:"user"});return(0,ei.A)(a.filter(a=>{const o=t[a];return!v.includes(a)&&a!==s&&(!o||!(0,S.tv)(o)||!e&&o.canBeInvitedToGroup)}))},[o,i,d,c,s,v,e]),M=(0,qt.hb)(()=>{g.length&&(m({query:""}),a(g))},[g,m,a]);return(0,pa.Y)("div",{className:"AddChatMembers",children:(0,pa.FD)("div",{className:"AddChatMembers-inner",children:[(0,pa.Y)(ti.A,{itemIds:A,selectedIds:g,filterValue:i,filterPlaceholder:p("lng_channel_add_users"),searchInputId:"new-members-picker-search",isLoading:r,onSelectedIdsChange:f,onFilterChange:b,isSearchable:!0,withDefaultPadding:!0,noScrollRestore:I,allowMultiple:!0,withStatus:!0,itemInputType:"checkbox"}),(0,pa.Y)(ai.A,{isShown:Boolean(g.length),disabled:n,ariaLabel:p("lng_channel_add_users"),onClick:M,iconName:"arrow-right",isLoading:n})]})})})),oi={root:"zKndvYxz",visible:"ZJBlf3zB",resizeHandle:"As4yLBIs",header:"JZ83v9_B",headerLeft:"_bjHeswi",title:"MNmgQVAW",headerActions:"AQQyV1M5",loginButton:"WvWNvIaH",minimizeBtn:"H7RhJXOX",slimToggleBar:"lvkHhX0i",slimToggleTooltip:"MxXqOB2z",slimToggleIcon:"dNYksCM0",chatScreen:"ki1JjPHD",messagesContainer:"_9h1rqMd",loginPrompt:"EEP83qou",loginText:"IU7ww6d_",loginButtonContainer:"fjHEO82O",passwordSetupContainer:"DxEpqL8_",passwordSetupForm:"RcJYCF6d",passwordSetupHeader:"rTle4AKM",passwordSetupTitle:"HtFY4FzD",passwordSetupDescription:"h0jmID7s",passwordInput:"q3GExaHZ",passwordSubmitButton:"Ho55jfLE",messageWrapper:"ac1XNsXb",messageOutgoing:"moPALE2F",messageAvatar:"k5Dj9Uma",aiAvatar:"EHrTxkIw",messageBubble:"rEGCgZiF",messageAppear:"GHMD3Z62",messageBubbleUser:"ZbV0U9Cr",messageContent:"hEj1lEo2",messageTime:"Dqh9JvWM",messageBubbleAgent:"EKDlWZo2",skeletonSpacer:"J3Go9Kpp",thinkingIndicator:"w5sOsF04",thinkingText:"StsJ8jHX",thinkingDots:"B143rj26",dot:"SsY4_gYZ",thinkingPulse:"RkxB6gZe",chatInputContainer:"Le84DyeY",chatInputWrapper:"GgMipN5b",chatInputField:"P826iJOo",sendButton:"YwIosG6g",sendButtonActive:"Dlf0RLWo",controlsBar:"bK5nx1MW",controlsLeft:"G6jIfrXs",controlsRight:"CauJXuyW",controlsDropdown:"RJ0cYn4t",controlsIconButton:"J2xr4PpZ",welcomeMessage:"ftdquIrK",welcomeIcon:"Tr3lROIf",float:"Tux2kGaZ",welcomeTitle:"HqAyjGrq",welcomeDescription:"l7sh3NmN",welcomeExamples:"p1cjigwL",exampleTitle:"xQokxhld",exampleItem:"kQWk7T_s",threadsSidebar:"szgIKkTT",threadsSidebarOpen:"lKM6WXu2",threadsHeader:"xhWAzMoD",threadsTitle:"C49h7hmp",threadsCloseButton:"UlmQcQU9",threadsContent:"nAM5rYLX",threadItem:"oKYo23tk",threadItemActive:"qPc19AoQ",threadMain:"y8TqS060",threadTitle:"wmSbdv4z",threadPreview:"Bd7z_MzQ",threadMeta:"oRHcru7a",threadTime:"MlRUGlaC",threadCount:"j7CdoUZ1",threadsFooter:"uybhRPcc",newThreadButton:"PXLZluzh",threadsToggleButton:"EStVVyWd"},ni=(0,qt.ph)(({onSend:e,disabled:t,className:a})=>{const s=(0,ea.A)(),[o,n]=(0,qt.J0)(""),i=(0,qt.li)(),r=(0,qt.hb)(a=>{a?.preventDefault(),o.trim()&&!t&&(e(o.trim()),n(""),i.current&&(i.current.style.height="auto"))},[o,t,e]),d=(0,qt.hb)(e=>{"Enter"!==e.key||e.shiftKey||e.ctrlKey||e.altKey||e.metaKey||(e.preventDefault(),r())},[r]),c=(0,qt.hb)(e=>{const t=e.target,{value:a}=t;n(a),t.style.height="auto";const s=Math.min(t.scrollHeight,120);t.style.height=`${s}px`},[]);(0,qt.vJ)(()=>{const e=i.current;if(e)return e.addEventListener("keydown",d),e.addEventListener("input",c),()=>{e.removeEventListener("keydown",d),e.removeEventListener("input",c)}},[d,c]);const l=o.trim()&&!t,u=(0,qt.Kr)(()=>({onTrigger:e})=>(0,pa.FD)("button",{type:"button",onClick:e,className:oi.controlsDropdown,children:[(0,pa.Y)("span",{children:"Ask"}),(0,pa.Y)("i",{className:"icon icon-down"})]}),[]);return(0,pa.FD)("div",{className:(0,Kt.A)(oi.chatInputContainer,a),children:[(0,pa.FD)("form",{onSubmit:r,className:oi.chatInputWrapper,children:[(0,pa.Y)("textarea",{ref:i,value:o,placeholder:"Ask a question...",disabled:t,className:oi.chatInputField,rows:1,dir:"auto"}),(0,pa.Y)("button",{type:"submit",disabled:!l,className:(0,Kt.A)(oi.sendButton,l&&oi.sendButtonActive),"aria-label":s("Send"),children:(0,pa.Y)("i",{className:"icon icon-send"})})]}),(0,pa.FD)("div",{className:oi.controlsBar,children:[(0,pa.Y)("div",{className:oi.controlsLeft,children:(0,pa.FD)(vs.A,{trigger:u,positionY:"top",children:[(0,pa.Y)(ja.A,{children:"Ask"}),(0,pa.Y)(ja.A,{children:"Chat"}),(0,pa.Y)(ja.A,{children:"Generate"})]})}),(0,pa.FD)("div",{className:oi.controlsRight,children:[(0,pa.Y)("button",{type:"button",className:oi.controlsIconButton,"aria-label":"Folder",children:(0,pa.Y)("i",{className:"icon icon-folder"})}),(0,pa.Y)("button",{type:"button",className:oi.controlsIconButton,"aria-label":"Filter",children:(0,pa.Y)("i",{className:"icon icon-sort"})})]})]})]})}),ii=(0,qt.ph)(({className:e})=>(0,pa.FD)("div",{className:(0,Kt.A)(oi.welcomeMessage,e),children:[(0,pa.Y)("div",{className:oi.welcomeIcon,children:""}),(0,pa.Y)("div",{className:oi.welcomeTitle,children:"This is your Smart Chat"}),(0,pa.Y)("div",{className:oi.welcomeDescription,children:"Ask questions about the current chat to get things done faster and smarter."}),(0,pa.FD)("div",{className:oi.welcomeExamples,children:[(0,pa.Y)("div",{className:oi.exampleTitle,children:"Examples:"}),(0,pa.Y)("div",{className:oi.exampleItem,children:'"Analyze the tone of the current chat and give me a good response."'}),(0,pa.Y)("div",{className:oi.exampleItem,children:'"Find me the most active people in the current chat."'}),(0,pa.Y)("div",{className:oi.exampleItem,children:'"Write a summary of the current chat"'})]})]})),ri=(0,qt.ph)((0,w.EK)(e=>{const t=(0,la.Z)(e),a=t?.activeThreadId,s=a&&e.alphahuman?.threadMessagesLoading?.[a]||!1,{chatId:o}=(0,C.Xf0)(e)||{};return{socketState:e.alphahuman?.socketState,streamingContent:e.alphahuman?.streamingContent,isStreaming:e.alphahuman?.isStreaming,activeTools:e.alphahuman?.activeTools,threads:t,isLoadingMessages:s,chatId:o}})(({className:e,socketState:t,streamingContent:a,isStreaming:s,activeTools:o,threads:n,isLoadingMessages:i,chatId:r})=>{const{streamAlphaHumanMessage:d,loadAlphahumanThreadMessages:c}=(0,w.ko)(),l=(0,qt.li)(),u=(0,qt.li)(),h=(0,qt.hb)(()=>{const e=l.current;e&&(u.current&&cancelAnimationFrame(u.current),u.current=requestAnimationFrame(()=>{const t=e.scrollHeight;(0,Ht.RK)(()=>{e.scrollTop=t})}))},[]),m=n?.activeThreadId,p=m?n?.byId[m]:void 0,g=(0,qt.Kr)(()=>p?.messages||[],[p?.messages]),f=Boolean(s&&!a);(0,qt.vJ)(()=>{m&&"string"==typeof m&&c({threadId:m})},[m,c]);const[I,v]=(0,qt.J0)(""),b=(0,qt.li)();(0,qt.vJ)(()=>(b.current&&cancelAnimationFrame(b.current),b.current=requestAnimationFrame(()=>{v(a||"")}),()=>{b.current&&cancelAnimationFrame(b.current)}),[a]);const S=(0,qt.hb)(e=>{(0,Jt.R)("REQUEST","Sending message:",{content:e,chatId:r,threadId:m}),d({threadId:m,content:e,chatId:r})},[d,m,r]),y=(0,qt.hb)(e=>{const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;const s=Math.floor(a/60);return s<24?`${s}h ago`:e.toLocaleDateString()},[]);return(0,qt.vJ)(()=>{h()},[g,I,f,h]),(0,pa.FD)("div",{className:(0,Kt.A)(oi.chatScreen,e),children:[(0,pa.Y)("div",{ref:l,className:oi.messagesContainer,children:i&&0===g.length?(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageWrapper,oi.messageOutgoing),children:(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageBubble,oi.messageBubbleUser),children:(0,pa.Y)("div",{className:oi.messageContent,children:(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:180})})})}),(0,pa.FD)("div",{className:oi.messageWrapper,children:[(0,pa.Y)("div",{className:oi.messageAvatar,children:(0,pa.Y)("div",{className:oi.aiAvatar,children:"AI"})}),(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageBubble,oi.messageBubbleAgent),children:(0,pa.FD)("div",{className:oi.messageContent,children:[(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:280}),(0,pa.Y)("div",{className:oi.skeletonSpacer}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:240}),(0,pa.Y)("div",{className:oi.skeletonSpacer}),(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:320})]})})]}),(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageWrapper,oi.messageOutgoing),children:(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageBubble,oi.messageBubbleUser),children:(0,pa.Y)("div",{className:oi.messageContent,children:(0,pa.Y)(co.A,{variant:"rounded-rect",height:16,width:200})})})})]}):(0,pa.FD)(pa.FK,{children:[0===g.length&&!I&&!f&&(0,pa.Y)(ii,{}),g.map(e=>(0,pa.FD)("div",{className:(0,Kt.A)(oi.messageWrapper,"user"===e.sender&&oi.messageOutgoing),children:["agent"===e.sender&&(0,pa.Y)("div",{className:oi.messageAvatar,children:(0,pa.Y)("div",{className:oi.aiAvatar,children:"AI"})}),(0,pa.FD)("div",{className:(0,Kt.A)(oi.messageBubble,"user"===e.sender?oi.messageBubbleUser:oi.messageBubbleAgent),children:[(0,pa.Y)("div",{className:oi.messageContent,children:"agent"===e.sender?(0,ro.A)(e.content,["emoji","br","simple_markdown","links"]):e.content}),(0,pa.FD)("div",{className:oi.messageTime,children:["user"===e.sender&&" ",y(e.timestamp)]})]})]},e.id)),o&&Object.keys(o).length>0&&(0,pa.Y)("div",{className:oi.toolIndicators,children:Object.values(o).map(e=>{const t="starting"===e.status?"Starting...":"active"===e.status?"Running...":"Completed";return(0,pa.FD)("div",{className:oi.toolIndicator,children:[(0,pa.Y)("span",{className:oi.toolName,children:e.name}),(0,pa.Y)("span",{className:oi.toolStatus,children:t})]},e.name)})}),I&&(0,pa.FD)("div",{className:oi.messageWrapper,children:[(0,pa.Y)("div",{className:oi.messageAvatar,children:(0,pa.Y)("div",{className:oi.aiAvatar,children:"AI"})}),(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageBubble,oi.messageBubbleAgent),children:(0,pa.Y)("div",{className:oi.messageContent,children:(0,ro.A)(I,["emoji","br","simple_markdown","links"])})})]}),f&&!I&&(0,pa.FD)("div",{className:oi.messageWrapper,children:[(0,pa.Y)("div",{className:oi.messageAvatar,children:(0,pa.Y)("div",{className:oi.aiAvatar,children:"AI"})}),(0,pa.Y)("div",{className:(0,Kt.A)(oi.messageBubble,oi.messageBubbleAgent),children:(0,pa.Y)("div",{className:oi.messageContent,children:"Thinking..."})})]})]})}),(0,pa.Y)(ni,{onSend:S,disabled:f})]})})),di=e=>{const t=(0,ma.A)(Xt.ar.Extra,"CreateTopic");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},ci=e=>{const t=(0,ma.A)(Xt.ar.Extra,"EditTopic");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},li=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"GifSearch",!t);return a?(0,pa.Y)(a,{...e}):(0,pa.Y)(Ra.A,{})},ui=e=>{const t=(0,ma.A)(Xt.ar.Extra,"Management");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},hi=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PollResults",!t);return a?(0,pa.Y)(a,{...e}):(0,pa.Y)(Ra.A,{})};var mi=a(55475),pi=a(35104),gi=a(93005),fi=a(36175),Ii=a(55429),vi=a(68323),bi=a(41385),Si=a(23459),yi=a(7985);var wi=a(5912),Ai=a(66230);const Mi=(0,I.nF)(e=>e(),250,!1);let Ci=!1;function Pi(e){switch(e){case"members":return i.zW.MemberList;case"gifts":return i.zW.GiftList;case"stories":return i.zW.StoryList;case"dialogs":return i.zW.SavedDialogs;default:return i.zW.SharedMedia}}var ki=a(96374);function Ti(e,t){const[a,o]=(0,ki.A)(e,t,void 0,s.nnT);return[a,o,!(!a||!t||a[0]===t[0])]}function Fi(e,t,a,o,n,i){const r=(0,qt.li)();(0,ia.A)(()=>{r.current=void 0},[i]),(0,ia.A)(()=>{t===e&&o&&n&&(r.current=(0,S.lH)(o,n,e))},[o,n,t,e]);const[d,c]=(0,ki.A)(a,r.current,void 0,"media"===e?s.Um:s.gXr);return[d,c,!(!d||!r.current||d[0]===r.current[0])]}var Bi=a(64489),Ui=a(65240),xi=a(55723),Ni=a(58968),Ri=a(66833),Ji=a(82855),Yi=a(40558),Ei=a(25404),Di=a(87049);const Oi="LLQBJODm",Li="_TMVTkD4",Gi=(0,qt.ph)((0,w.EK)((e,{peerId:t,gift:a})=>{const s=a.fromId?(0,C.PVB)(e,a.fromId):void 0,o=(0,C.hds)(e,t),n=o&&(0,S.ub)(o,"postMessages"),i=e.currentUserId,r=i?(0,C.mBe)(e,i):void 0,d=r?.emojiStatus,c=e.collectibleEmojiStatuses?.statuses;return{fromPeer:s,hasAdminRights:n,currentUserId:i,currentUserEmojiStatus:d,collectibleEmojiStatuses:c}})(({peerId:e,gift:t,style:a,fromPeer:o,currentUserId:n,hasAdminRights:i,collectibleEmojiStatuses:r,currentUserEmojiStatus:c,className:l,observeIntersection:u})=>{const{openGiftInfoModal:h}=(0,w.ko)(),m=(0,qt.li)(),p=(0,qt.li)(),f=(0,ea.A)(),[I,v,b]=(0,os.A)(),S=e===n||i,y=(0,Ri.UC)(t.gift),A=t.gift,M="starGiftUnique"===A.type?A:void 0,C=(0,qt.Kr)(()=>{if(M?.resellPrice)return M.resaleTonOnly?M.resellPrice.find(e=>e.currency===s.ykW):M.resellPrice.find(e=>e.currency===s.OUy)},[M]),P=M?.resellPrice?f("GiftRibbonSale"):t.isPinned&&M?f("GiftSavedNumber",{number:M.number}):y?f("ActionStarGiftLimitedRibbon",{total:(0,Aa.Vw)(f,y)}):void 0,k=M?.resellPrice?"green":"blue",{isContextMenuOpen:T,contextMenuAnchor:F,handleBeforeContextMenu:B,handleContextMenu:U,handleContextMenuClose:x,handleContextMenuHide:N}=(0,vo.A)(m),R=(0,ta.A)(()=>m.current),J=(0,ta.A)(()=>m.current.closest(".custom-scroll")),Y=(0,ta.A)(()=>document.querySelector("#portals")?.querySelector(".saved-gift-context-menu .bubble")),E=(0,ta.A)(()=>({withPortal:!0})),D=(0,ta.A)(()=>{h({peerId:e,gift:t})}),O=t.isNameHidden&&!o?Ni.I5:o,L=(0,Ri.yQ)(t.gift),G=(0,qt.Kr)(()=>(0,Ri.uc)(t.gift),[t.gift]),{backdrop:V,pattern:j}=G||{},q=(0,qt.Kr)(()=>{if(!V||!j)return;const e=[V.centerColor,V.edgeColor];return(0,pa.Y)(Yi.A,{className:"_I9aOdGr",backgroundColors:e,patternIcon:j.sticker,patternSize:14,ringsCount:1,ovalFactor:1,withAdaptiveHeight:!0})},[V,j]);if(L)return(0,pa.FD)("div",{ref:m,className:(0,Kt.A)("interactive-gift scroll-item","HN4dYXIk",l),style:a,onClick:D,onContextMenu:U,onMouseDown:B,onMouseEnter:d.TF?void 0:v,onMouseLeave:d.TF?void 0:b,children:[q,!q&&(0,pa.Y)(ps.A,{className:Li,peer:O,size:"micro"}),t.isPinned&&(0,pa.Y)(Ga.A,{name:"pinned-message",className:Li}),(0,pa.Y)("div",{ref:p,className:"NYuBBB9j",style:"width: 90px; height: 90px",children:L&&(0,pa.Y)(Ji.A,{containerRef:p,sticker:L,size:90,shouldLoop:I,shouldPreloadPreview:!0,observeIntersectionForPlaying:u,observeIntersectionForLoading:u})}),t.isUnsaved&&(0,pa.Y)("div",{className:"xY4yqqYA",children:(0,pa.Y)(Ga.A,{name:"eye-crossed-outline"})}),C&&(0,pa.Y)(La.A,{className:"haa6STaT",nonInteractive:!0,size:"tiny",withSparkleEffect:!0,noSparkleAnimation:!0,pill:!0,fluid:!0,children:"TON"===C.currency?(0,g.Ms)(f,C.amount,{shouldConvertFromNanos:!0,className:Oi}):(0,g.U2)(f,C.amount,{asFont:!0,className:Oi})}),P&&(0,pa.Y)(Di.A,{color:k,text:P}),void 0!==F&&(0,pa.Y)(Va.A,{isOpen:T,anchor:F,className:"saved-gift-context-menu",autoClose:!0,withPortal:!0,getMenuElement:Y,getTriggerElement:R,getRootElement:J,getLayout:E,onClose:x,onCloseAnimationEnd:N,children:(0,pa.Y)(Ei.A,{peerId:e,gift:t,canManage:S,collectibleEmojiStatuses:r,currentUserEmojiStatus:c})})]})}));var Vi=a(81524),ji=a(42827),qi=a(83868),zi=a(83057);const Hi=(0,qt.ph)(({media:e,idPrefix:t="preview-media",isProtected:a,observeIntersection:s,onClick:o,index:n})=>{const i=(0,qt.li)(),r=(0,wi.Vz)(i,s),d=(0,_o.A)(e),c=(0,Uo.A)(e,"preview"),l=(0,Ro.A)(c,!r),u=(0,zi.A)(l),h=e.content.video,m=(0,ta.A)(()=>{o(n)});return(0,pa.FD)("div",{ref:i,id:`${t}${n}`,className:"Media scroll-item",onClick:m,children:[(0,pa.Y)("img",{src:d,className:"media-miniature",alt:"",draggable:!a,decoding:"async",onContextMenu:a?qi.A:void 0}),(0,pa.Y)("img",{src:l,className:(0,Kt.A)("full-media","media-miniature",u),alt:"",draggable:!a,decoding:"async",onContextMenu:a?qi.A:void 0}),h&&(0,pa.Y)("span",{className:"video-duration",children:h.isGif?"GIF":(0,ye.QO)(h.duration)}),a&&(0,pa.Y)("span",{className:"protector"})]})});var Ki=a(25301),Wi=a(87970),_i=a(37378),Xi=a(54464),$i=a(59816);const Qi="XHW5o0B8",Zi="NOCaj4mx",er=(0,qt.ph)((0,w.EK)((e,{story:t})=>{const a=(0,C.hds)(e,t.peerId),s=a?.isProtected,{maxPinnedStoriesCount:o}=e.appConfig,n="isOut"in t&&t.isOut,i=(0,C.gVx)(e,t.peerId),r=i?.some(e=>e.id===t.id);return{isProtected:s,isPinned:r,canPin:n&&(!o||(i?.length||0)<o)}})(function({story:e,isProtected:t,isArchive:a,isPinned:s,canPin:o}){const{openStoryViewer:n,loadPeerSkippedStories:i,toggleStoryInProfile:r,toggleStoryPinnedToTop:d,showNotification:c}=(0,w.ko)(),l=(0,ea.A)(),u=(0,Da.A)(),h=(0,qt.li)(),m=(0,ta.A)(()=>h.current),p=(0,ta.A)(()=>document.body),g=(0,ta.A)(()=>document.querySelector("#portals .story-context-menu .bubble")),f=(0,ta.A)(()=>({withPortal:!0,isDense:!0})),I=e&&e.peerId,v=e&&"content"in e,b=v&&e.isOut,y=e&&"isDeleted"in e,A=v&&0===Object.keys(e.content).length,M=v?e.content.video:void 0,C=M&&(0,ye.QO)(M.duration),P=v?(0,S.EN)(e):void 0,k=(0,Ro.A)(P)||M?.thumbnail?.dataUri;(0,qt.vJ)(()=>{!e||v||y||i({peerId:e.peerId})},[y,v,e]);const{isContextMenuOpen:T,contextMenuAnchor:F,handleBeforeContextMenu:B,handleContextMenu:U,handleContextMenuClose:x,handleContextMenuHide:N}=(0,vo.A)(h,!b),R=(0,qt.hb)(()=>{n({peerId:e.peerId,storyId:e.id,isSinglePeer:!0,isPrivate:!0,isArchive:a})},[a,e.id,e.peerId]),J=(0,ta.A)(e=>{(0,Xi.u)(e),B(e)}),Y=(0,ta.A)(t=>{(0,qi.A)(t),r({peerId:I,storyId:e.id,isInProfile:!0}),c({message:u("Story.ToastSavedToProfileText")}),x()}),E=(0,ta.A)(t=>{(0,qi.A)(t),r({peerId:I,storyId:e.id,isInProfile:!1}),c({message:u("Story.ToastRemovedFromProfileText")}),x()}),D=(0,ta.A)(()=>{d({peerId:I,storyId:e.id}),x()});return(0,pa.FD)("div",{ref:h,className:(0,Kt.A)("kxMIqtqr","scroll-item"),onMouseDown:J,onClick:R,onContextMenu:U,children:[y&&(0,pa.FD)("span",{children:[(0,pa.Y)(Ga.A,{className:Qi,name:"story-expired"}),u("ExpiredStory")]}),A&&(0,pa.FD)("span",{children:[(0,pa.Y)(Ga.A,{className:Qi,name:"warning"}),l("StoryUnsupported")]}),s&&(0,pa.Y)(Ga.A,{className:(0,Kt.A)(Zi,"GTWFQyJx"),name:"pin-badge"}),v&&Boolean(e.views?.viewsCount)&&(0,pa.FD)("span",{className:(0,Kt.A)(Zi,"g09Rb4Ps"),children:[(0,pa.Y)(Ga.A,{name:"eye"}),e.views.viewsCount]}),C&&(0,pa.Y)("span",{className:(0,Kt.A)(Zi,"lM_2MMyQ"),children:C}),(0,pa.FD)("div",{className:"D6Yajvjx",children:[k&&(0,pa.Y)("img",{src:k,alt:"",className:"cV_QL3N5",draggable:!1}),v&&(0,pa.Y)($i.A,{story:e}),t&&(0,pa.Y)("span",{className:"protector"})]}),void 0!==F&&(0,pa.FD)(Va.A,{isOpen:T,anchor:F,getTriggerElement:m,getRootElement:p,getMenuElement:g,getLayout:f,className:(0,Kt.A)("UAfI9izT","story-context-menu"),autoClose:!0,onClose:x,onCloseAnimationEnd:N,withPortal:!0,children:[a&&(0,pa.Y)(ja.A,{icon:"archive",onClick:Y,children:u("StoryList.SaveToProfile")}),!a&&(0,pa.Y)(ja.A,{icon:"archive",onClick:E,children:u("Story.Context.RemoveFromProfile")}),!a&&!s&&o&&(0,pa.Y)(ja.A,{icon:"pin",onClick:D,children:u("StoryList.ItemAction.Pin")}),!a&&s&&(0,pa.Y)(ja.A,{icon:"unpin",onClick:D,children:u("StoryList.ItemAction.Unpin")})]})]})}));var tr=a(46222),ar=a(22720),sr=a(285),or=a(36838),nr=a(93545),ir=a(79577);const rr=(0,qt.ph)(({id:e,title:t,sticker:a,onClick:s})=>{const o=(0,ta.A)(()=>{s?.(e)});return(0,pa.FD)("div",{className:"_KBrROQt",onClick:o,children:[a&&(0,pa.Y)(ir.A,{className:"Y3vEed9M",sticker:a,size:20,forcePreview:!0}),t]})}),dr=(0,qt.ph)(({items:e,selectedItemId:t,animationLevel:a,onItemSelect:o,className:n})=>{const i=(0,qt.li)(),r=(0,qt.li)(),d=e.findIndex(e=>e.id===t)||0,[c,l]=(0,qt.J0)(""),u=a>s.dnp;(0,or.A)(i,!e.length,!0);const h=(0,ta.A)(()=>{const e=r.current,t=d>=0&&e?.childNodes[d];if(e&&t&&e.offsetWidth>0){const{offsetLeft:a,offsetWidth:s}=t,o=e.offsetWidth,n=(a/o*100).toFixed(1),i=((o-(a+s))/o*100).toFixed(1);l(`inset(0 ${i}% 0 ${n}% round 1rem)`)}});if((0,qt.vJ)(()=>{h()},[d,e]),(0,nr.A)(r,h),e.length)return(0,pa.FD)("div",{ref:i,className:(0,Kt.A)("UQ6pUmuC","no-scrollbar",n,c&&"_Nw3GzkO"),children:[e.map(e=>(0,pa.Y)(rr,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id)),(0,pa.Y)("div",{ref:r,className:(0,Kt.A)("c397ZVz4","clip-path-container",!u&&"zNFdzcTe"),style:c?`clip-path: ${c}`:void 0,"aria-hidden":!0,children:e.map((e,t)=>(0,pa.Y)(rr,{id:e.id,title:e.title,sticker:e.sticker,onClick:o},e.id))})]})}),cr=(0,qt.ph)((0,w.EK)((e,{peerId:t})=>{const{starGiftCollections:a}=e,s=a?.byPeerId?.[t];return{collections:s,activeCollectionId:(0,C.B59)(e,t),animationLevel:(0,je.lS)(e).animationLevel}})(({peerId:e,className:t,collections:a,activeCollectionId:s,animationLevel:o})=>{const{updateSelectedGiftCollection:n,resetSelectedGiftCollection:i}=(0,w.ko)(),r=(0,ea.A)(),d=(0,ta.A)(t=>{if("all"===t)i({peerId:e});else{const a=Number(t);n({peerId:e,collectionId:a})}});if(!a||0===a.length)return;const c=(0,qt.Kr)(()=>[{id:"all",title:r("AllGiftsCategory")},...a.map(e=>({id:String(e.collectionId),title:e.title,sticker:e.icon}))],[a,r]),l=s?String(s):"all";return(0,pa.Y)(dr,{items:c,selectedItemId:l,animationLevel:o,onItemSelect:d,className:(0,Kt.A)("pvf61Tbm",t)})})),lr=(0,qt.ph)((0,w.EK)((e,{peerId:t})=>{const{stories:a}=e,s=a?.albumsByPeerId?.[t];return{albums:s,selectedAlbumId:(0,st.tW)(e),animationLevel:(0,je.lS)(e).animationLevel}})(({peerId:e,className:t,albums:a,selectedAlbumId:s,animationLevel:o})=>{const{selectStoryAlbum:n,resetSelectedStoryAlbum:i}=(0,w.ko)(),r=(0,ea.A)(),d=(0,ta.A)(t=>{if("all"===t)i();else{const a=Number(t);n({peerId:e,albumId:a})}});if(!a?.length)return;const c=(0,qt.Kr)(()=>[{id:"all",title:r("AllStoriesCategory")},...a.map(e=>({id:String(e.albumId),title:e.title}))],[a,r]),l=s?String(s):"all";return(0,pa.Y)(dr,{items:c,selectedItemId:l,animationLevel:o,onItemSelect:d,className:(0,Kt.A)("GgK8T6WN",t)})})),ur=[{type:"media",key:"ProfileTabMedia"},{type:"documents",key:"ProfileTabFiles"},{type:"links",key:"ProfileTabLinks"},{type:"audio",key:"ProfileTabMusic"},{type:"gif",key:"ProfileTabGifs"}],hr=new Set(["stories","gifts","media","documents","audio","voice","links","gif"]),mr=new Set(["stories","gifts"]),pr=new Set(["media","documents","links","audio","voice","gif"]),gr=(0,qt.ph)((0,w.EK)((e,{chatId:t,threadId:a,isMobile:s})=>{const o=(0,C.mBe)(e,t),i=(0,C.hds)(e,t),r=(0,C.AWZ)(e,t),d=(0,C.vGo)(e,t),c=(0,C.zeq)(e,t),l=(0,C.nTw)(e),{chatInfo:u,savedGifts:h}=l,{isOwnProfile:m}=u,{animationLevel:p,shouldWarnAboutFiles:g}=(0,je.lS)(e),{currentType:f,resultsByType:I}=(0,C.BU_)(e)||{},{foundIds:v}=I&&f&&I[f]||{},b=Boolean(i?.isForum&&a&&a!==n.l3),{byId:y,statusesById:w}=e.users,{byId:A}=e.chats,M=t===e.currentUserId&&!m,P=m?void 0:(0,S.cG)(t,a,e.currentUserId),k=i&&(0,S.YE)(i),T=i&&(0,S.WX)(i),F=o&&(0,S.tv)(o),B=!b&&!P&&k&&!i?.isMonoforum,U=r?.members,x=r?.adminMembersById,N=B&&i&&(i.isForbidden||r&&!r.canViewMembers),R=B&&i&&((0,S.ub)(i,"inviteUsers")||!T&&!(0,S.Sq)(i,"inviteUsers")||i.isCreator),J=B&&i&&((0,S.ub)(i,"banUsers")||i.isCreator),Y=(0,C.yuw)(e),{similarChannelIds:E}=(0,C.dg4)(e,t)||{},{similarBotsIds:D}=(0,C.AOG)(e,t)||{},O=(0,C.g29)(e),L=o||i,G=d||r,V=o&&!o.isSelf&&!(0,S.tv)(o)&&!M&&Boolean(d?.commonChatsCount),j=(0,C.Ua4)(e,t),q=d?.botInfo?.hasPreviewMedia,z=e.users.previewMediaByBotId[t],H=L&&(o?.isSelf||!L.areStoriesHidden&&G?.hasPinnedStories)&&!M,K=H?(0,C._bp)(e,L.id):void 0,W=(0,st.tW)(e),_="all"!==W?K?.idsByAlbumId?.[W]?.ids:K?.profileIds,X=K?.pinnedIds,$=K?.byId,Q=K?.archiveIds,Z=Boolean(G?.starGiftCount)&&!M,ee=(0,mi.B5)(e,t),te=h.collectionsByPeerId[t]?.[ee],ae=e.stories.albumsByPeerId?.[t],se=e.starGiftCollections?.byPeerId?.[t],oe=(0,C.k2W)(e,t),ne=i&&(0,C._ls)(e,i.id),ie=Boolean(L?.avatarPhotoId),re=(0,C.xYJ)(e,"autoplayGifs");return{theme:(0,C.SJA)(e),isChannel:T,isBot:F,messagesById:c,foundIds:v,mediaSearchType:f,hasCommonChatsTab:V,hasStoriesTab:H,hasMembersTab:B,hasPreviewMediaTab:q,areMembersHidden:N,canAddMembers:R,canDeleteMembers:J,currentUserId:e.currentUserId,isRightColumnShown:(0,C.gjV)(e,s),isRestricted:ne,activeDownloads:Y,usersById:y,userStatusesById:w,chatsById:A,storyIds:_,hasGiftsTab:Z,gifts:te?.gifts,storyAlbums:ae,giftCollections:se,pinnedStoryIds:X,archiveStoryIds:Q,storyByIds:$,selectedStoryAlbumId:W,activeCollectionId:ee,giftsFilter:h.filter,isChatProtected:i?.isProtected,chatInfo:u,animationLevel:p,shouldWarnAboutFiles:g,similarChannels:E,similarBots:D,botPreviewMedia:z,isCurrentUserPremium:O,isTopicInfo:b,isSavedDialog:P,isSavedMessages:M,isSynced:e.isSynced,limitSimilarPeers:(0,fe.B)(e,"recommendedChannels"),members:B?U:void 0,adminMembersById:B?x:void 0,commonChatIds:j?.ids,monoforumChannel:oe,hasAvatar:ie,peerFullInfo:G,canUpdateMainTab:(0,C.ySL)(e,t),canAutoPlayGifs:re}})(({chatId:e,isActive:t,threadId:a,chatInfo:o,profileState:r,theme:c,monoforumChannel:l,isChannel:u,isBot:h,currentUserId:m,messagesById:p,foundIds:g,storyIds:f,pinnedStoryIds:I,archiveStoryIds:v,storyByIds:b,selectedStoryAlbumId:y,activeCollectionId:A,giftsFilter:M,mediaSearchType:C,hasCommonChatsTab:T,hasStoriesTab:F,hasMembersTab:B,hasPreviewMediaTab:U,hasGiftsTab:x,gifts:N,storyAlbums:R,giftCollections:J,botPreviewMedia:Y,areMembersHidden:E,canAddMembers:D,canDeleteMembers:O,commonChatIds:L,members:G,adminMembersById:V,usersById:j,userStatusesById:q,chatsById:z,isRightColumnShown:H,isRestricted:K,activeDownloads:W,isChatProtected:_,animationLevel:X,shouldWarnAboutFiles:$,similarChannels:Q,similarBots:Z,isCurrentUserPremium:ee,limitSimilarPeers:te,isTopicInfo:ae,isSavedDialog:se,isSavedMessages:oe,isSynced:ne,hasAvatar:ie,peerFullInfo:re,canUpdateMainTab:de,canAutoPlayGifs:ce,onProfileStateChange:le})=>{const{setSharedMediaSearchType:ue,loadMoreMembers:he,loadCommonChats:me,openChat:pe,searchSharedMediaMessages:ge,openMediaViewer:fe,openAudioPlayer:Ie,focusMessage:ve,setNewChatMembersDialogState:be,loadPeerProfileStories:Se,loadStoriesArchive:ye,openPremiumModal:we,loadChannelRecommendations:Ae,loadBotRecommendations:Me,loadPreviewMedias:Ce,loadPeerSavedGifts:Pe,resetGiftProfileFilter:ke,loadStarGiftCollections:Te,loadStoryAlbums:Fe,resetSelectedStoryAlbum:Be,changeProfileTab:Ue,setMainProfileTab:xe}=(0,w.ko)(),Ne=(0,qt.li)(),Re=(0,qt.li)(),Je=(0,qt.li)(!1),Ye=(0,Da.A)(),Ee=(0,ea.A)(),[De,Oe]=(0,qt.J0)(),[Le,Ge,Ve]=(0,os.A)(),je=!o.isOpen,{profileTab:qe,forceScrollProfileTab:ze,isOwnProfile:He}=o,Ke=se?String(a):e,We=oe&&!se,[_e,Xe,$e]=(0,os.A)(),[Qe,Ze]=(0,qt.J0)(0),et=(0,k.L8)(e)?mr:hr,tt=re?.mainTab,at=(0,qt.Kr)(()=>{const t=[];if(We&&t.push({type:"dialogs",key:"ProfileTabSavedDialogs"}),F&&t.push({type:"stories",key:"ProfileTabStories"}),x&&t.push({type:"gifts",key:"ProfileTabGifts"}),F&&He&&t.push({type:"storiesArchive",key:"ProfileTabStoriesArchive"}),B&&!He&&t.push({type:"members",key:"ProfileTabMembers"}),U&&!He&&t.push({type:"previewMedia",key:"ProfileTabBotPreview"}),He||t.push(...ur),ae||He||t.push({type:"voice",key:"ProfileTabVoice"}),T&&!He&&t.push({type:"commonChats",key:"ProfileTabSharedGroups"}),u&&Q?.length&&!He&&t.push({type:"similarChannels",key:"ProfileTabSimilarChannels"}),h&&Z?.length&&!He&&t.push({type:"similarBots",key:"ProfileTabSimilarBots"}),t.length||t.push(ur[0]),tt){const e=t.findIndex(e=>e.type===tt);if(-1!==e){const a=t[e];t.splice(e,1),t.unshift(a)}}return t.map(t=>{const a=de&&tt!==t.type&&et.has(t.type)?[{title:Ee("ProfileMenuSetMainTab"),icon:"reorder-tabs",handler:()=>{xe({chatId:e,tab:t.type})}}]:void 0;return{type:t.type,title:Ee(t.key),contextActions:a}})},[We,F,x,B,U,ae,T,u,h,Q?.length,Z?.length,Ee,He,tt,e,de,et]),[st,ot,nt]=(0,os.A)(!1),it=(0,ta.A)(e=>{je||(Ue({profileTab:e}),ue({mediaType:pr.has(e)?e:void 0}))});(0,qt.vJ)(()=>{je||(qe?Ue({profileTab:qe,shouldScrollTo:void 0}):it(at[0].type))},[je,qe,at]),(0,Ps.A)(([e])=>{!e&&re?.mainTab&&it(re.mainTab)},[re]);const rt=(0,qt.hb)(e=>{ot(),it(at[e].type)},[at]);(0,qt.vJ)(()=>{U&&!Y&&Ce({botId:e})},[e,Y,U]),(0,qt.vJ)(()=>{u&&!Q&&ne&&Ae({chatId:e})},[e,u,Q,ne]),(0,qt.vJ)(()=>{h&&!Z&&ne&&Me({userId:e})},[e,h,Z,ne]),(0,qt.vJ)(()=>{Be()},[e]),(0,ia.A)(()=>{Ge()},[M]),(0,ia.A)(()=>{Ve()},[N]),(0,qt.vJ)(()=>{x&&ne&&(Te({peerId:e}),Fe({peerId:e}))},[e,x,ne]);const[ct,lt]=(0,qt.J0)(N),{startViewTransition:ut}=(0,vi.Y)(),{createVtnStyle:ht}=(0,bi.k)(),mt=(0,qt.Kr)(()=>ct?.map(e=>(0,pi.p)(e)),[ct]),gt=(0,qt.Kr)(()=>{const e=at.findIndex(({type:e})=>e===qe);return-1===e?0:e},[qe,at]);Je.current&&(Je.current=!1),(0,Ai.A)(([e,t])=>{e===qe&&t!==gt&&(Je.current=!0)},[qe,gt]);const ft=at[gt].type,It=(0,qt.hb)(()=>{me({userId:e})},[e]),vt=(0,qt.hb)(({offsetId:t})=>{Se({peerId:e,offsetId:t})},[e]),bt=(0,qt.hb)(({offsetId:t})=>{ye({peerId:e,offsetId:t})},[e]),St=(0,qt.hb)(()=>{Pe({peerId:e})},[e]),yt=(0,qt.hb)(()=>{he({chatId:e})},[e,he]);(0,Ps.A)(([e])=>{if((0,P.T)(N,e))return;if(!N||!e||!Le)return void lt(N);const t=e.map(e=>(0,pi.p)(e)),a=N.map(e=>(0,pi.p)(e));t.some((e,t)=>e!==a[t])?ut(gi.NH,()=>{lt(N)}):lt(N)},[N,ut,Le]);const[wt,At,Mt,Ct]=function({loadMoreMembers:e,loadCommonChats:t,searchMessages:a,loadStories:s,loadStoriesArchive:o,loadMoreGifts:n,tabType:i,mediaSearchType:r,groupChatMembers:d,commonChatIds:c,usersById:l,userStatusesById:u,chatsById:h,chatMessages:m,foundIds:p,threadId:g,storyIds:f,giftIds:I,pinnedStoryIds:v,archiveStoryIds:b,similarChannels:y,similarBots:w}){const A="members"!==i&&r?r:i,M=(0,qt.Kr)(()=>{if(d&&l&&u)return(0,S.UB)(d.map(({userId:e})=>e),l,u)},[d,l,u]),C=(0,qt.Kr)(()=>{if(c&&h)return(0,ei.A)(c,!0)},[h,c]),[P,k,T]=Ti(e,M),[F,B,U]=Fi("media",A,a,m,p,g),[x,N,R]=Fi("gif",A,a,m,p,g),[J,Y,E]=Fi("documents",A,a,m,p,g),[D,O,L]=Fi("links",A,a,m,p,g),[G,V,j]=Fi("audio",A,a,m,p,g),[q,z,H]=Fi("voice",A,a,m,p,g),[K,W,_]=Ti(t,C),X=(0,qt.Kr)(()=>{if(!f?.length)return f;const e=new Set(v);return f.slice().sort((t,a)=>{const s=e.has(t),o=e.has(a);return s&&!o?-1:!s&&o?1:a-t})},[f,v]),[$,Q,Z]=Ti(s,X),[ee,te,ae]=Ti(o,b);let se,oe,ne=!1;switch(A){case"members":se=P,oe=k,ne=T;break;case"commonChats":se=K,oe=W,ne=_;break;case"media":se=F,oe=B,ne=U;break;case"gif":se=x,oe=N,ne=R;break;case"documents":se=J,oe=Y,ne=E;break;case"links":se=D,oe=O,ne=L;break;case"audio":se=G,oe=V,ne=j;break;case"voice":se=q,oe=z,ne=H;break;case"stories":se=$,oe=Q,ne=Z;break;case"storiesArchive":se=ee,oe=te,ne=ae;break;case"similarChannels":se=y;break;case"similarBots":se=w;break;case"gifts":se=I,oe=n;break;case"dialogs":ne=!0}return[A,se,oe,ne]}({loadMoreMembers:yt,searchMessages:ge,loadStories:vt,loadStoriesArchive:bt,loadMoreGifts:St,loadCommonChats:It,tabType:ft,mediaSearchType:C,groupChatMembers:G,commonChatIds:L,usersById:j,userStatusesById:q,chatsById:z,chatMessages:p,foundIds:g,threadId:a,storyIds:f,giftIds:mt,pinnedStoryIds:I,archiveStoryIds:v,similarChannels:Q,similarBots:Z}),Pt=!Ct&&!oe,kt=at[0].type===wt,Tt=at.findIndex(({type:e})=>e===wt),[Ft,Bt,Ut]=(0,os.A)(!1),[xt,Nt,Rt]=(0,os.A)(!1),Jt=J&&J.length>0,Yt=R&&R.length>0,Et="gifts"===wt&&Jt||"stories"===wt&&Yt;(0,qt.vJ)(()=>{Jt?setTimeout(()=>{Bt()},300):Ut(),Yt?setTimeout(()=>{Nt()},300):Rt()},[Jt,Yt,Bt,Nt]),(0,Si.A)("members"===wt?At:void 0);const Dt=(0,ta.A)(()=>{nt()}),Ot=(0,ta.A)(()=>{_e||ut(gi.pV,()=>{Xe()})}),Lt=(0,ta.A)(()=>{_e&&ut(gi.gh,()=>{$e()})}),{handleScroll:Gt}=function({containerRef:e,tabType:t,profileState:a,onProfileStateChange:s,forceScrollProfileTab:o=!1,allowAutoScrollToTabs:n=!1,handleStopAutoScrollToTabs:r}){(0,Ps.A)(([a])=>{if(a&&a!==t&&n||t&&o){const a=e.current,o=a.querySelector(".TabList");r(),a.scrollTop<o.offsetTop&&(s(Pi(t)),Ci=!0,(0,dt.Ay)({container:a,element:o,position:"start",forceDuration:300}),setTimeout(()=>{Ci=!1},350))}},[t,s,e,o,n,r]),(0,Ps.A)(([t])=>{if(a!==i.zW.Profile||a===t)return;const s=e.current;if(!s)return;const o=s.querySelector(".TabList");!o||o.offsetTop>s.scrollTop||(Ci=!0,(0,dt.Ay)({container:s,element:s.firstElementChild,position:"start",maxDistance:2*s.offsetHeight}),setTimeout(()=>{Ci=!1},350))},[a,e]);const d=(0,ta.A)(()=>{const o=e.current;if(!o)return;const n=o.querySelector(".TabList");if(!n)return;let r=i.zW.Profile;Math.ceil(o.scrollTop)>=n.offsetTop&&(r=Pi(t)),r!==a&&s(r)});return(0,qt.vJ)(()=>{Ci||d()},[d,t]),{handleScroll:(0,ta.A)(()=>{Ci||Mi(d)})}}({containerRef:Ne,tabType:wt,profileState:r,forceScrollProfileTab:ze,allowAutoScrollToTabs:st,onProfileStateChange:le,handleStopAutoScrollToTabs:Dt});!function(e,t=".Transition.shared-media-transition"){(0,qt.vJ)(()=>{function a(){const a=e.current,s=a.querySelector(t),o=a.querySelector(".TabList");if(s&&o){const e=a.clientHeight-o.offsetHeight;(0,Ht.RK)(()=>{s.style.minHeight=`${e}px`})}}return a(),window.addEventListener("resize",a,!1),()=>{window.removeEventListener("resize",a,!1)}},[e,t])}(Ne);const[Vt,jt]=(()=>{const[e,t]=(0,qt.J0)(0);return[e,(0,qt.hb)(()=>{t(e=>e+1)},[])]})(),{observe:zt}=(0,wi.BL)({rootRef:Ne,throttleMs:500}),Wt=(0,ta.A)(()=>{be({newChatMembersProgress:i.D7.InProgress})}),_t=(0,ta.A)(e=>{fe({chatId:Ke,threadId:n.l3,messageId:e,origin:i.TQ.SharedMedia})}),Xt=(0,ta.A)(e=>{fe({standaloneMedia:Y?.flatMap(e=>e?.content.photo||e?.content.video).filter(Boolean),origin:i.TQ.PreviewMedia,mediaIndex:e})}),$t=(0,ta.A)(e=>{Ie({chatId:Ke,messageId:e})}),Qt=(0,ta.A)(e=>{pe({id:e})}),Zt=(0,ta.A)(e=>{ve({chatId:e.chatId,messageId:e.id})}),aa=(0,ta.A)(()=>{Oe(void 0)}),sa=(0,ta.A)(()=>{ke({peerId:e})});let oa;(0,yi.A)({containerRef:Ne,onOverscroll:Ot,onReset:Lt,isOverscrolled:_e,isDisabled:!ie||!Pt}),(0,qt.vJ)(()=>{if(Re.current&&d.TF)return(0,Ha.wJ)(Re.current,{selectorToPreventScroll:".Profile",onSwipe:(e,t)=>{if(t===Ha.ez.Left){const e=Math.min(gt+1,at.length-1);return it(at[e].type),!0}if(t===Ha.ez.Right){const e=Math.max(0,gt-1);return it(at[e].type),!0}return!1}})},[gt,at]),kt?oa=H?0:1e3:(!At&&!Y||!N?.length&&"gifts"===wt)&&(oa=s.jhd);const na=(0,Qo.A)([e,a,wt,gt,A,y],oa);const ra="stories"===wt||"gifts"===wt,da="stories"===wt?"all"===y?0:y:"gifts"===wt?"all"===A?0:A:0,ca=(0,ta.A)(()=>{Ze(Qe+1)});function la(t,a){const s=function(t,a){if(t){const e=Boolean("members"===wt&&E);return(0,pa.FD)("div",{className:"content empty-list",children:[!a&&!e&&(0,pa.Y)(Ms.A,{}),e&&(0,pa.Y)(ji.A,{text:Ee("ChatMemberListNoAccess")})]})}const s=At&&!At?.length;if(s&&"gifts"===wt)return(0,pa.FD)("div",{className:"nothing-found-gifts",children:[(0,pa.Y)(Bi.A,{size:160,tgsUrl:fi.w.SearchingDuck,nonInteractive:!0,noLoop:!0}),(0,pa.Y)("div",{className:"description",children:Ee("GiftSearchEmpty")}),(0,pa.Y)(Tn.A,{className:"date",onClick:sa,children:Ee("GiftSearchReset")})]});if(s){let e;switch(wt){case"members":e=Ee(E?"ChatMemberListNoAccess":"NoMembersFound");break;case"commonChats":e=Ye("NoGroupsInCommon");break;case"documents":e=Ye("lng_media_file_empty");break;case"links":e=Ye("lng_media_link_empty");break;case"audio":e=Ye("lng_media_song_empty");break;case"voice":e=Ye("lng_media_audio_empty");break;case"stories":e=Ye("StoryList.SavedEmptyState.Title");break;case"storiesArchive":e=Ye("StoryList.ArchivedEmptyState.Title");break;case"gif":e=Ye("lng_media_gif_empty");break;default:e=Ye("SharedMedia.EmptyTitle")}return(0,pa.Y)("div",{className:"content empty-list",children:(0,pa.Y)(ji.A,{text:e})})}if(!p)return;const o="gifts"===wt?Ft:"stories"===wt&&xt;return(0,pa.Y)("div",{className:(0,Kt.A)(`content ${wt}-list`,Et&&"showContentPanel",o&&"noTransition"),dir:!Ee.isRtl||"media"!==wt&&"gif"!==wt?void 0:"rtl",teactFastList:!0,children:"media"===wt||"gif"===wt?At.map(e=>p[e]&&(0,pa.Y)(Vi.A,{message:p[e],isProtected:_||p[e].isProtected,canAutoPlay:ce,observeIntersection:zt,onClick:_t},e)):"stories"===wt||"storiesArchive"===wt?At.map((e,t)=>b?.[e]&&(0,pa.Y)(er,{teactOrderKey:t,story:b[e],isArchive:"storiesArchive"===wt},`${wt}_${e}`)):"documents"===wt?At.map(e=>p[e]&&(0,pa.Y)(xi.A,{id:`shared-media${(0,S.GZ)(e)}`,document:(0,S.zC)(p[e]),datetime:p[e].date,smaller:!0,className:"scroll-item",isDownloading:(0,S.$r)(W,(0,S.zC)(p[e])),observeIntersection:zt,onDateClick:Zt,message:p[e],shouldWarnAboutFiles:$,onMediaClick:_t},e)):"links"===wt?At.map(e=>p[e]&&(0,pa.Y)(_i.A,{message:p[e],isProtected:_||p[e].isProtected,observeIntersection:zt,onMessageClick:Zt},e)):"audio"===wt?At.map(e=>p[e]&&(0,pa.Y)(Ui.Ay,{theme:c,message:p[e],origin:i.d9.SharedMedia,date:p[e].date,className:"scroll-item",onPlay:$t,onDateClick:Zt,canDownload:!_&&!p[e].isProtected,isDownloading:(0,S.$r)(W,p[e].content.audio)},e)):"voice"===wt?At.map(e=>{const t=(0,w.mS)(),a=p[e];if(!a)return;const s=(0,pt.iS)(t,a);return p[e]&&(0,pa.Y)(Ui.Ay,{theme:c,message:a,senderTitle:(0,Ii.N)(Ye,a,z,j),origin:i.d9.SharedMedia,date:a.date,className:"scroll-item",onPlay:$t,onDateClick:Zt,canDownload:!_&&!a.isProtected,isDownloading:(0,S.$r)(W,s)},e)}):"members"===wt?At.map((e,t)=>{return(0,pa.Y)(ar.A,{teactOrderKey:t,className:"chat-item-clickable contact-list-item scroll-item small-icon",onClick:()=>Qt(e),contextActions:(a=e,a!==m&&O?[{title:Ye("lng_context_remove_from_group"),icon:"stop",handler:()=>{Oe(a)}}]:void 0),children:(0,pa.Y)(ko.A,{userId:e,adminMember:V?.[e],forceShowSelf:!0,withStory:!0})},e);var a}):"commonChats"===wt?At.map((e,t)=>(0,pa.Y)(ar.A,{teactOrderKey:t,className:"chat-item-clickable scroll-item small-icon",onClick:()=>pe({id:e}),children:(0,pa.Y)(Po.A,{chatId:e})},e)):"previewMedia"===wt?Y.map((e,t)=>(0,pa.Y)(Hi,{media:e,isProtected:_,observeIntersection:zt,onClick:Xt,index:t},e.date)):"similarChannels"===wt?(0,pa.FD)("div",{children:[At.map((e,t)=>(0,pa.Y)(ar.A,{teactOrderKey:t,className:(0,Kt.A)("chat-item-clickable search-result",!ee&&t===Q.length-1&&"blured"),onClick:()=>pe({id:e}),children:(0,pa.Y)(Po.A,{avatarSize:"large",chatId:e,withFullInfo:!0})},e)),!ee&&(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(La.A,{className:"show-more-channels",onClick:()=>we(),iconName:"unlock-badge",iconAlignment:"end",children:Ye("UnlockSimilar")}),(0,pa.Y)("div",{className:"more-similar",children:(0,ro.A)(Ye("MoreSimilarText",te),["simple_markdown"])})]})]},wt):"similarBots"===wt?(0,pa.FD)("div",{children:[At.map((e,t)=>(0,pa.Y)(ar.A,{teactOrderKey:t,className:(0,Kt.A)("chat-item-clickable search-result",!ee&&t===Z.length-1&&"blured"),onClick:()=>pe({id:e}),children:(0,pa.Y)(ko.A,{userId:e,avatarSize:"medium"})},e)),!ee&&(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(La.A,{className:"show-more-bots",onClick:()=>we(),iconName:"unlock-badge",children:Ee("UnlockMoreSimilarBots")}),(0,pa.Y)("div",{className:"more-similar",children:(0,ro.A)(Ee("MoreSimilarBotsDescription",{count:te},{withNodes:!0,withMarkdown:!0,pluralValue:te}))})]})]},wt):"gifts"===wt?ct?.map(t=>(0,pa.Y)(Gi,{peerId:e,className:"saved-gift",style:ht((0,pi.p)(t)),gift:t,observeIntersection:zt},(0,pi.p)(t))):void 0})}(t,a),o=t&&!a;return ra?(0,pa.Y)(Na.Ay,{className:`${wt}-list`,activeKey:da,name:(0,ka.P)("slideOptimized",X,void 0,Ee.isRtl),shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:Qe,contentSelector:".Transition > .Transition_slide-active > .content",children:(0,pa.Y)(Na.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,restoreHeightKey:Qe,contentSelector:".content",onStop:ca,children:s})}):(0,pa.Y)(Na.Ay,{activeKey:o?0:1,name:"fade",shouldCleanup:!0,shouldRestoreHeight:!0,children:s})}const ua=".shared-media-transition > .Transition_slide-active",ha=ra?`${ua} > .Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .${wt}-list > .scroll-item`:`${ua} .${wt}-list > .scroll-item`;return(0,pa.FD)(tr.A,{ref:Ne,className:"Profile custom-scroll",itemSelector:ha,items:na?At:void 0,cacheBuster:Vt,sensitiveArea:s.ZhW,preloadBackwards:na?"members"===wt?s.nnT:s.Um:0,noScrollRestoreOnTop:!0,noFastList:!0,onLoadMore:Mt,onScroll:Gt,children:[!Ct&&!oe&&(ma=l?.id||Ke,ga=H&&na,(0,pa.FD)("div",{className:"profile-info",children:[(0,pa.Y)(Wi.A,{isExpanded:_e,peerId:ma,canPlayVideo:ga,isForMonoforum:Boolean(l),onExpand:Ot}),(0,pa.Y)(Ki.A,{chatOrUserId:Ke,isSavedDialog:se,isOwnProfile:He})]})),!K&&(0,pa.FD)("div",{className:"shared-media",style:ht("sharedMedia"),children:[(0,pa.Y)(Na.Ay,{ref:Re,name:Je.current?"none":(0,ka.P)("slideOptimized",X,void 0,Ee.isRtl),activeKey:Tt,renderCount:at.length,shouldRestoreHeight:!0,className:"shared-media-transition",onStop:jt,restoreHeightKey:ra?Qe:void 0,contentSelector:ra?".Transition > .Transition_slide-active > .Transition > .Transition_slide-active > .content":void 0,children:function(){if("dialogs"===wt)return(0,pa.Y)(Za.A,{className:"saved-dialogs",folderType:"saved",isActive:!0});const t=!At&&!Y||!na||!p,a=kt&&!na;return(0,pa.FD)("div",{children:["gifts"===wt?(0,pa.Y)("div",{className:(0,Kt.A)("contentCategoriesPanel",!Et&&"hiddenPanel",Ft&&"noTransition"),children:(0,pa.Y)(cr,{peerId:e})}):"stories"===wt?(0,pa.Y)("div",{className:(0,Kt.A)("contentCategoriesPanel",!Et&&"hiddenPanel",xt&&"noTransition"),children:(0,pa.Y)(lr,{peerId:e})}):void 0,la(t,a)]})}()}),(0,pa.Y)(Qa.A,{activeTab:gt,tabs:at,onSwitchTab:rt})]}),D&&(0,pa.Y)(ai.A,{className:(0,Kt.A)(!t&&"hidden"),isShown:na,onClick:Wt,ariaLabel:Ye("lng_channel_add_users"),iconName:"add-user-filled"}),O&&(0,pa.Y)(sr.A,{isOpen:Boolean(De),userId:De,onClose:aa})]});var ma,ga})),fr=450+s.xB5;var Ir=function(e){return e[e.Profile=0]="Profile",e[e.MemberList=1]="MemberList",e[e.GiftList=2]="GiftList",e[e.SharedMedia=3]="SharedMedia",e[e.StoryList=4]="StoryList",e[e.Search=5]="Search",e[e.Statistics=6]="Statistics",e[e.MessageStatistics=7]="MessageStatistics",e[e.StoryStatistics=8]="StoryStatistics",e[e.BoostStatistics=9]="BoostStatistics",e[e.MonetizationStatistics=10]="MonetizationStatistics",e[e.Management=11]="Management",e[e.ManageInitial=12]="ManageInitial",e[e.ManageChannelSubscribers=13]="ManageChannelSubscribers",e[e.ManageChatAdministrators=14]="ManageChatAdministrators",e[e.ManageChatPrivacyType=15]="ManageChatPrivacyType",e[e.ManageDiscussion=16]="ManageDiscussion",e[e.ManageGroupPermissions=17]="ManageGroupPermissions",e[e.ManageGroupRemovedUsers=18]="ManageGroupRemovedUsers",e[e.ManageChannelRemovedUsers=19]="ManageChannelRemovedUsers",e[e.ManageGroupUserPermissionsCreate=20]="ManageGroupUserPermissionsCreate",e[e.ManageGroupUserPermissions=21]="ManageGroupUserPermissions",e[e.ManageGroupRecentActions=22]="ManageGroupRecentActions",e[e.ManageGroupAdminRights=23]="ManageGroupAdminRights",e[e.ManageGroupNewAdminRights=24]="ManageGroupNewAdminRights",e[e.ManageGroupMembers=25]="ManageGroupMembers",e[e.ManageGroupAddAdmins=26]="ManageGroupAddAdmins",e[e.StickerSearch=27]="StickerSearch",e[e.GifSearch=28]="GifSearch",e[e.PollResults=29]="PollResults",e[e.AddingMembers=30]="AddingMembers",e[e.ManageInvites=31]="ManageInvites",e[e.ManageEditInvite=32]="ManageEditInvite",e[e.ManageReactions=33]="ManageReactions",e[e.ManageInviteInfo=34]="ManageInviteInfo",e[e.ManageJoinRequests=35]="ManageJoinRequests",e[e.CreateTopic=36]="CreateTopic",e[e.EditTopic=37]="EditTopic",e[e.SavedDialogs=38]="SavedDialogs",e[e.NewDiscussionGroup=39]="NewDiscussionGroup",e[e.AgentChat=40]="AgentChat",e[e.ThreadHistory=41]="ThreadHistory",e}(Ir||{});const vr=(0,w.EK)((e,{chatId:t,isProfile:a,isManagement:s,threadId:o})=>{const i=(0,C.nTw)(e),{query:r}=(0,C.BmE)(e)||{},{query:d}=(0,C.Wy7)(e)||{},c=t?(0,C.hds)(e,t):void 0,l=a&&t&&(0,k.L8)(t)?(0,C.mBe)(e,t):void 0,u=c&&(0,S.WX)(c),h=c?.isForum&&Boolean(o&&o!==n.l3),m=h?(0,C.S0q)(e,t,o):void 0,p=h&&m&&(0,S.l1)(c,m),g=l&&(0,S.tv)(l),f=i.chatInfo?.isOwnProfile,I=t&&!f?(0,C.nZ4)(e,t):void 0,v=g&&l?.canEditBot,b=l&&(0,S.Gh)(l),y=Boolean(!s&&a&&t&&(0,C.e5V)(e,t)),w=Boolean(t&&i.management.byChatId[t]?.editingInvite),A=!h&&t?(0,C.AWZ)(e,t)?.canViewStatistics:void 0,M=t?i.management.byChatId[t]?.inviteInfo?.invite:void 0,P=i.savedGifts.filter,T=!!t&&(0,C.rtZ)(e,t),F=!!t&&(0,C.ERc)(e,t);return{canManage:y,canAddContact:b,canViewStatistics:A,isChannel:u,isBot:g,isInsideTopic:h,canEditTopic:p,userId:l?.id,isSelf:l?.isSelf,stickerSearchQuery:r,gifSearchQuery:d,isEditingInvite:w,currentInviteInfo:M,isSavedMessages:I,shouldSkipHistoryAnimations:i.shouldSkipHistoryAnimations,canEditBot:v,giftProfileFilter:P,canUseGiftFilter:T,canUseGiftAdminFilter:F,isOwnProfile:f}})(({chatId:e,threadId:t,isColumnOpen:a,isProfile:o,isManagement:n,isStatistics:r,isMessageStatistics:c,isStoryStatistics:l,isMonetizationStatistics:u,isBoostStatistics:h,isStickerSearch:m,isGifSearch:p,isPollResults:g,isCreatingTopic:f,isEditingTopic:I,isAddingChatMembers:v,isAgentChat:b,isThreadHistory:S,profileState:y,managementScreen:A,canAddContact:M,userId:C,isSelf:P,canManage:k,isChannel:T,stickerSearchQuery:F,gifSearchQuery:B,isEditingInvite:U,canViewStatistics:x,currentInviteInfo:N,shouldSkipHistoryAnimations:R,isBot:J,isInsideTopic:Y,canEditTopic:E,isSavedMessages:D,canEditBot:L,giftProfileFilter:G,canUseGiftFilter:V,canUseGiftAdminFilter:j,isOwnProfile:q,onClose:z,onScreenSelect:H,onOpenThreadHistoryOverlay:K})=>{const{setStickerSearchQuery:W,setGifSearchQuery:_,toggleManagement:X,openAddContactDialog:$,toggleStatistics:Q,setEditingExportedInvite:Z,deleteExportedChatInvite:ee,openEditTopicPanel:te,updateGiftProfileFilter:ae,openSettingsScreen:se}=(0,w.ko)(),[oe,ne,ie]=(0,os.A)(),{isMobile:re}=(0,O.Ay)(),{createVtnStyle:de}=(0,bi.k)(),{sortType:ce,shouldIncludeUnlimited:le,shouldIncludeLimited:ue,shouldIncludeUpgradable:he,shouldIncludeUnique:me,shouldIncludeDisplayed:pe,shouldIncludeHidden:ge}=G,fe=(0,Ma.g5)(),Ie=(0,ta.A)(()=>{Z({chatId:e,invite:N}),H(i.je.EditInvite)}),ve=(0,ta.A)(()=>{ee({chatId:e,link:N.link}),H(i.je.Invites),ie()}),be=(0,ta.A)(e=>{W({query:e})}),Se=(0,ta.A)(e=>{_({query:e})}),ye=(0,ta.A)(()=>{$({userId:C})}),we=(0,ta.A)(()=>{e&&t&&te({chatId:e,topicId:Number(t)})}),Ae=(0,ta.A)(()=>{X()}),Me=(0,ta.A)(()=>{Q()}),Ce=(0,ta.A)(()=>{se({screen:i.VS.EditProfile})}),Pe=(0,ta.A)(()=>{z(!D)}),[ke,Te]=(0,qt.J0)(!a);(0,qt.vJ)(()=>{setTimeout(()=>{Te(!a)},fr)},[a]);const Fe=(0,Da.A)(),Be=(0,ea.A)(),Ue=o?y===i.zW.Profile?Ir.Profile:y===i.zW.SharedMedia?Ir.SharedMedia:y===i.zW.MemberList?Ir.MemberList:y===i.zW.GiftList?Ir.GiftList:y===i.zW.StoryList?Ir.StoryList:y===i.zW.SavedDialogs?Ir.SavedDialogs:-1:g?Ir.PollResults:m?Ir.StickerSearch:p?Ir.GifSearch:v?Ir.AddingMembers:n?A===i.je.Initial?Ir.ManageInitial:A===i.je.ChatPrivacyType?Ir.ManageChatPrivacyType:A===i.je.Discussion?Ir.ManageDiscussion:A===i.je.ChannelSubscribers?Ir.ManageChannelSubscribers:A===i.je.GroupPermissions?Ir.ManageGroupPermissions:A===i.je.ChatAdministrators?Ir.ManageChatAdministrators:A===i.je.GroupRemovedUsers?Ir.ManageGroupRemovedUsers:A===i.je.ChannelRemovedUsers?Ir.ManageChannelRemovedUsers:A===i.je.GroupUserPermissionsCreate?Ir.ManageGroupUserPermissionsCreate:A===i.je.GroupUserPermissions?Ir.ManageGroupUserPermissions:A===i.je.GroupRecentActions?Ir.ManageGroupRecentActions:A===i.je.ChatAdminRights?Ir.ManageGroupAdminRights:A===i.je.ChatNewAdminRights?Ir.ManageGroupNewAdminRights:A===i.je.GroupMembers?Ir.ManageGroupMembers:A===i.je.Invites?Ir.ManageInvites:A===i.je.EditInvite?Ir.ManageEditInvite:A===i.je.GroupAddAdmins?Ir.ManageGroupAddAdmins:A===i.je.Reactions?Ir.ManageReactions:A===i.je.InviteInfo?Ir.ManageInviteInfo:A===i.je.JoinRequests?Ir.ManageJoinRequests:A===i.je.NewDiscussionGroup?Ir.NewDiscussionGroup:void 0:r?Ir.Statistics:c?Ir.MessageStatistics:l?Ir.StoryStatistics:h?Ir.BoostStatistics:f?Ir.CreateTopic:I?Ir.EditTopic:u?Ir.MonetizationStatistics:S?Ir.ThreadHistory:b?Ir.AgentChat:void 0,xe=(0,No.A)(Ue,!0)??-1,Ne=(0,qt.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,pa.Y)(La.A,{round:!0,ripple:!re,size:"smaller",color:"translucent",className:t?"active":"",onClick:e,ariaLabel:Be("AriaLabelOpenMenu"),iconName:"more"}),[re,Be]),Re=re||!D&&(Ue===Ir.SharedMedia||Ue===Ir.GiftList||Ue===Ir.MemberList||Ue===Ir.StoryList||Ue===Ir.AddingMembers||Ue===Ir.MessageStatistics||Ue===Ir.StoryStatistics||n),Je=(0,Kt.A)("animated-close-icon",Re&&"state-back",(ke||R)&&"no-transition");return(0,pa.FD)("div",{className:"RightHeader","data-tauri-drag-region":!(!vt.Vq||!d.MP)||void 0,style:de("rightHeader",!0),children:[(0,pa.Y)(La.A,{className:"close-button",round:!0,color:"translucent",size:"smaller",onClick:Pe,ariaLabel:Fe(Re?"Common.Back":"Common.Close"),children:(0,pa.Y)("div",{className:Je})}),(0,pa.Y)(Na.Ay,{name:ke||R?"none":"slideFade",activeKey:Number(xe),children:function(){if(-1!==xe)switch(xe){case Ir.PollResults:return(0,pa.Y)("h3",{className:"title",children:Fe("PollResults")});case Ir.AddingMembers:return(0,pa.Y)("h3",{className:"title",children:Fe(T?"ChannelAddSubscribers":"GroupAddMembers")});case Ir.ManageInitial:return(0,pa.Y)("h3",{className:"title",children:Fe("Edit")});case Ir.ManageChatPrivacyType:return(0,pa.Y)("h3",{className:"title",children:Fe(T?"ChannelTypeHeader":"GroupTypeHeader")});case Ir.ManageDiscussion:return(0,pa.Y)("h3",{className:"title",children:Fe("Discussion")});case Ir.ManageChatAdministrators:return(0,pa.Y)("h3",{className:"title",children:Fe("ChannelAdministrators")});case Ir.ManageGroupRecentActions:return(0,pa.Y)("h3",{className:"title",children:Fe("Group.Info.AdminLog")});case Ir.ManageGroupAdminRights:return(0,pa.Y)("h3",{className:"title",children:Fe("EditAdminRights")});case Ir.ManageGroupNewAdminRights:return(0,pa.Y)("h3",{className:"title",children:Fe("SetAsAdmin")});case Ir.ManageGroupPermissions:return(0,pa.Y)("h3",{className:"title",children:Fe("ChannelPermissions")});case Ir.ManageGroupRemovedUsers:return(0,pa.Y)("h3",{className:"title",children:Fe("BlockedUsers")});case Ir.ManageChannelRemovedUsers:return(0,pa.Y)("h3",{className:"title",children:Fe("ChannelBlockedUsers")});case Ir.ManageGroupUserPermissionsCreate:return(0,pa.Y)("h3",{className:"title",children:Fe("ChannelAddException")});case Ir.ManageGroupUserPermissions:return(0,pa.Y)("h3",{className:"title",children:Fe("UserRestrictions")});case Ir.ManageInvites:return(0,pa.Y)("h3",{className:"title",children:Fe("lng_group_invite_title")});case Ir.ManageEditInvite:return(0,pa.Y)("h3",{className:"title",children:Fe(U?"EditLink":"NewLink")});case Ir.ManageInviteInfo:return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("h3",{className:"title",children:Fe("InviteLink")}),(0,pa.FD)("section",{className:"tools",children:[N&&!N.isRevoked&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("Edit"),onClick:Ie,iconName:"edit"}),N&&N.isRevoked&&(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(La.A,{round:!0,color:"danger",size:"smaller",ariaLabel:Fe("Delete"),onClick:ne,iconName:"delete"}),(0,pa.Y)(an.A,{isOpen:oe,onClose:ie,title:Fe("DeleteLink"),text:Fe("DeleteLinkHelp"),confirmIsDestructive:!0,confirmLabel:Fe("Delete"),confirmHandler:ve})]})]})]});case Ir.ManageJoinRequests:return(0,pa.Y)("h3",{className:"title",children:Fe(T?"SubscribeRequests":"MemberRequests")});case Ir.ManageGroupAddAdmins:return(0,pa.Y)("h3",{className:"title",children:Fe("Channel.Management.AddModerator")});case Ir.StickerSearch:return(0,pa.Y)(ws.A,{value:F,placeholder:Fe("SearchStickersHint"),autoFocusSearch:!0,onChange:be});case Ir.GifSearch:return(0,pa.Y)(ws.A,{value:B,placeholder:Fe("SearchGifsTitle"),autoFocusSearch:!0,onChange:Se});case Ir.Statistics:return(0,pa.Y)("h3",{className:"title",children:Fe(T?"ChannelStats.Title":"GroupStats.Title")});case Ir.MessageStatistics:return(0,pa.Y)("h3",{className:"title",children:Fe("Stats.MessageTitle")});case Ir.StoryStatistics:return(0,pa.Y)("h3",{className:"title",children:Fe("Stats.StoryTitle")});case Ir.BoostStatistics:return(0,pa.Y)("h3",{className:"title",children:Fe("Boosts")});case Ir.MonetizationStatistics:return(0,pa.Y)("h3",{className:"title",children:Fe("lng_channel_earn_title")});case Ir.SharedMedia:return(0,pa.Y)("h3",{className:"title",children:Fe("SharedMedia")});case Ir.ManageChannelSubscribers:return(0,pa.Y)("h3",{className:"title",children:Fe("ChannelSubscribers")});case Ir.MemberList:case Ir.ManageGroupMembers:return(0,pa.Y)("h3",{className:"title",children:Fe("GroupMembers")});case Ir.StoryList:return(0,pa.Y)("h3",{className:"title",children:Fe(P?"Settings.MyStories":"PeerInfo.PaneStories")});case Ir.SavedDialogs:return(0,pa.FD)("div",{className:"header",children:[(0,pa.Y)("h3",{className:"title",children:Fe("SavedMessagesTab")}),(0,pa.Y)("div",{className:"subtitle",children:Fe("Chats",fe[s.pX9])})]});case Ir.ManageReactions:return(0,pa.Y)("h3",{className:"title",children:Fe("Reactions")});case Ir.CreateTopic:return(0,pa.Y)("h3",{className:"title",children:Fe("NewTopic")});case Ir.EditTopic:return(0,pa.Y)("h3",{className:"title",children:Fe("EditTopic")});case Ir.GiftList:return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("h3",{className:"title",children:Be("ProfileTabGifts")}),V&&e&&(0,pa.Y)("section",{className:"tools",children:(0,pa.FD)(vs.A,{trigger:Ne,positionX:"right",autoClose:!1,children:[(0,pa.Y)(ja.A,{icon:"byDate"===ce?"cash-circle":"calendar-filter",onClick:()=>ae({peerId:e,filter:{sortType:"byDate"===ce?"byValue":"byDate"}}),children:Be("byDate"===ce?"GiftSortByValue":"GiftSortByDate")}),(0,pa.Y)(cs.A,{}),(0,pa.Y)(ja.A,{icon:le?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeUnlimited:!le}}),children:Be("GiftFilterUnlimited")}),(0,pa.Y)(ja.A,{icon:ue?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeLimited:!ue}}),children:Be("GiftFilterLimited")}),(0,pa.Y)(ja.A,{icon:he?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeUpgradable:!he}}),children:Be("GiftFilterUpgradable")}),(0,pa.Y)(ja.A,{icon:me?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeUnique:!me}}),children:Be("GiftFilterUnique")}),j&&(0,pa.FD)(pa.FK,{children:[(0,pa.Y)(cs.A,{}),(0,pa.Y)(ja.A,{icon:pe?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeDisplayed:!pe}}),children:Be("GiftFilterDisplayed")}),(0,pa.Y)(ja.A,{icon:ge?"check":"placeholder",onClick:()=>ae({peerId:e,filter:{shouldIncludeHidden:!ge}}),children:Be("GiftFilterHidden")})]})]})})]});case Ir.NewDiscussionGroup:return(0,pa.Y)("h3",{className:"title",children:Fe("NewGroup")});case Ir.AgentChat:return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("h3",{className:"title",children:Be("AiAgent")}),(0,pa.Y)("section",{className:"tools",children:(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Show thread history",onClick:K,iconName:"clock"})})]});default:return(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("h3",{className:"title",children:q?Be("MyProfileHeader"):Fe(D?"SavedMessages":Y?"AccDescrTopic":T?"Channel.TitleInfo":C?J?"lng_info_bot_title":"lng_info_user_title":"GroupInfo.Title")}),(0,pa.FD)("section",{className:"tools",children:[M&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("AddContact"),onClick:ye,iconName:"add-user"}),k&&!Y&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("Edit"),onClick:Ae,iconName:"edit"}),L&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("Edit"),onClick:Ae,iconName:"edit"}),E&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("EditTopic"),onClick:we,iconName:"edit"}),x&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Fe("Statistics"),onClick:Me,iconName:"stats"}),q&&(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:Be("Edit"),onClick:Ce,iconName:"edit"})]})]})}}()})]})});var br=a(55317),Sr=a(47058),yr=a(20333),wr=a(71950);const Ar={root:"gk6pIryJ",noResults:"WP4wRUbm","section-header":"LWcgK3OX",sectionHeader:"LWcgK3OX",section:"C8KF95yU",user:"oMy5KOFr",stats:"GOzrl0zF",down:"QuLtxDUV",loadMoreSpinner:"ln5zB7KK",status:"r3zLiaXx",info:"Eo1qQlxx",month:"McSPvm0N",quantity:"s1yf_GJa",floatingBadge:"oSCjRZtx",floatingBadgeButtonColor:"duVpAT_e",floatingBadgeWarning:"DsJMXNNk",floatingBadgeButton:"urrWJVYB",floatingBadgeIcon:"hcA9VPeV",floatingBadgeValue:"hHkCO4Ge",content:"SG00REIA",boostSection:"ETgjBS4d",giveawayButton:"wOCtp5Kk",giveawayIcon:"B9GF4NDB",primaryLink:"GXmXwIbx",copy:"rB0gc1GX",boostInfo:"BhoA3MT6"};var Mr=a(72078),Cr=a(68153),Pr=a(65741),kr=a(45318);const Tr={3:Cr,6:Mr,12:Pr},Fr={isCustomPeer:!0,avatarIcon:"star",peerColorId:1},Br={isCustomPeer:!0,titleKey:"BoostingToBeDistributed",avatarIcon:"user",withPremiumGradient:!0},Ur=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e).boostStatistics,a=(0,C.hc)(e),s=t&&t.chatId,o=s?(0,C.hds)(e,s):void 0,n=o&&(0,S.WX)(o),i=e.appConfig.giveawayBoostsPerPremium,{animationLevel:r}=(0,je.lS)(e);return{boostStatistics:t,isGiveawayAvailable:a,chatId:s,giveawayBoostsPerPremium:i,isChannel:n,animationLevel:r}})(({boostStatistics:e,isGiveawayAvailable:t,chatId:a,giveawayBoostsPerPremium:o,isChannel:n,animationLevel:i})=>{const{openChat:r,loadMoreBoosters:d,closeBoostStatistics:c,openGiveawayModal:l,showNotification:u}=(0,w.ko)(),h=(0,Da.A)(),m=(0,qt.li)(),p=e?.boostStatus,g=p?e.boostStatus:void 0,f=!(e&&e?.boosts?.count===e?.giftedBoosts?.count)&&e?.giftedBoosts&&e?.giftedBoosts?.list?.length>0,{currentLevel:I,hasNextLevel:v,boosts:b,levelProgress:S,remainingBoosts:y}=(0,qt.Kr)(()=>g?(0,br.z)(g):{currentLevel:0,hasNextLevel:!1,boosts:0,levelProgress:0,remainingBoosts:0,prepaidGiveaways:[]},[g]),A=(0,qt.Kr)(()=>{if(g)return{level:I,boosts:b,premiumSubscribers:g.premiumSubscribers,remainingBoosts:y,prepaidGiveaways:g.prepaidGiveaways}},[g,b,I,y]),M=(0,qt.Kr)(()=>f?[{type:"boostList",title:h("BoostingBoostsCount",e?.boosts?.count,"i")},{type:"giftedBoostList",title:h("BoostingGiftsCount",e?.giftedBoosts?.count,"i")}]:[],[f,h,e?.boosts?.count,e?.giftedBoosts?.count]),C=(0,qt.Kr)(()=>e?.boosts&&e.boosts?.list.length>0?1:0,[e]),[P,k]=(0,qt.J0)(C),T=P>M.length-1?M.length-1:P,F=M[T]?.type,B=M.findIndex(({type:e})=>e===F),U=(0,qt.Kr)(()=>{if(!e)return;const t=f?"boostList"===F?e.boosts:e.giftedBoosts:e.boosts;if(!t?.count)return;const a=t.list.reduce((e,t)=>e+(t.multiplier||1),0),s=t.count-a;return s>0?s:void 0},[f,e,F]),x=(0,ta.A)(e=>(0,pa.Y)("div",{className:Ar.quantity,children:(0,pa.FD)("div",{className:(0,Kt.A)(Ar.floatingBadge,Ar.floatingBadgeButtonColor),children:[(0,pa.Y)(Ga.A,{name:"boost",className:Ar.floatingBadgeIcon}),(0,pa.Y)("div",{className:Ar.floatingBadgeValue,children:e})]})})),N=(0,ta.A)(e=>{if(e.isFromGiveaway||e.isGift)return(0,pa.Y)("div",{className:Ar.quantity,children:(0,pa.FD)("div",{className:(0,Kt.A)(Ar.floatingBadge,!e.isFromGiveaway&&Ar.floatingBadgeWarning,Ar.floatingBadgeButtonColor,Ar.floatingBadgeButton),children:[(0,pa.Y)(Ga.A,{name:"gift",className:Ar.floatingBadgeIcon}),(0,pa.Y)("div",{className:Ar.floatingBadgeValue,children:h(e.isFromGiveaway?"BoostingGiveaway":"BoostingGift")})]})})}),R=(0,ta.A)(e=>{e?(r({id:e}),c()):u({message:h("BoostingRecipientWillBeSelected")})}),J=(0,ta.A)(e=>{let t;return Boolean(e?.stars)&&(t={...Fr,title:h("Stars",e.stars)}),e.userId||(t=Br),(0,pa.Y)(ar.A,{className:(0,Kt.A)(Ar.boostInfo,"chat-item-clickable"),onClick:()=>R(e.userId),children:(0,pa.Y)(ko.A,{className:Ar.user,userId:e.userId,customPeer:t,status:h("BoostExpireOn",(0,ye.U)(h,1e3*e.expires)),noEmojiStatus:!0,forceShowSelf:!0,noFake:!0,noVerified:!0,iconElement:e.multiplier?x(e.multiplier):void 0,rightElement:N(e)})})}),Y=(0,ta.A)(()=>{l({chatId:a})}),E=(0,ta.A)(e=>{e.preventDefault(),d({isGifts:"giftedBoostList"===F})}),D=(0,ta.A)(e=>{l({chatId:a,prepaidGiveaway:e})});return(0,pa.FD)("div",{className:(0,Kt.A)(Ar.root,"panel-content custom-scroll"),children:[!p&&(0,pa.Y)(Ra.A,{}),p&&A&&(0,pa.FD)(pa.FK,{children:[(0,pa.FD)("div",{className:Ar.section,children:[(0,pa.Y)(yr.A,{leftText:h("BoostsLevel",I),rightText:v?h("BoostsLevel",I+1):void 0,progress:S,floatingBadgeText:(0,Aa.Sm)(b),floatingBadgeIcon:"boost"}),(0,pa.Y)(wr.A,{className:Ar.stats,statistics:A,type:"boost"})]}),A.prepaidGiveaways&&(0,pa.FD)("div",{className:Ar.section,children:[(0,pa.Y)("h4",{className:Ar.sectionHeader,dir:h.isRtl?"rtl":void 0,children:h("BoostingPreparedGiveaways")}),A?.prepaidGiveaways?.map(e=>{const t="stars"in e;return(0,pa.Y)(ar.A,{className:"chat-item-clickable",onClick:()=>D(e),children:(0,pa.FD)("div",{className:(0,Kt.A)(Ar.status,"status-clickable"),children:[(0,pa.Y)("div",{children:t?(0,pa.Y)("img",{src:kr,className:Ar.giveawayIcon,alt:h("GiftStar")}):(0,pa.Y)("img",{src:Tr[e.months]||Tr[3],className:Ar.giveawayIcon,alt:h("Giveaway")})}),(0,pa.FD)("div",{className:Ar.info,children:[(0,pa.Y)("h3",{children:t?h("Giveaway.Stars.Prepaid.Title",e.stars):h("BoostingTelegramPremiumCountPlural",e.quantity)}),(0,pa.Y)("p",{className:Ar.month,children:t?h("Giveaway.Stars.Prepaid.Desc",e.quantity):h("PrepaidGiveawayMonths",e.months)})]}),(0,pa.Y)("div",{className:Ar.quantity,children:(0,pa.FD)("div",{className:(0,Kt.A)(Ar.floatingBadge,Ar.floatingBadgeButtonColor,Ar.floatingBadgeButton),children:[(0,pa.Y)(Ga.A,{name:"boost",className:Ar.floatingBadgeIcon}),(0,pa.Y)("div",{className:Ar.floatingBadgeValue,dir:h.isRtl?"rtl":void 0,children:t?e.boosts:e.quantity*(o??s.CQG)})]})})]})},e.id)}),(0,pa.Y)("p",{className:"text-muted hint",children:h("BoostingSelectPaidGiveaway")},"links-hint")]}),(0,pa.FD)("div",{className:Ar.section,children:[f?(0,pa.FD)("div",{className:(0,Kt.A)(Ar.boostSection,Ar.content),children:[(0,pa.Y)(Na.Ay,{ref:m,name:(0,ka.P)("slideOptimized",i,void 0,h.isRtl),activeKey:B,renderCount:M.length,shouldRestoreHeight:!0,children:function(){let t;if("boostList"===F?t=e?.boosts?.list:"giftedBoostList"===F&&(t=e?.giftedBoosts?.list),!t||t?.length)return(0,pa.Y)("div",{className:Ar.section,children:t?.map(e=>J(e))})}()}),(0,pa.Y)(Qa.A,{activeTab:T,tabs:M,onSwitchTab:k})]}):(0,pa.FD)(pa.FK,{children:[(0,pa.Y)("h4",{className:Ar.sectionHeader,dir:h.isRtl?"rtl":void 0,children:h("BoostingBoostsCount",e?.boosts?.count)}),!e?.boosts?.list?.length&&(0,pa.Y)("div",{className:Ar.noResults,children:h(n?"NoBoostersHint":"NoBoostersGroupHint")}),e?.boosts?.list?.map(e=>J(e))]}),Boolean(U)&&(0,pa.FD)(ar.A,{className:Ar.showMore,disabled:e?.isLoadingBoosters,onClick:E,children:[e?.isLoadingBoosters?(0,pa.Y)(Ms.A,{className:Ar.loadMoreSpinner}):(0,pa.Y)(Ga.A,{name:"down",className:Ar.down}),h("ShowVotes",U,"i")]},"load-more")]}),(0,pa.Y)(Sr.A,{className:Ar.section,link:g.boostUrl,withShare:!0,title:h("LinkForBoosting")}),t&&(0,pa.FD)("div",{className:Ar.section,children:[(0,pa.Y)(ar.A,{icon:"gift",onClick:Y,className:Ar.giveawayButton,children:h("BoostingGetBoostsViaGifts")},"load-more"),(0,pa.Y)("p",{className:"text-muted hint",children:h(n?"BoostingGetMoreBoosts":"BoostingGetMoreBoostsGroup")},"links-hint")]})]})]})})),xr=e=>{const t=(0,ma.A)(Xt.ar.Extra,"MessageStatistics");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})};var Nr=a(75319);const Rr=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"AboutMonetizationModal",!t);return a?(0,pa.Y)(a,{...e}):void 0};var Jr=a(84685);const Yr={root:"vBPv6lUS",graph:"EbPbvB1I",hidden:"nsPIlLYL",ready:"s6qyDhkE",section:"cB2IkwY6",topText:"FLOpxZd1",availableReward:"emE6bAD8",rewardValue:"eyDAxGDU",decimalPart:"jkRV_L7b",integer:"xE9kfGi7",decimalUsdPart:"hWMnYdxX",toncoinIcon:"ubDl9CvS",textBottom:"P3qZJJzF"};let Er,Dr;const Or={topHoursGraph:"ChannelStats.Graph.ViewsByHours",revenueGraph:"lng_channel_earn_chart_revenue"},Lr=Object.keys(Or),Gr=(0,qt.ph)((0,w.EK)(e=>{const t=(0,C.nTw)(e),{settings:{byKey:{hasPassword:a}}}=e,s=t.monetizationStatistics,o=s&&s.chatId,n=o?(0,C.hds)(e,o):void 0,i=(0,C.AWZ)(e,o)?.statisticsDcId,r=Boolean(n?.isCreator);return{chatId:o,dcId:i,statistics:t.statistics.monetization,isCreator:r,isChannelRevenueWithdrawalEnabled:e.appConfig.isChannelRevenueWithdrawalEnabled,hasPassword:a}})(({chatId:e,dcId:t,statistics:s,isCreator:o,isChannelRevenueWithdrawalEnabled:n,hasPassword:i})=>{const{loadChannelMonetizationStatistics:r,openMonetizationVerificationModal:d,loadPasswordInfo:c}=(0,w.ko)(),l=(0,Da.A)(),u=(0,ea.A)(),h=(0,qt.li)(),[m,p]=(0,qt.J0)(!1),g=(0,qt.li)(new Set),f=(0,qt.li)(new Set),I=(0,Zt.A)(),[v,b,S]=(0,os.A)(!1),[y,A,M]=(0,os.A)(),C=s?.balances?.availableBalance,P=s?.balances?.isWithdrawalEnabled,k=o&&n&&Boolean(C)&&P;(0,qt.vJ)(()=>{e&&(r({peerId:e}),c())},[e,r]),(0,qt.vJ)(()=>{(async()=>{await async function(){return Er||(Er=a.e(4810).then(a.bind(a,24810)),Dr=await Er),Er}(),m?(h.current&&Array.from(h.current.children).forEach(e=>{e.innerHTML="",e.classList.add(Yr.hidden)}),g.current.clear(),f.current.clear(),s&&h.current&&(Lr.forEach((e,t)=>{const a=s[e];if(!(0,Nr.R)(a))return;const o="async"===a.graphType,n="error"===a.graphType;if(!o&&!g.current.has(e)){if(n)return g.current.add(e),void f.current.add(e);Dr.create(h.current.children[t],{title:l(Or[e]),...a}),g.current.add(e),h.current.children[t].classList.remove(Yr.hidden)}}),I())):p(!0)})()},[m,s,l,e,t,I]);const T=(0,qt.Kr)(()=>{const e=l("LearnMore");return u("ChannelEarnAbout",{link:(0,pa.FD)(Tn.A,{isPrimary:!0,onClick:b,children:[e,(0,pa.Y)(Ga.A,{name:"next"})]})},{withNodes:!0})},[u,l]),F=(0,qt.Kr)(()=>{const e=l("LearnMore");return u("MonetizationBalanceZeroInfo",{link:(0,pa.FD)(Jr.A,{url:l("MonetizationProceedsInfoLink"),text:e,children:[e,(0,pa.Y)(Ga.A,{name:"next"})]})},{withNodes:!0})},[u,l]),B=(0,ta.A)(()=>{i?d({chatId:e}):A()});return m&&s?(0,pa.FD)("div",{className:(0,Kt.A)(Yr.root,"custom-scroll",m&&Yr.ready),children:[(0,pa.Y)("div",{className:(0,Kt.A)(Yr.section,Yr.topText),children:T}),(0,pa.Y)(wr.A,{statistics:s,isToncoin:!0,type:"monetization",title:l("MonetizationOverview"),subtitle:(0,pa.Y)("div",{className:Yr.textBottom,children:l("MonetizationProceedsTONInfo")})}),!g.current.size&&(0,pa.Y)(Ra.A,{}),(0,pa.Y)("div",{ref:h,className:Yr.section,children:Lr.filter(Boolean).map(e=>(0,pa.Y)("div",{className:(0,Kt.A)(Yr.graph,Yr.hidden)},e))}),(0,pa.FD)("div",{className:Yr.section,children:[l("lng_channel_earn_balance_title"),function(){const e=C?(0,jt.wD)(C.amount):0,[t,a]=e.toFixed(4).split("."),[o,n]=C&&s?.usdRate?(e*s.usdRate).toFixed(2).split("."):[0];return(0,pa.FD)("div",{className:Yr.availableReward,children:[(0,pa.FD)("div",{className:Yr.toncoin,children:[(0,pa.Y)(Ga.A,{className:Yr.toncoinIcon,name:"toncoin"}),(0,pa.FD)("b",{className:Yr.rewardValue,children:[t,a?(0,pa.FD)("span",{className:Yr.decimalPart,children:[".",a]}):void 0]})]})," ",(0,pa.FD)("span",{className:Yr.integer,children:[" $",o,n?(0,pa.FD)("span",{className:Yr.decimalUsdPart,children:[".",n]}):void 0]})]})}(),(0,pa.Y)(La.A,{type:"button",onClick:B,disabled:!k,children:l("MonetizationWithdraw")}),(0,pa.Y)("div",{className:Yr.textBottom,children:F})]}),(0,pa.Y)(Rr,{isOpen:v,onClose:S}),(0,pa.Y)(an.A,{isOnlyConfirm:!0,isOpen:y,onClose:M,confirmHandler:M,confirmLabel:u("OK"),children:(0,pa.Y)("p",{children:(0,ro.A)(l("Monetization.Withdraw.Error.Text"),["br"])})})]}):(0,pa.Y)(Ra.A,{})})),Vr=e=>{const t=(0,ma.A)(Xt.ar.Extra,"Statistics");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},jr=e=>{const t=(0,ma.A)(Xt.ar.Extra,"StoryStatistics");return t?(0,pa.Y)(t,{...e}):(0,pa.Y)(Ra.A,{})},qr=e=>{const{isActive:t}=e,a=(0,ma.A)(Xt.ar.Extra,"StickerSearch",!t);return a?(0,pa.Y)(a,{...e}):(0,pa.Y)(Ra.A,{})},zr=(0,qt.ph)((0,w.EK)(e=>{const t=(0,la.Z)(e),{chatId:a}=(0,C.Xf0)(e)||{};return{threads:t,alphahumanThreads:e.alphahuman?.threads,alphahumanThreadsLoading:e.alphahuman?.threadsLoading,alphahumanThreadsError:e.alphahuman?.threadsError,chatId:a}})(({isActive:e,onClose:t,threads:a,alphahumanThreads:s,alphahumanThreadsLoading:o,alphahumanThreadsError:n,chatId:i})=>{const{openAlphaHumanThread:r,loadAlphahumanThreads:d}=(0,w.ko)(),c=(0,Da.A)(),l=(0,qt.li)(!1);(0,qt.vJ)(()=>{e?l.current||o||s&&0!==s.length||n||(l.current=!0,d()):l.current=!1},[e,s,o,n,d]);const u=(0,ta.A)((e,a)=>{a&&(r({threadId:a}),t(!1))}),h=(0,qt.Kr)(()=>a?.byId?Object.values(a.byId).filter(e=>{const t=String(e.chatId)||"",a=i||"";return a?t===a:!t||""===t}).sort((e,t)=>{const a=e.timestamp instanceof Date?e.timestamp.getTime():0;return(t.timestamp instanceof Date?t.timestamp.getTime():0)-a}):[],[a,i]);return(0,pa.Y)("div",{className:"ThreadHistory",children:(0,pa.Y)("div",{className:"thread-list-wrapper",children:o?(0,pa.Y)("div",{className:"thread-list loading",children:Array.from({length:5}).map((e,t)=>(0,pa.Y)("div",{className:"thread-item",children:(0,pa.Y)(co.A,{width:350,height:40})},`skeleton-${t}`))}):0===h.length?(0,pa.Y)("div",{className:"empty-state",children:(0,pa.Y)("p",{children:c("NoThreads")||"No threads available"})}):(0,pa.Y)("div",{className:"thread-list",children:h.map(e=>(0,pa.Y)(ar.A,{className:"thread-item",onClick:u,clickArg:e.id,children:(0,pa.Y)("div",{className:"thread-title",children:e.title||"New Chat"})},e.id))})})})})),Hr=450+s.xB5,Kr=Object.keys(i.Ul).length/2,Wr=Object.keys(i.je).length/2;function _r(){const e=document.querySelector(".RightHeader .SearchInput input");e&&e.blur()}const Xr=(0,qt.ph)((0,w.EK)((e,{isMobile:t})=>{const{chatId:a,threadId:s}=(0,C.Xf0)(e)||{},o=(0,C.bE$)(e),{animationLevel:n}=(0,je.lS)(e),{management:i,shouldSkipHistoryAnimations:r,shouldCloseRightColumn:d,chatInfo:c}=(0,C.nTw)(e),l=a?i.byChatId[a]?.nextScreen:void 0,u=c?.isOwnProfile,h=a&&!u?(0,C.nZ4)(e,a):void 0,m=a?(0,S.cG)(a,s,e.currentUserId):void 0;return{contentKey:(0,C.t75)(e,t),chatId:a,threadId:s,isChatSelected:Boolean(a&&o),animationLevel:n,shouldSkipHistoryAnimations:r,nextManagementScreen:l,shouldCloseRightColumn:d,isSavedMessages:h,isSavedDialog:m,isOwnProfile:u}})(({contentKey:e,chatId:t,threadId:a,isMobile:o,isChatSelected:n,animationLevel:r,shouldSkipHistoryAnimations:d,nextManagementScreen:c,shouldCloseRightColumn:l,isSavedMessages:u,isSavedDialog:h,isOwnProfile:m})=>{const{toggleChatInfo:p,toggleManagement:g,toggleAgentChat:f,toggleThreadHistory:I,setStickerSearchQuery:v,setGifSearchQuery:b,closePollResults:S,addChatMembers:y,setNewChatMembersDialogState:A,setEditingExportedInvite:M,toggleStatistics:C,toggleMessageStatistics:P,toggleStoryStatistics:k,setOpenedInviteInfo:T,requestNextManagementScreen:F,closeCreateTopicPanel:B,closeEditTopicPanel:U,closeBoostStatistics:x,setShouldCloseRightColumn:N,closeMonetizationStatistics:R}=(0,w.ko)(),J=(0,qt.li)(),{width:Y}=(0,Zs.A)(),[E,D]=(0,qt.J0)(u&&!h?i.zW.SavedDialogs:i.zW.Profile),[O,L]=(0,qt.J0)(i.je.Initial),[G,V]=(0,qt.J0)(),[j,q]=(0,qt.J0)(),z=E!==i.zW.Profile,H=void 0!==e,K=e===i.Ul.ChatInfo,W=e===i.Ul.Management,_=e===i.Ul.Statistics,X=e===i.Ul.MessageStatistics,$=e===i.Ul.StoryStatistics,Q=e===i.Ul.BoostStatistics,Z=e===i.Ul.MonetizationStatistics,ee=e===i.Ul.StickerSearch,te=e===i.Ul.GifSearch,ae=e===i.Ul.PollResults,se=e===i.Ul.AddingMembers,oe=e===i.Ul.CreateTopic,ne=e===i.Ul.EditTopic,ie=e===i.Ul.AgentChat,re=e===i.Ul.ThreadHistory,de=Y<=s.gQx,[ce,le]=(0,qt.J0)(!H),[ue,he]=(0,qt.J0)(!1),me=(0,No.A)(e,!0,!n)??-1;(0,Zn.A)({containerRef:J,selector:":scope .custom-scroll, :scope .panel-content"},[e,O,t,a]);const pe=(0,ta.A)(()=>{he(!0)}),ge=(0,ta.A)(()=>{he(!1)}),fe=(0,ta.A)((a=!0)=>{switch(e){case i.Ul.AddingMembers:A({newChatMembersProgress:i.D7.Closed});break;case i.Ul.ChatInfo:if(z&&a&&!u){D(i.zW.Profile);break}p({force:!1},{forceSyncOnIOs:!0});break;case i.Ul.Management:switch(O){case i.je.Initial:g();break;case i.je.ChatPrivacyType:case i.je.Discussion:case i.je.GroupPermissions:case i.je.GroupType:case i.je.ChatAdministrators:case i.je.ChannelSubscribers:case i.je.GroupMembers:case i.je.Invites:case i.je.Reactions:case i.je.JoinRequests:case i.je.ChannelRemovedUsers:L(i.je.Initial);break;case i.je.GroupUserPermissionsCreate:case i.je.GroupRemovedUsers:case i.je.GroupUserPermissions:L(i.je.GroupPermissions),V(void 0),q(void 0);break;case i.je.NewDiscussionGroup:L(i.je.Discussion);break;case i.je.ChatAdminRights:case i.je.ChatNewAdminRights:case i.je.GroupAddAdmins:case i.je.GroupRecentActions:L(i.je.ChatAdministrators);break;case i.je.EditInvite:case i.je.InviteInfo:L(i.je.Invites),T({chatId:t,invite:void 0}),M({chatId:t,invite:void 0})}break;case i.Ul.MessageStatistics:P();break;case i.Ul.StoryStatistics:k();break;case i.Ul.Statistics:C();break;case i.Ul.BoostStatistics:x();break;case i.Ul.MonetizationStatistics:R();break;case i.Ul.StickerSearch:_r(),v({query:void 0});break;case i.Ul.GifSearch:_r(),b({query:void 0});break;case i.Ul.PollResults:S();break;case i.Ul.CreateTopic:B();break;case i.Ul.EditTopic:U();break;case i.Ul.AgentChat:f({force:!1});break;case i.Ul.ThreadHistory:I({force:!1})}}),Ie=(0,ta.A)((e,t)=>{V(e),q(t)}),ve=(0,ta.A)(e=>{y({chatId:t,memberIds:e})});return(0,qt.vJ)(()=>H&&t?(0,Pa.A)(fe):void 0,[H,fe,t]),(0,qt.vJ)(()=>{setTimeout(()=>{le(!H)},Hr)},[H]),(0,qt.vJ)(()=>{c&&(L(c),F(void 0))},[c]),(0,qt.vJ)(()=>{l&&(fe(),N({value:void 0}))},[l]),(0,qt.vJ)(()=>{H&&de&&fe()},[de]),(0,Qn.A)(([e,s])=>{e===t&&s===a||(D(u&&!h?i.zW.SavedDialogs:i.zW.Profile),L(i.je.Initial))},[t,a,h,u]),(0,ua.A)({isActive:n&&(e===i.Ul.ChatInfo||e===i.Ul.Management||e===i.Ul.AddingMembers||e===i.Ul.CreateTopic||e===i.Ul.EditTopic),onBack:()=>fe(!1)}),(0,pa.FD)("div",{id:"RightColumn-wrapper",className:(0,Kt.A)(!n&&"is-hidden",ie&&ue&&"thread-history-overlay-open"),children:[de&&(0,pa.Y)("div",{className:"overlay-backdrop",onClick:fe}),(0,pa.FD)("div",{id:"RightColumn",children:[(0,pa.Y)(vr,{chatId:t,threadId:a,isColumnOpen:H,isProfile:K,isManagement:W,isStatistics:_,isBoostStatistics:Q,isMonetizationStatistics:Z,isMessageStatistics:X,isStoryStatistics:$,isStickerSearch:ee,isGifSearch:te,isPollResults:ae,isCreatingTopic:oe,isEditingTopic:ne,isAddingChatMembers:se,isAgentChat:ie,isThreadHistory:re,profileState:E,managementScreen:O,onClose:fe,onScreenSelect:L,onOpenThreadHistoryOverlay:pe}),(0,pa.Y)(Na.Ay,{ref:J,name:(0,ka.P)("layers",r,ce||d),renderCount:Kr+Wr,activeKey:W?Kr+O:me,shouldCleanup:!0,cleanupExceptionKey:me===i.Ul.MessageStatistics||me===i.Ul.StoryStatistics?i.Ul.Statistics:void 0,children:function(e){if(-1!==me)switch(me){case i.Ul.AddingMembers:return(0,pa.Y)(si,{chatId:t,isActive:H&&e,onNextStep:ve,onClose:fe},`add_chat_members_${t}`);case i.Ul.ChatInfo:return(0,pa.Y)(gr,{chatId:t,threadId:a,profileState:E,isMobile:o,isActive:H&&e,onProfileStateChange:D},`profile_${t}_${a}_${Boolean(m)}`);case i.Ul.Management:return(0,pa.Y)(ui,{chatId:t,currentScreen:O,isPromotedByCurrentUser:j,selectedChatMemberId:G,isActive:H&&e,onScreenSelect:L,onChatMemberSelect:Ie,onClose:fe},`management_${t}_${O}`);case i.Ul.Statistics:return(0,pa.Y)(Vr,{chatId:t});case i.Ul.BoostStatistics:return(0,pa.Y)(Ur,{});case i.Ul.MonetizationStatistics:return(0,pa.Y)(Gr,{});case i.Ul.MessageStatistics:return(0,pa.Y)(xr,{chatId:t,isActive:H&&e});case i.Ul.StoryStatistics:return(0,pa.Y)(jr,{chatId:t,isActive:H&&e});case i.Ul.StickerSearch:return(0,pa.Y)(qr,{onClose:fe,isActive:H&&e});case i.Ul.GifSearch:return(0,pa.Y)(li,{onClose:fe,isActive:H&&e});case i.Ul.PollResults:return(0,pa.Y)(hi,{onClose:fe,isActive:H&&e});case i.Ul.CreateTopic:return(0,pa.Y)(di,{onClose:fe,isActive:H&&e});case i.Ul.EditTopic:return(0,pa.Y)(ci,{onClose:fe,isActive:H&&e});case i.Ul.AgentChat:return(0,pa.Y)(ri,{});case i.Ul.ThreadHistory:return(0,pa.Y)(zr,{onClose:fe,isActive:H&&e})}}})]}),ie&&ue&&(0,pa.FD)("div",{className:"thread-history-overlay",children:[(0,pa.FD)("div",{className:"thread-history-overlay-header",children:[(0,pa.Y)(La.A,{round:!0,color:"translucent",size:"smaller",ariaLabel:"Back",onClick:ge,iconName:"arrow-left"}),(0,pa.Y)("h3",{className:"thread-history-overlay-title",children:"Thread History"})]}),(0,pa.Y)("div",{className:"thread-history-overlay-content",children:(0,pa.Y)(zr,{isActive:ue,onClose:ge})})]})]})})),$r=(0,qt.ph)(({isOpen:e})=>{const t=(0,ma.A)(Xt.ar.Extra,"StoryViewer",!e);return t?(0,pa.Y)(t,{}):void 0}),Qr=e=>{const{requestedAttachBotInChat:t}=e,a=(0,ma.A)(Xt.ar.Extra,"AttachBotRecipientPicker",!t);return a?(0,pa.Y)(a,{...e}):void 0},Zr=e=>{const{bot:t}=e,a=(0,ma.A)(Xt.ar.Extra,"BotTrustModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},ed=e=>{const{folder:t}=e,a=(0,ma.A)(Xt.ar.Extra,"DeleteFolderDialog",!t);return a?(0,pa.Y)(a,{...e}):void 0};var td=a(26087),ad=a(95362),sd=a(14235),od=a(56133);const nd=new Set,id=new Set,rd=(0,qt.ph)((0,w.EK)(e=>({activeDownloads:(0,C.nTw)(e).activeDownloads}))(({activeDownloads:e})=>{const{cancelMediaHashDownloads:t,showNotification:a}=(0,w.ko)(),s=(0,od.A)(1e3,!0),o=(0,ta.A)(e=>{id.add(e),s(()=>{id.size&&(t({mediaHashes:Array.from(id)}),id.clear())})});(0,qt.vJ)(()=>{Object.keys(e).length?Object.entries(e).forEach(([e,t])=>{if(nd.has(e))return;nd.add(e);const{size:s,filename:i,format:r}=t,c=tt.Ih(e);if(c)return(0,ad.A)(c,i),void o(e);if(s>d.kn&&!d.l5&&!d.Tz)return a({message:"Downloading files bigger than 2GB is not supported in your browser."}),void o(e);const l=()=>{(0,C.nTw)((0,w.mS)()).activeDownloads[e]||tt.ch(l)};tt.hd(e,r,!0,l,(0,sd.A)()).then(t=>{if(r===n.qZ.DownloadUrl){const e=new URL(t,window.document.baseURI);e.searchParams.set("filename",encodeURIComponent(i));const s=window.open(e.toString());s?.addEventListener("beforeunload",()=>{a({message:"Download started. Please, do not close the app before it is finished."})})}else t&&(0,ad.A)(t,i);o(e)})}):nd.clear()},[e])})),dd=e=>{const{requestedDraft:t}=e,a=(0,ma.A)(Xt.ar.Extra,"DraftRecipientPicker",!t);return a?(0,pa.Y)(a,{...e}):void 0};var cd=a(47366),ld=a(98028);const ud={root:"kRuZeoF6",tabs:"rABcVLvv",icon:"os3EiiML",menuButton:"wrXChz0J",divider:"tXL6PpB_",hideMenuButton:"OkCgWlzE"},hd=(0,qt.ph)((0,w.EK)(e=>{const{chatFolders:{byId:t,orderedIds:a,invites:s}}=e,{activeChatFolder:o}=(0,C.nTw)(e);return{chatFoldersById:t,folderInvitesById:s,orderedFolderIds:a,activeChatFolder:o,maxFolders:(0,fe.d)(e,"dialogFilters"),maxFolderInvites:(0,fe.d)(e,"chatlistInvites"),maxChatLists:(0,fe.d)(e,"chatlistJoined")}})(({chatFoldersById:e,orderedFolderIds:t,activeChatFolder:a,maxFolders:s,maxChatLists:o,folderInvitesById:n,maxFolderInvites:r,isActive:c})=>{const{loadChatFolders:l,setActiveChatFolder:u,openLeftColumnContent:h,openSettingsScreen:m}=(0,w.ko)(),p=(0,qt.li)();(0,qt.vJ)(()=>{l()},[]);const g=(0,ta.A)(()=>{const e=document.querySelector("#LeftColumn .chat-list.Transition_slide-active");e?.scrollTo({top:0,behavior:"smooth"})}),{folderTabs:f}=Xa({sidebarMode:!0,orderedFolderIds:t,chatFoldersById:e,maxFolders:s,maxChatLists:o,folderInvitesById:n,maxFolderInvites:r}),{handleScroll:I,isAtBeginning:v,isAtEnd:b}=(0,cd.A)(),S=(0,ea.A)(),y=(0,ta.A)(e=>{h({contentKey:i.Bn.ChatList}),m({screen:void 0}),u({activeChatFolder:e},{forceOnHeavyAnimation:!0}),a===e&&g(),p.current?.children[e]?.scrollIntoView({behavior:"smooth",block:"center"})}),A=(0,ta.A)(()=>{h({contentKey:i.Bn.Settings}),m({screen:i.VS.Folders})});(0,qt.vJ)(()=>{f?.length&&a>=f.length&&u({activeChatFolder:0})},[a,f,u]);const M=(0,qt.Kr)(()=>({onTrigger:e,isOpen:t})=>(0,pa.Y)(La.A,{color:"translucent",className:(0,Kt.A)(t?"active":"",ud.menuButton),onClick:e,ariaLabel:S("AriaLabelOpenMenu"),iconName:"menu",iconClassName:ud.icon}),[S]);if(c)return(0,pa.FD)("div",{className:ud.root,id:"FoldersSidebar",children:[(0,pa.Y)(bs,{trigger:M,className:(0,Kt.A)(vt.Vq&&d.MP&&ud.hideMenuButton)}),!v&&(0,pa.Y)("div",{className:ud.divider}),(0,pa.Y)("div",{ref:p,className:(0,Kt.A)(ud.tabs,"custom-scroll","no-scrollbar"),onScroll:I,children:f?.map((e,t)=>(0,pa.Y)(ld.A,{title:e.title,isActive:t===a,isBlocked:e.isBlocked,badgeCount:e.badgeCount,isBadgeActive:e.isBadgeActive,onClick:y,clickArg:t,contextActions:e.contextActions,contextRootElementSelector:"#FoldersSidebar",icon:e.emoticon,className:ud.tab},e.id))}),!b&&(0,pa.Y)("div",{className:ud.divider}),(0,pa.Y)(La.A,{color:"translucent",className:(0,Kt.A)(ud.menuButton,ud.settingsButton),onClick:A,iconName:"tools",iconClassName:ud.icon})]})})),md=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"ForwardRecipientPicker",!t);return a?(0,pa.Y)(a,{...e}):void 0};var pd=a(73172),gd=a(22337);const fd=(0,qt.ph)((0,w.EK)((e,{openedGame:t})=>{const{chatId:a}=t||{},s=a&&(0,C.hds)(e,a),o=a?(0,C.AWZ)(e,a):void 0;return{canPost:Boolean(s)&&(0,S.__)(s,void 0,void 0,o)}})(({openedGame:e,gameTitle:t,canPost:a})=>{const{closeGame:s,openForwardMenu:o}=(0,w.ko)(),n=(0,Da.A)(),{url:i,chatId:r,messageId:d}=e||{},c=Boolean(i),l=(0,pd.A)(r);(0,$t.A)(()=>{l({type:"playingGame"})},c&&a?5e3:void 0);const u=(0,qt.hb)(e=>{if(r&&d)try{const t=JSON.parse(e.data);"share_score"===t.eventType&&(o({fromChatId:r,messageIds:[d],withMyScore:!0}),s()),"share_game"===t.eventType&&(o({fromChatId:r,messageIds:[d]}),s())}catch(e){}},[r,s,d,o]),h=(0,qt.hb)(e=>{e.currentTarget.focus()},[]);return(0,qt.vJ)(()=>(window.addEventListener("message",u),()=>window.removeEventListener("message",u)),[u]),(0,pa.Y)(gd.A,{className:"GameModal",isOpen:c,onClose:s,title:t,hasCloseButton:!0,children:c&&(0,pa.Y)("iframe",{className:"game-frame",onLoad:h,src:i,title:n("AttachGame"),sandbox:"allow-scripts allow-same-origin allow-orientation-lock",allow:"fullscreen"})})})),Id=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"HistoryCalendar",!t);return a?(0,pa.Y)(a,{...e}):void 0},vd=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"NewContactModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},bd=e=>{const{limit:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PremiumLimitReachedModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},Sd=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"GiveawayModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},yd=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Extra,"PremiumMainModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},wd=e=>{const{isOpen:t}=e,a=(0,ma.A)(Xt.ar.Stars,"StarsGiftingPickerModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},Ad=e=>{const{url:t}=e,a=(0,ma.A)(Xt.ar.Extra,"SafeLinkModal",!t);return a?(0,pa.Y)(a,{...e}):void 0},Md={root:"YUAfqWPN"},Cd=["#E8BC2C","#D0049E","#02CBFE","#5723FD","#FE8C27","#6CB859"],Pd=new Path2D("M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z"),kd=(0,qt.ph)((0,w.EK)(e=>(0,h.Up)((0,C.nTw)(e),["confetti"]))(({confetti:e})=>{const t=(0,qt.li)(),a=(0,qt.li)([]),s=(0,qt.li)(!1),o=(0,Zs.A)(),n=(0,Zt.A)(),{isMobile:i}=(0,O.Ay)(),r=i?50:100,{lastConfettiTime:d,top:c,width:l,left:u,height:h,style:m="poppers"}=e||{},p=(0,ta.A)((t,s,o=r)=>{for(let n=0;n<o;n++){const{position:o,velocity:i}=Td(m,t,s,n),r=10+Fd(5),d=Cd[Math.floor(Math.random()*Cd.length)];a.current.push({pos:o,size:r,color:d,velocity:i,flicker:r,flickerFrequency:.2*Math.random(),rotation:0,lastDrawnAt:Date.now(),frameCount:0,isStar:e?.withStars&&Math.random()>.8})}}),g=(0,ta.A)(()=>{if(!t.current||!s.current)return;const e=t.current,o=e.getContext("2d");if(!o)return;const{width:n,height:i}=e;o.clearRect(0,0,n,i);const r=[];a.current.forEach((e,t)=>{const{pos:s,velocity:n,size:d,color:c,flicker:l,flickerFrequency:u,rotation:h,lastDrawnAt:m,frameCount:p}=e,g=(Date.now()-m)/1e3,f={x:s.x+n.x*g,y:s.y+n.y*g},I={x:n.x*.5**(g/1),y:n.y+=1e3*g},v=d*Math.abs(Math.sin(p*u)),b=5*p*u*(Math.PI/180),S=p+1,y=Date.now();if(f.y>i+e.size)return void r.push(e);const w={...e,pos:f,velocity:I,flicker:v,rotation:b,lastDrawnAt:y,frameCount:S};a.current[t]=w,o.fillStyle=c,e.isStar?(o.save(),o.translate(s.x,s.y),o.scale(d/10*1.5,d/10*1.5),o.rotate(h),o.fill(Pd),o.restore()):(o.beginPath(),o.ellipse(s.x,s.y,d,l,h,0,2*Math.PI),o.fill())}),a.current=a.current.filter(e=>!r.includes(e)),a.current.length?(0,Ht.YS)(g):s.current=!1});if((0,ia.A)(([e])=>{let t;return e!==d&&(p(l||o.width,h||o.height),t=setTimeout(n,1e4),s.current||(s.current=!0,(0,Ht.YS)(g))),()=>{clearTimeout(t)}},[d,n,g]),!d||Date.now()-d>1e4)return;const f=(0,_s.A)(Boolean(c)&&`top: ${c}px`,Boolean(u)&&`left: ${u}px`,Boolean(l)&&`width: ${l}px`,Boolean(h)&&`height: ${h}px`);return(0,pa.Y)("div",{id:"Confetti",className:Md.root,style:f,children:(0,pa.Y)("canvas",{ref:t,className:Md.canvas,width:o.width,height:o.height})})}));function Td(e,t,a,s){if("poppers"===e){const e=s%2,o={x:t*(e?-.1:1.1),y:.66*a},n=Math.random()*t;return{position:o,velocity:{x:e?n:-1*n,y:-a-Fd(.75*a)}}}return{position:{x:Math.random()*t,y:-20},velocity:{x:Fd(t),y:-a*Math.random()*1.25}}}function Fd(e=1){return Math.random()*e-e/2}var Bd=a(15006),Ud=a(28470);const xd=a.p+"wave_ripple.5d7d9fa793232bef56c0.jpg",Nd="wave-filter",Rd=(0,qt.ph)((0,w.EK)(e=>({waveInfo:(0,C.nTw)(e).wave}))(({waveInfo:e})=>{const[t,a]=(0,qt.J0)([]),o=(0,ta.A)(e=>{t.length>=7||a(t=>[...t,e])});return(0,qt.vJ)(()=>{if(!e)return;const{startX:t,startY:a}=e,{width:s,height:n}=B.A.get(),i=1.73*Math.max(s-t,n-a,t,a),r=a-i/2,d=t-i/2;o({startTime:e.lastWaveTime,waveWidth:i,top:r,left:d})},[e]),(0,qt.vJ)(()=>((0,Ud.z)((0,pa.FD)("filter",{x:"0",y:"0",width:"1",height:"1","color-interpolation-filters":"sRGB",xmlns:s.jNX,children:[(0,pa.Y)("feImage",{href:xd,result:"waveImage"}),(0,pa.Y)("feDisplacementMap",{in:"SourceGraphic",in2:"waveImage",scale:"20",xChannelSelector:"R",yChannelSelector:"B"})]}),Nd),()=>{(0,Ud.e)(Nd)}),[]),(0,pa.Y)("div",{className:(0,Kt.A)("RMsQzedH"),teactFastList:!0,children:t.map(e=>(0,pa.Y)("div",{className:"YLR2Oh2f",style:(0,_s.A)(`--wave-width: ${e.waveWidth}px`,`--wave-pos-top: ${e.top}px`,`--wave-pos-left: ${e.left}px`),onAnimationEnd:()=>a(t=>t.filter(t=>t!==e))},e.startTime))})}));let Jd=!1;const Yd=(0,qt.ph)((0,w.EK)((e,{isMobile:t})=>{const{currentUserId:a}=e,{botTrustRequest:o,requestedAttachBotInChat:n,requestedDraft:i,safeLinkModalUrl:r,openedStickerSetShortName:d,openedCustomEmojiSetIds:c,shouldSkipHistoryAnimations:l,openedGame:u,isLeftColumnShown:h,historyCalendarSelectedAt:m,newContact:p,ratingPhoneCall:g,premiumModal:f,giveawayModal:I,deleteMessageModal:v,starsGiftingPickerModal:b,isMasterTab:S,payment:y,limitReachedModal:w,deleteFolderDialogModal:A,activeGiftAuction:M}=(0,C.nTw)(e),{wasTimeFormatSetManually:P,foldersPosition:k}=(0,je.lS)(e),T=u&&(0,C.O5q)(e,u.chatId,u.messageId),F=T?.content.game?.title,{chatId:B}=(0,C.Xf0)(e)||{},U=!(0,C.xYJ)(e,"rightColumnAnimations")||!(0,C.PKK)(e),x=A?(0,C.$aQ)(e,A):void 0,N=(0,C.trm)(e);return{currentUserId:a,isLeftColumnOpen:h,isMiddleColumnOpen:Boolean(B),isRightColumnOpen:(0,C.gjV)(e,t),isMediaViewerOpen:(0,C.F4N)(e),isStoryViewerOpen:(0,C.gd2)(e),isForwardModalOpen:(0,C.p5z)(e),isReactionPickerOpen:(0,C.Ani)(e),safeLinkModalUrl:r,isHistoryCalendarOpen:Boolean(m),shouldSkipHistoryAnimations:l,openedStickerSetShortName:d,openedCustomEmojiSetIds:c,isServiceChatReady:(0,C.dqr)(e),activeGroupCallId:S?e.groupCalls.activeGroupCallId:void 0,withInterfaceAnimations:(0,C.PKK)(e),wasTimeFormatSetManually:P,isPhoneCallActive:S?Boolean(e.phoneCall):void 0,addedSetIds:e.stickers.added.setIds,addedCustomEmojiIds:e.customEmojis.added.setIds,newContactUserId:p?.userId,newContactByPhoneNumber:p?.isByPhoneNumber,openedGame:u,gameTitle:F,isRatePhoneCallModalOpen:Boolean(g),botTrustRequest:o,botTrustRequestBot:o&&(0,C.mBe)(e,o.botId),requestedAttachBotInChat:n,isCurrentUserPremium:(0,C.g29)(e),isPremiumModalOpen:f?.isOpen,isGiveawayModalOpen:I?.isOpen,isDeleteMessageModalOpen:Boolean(v),isStarsGiftingPickerModal:b?.isOpen,limitReached:w?.limit,isPaymentModalOpen:y.isPaymentModalOpen,isReceiptModalOpen:Boolean(y.receipt),deleteFolderDialog:x,isMasterTab:S,requestedDraft:i,noRightColumnAnimation:U,isSynced:e.isSynced,isAccountFrozen:N,isAppConfigLoaded:e.isAppConfigLoaded,isFoldersSidebarShown:k===s._C3&&!t&&(0,C.XD6)(e),activeGiftAuction:M}})(({isMobile:e,isLeftColumnOpen:t,isMiddleColumnOpen:o,isRightColumnOpen:n,isMediaViewerOpen:i,isStoryViewerOpen:r,isForwardModalOpen:c,activeGroupCallId:l,safeLinkModalUrl:h,isHistoryCalendarOpen:m,shouldSkipHistoryAnimations:p,limitReached:g,openedStickerSetShortName:f,openedCustomEmojiSetIds:I,isServiceChatReady:v,withInterfaceAnimations:b,wasTimeFormatSetManually:S,addedSetIds:y,addedCustomEmojiIds:A,isPhoneCallActive:M,newContactUserId:C,newContactByPhoneNumber:P,openedGame:k,gameTitle:T,isRatePhoneCallModalOpen:F,botTrustRequest:B,botTrustRequestBot:U,requestedAttachBotInChat:x,requestedDraft:N,isPremiumModalOpen:R,isGiveawayModalOpen:J,isDeleteMessageModalOpen:Y,isStarsGiftingPickerModal:E,isPaymentModalOpen:D,isReceiptModalOpen:L,isReactionPickerOpen:G,isCurrentUserPremium:V,deleteFolderDialog:j,isMasterTab:q,noRightColumnAnimation:z,isSynced:H,currentUserId:K,isAccountFrozen:W,isAppConfigLoaded:_,isFoldersSidebarShown:X,activeGiftAuction:$})=>{const{initMain:Q,loadAnimatedEmojis:Z,loadBirthdayNumbersStickers:ee,loadRestrictedEmojiStickers:te,loadNotificationSettings:ae,loadNotificationExceptions:se,updateIsOnline:oe,onTabFocusChange:ne,loadTopInlineBots:ie,loadEmojiKeywords:re,loadCountryList:de,loadAvailableReactions:ce,loadStickerSets:le,loadPremiumGifts:ue,loadTonGifts:he,loadStarGifts:me,loadMyUniqueGifts:pe,loadDefaultTopicIcons:ge,loadAddedStickers:fe,loadFavoriteStickers:Ie,loadDefaultStatusIcons:ve,ensureTimeFormat:be,closeStickerSetModal:Se,closeCustomEmojiSets:ye,checkVersionNotification:we,loadConfig:Ae,loadAppConfig:Me,loadAttachBots:Ce,loadContactList:Pe,loadCustomEmojis:ke,loadGenericEmojiEffects:Te,closePaymentModal:Fe,clearReceipt:Be,checkAppVersion:Ue,openThread:xe,openSummarizePage:Ne,openAlphaHumanThread:Re,toggleLeftColumn:Je,loadRecentEmojiStatuses:Ye,loadUserCollectibleStatuses:Ee,updatePageTitle:De,loadTopReactions:Oe,loadRecentReactions:Le,loadDefaultTagReactions:Ge,loadFeaturedEmojiStickers:Ve,loadAuthorizations:je,loadPeerColors:qe,loadSavedReactionTags:ze,loadTimezones:He,loadQuickReplies:Ke,loadStarStatus:We,loadAvailableEffects:_e,loadTopBotApps:Xe,loadPaidReactionPrivacy:$e,loadPasswordInfo:Qe,loadBotFreezeAppeal:Ze,loadAllChats:et,loadAllStories:tt,loadAllHiddenStories:at,loadContentSettings:st,loadActiveGiftAuction:ot,loadPromoData:nt}=(0,w.ko)();s.Oig&&!Jd&&(Jd=!0,console.log(">>> RENDER MAIN"));const rt=(0,ea.A)();(0,Qt.A)(()=>{(0,Xt.po)(Xt.ar.Calls)},5e3);const dt=(0,qt.li)(),ct=(0,qt.li)(),{isDesktop:lt}=(0,O.Ay)();var ut,ht;(0,qt.vJ)(()=>{t||o||lt?t&&o&&e&&Je():Je()},[lt,t,o,e,Je]),(0,$t.A)(Ue,q?3e5:void 0,!0),(0,qt.vJ)(()=>{q&&H&&(oe({isOnline:!0}),Ae(),Me(),qe(),Q(),Pe(),Ue(),je(),Qe(),(0,w.ko)().initAlphaHumanSocket())},[q,H]),(0,qt.vJ)(()=>{q&&H&&_&&!W&&(et({listType:"saved"}),tt(),at(),nt(),st(),Le(),Ge(),Ce(),ae(),se(),ie(),Oe(),We(),re({language:s.cUY}),Ve(),ze(),Xe(),$e(),ge(),Z(),ce(),Ee(),Te(),ue(),he(),me(),pe(),_e(),ee(),te(),Ke(),He())},[q,H,_,W]),(0,qt.vJ)(()=>{q&&V&&_&&!W&&(ve(),Ye())},[V,q,_,W]),(0,qt.vJ)(()=>{q&&(rt.code!==s.cUY&&re({language:rt.code}),de({langCode:rt.code}))},[rt,q]),(0,qt.vJ)(()=>{q&&ke({ids:Object.keys((0,w.mS)().customEmojis.byId),ignoreCache:!0})},[q]),(0,qt.vJ)(()=>{q&&H&&_&&!W&&(y&&A||(le(),Ie()),y&&A&&fe())},[y,A,q,H,_,W]),(0,qt.vJ)(()=>{Ze()},[_]),(0,qt.vJ)(()=>{v&&q&&we()},[v,q]),(0,qt.vJ)(()=>{S||be()},[S]),(0,qt.vJ)(()=>{if(!H)return;De();const e=(0,it.f4)();e?.tgaddr&&(0,_t._)(decodeURIComponent(e.tgaddr))},[H]),ut="deeplink",ht=e=>{try{const t=e.payload||"",a=decodeURIComponent(t);(0,_t._)(a)}catch(e){s.Oig&&console.error("Failed to process deep link",e)}},(0,qt.vJ)(()=>{if(!vt.Vq)return;let e;return(async()=>{const{listen:t}=await a.e(8925).then(a.bind(a,8925));e=await t(ut,e=>{ht(e)})})().catch(e=>{console.error(`Could not set up window event listener. ${e}`)}),()=>{e?.()}},[ut,ht]);const mt=(0,ta.A)(()=>{const e=(0,it.xV)(K);if(e)if("isSummarize"in e&&e.isSummarize)Ne();else{if("isAlphaHumanThread"in e&&e.isAlphaHumanThread){const{threadId:t}=e;return void(t&&Re({threadId:t}))}if("chatId"in e){const{chatId:t,threadId:a,type:s}=e;t&&xe({chatId:t,threadId:a||0,type:s||"thread"})}}else(0,w.mS)().byTabId[(0,u.g0)()]});(0,qt.vJ)(()=>{mt()},[K,mt]),(0,qt.vJ)(()=>(window.addEventListener("hashchange",mt),()=>{window.removeEventListener("hashchange",mt)}),[mt]);const pt=$?.timeout,gt=$?.gift.id;(0,$t.A)(()=>{gt&&ot({giftId:gt})},pt?1e3*pt:void 0),(0,qt.Nf)(()=>{const e=dt.current;1===e.parentNode.childElementCount&&(0,zt.YM)(e,"Transition_slide-active")},[]),(0,na.A)({ref:dt,isOpen:t,noCloseTransition:p,prefix:"left-column-"});const ft=(0,qt.li)(!1),It=(0,Zt.A)();(0,ia.A)(([e])=>{if(void 0===e||t===e||!b)return;ft.current=!0,d.Ni&&(0,Ht.Uz)(()=>{document.body.classList.toggle("android-left-blackout-open",!t)});const a=(0,qt.VK)();(0,Wt.j)(document.getElementById("MiddleColumn"),()=>{a(),ft.current=!1,It()})},[t,b,It]),(0,na.A)({ref:dt,isOpen:n,noCloseTransition:p,prefix:"right-column-"});const bt=(0,qt.li)(!1),[St,wt]=(0,qt.J0)(n),At=(0,ca.zk)();(0,ia.A)(([e,t])=>{if(void 0===t||n===t)return;if(!e||z)return void wt(n);bt.current=!0;const a=(0,qt.VK)();(0,Wt.j)(document.getElementById("RightColumn"),()=>{a(),bt.current=!1,It(),wt(n)})},[o,n,z,It]);const Mt=(0,Kt.A)(ft.current&&"left-column-animating",bt.current&&"right-column-animating",St&&"narrow-message-list",p&&"history-animation-disabled",At&&"is-fullscreen",X&&"folders-sidebar-visible","agent-sidebar-visible"),Ct=(0,ta.A)(()=>{ne({isBlurred:!0})}),Pt=(0,ta.A)(()=>{ne({isBlurred:!1}),document.title.includes(s.LaL)||De(),yt(!1)}),kt=(0,ta.A)(()=>{Se()}),Tt=(0,ta.A)(()=>{ye()});return(0,ra.Ay)(Ct,Pt,vt.Vq),(0,da.A)(Ct),function(e=!1){(0,qt.vJ)(()=>{if(d.TF){if(!e)return aa?.setAttribute("content",sa),d.pz&&!d._7&&document.addEventListener("gesturestart",oa),()=>{aa?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no"),d.pz&&!d._7&&document.removeEventListener("gesturestart",oa)};aa?.setAttribute("content","width=device-width, initial-scale=1, shrink-to-fit=no, viewport-fit=cover")}},[e])}(i||r),(0,pa.FD)("div",{ref:dt,id:"Main",className:Mt,children:[(0,pa.Y)(hd,{isMobile:e,isActive:X}),(0,pa.Y)(qs,{ref:ct,isFoldersSidebarShown:X}),(0,pa.Y)(jn,{leftColumnRef:ct,isMobile:e}),(0,pa.Y)(Xr,{isMobile:e}),(0,pa.Y)(zs,{isOpen:i}),(0,pa.Y)($r,{isOpen:r}),(0,pa.Y)(md,{isOpen:c}),(0,pa.Y)(dd,{requestedDraft:N}),(0,pa.Y)(td.A,{}),(0,pa.Y)(Ko,{noUi:!0}),(0,pa.Y)(_n,{}),(0,pa.Y)(Ad,{url:h}),(0,pa.Y)(Id,{isOpen:m}),(0,pa.Y)(ya,{isOpen:Boolean(f),onClose:kt,stickerSetShortName:f}),(0,pa.Y)(ba,{customEmojiSetIds:I,onClose:Tt}),l&&(0,pa.Y)(fa,{groupCallId:l}),(0,pa.Y)(ga,{isActive:Boolean(l||M)}),(0,pa.Y)(vd,{isOpen:Boolean(C||P),userId:C,isByPhoneNumber:P}),(0,pa.Y)(fd,{openedGame:k,gameTitle:T}),(0,pa.Y)(rd,{}),(0,pa.Y)(kd,{}),d.J6&&(0,pa.Y)(Rd,{}),(0,pa.Y)(Bd.A,{}),(0,pa.Y)(Ia,{isActive:M}),(0,pa.Y)(Ca,{isForAppBadge:!0}),(0,pa.Y)(va,{isOpen:F}),(0,pa.Y)(Zr,{bot:U,type:B?.type,shouldRequestWriteAccess:B?.shouldRequestWriteAccess}),(0,pa.Y)(Qr,{requestedAttachBotInChat:x}),(0,pa.Y)(Ws,{}),(0,pa.Y)(zn,{}),(0,pa.Y)(ha,{}),(0,pa.Y)(yd,{isOpen:R}),(0,pa.Y)(Sd,{isOpen:J}),(0,pa.Y)(wd,{isOpen:E}),(0,pa.Y)(bd,{limit:g}),(0,pa.Y)(Xn,{isOpen:D,onClose:Fe}),(0,pa.Y)($n,{isOpen:L,onClose:Be}),(0,pa.Y)(ed,{folder:j}),(0,pa.Y)(Hs,{isOpen:G}),(0,pa.Y)(Sa,{isOpen:Y})]})}));var Ed=a(15535);var Dd=a(89704);const Od=(0,qt.ph)((0,w.EK)(e=>({passcodeSettings:e.passcode}))(({isLocked:e,passcodeSettings:t})=>{const{unlockScreen:a,signOut:s,logInvalidUnlockAttempt:o,resetInvalidUnlockAttempts:n}=(0,w.ko)(),{invalidAttemptsCount:i,timeoutUntil:r,isLoading:d}=t,c=(0,Da.A)(),[l,u]=(0,qt.J0)(""),[h,m]=(0,qt.J0)(!1),[p,g,f]=(0,os.A)(!1),{shouldRender:I}=(0,Oa.A)(e);(0,Qt.A)(n,r?r-Date.now():void 0);const v=(0,qt.hb)(()=>{u("")},[]),b=(0,qt.hb)(e=>{void 0===r?(u(""),(0,Ft.UQ)(e).then(a,e=>{e instanceof Ft.Mv&&s({forceInitApi:!0}),o(),u(c("lng_passcode_wrong"))})):u(c("FloodWait"))},[c,r]);(0,qt.vJ)(()=>{void 0!==r?u(c("FloodWait")):0===i&&u("")},[r,c,i]);const S=(0,qt.hb)(()=>{f(),s({forceInitApi:!0})},[f,s]);if(I)return(0,pa.FD)("div",{className:"bdKGCai4",children:[(0,pa.FD)("div",{className:"BIi4Pl4Z",dir:c.isRtl?"rtl":void 0,children:[(0,pa.Y)(Bi.A,{tgsUrl:fi.w.Lock,previewUrl:Dd,size:160,className:"JwlsF2tF"}),(0,pa.Y)(Ed.A,{shouldShowSubmit:!0,shouldDisablePasswordManager:!0,isLoading:d,error:l,placeholder:c("Passcode.EnterPasscodePlaceholder"),submitLabel:c("Next"),onClearError:v,isPasswordVisible:h,noRipple:!0,onChangePasswordVisibility:m,onSubmit:b},"password-form"),(0,pa.FD)("div",{className:"VlXFyC_a",children:[(0,pa.FD)("p",{children:[(0,pa.Y)(Tn.A,{onClick:g,children:"Log out"})," ","if you don't remember your passcode."]}),(0,pa.Y)("p",{children:(0,pa.Y)(La.A,{color:"translucent",size:"tiny",isText:!0,onClick:g,children:c("AccountSettings.Logout")})})]})]}),(0,pa.Y)(an.A,{isOpen:p,onClose:f,text:c("lng_sure_logout"),confirmLabel:c("AccountSettings.Logout"),confirmHandler:S,confirmIsDestructive:!0})]})}));s.Oig&&console.log(">>> FINISH LOAD MAIN BUNDLE")}}]);
//# sourceMappingURL=7768.93a09bc54159a4e0aa33.js.map