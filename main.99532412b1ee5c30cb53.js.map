{"version":3,"file":"main.99532412b1ee5c30cb53.js","mappings":"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C,GAA2B,IAC3BC,GAA4B,IAE5BC,GAAuB,mBACvBC,GAAuB,kBAEvB5M,GAAgB,6BAChB19D,GAAiB,IAAIlT,IAAI,CAAC,MAAO,SAGjCy9E,GAAgB,YAEhBC,GAA2B,0BAC3BC,GAJkB,aAMlBC,GAAgC,IAAI59E,IAAI,CACnD,YACA,aACAy9E,KAGWI,GAAgC,IAAI79E,IAAI,CACnD,YACA,oBAGW89E,GAAgC,IAAI99E,IAAI,CACnD,YACA,YACA,YACA,aACA,aACA,YACA,YACA,YACA,gBAGW+9E,GAA6B,IAAI/9E,IAAI,IAC7C49E,MACAC,KAIQG,GAAkC,CAE7C,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KAEA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,QACA,QACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,MAGWzlF,GACX,8HAEWC,GAAsB,iBACtBylF,GAAa,eACbC,GACX,uDACWC,GAAmB,kCACnBC,GAAkB,gBAClBC,GAAsB,YACtBC,GAA0B,8BAC1BC,GAA4B,sBAC5BC,GAAoB,UAKpBC,IAJ6B,IAAIz+E,IAAI,CAChDs+E,GACA,qBAE6B,IAAIt+E,IAAI,CACrC,OACA,WACA,SACA,SACA,YAEW69C,GAAmB,OACnB6gC,GAAY,OAEZC,GAA0B,YAE1B1Q,GAAiC,IAAIjuE,IAAI,CACp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B,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAuB,KAAO,uBAAu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","sources":["webpack://alphahuman-telegram/webpack/runtime/create fake namespace object","webpack://alphahuman-telegram/webpack/runtime/load script","webpack://alphahuman-telegram/./src/hooks/useCurrentOrPrev.ts","webpack://alphahuman-telegram/./src/util/browser/passkeys.ts","webpack://alphahuman-telegram/./src/global/helpers/meta.ts","webpack://alphahuman-telegram/./node_modules/ieee754/index.js","webpack://alphahuman-telegram/./src/util/searchWords.ts","webpack://alphahuman-telegram/./src/hooks/useThrottledCallback.ts","webpack://alphahuman-telegram/./src/global/selectors/stories.ts","webpack://alphahuman-telegram/./src/util/handleError.ts","webpack://alphahuman-telegram/./src/hooks/media/useThumbnail.ts","webpack://alphahuman-telegram/./src/components/ui/Portal.ts","webpack://alphahuman-telegram/./src/global/helpers/messageSummary.ts","webpack://alphahuman-telegram/./src/util/installPrompt.ts","webpack://alphahuman-telegram/./src/components/middle/message/helpers/messageActions.tsx","webpack://alphahuman-telegram/./src/util/multiaccount.ts","webpack://alphahuman-telegram/./src/components/common/AnimatedIcon.tsx","webpack://alphahuman-telegram/./src/components/common/helpers/renderText.tsx","webpack://alphahuman-telegram/./src/global/actions/apiUpdaters/initial.ts","webpack://alphahuman-telegram/./src/global/selectors/tabs.ts","webpack://alphahuman-telegram/./src/util/notifications.tsx","webpack://alphahuman-telegram/./src/hooks/useSignalEffect.ts","webpack://alphahuman-telegram/./src/hooks/useIntersectionObserver.ts","webpack://alphahuman-telegram/./src/util/arePropsShallowEqual.ts","webpack://alphahuman-telegram/./src/util/element/jsxToHtml.ts","webpack://alphahuman-telegram/./src/util/numbers.ts","webpack://alphahuman-telegram/./src/lib/teact/heavyAnimation.ts","webpack://alphahuman-telegram/./src/components/common/icons/StarIcon.module.scss?d424","webpack://alphahuman-telegram/./src/components/common/icons/StarIcon.tsx","webpack://alphahuman-telegram/./src/util/Deferred.ts","webpack://alphahuman-telegram/./src/util/entities/ids.ts","webpack://alphahuman-telegram/./src/lib/teact/dom-events.ts","webpack://alphahuman-telegram/./src/util/media/ipRevealingMedia.ts","webpack://alphahuman-telegram/./src/hooks/useKeyboardListNavigation.ts","webpack://alphahuman-telegram/./src/util/entities/username.ts","webpack://alphahuman-telegram/./src/global/actions/ui/settings.ts","webpack://alphahuman-telegram/./src/hooks/useFastClick.ts","webpack://alphahuman-telegram/./src/util/captureEscKeyListener.ts","webpack://alphahuman-telegram/./src/limits.ts","webpack://alphahuman-telegram/./src/global/index.ts","webpack://alphahuman-telegram/./src/util/generateUniqueId.ts","webpack://alphahuman-telegram/./src/util/textFormat.ts","webpack://alphahuman-telegram/./src/util/establishMultitabRole.ts","webpack://alphahuman-telegram/./src/hooks/useUniqueId.ts","webpack://alphahuman-telegram/./src/hooks/useEffectOnce.ts","webpack://alphahuman-telegram/./src/lib/twemojiRegex.js","webpack://alphahuman-telegram/./src/global/reducers/chats.ts","webpack://alphahuman-telegram/./src/util/visibility/getOffsetToContainer.ts","webpack://alphahuman-telegram/./src/hooks/useDebouncedCallback.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/restHelpers.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/getMe.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/getHighlights.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/getThreads.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/createThread.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/getThreadMessages.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/loginTokens.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/notionAuth.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/rest/googleAuth.ts","webpack://alphahuman-telegram/./src/util/formatCurrency.tsx","webpack://alphahuman-telegram/./src/util/emoji/parseEmojiOnlyString.ts","webpack://alphahuman-telegram/./src/global/reducers/auth.ts","webpack://alphahuman-telegram/./src/util/dates/dateFormat.ts","webpack://alphahuman-telegram/./src/hooks/useLastCallback.ts","webpack://alphahuman-telegram/./src/components/common/AnimatedSticker.tsx","webpack://alphahuman-telegram/./src/components/common/icons/Icon.tsx","webpack://alphahuman-telegram/./src/components/common/Blockquote.tsx","webpack://alphahuman-telegram/./src/components/common/Blockquote.module.scss?d7ef","webpack://alphahuman-telegram/./src/util/prettyCodeLanguageNames.ts","webpack://alphahuman-telegram/./src/components/common/code/CodeOverlay.module.scss?733a","webpack://alphahuman-telegram/./src/components/common/code/CodeOverlay.tsx","webpack://alphahuman-telegram/./src/components/common/code/CodeBlock.tsx","webpack://alphahuman-telegram/./src/components/common/spoiler/Spoiler.tsx","webpack://alphahuman-telegram/./src/components/common/helpers/renderTextWithEntities.tsx","webpack://alphahuman-telegram/./src/components/common/MessageSummary.tsx","webpack://alphahuman-telegram/./src/hooks/useDerivedState.ts","webpack://alphahuman-telegram/./src/util/withCache.ts","webpack://alphahuman-telegram/./src/global/selectors/messages.ts","webpack://alphahuman-telegram/./src/util/permanentWebVersion.ts","webpack://alphahuman-telegram/./src/components/ui/Checkbox.tsx","webpack://alphahuman-telegram/./src/util/animation.ts","webpack://alphahuman-telegram/./src/global/selectors/users.ts","webpack://alphahuman-telegram/./src/lib/teact/jsx-runtime.ts","webpack://alphahuman-telegram/./src/global/helpers/bots.ts","webpack://alphahuman-telegram/./src/global/initialState.ts","webpack://alphahuman-telegram/./src/global/selectors/chats.ts","webpack://alphahuman-telegram/./src/util/dates/units.ts","webpack://alphahuman-telegram/./src/util/perfomanceSettings.ts","webpack://alphahuman-telegram/./src/components/common/Avatar.tsx","webpack://alphahuman-telegram/./src/util/signals.ts","webpack://alphahuman-telegram/./src/components/ui/DropdownMenu.tsx","webpack://alphahuman-telegram/./src/hooks/useVirtualBackdrop.ts","webpack://alphahuman-telegram/./src/util/areDeepEqual.ts","webpack://alphahuman-telegram/./src/util/emoji/fixNonStandardEmoji.ts","webpack://alphahuman-telegram/./src/components/ui/MenuItem.tsx","webpack://alphahuman-telegram/./src/lib/punycode.js","webpack://alphahuman-telegram/./src/util/browser/url.ts","webpack://alphahuman-telegram/./src/global/helpers/middleSearch.ts","webpack://alphahuman-telegram/./src/util/imageResize.ts","webpack://alphahuman-telegram/./src/util/cssAnimationEndListeners.ts","webpack://alphahuman-telegram/./src/hooks/useHistoryBack.ts","webpack://alphahuman-telegram/./src/util/appBadge.ts","webpack://alphahuman-telegram/./src/global/helpers/replies.ts","webpack://alphahuman-telegram/./src/global/actions/api/settings.ts","webpack://alphahuman-telegram/./src/global/helpers/notifications.ts","webpack://alphahuman-telegram/./src/util/svgController.ts","webpack://alphahuman-telegram/./src/hooks/usePrevious.ts","webpack://alphahuman-telegram/./src/global/selectors/symbols.ts","webpack://alphahuman-telegram/./src/global/selectors/sharedState.ts","webpack://alphahuman-telegram/./src/global/selectors/settings.ts","webpack://alphahuman-telegram/./src/hooks/useForceUpdate.ts","webpack://alphahuman-telegram/./src/config.ts","webpack://alphahuman-telegram/./src/hooks/schedulers/useInterval.ts","webpack://alphahuman-telegram/./src/global/reducers/tabs.ts","webpack://alphahuman-telegram/./src/util/requestActionTimeout.ts","webpack://alphahuman-telegram/./src/util/deepMerge.ts","webpack://alphahuman-telegram/./src/hooks/useShowTransition.ts","webpack://alphahuman-telegram/./src/hooks/usePriorityPlaybackCheck.ts","webpack://alphahuman-telegram/./src/global/helpers/stars.ts","webpack://alphahuman-telegram/./src/hooks/useSyncEffect.ts","webpack://alphahuman-telegram/./src/api/types/media.ts","webpack://alphahuman-telegram/./src/components/common/helpers/animatedAssets.ts","webpack://alphahuman-telegram/./src/hooks/stickers/useColorFilter.tsx","webpack://alphahuman-telegram/./src/hooks/useFlag.ts","webpack://alphahuman-telegram/./src/util/schedulers.ts","webpack://alphahuman-telegram/./src/lib/teact/teactn.tsx","webpack://alphahuman-telegram/./src/hooks/useMediaTransition.ts","webpack://alphahuman-telegram/./src/hooks/window/useDevicePixelRatio.ts","webpack://alphahuman-telegram/./src/hooks/useLang.ts","webpack://alphahuman-telegram/./src/hooks/window/useWindowSize.ts","webpack://alphahuman-telegram/./src/util/browser/unloadVideo.ts","webpack://alphahuman-telegram/./src/components/common/embedded/EmojiIconBackground.tsx","webpack://alphahuman-telegram/./src/components/common/embedded/EmojiIconBackground.module.scss?aa76","webpack://alphahuman-telegram/./src/hooks/usePeerColor.ts","webpack://alphahuman-telegram/./src/components/ui/InputText.tsx","webpack://alphahuman-telegram/./src/components/ui/Transition.tsx","webpack://alphahuman-telegram/./src/hooks/useStateRef.ts","webpack://alphahuman-telegram/./src/util/forceReflow.ts","webpack://alphahuman-telegram/./src/util/safePlay.ts","webpack://alphahuman-telegram/./node_modules/engine.io-parser/build/esm/commons.js","webpack://alphahuman-telegram/./node_modules/engine.io-parser/build/esm/encodePacket.browser.js","webpack://alphahuman-telegram/./node_modules/engine.io-parser/build/esm/contrib/base64-arraybuffer.js","webpack://alphahuman-telegram/./node_modules/engine.io-parser/build/esm/decodePacket.browser.js","webpack://alphahuman-telegram/./node_modules/engine.io-parser/build/esm/index.js","webpack://alphahuman-telegram/./node_modules/@socket.io/component-emitter/lib/esm/index.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/globals.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/util.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transport.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/contrib/parseqs.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transports/polling.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/contrib/has-cors.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transports/polling-xhr.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transports/websocket.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transports/index.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/transports/webtransport.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/contrib/parseuri.js","webpack://alphahuman-telegram/./node_modules/engine.io-client/build/esm/socket.js","webpack://alphahuman-telegram/./node_modules/socket.io-parser/build/esm/is-binary.js","webpack://alphahuman-telegram/./node_modules/socket.io-parser/build/esm/binary.js","webpack://alphahuman-telegram/./node_modules/socket.io-parser/build/esm/index.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/on.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/socket.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/contrib/backo2.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/manager.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/index.js","webpack://alphahuman-telegram/./node_modules/socket.io-client/build/esm/url.js","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/validation.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/errorHandler.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/telegramApi.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getChats.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/listChats.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/createGroup.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/inviteToGroup.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/createChannel.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/editChatTitle.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/deleteChatPhoto.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/leaveChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getParticipants.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getAdmins.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getBannedUsers.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/promoteAdmin.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/demoteAdmin.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/banUser.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/unbanUser.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getInviteLink.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/exportChatInvite.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/importChatInvite.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/joinChatByLink.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/subscribePublicChannel.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/muteChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/unmuteChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/archiveChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/unarchiveChat.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getMessages.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/listMessages.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/listTopics.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/sendMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/replyToMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/editMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/deleteMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/forwardMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/pinMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/unpinMessage.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/markAsRead.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getMessageContext.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getHistory.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getPinnedMessages.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/sendReaction.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/removeReaction.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getMessageReactions.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/listInlineButtons.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/pressInlineButton.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/saveDraft.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getDrafts.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/clearDraft.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/listContacts.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/searchContacts.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/addContact.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/deleteContact.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/blockUser.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/unblockUser.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getBlockedUsers.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getMe.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/updateProfile.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getUserPhotos.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getUserStatus.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/searchPublicChats.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/searchMessages.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/resolveUsername.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getMediaInfo.ts","webpack://alphahuman-telegram/./node_modules/@cryptography/aes/dist/es/aes.js","webpack://alphahuman-telegram/./src/lib/gramjs/Helpers.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/generationHelpers.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/apiHelpers.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/api.js","webpack://alphahuman-telegram/./src/lib/gramjs/tl/apiTl.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/schemaTl.ts","webpack://alphahuman-telegram/./src/lib/gramjs/errors/RPCBaseErrors.ts","webpack://alphahuman-telegram/./src/lib/gramjs/errors/RPCErrorList.ts","webpack://alphahuman-telegram/./src/lib/gramjs/errors/Common.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/core/GZIPPacked.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/core/TLMessage.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/core/MessageContainer.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/core/RPCResult.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/core/index.ts","webpack://alphahuman-telegram/./src/lib/gramjs/tl/AllTLObjects.ts","webpack://alphahuman-telegram/./src/lib/gramjs/extensions/HttpStream.ts","webpack://alphahuman-telegram/./src/lib/gramjs/extensions/Logger.ts","webpack://alphahuman-telegram/./src/lib/gramjs/extensions/MessagePacker.ts","webpack://alphahuman-telegram/./node_modules/async-mutex/index.mjs","webpack://alphahuman-telegram/./src/lib/gramjs/extensions/PromisedWebSockets.ts","webpack://alphahuman-telegram/./src/lib/gramjs/network/connection/TCPAbridged.ts","webpack://alphahuman-telegram/./src/lib/gramjs/crypto/RSA.ts","webpack://alphahuman-telegram/./src/lib/gramjs/Utils.ts","webpack://alphahuman-telegram/./src/api/gramjs/localDb.ts","webpack://alphahuman-telegram/./src/api/gramjs/apiBuilders/helpers.ts","webpack://alphahuman-telegram/./src/api/gramjs/gramjsBuilders/index.ts","webpack://alphahuman-telegram/./src/util/dcBandwithManager.ts","webpack://alphahuman-telegram/./src/lib/gramjs/client/TelegramClient.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getRecentActions.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/createPoll.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getBotInfo.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/setBotCommands.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getPrivacySettings.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/setPrivacySettings.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/setProfilePhoto.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/deleteProfilePhoto.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/editChatPhoto.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getStickerSets.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getGifSearch.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getContactIds.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/importContacts.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/exportContacts.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getDirectChatByContact.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getContactChats.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/tools/getLastInteraction.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/transport.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/server.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/index.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/index.ts","webpack://alphahuman-telegram/./src/global/cache.ts","webpack://alphahuman-telegram/./src/components/ui/RippleEffect.tsx","webpack://alphahuman-telegram/./src/util/data/readStrings.ts","webpack://alphahuman-telegram/./src/util/data/readFallbackStrings.ts","webpack://alphahuman-telegram/./src/assets/localization/initialStrings.ts","webpack://alphahuman-telegram/./src/util/localization/index.ts","webpack://alphahuman-telegram/./src/util/browser/intlListFormat.ts","webpack://alphahuman-telegram/./src/util/math.ts","webpack://alphahuman-telegram/./src/util/windowSize.ts","webpack://alphahuman-telegram/./src/api/gramjs/worker/connector.ts","webpack://alphahuman-telegram/./src/hooks/useAppLayout.ts","webpack://alphahuman-telegram/./src/util/emoji/ensureCustomEmoji.ts","webpack://alphahuman-telegram/./src/components/common/hooks/useCustomEmoji.ts","webpack://alphahuman-telegram/./src/global/selectors/peers.ts","webpack://alphahuman-telegram/./src/util/deepLinkParser.ts","webpack://alphahuman-telegram/./node_modules/@tauri-apps/api/external/tslib/tslib.es6.js","webpack://alphahuman-telegram/./src/util/callbacks.ts","webpack://alphahuman-telegram/./src/hooks/useSharedIntersectionObserver.ts","webpack://alphahuman-telegram/./src/global/actions/ui/googleAuth.ts","webpack://alphahuman-telegram/./node_modules/buffer/index.js","webpack://alphahuman-telegram/./src/global/actions/ui/notionAuth.ts","webpack://alphahuman-telegram/./src/global/actions/api/initial.ts","webpack://alphahuman-telegram/./src/util/localization/format.tsx","webpack://alphahuman-telegram/./src/util/colors.ts","webpack://alphahuman-telegram/./src/util/folderManager.ts","webpack://alphahuman-telegram/./src/util/safeExec.ts","webpack://alphahuman-telegram/./src/util/captureEvents.ts","webpack://alphahuman-telegram/./src/util/lethargy.ts","webpack://alphahuman-telegram/./src/hooks/useShowTransitionDeprecated.ts","webpack://alphahuman-telegram/./src/components/middle/message/ActionMessage.module.scss?5fb2","webpack://alphahuman-telegram/./node_modules/os-browserify/browser.js","webpack://alphahuman-telegram/./src/util/emoji/emoji.ts","webpack://alphahuman-telegram/./src/util/captureKeyboardListeners.ts","webpack://alphahuman-telegram/./src/components/ui/Loading.tsx","webpack://alphahuman-telegram/./src/components/middle/helpers/preventMessageInputBlur.ts","webpack://alphahuman-telegram/./src/util/deeplink.ts","webpack://alphahuman-telegram/./src/global/shared/sharedStateConnector.ts","webpack://alphahuman-telegram/./src/global/selectors/payments.ts","webpack://alphahuman-telegram/./node_modules/@tauri-apps/api/core.js","webpack://alphahuman-telegram/./src/util/swipeController.ts","webpack://alphahuman-telegram/./src/components/middle/message/MentionLink.tsx","webpack://alphahuman-telegram/./src/global/selectors/media.ts","webpack://alphahuman-telegram/./src/hooks/useAsync.ts","webpack://alphahuman-telegram/./src/components/common/TypingWrapper.tsx","webpack://alphahuman-telegram/./src/components/common/MessageText.tsx","webpack://alphahuman-telegram/./src/util/keys/searchResultKey.ts","webpack://alphahuman-telegram/./src/components/ui/Spinner.tsx","webpack://alphahuman-telegram/./src/hooks/element/useCollapsibleLines.ts","webpack://alphahuman-telegram/./src/util/sessions.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/logger.ts","webpack://alphahuman-telegram/./src/util/oggToWav.ts","webpack://alphahuman-telegram/./src/util/mediaLoader.ts","webpack://alphahuman-telegram/./src/components/middle/composer/helpers/customEmoji.ts","webpack://alphahuman-telegram/./src/util/trimText.ts","webpack://alphahuman-telegram/./src/hooks/useOldLang.ts","webpack://alphahuman-telegram/./src/util/browser/multitab.ts","webpack://alphahuman-telegram/./src/util/themeStyle.ts","webpack://alphahuman-telegram/./src/util/oldLangProvider.ts","webpack://alphahuman-telegram/./src/util/emoji/customEmojiManager.ts","webpack://alphahuman-telegram/./src/util/keys/messageKey.ts","webpack://alphahuman-telegram/./src/hooks/window/useBackgroundMode.ts","webpack://alphahuman-telegram/./src/util/debugConsole.ts","webpack://alphahuman-telegram/./src/lib/teact/teact-dom.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/mcp/toolActionParser.ts","webpack://alphahuman-telegram/./src/global/helpers/chats.ts","webpack://alphahuman-telegram/./src/global/selectors/summarize.ts","webpack://alphahuman-telegram/./src/hooks/useMedia.ts","webpack://alphahuman-telegram/./src/util/browser/globalEnvironment.ts","webpack://alphahuman-telegram/./src/hooks/data/useSelector.ts","webpack://alphahuman-telegram/./src/components/ui/Button.tsx","webpack://alphahuman-telegram/./src/global/selectors/limits.ts","webpack://alphahuman-telegram/./src/lib/alphahuman/types.ts","webpack://alphahuman-telegram/./src/global/selectors/alphaHumanThread.ts","webpack://alphahuman-telegram/./src/util/phoneNumber.ts","webpack://alphahuman-telegram/./src/components/middle/message/hooks/useVideoAutoPause.ts","webpack://alphahuman-telegram/./src/components/ui/OptimizedVideo.tsx","webpack://alphahuman-telegram/./src/hooks/useSyncEffectWithPrevDeps.ts","webpack://alphahuman-telegram/./src/util/routing.ts","webpack://alphahuman-telegram/./src/lib/fasterdom/fasterdom.ts","webpack://alphahuman-telegram/./node_modules/base64-js/index.js","webpack://alphahuman-telegram/./src/components/common/AnimatedCounter.tsx","webpack://alphahuman-telegram/./src/components/common/AnimatedCounter.module.scss?3640","webpack://alphahuman-telegram/./src/hooks/animations/useViewTransition.ts","webpack://alphahuman-telegram/./src/global/reducers/middleSearch.ts","webpack://alphahuman-telegram/./src/global/reducers/symbols.ts","webpack://alphahuman-telegram/./src/global/reducers/users.ts","webpack://alphahuman-telegram/./src/global/reducers/globalSearch.ts","webpack://alphahuman-telegram/./src/global/reducers/management.ts","webpack://alphahuman-telegram/./src/global/reducers/settings.ts","webpack://alphahuman-telegram/./src/global/reducers/sharedState.ts","webpack://alphahuman-telegram/./src/global/reducers/twoFaSettings.ts","webpack://alphahuman-telegram/./src/global/reducers/passcode.ts","webpack://alphahuman-telegram/./src/global/reducers/payments.ts","webpack://alphahuman-telegram/./src/global/reducers/statistics.ts","webpack://alphahuman-telegram/./src/global/reducers/peers.ts","webpack://alphahuman-telegram/./src/global/reducers/stories.ts","webpack://alphahuman-telegram/./src/global/reducers/topics.ts","webpack://alphahuman-telegram/./src/global/reducers/gifts.ts","webpack://alphahuman-telegram/./src/global/reducers/layout.ts","webpack://alphahuman-telegram/./src/global/reducers/summarize.ts","webpack://alphahuman-telegram/./src/global/helpers/peers.ts","webpack://alphahuman-telegram/./node_modules/idb-keyval/dist/index.js","webpack://alphahuman-telegram/./src/util/browser/idb.ts","webpack://alphahuman-telegram/./src/util/dates/timestamp.ts","webpack://alphahuman-telegram/./src/util/passcode.ts","webpack://alphahuman-telegram/./src/util/switchTheme.ts","webpack://alphahuman-telegram/./src/hooks/useMenuPosition.ts","webpack://alphahuman-telegram/./src/components/ui/Menu.tsx","webpack://alphahuman-telegram/./src/hooks/useBuffering.ts","webpack://alphahuman-telegram/./src/global/reducers/socket.ts","webpack://alphahuman-telegram/./src/hooks/useVideoCleanup.ts","webpack://alphahuman-telegram/./src/hooks/usePreviousDeprecated.ts","webpack://alphahuman-telegram/./src/util/theme.ts","webpack://alphahuman-telegram/./src/util/cacheApi.ts","webpack://alphahuman-telegram/./src/lib/fasterdom/layoutCauses.ts","webpack://alphahuman-telegram/./src/lib/fasterdom/stricterdom.ts","webpack://alphahuman-telegram/./src/components/common/helpers/mediaDimensions.ts","webpack://alphahuman-telegram/./src/components/common/TopicDefaultIcon.module.scss?06b0","webpack://alphahuman-telegram/./src/components/common/TopicDefaultIcon.tsx","webpack://alphahuman-telegram/./src/global/helpers/messageMedia.ts","webpack://alphahuman-telegram/./src/global/helpers/symbols.ts","webpack://alphahuman-telegram/./src/global/helpers/users.ts","webpack://alphahuman-telegram/./src/util/memo.ts","webpack://alphahuman-telegram/./src/util/moduleLoader.ts","webpack://alphahuman-telegram/./src/util/serverTime.ts","webpack://alphahuman-telegram/./src/hooks/useModuleLoader.ts","webpack://alphahuman-telegram/./src/util/patchSafariProgressiveAudio.ts","webpack://alphahuman-telegram/./src/hooks/useEffectWithPrevDeps.ts","webpack://alphahuman-telegram/./src/global/helpers/getEmojiOnlyCountForMessage.ts","webpack://alphahuman-telegram/./src/global/reducers/messages.ts","webpack://alphahuman-telegram/./src/components/common/StickerView.module.scss?7ce5","webpack://alphahuman-telegram/./src/components/common/StickerView.tsx","webpack://alphahuman-telegram/./src/hooks/useMountAfterHeavyAnimation.ts","webpack://alphahuman-telegram/./src/hooks/useMediaTransitionDeprecated.ts","webpack://alphahuman-telegram/./src/hooks/useDerivedSignal.ts","webpack://alphahuman-telegram/./src/util/localization/types.ts","webpack://alphahuman-telegram/./src/util/stopEvent.ts","webpack://alphahuman-telegram/./src/util/debugOverlay.ts","webpack://alphahuman-telegram/./src/lib/teact/teact.ts","webpack://alphahuman-telegram/./src/hooks/useHeavyAnimation.ts","webpack://alphahuman-telegram/./src/util/systemTheme.ts","webpack://alphahuman-telegram/./src/api/types/messages.ts","webpack://alphahuman-telegram/./src/util/websync.ts","webpack://alphahuman-telegram/./src/components/common/SafeLink.tsx","webpack://alphahuman-telegram/./src/global/reducers/alphahuman.ts","webpack://alphahuman-telegram/./src/util/primitives/LimitedMap.ts","webpack://alphahuman-telegram/./src/components/common/Sparkles.module.scss?15c2","webpack://alphahuman-telegram/./src/components/common/Sparkles.tsx","webpack://alphahuman-telegram/./src/util/clipboard.ts","webpack://alphahuman-telegram/./src/components/common/PeerColorWrapper.tsx","webpack://alphahuman-telegram/./src/components/common/PeerColorWrapper.module.scss?b340","webpack://alphahuman-telegram/./src/global/helpers/messages.ts","webpack://alphahuman-telegram/./src/hooks/stickers/useDynamicColorListener.ts","webpack://alphahuman-telegram/./src/hooks/element/useStyleObserver.ts","webpack://alphahuman-telegram/./src/util/buildClassName.ts","webpack://alphahuman-telegram/./src/components/common/CustomEmoji.tsx","webpack://alphahuman-telegram/./src/components/common/CustomEmoji.module.scss?8f5a","webpack://alphahuman-telegram/./src/util/files.ts","webpack://alphahuman-telegram/./node_modules/pako/dist/pako_inflate.js","webpack://alphahuman-telegram/./src/util/iteratees.ts","webpack://alphahuman-telegram/./src/global/selectors/topics.ts","webpack://alphahuman-telegram/./src/lib/rlottie/RLottie.async.ts","webpack://alphahuman-telegram/./src/components/common/AvatarStoryCircle.tsx","webpack://alphahuman-telegram/./src/global/actions/ui/initial.ts","webpack://alphahuman-telegram/./src/types/index.ts","webpack://alphahuman-telegram/./src/util/forumColors.ts","webpack://alphahuman-telegram/./src/global/helpers/reactions.ts","webpack://alphahuman-telegram/./src/global/helpers/media.ts","webpack://alphahuman-telegram/./src/global/helpers/misc.ts","webpack://alphahuman-telegram/./src/global/selectors/management.ts","webpack://alphahuman-telegram/./src/global/selectors/statistics.ts","webpack://alphahuman-telegram/./src/global/selectors/ui.ts","webpack://alphahuman-telegram/./src/global/selectors/globalSearch.ts","webpack://alphahuman-telegram/./src/components/common/helpers/documentInfo.ts","webpack://alphahuman-telegram/./src/util/element/calcTextLineHeightAndCount.ts","webpack://alphahuman-telegram/./src/hooks/useResizeObserver.ts","webpack://alphahuman-telegram/./src/hooks/useMultiaccountInfo.ts","webpack://alphahuman-telegram/./src/global/selectors/middleSearch.ts","webpack://alphahuman-telegram/./src/hooks/useCoordsInSharedCanvas.ts","webpack://alphahuman-telegram/./src/util/deepDiff.ts","webpack://alphahuman-telegram/./src/global/reducers/translations.ts","webpack://alphahuman-telegram/./src/util/buildStyle.ts","webpack://alphahuman-telegram/./src/util/browser/windowEnvironment.ts","webpack://alphahuman-telegram/./src/components/ui/Link.tsx","webpack://alphahuman-telegram/./src/components/ui/Link.module.scss?2387","webpack://alphahuman-telegram/./src/util/localization/utils.ts","webpack://alphahuman-telegram/./src/components/middle/message/ActionMessageText.tsx","webpack://alphahuman-telegram/./src/hooks/data/useSelectorSignal.ts","webpack://alphahuman-telegram/./src/util/replaceWithTeact.ts","webpack://alphahuman-telegram/./src/util/getReadableErrorText.ts","webpack://alphahuman-telegram/webpack/bootstrap","webpack://alphahuman-telegram/webpack/runtime/define property getters","webpack://alphahuman-telegram/webpack/runtime/ensure chunk","webpack://alphahuman-telegram/webpack/runtime/get javascript chunk filename","webpack://alphahuman-telegram/webpack/runtime/get mini-css chunk filename","webpack://alphahuman-telegram/webpack/runtime/global","webpack://alphahuman-telegram/webpack/runtime/hasOwnProperty shorthand","webpack://alphahuman-telegram/webpack/runtime/make namespace object","webpack://alphahuman-telegram/webpack/runtime/publicPath","webpack://alphahuman-telegram/webpack/runtime/css loading","webpack://alphahuman-telegram/webpack/runtime/jsonp chunk loading","webpack://alphahuman-telegram/./src/util/setupServiceWorker.ts","webpack://alphahuman-telegram/./src/global/intervals.ts","webpack://alphahuman-telegram/./src/util/init.ts","webpack://alphahuman-telegram/./src/global/init.ts","webpack://alphahuman-telegram/./src/util/betterView.ts","webpack://alphahuman-telegram/./src/util/tauri/setupTauriListeners.ts","webpack://alphahuman-telegram/./src/components/auth/AuthCode.async.tsx","webpack://alphahuman-telegram/./src/components/auth/AuthPassword.async.tsx","webpack://alphahuman-telegram/./src/util/fonts.ts","webpack://alphahuman-telegram/./src/components/auth/helpers/backNavigation.ts","webpack://alphahuman-telegram/./src/components/auth/helpers/getSuggestedLanguage.ts","webpack://alphahuman-telegram/./src/hooks/useLangString.ts","webpack://alphahuman-telegram/./src/components/auth/CountryCodeInput.tsx","webpack://alphahuman-telegram/./src/components/auth/AuthPhoneNumber.tsx","webpack://alphahuman-telegram/./src/components/auth/AuthQrCode.tsx","webpack://alphahuman-telegram/./src/components/auth/AuthRegister.async.tsx","webpack://alphahuman-telegram/./src/components/auth/Auth.tsx","webpack://alphahuman-telegram/./src/components/ui/RoundTimer.module.scss?7ffc","webpack://alphahuman-telegram/./src/components/ui/RoundTimer.tsx","webpack://alphahuman-telegram/./src/components/ui/Notification.tsx","webpack://alphahuman-telegram/./src/components/common/Notifications.tsx","webpack://alphahuman-telegram/./src/components/App.module.scss?a9d3","webpack://alphahuman-telegram/./src/components/common/UiLoader.module.scss?03f6","webpack://alphahuman-telegram/./src/components/common/UiLoader.tsx","webpack://alphahuman-telegram/./src/components/main/AppInactive.tsx","webpack://alphahuman-telegram/./src/components/main/LockScreen.async.tsx","webpack://alphahuman-telegram/./src/components/main/Main.async.tsx","webpack://alphahuman-telegram/./src/components/welcome/Welcome.tsx","webpack://alphahuman-telegram/./src/components/auth/NotionOAuthCallback.module.scss?c5e1","webpack://alphahuman-telegram/./src/components/auth/GoogleOAuthCallback.module.scss?b1dd","webpack://alphahuman-telegram/./src/components/App.tsx","webpack://alphahuman-telegram/./src/components/auth/NotionOAuthCallback.tsx","webpack://alphahuman-telegram/./src/components/auth/GoogleOAuthCallback.tsx","webpack://alphahuman-telegram/./src/hooks/tauri/useTauriDrag.ts","webpack://alphahuman-telegram/./src/index.tsx","webpack://alphahuman-telegram/./src/util/tauri/initTauriApi.ts","webpack://alphahuman-telegram/./src/util/browser/listenOtherClients.ts","webpack://alphahuman-telegram/./src/util/updateWebmanifest.ts"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; (typeof current == 'object' || typeof current == 'function') && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","var inProgress = {};\nvar dataWebpackPrefix = \"alphahuman-telegram:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","import usePreviousDeprecated from './usePreviousDeprecated';\n\nexport default function useCurrentOrPrev<T>(\n  current: T, shouldSkipUndefined = false, shouldForceCurrent = false,\n): T | undefined {\n  const prev = usePreviousDeprecated(current, shouldSkipUndefined);\n\n  // eslint-disable-next-line no-null/no-null\n  return shouldForceCurrent || (current !== null && current !== undefined) ? current : prev;\n}\n","import type { ApiPasskeyOption, ApiPasskeyRegistrationOption } from '../../api/types';\n\nexport function toCredentialCreationOptions(option: ApiPasskeyRegistrationOption): CredentialCreationOptions {\n  const publicKey = PublicKeyCredential.parseCreationOptionsFromJSON(option.publicKey);\n\n  return {\n    publicKey,\n  };\n}\n\nexport function toCredentialRequestOptions(option: ApiPasskeyOption): CredentialRequestOptions {\n  const publicKey = PublicKeyCredential.parseRequestOptionsFromJSON(option.publicKey);\n\n  return {\n    publicKey,\n  };\n}\n","import type { ActionReturnType, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { updateTabState } from '../reducers/tabs';\nimport { addActionHandler, type TabStateActionNames } from '..';\n\nexport function addTabStateResetterAction<ActionName extends TabStateActionNames>(\n  name: ActionName, key: keyof TabState,\n) {\n  // @ts-ignore\n  addActionHandler(name, (global, actions, payload): ActionReturnType => {\n    const { tabId = getCurrentTabId() } = payload || {};\n\n    return updateTabState(global, {\n      [key]: undefined,\n    }, tabId);\n  });\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","let RE_NOT_LETTER: RegExp;\n\ntry {\n  RE_NOT_LETTER = /[^\\p{L}\\p{M}]+/ui;\n} catch (e) {\n  // Support for older versions of firefox\n  RE_NOT_LETTER = /[^\\w-]+/i;\n}\n\nexport default function searchWords(haystack: string, needle: string | string[]) {\n  if (!haystack || !needle) {\n    return false;\n  }\n\n  const needleWords = typeof needle === 'string' ? needle.toLowerCase().split(RE_NOT_LETTER) : needle;\n  const haystackLower = haystack.toLowerCase();\n\n  // @optimization\n  if (needleWords.length === 1 && !haystackLower.includes(needleWords[0])) {\n    return false;\n  }\n\n  let haystackWords: string[];\n\n  return needleWords.every((needleWord) => {\n    if (!haystackLower.includes(needleWord)) {\n      return false;\n    }\n\n    if (!haystackWords) {\n      haystackWords = haystackLower.split(RE_NOT_LETTER);\n    }\n\n    return haystackWords.some((haystackWord) => haystackWord.startsWith(needleWord));\n  });\n}\n\nexport function prepareSearchWordsForNeedle(needle: string) {\n  const needleWords = needle.toLowerCase().split(RE_NOT_LETTER);\n\n  return (haystack: string) => searchWords(haystack, needleWords);\n}\n","import { useCallback, useMemo } from '../lib/teact/teact';\n\nimport type { Scheduler } from '../util/schedulers';\n\nimport { throttle, throttleWith } from '../util/schedulers';\n\nexport default function useThrottledCallback<T extends AnyToVoidFunction>(\n  fn: T,\n  deps: any[],\n  msOrSchedulerFn: number | Scheduler,\n  noFirst = false,\n) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(fn, deps);\n\n  return useMemo(() => {\n    if (typeof msOrSchedulerFn === 'number') {\n      return throttle(fnMemo, msOrSchedulerFn, !noFirst);\n    } else {\n      return throttleWith(msOrSchedulerFn, fnMemo);\n    }\n  }, [fnMemo, msOrSchedulerFn, noFirst]);\n}\n","import type { ApiPeerStories, ApiTypeStory } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\nimport type { ProfileCollectionKey } from './payments';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectPeer } from './peers';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentViewedStory<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { storyViewer: { peerId, storyId } } = selectTabState(global, tabId);\n\n  return { peerId, storyId };\n}\n\nexport function selectIsStoryViewerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { peerId, storyId } = selectCurrentViewedStory(global, tabId);\n\n  return Boolean(peerId) && Boolean(storyId);\n}\n\nexport function selectPeerStories<T extends GlobalState>(\n  global: T, peerId: string,\n): ApiPeerStories | undefined {\n  return global.stories.byPeerId[peerId];\n}\n\nexport function selectPeerStory<T extends GlobalState>(\n  global: T, peerId: string, storyId: number,\n): ApiTypeStory | undefined {\n  return selectPeerStories(global, peerId)?.byId[storyId];\n}\n\nexport function selectPinnedStories<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const stories = selectPeerStories(global, peerId);\n  if (!stories?.pinnedIds?.length) return undefined;\n  return stories.pinnedIds.map((id) => stories.byId[id]).filter((s) => (\n    s && 'isInProfile' in s && s.isInProfile\n  ));\n}\n\nexport function selectPeerFirstUnreadStoryId<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const peerStories = selectPeerStories(global, peerId);\n  if (!peerStories) {\n    return undefined;\n  }\n\n  if (!peerStories.lastReadId) {\n    return peerStories.orderedIds?.[0];\n  }\n\n  const lastReadIndex = peerStories.orderedIds.findIndex((id) => id === peerStories.lastReadId);\n\n  return peerStories.orderedIds?.[lastReadIndex + 1];\n}\n\nexport function selectPeerFirstStoryId<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  return selectPeerStories(global, peerId)?.orderedIds?.[0];\n}\n\nexport function selectStoryListForViewer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId?: number,\n  isSingleStory?: boolean,\n  isSinglePeer?: boolean,\n  isPrivate?: boolean,\n  isArchive?: boolean,\n): {\n  peerIds: string[];\n  storyIdsByPeerId: Record<string, number[]>;\n} | undefined {\n  const currentStoryId = storyId\n    || selectPeerFirstUnreadStoryId(global, peerId)\n    || selectPeerFirstStoryId(global, peerId);\n  if (!currentStoryId) {\n    return undefined;\n  }\n\n  if (isSingleStory) {\n    return {\n      peerIds: [peerId],\n      storyIdsByPeerId: { [peerId]: [currentStoryId] },\n    };\n  }\n\n  const peer = selectPeer(global, peerId);\n  const story = selectPeerStory(global, peerId, currentStoryId);\n  if (!peer || !story) {\n    return undefined;\n  }\n\n  const isUnread = (global.stories.byPeerId[peerId].lastReadId || 0) < story.id;\n\n  if (isSinglePeer) {\n    const storyIds = getPeerStoryIdsForViewer(global, peerId, isUnread, isArchive, isPrivate);\n\n    return storyIds?.length\n      ? { peerIds: [peerId], storyIdsByPeerId: { [peerId]: storyIds } }\n      : undefined;\n  }\n\n  const { orderedPeerIds: { active, archived } } = global.stories;\n  const orderedPeerIds = (peer.areStoriesHidden ? archived : active) ?? [];\n  const peerIds: string[] = [];\n  const storyIdsByPeerId: Record<string, number[]> = {};\n\n  for (const currentPeerId of orderedPeerIds) {\n    const storyIds = getPeerStoryIdsForViewer(global, currentPeerId, isUnread, isArchive, isPrivate);\n    if (storyIds?.length) {\n      peerIds.push(currentPeerId);\n      storyIdsByPeerId[currentPeerId] = storyIds;\n    }\n  }\n\n  return peerIds.length ? { peerIds, storyIdsByPeerId } : undefined;\n}\n\nfunction getPeerStoryIdsForViewer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isUnread?: boolean,\n  isArchive?: boolean,\n  isPrivate?: boolean,\n): number[] | undefined {\n  const peerStories = selectPeerStories(global, peerId);\n  const storySourceProp = isArchive ? 'archiveIds' : isPrivate ? 'profileIds' : 'orderedIds';\n  const storyIds = peerStories?.[storySourceProp];\n\n  if (!peerStories || !storyIds?.length) {\n    return undefined;\n  }\n\n  if (!peerStories.lastReadId || !isUnread) {\n    return storyIds.slice();\n  }\n\n  const lastReadIndex = storyIds.indexOf(peerStories.lastReadId);\n  return (storyIds.length > lastReadIndex + 1)\n    ? storyIds.slice(lastReadIndex + 1)\n    : undefined;\n}\n\nexport function selectActiveStoriesCollectionId<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ProfileCollectionKey {\n  return selectTabState(global, tabId).selectedStoryAlbumId || 'all';\n}\n","import { DEBUG, DEBUG_ALERT_MSG } from '../config';\nimport { isCurrentTabMaster } from './establishMultitabRole';\nimport { throttle } from './schedulers';\n\nlet showError = true;\nlet error: Error | undefined;\n\nwindow.addEventListener('error', handleErrorEvent);\nwindow.addEventListener('unhandledrejection', handleErrorEvent);\n\nif (DEBUG) {\n  window.addEventListener('focus', () => {\n    if (!isCurrentTabMaster()) {\n      return;\n    }\n    showError = true;\n    if (error) {\n      // window.alert(getErrorMessage(error));\n      error = undefined;\n    }\n  });\n  window.addEventListener('blur', () => {\n    if (!isCurrentTabMaster()) {\n      return;\n    }\n    showError = false;\n  });\n}\n\nconst throttleError = throttle((err) => {\n  if (showError) {\n    console.error(err);\n    // window.alert(getErrorMessage(err));\n  } else {\n    error = err;\n  }\n}, 1500);\n\nexport function handleError(err: Error) {\n  // eslint-disable-next-line no-console\n  console.error(err);\n  if (DEBUG) {\n    throttleError(err);\n  }\n}\n\nfunction handleErrorEvent(e: ErrorEvent | PromiseRejectionEvent) {\n  if (e instanceof ErrorEvent) {\n    // https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded\n    if (e.message === 'ResizeObserver loop limit exceeded') {\n      return;\n    }\n\n    // Flood wait errors\n    if (e.message.includes('A wait of')) {\n      return;\n    }\n  }\n\n  e.preventDefault();\n  handleError(e instanceof ErrorEvent ? (e.error || e.message) : e.reason);\n}\n\nfunction getErrorMessage(err: Error) {\n  return `${DEBUG_ALERT_MSG}\\n\\n${(err?.message) || err}\\n${err?.stack}`;\n}\n","import { useMemo } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { ApiThumbnail, MediaContainer } from '../../api/types';\n\nimport { selectTheme } from '../../global/selectors';\nimport { selectMessageMediaThumbDataUri } from '../../global/selectors/media';\n\nexport default function useThumbnail(media?: MediaContainer | ApiThumbnail) {\n  const isMediaContainer = media && 'content' in media;\n  const global = getGlobal();\n  const thumbDataUri = isMediaContainer ? selectMessageMediaThumbDataUri(global, media) : media?.dataUri;\n\n  // TODO Find a way to update thumbnail on theme change\n  const theme = selectTheme(global);\n\n  const dataUri = useMemo(() => {\n    const uri = thumbDataUri;\n    if (!uri || theme !== 'dark') return uri;\n\n    return uri.replace('<svg', '<svg fill=\"white\"');\n  }, [thumbDataUri, theme]);\n\n  return dataUri;\n}\n","import type { FC, VirtualElement } from '../../lib/teact/teact';\nimport { useLayoutEffect, useRef } from '../../lib/teact/teact';\nimport TeactDOM from '../../lib/teact/teact-dom';\n\ntype OwnProps = {\n  containerSelector?: string;\n  className?: string;\n  children: VirtualElement;\n};\n\nconst Portal: FC<OwnProps> = ({ containerSelector, className, children }) => {\n  const elementRef = useRef<HTMLDivElement>();\n  if (!elementRef.current) {\n    elementRef.current = document.createElement('div');\n  }\n\n  useLayoutEffect(() => {\n    const container = document.querySelector<HTMLDivElement>(containerSelector || '#portals');\n    if (!container) {\n      return undefined;\n    }\n\n    const element = elementRef.current!;\n    if (className) {\n      element.classList.add(className);\n    }\n\n    container.appendChild(element);\n\n    return () => {\n      TeactDOM.render(undefined, element);\n      container.removeChild(element);\n    };\n  }, [className, containerSelector]);\n\n  return TeactDOM.render(children, elementRef.current);\n};\n\nexport default Portal;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiMediaExtendedPreview, ApiMessage, MediaContent, StatefulMediaContent,\n} from '../../api/types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { type LangFn } from '../../util/localization';\nimport trimText from '../../util/trimText';\nimport { renderTextWithEntities } from '../../components/common/helpers/renderTextWithEntities';\nimport {\n  getMessageTextWithFallback, getMessageTranscription,\n} from './messages';\n\nconst SPOILER_CHARS = ['', '', '', ''];\nexport const TRUNCATED_SUMMARY_LENGTH = 200;\n\nexport function getMessageSummaryText(\n  lang: LangFn,\n  message: ApiMessage,\n  statefulContent: StatefulMediaContent | undefined,\n  noEmoji = false,\n  truncateLength = TRUNCATED_SUMMARY_LENGTH,\n  isExtended = false,\n) {\n  const emoji = !noEmoji && getMessageSummaryEmoji(message);\n  const emojiWithSpace = emoji ? `${emoji} ` : '';\n  const text = trimText(getMessageTextWithSpoilers(lang, message, statefulContent), truncateLength);\n  const description = getMessageSummaryDescription(lang, message, statefulContent, text, isExtended) as string;\n\n  return `${emojiWithSpace}${description}`;\n}\n\nexport function getMessageTextWithSpoilers(\n  lang: LangFn,\n  message: ApiMessage,\n  statefulContent: StatefulMediaContent | undefined,\n) {\n  const transcription = getMessageTranscription(message);\n\n  const textWithoutTranscription = getMessageTextWithFallback(lang, statefulContent?.story || message)?.text;\n  if (!textWithoutTranscription) {\n    return transcription;\n  }\n\n  const { entities } = message.content.text || {};\n  if (!entities?.length) {\n    return transcription ? `${transcription}\\n${textWithoutTranscription}` : textWithoutTranscription;\n  }\n\n  const text = entities.reduce((accText, {\n    type,\n    offset,\n    length,\n  }) => {\n    if (type !== ApiMessageEntityTypes.Spoiler) {\n      return accText;\n    }\n\n    const spoiler = generateBrailleSpoiler(length);\n\n    return `${accText.slice(0, offset)}${spoiler}${accText.slice(offset + length)}`;\n  }, textWithoutTranscription);\n\n  return transcription ? `${transcription}\\n${text}` : text;\n}\n\nexport function getMessageSummaryEmoji(message: ApiMessage) {\n  const {\n    photo,\n    video,\n    audio,\n    voice,\n    document,\n    sticker,\n    pollId,\n    paidMedia,\n    todo,\n  } = message.content;\n\n  if (message.groupedId || photo || paidMedia) {\n    return '';\n  }\n\n  if (video) {\n    return '';\n  }\n\n  if (sticker) {\n    return sticker.emoji;\n  }\n\n  if (audio) {\n    return '';\n  }\n\n  if (voice) {\n    return '';\n  }\n\n  if (document) {\n    return '';\n  }\n\n  if (pollId) {\n    return '';\n  }\n\n  if (todo) {\n    return '';\n  }\n\n  return undefined;\n}\n\nexport function getMediaContentTypeDescription(\n  lang: LangFn, content: MediaContent, statefulContent: StatefulMediaContent | undefined,\n) {\n  return getSummaryDescription(lang, content, statefulContent);\n}\nexport function getMessageSummaryDescription(\n  lang: LangFn,\n  message: ApiMessage,\n  statefulContent: StatefulMediaContent | undefined,\n  truncatedText?: string | TeactNode,\n  isExtended = false,\n) {\n  return getSummaryDescription(lang, message.content, statefulContent, message, truncatedText, isExtended);\n}\nfunction getSummaryDescription(\n  lang: LangFn,\n  mediaContent: MediaContent,\n  statefulContent: StatefulMediaContent | undefined,\n  message?: ApiMessage,\n  truncatedText?: string | TeactNode,\n  isExtended = false,\n) {\n  const {\n    text,\n    photo,\n    video,\n    audio,\n    voice,\n    document,\n    sticker,\n    contact,\n    invoice,\n    location,\n    game,\n    storyData,\n    giveaway,\n    giveawayResults,\n    paidMedia,\n    todo,\n  } = mediaContent;\n  const { poll } = statefulContent || {};\n\n  let hasUsedTruncatedText = false;\n  let summary: TeactNode | undefined;\n\n  const boughtExtendedMedia = paidMedia?.isBought && paidMedia.extendedMedia;\n  const previewExtendedMedia = paidMedia && !paidMedia.isBought\n    ? paidMedia.extendedMedia as ApiMediaExtendedPreview[] : undefined;\n\n  const isPaidMediaAlbum = paidMedia && paidMedia.extendedMedia.length > 1;\n  const isPaidMediaSingleVideo = !isPaidMediaAlbum\n    && (boughtExtendedMedia?.[0].video || previewExtendedMedia?.[0].duration);\n  const isPaidMediaSinglePhoto = !isPaidMediaAlbum && !isPaidMediaSingleVideo;\n\n  if (message?.groupedId || isPaidMediaAlbum) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('Album');\n  }\n\n  if (photo || isPaidMediaSinglePhoto) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('AttachPhoto');\n  }\n\n  if (video || isPaidMediaSingleVideo) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang(video?.isGif ? 'AttachGif' : 'AttachVideo');\n  }\n\n  if (sticker) {\n    summary = lang('AttachSticker').trim();\n  }\n\n  if (audio) {\n    summary = getMessageAudioCaption(mediaContent) || lang('AttachMusic');\n  }\n\n  if (voice) {\n    hasUsedTruncatedText = true;\n    summary = truncatedText || lang('AttachAudio');\n  }\n\n  if (document) {\n    hasUsedTruncatedText = !isExtended;\n    summary = isExtended ? document.fileName : (truncatedText || document.fileName);\n  }\n\n  if (contact) {\n    summary = lang('AttachContact');\n  }\n\n  if (poll) {\n    summary = renderTextWithEntities({\n      text: poll.summary.question.text,\n      entities: poll.summary.question.entities,\n      asPreview: true,\n    });\n  }\n\n  if (invoice) {\n    summary = invoice.extendedMedia ? invoice.title : lang('AttachInvoice', { description: invoice.description });\n  }\n\n  if (text) {\n    if (isExtended && summary && !hasUsedTruncatedText) {\n      (summary as string) += `\\n${truncatedText as string}`;\n    } else {\n      summary = truncatedText as string;\n    }\n  }\n\n  if (location?.mediaType === 'geo' || location?.mediaType === 'venue') {\n    summary = lang('AttachLocation');\n  }\n\n  if (location?.mediaType === 'geoLive') {\n    summary = lang('AttachLiveLocation');\n  }\n\n  if (game) {\n    summary = ` ${game.title}`;\n  }\n\n  if (giveaway) {\n    summary = lang('AttachGiveaway');\n  }\n\n  if (giveawayResults) {\n    summary = lang('AttachGiveawayResults');\n  }\n\n  if (storyData) {\n    summary = truncatedText || lang('AttachStory');\n  }\n\n  if (todo) {\n    summary = renderTextWithEntities({\n      text: todo.todo.title.text,\n      entities: todo.todo.title.entities,\n      asPreview: true,\n    });\n  }\n\n  return summary || lang('MessageUnsupported');\n}\n\nexport function generateBrailleSpoiler(length: number) {\n  return new Array(length)\n    .fill(undefined)\n    .map(() => SPOILER_CHARS[Math.floor(Math.random() * SPOILER_CHARS.length)])\n    .join('');\n}\n\nfunction getMessageAudioCaption(mediaContent: MediaContent) {\n  const {\n    audio,\n    text,\n  } = mediaContent;\n\n  return (audio && [audio.title, audio.performer].filter(Boolean)\n    .join('  ')) || (text?.text);\n}\n","import { getActions } from '../global';\n\nlet promptInstall: () => Promise<void>;\n\nexport function setupBeforeInstallPrompt() {\n  window.addEventListener('beforeinstallprompt', (e: any) => {\n    promptInstall = async () => {\n      e.prompt();\n      const userChoice = await e.userChoice;\n      const isInstalled = userChoice.outcome === 'accepted';\n\n      if (!isInstalled) return;\n      getActions().setInstallPrompt({ canInstall: false });\n    };\n    getActions().setInstallPrompt({ canInstall: true });\n  });\n}\n\nexport function getPromptInstall() {\n  return promptInstall;\n}\n","import { type TeactNode } from '../../../../lib/teact/teact';\nimport { getActions } from '../../../../global';\n\nimport type { ApiMessage } from '../../../../api/types';\nimport type { ApiMessageActionPhoneCall } from '../../../../api/types/messageActions';\nimport type {\n  LangKey,\n  LangPairPluralWithVariables,\n  LangPairWithVariables,\n  PluralLangKeyWithVariables,\n  RegularLangKey,\n  RegularLangKeyWithVariables,\n} from '../../../../types/language';\nimport type { LangFn } from '../../../../util/localization';\n\nimport { getMessageContent } from '../../../../global/helpers';\nimport { IS_SAFARI } from '../../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../../util/buildClassName';\nimport renderText from '../../../common/helpers/renderText';\n\nimport Link from '../../../ui/Link';\n\nimport styles from '../ActionMessage.module.scss';\n\ntype SuffixKey<T, K extends keyof T> = `${K & string}You` extends keyof T ? T[`${K & string}You`] : never;\ntype VariablesForKey<K extends LangKey> =\n  K extends RegularLangKeyWithVariables\n    ? LangPairWithVariables<TeactNode | undefined>[K] | SuffixKey<LangPairWithVariables, K>\n    : K extends PluralLangKeyWithVariables\n      ? LangPairPluralWithVariables<TeactNode | undefined>[K] | SuffixKey<LangPairPluralWithVariables, K>\n      : undefined;\n\nexport function translateWithYou<K extends LangKey>(\n  lang: LangFn,\n  key: K,\n  isYou: boolean,\n  variables: VariablesForKey<K>,\n  options?: {\n    pluralValue?: number;\n    asText?: boolean;\n    withMarkdown?: boolean;\n    renderTextFilters?: string[];\n  },\n): TeactNode {\n  const { pluralValue, asText, withMarkdown, renderTextFilters } = options || {};\n  const translationKey = isYou ? (`${key}You` as LangKey) : key;\n\n  return lang(\n    // @ts-ignore -- I have no idea if this even possible to type correctly\n    translationKey,\n    variables,\n    {\n      withNodes: !asText, withMarkdown, pluralValue, renderTextFilters,\n    },\n  );\n}\n\nexport function getPinnedMediaValue(lang: LangFn, message: ApiMessage) {\n  const {\n    audio, contact, document, game, giveaway, giveawayResults, paidMedia, storyData,\n    invoice, location, photo, pollId, sticker, video, voice,\n  } = getMessageContent(message);\n\n  if (message.groupedId || paidMedia) return lang('ActionPinnedMediaAlbum');\n  if (photo) return lang('ActionPinnedMediaPhoto');\n  if (audio) return lang('ActionPinnedMediaAudio');\n  if (voice) return lang('ActionPinnedMediaVoice');\n  if (video?.isRound) return lang('ActionPinnedMediaVideoMessage');\n  if (video?.isGif) return lang('ActionPinnedMediaGif');\n  if (video) return lang('ActionPinnedMediaVideo');\n  if (sticker) return lang('ActionPinnedMediaSticker');\n  if (document) return lang('ActionPinnedMediaFile');\n  if (contact) return lang('ActionPinnedMediaContact');\n  if (location) return lang('ActionPinnedMediaLocation');\n  if (storyData) return lang('ActionPinnedMediaStory');\n  if (invoice) return lang('ActionPinnedMediaInvoice');\n  if (game) return lang('ActionPinnedMediaGame', { game: game.title });\n  if (pollId) return lang('ActionPinnedMediaPoll');\n  if (giveaway) return lang('ActionPinnedMediaGiveaway');\n  if (giveawayResults) return lang('ActionPinnedMediaGiveawayResults');\n\n  return undefined;\n}\n\nexport function renderPeerLink(peerId: string | undefined, text: string, asPreview?: boolean) {\n  if (!peerId || asPreview) {\n    return renderText(text);\n  }\n\n  return (\n    <Link\n      className={buildClassName(styles.peerLink, styles.strong)}\n\n      onClick={(e) => {\n        e.stopPropagation();\n        getActions().openChat({ id: peerId });\n      }}\n      // box-decoration-break: clone; is broken when child has `dir` attribute\n      // https://bugs.webkit.org/show_bug.cgi?id=296990\n      withMultilineFix={IS_SAFARI}\n    >\n      {renderText(text)}\n    </Link>\n  );\n}\n\nexport function renderMessageLink(\n  targetMessage: ApiMessage | undefined,\n  text: TeactNode,\n  asPreview: boolean | undefined,\n  params?: {\n    noEllipsis?: boolean;\n  },\n) {\n  const { noEllipsis } = params || {};\n\n  if (asPreview || !targetMessage) return text;\n\n  return (\n    <Link\n      className={buildClassName(styles.messageLink, noEllipsis && styles.noEllipsis)}\n      onClick={(e) => {\n        e.stopPropagation();\n        getActions().focusMessage({ chatId: targetMessage.chatId, messageId: targetMessage.id });\n      }}\n      withMultilineFix={IS_SAFARI}\n    >\n      {text}\n    </Link>\n  );\n}\n\nexport function renderTopicLink(chatId: string, topicId: number, content: TeactNode, asPreview?: boolean) {\n  if (asPreview) return content;\n\n  return (\n    <Link\n      className={styles.topicLink}\n      onClick={(e) => {\n        e.stopPropagation();\n        getActions().openThread({ chatId, threadId: topicId });\n      }}\n      withMultilineFix={IS_SAFARI}\n    >\n      {content}\n    </Link>\n  );\n}\n\nexport function getCallMessageKey(action: ApiMessageActionPhoneCall, isOutgoing: boolean): RegularLangKey {\n  const isMissed = action.reason === 'missed';\n  const isCancelled = action.reason === 'busy' || action.duration === undefined;\n  if (action.isVideo) {\n    if (isMissed) return isOutgoing ? 'CallMessageVideoOutgoingMissed' : 'CallMessageVideoIncomingMissed';\n    if (isCancelled) return 'CallMessageVideoIncomingDeclined';\n\n    return isOutgoing ? 'CallMessageVideoOutgoing' : 'CallMessageVideoIncoming';\n  } else {\n    if (isMissed) return isOutgoing ? 'CallMessageOutgoingMissed' : 'CallMessageIncomingMissed';\n    if (isCancelled) return 'CallMessageIncomingDeclined';\n\n    return isOutgoing ? 'CallMessageOutgoing' : 'CallMessageIncoming';\n  }\n}\n","import type { AccountInfo, SessionUserInfo, SharedSessionData } from '../types';\n\nimport {\n  ACCOUNT_QUERY,\n  DATA_BROADCAST_CHANNEL_PREFIX,\n  ESTABLISH_BROADCAST_CHANNEL_PREFIX,\n  GLOBAL_STATE_CACHE_PREFIX,\n  MULTITAB_LOCALSTORAGE_KEY_PREFIX,\n  SESSION_ACCOUNT_PREFIX,\n} from '../config';\nimport { IS_MULTIACCOUNT_SUPPORTED } from './browser/globalEnvironment';\n\nconst WORKER_NAME = typeof WorkerGlobalScope !== 'undefined' && globalThis.self instanceof WorkerGlobalScope\n  ? globalThis.self.name : undefined;\nconst WORKER_ACCOUNT_SLOT = WORKER_NAME ? Number(new URLSearchParams(WORKER_NAME).get(ACCOUNT_QUERY)) : undefined;\n\nexport const ACCOUNT_SLOT = WORKER_ACCOUNT_SLOT || (\n  IS_MULTIACCOUNT_SUPPORTED ? getAccountSlot(globalThis.location.href) : undefined\n);\n\nexport const DATA_BROADCAST_CHANNEL_NAME = `${DATA_BROADCAST_CHANNEL_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const ESTABLISH_BROADCAST_CHANNEL_NAME = `${ESTABLISH_BROADCAST_CHANNEL_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const MULTITAB_STORAGE_KEY = `${MULTITAB_LOCALSTORAGE_KEY_PREFIX}_${ACCOUNT_SLOT || 1}`;\nexport const GLOBAL_STATE_CACHE_KEY = ACCOUNT_SLOT\n  ? `${GLOBAL_STATE_CACHE_PREFIX}_${ACCOUNT_SLOT}` : GLOBAL_STATE_CACHE_PREFIX;\n\nexport function getAccountSlot(url: string) {\n  const params = new URL(url).searchParams;\n  const slot = params.get(ACCOUNT_QUERY);\n  const slotNumber = slot ? Number(slot) : 1;\n  if (!slotNumber || Number.isNaN(slotNumber) || slotNumber === 1) return undefined;\n  return slotNumber;\n}\n\nexport function getAccountsInfo() {\n  if (!IS_MULTIACCOUNT_SUPPORTED) return {};\n  const allKeys = Object.keys(localStorage);\n  const allSlots = allKeys.filter((key) => key.startsWith(SESSION_ACCOUNT_PREFIX));\n  const accountInfo: Record<number, AccountInfo> = {};\n  for (const key of allSlots) {\n    const i = Number(key.slice(SESSION_ACCOUNT_PREFIX.length));\n    const info = getAccountInfo(i);\n    if (info) {\n      accountInfo[i] = info;\n    }\n  }\n  return accountInfo;\n}\n\nfunction getAccountInfo(slot: number): AccountInfo | undefined {\n  const sessionData = loadSlotSession(slot);\n  const {\n    userId, avatarUri, color, emojiStatusId, firstName, lastName, isPremium, isTest, phone,\n  } = sessionData || {};\n\n  if (!userId) return undefined;\n\n  return {\n    userId,\n    avatarUri,\n    color,\n    emojiStatusId,\n    firstName,\n    lastName,\n    isPremium,\n    isTest,\n    phone,\n  };\n}\n\nexport function loadSlotSession(slot: number | undefined): SharedSessionData | undefined {\n  try {\n    const data = JSON.parse(localStorage.getItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`) || '{}') as SharedSessionData;\n    if (!data.dcId) return undefined;\n    return data;\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function storeAccountData(slot: number | undefined, data: Partial<SessionUserInfo>) {\n  const currentSlotData = loadSlotSession(slot);\n\n  if (!currentSlotData) return;\n\n  const updatedSharedData: SharedSessionData = {\n    ...currentSlotData,\n    ...data,\n  };\n\n  if (!updatedSharedData.userId) return;\n\n  writeSlotSession(slot, updatedSharedData);\n}\n\nexport function writeSlotSession(slot: number | undefined, data: SharedSessionData) {\n  localStorage.setItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`, JSON.stringify(data));\n}\n\nexport function getAccountSlotUrl(slot: number, forLogin?: boolean, isTest?: boolean) {\n  const url = new URL(globalThis.location.href);\n  if (slot !== 1) {\n    url.searchParams.set(ACCOUNT_QUERY, String(slot));\n  } else {\n    url.searchParams.delete(ACCOUNT_QUERY);\n  }\n\n  if (isTest) {\n    url.searchParams.set('test', 'true');\n  } else {\n    url.searchParams.delete('test');\n  }\n\n  url.hash = forLogin ? 'login' : '';\n  return url.toString();\n}\n\n// Validate current version across all tabs to avoid conflicts\nif (typeof window === 'object') {\n  const versionChannel = new BroadcastChannel('tt-version');\n  versionChannel.postMessage({ version: APP_VERSION });\n\n  versionChannel.addEventListener('message', (event) => {\n    const { version } = event.data;\n    if (!version) return;\n    if (semverCompare(APP_VERSION, version) === -1) {\n      window.location.reload();\n    }\n\n    // If incoming version is older, send back the current version\n    if (semverCompare(APP_VERSION, version) === 1) {\n      versionChannel.postMessage({ version: APP_VERSION });\n    }\n  });\n}\n\nfunction semverCompare(a: string, b: string) {\n  if (a.startsWith(`${b}-`)) return -1;\n  if (b.startsWith(`${a}-`)) return 1;\n  return a.localeCompare(b, undefined, { numeric: true, sensitivity: 'case', caseFirst: 'upper' });\n}\n","import { memo, useState } from '../../lib/teact/teact';\n\nimport type { OwnProps as AnimatedStickerProps } from './AnimatedSticker';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useFlag from '../../hooks/useFlag';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMediaTransitionDeprecated from '../../hooks/useMediaTransitionDeprecated';\n\nimport AnimatedSticker from './AnimatedSticker';\n\nconst DEFAULT_SIZE = 150;\n\nexport type OwnProps =\n  Partial<AnimatedStickerProps>\n  & { noTransition?: boolean; nonInteractive?: boolean };\n\nfunction AnimatedIcon(props: OwnProps) {\n  const {\n    size = DEFAULT_SIZE,\n    play = true,\n    noLoop = true,\n    className,\n    noTransition,\n    nonInteractive,\n    onLoad,\n    onClick,\n    ...otherProps\n  } = props;\n  const [isAnimationLoaded, markAnimationLoaded] = useFlag(false);\n  const transitionClassNames = useMediaTransitionDeprecated(noTransition || isAnimationLoaded);\n\n  const handleLoad = useLastCallback(() => {\n    markAnimationLoaded();\n    onLoad?.();\n  });\n\n  const [playKey, setPlayKey] = useState(() => String(Math.random()));\n\n  const handleClick = useLastCallback(() => {\n    if (play === true) {\n      setPlayKey(String(Math.random()));\n    }\n\n    onClick?.();\n  });\n\n  return (\n    <AnimatedSticker\n      className={buildClassName(className, transitionClassNames)}\n      size={size}\n      play={play === true ? playKey : play}\n      noLoop={noLoop}\n      onClick={!nonInteractive ? handleClick : undefined}\n      onLoad={handleLoad}\n\n      {...otherProps}\n    />\n  );\n}\n\nexport default memo(AnimatedIcon);\n","import type { TeactNode } from '../../../lib/teact/teact';\n\nimport type { TextPart } from '../../../types';\n\nimport { RE_LINK_TEMPLATE, RE_MENTION_TEMPLATE } from '../../../config';\nimport EMOJI_REGEX from '../../../lib/twemojiRegex';\nimport { IS_EMOJI_SUPPORTED } from '../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../util/buildClassName';\nimport { isDeepLink } from '../../../util/deepLinkParser';\nimport {\n  handleEmojiLoad,\n  LOADED_EMOJIS,\n  nativeToUnifiedExtendedWithCache,\n} from '../../../util/emoji/emoji';\nimport fixNonStandardEmoji from '../../../util/emoji/fixNonStandardEmoji';\nimport { compact } from '../../../util/iteratees';\n\nimport MentionLink from '../../middle/message/MentionLink';\nimport SafeLink from '../SafeLink';\n\nexport type TextFilter = (\n  'escape_html' | 'hq_emoji' | 'emoji' | 'emoji_html' | 'br' | 'br_html' | 'highlight' | 'links' |\n  'simple_markdown' | 'simple_markdown_html' | 'tg_links'\n);\n\nconst SIMPLE_MARKDOWN_REGEX = /(\\*\\*|__).+?\\1/g;\n\nexport default function renderText(\n  part: TextPart,\n  filters: Array<TextFilter> = ['emoji'],\n  params?: {\n    highlight?: string;\n    markdownPostProcessor?: (part: string) => TeactNode;\n  },\n): TeactNode[] {\n  if (typeof part !== 'string') {\n    return [part];\n  }\n\n  return compact(filters.reduce((text, filter) => {\n    switch (filter) {\n      case 'escape_html':\n        return escapeHtml(text, params?.markdownPostProcessor);\n\n      case 'hq_emoji':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'big', 'jsx', params?.markdownPostProcessor);\n\n      case 'emoji':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'small', 'jsx', params?.markdownPostProcessor);\n\n      case 'emoji_html':\n        EMOJI_REGEX.lastIndex = 0;\n        return replaceEmojis(text, 'small', 'html');\n\n      case 'br':\n        return addLineBreaks(text, 'jsx', params?.markdownPostProcessor);\n\n      case 'br_html':\n        return addLineBreaks(text, 'html');\n\n      case 'highlight':\n        return addHighlight(text, params!.highlight, params?.markdownPostProcessor);\n\n      case 'links':\n        return addLinks(text, undefined, params?.markdownPostProcessor);\n\n      case 'tg_links':\n        return addLinks(text, true, params?.markdownPostProcessor);\n\n      case 'simple_markdown':\n        return replaceSimpleMarkdown(text, 'jsx', params?.markdownPostProcessor);\n\n      case 'simple_markdown_html':\n        return replaceSimpleMarkdown(text, 'html');\n    }\n\n    return text;\n  }, [part] as TextPart[]));\n}\n\nfunction escapeHtml(textParts: TextPart[], postProcessor?: (part: string) => TeactNode): TextPart[] {\n  const postProcess = postProcessor || ((part: string) => part);\n\n  const divEl = document.createElement('div');\n  return textParts.reduce((result: TextPart[], part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    divEl.innerText = part;\n    result.push(postProcess(divEl.innerHTML));\n\n    return result;\n  }, []);\n}\n\nfunction replaceEmojis(\n  textParts: TextPart[], size: 'big' | 'small', type: 'jsx' | 'html',\n  postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  const postProcess = postProcessor || ((part: string) => part);\n\n  if (IS_EMOJI_SUPPORTED) {\n    return textParts.map((part) => typeof part === 'string' ? postProcess(part) : part);\n  }\n\n  return textParts.reduce((result: TextPart[], part: TextPart) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    part = fixNonStandardEmoji(part);\n    const parts = part.split(EMOJI_REGEX);\n    const emojis: string[] = part.match(EMOJI_REGEX) || [];\n    result.push(postProcess(parts[0]));\n\n    return emojis.reduce((emojiResult: TextPart[], emoji, i) => {\n      const code = nativeToUnifiedExtendedWithCache(emoji);\n      if (!code) {\n        emojiResult.push(postProcess(emoji));\n      } else {\n        const src = `./img-apple-${size === 'big' ? '160' : '64'}/${code}.png`;\n        const className = buildClassName(\n          'emoji',\n          size === 'small' && 'emoji-small',\n        );\n\n        if (type === 'jsx') {\n          const isLoaded = LOADED_EMOJIS.has(src);\n\n          emojiResult.push(\n            <img\n              src={src}\n              className={`${className}${!isLoaded ? ' opacity-transition slow shown' : ''}`}\n              alt={emoji}\n              data-path={src}\n              draggable={false}\n              onLoad={!isLoaded ? handleEmojiLoad : undefined}\n            />,\n          );\n        }\n        if (type === 'html') {\n          emojiResult.push(\n            `<img\\\n            draggable=\"false\"\\\n            class=\"${className}\"\\\n            src=\"${src}\"\\\n            alt=\"${emoji}\"\\\n          />`,\n          );\n        }\n      }\n\n      const index = i * 2 + 2;\n      if (parts[index]) {\n        emojiResult.push(postProcess(parts[index]));\n      }\n\n      return emojiResult;\n    }, result);\n  }, [] as TextPart[]);\n}\n\nfunction addLineBreaks(\n  textParts: TextPart[], type: 'jsx' | 'html', postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  const postProcess = postProcessor || ((part: string) => part);\n\n  return textParts.reduce((result: TextPart[], part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const splittenParts = part\n      .split(/\\r\\n|\\r|\\n/g)\n      .reduce((parts: TextPart[], line: string, i, source) => {\n        // This adds non-breaking space if line was indented with spaces, to preserve the indentation\n        const trimmedLine = line.trimStart();\n        const indentLength = line.length - trimmedLine.length;\n        parts.push(String.fromCharCode(160).repeat(indentLength));\n        parts.push(postProcess(trimmedLine));\n\n        if (i !== source.length - 1) {\n          parts.push(\n            type === 'jsx' ? <br /> : '<br />',\n          );\n        }\n\n        return parts;\n      }, []);\n\n    return [...result, ...splittenParts];\n  }, []);\n}\n\nfunction addHighlight(\n  textParts: TextPart[], highlight: string | undefined,\n  postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  const postProcess = postProcessor || ((part: string) => part);\n\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string' || !highlight) {\n      result.push(part);\n      return result;\n    }\n\n    const lowerCaseText = part.toLowerCase();\n    const queryPosition = lowerCaseText.indexOf(highlight.toLowerCase());\n    if (queryPosition < 0) {\n      result.push(postProcess(part));\n      return result;\n    }\n\n    const newParts: TextPart[] = [];\n    newParts.push(postProcess(part.substring(0, queryPosition)));\n    newParts.push(\n      <span className=\"matching-text-highlight\">\n        {postProcess(part.substring(queryPosition, queryPosition + highlight.length))}\n      </span>,\n    );\n    newParts.push(postProcess(part.substring(queryPosition + highlight.length)));\n    return [...result, ...newParts];\n  }, []);\n}\n\nconst RE_LINK = new RegExp(`${RE_LINK_TEMPLATE}|${RE_MENTION_TEMPLATE}`, 'ig');\n\nfunction addLinks(\n  textParts: TextPart[], allowOnlyTgLinks?: boolean, postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  const postProcess = postProcessor || ((part: string) => part);\n\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const links = part.match(RE_LINK);\n    if (!links || !links.length) {\n      result.push(postProcess(part));\n      return result;\n    }\n\n    const content: TextPart[] = [];\n\n    let nextLink = links.shift();\n    let lastIndex = 0;\n    while (nextLink) {\n      const index = part.indexOf(nextLink, lastIndex);\n      content.push(postProcess(part.substring(lastIndex, index)));\n      if (nextLink.startsWith('@')) {\n        content.push(\n          <MentionLink username={nextLink}>\n            {postProcess(nextLink)}\n          </MentionLink>,\n        );\n      } else {\n        if (nextLink.endsWith('?')) {\n          nextLink = nextLink.slice(0, nextLink.length - 1);\n        }\n\n        if (!allowOnlyTgLinks || isDeepLink(nextLink)) {\n          content.push(\n            <SafeLink text={nextLink} url={nextLink} />,\n          );\n        } else {\n          content.push(postProcess(nextLink));\n        }\n      }\n      lastIndex = index + nextLink.length;\n      nextLink = links.shift();\n    }\n    content.push(postProcess(part.substring(lastIndex)));\n\n    return [...result, ...content];\n  }, []);\n}\n\nfunction replaceSimpleMarkdown(\n  textParts: TextPart[], type: 'jsx' | 'html', postProcessor?: (part: string) => TeactNode,\n): TextPart[] {\n  // Currently supported only for JSX. If needed, add typings to support HTML as well.\n  const postProcess = postProcessor || ((part: string) => part);\n\n  return textParts.reduce<TextPart[]>((result, part) => {\n    if (typeof part !== 'string') {\n      result.push(part);\n      return result;\n    }\n\n    const parts = part.split(SIMPLE_MARKDOWN_REGEX);\n    const entities: string[] = part.match(SIMPLE_MARKDOWN_REGEX) || [];\n    result.push(postProcess(parts[0]));\n\n    return entities.reduce((entityResult: TextPart[], entity, i) => {\n      if (type === 'jsx') {\n        entityResult.push(\n          entity.startsWith('**')\n            ? <b>{postProcess(entity.replace(/\\*\\*/g, ''))}</b>\n            : <i>{postProcess(entity.replace(/__/g, ''))}</i>,\n        );\n      } else {\n        entityResult.push(\n          entity.startsWith('**')\n            ? `<b>${entity.replace(/\\*\\*/g, '')}</b>`\n            : `<i>${entity.replace(/__/g, '')}</i>`,\n        );\n      }\n\n      const index = i * 2 + 2;\n      if (parts[index]) {\n        entityResult.push(postProcess(parts[index]));\n      }\n\n      return entityResult;\n    }, result);\n  }, []);\n}\n\nexport function areLinesWrapping(text: string, element: HTMLElement) {\n  const lines = (text.trim().match(/\\n/g) || '').length + 1;\n  const { lineHeight } = getComputedStyle(element);\n  const lineHeightParsed = parseFloat(lineHeight.split('px')[0]);\n\n  return element.clientHeight >= (lines + 1) * lineHeightParsed;\n}\n","import type {\n  ApiUpdateAuthorizationError,\n  ApiUpdateAuthorizationState,\n  ApiUpdateConnectionState,\n  ApiUpdateCurrentUser,\n  ApiUpdatePasskeyOption,\n  ApiUpdateServerTimeOffset,\n  ApiUpdateSession,\n  ApiUpdateUserAlreadyAuthorized,\n} from '../../../api/types';\nimport type { LangCode } from '../../../types';\nimport type { RequiredGlobalActions } from '../../index';\nimport type { ActionReturnType, GlobalState } from '../../types';\n\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { getShippingError, shouldClosePaymentModal } from '../../../util/getReadableErrorText';\nimport { unique } from '../../../util/iteratees';\nimport { getAccountsInfo, getAccountSlotUrl } from '../../../util/multiaccount';\nimport { oldSetLanguage } from '../../../util/oldLangProvider';\nimport { clearWebTokenAuth } from '../../../util/routing';\nimport { setServerTimeOffset } from '../../../util/serverTime';\nimport { updateSessionUserId } from '../../../util/sessions';\nimport { forceWebsync } from '../../../util/websync';\nimport { isChatChannel, isChatSuperGroup } from '../../helpers';\nimport {\n  addActionHandler, getActions, getGlobal, setGlobal,\n} from '../../index';\nimport { updateUser, updateUserFullInfo } from '../../reducers';\nimport { updateAuth } from '../../reducers/auth';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectTabState } from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\naddActionHandler('apiUpdate', (global, actions, update): ActionReturnType => {\n  switch (update['@type']) {\n    case 'updateApiReady':\n      onUpdateApiReady(global);\n      break;\n\n    case 'updateAuthorizationState':\n      onUpdateAuthorizationState(global, update);\n      break;\n\n    case 'updateAuthorizationError':\n      onUpdateAuthorizationError(global, update);\n      break;\n\n    case 'updateUserAlreadyAuthorized':\n      onUpdateUserAlreadyAuthorized(global, update);\n      break;\n\n    case 'updateWebAuthTokenFailed':\n      onUpdateWebAuthTokenFailed(global);\n      break;\n\n    case 'updatePasskeyOption':\n      onUpdatePasskeyOption(global, update);\n      break;\n\n    case 'updateConnectionState':\n      onUpdateConnectionState(global, actions, update);\n      break;\n\n    case 'updateSession':\n      onUpdateSession(global, actions, update);\n      break;\n\n    case 'updateServerTimeOffset':\n      onUpdateServerTimeOffset(update);\n      break;\n\n    case 'updateCurrentUser':\n      onUpdateCurrentUser(global, update);\n      break;\n\n    case 'requestReconnectApi':\n      global = { ...global, isSynced: false };\n      setGlobal(global);\n\n      onUpdateConnectionState(global, actions, {\n        '@type': 'updateConnectionState',\n        connectionState: 'connectionStateConnecting',\n      });\n      actions.initApi();\n      break;\n\n    case 'requestSync':\n      actions.sync();\n      break;\n\n    case 'updateFetchingDifference':\n      global = { ...global, isFetchingDifference: update.isFetching };\n      setGlobal(global);\n      break;\n\n    case 'error': {\n      Object.values(global.byTabId).forEach(({ id: tabId }) => {\n        const paymentShippingError = getShippingError(update.error);\n        if (paymentShippingError) {\n          actions.addPaymentError({ error: paymentShippingError, tabId });\n        } else if (shouldClosePaymentModal(update.error)) {\n          actions.closePaymentModal({ tabId });\n        } else if (actions.showDialog) {\n          actions.showDialog({ data: update.error, tabId });\n        }\n      });\n\n      break;\n    }\n\n    case 'notSupportedInFrozenAccount': {\n      actions.showNotification({\n        title: {\n          key: 'NotificationTitleNotSupportedInFrozenAccount',\n        },\n        message: {\n          key: 'NotificationMessageNotSupportedInFrozenAccount',\n        },\n        tabId: getCurrentTabId(),\n      });\n      break;\n    }\n  }\n});\n\nfunction onUpdateApiReady<T extends GlobalState>(global: T) {\n  void oldSetLanguage(selectSharedSettings(global).language as LangCode);\n}\n\nfunction onUpdateAuthorizationState<T extends GlobalState>(global: T, update: ApiUpdateAuthorizationState) {\n  const wasAuthReady = global.auth.state === 'authorizationStateReady';\n  const authState = update.authorizationState;\n\n  global = updateAuth(global, {\n    state: authState,\n    isLoading: false,\n  });\n  setGlobal(global);\n  global = getGlobal();\n\n  switch (authState) {\n    case 'authorizationStateLoggingOut':\n      void forceWebsync(false);\n\n      global = updateAuth(global, {\n        isLoggingOut: true,\n      });\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitCode':\n      global = updateAuth(global, {\n        isCodeViaApp: update.isCodeViaApp,\n      });\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitPassword':\n      global = updateAuth(global, {\n        hint: update.hint,\n      });\n\n      if (update.noReset) {\n        global = updateAuth(global, {\n          hasWebAuthTokenPasswordRequired: true,\n        });\n      }\n\n      setGlobal(global);\n      break;\n    case 'authorizationStateWaitQrCode':\n      global = updateAuth(global, {\n        isLoadingQrCode: false,\n        qrCode: update.qrCode,\n      });\n      setGlobal(global);\n      break;\n    case 'authorizationStateReady': {\n      if (wasAuthReady) {\n        break;\n      }\n\n      void forceWebsync(true);\n\n      global = updateAuth(global, {\n        isLoggingOut: false,\n      });\n      Object.values(global.byTabId).forEach(({ id: tabId }) => {\n        global = updateTabState(global, {\n          inactiveReason: undefined,\n        }, tabId);\n      });\n      setGlobal(global);\n\n      break;\n    }\n  }\n}\n\nfunction onUpdateAuthorizationError<T extends GlobalState>(global: T, update: ApiUpdateAuthorizationError) {\n  if (update.errorCode === 'PASSKEY_CREDENTIAL_NOT_FOUND') {\n    getActions().showNotification({\n      message: update.errorKey,\n      tabId: getCurrentTabId(),\n    });\n    return;\n  }\n\n  global = updateAuth(global, {\n    errorKey: update.errorKey,\n  });\n  setGlobal(global);\n}\n\nfunction onUpdateUserAlreadyAuthorized<T extends GlobalState>(global: T, update: ApiUpdateUserAlreadyAuthorized) {\n  const { userId } = update;\n  if (global.currentUserId === userId) return;\n\n  const accounts = getAccountsInfo();\n  const slot = Object.entries(accounts).find(([_, info]) => info.userId === userId)?.[0];\n  if (!slot) return;\n  const url = getAccountSlotUrl(Number(slot));\n  window.location.replace(url);\n}\n\nfunction onUpdateWebAuthTokenFailed<T extends GlobalState>(global: T) {\n  clearWebTokenAuth();\n\n  global = updateAuth(global, {\n    hasWebAuthTokenFailed: true,\n  });\n  setGlobal(global);\n}\n\nfunction onUpdatePasskeyOption<T extends GlobalState>(global: T, update: ApiUpdatePasskeyOption) {\n  global = updateAuth(global, {\n    passkeyOption: update.option,\n  });\n  setGlobal(global);\n}\n\nfunction onUpdateConnectionState<T extends GlobalState>(\n  global: T, actions: RequiredGlobalActions, update: ApiUpdateConnectionState,\n) {\n  const { connectionState } = update;\n\n  const tabState = selectTabState(global, getCurrentTabId());\n  if (connectionState === 'connectionStateReady' && tabState.isMasterTab && tabState.multitabNextAction) {\n    // @ts-ignore\n    actions[tabState.multitabNextAction.action](tabState.multitabNextAction.payload);\n    actions.clearMultitabNextAction({ tabId: tabState.id });\n  }\n\n  if (connectionState === global.connectionState) {\n    return;\n  }\n\n  global = {\n    ...global,\n    connectionState,\n  };\n  setGlobal(global);\n\n  if (global.isSynced) {\n    const channelStackIds = Object.values(global.byTabId)\n      .flatMap((tab) => tab.messageLists)\n      .map((messageList) => messageList.chatId)\n      .filter((chatId) => {\n        const chat = global.chats.byId[chatId];\n        return chat && (isChatChannel(chat) || isChatSuperGroup(chat));\n      });\n    if (connectionState === 'connectionStateReady' && channelStackIds.length) {\n      unique(channelStackIds).forEach((chatId) => {\n        actions.requestChannelDifference({ chatId });\n      });\n    }\n  }\n\n  if (connectionState === 'connectionStateBroken') {\n    actions.signOut({ forceInitApi: true });\n  }\n}\n\nfunction onUpdateSession<T extends GlobalState>(global: T, actions: RequiredGlobalActions, update: ApiUpdateSession) {\n  const { sessionData } = update;\n  const { rememberMe, state } = global.auth;\n  const isEmpty = !sessionData || !sessionData.mainDcId;\n\n  const isTest = sessionData?.isTest;\n  if (isTest) {\n    global = {\n      ...global,\n      config: {\n        ...global.config,\n        isTestServer: isTest,\n      },\n    };\n    setGlobal(global);\n  }\n\n  if (!rememberMe || state !== 'authorizationStateReady' || isEmpty) {\n    return;\n  }\n\n  actions.saveSession({ sessionData });\n}\n\nfunction onUpdateServerTimeOffset(update: ApiUpdateServerTimeOffset) {\n  setServerTimeOffset(update.serverTimeOffset);\n}\n\nfunction onUpdateCurrentUser<T extends GlobalState>(global: T, update: ApiUpdateCurrentUser) {\n  const { currentUser, currentUserFullInfo } = update;\n\n  global = {\n    ...updateUser(global, currentUser.id, currentUser),\n    currentUserId: currentUser.id,\n  };\n  global = updateUserFullInfo(global, currentUser.id, currentUserFullInfo);\n  setGlobal(global);\n\n  updateSessionUserId(currentUser.id);\n}\n","import type {\n  GlobalState, TabArgs,\n  TabState,\n} from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\n\nexport function selectTabState<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): TabState {\n  return global.byTabId[tabId];\n}\n","import { getActions, getGlobal, setGlobal } from '../global';\n\nimport type {\n  ApiChat, ApiMessage, ApiPeer, ApiPeerReaction,\n  ApiPhoneCall, ApiUser,\n} from '../api/types';\nimport { ApiMediaFormat } from '../api/types';\n\nimport { APP_NAME, DEBUG, IS_TEST } from '../config';\nimport {\n  getChatAvatarHash,\n  getChatTitle,\n  getMessageRecentReaction,\n  getPrivateChatUserId,\n  getUserFullName,\n} from '../global/helpers';\nimport { getIsChatMuted, getIsChatSilent, getShouldShowMessagePreview } from '../global/helpers/notifications';\nimport { getMessageSenderName } from '../global/helpers/peers';\nimport {\n  selectCurrentMessageList,\n  selectCustomEmoji,\n  selectIsChatWithSelf,\n  selectNotifyDefaults,\n  selectNotifyException,\n  selectPeer,\n  selectSender,\n  selectSettingsKeys,\n  selectTopicFromMessage,\n} from '../global/selectors';\nimport { callApi } from '../api/gramjs';\nimport { IS_TAURI } from './browser/globalEnvironment';\nimport { IS_SERVICE_WORKER_SUPPORTED, IS_TOUCH_ENV } from './browser/windowEnvironment';\nimport jsxToHtml from './element/jsxToHtml';\nimport { buildCollectionByKey } from './iteratees';\nimport { getTranslationFn } from './localization';\nimport * as mediaLoader from './mediaLoader';\nimport { oldTranslate } from './oldLangProvider';\nimport { debounce } from './schedulers';\nimport { getServerTime } from './serverTime';\n\nimport MessageSummary from '../components/common/MessageSummary';\n\nfunction getDeviceToken(subscription: PushSubscription) {\n  const data = subscription.toJSON();\n  return JSON.stringify({\n    endpoint: data.endpoint,\n    keys: data.keys,\n  });\n}\n\nfunction checkIfPushSupported() {\n  if (!IS_SERVICE_WORKER_SUPPORTED || IS_TAURI) return false;\n\n  if (!('showNotification' in ServiceWorkerRegistration.prototype)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Push notifications aren\\'t supported.');\n    }\n    return false;\n  }\n\n  // If permission is denied, it is blocked until the user manually changes their settings\n  if (Notification.permission === 'denied') {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] The user has blocked push notifications.');\n    }\n    return false;\n  }\n\n  // Check if push messaging is supported\n  if (!('PushManager' in window)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Push messaging isn\\'t supported.');\n    }\n    return false;\n  }\n\n  return true;\n}\n\nexport function checkIfNotificationsSupported() {\n  // Let's check if the browser supports notifications\n  if (!('Notification' in window)) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] This browser does not support desktop notification');\n    }\n    return false;\n  }\n\n  if (Notification.permission === 'denied') {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] The user has blocked push notifications.');\n    }\n    return false;\n  }\n  return true;\n}\n\nconst expirationTime = 12 * 60 * 60 * 1000; // 12 hours\n// Notification id is removed from soundPlayed cache after 3 seconds\nconst soundPlayedDelay = 3 * 1000;\nconst soundPlayedIds = new Set<string>();\nconst notificationSound = new Audio('./notification.mp3');\nnotificationSound.setAttribute('mozaudiochannel', 'notification');\n\nexport async function playNotifySound(id?: string, volume?: number) {\n  if (id !== undefined && soundPlayedIds.has(id)) return;\n  const { notificationSoundVolume } = selectSettingsKeys(getGlobal());\n  const currentVolume = volume ? volume / 10 : notificationSoundVolume / 10;\n  if (currentVolume === 0) return;\n  notificationSound.volume = currentVolume;\n  if (id !== undefined) {\n    notificationSound.addEventListener('ended', () => {\n      soundPlayedIds.add(id);\n    }, { once: true });\n\n    setTimeout(() => {\n      soundPlayedIds.delete(id);\n    }, soundPlayedDelay);\n  }\n\n  try {\n    await notificationSound.play();\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[PUSH] Unable to play notification sound');\n    }\n  }\n}\n\nexport const playNotifySoundDebounced = debounce(playNotifySound, 1000, true, false);\n\nfunction checkIfShouldResubscribe(subscription: PushSubscription | null) {\n  const global = getGlobal();\n  if (!global.push || !subscription) return true;\n  if (getDeviceToken(subscription) !== global.push.deviceToken) return true;\n  return Date.now() - global.push.subscribedAt > expirationTime;\n}\n\nexport async function requestPermission() {\n  if (IS_TAURI) {\n    const tauriPlugin = await import('@tauri-apps/plugin-notification');\n    const tauriPermissionGranted = await tauriPlugin.isPermissionGranted();\n\n    if (!tauriPermissionGranted) {\n      const permission = await tauriPlugin.requestPermission();\n\n      return permission === 'granted';\n    }\n\n    return true;\n  }\n\n  if (!('Notification' in window)) {\n    return false;\n  }\n  let permission = Notification.permission;\n  if (!['granted', 'denied'].includes(permission)) {\n    permission = await Notification.requestPermission();\n  }\n  return permission === 'granted';\n}\n\nasync function unsubscribeFromPush(subscription: PushSubscription | null) {\n  const { deleteDeviceToken } = getActions();\n  if (subscription) {\n    try {\n      const deviceToken = getDeviceToken(subscription);\n      await callApi('unregisterDevice', deviceToken);\n      await subscription.unsubscribe();\n      deleteDeviceToken();\n      return;\n    } catch (error) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[PUSH] Unable to unsubscribe from push.', error);\n      }\n    }\n  }\n  const global = getGlobal();\n  if (global.push) {\n    await callApi('unregisterDevice', global.push.deviceToken);\n    deleteDeviceToken();\n  }\n}\n\nexport async function unsubscribe() {\n  if (!checkIfPushSupported()) return;\n  const serviceWorkerRegistration = await navigator.serviceWorker.ready;\n  const subscription = await serviceWorkerRegistration.pushManager.getSubscription();\n  await unsubscribeFromPush(subscription);\n}\n\n// Load custom emoji from the api if it's not cached already\nasync function loadCustomEmoji(id: string) {\n  let global = getGlobal();\n  if (selectCustomEmoji(global, id)) return;\n  const customEmoji = await callApi('fetchCustomEmoji', {\n    documentId: [id],\n  });\n  if (!customEmoji) return;\n  global = getGlobal();\n  global = {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      byId: {\n        ...global.customEmojis.byId,\n        ...buildCollectionByKey(customEmoji, 'id'),\n      },\n    },\n  };\n  setGlobal(global);\n}\n\nlet isSubscriptionFailed = false;\nexport function checkIfOfflinePushFailed() {\n  return isSubscriptionFailed;\n}\n\nexport async function subscribe() {\n  const { setDeviceToken, updateWebNotificationSettings } = getActions();\n  let hasWebNotifications = false;\n  let hasPushNotifications = false;\n  if (!checkIfPushSupported()) {\n    // Ask for notification permissions only if service worker notifications are not supported\n    // As pushManager.subscribe automatically triggers permission popup\n    hasWebNotifications = await requestPermission();\n    updateWebNotificationSettings({\n      hasWebNotifications,\n      hasPushNotifications,\n    });\n    return;\n  }\n  const serviceWorkerRegistration = await navigator.serviceWorker.ready;\n  let subscription = await serviceWorkerRegistration.pushManager.getSubscription();\n  if (!checkIfShouldResubscribe(subscription)) return;\n  await unsubscribeFromPush(subscription);\n  try {\n    subscription = await serviceWorkerRegistration.pushManager.subscribe({\n      userVisibleOnly: true,\n    });\n    const deviceToken = getDeviceToken(subscription);\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.log('[PUSH] Received push subscription: ', deviceToken);\n    }\n    await callApi('registerDevice', deviceToken);\n    setDeviceToken({ token: deviceToken });\n    hasPushNotifications = true;\n    hasWebNotifications = true;\n  } catch (error: any) {\n    if (Notification.permission === 'denied') {\n      // The user denied the notification permission which\n      // means we failed to subscribe and the user will need\n      // to manually change the notification permission to\n      // subscribe to push messages\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.warn('[PUSH] The user has blocked push notifications.');\n      }\n    } else {\n      // A problem occurred with the subscription, this can\n      // often be down to an issue or lack of the gcm_sender_id\n      // and / or gcm_user_visible_only\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[PUSH] Unable to subscribe to push.', error);\n      }\n      // Request permissions and fall back to local notifications\n      // if pushManager.subscribe was aborted due to invalid VAPID key.\n      if ([DOMException.ABORT_ERR, DOMException.NOT_SUPPORTED_ERR].includes(error.code)) {\n        isSubscriptionFailed = true;\n        hasWebNotifications = await requestPermission();\n      }\n    }\n  }\n  updateWebNotificationSettings({\n    hasWebNotifications,\n    hasPushNotifications,\n  });\n}\n\nfunction checkIfShouldNotify(chat: ApiChat, message: Partial<ApiMessage>) {\n  const global = getGlobal();\n  const isChatMuted = getIsChatMuted(chat, selectNotifyDefaults(global), selectNotifyException(global, chat.id));\n  const topic = selectTopicFromMessage(global, message as ApiMessage);\n  const topicMutedUntil = topic?.notifySettings.mutedUntil;\n  const isMuted = topicMutedUntil === undefined ? isChatMuted : topicMutedUntil > getServerTime();\n  const shouldIgnoreMute = message.isMentioned;\n\n  const shouldNotifyAboutMessage = message.content?.action?.type !== 'phoneCall';\n  if ((isMuted && !shouldIgnoreMute) || !shouldNotifyAboutMessage\n    || chat.isNotJoined || !chat.isListed || selectIsChatWithSelf(global, chat.id)) {\n    return false;\n  }\n  // On touch devices show notifications when chat is not active\n  if (IS_TOUCH_ENV) {\n    const {\n      chatId,\n      type,\n    } = selectCurrentMessageList(global) || {};\n    return !(chatId === chat.id && type === 'thread');\n  }\n  // On desktop show notifications when window is not focused\n  return !document.hasFocus();\n}\n\nfunction getNotificationContent(chat: ApiChat, message: ApiMessage, reaction?: ApiPeerReaction) {\n  const global = getGlobal();\n  let sender = selectSender(global, message);\n  const hasReaction = Boolean(reaction);\n  if (hasReaction) {\n    sender = selectPeer(global, reaction.peerId);\n  }\n\n  const { isScreenLocked } = global.passcode;\n  const privateChatUserId = getPrivateChatUserId(chat);\n  const isSelf = privateChatUserId === global.currentUserId;\n\n  let body: string;\n  if (\n    !isScreenLocked\n    && getShouldShowMessagePreview(chat, selectNotifyDefaults(global), selectNotifyException(global, chat.id))\n  ) {\n    const senderName = sender ? getMessageSenderName(getTranslationFn(), chat.id, sender) : undefined;\n    let summary = jsxToHtml(<span><MessageSummary message={message} /></span>)[0].textContent || '';\n\n    if (hasReaction) {\n      const emoji = getReactionEmoji(reaction);\n      summary = oldTranslate('PushReactText', [emoji, summary]);\n    }\n\n    body = senderName ? `${senderName}: ${summary}` : summary;\n  } else {\n    body = getTranslationFn()('NotificationMessageTextHidden');\n  }\n\n  let title = isScreenLocked ? APP_NAME : getChatTitle(oldTranslate, chat, isSelf);\n\n  if (message.isSilent) {\n    title += ' ';\n  }\n\n  return { title, body };\n}\n\nasync function getAvatar(chat: ApiPeer) {\n  const imageHash = getChatAvatarHash(chat);\n  if (!imageHash) return undefined;\n  let mediaData = mediaLoader.getFromMemory(imageHash);\n  if (!mediaData) {\n    await mediaLoader.fetch(imageHash, ApiMediaFormat.BlobUrl);\n    mediaData = mediaLoader.getFromMemory(imageHash);\n  }\n  return mediaData;\n}\n\nfunction getReactionEmoji(reaction: ApiPeerReaction) {\n  let emoji;\n  if (reaction.reaction.type === 'emoji') {\n    emoji = reaction.reaction.emoticon;\n  }\n\n  if (reaction.reaction.type === 'custom') {\n    emoji = selectCustomEmoji(getGlobal(), reaction.reaction.documentId)?.emoji;\n  }\n  return emoji || '';\n}\n\nexport async function notifyAboutCall({\n  call, user,\n}: {\n  call: ApiPhoneCall; user: ApiUser;\n}) {\n  const { hasWebNotifications } = selectSettingsKeys(getGlobal());\n  if (document.hasFocus() || !hasWebNotifications) return;\n  const areNotificationsSupported = checkIfNotificationsSupported();\n  if (!areNotificationsSupported) return;\n\n  const icon = await getAvatar(user);\n\n  const options: NotificationOptions = {\n    body: getUserFullName(user),\n    icon,\n    badge: icon,\n    tag: `call_${call.id}`,\n  };\n\n  if ('vibrate' in navigator) {\n    // @ts-ignore\n    options.vibrate = [200, 100, 200];\n  }\n\n  const notification = new Notification(oldTranslate('VoipIncoming'), options);\n\n  notification.onclick = () => {\n    notification.close();\n    if (window.focus) {\n      window.focus();\n    }\n  };\n}\n\nexport async function notifyAboutMessage({\n  chat,\n  message,\n  isReaction = false,\n}: { chat: ApiChat; message: Partial<ApiMessage>; isReaction?: boolean }) {\n  const global = getGlobal();\n  const { hasWebNotifications } = selectSettingsKeys(global);\n  if (!checkIfShouldNotify(chat, message)) return;\n  const isChatSilent = getIsChatSilent(\n    chat, selectNotifyDefaults(getGlobal()), selectNotifyException(getGlobal(), chat.id),\n  );\n  const topic = selectTopicFromMessage(global, message as ApiMessage);\n  const isSilent = topic?.notifySettings.hasSound === undefined ? isChatSilent : !topic.notifySettings.hasSound;\n\n  const areNotificationsSupported = checkIfNotificationsSupported();\n  if (!hasWebNotifications || !areNotificationsSupported) {\n    if (!isSilent && !message.isSilent && !isReaction && !IS_TAURI) {\n      // Only play sound if web notifications are disabled\n      playNotifySoundDebounced(String(message.id) || chat.id);\n    }\n\n    return;\n  }\n  if (!areNotificationsSupported) return;\n\n  if (!message.id) return;\n\n  const activeReaction = getMessageRecentReaction(message);\n  // Do not notify about reactions on messages that are not outgoing\n  if (isReaction && !activeReaction) return;\n\n  // If this is a custom emoji reaction we need to make sure it is loaded\n  if (isReaction && activeReaction && activeReaction.reaction.type === 'custom') {\n    await loadCustomEmoji(activeReaction.reaction.documentId);\n  }\n\n  const icon = await getAvatar(chat);\n\n  const {\n    title,\n    body,\n  } = getNotificationContent(chat, message as ApiMessage, activeReaction);\n\n  if (checkIfPushSupported()) {\n    if (navigator.serviceWorker?.controller) {\n      // notify service worker about new message notification\n      navigator.serviceWorker.controller.postMessage({\n        type: 'showMessageNotification',\n        payload: {\n          title,\n          body,\n          icon,\n          chatId: chat.id,\n          messageId: message.id,\n          shouldReplaceHistory: true,\n          isSilent: isSilent || message.isSilent,\n          reaction: activeReaction?.reaction,\n        },\n      });\n    }\n  } else {\n    const dispatch = getActions();\n    const options: NotificationOptions = {\n      body,\n      icon,\n      badge: icon,\n      tag: String(message.id),\n    };\n\n    if ('vibrate' in navigator) {\n      // @ts-ignore\n      options.vibrate = [200, 100, 200];\n    }\n\n    const notification = new Notification(title, options);\n\n    notification.onclick = () => {\n      notification.close();\n      dispatch.focusMessage({\n        chatId: chat.id,\n        messageId: message.id!,\n        shouldReplaceHistory: true,\n      });\n      if (window.focus) {\n        window.focus();\n      }\n    };\n\n    // Play sound when notification is displayed\n    notification.onshow = () => {\n      // TODO Update when reaction badges are implemented\n      if (isReaction || message.isSilent || IS_TAURI) return;\n      playNotifySoundDebounced(String(message.id) || chat.id);\n    };\n  }\n}\n\nexport function closeMessageNotifications(payload: { chatId: string; lastReadInboxMessageId?: number }) {\n  if (IS_TEST || !navigator.serviceWorker?.controller) return;\n  navigator.serviceWorker.controller.postMessage({\n    type: 'closeMessageNotifications',\n    payload,\n  });\n}\n\n// Notify service worker that client is fully loaded\nexport function notifyClientReady() {\n  if (!navigator.serviceWorker?.controller) return;\n  navigator.serviceWorker.controller.postMessage({\n    type: 'clientReady',\n  });\n}\n","import { useRef, useUnmountCleanup } from '../lib/teact/teact';\n\nimport { cleanupEffect, isSignal } from '../util/signals';\n\nexport function useSignalEffect(effect: NoneToVoidFunction, dependencies: readonly any[]) {\n  // The is extracted from `useEffectOnce` to run before all effects\n  const isFirstRun = useRef(true);\n  if (isFirstRun.current) {\n    isFirstRun.current = false;\n\n    dependencies?.forEach((dependency) => {\n      if (isSignal(dependency)) {\n        dependency.subscribe(effect);\n      }\n    });\n  }\n\n  useUnmountCleanup(() => {\n    cleanupEffect(effect);\n  });\n}\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useEffect, useRef, useState } from '../lib/teact/teact';\n\nimport type { Scheduler } from '../util/schedulers';\n\nimport { type CallbackManager, createCallbackManager } from '../util/callbacks';\nimport {\n  debounce, throttle, throttleWith,\n} from '../util/schedulers';\nimport useHeavyAnimation from './useHeavyAnimation';\nimport useLastCallback from './useLastCallback';\n\ntype TargetCallback = (entry: IntersectionObserverEntry) => void;\ntype RootCallback = (entries: IntersectionObserverEntry[]) => void;\ntype ObserveCleanup = NoneToVoidFunction;\nexport type ObserveFn = (target: HTMLElement, targetCallback?: TargetCallback) => ObserveCleanup;\n\ninterface IntersectionController {\n  observer: IntersectionObserver;\n  addCallback: (element: HTMLElement, callback: TargetCallback) => void;\n  removeCallback: (element: HTMLElement, callback: TargetCallback) => void;\n  destroy: NoneToVoidFunction;\n}\n\ninterface Response {\n  observe: ObserveFn;\n  freeze: NoneToVoidFunction;\n  unfreeze: NoneToVoidFunction;\n}\n\nexport function useIntersectionObserver({\n  rootRef,\n  throttleMs,\n  throttleScheduler,\n  debounceMs,\n  shouldSkipFirst,\n  margin,\n  threshold,\n  isDisabled,\n}: {\n  rootRef: ElementRef<HTMLDivElement>;\n  throttleMs?: number;\n  throttleScheduler?: Scheduler;\n  debounceMs?: number;\n  shouldSkipFirst?: boolean;\n  margin?: number;\n  threshold?: number | number[];\n  isDisabled?: boolean;\n}, rootCallback?: RootCallback): Response {\n  const controllerRef = useRef<IntersectionController>();\n  const rootCallbackRef = useRef<RootCallback>();\n  const freezeFlagsRef = useRef(0);\n  const onUnfreezeRef = useRef<NoneToVoidFunction>();\n\n  rootCallbackRef.current = rootCallback;\n\n  const freeze = useLastCallback(() => {\n    freezeFlagsRef.current++;\n  });\n\n  const unfreeze = useLastCallback(() => {\n    if (!freezeFlagsRef.current) {\n      return;\n    }\n\n    freezeFlagsRef.current--;\n\n    if (!freezeFlagsRef.current && onUnfreezeRef.current) {\n      onUnfreezeRef.current();\n      onUnfreezeRef.current = undefined;\n    }\n  });\n\n  useHeavyAnimation(freeze, unfreeze);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    return () => {\n      if (controllerRef.current) {\n        controllerRef.current.observer.disconnect();\n        controllerRef.current.destroy();\n        controllerRef.current = undefined;\n      }\n    };\n  }, [isDisabled]);\n\n  function initController() {\n    const callbacks = new Map<HTMLElement, CallbackManager<TargetCallback>>();\n    const entriesAccumulator = new Map<Element, IntersectionObserverEntry>();\n\n    let observerCallback: typeof observerCallbackSync;\n    if (typeof throttleScheduler === 'function') {\n      observerCallback = throttleWith(throttleScheduler, observerCallbackSync);\n    } else if (throttleMs) {\n      observerCallback = throttle(observerCallbackSync, throttleMs, !shouldSkipFirst);\n    } else if (debounceMs) {\n      observerCallback = debounce(observerCallbackSync, debounceMs, !shouldSkipFirst);\n    } else {\n      observerCallback = observerCallbackSync;\n    }\n\n    function observerCallbackSync() {\n      if (freezeFlagsRef.current) {\n        onUnfreezeRef.current = observerCallback;\n        return;\n      }\n\n      const entries = Array.from(entriesAccumulator.values());\n\n      entries.forEach((entry: IntersectionObserverEntry) => {\n        const callbackManager = callbacks.get(entry.target as HTMLElement);\n        callbackManager?.runCallbacks(entry);\n      });\n\n      if (rootCallbackRef.current) {\n        rootCallbackRef.current(entries);\n      }\n\n      entriesAccumulator.clear();\n    }\n\n    function addCallback(element: HTMLElement, callback: TargetCallback) {\n      if (!callbacks.get(element)) {\n        callbacks.set(element, createCallbackManager<TargetCallback>());\n      }\n\n      const callbackManager = callbacks.get(element)!;\n      callbackManager.addCallback(callback);\n    }\n\n    function removeCallback(element: HTMLElement, callback: TargetCallback) {\n      const callbackManager = callbacks.get(element);\n      if (!callbackManager) return;\n      callbackManager.removeCallback(callback);\n\n      if (!callbackManager.hasCallbacks()) {\n        callbacks.delete(element);\n      }\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          entriesAccumulator.set(entry.target, entry);\n        });\n\n        if (freezeFlagsRef.current) {\n          onUnfreezeRef.current = observerCallback;\n        } else {\n          observerCallback();\n        }\n      },\n      {\n        root: rootRef.current,\n        rootMargin: margin ? `${margin}px` : undefined,\n        threshold,\n      },\n    );\n\n    function destroy() {\n      callbacks.clear();\n      observer.disconnect();\n      entriesAccumulator.clear();\n    }\n\n    controllerRef.current = {\n      observer,\n      addCallback,\n      removeCallback,\n      destroy,\n    };\n  }\n\n  const observe = useLastCallback((target, targetCallback) => {\n    if (!controllerRef.current) {\n      initController();\n    }\n\n    const controller = controllerRef.current!;\n    controller.observer.observe(target);\n\n    if (targetCallback) {\n      controller.addCallback(target, targetCallback);\n    }\n\n    return () => {\n      if (targetCallback) {\n        controller.removeCallback(target, targetCallback);\n      }\n\n      controller.observer.unobserve(target);\n    };\n  });\n\n  return { observe, freeze, unfreeze };\n}\n\nexport function useOnIntersect(\n  targetRef: ElementRef<HTMLDivElement>, observe?: ObserveFn, callback?: TargetCallback,\n) {\n  const lastCallback = useLastCallback(callback);\n\n  useEffect(() => {\n    return observe ? observe(targetRef.current!, lastCallback) : undefined;\n  }, [lastCallback, observe, targetRef]);\n}\n\nexport function useIsIntersecting(\n  targetRef: ElementRef<HTMLDivElement>, observe?: ObserveFn, callback?: TargetCallback,\n) {\n  const [isIntersecting, setIsIntersecting] = useState(!observe);\n\n  useOnIntersect(targetRef, observe, (entry) => {\n    setIsIntersecting(entry.isIntersecting);\n\n    if (callback) {\n      callback(entry);\n    }\n  });\n\n  return isIntersecting;\n}\n","export default function arePropsShallowEqual(currentProps: AnyLiteral, newProps: AnyLiteral) {\n  if (currentProps === newProps) {\n    return true;\n  }\n\n  const currentKeys = Object.keys(currentProps);\n  const currentKeysLength = currentKeys.length;\n  const newKeysLength = Object.keys(newProps).length;\n\n  if (currentKeysLength !== newKeysLength) {\n    return false;\n  }\n\n  if (currentKeysLength === 0) {\n    return true;\n  }\n\n  for (let i = 0; i < currentKeysLength; i++) {\n    const prop = currentKeys[i];\n    if (currentProps[prop] !== newProps[prop]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function logUnequalProps(currentProps: AnyLiteral, newProps: AnyLiteral, msg: string, debugKey = '') {\n  const currentKeys = Object.keys(currentProps);\n  const currentKeysLength = currentKeys.length;\n  const newKeysLength = Object.keys(newProps).length;\n\n  if (currentKeysLength !== newKeysLength) {\n    // eslint-disable-next-line no-console\n    console.log(`${msg} LENGTH`);\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.log(msg);\n  currentKeys.forEach((prop) => {\n    if (currentProps[prop] !== newProps[prop]) {\n      // eslint-disable-next-line no-console\n      console.log(debugKey, prop, ':', currentProps[prop], '=>', newProps[prop]);\n    }\n  });\n}\n","import type { VirtualElement } from '../../lib/teact/teact';\nimport TeactDOM from '../../lib/teact/teact-dom';\n\nexport default function jsxToHtml(jsx: VirtualElement) {\n  const fragment = document.createElement('div');\n  TeactDOM.render(jsx, fragment);\n\n  const children = Array.from(fragment.children);\n  TeactDOM.render(undefined, fragment);\n\n  return children;\n}\n","import { DEBUG } from '../config';\n\nexport function toJSNumber(value: undefined): undefined;\nexport function toJSNumber(value: bigint): number;\nexport function toJSNumber(value?: bigint): number | undefined;\nexport function toJSNumber(value?: bigint): number | undefined {\n  if (value === undefined) return undefined;\n\n  if (DEBUG && (value < Number.MIN_SAFE_INTEGER || value > Number.MAX_SAFE_INTEGER)) {\n    // eslint-disable-next-line no-console\n    console.error('Unsafe BigInt conversion', value);\n  }\n\n  return Number(value);\n}\n\nexport function tryParseBigInt(value: string): bigint | undefined {\n  try {\n    return BigInt(value);\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error('Error parsing BigInt', value, error);\n    }\n    return undefined;\n  }\n}\n","import { onIdle, throttleWith } from '../../util/schedulers';\nimport { createSignal } from '../../util/signals';\nimport { requestMeasure } from '../fasterdom/fasterdom';\n\nconst AUTO_END_TIMEOUT = 1000;\n\nlet counter = 0;\nlet counterBlocking = 0;\n\nconst [getIsAnimating, setIsAnimating] = createSignal(false);\nconst [getIsBlockingAnimating, setIsBlockingAnimating] = createSignal(false);\n\nexport const getIsHeavyAnimating = getIsAnimating;\nexport { getIsBlockingAnimating };\n\nexport function beginHeavyAnimation(duration = AUTO_END_TIMEOUT, isBlocking = false) {\n  counter++;\n\n  if (counter === 1) {\n    setIsAnimating(true);\n  }\n\n  if (isBlocking) {\n    counterBlocking++;\n\n    if (counterBlocking === 1) {\n      setIsBlockingAnimating(true);\n    }\n  }\n\n  const timeout = window.setTimeout(onEnd, duration);\n\n  let hasEnded = false;\n\n  function onEnd() {\n    if (hasEnded) return;\n    hasEnded = true;\n\n    clearTimeout(timeout);\n\n    counter--;\n\n    if (counter === 0) {\n      setIsAnimating(false);\n    }\n\n    if (isBlocking) {\n      counterBlocking--;\n\n      if (counterBlocking === 0) {\n        setIsBlockingAnimating(false);\n      }\n    }\n  }\n\n  return onEnd;\n}\n\nexport function onFullyIdle(cb: NoneToVoidFunction) {\n  onIdle(() => {\n    if (getIsAnimating()) {\n      requestMeasure(() => {\n        onFullyIdle(cb);\n      });\n    } else {\n      cb();\n    }\n  });\n}\n\nexport function throttleWithFullyIdle<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onFullyIdle, fn);\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"qEhgJEpm\",\"middle\":\"GjxPnwZR\",\"big\":\"HRLrnZvQ\",\"adaptive\":\"ebO2WJkv\",\"svg\":\"lbK6aMGA\",\"clickable\":\"hqg1cKl7\"};","import type { FC } from '../../../lib/teact/teact';\nimport { memo } from '../../../lib/teact/teact';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport useUniqueId from '../../../hooks/useUniqueId';\n\nimport styles from './StarIcon.module.scss';\n\ntype OwnProps = {\n  type?: 'gold' | 'premium' | 'regular';\n  size?: 'small' | 'middle' | 'big' | 'adaptive';\n  className?: string;\n  style?: string;\n  onClick?: VoidFunction;\n};\n\n/* eslint-disable @stylistic/max-len */\nconst STAR_PATH = 'M6.63869 12.1902L3.50621 14.1092C3.18049 14.3087 2.75468 14.2064 2.55515 13.8807C2.45769 13.7216 2.42864 13.5299 2.47457 13.3491L2.95948 11.4405C3.13452 10.7515 3.60599 10.1756 4.24682 9.86791L7.6642 8.22716C7.82352 8.15067 7.89067 7.95951 7.81418 7.80019C7.75223 7.67116 7.61214 7.59896 7.47111 7.62338L3.66713 8.28194C2.89387 8.41581 2.1009 8.20228 1.49941 7.69823L0.297703 6.69116C0.00493565 6.44581 -0.0335059 6.00958 0.211842 5.71682C0.33117 5.57442 0.502766 5.48602 0.687982 5.47153L4.35956 5.18419C4.61895 5.16389 4.845 4.99974 4.94458 4.75937L6.36101 1.3402C6.5072 0.987302 6.91179 0.819734 7.26469 0.965925C7.43413 1.03612 7.56876 1.17075 7.63896 1.3402L9.05539 4.75937C9.15496 4.99974 9.38101 5.16389 9.6404 5.18419L13.3322 5.47311C13.713 5.50291 13.9975 5.83578 13.9677 6.2166C13.9534 6.39979 13.8667 6.56975 13.7269 6.68896L10.9114 9.08928C10.7131 9.25826 10.6267 9.52425 10.6876 9.77748L11.5532 13.3733C11.6426 13.7447 11.414 14.1182 11.0427 14.2076C10.8642 14.2506 10.676 14.2208 10.5195 14.1249L7.36128 12.1902C7.13956 12.0544 6.8604 12.0544 6.63869 12.1902Z';\n/* eslint-enable @stylistic/max-len */\n\nconst StarIcon: FC<OwnProps> = ({\n  type = 'regular',\n  size = 'small',\n  className,\n  style,\n  onClick,\n}) => {\n  const randomId = useUniqueId();\n  const validSvgRandomId = `svg-${randomId}`; // ID must start with a letter\n\n  const renderIcon = () => {\n    switch (type) {\n      case 'gold':\n        return <GoldStarIcon randomId={validSvgRandomId} />;\n      case 'premium':\n        return <PremiumStarIcon randomId={validSvgRandomId} />;\n      default:\n        return <RegularStarIcon />;\n    }\n  };\n\n  return (\n    <i\n      onClick={onClick}\n      className={buildClassName(\n        'StarIcon',\n        styles.root,\n        className,\n        onClick && styles.clickable,\n        styles[size],\n      )}\n      style={style}\n    >\n      {renderIcon()}\n    </i>\n  );\n};\n\nfunction GoldStarIcon({ randomId }: { randomId: string }) {\n  const mask1Id = `${randomId}-mask1`;\n  const mask2Id = `${randomId}-mask2`;\n  const gradient1Id = `${randomId}-gradient1`;\n  const gradient2Id = `${randomId}-gradient2`;\n  const gradient3Id = `${randomId}-gradient3`;\n\n  return (\n    <svg className={styles.svg} width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\">\n      <g clip-path=\"url(#clip0_4913_7387)\">\n        <mask id={mask1Id} style=\"mask-type:luminance\" maskUnits=\"userSpaceOnUse\" x=\"-2\" y=\"-2\" width=\"24\" height=\"24\">\n          <path d=\"M21.416 -1.42493H-1.08398V21.0751H21.416V-1.42493Z\" fill=\"white\" />\n        </mask>\n        <g mask={`url(#${mask1Id})`}>\n          <mask\n            id={mask2Id}\n            style=\"mask-type:luminance\"\n            maskUnits=\"userSpaceOnUse\"\n            x=\"-2\"\n            y=\"-2\"\n            width=\"24\"\n            height=\"24\"\n          >\n            <path d=\"M-1.08398 -1.42493H21.416V21.0751H-1.08398V-1.42493Z\" fill=\"white\" />\n          </mask>\n          <g mask={`url(#${mask2Id})`}>\n            <path d=\"M7.26843 6.25162L9.28943 2.22541C9.52311 1.76121 10.0884 1.5749 10.5494 1.80857C10.7294 1.90015 10.8747 2.04857 10.9662 2.23172L12.8767 6.11583C13.0314 6.43477 13.3378 6.64951 13.6883 6.69056L17.6829 7.17055C18.2261 7.23686 18.6145 7.73264 18.5513 8.27894C18.5229 8.50314 18.4218 8.71156 18.2608 8.86945L15.0998 11.9862C14.9703 12.1125 14.9103 12.2894 14.9324 12.4694L15.4598 16.6756C15.5356 17.2787 15.1093 17.8282 14.5093 17.904C14.2819 17.9324 14.0546 17.8913 13.8525 17.7808L10.5147 15.9556C10.2715 15.823 9.98099 15.8198 9.73784 15.9461L6.27687 17.7208C5.79057 17.9703 5.1969 17.7745 4.94743 17.285C4.8527 17.1019 4.82112 16.8966 4.84954 16.6945L5.12427 14.7619C5.26006 13.8177 5.84425 12.9967 6.69055 12.5641L10.5305 10.6031C10.6315 10.5526 10.6726 10.4263 10.622 10.322C10.581 10.2431 10.4957 10.1957 10.4073 10.2084L5.70847 10.8841C4.99164 10.9852 4.26535 10.7831 3.7001 10.322L2.13698 9.04629C1.69173 8.68314 1.6191 8.02 1.98225 7.57159C2.15277 7.36317 2.39592 7.22739 2.66118 7.19265L6.6716 6.67793C6.92739 6.64319 7.15159 6.4853 7.26843 6.25162Z\" fill={`url(#${gradient1Id})`} />\n            <path d=\"M10.8242 2.9422C10.4168 2.85062 9.98417 3.0464 9.78839 3.43797L7.76423 7.46419C7.64739 7.69787 7.42634 7.85576 7.1674 7.89049L3.15698 8.40837C2.89804 8.44311 2.6612 8.56942 2.49384 8.76837L3.97801 9.98097C4.44537 10.3631 5.05167 10.5304 5.64849 10.4452L10.3442 9.77255C10.6221 9.73466 10.8936 9.8736 11.0168 10.1231C11.1778 10.442 11.0515 10.8336 10.7326 10.9978L9.50734 11.623L10.9031 11.4209C10.9915 11.4083 11.0799 11.4557 11.1178 11.5346C11.1715 11.6388 11.1273 11.7651 11.0263 11.8157L7.18635 13.7767C6.34006 14.2093 5.75586 15.0303 5.62007 15.9745L5.44008 17.2282C5.60428 17.3924 5.86322 17.4366 6.07796 17.326L9.53261 15.5514C9.90839 15.3587 10.3536 15.365 10.7231 15.5671L14.0609 17.3924C14.1809 17.4587 14.3199 17.4839 14.4556 17.4682C14.8093 17.4239 15.0651 17.0955 15.0209 16.7324L14.4967 12.523C14.4588 12.2072 14.5662 11.8946 14.7904 11.6736L17.9513 8.55679C18.005 8.50311 18.0461 8.43995 18.0745 8.37048L14.1841 7.90312C13.8336 7.86207 13.5304 7.64418 13.3725 7.3284L13.2209 7.01578C12.902 6.87683 12.6399 6.63052 12.482 6.31159L10.8242 2.9422Z\" fill={`url(#${gradient2Id})`} />\n            <path d=\"M10.7484 1.41397C10.0663 1.06977 9.23893 1.3445 8.89789 2.02659L6.87373 6.05596C6.8232 6.15701 6.72531 6.22649 6.61478 6.23912L2.60436 6.757C2.22542 6.80437 1.87806 7.00015 1.63807 7.29699C1.12334 7.93486 1.22124 8.86958 1.85596 9.38746L3.42223 10.6664C4.08222 11.2032 4.93167 11.44 5.77165 11.32L9.09051 10.8432L6.48847 12.1727C5.51271 12.6716 4.84325 13.6126 4.68852 14.6989L4.41063 16.6315C4.36958 16.9252 4.41695 17.222 4.55273 17.4873C4.90956 18.1915 5.77481 18.4725 6.479 18.1125L9.93681 16.3378C10.0505 16.2778 10.1863 16.281 10.3 16.3441L13.6378 18.1662C13.9188 18.3209 14.2441 18.3841 14.563 18.343C15.4061 18.2357 15.9998 17.462 15.8956 16.622L15.3714 12.4126C15.3651 12.3716 15.3809 12.3274 15.4093 12.299L18.5703 9.1822C18.8008 8.95168 18.9492 8.65169 18.9871 8.32959C19.0787 7.5433 18.5229 6.82963 17.7366 6.73489L13.7388 6.25491C13.5399 6.2328 13.363 6.10649 13.2715 5.92334L11.3641 2.03606C11.2315 1.76765 11.0136 1.54976 10.7484 1.41397ZM9.68418 2.42132C9.80734 2.17501 10.1073 2.07712 10.3505 2.20027C10.4452 2.24764 10.5242 2.32974 10.5715 2.42763L12.482 6.31175C12.7031 6.76332 13.1357 7.06962 13.6346 7.12962L17.6324 7.60961C17.9324 7.64435 18.1471 7.91908 18.1124 8.22538C18.0966 8.3517 18.0398 8.46854 17.9513 8.55695L14.7904 11.6737C14.5662 11.8948 14.4588 12.2074 14.4967 12.5232L15.0209 16.7325C15.0651 17.0957 14.8093 17.4241 14.4556 17.4683C14.3199 17.4841 14.1809 17.4588 14.0609 17.3925L10.7231 15.5673C10.3536 15.3652 9.90839 15.362 9.53261 15.5547L6.0748 17.3294C5.80638 17.4652 5.47797 17.3578 5.33903 17.0862C5.2885 16.9852 5.26956 16.8683 5.28534 16.7546L5.56007 14.8252C5.67376 14.0231 6.17269 13.3253 6.88952 12.959L10.7294 10.9979C11.0515 10.8337 11.1778 10.4422 11.0168 10.1232C10.8905 9.87376 10.6221 9.73482 10.3442 9.77271L5.64534 10.4453C5.04851 10.5306 4.44537 10.3632 3.97801 9.98113L2.41489 8.70221C2.15595 8.49064 2.1149 8.10854 2.32647 7.8496C2.42436 7.72961 2.56331 7.65066 2.71488 7.63171L6.72531 7.11383C7.12951 7.06331 7.48003 6.81384 7.66318 6.45069L9.68418 2.42132Z\" fill={`url(#${gradient3Id})`} />\n          </g>\n        </g>\n      </g>\n      <defs>\n        <linearGradient\n          id={gradient1Id}\n          x1=\"10.1547\"\n          y1=\"1.70752\"\n          x2=\"10.1547\"\n          y2=\"17.9134\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#FFF0C2\" />\n          <stop offset=\"1\" stop-color=\"#FFEBBA\" />\n        </linearGradient>\n        <linearGradient\n          id={gradient2Id}\n          x1=\"10.2842\"\n          y1=\"2.92009\"\n          x2=\"14.7304\"\n          y2=\"17.4713\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#FFD147\" />\n          <stop offset=\"1\" stop-color=\"#FFB526\" />\n        </linearGradient>\n        <linearGradient\n          id={gradient3Id}\n          x1=\"10.1547\"\n          y1=\"1.26556\"\n          x2=\"14.0546\"\n          y2=\"18.3525\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop stop-color=\"#E58F0D\" />\n          <stop offset=\"1\" stop-color=\"#EB7814\" />\n        </linearGradient>\n        <clipPath id=\"clip0_4913_7387\">\n          <rect width=\"20\" height=\"20\" fill=\"white\" />\n        </clipPath>\n      </defs>\n    </svg>\n  );\n}\n\nfunction PremiumStarIcon({ randomId }: { randomId: string }) {\n  return (\n    <svg className={styles.svg} width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\">\n      <defs>\n        <linearGradient id={randomId} x1=\"3\" y1=\"63.5001\" x2=\"84.1475\" y2=\"-1.32262\" gradientUnits=\"userSpaceOnUse\">\n          <stop stop-color=\"#6B93FF\" />\n          <stop offset=\"0.439058\" stop-color=\"#976FFF\" />\n          <stop offset=\"1\" stop-color=\"#E46ACE\" />\n        </linearGradient>\n      </defs>\n      <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d={STAR_PATH} fill={`url(#${randomId})`} />\n    </svg>\n  );\n}\n\nfunction RegularStarIcon() {\n  return (\n    <svg className={styles.svg} width=\"14\" height=\"15\" viewBox=\"0 0 14 15\" fill=\"none\">\n      <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d={STAR_PATH} fill=\"var(--color-fill)\" />\n    </svg>\n  );\n}\n\nexport default memo(StarIcon);\n","export default class Deferred<T = void> {\n  promise: Promise<T>;\n\n  reject!: (reason?: any) => void;\n\n  resolve!: (value: T | PromiseLike<T>) => void;\n\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.reject = reject;\n      this.resolve = resolve;\n    });\n  }\n\n  static resolved(): Deferred<void>;\n  static resolved<T>(value: T): Deferred<T>;\n  static resolved<T>(value?: T): Deferred<T | void> {\n    const deferred = new Deferred<T | void>();\n    deferred.resolve(value);\n    return deferred;\n  }\n}\n","import { CHANNEL_ID_BASE } from '../../config';\nimport { toJSNumber } from '../numbers';\n\nexport function isUserId(entityId: string) {\n  return !entityId.startsWith('-');\n}\n\nexport function isChannelId(entityId: string) {\n  const n = BigInt(entityId);\n  return n < -CHANNEL_ID_BASE;\n}\n\nexport function toChannelId(mtpId: string) {\n  const n = BigInt(mtpId);\n  return String(-CHANNEL_ID_BASE - n);\n}\n\nexport function getRawPeerId(id: string) {\n  const n = BigInt(id);\n  if (isUserId(id)) {\n    return n;\n  }\n\n  if (isChannelId(id)) {\n    return -n - CHANNEL_ID_BASE;\n  }\n\n  return n * -1n;\n}\n\nexport function getPeerIdDividend(peerId: string) {\n  return toJSNumber(getRawPeerId(peerId));\n}\n","import { DEBUG } from '../../config';\n\ntype Handler = (e: Event) => void;\ntype DelegationRegistry = Map<Element, Handler>;\n\nconst NON_BUBBLEABLE_EVENTS = new Set(['scroll', 'mouseenter', 'mouseleave', 'load', 'error']);\n\nconst documentEventCounters: Record<string, number> = {};\nconst delegationRegistryByEventType: Record<string, DelegationRegistry> = {};\nconst delegatedEventTypesByElement = new Map<Element, Set<string>>();\n\nexport function addEventListener(element: Element, propName: string, handler: Handler, asCapture = false) {\n  const eventType = resolveEventType(propName, element);\n  if (canUseEventDelegation(eventType, element, asCapture)) {\n    addDelegatedListener(eventType, element, handler);\n  } else {\n    element.addEventListener(eventType, handler, asCapture);\n  }\n}\n\nexport function removeEventListener(element: Element, propName: string, handler: Handler, asCapture = false) {\n  const eventType = resolveEventType(propName, element);\n  if (canUseEventDelegation(eventType, element, asCapture)) {\n    removeDelegatedListener(eventType, element);\n  } else {\n    element.removeEventListener(eventType, handler, asCapture);\n  }\n}\n\nexport function resolveEventType(propName: string, element: Element) {\n  const eventType = propName\n    .replace(/^on/, '')\n    .replace(/Capture$/, '').toLowerCase();\n\n  if (eventType === 'change' && element.tagName !== 'SELECT') {\n    // React behavior repeated here.\n    // https://stackoverflow.com/questions/38256332/in-react-whats-the-difference-between-onchange-and-oninput\n    return 'input';\n  }\n\n  if (eventType === 'doubleclick') {\n    return 'dblclick';\n  }\n\n  // Replace focus/blur by their \"bubbleable\" versions\n  if (eventType === 'focus') {\n    return 'focusin';\n  }\n\n  if (eventType === 'blur') {\n    return 'focusout';\n  }\n\n  return eventType;\n}\n\nfunction canUseEventDelegation(realEventType: string, element: Element, asCapture: boolean) {\n  return (\n    !asCapture\n    && !NON_BUBBLEABLE_EVENTS.has(realEventType)\n    && element.tagName !== 'VIDEO'\n    && element.tagName !== 'IFRAME'\n  );\n}\n\nfunction addDelegatedListener(eventType: string, element: Element, handler: Handler) {\n  if (!documentEventCounters[eventType]) {\n    documentEventCounters[eventType] = 0;\n    document.addEventListener(eventType, handleEvent);\n  }\n\n  resolveDelegationRegistry(eventType).set(element, handler);\n  resolveDelegatedEventTypes(element).add(eventType);\n  documentEventCounters[eventType]++;\n}\n\nfunction removeDelegatedListener(eventType: string, element: Element) {\n  documentEventCounters[eventType]--;\n  if (!documentEventCounters[eventType]) {\n    // Synchronous deletion on 0 will cause perf degradation in the case of 1 element\n    // which is not a real case, so it's ok to do it this way\n    document.removeEventListener(eventType, handleEvent);\n  }\n\n  delegationRegistryByEventType[eventType].delete(element);\n  delegatedEventTypesByElement.get(element)!.delete(eventType);\n}\n\nexport function removeAllDelegatedListeners(element: Element) {\n  const eventTypes = delegatedEventTypesByElement.get(element);\n  if (!eventTypes) {\n    return;\n  }\n\n  eventTypes.forEach((eventType) => removeDelegatedListener(eventType, element));\n  delegatedEventTypesByElement.delete(element);\n}\n\nfunction handleEvent(realEvent: Event) {\n  const events = delegationRegistryByEventType[realEvent.type];\n\n  if (events) {\n    let furtherCallsPrevented = false;\n    let current: Element = realEvent.target as Element;\n\n    const stopPropagation = () => {\n      furtherCallsPrevented = true;\n    };\n\n    const preventDefault = () => {\n      realEvent.preventDefault();\n    };\n\n    // Proxy is a simplest way to provide an access to the event property\n    const event = new Proxy(realEvent, {\n      get(target, p) {\n        if (p === 'currentTarget') {\n          return current;\n        }\n        if (p === 'stopPropagation' || p === 'stopImmediatePropagation') {\n          return stopPropagation;\n        }\n        if (p === 'preventDefault') {\n          // \"this\" is changed to proxy and one can't call methods via it\n          return preventDefault;\n        }\n        return Reflect.get(target, p);\n      },\n    });\n\n    // This can also be limited by teact root\n    while (current && current !== document.body) {\n      const handler = events.get(current);\n      if (handler) {\n        handler(event);\n        if (furtherCallsPrevented) {\n          return;\n        }\n      }\n\n      current = current.parentNode as Element;\n    }\n  }\n}\n\nfunction resolveDelegationRegistry(eventType: string) {\n  if (!delegationRegistryByEventType[eventType]) {\n    delegationRegistryByEventType[eventType] = new Map();\n  }\n\n  return delegationRegistryByEventType[eventType];\n}\n\nfunction resolveDelegatedEventTypes(element: Element) {\n  const existing = delegatedEventTypesByElement.get(element);\n  if (existing) {\n    return existing;\n  }\n\n  const newSet = new Set<string>();\n  delegatedEventTypesByElement.set(element, newSet);\n\n  return newSet;\n}\n\nif (DEBUG) {\n  document.addEventListener('dblclick', () => {\n    const documentListenersCount = Object.keys(documentEventCounters).length;\n    const delegatedHandlersCount1 = Object.values(documentEventCounters)\n      .reduce((acc, counter) => acc + counter, 0);\n    const delegationRegistriesCount = Object.keys(delegationRegistryByEventType).length;\n    const delegatedHandlersCount2 = Object.values(delegationRegistryByEventType)\n      .reduce((acc, delegationRegistry) => acc + delegationRegistry.size, 0);\n    const delegationElementsCount = delegatedEventTypesByElement.size;\n    const delegatedEventTypesCount = Array.from(delegatedEventTypesByElement.values())\n      .reduce((acc, eventTypes) => acc + eventTypes.size, 0);\n\n    // eslint-disable-next-line no-console\n    console.warn('DELEGATED EVENTS STATS', {\n      delegatedHandlersCount1,\n      delegatedHandlersCount2,\n      delegatedEventTypesCount,\n      delegationRegistriesCount,\n      delegationElementsCount,\n      documentListenersCount,\n    });\n  });\n}\n","import { SVG_EXTENSIONS } from '../../config';\n\nconst UNSAFE_MIME_TYPES = new Set(['text/html', 'image/svg+xml']);\nconst UNSAFE_EXTENSIONS = new Set([\n  ...SVG_EXTENSIONS,\n  'htm', 'html', 'svg', 'm4v', 'm3u', 'm3u8', 'xhtml', 'xml',\n]);\n\nexport function isIpRevealingMedia({ mimeType, extension }: { mimeType?: string; extension: string }) {\n  if (mimeType && UNSAFE_MIME_TYPES.has(mimeType)) {\n    return true;\n  }\n\n  if (UNSAFE_EXTENSIONS.has(extension)) {\n    return true;\n  }\n\n  return false;\n}\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useEffect, useState } from '../lib/teact/teact';\n\nimport { requestMeasure, requestMutation } from '../lib/fasterdom/fasterdom';\nimport useLastCallback from './useLastCallback';\n\nconst useKeyboardListNavigation = (\n  elementRef: ElementRef<HTMLElement>,\n  isOpen: boolean,\n  onSelectWithEnter?: (index: number) => void,\n  itemSelector?: string,\n  noCaptureFocus?: boolean,\n) => {\n  const [focusedIndex, setFocusedIndex] = useState(-1);\n\n  useEffect(() => {\n    setFocusedIndex(-1);\n\n    const element = elementRef.current;\n    if (isOpen && element && !noCaptureFocus) {\n      requestMutation(() => {\n        element.tabIndex = -1;\n      });\n      requestMeasure(() => element.focus());\n    }\n  }, [elementRef, isOpen, noCaptureFocus]);\n\n  return useLastCallback((e: React.KeyboardEvent<any>) => {\n    const element = elementRef.current;\n\n    if (!element) {\n      return;\n    }\n\n    if (e.keyCode === 13 && onSelectWithEnter) {\n      onSelectWithEnter(focusedIndex);\n      return;\n    }\n\n    if (e.keyCode !== 38 && e.keyCode !== 40) {\n      return;\n    }\n\n    const focusedElement = document.activeElement;\n    const elementChildren = Array.from(itemSelector ? element.querySelectorAll(itemSelector) : element.children);\n\n    let newIndex = (focusedElement && elementChildren.indexOf(focusedElement)) || focusedIndex;\n\n    if (e.keyCode === 38 && newIndex > 0) {\n      newIndex--;\n    } else if (e.keyCode === 40 && newIndex < elementChildren.length - 1) {\n      newIndex++;\n    } else if (elementChildren.length === 1) {\n      newIndex = 0;\n    } else {\n      return;\n    }\n\n    const item = elementChildren[newIndex] as HTMLElement;\n    if (item) {\n      setFocusedIndex(newIndex);\n      item.focus();\n    }\n  });\n};\n\nexport default useKeyboardListNavigation;\n","export const MIN_USERNAME_LENGTH = 3; // Some bots have 3-letter usernames\nexport const MIN_UPDATE_USERNAME_LENGTH = 5; // 4 letter usernames are only available on Fragment\nexport const MAX_USERNAME_LENGTH = 32;\nexport const USERNAME_REGEX = /^[a-zA-Z]\\w+$/;\n\nexport function isUsernameValid(username: string, isUpdating?: boolean) {\n  const minUsernameLength = isUpdating ? MIN_UPDATE_USERNAME_LENGTH : MIN_USERNAME_LENGTH;\n  return username.length >= minUsernameLength\n    && username.length <= MAX_USERNAME_LENGTH\n    && USERNAME_REGEX.test(username);\n}\n","import { addCallback } from '../../../lib/teact/teactn';\n\nimport type { ActionReturnType, GlobalState } from '../../types';\nimport { type LangCode, LeftColumnContent, SettingsScreens } from '../../../types';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { IS_IOS } from '../../../util/browser/windowEnvironment';\nimport { disableDebugConsole, initDebugConsole } from '../../../util/debugConsole';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { oldSetLanguage, setTimeFormat } from '../../../util/oldLangProvider';\nimport { applyPerformanceSettings } from '../../../util/perfomanceSettings';\nimport switchTheme from '../../../util/switchTheme';\nimport { updatePeerColors } from '../../../util/theme';\nimport { callApi, setShouldEnableDebugLog } from '../../../api/gramjs';\nimport { addTabStateResetterAction } from '../../helpers/meta';\nimport {\n  addActionHandler, getActions, setGlobal,\n} from '../../index';\nimport { replaceSettings, updateSharedSettings, updateThemeSettings } from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectCanAnimateInterface, selectChatFolder, selectTabState } from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  const { updatePageTitle, updateShouldDebugExportedSenders, updateShouldEnableDebugLog } = getActions();\n\n  const oldGlobal = prevGlobal;\n  prevGlobal = global;\n\n  if (!oldGlobal) return;\n\n  const oldSharedSettings = selectSharedSettings(oldGlobal);\n  const sharedSettings = selectSharedSettings(global);\n\n  const performance = sharedSettings.performance;\n  const prevPerformance = oldSharedSettings.performance;\n  const peerColors = global.peerColors;\n  const prevPeerColors = oldGlobal.peerColors;\n\n  if (peerColors && peerColors !== prevPeerColors) {\n    updatePeerColors(peerColors.general);\n  }\n\n  if (performance !== prevPerformance) {\n    requestMutation(() => {\n      applyPerformanceSettings(performance);\n    });\n  }\n\n  if (sharedSettings.theme !== oldSharedSettings.theme) {\n    const withAnimation = document.hasFocus() ? selectCanAnimateInterface(global) : false;\n    switchTheme(sharedSettings.theme, withAnimation);\n  }\n\n  if (sharedSettings.language !== oldSharedSettings.language) {\n    oldSetLanguage(sharedSettings.language as LangCode);\n  }\n\n  if (sharedSettings.timeFormat !== oldSharedSettings.timeFormat) {\n    setTimeFormat(sharedSettings.timeFormat);\n  }\n\n  if (sharedSettings.messageTextSize !== oldSharedSettings.messageTextSize) {\n    document.documentElement.style.setProperty(\n      '--composer-text-size', `${Math.max(sharedSettings.messageTextSize, IS_IOS ? 16 : 15)}px`,\n    );\n    document.documentElement.style.setProperty('--message-meta-height',\n      `${Math.floor(sharedSettings.messageTextSize * 1.3125)}px`);\n    document.documentElement.style.setProperty('--message-text-size', `${sharedSettings.messageTextSize}px`);\n    document.documentElement.setAttribute('data-message-text-size', sharedSettings.messageTextSize.toString());\n  }\n\n  if (sharedSettings.canDisplayChatInTitle !== oldSharedSettings.canDisplayChatInTitle) {\n    updatePageTitle();\n  }\n\n  if (sharedSettings.shouldForceHttpTransport !== oldSharedSettings.shouldForceHttpTransport) {\n    callApi('setForceHttpTransport', Boolean(sharedSettings.shouldForceHttpTransport));\n  }\n\n  if (sharedSettings.shouldAllowHttpTransport !== oldSharedSettings.shouldAllowHttpTransport) {\n    callApi('setAllowHttpTransport', Boolean(sharedSettings.shouldAllowHttpTransport));\n    if (!sharedSettings.shouldAllowHttpTransport && sharedSettings.shouldForceHttpTransport) {\n      global = updateSharedSettings(global, {\n        shouldForceHttpTransport: false,\n      });\n      setGlobal(global);\n    }\n  }\n\n  if (sharedSettings.shouldDebugExportedSenders !== oldSharedSettings.shouldDebugExportedSenders) {\n    updateShouldDebugExportedSenders();\n  }\n\n  if (sharedSettings.shouldCollectDebugLogs !== oldSharedSettings.shouldCollectDebugLogs) {\n    updateShouldEnableDebugLog();\n  }\n});\n\naddActionHandler('updateShouldEnableDebugLog', (global): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n\n  if (settings.shouldCollectDebugLogs) {\n    setShouldEnableDebugLog(true);\n    initDebugConsole();\n  } else {\n    setShouldEnableDebugLog(false);\n    disableDebugConsole();\n  }\n});\n\naddActionHandler('updateShouldDebugExportedSenders', (global): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n  callApi('setShouldDebugExportedSenders', Boolean(settings.shouldDebugExportedSenders));\n});\n\naddActionHandler('setSettingOption', (global, actions, payload): ActionReturnType => {\n  return replaceSettings(global, payload);\n});\n\naddActionHandler('setSharedSettingOption', (global, actions, payload): ActionReturnType => {\n  return updateSharedSettings(global, payload);\n});\n\naddActionHandler('updatePerformanceSettings', (global, actions, payload): ActionReturnType => {\n  const settings = selectSharedSettings(global);\n  global = updateSharedSettings(global, {\n    performance: {\n      ...settings.performance,\n      ...payload,\n    },\n    wasAnimationLevelSetManually: true,\n  });\n\n  return global;\n});\n\naddActionHandler('setThemeSettings', (global, actions, payload): ActionReturnType => {\n  const { theme, ...settings } = payload;\n\n  return updateThemeSettings(global, theme, settings);\n});\n\naddActionHandler('requestNextFoldersAction', (global, actions, payload): ActionReturnType => {\n  const { foldersAction, tabId = getCurrentTabId() } = payload;\n  return updateTabState(global, {\n    nextFoldersAction: foldersAction,\n  }, tabId);\n});\n\naddActionHandler('openLeftColumnContent', (global, actions, payload): ActionReturnType => {\n  const { contentKey = LeftColumnContent.ChatList, tabId = getCurrentTabId() } = payload;\n  const tabState = selectTabState(global, tabId);\n  return updateTabState(global, {\n    leftColumn: {\n      ...tabState.leftColumn,\n      contentKey,\n    },\n  }, tabId);\n});\n\naddActionHandler('openSettingsScreen', (global, actions, payload): ActionReturnType => {\n  const { screen, tabId = getCurrentTabId() } = payload;\n  const tabState = selectTabState(global, tabId);\n\n  actions.loadPrivacySettings({ skipIfCached: true });\n  // Force settings only if new screen is passed, do not on resets\n  if (payload.screen !== undefined) actions.openLeftColumnContent({ contentKey: LeftColumnContent.Settings, tabId });\n  return updateTabState(global, {\n    leftColumn: {\n      ...tabState.leftColumn,\n      settingsScreen: screen || SettingsScreens.Main,\n    },\n  }, tabId);\n});\n\naddActionHandler('openEditChatFolder', (global, actions, payload): ActionReturnType => {\n  const { folderId, isOnlyInvites, tabId = getCurrentTabId() } = payload;\n\n  const chatFolder = selectChatFolder(global, folderId);\n  if (!chatFolder) return;\n\n  actions.openSettingsScreen({\n    screen: isOnlyInvites ? SettingsScreens.FoldersEditFolderInvites : SettingsScreens.FoldersEditFolderFromChatList,\n    tabId,\n  });\n  actions.requestNextFoldersAction({\n    foldersAction: {\n      type: 'editFolder',\n      payload: chatFolder,\n    },\n    tabId,\n  });\n});\n\naddActionHandler('openShareChatFolderModal', (global, actions, payload): ActionReturnType => {\n  const {\n    folderId, url, noRequestNextScreen, tabId = getCurrentTabId(),\n  } = payload;\n\n  const chatFolder = selectChatFolder(global, folderId);\n  const isChatList = chatFolder?.isChatList;\n  if (isChatList && !noRequestNextScreen) {\n    actions.openEditChatFolder({ folderId, isOnlyInvites: true, tabId });\n    return undefined;\n  }\n\n  if (!noRequestNextScreen) actions.openSettingsScreen({ screen: SettingsScreens.FoldersShare, tabId });\n\n  return updateTabState(global, {\n    shareFolderScreen: {\n      folderId,\n      isFromSettings: Boolean(noRequestNextScreen),\n      url,\n    },\n  }, tabId);\n});\n\naddActionHandler('closeShareChatFolderModal', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  actions.openSettingsScreen({ screen: undefined, tabId });\n\n  return updateTabState(global, {\n    shareFolderScreen: undefined,\n  }, tabId);\n});\n\naddActionHandler('openPasskeyModal', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  return updateTabState(global, {\n    isPasskeyModalOpen: true,\n  }, tabId);\n});\n\naddTabStateResetterAction('closePasskeyModal', 'isPasskeyModalOpen');\n","import type React from '../lib/teact/teact';\n\nimport { IS_TOUCH_ENV, MouseButton } from '../util/browser/windowEnvironment';\nimport useLastCallback from './useLastCallback';\n\ntype EventArg<E> = React.MouseEvent<E>;\ntype EventHandler<E> = (e: EventArg<E>) => void;\n\nexport function useFastClick<T extends HTMLDivElement | HTMLButtonElement>(callback?: EventHandler<T>) {\n  const handler = useLastCallback((e: EventArg<T>) => {\n    if (e.type === 'mousedown' && e.button !== MouseButton.Main) {\n      return;\n    }\n\n    callback!(e);\n  });\n\n  return IS_TOUCH_ENV\n    ? { handleClick: callback ? handler : undefined }\n    : { handleMouseDown: callback ? handler : undefined };\n}\n","import captureKeyboardListener from './captureKeyboardListeners';\n\ntype IHandlerFunction = () => void;\n\nexport default function captureEscKeyListener(handler: IHandlerFunction) {\n  return captureKeyboardListener({ onEsc: handler });\n}\n","import type { ApiAppConfig, ApiLimitType } from './api/types';\n\nimport { MULTIACCOUNT_MAX_SLOTS } from './config';\n\nexport const MAX_UNIQUE_REACTIONS = 11;\nexport const GROUP_CALL_PARTICIPANTS_LIMIT = 100;\nexport const STORY_LIST_LIMIT = 100;\nexport const API_GENERAL_ID_LIMIT = 100;\nexport const RESALE_GIFTS_LIMIT = 50;\nexport const PINNED_MESSAGES_LIMIT = 50;\nexport const BLOCKED_LIST_LIMIT = 100;\nexport const GLOBAL_SEARCH_CONTACTS_LIMIT = 20;\n\n// As in Telegram for Android\n// https://github.com/DrKLO/Telegram/blob/51e9947527/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L7799\nexport const TOP_REACTIONS_LIMIT = 100;\nexport const RECENT_REACTIONS_LIMIT = 50;\nexport const REACTION_LIST_LIMIT = 100;\n\nexport const DEFAULT_LIMITS: Record<ApiLimitType, readonly [number, number]> = {\n  uploadMaxFileparts: [4000, 8000],\n  stickersFaved: [5, 10],\n  savedGifs: [200, 400],\n  dialogFiltersChats: [100, 200],\n  dialogFilters: [10, 20],\n  dialogFolderPinned: [5, 10],\n  captionLength: [1024, 4096],\n  channels: [500, 1000],\n  channelsPublic: [10, 20],\n  aboutLength: [70, 140],\n  chatlistInvites: [3, 100],\n  chatlistJoined: [2, 20],\n  recommendedChannels: [10, 100],\n  savedDialogsPinned: [5, 100],\n  maxReactions: [1, 3],\n  moreAccounts: [3, MULTIACCOUNT_MAX_SLOTS],\n};\n\nexport const DEFAULT_MAX_MESSAGE_LENGTH = 4096;\nexport const DEFAULT_MAX_NOTE_LENGTH = 128;\n\nexport const DEFAULT_APP_CONFIG: ApiAppConfig = {\n  hash: 0,\n  limits: {\n    uploadMaxFileparts: DEFAULT_LIMITS.uploadMaxFileparts,\n    stickersFaved: DEFAULT_LIMITS.stickersFaved,\n    savedGifs: DEFAULT_LIMITS.savedGifs,\n    dialogFiltersChats: DEFAULT_LIMITS.dialogFiltersChats,\n    dialogFilters: DEFAULT_LIMITS.dialogFilters,\n    dialogFolderPinned: DEFAULT_LIMITS.dialogFolderPinned,\n    captionLength: DEFAULT_LIMITS.captionLength,\n    channels: DEFAULT_LIMITS.channels,\n    channelsPublic: DEFAULT_LIMITS.channelsPublic,\n    aboutLength: DEFAULT_LIMITS.aboutLength,\n    chatlistInvites: DEFAULT_LIMITS.chatlistInvites,\n    chatlistJoined: DEFAULT_LIMITS.chatlistJoined,\n    recommendedChannels: DEFAULT_LIMITS.recommendedChannels,\n    savedDialogsPinned: DEFAULT_LIMITS.savedDialogsPinned,\n    moreAccounts: DEFAULT_LIMITS.moreAccounts,\n    maxReactions: DEFAULT_LIMITS.maxReactions,\n  },\n  autologinDomains: [\n    'instantview.telegram.org',\n    'translations.telegram.org',\n    'contest.dev',\n    'contest.com',\n    'bugs.telegram.org',\n    'suggestions.telegram.org',\n    'themes.telegram.org',\n    'promote.telegram.org',\n    'ads.telegram.org',\n  ],\n  channelLevelMax: 100,\n  boostsPerSentGift: 3,\n  channelRestrictAdsLevelMin: 50,\n  seenByExpiresAt: 604800,\n  seenByMaxChatMembers: 100,\n  defaultEmojiStatusesStickerSetId: '773947703670341676',\n  emojiSounds: {},\n  giveawayAddPeersMax: 10,\n  giveawayBoostsPerPremium: 4,\n  giveawayCountriesMax: 10,\n  isGiveawayGiftsPurchaseAvailable: false,\n  groupTranscribeLevelMin: 6,\n  hiddenMembersMinCount: 100,\n  ignoreRestrictionReasons: [],\n  canLimitNewMessagesWithoutPremium: false,\n  readDateExpiresAt: 604800,\n  premiumBotUsername: 'PremiumBot',\n  premiumPromoOrder: [\n    'stories',\n    'more_upload',\n    'double_limits',\n    // 'business',\n    'last_seen',\n    'voice_to_text',\n    'faster_download',\n    'translations',\n    'animated_emoji',\n    'emoji_status',\n    'saved_tags',\n    // 'peer_colors',\n    // 'wallpapers',\n    'profile_badge',\n    'message_privacy',\n    'advanced_chat_management',\n    'no_ads',\n    // 'app_icons',\n    'infinite_reactions',\n    'animated_userpics',\n    'premium_stickers',\n    'effects',\n  ],\n  isPremiumPurchaseBlocked: false,\n  maxUniqueReactions: 11,\n  starGiftMaxConvertPeriod: 7776000,\n  starGiftMaxMessageLength: 255,\n  starRefStartPrefixes: [\n    '_tgr_',\n  ],\n  isStarsGiftEnabled: true,\n  paidReactionMaxAmount: 2500,\n  starsUsdWithdrawRateX1000: 1300,\n  storyChangelogUserId: '777000',\n  maxPinnedStoriesCount: 3,\n  starsSuggestedPostAmountMax: 100000,\n  starsSuggestedPostAmountMin: 5,\n  starsSuggestedPostAgeMin: 86400,\n  starsSuggestedPostFutureMin: 300,\n  starsSuggestedPostFutureMax: 2678400,\n  starsSuggestedPostCommissionPermille: 850,\n  tonSuggestedPostCommissionPermille: 850,\n  todoItemLengthMax: 64,\n  todoItemsMax: 30,\n  todoTitleLengthMax: 32,\n  tonSuggestedPostAmountMax: 10000000000000,\n  tonSuggestedPostAmountMin: 10000000,\n  tonTopupUrl: 'https://fragment.com/ads/topup',\n  storyViewersExpirePeriod: 86400,\n  topicsPinnedLimit: 5,\n  bandwidthPremiumDownloadSpeedup: 10,\n  bandwidthPremiumNotifyPeriod: 3600,\n  bandwidthPremiumUploadSpeedup: 10,\n  urlAuthDomains: [\n    'web.telegram.org',\n    'web.t.me',\n    'k.t.me',\n    'z.t.me',\n    'a.t.me',\n  ],\n  whitelistedDomains: [\n    'telegram.dog',\n    'telegram.me',\n    'telegram.org',\n    't.me',\n    'telesco.pe',\n    'fragment.com',\n    'translations.telegram.org',\n  ],\n  typingDraftTtl: 10,\n  arePasskeysAvailable: true,\n  passkeysMaxCount: 5,\n};\n","import type { ActionOptions } from '../lib/teact/teactn';\nimport { typify } from '../lib/teact/teactn';\n\nimport type {\n  ActionPayloads, GlobalState, RequiredActionPayloads, RequiredGlobalState,\n} from './types';\n\nconst typed = typify<GlobalState, ActionPayloads & RequiredActionPayloads>();\n\ntype ProjectActionTypes =\n  ActionPayloads\n  & RequiredActionPayloads;\n\ntype ProjectActionNames = keyof ProjectActionTypes;\n\ntype Helper<T, E> = Exclude<T, E> extends never ? unknown : Exclude<T, E>;\n\nexport type TabStateActionNames = {\n  [ActionName in ProjectActionNames]:\n  'tabId' extends keyof Helper<ProjectActionTypes[ActionName], undefined> ? ActionName : never\n}[ProjectActionNames];\n// `Required` actions are called from actions to ensure the `tabId` is always provided if needed.\n// There are three types of actions:\n// 1. With tabId, which is made required when calling action from another action handler\n// 2. Without payload (= undefined), hence made the payload not required\n// 3. With payload, hence made the payload required\nexport type RequiredGlobalActions = {\n  [ActionName in ProjectActionNames]: ActionName extends TabStateActionNames ? ((\n    payload: ProjectActionTypes[ActionName] & { tabId: number },\n    options?: ActionOptions,\n  ) => void) :\n    (undefined extends ProjectActionTypes[ActionName] ? (\n      (payload?: ProjectActionTypes[ActionName], options?: ActionOptions) => void\n    ) : (\n      (payload: ProjectActionTypes[ActionName], options?: ActionOptions) => void\n    ))\n} & { _: never };\n\ntype ActionHandlers = {\n  [ActionName in keyof ProjectActionTypes]: (\n    global: RequiredGlobalState,\n    actions: RequiredGlobalActions,\n    payload: ProjectActionTypes[ActionName],\n  ) => GlobalState | void | Promise<void>;\n};\n\nexport const getGlobal = typed.getGlobal;\nexport const setGlobal = typed.setGlobal;\nexport const getActions = typed.getActions;\nexport const getPromiseActions = typed.getPromiseActions;\nexport const addActionHandler = typed.addActionHandler as <ActionName extends ProjectActionNames>(\n  name: ActionName,\n  handler: ActionHandlers[ActionName],\n) => void;\nexport const execAfterActions = typed.execAfterActions;\nexport const withGlobal = typed.withGlobal;\nexport type GlobalActions = ReturnType<typeof getActions>;\n","export default function generateUniqueId() {\n  return Date.now().toString(36) + Math.random().toString(36).slice(2);\n}\n\nexport function generateUniqueNumberId() {\n  const timestamp = Date.now() % 100000000;\n  const random = Math.floor(Math.random() * 1000);\n  return timestamp + random;\n}\n","import type { LangFn } from './localization';\n\nimport EMOJI_REGEX from '../lib/twemojiRegex';\nimport fixNonStandardEmoji from './emoji/fixNonStandardEmoji';\nimport { floor } from './math';\nimport withCache from './withCache';\n\nexport function formatInteger(value: number) {\n  return String(value).replace(/\\d(?=(\\d{3})+$)/g, '$& ');\n}\n\nexport function formatIntegerCompact(lang: LangFn, views: number) {\n  if (views < 1e3) {\n    return lang.number(views);\n  }\n\n  if (views < 1e6) {\n    return `${lang.number(floor(views / 1e3, 1))}K`;\n  }\n\n  return `${lang.number(floor(views / 1e6, 1))}M`;\n}\n\nexport function formatPercent(value: number, fractionDigits = 1) {\n  return `${Number.isInteger(value) ? value : value.toFixed(fractionDigits)}%`;\n}\n\nexport const getFirstLetters = withCache((phrase: string, count = 2) => {\n  return phrase\n    .replace(/[.,!@#$%^&*()_+=\\-`~[\\]/\\\\{}:\"|<>?]+/gi, '')\n    .trim()\n    .split(/\\s+/)\n    .slice(0, count)\n    .map((word: string) => {\n      if (!word.length) return '';\n      word = fixNonStandardEmoji(word);\n      const emojis = word.match(EMOJI_REGEX);\n      if (emojis && word.startsWith(emojis[0])) {\n        return emojis[0];\n      }\n      return word.match(/./u)![0].toUpperCase();\n    })\n    .join('');\n});\n\nconst FILE_SIZE_UNITS = ['B', 'KB', 'MB', 'GB'] as const;\nexport function formatFileSize(lang: LangFn, bytes: number, decimals = 1): string {\n  if (bytes === 0) {\n    return lang('MediaSizeB', { size: 0 }, { pluralValue: 0 });\n  }\n\n  const k = 1024;\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  const v = (bytes / (k ** i));\n  const value = v.toFixed(Math.max(decimals, 0));\n\n  return lang(`MediaSize${FILE_SIZE_UNITS[i]}`, { size: value }, { pluralValue: v });\n}\n","import { IS_TAURI } from './browser/globalEnvironment';\nimport { createCallbackManager } from './callbacks';\nimport { ESTABLISH_BROADCAST_CHANNEL_NAME } from './multiaccount';\nimport { getPasscodeHash, setPasscodeHash } from './passcode';\n\nimport Deferred from './Deferred';\n\nconst ESTABLISH_TIMEOUT = 100;\n\nconst { addCallback, runCallbacks } = createCallbackManager();\nconst { addCallback: addCallbackTokenDied, runCallbacks: runCallbacksTokenDied } = createCallbackManager();\nconst token = Number(Math.random().toString().substring(2));\nconst collectedTokens = new Set([token]);\nconst channel = new BroadcastChannel(ESTABLISH_BROADCAST_CHANNEL_NAME);\n\nlet isEstablished = false;\nconst initialEstablishment = new Deferred();\nlet masterToken: number | undefined;\nlet isWaitingForMaster = false;\nlet reestablishToken: number | undefined;\nlet isChannelClosed = false;\n\ntype EstablishMessage = {\n  collectedTokens: Set<number>;\n  masterToken?: number;\n  tokenDied?: number;\n  currentPasscodeHash?: ArrayBuffer;\n  reestablishToken?: number;\n  shouldGiveUpMaster?: boolean;\n  hasGaveUpMaster?: boolean;\n};\n\nconst handleMessage = ({ data }: { data: EstablishMessage }) => {\n  if (!data) return;\n\n  if (data.currentPasscodeHash) {\n    setPasscodeHash(data.currentPasscodeHash);\n  }\n\n  if (data.hasGaveUpMaster && isWaitingForMaster) {\n    masterToken = token;\n    isWaitingForMaster = false;\n    initialEstablishment.resolve();\n    runCallbacks(true);\n    return;\n  }\n\n  if (data.shouldGiveUpMaster) {\n    if (masterToken === token) {\n      runCallbacks(false);\n      channel.postMessage({ currentPasscodeHash: getPasscodeHash(), hasGaveUpMaster: true });\n    }\n    masterToken = data.masterToken;\n    return;\n  }\n\n  if (data.tokenDied) {\n    runCallbacksTokenDied(data.tokenDied);\n    collectedTokens.delete(data.tokenDied);\n    if (data.tokenDied === masterToken) {\n      collectedTokens.delete(data.tokenDied);\n      masterToken = undefined;\n      isEstablished = false;\n      reestablishToken = data.tokenDied;\n\n      channel.postMessage({\n        collectedTokens,\n        masterToken,\n        reestablishToken,\n      });\n      if (collectedTokens.size === 1) {\n        isEstablished = true;\n        masterToken = token;\n        reestablishToken = undefined;\n        initialEstablishment.resolve();\n        runCallbacks(true);\n      }\n    }\n  }\n\n  if (data.collectedTokens) {\n    if (!data.reestablishToken && reestablishToken) {\n      return;\n    }\n    if (data.reestablishToken && reestablishToken !== data.reestablishToken) {\n      data.collectedTokens.delete(data.reestablishToken);\n\n      reestablishToken = data.reestablishToken;\n    }\n    const prevLength = collectedTokens.size;\n    data.collectedTokens.forEach((l) => collectedTokens.add(l));\n    if (reestablishToken) data.collectedTokens.delete(reestablishToken);\n\n    if (!isEstablished) {\n      if (data.masterToken) {\n        reestablishToken = undefined;\n        masterToken = data.masterToken;\n        runCallbacks(masterToken === token);\n\n        if (!isEstablished) {\n          channel.postMessage({\n            collectedTokens,\n            masterToken,\n            reestablishToken,\n          });\n        }\n        initialEstablishment.resolve();\n        isEstablished = true;\n      } else if (prevLength !== collectedTokens.size) {\n        channel.postMessage({\n          collectedTokens,\n          masterToken,\n          reestablishToken,\n        });\n      } else {\n        reestablishToken = undefined;\n        masterToken = Math.max(...Array.from(collectedTokens));\n        runCallbacks(masterToken === token);\n\n        if (!isEstablished) {\n          channel.postMessage({\n            collectedTokens,\n            masterToken,\n            reestablishToken,\n          });\n        }\n        initialEstablishment.resolve();\n        isEstablished = true;\n      }\n    } else if (!data.masterToken) {\n      channel.postMessage({\n        collectedTokens,\n        masterToken,\n        reestablishToken,\n      });\n    }\n  }\n};\n\nexport function establishMultitabRole(shouldReestablishMasterToSelf?: boolean) {\n  if (isChannelClosed) return;\n  channel.addEventListener('message', handleMessage);\n\n  channel.postMessage({ collectedTokens });\n\n  // To make the connection faster, we can ignore the waiting and connect right away,\n  // and then if we realize we're not master, drop the connection\n  setTimeout(() => {\n    if (masterToken === undefined) {\n      masterToken = token;\n      initialEstablishment.resolve();\n      runCallbacks(true);\n    } else if (shouldReestablishMasterToSelf) {\n      reestablishMasterToSelf();\n    }\n  }, ESTABLISH_TIMEOUT);\n\n  window.addEventListener('beforeunload', signalTokenDead);\n  if (IS_TAURI) window.addEventListener('unload', signalTokenDead);\n}\n\nexport function signalTokenDead() {\n  if (isChannelClosed) return;\n  runCallbacksTokenDied(token);\n  channel.removeEventListener('message', handleMessage);\n  channel.postMessage({ tokenDied: token, currentPasscodeHash: getPasscodeHash() });\n  channel.close();\n  isChannelClosed = true;\n}\n\nexport function signalPasscodeHash() {\n  channel.postMessage({ currentPasscodeHash: getPasscodeHash() });\n}\n\nexport function getCurrentTabId() {\n  return token;\n}\n\nexport function getAllMultitabTokens() {\n  return Array.from(collectedTokens);\n}\n\nexport function reestablishMasterToSelf() {\n  isWaitingForMaster = true;\n  channel.postMessage({\n    collectedTokens, masterToken: token, shouldGiveUpMaster: true,\n  });\n}\n\nexport const subscribeToTokenDied = addCallbackTokenDied;\nexport const subscribeToMasterChange = addCallback;\n\nexport const initialEstablishmentPromise = initialEstablishment.promise;\n\nexport function isCurrentTabMaster() {\n  return masterToken === token;\n}\n","import { useRef } from '../lib/teact/teact';\n\nimport generateUniqueId from '../util/generateUniqueId';\n\nexport default function useUniqueId() {\n  const idRef = useRef<string>();\n\n  if (!idRef.current) {\n    idRef.current = generateUniqueId();\n  }\n\n  return idRef.current;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nfunction useEffectOnce(effect: React.EffectCallback) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useEffect(effect, []);\n}\n\nexport default useEffectOnce;\n","// Copyright Twitter Inc. Licensed under MIT\n// https://github.com/twitter/twemoji-parser/blob/master/LICENSE.md\n// Emoji 16.0.0 support was taken here https://github.com/jdecked/twemoji-parser\n// Version ab019e0 14.04.2025\n\nconst vs16RegExp = /\\uFE0F/g;\n// avoid using a string literal like `\\u200D` here because minifiers expand it inline\nconst zeroWidthJoiner = String.fromCharCode(0x200d);\n\nexport function removeVS16s(rawEmoji) {\n  return rawEmoji.indexOf(zeroWidthJoiner) < 0 ? rawEmoji.replace(vs16RegExp, '') : rawEmoji;\n}\n\n// Default Twemoji regex was modified here.\n// An exception for ascii emoji has been added to the beginning of the regular string: .\n// UTF-16 endcoding are `\\ud83c\\udd70`, `\\ud83c\\udd71`, `\\ud83c\\udd7e` and `\\ud83c\\udd7f`.\n// These emojis in the graphic version must end with the `\\ufe0f` symbol.\n// Therefore, they should be excluded from the regular expression.\n// You must remove next substring `\\udd70\\udd71\\udd7e\\udd7f` from the middle of the regex on every update.\n\n// This file is generated by source/emoji/scripts/generate.sh\n// eslint-disable-next-line @stylistic/max-len\nexport default /(?:\\ud83c[\\udd70\\udd71\\udd7e\\udd7f]\\ufe0f)|(?:\\ud83d\\udc68\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffc-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc68\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc69\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffc-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc69\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc69\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc69\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc68\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc69\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83d\\udc69\\ud83c[\\udffb-\\udffe]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffc-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffb\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffc\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\uddd1\\ud83c\\udffd\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\uddd1\\ud83c\\udffe\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\u2764\\ufe0f\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udffe]|\\ud83e\\uddd1\\ud83c\\udfff\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68|\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d[\\udc68\\udc69]|\\ud83e\\udef1\\ud83c\\udffb\\u200d\\ud83e\\udef2\\ud83c[\\udffc-\\udfff]|\\ud83e\\udef1\\ud83c\\udffc\\u200d\\ud83e\\udef2\\ud83c[\\udffb\\udffd-\\udfff]|\\ud83e\\udef1\\ud83c\\udffd\\u200d\\ud83e\\udef2\\ud83c[\\udffb\\udffc\\udffe\\udfff]|\\ud83e\\udef1\\ud83c\\udffe\\u200d\\ud83e\\udef2\\ud83c[\\udffb-\\udffd\\udfff]|\\ud83e\\udef1\\ud83c\\udfff\\u200d\\ud83e\\udef2\\ud83c[\\udffb-\\udffe]|\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68|\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d[\\udc68\\udc69]|\\ud83e\\uddd1\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1|\\ud83d\\udc6b\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc6c\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc6d\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc8f\\ud83c[\\udffb-\\udfff]|\\ud83d\\udc91\\ud83c[\\udffb-\\udfff]|\\ud83e\\udd1d\\ud83c[\\udffb-\\udfff]|\\ud83d[\\udc6b-\\udc6d\\udc8f\\udc91]|\\ud83e\\udd1d)|(?:\\ud83d[\\udc68\\udc69]|\\ud83e\\uddd1)(?:\\ud83c[\\udffb-\\udfff])?\\u200d(?:\\u2695\\ufe0f|\\u2696\\ufe0f|\\u2708\\ufe0f|\\ud83c[\\udf3e\\udf73\\udf7c\\udf84\\udf93\\udfa4\\udfa8\\udfeb\\udfed]|\\ud83d[\\udcbb\\udcbc\\udd27\\udd2c\\ude80\\ude92]|\\ud83e[\\uddaf-\\uddb3\\uddbc\\uddbd])(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83c[\\udfcb\\udfcc]|\\ud83d[\\udd74\\udd75]|\\u26f9)((?:\\ud83c[\\udffb-\\udfff]|\\ufe0f)\\u200d[\\u2640\\u2642]\\ufe0f(?:\\u200d\\u27a1\\ufe0f)?)|(?:\\ud83c[\\udfc3\\udfc4\\udfca]|\\ud83d[\\udc6e\\udc70\\udc71\\udc73\\udc77\\udc81\\udc82\\udc86\\udc87\\ude45-\\ude47\\ude4b\\ude4d\\ude4e\\udea3\\udeb4-\\udeb6]|\\ud83e[\\udd26\\udd35\\udd37-\\udd39\\udd3d\\udd3e\\uddb8\\uddb9\\uddcd-\\uddcf\\uddd4\\uddd6-\\udddd])(?:\\ud83c[\\udffb-\\udfff])?\\u200d[\\u2640\\u2642]\\ufe0f(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83e\\uddd1\\u200d\\ud83e\\uddd1\\u200d\\ud83e\\uddd2\\u200d\\ud83e\\uddd2|\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66|\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83e\\uddd1\\u200d\\ud83e\\uddd1\\u200d\\ud83e\\uddd2|\\ud83e\\uddd1\\u200d\\ud83e\\uddd2\\u200d\\ud83e\\uddd2|\\ud83c\\udff3\\ufe0f\\u200d\\u26a7\\ufe0f|\\ud83c\\udff3\\ufe0f\\u200d\\ud83c\\udf08|\\ud83d\\ude36\\u200d\\ud83c\\udf2b\\ufe0f|\\u26d3\\ufe0f\\u200d\\ud83d\\udca5|\\u2764\\ufe0f\\u200d\\ud83d\\udd25|\\u2764\\ufe0f\\u200d\\ud83e\\ude79|\\ud83c\\udf44\\u200d\\ud83d\\udfeb|\\ud83c\\udf4b\\u200d\\ud83d\\udfe9|\\ud83c\\udff4\\u200d\\u2620\\ufe0f|\\ud83d\\udc15\\u200d\\ud83e\\uddba|\\ud83d\\udc26\\u200d\\ud83d\\udd25|\\ud83d\\udc3b\\u200d\\u2744\\ufe0f|\\ud83d\\udc41\\u200d\\ud83d\\udde8|\\ud83d\\udc68\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc69\\u200d\\ud83d[\\udc66\\udc67]|\\ud83d\\udc6f\\u200d\\u2640\\ufe0f|\\ud83d\\udc6f\\u200d\\u2642\\ufe0f|\\ud83d\\ude2e\\u200d\\ud83d\\udca8|\\ud83d\\ude35\\u200d\\ud83d\\udcab|\\ud83d\\ude42\\u200d\\u2194\\ufe0f|\\ud83d\\ude42\\u200d\\u2195\\ufe0f|\\ud83e\\udd3c\\u200d\\u2640\\ufe0f|\\ud83e\\udd3c\\u200d\\u2642\\ufe0f|\\ud83e\\uddd1\\u200d\\ud83e\\uddd2|\\ud83e\\uddde\\u200d\\u2640\\ufe0f|\\ud83e\\uddde\\u200d\\u2642\\ufe0f|\\ud83e\\udddf\\u200d\\u2640\\ufe0f|\\ud83e\\udddf\\u200d\\u2642\\ufe0f|\\ud83d\\udc08\\u200d\\u2b1b|\\ud83d\\udc26\\u200d\\u2b1b)|[#*0-9]\\ufe0f?\\u20e3|(?:[\\u2122\\u265f]\\ufe0f)|(?:\\ud83c[\\udc04\\ude02\\ude1a\\ude2f\\ude37\\udf21\\udf24-\\udf2c\\udf36\\udf7d\\udf96\\udf97\\udf99-\\udf9b\\udf9e\\udf9f\\udfcd\\udfce\\udfd4-\\udfdf\\udff3\\udff5\\udff7]|\\ud83d[\\udc3f\\udc41\\udcfd\\udd49\\udd4a\\udd6f\\udd70\\udd73\\udd76-\\udd79\\udd87\\udd8a-\\udd8d\\udda5\\udda8\\uddb1\\uddb2\\uddbc\\uddc2-\\uddc4\\uddd1-\\uddd3\\udddc-\\uddde\\udde1\\udde3\\udde8\\uddef\\uddf3\\uddfa\\udecb\\udecd-\\udecf\\udee0-\\udee5\\udee9\\udef0\\udef3]|[\\u203c\\u2049\\u2139\\u2194-\\u2199\\u21a9\\u21aa\\u231a\\u231b\\u2328\\u23cf\\u23ed-\\u23ef\\u23f1\\u23f2\\u23f8-\\u23fa\\u24c2\\u25aa\\u25ab\\u25b6\\u25c0\\u25fb-\\u25fe\\u2600-\\u2604\\u260e\\u2611\\u2614\\u2615\\u2618\\u2620\\u2622\\u2623\\u2626\\u262a\\u262e\\u262f\\u2638-\\u263a\\u2640\\u2642\\u2648-\\u2653\\u2660\\u2663\\u2665\\u2666\\u2668\\u267b\\u267f\\u2692-\\u2697\\u2699\\u269b\\u269c\\u26a0\\u26a1\\u26a7\\u26aa\\u26ab\\u26b0\\u26b1\\u26bd\\u26be\\u26c4\\u26c5\\u26c8\\u26cf\\u26d1\\u26d3\\u26d4\\u26e9\\u26ea\\u26f0-\\u26f5\\u26f8\\u26fa\\u26fd\\u2702\\u2708\\u2709\\u270f\\u2712\\u2714\\u2716\\u271d\\u2721\\u2733\\u2734\\u2744\\u2747\\u2757\\u2763\\u2764\\u27a1\\u2934\\u2935\\u2b05-\\u2b07\\u2b1b\\u2b1c\\u2b50\\u2b55\\u3030\\u303d\\u3297\\u3299])(?:\\ufe0f|(?!\\ufe0e))|(?:(?:\\ud83c[\\udfcb\\udfcc]|\\ud83d[\\udd74\\udd75\\udd90]|\\ud83e\\udef0|[\\u261d\\u26f7\\u26f9\\u270c\\u270d])(?:\\ufe0f|(?!\\ufe0e))|(?:\\ud83c\\udfc3|\\ud83d\\udeb6|\\ud83e\\uddce)(?:\\ud83c[\\udffb-\\udfff])?(?:\\u200d\\u27a1\\ufe0f)?|(?:\\ud83c[\\udf85\\udfc2\\udfc4\\udfc7\\udfca]|\\ud83d[\\udc42\\udc43\\udc46-\\udc50\\udc66-\\udc69\\udc6e\\udc70-\\udc78\\udc7c\\udc81-\\udc83\\udc85-\\udc87\\udcaa\\udd7a\\udd95\\udd96\\ude45-\\ude47\\ude4b-\\ude4f\\udea3\\udeb4\\udeb5\\udec0\\udecc]|\\ud83e[\\udd0c\\udd0f\\udd18-\\udd1c\\udd1e\\udd1f\\udd26\\udd30-\\udd39\\udd3d\\udd3e\\udd77\\uddb5\\uddb6\\uddb8\\uddb9\\uddbb\\uddcd\\uddcf\\uddd1-\\udddd\\udec3-\\udec5\\udef1-\\udef8]|[\\u270a\\u270b]))(?:\\ud83c[\\udffb-\\udfff])?|(?:\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc65\\udb40\\udc6e\\udb40\\udc67\\udb40\\udc7f|\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc73\\udb40\\udc63\\udb40\\udc74\\udb40\\udc7f|\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc77\\udb40\\udc6c\\udb40\\udc73\\udb40\\udc7f|\\ud83c\\udde6\\ud83c[\\udde8-\\uddec\\uddee\\uddf1\\uddf2\\uddf4\\uddf6-\\uddfa\\uddfc\\uddfd\\uddff]|\\ud83c\\udde7\\ud83c[\\udde6\\udde7\\udde9-\\uddef\\uddf1-\\uddf4\\uddf6-\\uddf9\\uddfb\\uddfc\\uddfe\\uddff]|\\ud83c\\udde8\\ud83c[\\udde6\\udde8\\udde9\\uddeb-\\uddee\\uddf0-\\uddf7\\uddfa-\\uddff]|\\ud83c\\udde9\\ud83c[\\uddea\\uddec\\uddef\\uddf0\\uddf2\\uddf4\\uddff]|\\ud83c\\uddea\\ud83c[\\udde6\\udde8\\uddea\\uddec\\udded\\uddf7-\\uddfa]|\\ud83c\\uddeb\\ud83c[\\uddee-\\uddf0\\uddf2\\uddf4\\uddf7]|\\ud83c\\uddec\\ud83c[\\udde6\\udde7\\udde9-\\uddee\\uddf1-\\uddf3\\uddf5-\\uddfa\\uddfc\\uddfe]|\\ud83c\\udded\\ud83c[\\uddf0\\uddf2\\uddf3\\uddf7\\uddf9\\uddfa]|\\ud83c\\uddee\\ud83c[\\udde8-\\uddea\\uddf1-\\uddf4\\uddf6-\\uddf9]|\\ud83c\\uddef\\ud83c[\\uddea\\uddf2\\uddf4\\uddf5]|\\ud83c\\uddf0\\ud83c[\\uddea\\uddec-\\uddee\\uddf2\\uddf3\\uddf5\\uddf7\\uddfc\\uddfe\\uddff]|\\ud83c\\uddf1\\ud83c[\\udde6-\\udde8\\uddee\\uddf0\\uddf7-\\uddfb\\uddfe]|\\ud83c\\uddf2\\ud83c[\\udde6\\udde8-\\udded\\uddf0-\\uddff]|\\ud83c\\uddf3\\ud83c[\\udde6\\udde8\\uddea-\\uddec\\uddee\\uddf1\\uddf4\\uddf5\\uddf7\\uddfa\\uddff]|\\ud83c\\uddf4\\ud83c\\uddf2|\\ud83c\\uddf5\\ud83c[\\udde6\\uddea-\\udded\\uddf0-\\uddf3\\uddf7-\\uddf9\\uddfc\\uddfe]|\\ud83c\\uddf6\\ud83c\\udde6|\\ud83c\\uddf7\\ud83c[\\uddea\\uddf4\\uddf8\\uddfa\\uddfc]|\\ud83c\\uddf8\\ud83c[\\udde6-\\uddea\\uddec-\\uddf4\\uddf7-\\uddf9\\uddfb\\uddfd-\\uddff]|\\ud83c\\uddf9\\ud83c[\\udde6\\udde8\\udde9\\uddeb-\\udded\\uddef-\\uddf4\\uddf7\\uddf9\\uddfb\\uddfc\\uddff]|\\ud83c\\uddfa\\ud83c[\\udde6\\uddec\\uddf2\\uddf3\\uddf8\\uddfe\\uddff]|\\ud83c\\uddfb\\ud83c[\\udde6\\udde8\\uddea\\uddec\\uddee\\uddf3\\uddfa]|\\ud83c\\uddfc\\ud83c[\\uddeb\\uddf8]|\\ud83c\\uddfd\\ud83c\\uddf0|\\ud83c\\uddfe\\ud83c[\\uddea\\uddf9]|\\ud83c\\uddff\\ud83c[\\udde6\\uddf2\\uddfc]|\\ud83c[\\udccf\\udd8e\\udd91-\\udd9a\\udde6-\\uddff\\ude01\\ude32-\\ude36\\ude38-\\ude3a\\ude50\\ude51\\udf00-\\udf20\\udf2d-\\udf35\\udf37-\\udf7c\\udf7e-\\udf84\\udf86-\\udf93\\udfa0-\\udfc1\\udfc5\\udfc6\\udfc8\\udfc9\\udfcf-\\udfd3\\udfe0-\\udff0\\udff4\\udff8-\\udfff]|\\ud83d[\\udc00-\\udc3e\\udc40\\udc44\\udc45\\udc51-\\udc65\\udc6a\\udc6f\\udc79-\\udc7b\\udc7d-\\udc80\\udc84\\udc88-\\udc8e\\udc90\\udc92-\\udca9\\udcab-\\udcfc\\udcff-\\udd3d\\udd4b-\\udd4e\\udd50-\\udd67\\udda4\\uddfb-\\ude44\\ude48-\\ude4a\\ude80-\\udea2\\udea4-\\udeb3\\udeb7-\\udebf\\udec1-\\udec5\\uded0-\\uded2\\uded5-\\uded7\\udedc-\\udedf\\udeeb\\udeec\\udef4-\\udefc\\udfe0-\\udfeb\\udff0]|\\ud83e[\\udd0d\\udd0e\\udd10-\\udd17\\udd20-\\udd25\\udd27-\\udd2f\\udd3a\\udd3c\\udd3f-\\udd45\\udd47-\\udd76\\udd78-\\uddb4\\uddb7\\uddba\\uddbc-\\uddcc\\uddd0\\uddde-\\uddff\\ude70-\\ude7c\\ude80-\\ude89\\ude8f-\\udec2\\udec6\\udece-\\udedc\\udedf-\\udee9]|[\\u23e9-\\u23ec\\u23f0\\u23f3\\u267e\\u26ce\\u2705\\u2728\\u274c\\u274e\\u2753-\\u2755\\u2795-\\u2797\\u27b0\\u27bf\\ue50a])|\\ufe0f/g;\n","import type {\n  ApiChat, ApiChatFullInfo, ApiChatMember,\n} from '../../api/types';\nimport type { ChatListType } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { ARCHIVED_FOLDER_ID } from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport {\n  areSortedArraysEqual, buildCollectionByKey, omit, omitUndefined, pick, unique,\n} from '../../util/iteratees';\nimport { selectChatFullInfo } from '../selectors';\n\nconst DEFAULT_CHAT_LISTS: ChatListType[] = ['active', 'archived'];\n\nexport function replaceChatListIds<T extends GlobalState>(\n  global: T,\n  type: ChatListType,\n  newIds: string[] | undefined,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      listIds: {\n        ...global.chats.listIds,\n        [type]: newIds,\n      },\n    },\n  };\n}\n\nexport function replaceChatListLoadingParameters<T extends GlobalState>(\n  global: T, type: ChatListType, nextOffsetId?: number, nextOffsetPeerId?: string, nextOffsetDate?: number,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      loadingParameters: {\n        ...global.chats.loadingParameters,\n        [type]: {\n          nextOffsetId,\n          nextOffsetPeerId,\n          nextOffsetDate,\n        },\n      },\n    },\n  };\n}\n\nexport function updateChatLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, lastMessageId: number, listType?: ChatListType,\n): T {\n  const key = listType === 'saved' ? 'saved' : 'all';\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      lastMessageIds: {\n        ...global.chats.lastMessageIds,\n        [key]: {\n          ...global.chats.lastMessageIds[key],\n          [chatId]: lastMessageId,\n        },\n      },\n    },\n  };\n}\n\nexport function updateChatsLastMessageId<T extends GlobalState>(\n  global: T, messageIds: Record<string, number>, listType?: ChatListType,\n): T {\n  const key = listType === 'saved' ? 'saved' : 'all';\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      lastMessageIds: {\n        ...global.chats.lastMessageIds,\n        [key]: {\n          ...global.chats.lastMessageIds[key],\n          ...messageIds,\n        },\n      },\n    },\n  };\n}\n\nexport function addChatListIds<T extends GlobalState>(\n  global: T, type: ChatListType, idsUpdate: string[],\n): T {\n  const { [type]: listIds } = global.chats.listIds;\n  const newIds = listIds?.length\n    ? idsUpdate.filter((id) => !listIds.includes(id))\n    : idsUpdate;\n\n  if (listIds && !newIds.length) {\n    return global;\n  }\n\n  return replaceChatListIds(global, type, [\n    ...(listIds || []),\n    ...newIds,\n  ]);\n}\n\nexport function replaceChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      byId: newById,\n    },\n  };\n}\n\nexport function addUnreadMentions<T extends GlobalState>(\n  global: T, chatId: string, chat: ApiChat, ids: number[], shouldUpdateCount: boolean = false,\n): T {\n  const prevChatUnreadMentions = (chat.unreadMentions || []);\n  const updatedUnreadMentions = unique([...prevChatUnreadMentions, ...ids]).sort((a, b) => b - a);\n  global = updateChat(global, chatId, {\n    unreadMentions: updatedUnreadMentions,\n  });\n\n  if (shouldUpdateCount) {\n    const updatedUnreadMentionsCount = (chat.unreadMentionsCount || 0)\n      + Math.max(0, updatedUnreadMentions.length - prevChatUnreadMentions.length);\n\n    global = updateChat(global, chatId, {\n      unreadMentionsCount: updatedUnreadMentionsCount,\n    });\n  }\n  return global;\n}\n\nexport function removeUnreadMentions<T extends GlobalState>(\n  global: T, chatId: string, chat: ApiChat, ids: number[], shouldUpdateCount: boolean = false,\n): T {\n  const prevChatUnreadMentions = (chat.unreadMentions || []);\n  const updatedUnreadMentions = prevChatUnreadMentions?.filter((id) => !ids.includes(id));\n\n  global = updateChat(global, chatId, {\n    unreadMentions: updatedUnreadMentions,\n  });\n\n  if (shouldUpdateCount && chat.unreadMentionsCount) {\n    const removedCount = prevChatUnreadMentions.length - updatedUnreadMentions.length;\n    const updatedUnreadMentionsCount = Math.max(chat.unreadMentionsCount - removedCount, 0) || undefined;\n\n    global = updateChat(global, chatId, {\n      unreadMentionsCount: updatedUnreadMentionsCount,\n    });\n  }\n  return global;\n}\n\nexport function updateChat<T extends GlobalState>(\n  global: T, chatId: string, chatUpdate: Partial<ApiChat>, noOmitUnreadReactionCount = false, withDeepCheck = false,\n): T {\n  const { byId } = global.chats;\n\n  const chat = byId[chatId];\n  if (withDeepCheck && chat) {\n    const updateKeys = Object.keys(chatUpdate) as (keyof ApiChat)[];\n    if (areDeepEqual(pick(chat, updateKeys), chatUpdate)) {\n      return global;\n    }\n  }\n\n  const updatedChat = getUpdatedChat(global, chatId, chatUpdate, noOmitUnreadReactionCount);\n  if (!updatedChat) {\n    return global;\n  }\n\n  return replaceChats(global, {\n    ...byId,\n    [chatId]: updatedChat,\n  });\n}\n\nexport function updateChatFullInfo<T extends GlobalState>(\n  global: T, chatId: string, fullInfoUpdate: Partial<ApiChatFullInfo>,\n): T {\n  const currentFullInfo = selectChatFullInfo(global, chatId);\n  const updatedFullInfo = {\n    ...currentFullInfo,\n    ...fullInfoUpdate,\n  };\n\n  if (areDeepEqual(currentFullInfo, updatedFullInfo)) {\n    return global;\n  }\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      fullInfoById: {\n        ...global.chats.fullInfoById,\n        [chatId]: updatedFullInfo,\n      },\n    },\n  };\n}\n\nexport function replaceChatFullInfo<T extends GlobalState>(global: T, chatId: string, fullInfo: ApiChatFullInfo): T {\n  const currentFullInfo = selectChatFullInfo(global, chatId);\n\n  if (areDeepEqual(currentFullInfo, fullInfo)) {\n    return global;\n  }\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      fullInfoById: {\n        ...global.chats.fullInfoById,\n        [chatId]: fullInfo,\n      },\n    },\n  };\n}\n\nexport function updateChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  const updatedById = Object.keys(newById).reduce((acc: Record<string, ApiChat>, id) => {\n    const updatedChat = getUpdatedChat(global, id, newById[id]);\n    if (updatedChat) {\n      acc[id] = updatedChat;\n    }\n\n    return acc;\n  }, {});\n\n  global = replaceChats(global, {\n    ...global.chats.byId,\n    ...updatedById,\n  });\n\n  return global;\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addChats<T extends GlobalState>(global: T, newById: Record<string, ApiChat>): T {\n  const { byId } = global.chats;\n  let isUpdated = false;\n\n  const addedById = Object.keys(newById).reduce<Record<string, ApiChat>>((acc, id) => {\n    const existingChat = byId[id];\n    const newChat = newById[id];\n\n    const membersCountChanged = !existingChat?.membersCount && newChat.membersCount;\n\n    if (existingChat && !existingChat.isMin && !membersCountChanged\n      && (newChat.isMin || existingChat.accessHash === newChat.accessHash)) {\n      return acc;\n    }\n\n    const updatedChat = getUpdatedChat(global, id, newChat);\n    if (updatedChat) {\n      acc[id] = updatedChat;\n      if (!isUpdated) {\n        isUpdated = true;\n      }\n    }\n\n    return acc;\n  }, {});\n\n  if (!isUpdated) {\n    return global;\n  }\n\n  global = replaceChats(global, {\n    ...byId,\n    ...addedById,\n  });\n\n  return global;\n}\n\n// @optimization Don't spread/unspread global for each element, do it in a batch\nfunction getUpdatedChat<T extends GlobalState>(\n  global: T, chatId: string, chatUpdate: Partial<ApiChat>,\n  noOmitUnreadReactionCount = false,\n) {\n  const { byId } = global.chats;\n  const chat = byId[chatId];\n  const omitProps: (keyof ApiChat)[] = [];\n\n  if (chatUpdate.isMin && chat && !chat.isMin) {\n    return undefined; // Do not apply updates from min constructor\n  }\n\n  if (!noOmitUnreadReactionCount) {\n    omitProps.push('unreadReactionsCount');\n  }\n\n  if (areDeepEqual(chat?.usernames, chatUpdate.usernames)) {\n    omitProps.push('usernames');\n  }\n\n  const updatedChat: ApiChat = {\n    ...chat,\n    ...omit(chatUpdate, omitProps),\n  } as ApiChat;\n\n  if (!updatedChat.id || !updatedChat.type) {\n    return undefined;\n  }\n\n  return omitUndefined(updatedChat);\n}\n\nexport function updateChatListType<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  folderId?: number,\n): T {\n  const listType = folderId === ARCHIVED_FOLDER_ID ? 'archived' : 'active';\n\n  let currentListIds = global.chats.listIds;\n  (Object.keys(currentListIds) as Array<keyof typeof currentListIds>).forEach((listTypeKey) => {\n    const currentFolderList = currentListIds[listTypeKey] || [];\n    if (listTypeKey === listType && !currentFolderList.includes(chatId)) {\n      currentListIds = {\n        ...currentListIds,\n        [listTypeKey]: [...currentFolderList, chatId],\n      };\n    } else if (listTypeKey !== listType && currentFolderList.includes(chatId)) {\n      currentListIds = {\n        ...currentListIds,\n        [listTypeKey]: currentFolderList.filter((id) => id !== chatId),\n      };\n    }\n  });\n\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      listIds: currentListIds,\n    },\n  };\n\n  global = updateChat(global, chatId, { folderId: folderId || undefined });\n\n  return global;\n}\n\nexport function updateChatListSecondaryInfo<T extends GlobalState>(\n  global: T,\n  type: ChatListType,\n  info: {\n    orderedPinnedIds?: string[];\n    totalChatCount: number;\n  },\n): T {\n  const totalCountKey = type === 'active' ? 'all' : type;\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      ...(info.orderedPinnedIds && {\n        orderedPinnedIds: {\n          ...global.chats.orderedPinnedIds,\n          [type]: info.orderedPinnedIds,\n        },\n      }),\n      totalCount: {\n        ...global.chats.totalCount,\n        [totalCountKey]: info.totalChatCount,\n      },\n    },\n  };\n}\n\nexport function leaveChat<T extends GlobalState>(global: T, leftChatId: string): T {\n  global = removeChatFromChatLists(global, leftChatId);\n\n  global = updateChat(global, leftChatId, { isNotJoined: true });\n  global = updateChatFullInfo(global, leftChatId, { joinInfo: undefined });\n\n  return global;\n}\n\nexport function removeChatFromChatLists<T extends GlobalState>(\n  global: T, chatId: string, type: 'all' | 'saved' = 'all',\n): T {\n  const chatLists = type === 'all' ? DEFAULT_CHAT_LISTS : [type];\n  chatLists.forEach((listType) => {\n    global = replaceChatListIds(global, listType, global.chats.listIds[listType]?.filter((id) => id !== chatId));\n  });\n\n  return global;\n}\n\nexport function addChatMembers<T extends GlobalState>(global: T, chat: ApiChat, membersToAdd: ApiChatMember[]): T {\n  const currentMembers = selectChatFullInfo(global, chat.id)?.members;\n  const newMemberIds = new Set(membersToAdd.map((m) => m.userId));\n  const updatedMembers = [\n    ...currentMembers?.filter(({ userId }) => !newMemberIds.has(userId)) || [],\n    ...membersToAdd,\n  ];\n  const currentIds = currentMembers?.map(({ userId }) => userId) || [];\n  const updatedIds = updatedMembers.map(({ userId }) => userId);\n\n  if (areSortedArraysEqual(currentIds, updatedIds)) {\n    return global;\n  }\n\n  const adminMembers = updatedMembers.filter(({ isAdmin, isOwner }) => isAdmin || isOwner);\n\n  return updateChatFullInfo(global, chat.id, {\n    members: updatedMembers,\n    adminMembersById: buildCollectionByKey(adminMembers, 'userId'),\n  });\n}\n\nexport function replaceSimilarChannels<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  similarChannelIds: string[],\n  count?: number,\n) {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarChannelsById: {\n        ...global.chats.similarChannelsById,\n        [chatId]: {\n          similarChannelIds,\n          count: count || similarChannelIds.length,\n        },\n      },\n    },\n  };\n}\n\nexport function toggleSimilarChannels<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  const similarChannels = global.chats.similarChannelsById[chatId];\n\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarChannelsById: {\n        ...global.chats.similarChannelsById,\n        [chatId]: {\n          ...similarChannels,\n          isExpanded: !similarChannels?.isExpanded,\n        },\n      },\n    },\n  };\n}\n\nexport function addSimilarBots<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  similarBotsIds: string[],\n  count?: number,\n) {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      similarBotsById: {\n        ...global.chats.similarBotsById,\n        [chatId]: {\n          similarBotsIds,\n          count,\n        },\n      },\n    },\n  };\n}\n","export default function getOffsetToContainer(element: HTMLElement, container: HTMLElement) {\n  let offsetTop = 0;\n  let offsetLeft = 0;\n\n  let current: HTMLElement | null = element;\n\n  while (current && current !== container && !current.contains(container)) {\n    offsetTop += current.offsetTop;\n    offsetLeft += current.offsetLeft;\n\n    current = current.offsetParent as HTMLElement | null;\n  }\n\n  offsetTop -= container.clientTop;\n  offsetLeft -= container.clientLeft;\n\n  return { top: offsetTop, left: offsetLeft };\n}\n","import { useCallback, useMemo } from '../lib/teact/teact';\n\nimport { debounce } from '../util/schedulers';\n\nexport default function useDebouncedCallback<T extends AnyToVoidFunction>(\n  fn: T,\n  deps: any[],\n  ms: number,\n  noFirst = false,\n  noLast = false,\n) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(fn, deps);\n\n  return useMemo(() => {\n    return debounce(fnMemo, ms, !noFirst, !noLast);\n  }, [fnMemo, ms, noFirst, noLast]);\n}\n","import { BACKEND_API_URL } from '../../../config';\nimport getAlpahHumanSocketManager from '../index';\nimport { log } from '../logger';\n\nexport interface RestContext {\n  backendUrl: string;\n}\n\n/**\n * Get JWT token from global state (preferred) or sessionStorage (fallback)\n */\nfunction getJwtToken(): string | undefined {\n  try {\n    // Try global state first (via alphahuman service)\n    const socketManager = getAlpahHumanSocketManager();\n    return socketManager.getJwtToken();\n  } catch (error) {\n    log('AUTH ERROR', 'Error loading JWT token:', error);\n    return undefined;\n  }\n}\n\n/**\n * Delete JWT token from state and storage\n */\nfunction deleteJwtToken(): void {\n  try {\n    // Clear token from global state via alphahuman service\n    const socketManager = getAlpahHumanSocketManager();\n    socketManager.saveJwtTokenToSession(undefined);\n  } catch (error) {\n    log('AUTH ERROR', 'Error deleting JWT token:', error);\n  }\n}\n\n/**\n * Make an authenticated REST API request\n * @param method - HTTP method (GET, POST, PUT, etc.)\n * @param path - API path (e.g., '/telegram/me')\n * @param data - Request body data (for POST/PUT requests)\n * @param queryParams - Query parameters (for GET requests)\n * @returns Promise that resolves with the response data\n */\nexport async function makeRestRequest<ReqBody = unknown, Response = unknown>(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  path: string,\n  data?: ReqBody,\n  queryParams?: Record<string, string>,\n): Promise<Response> {\n  const jwtToken = getJwtToken();\n  if (!jwtToken) {\n    throw new Error('JWT token not found. Please authenticate first.');\n  }\n\n  const backendUrl = BACKEND_API_URL || '';\n  if (!backendUrl) {\n    throw new Error('Backend API URL not configured');\n  }\n\n  // Build URL with query parameters\n  const url = new URL(path, backendUrl);\n  if (queryParams) {\n    Object.entries(queryParams).forEach(([key, value]) => {\n      url.searchParams.append(key, value);\n    });\n  }\n\n  // Prepare request options\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n    Authorization: `Bearer ${jwtToken}`,\n  };\n\n  const options: RequestInit = {\n    method,\n    headers,\n  };\n\n  // Add body for POST/PUT requests\n  if (data && (method === 'POST' || method === 'PUT')) {\n    options.body = JSON.stringify(data);\n  }\n\n  log('REQUEST', `${method} ${url.pathname}${url.search}`);\n\n  try {\n    const response = await fetch(url.toString(), options);\n\n    // Check if response is ok\n    if (!response.ok) {\n      const errorText = await response.text();\n      let errorMessage = `HTTP ${response.status}: ${response.statusText}`;\n      try {\n        const errorJson = JSON.parse(errorText);\n        errorMessage = errorJson.error || errorJson.message || errorMessage;\n      } catch {\n        // If JSON parsing fails, use the raw text\n        if (errorText) {\n          errorMessage = errorText;\n        }\n      }\n\n      if (response.status === 401) {\n        log('AUTH ERROR', 'Authentication failed (401):', errorMessage);\n        // Delete JWT token from storage on 401 error\n        deleteJwtToken();\n        throw new Error(`Authentication failed: ${errorMessage}`);\n      }\n\n      if (response.status === 403) {\n        log('AUTH ERROR', 'Authentication failed (403):', errorMessage);\n        throw new Error(`Authentication failed: ${errorMessage}`);\n      }\n\n      log('BACKEND ERROR', errorMessage);\n      throw new Error(errorMessage);\n    }\n\n    const result = await response.json();\n    log('RESPONSE', `Response from ${method} ${path}:`, result);\n\n    // Backend returns { success: true, data: ... }\n    if (result.success && result.data !== undefined) {\n      return result.data as Response;\n    }\n\n    // If response doesn't follow the standard format, return as-is\n    return result as Response;\n  } catch (error) {\n    log('BACKEND ERROR', `Failed to make ${method} request to ${path}:`, error);\n    if (error instanceof Error) {\n      throw error;\n    }\n    throw new Error(`Failed to make ${method} request to ${path}`);\n  }\n}\n","import { log } from '../logger';\nimport { makeRestRequest } from './restHelpers';\n\nexport interface GetMeResponse {\n  autoDeleteTelegramMessagesAfterDays: number;\n  autoDeleteThreadsAfterDays: number;\n  hasAccess: boolean;\n  magicWord: string;\n  telegramId: number;\n}\n\n/**\n * Get the current authenticated Telegram user details\n * REST API endpoint: GET /telegram/me\n */\nexport async function getMeRest(): Promise<GetMeResponse> {\n  log('REQUEST', 'Getting user details via REST API');\n  const response = await makeRestRequest<undefined, GetMeResponse>('GET', '/telegram/me');\n  log('RESPONSE', 'User data:', response);\n  return response;\n}\n","import { log } from '../logger';\nimport { makeRestRequest } from './restHelpers';\n\nexport type HighlightsTimeframe = 'daily' | 'weekly';\n\nexport interface HighlightPeriod {\n  start: string; // ISO date string\n  end: string; // ISO date string\n}\n\nexport interface Highlight {\n  chatHash: string;\n  chatType: string;\n  timeframe: HighlightsTimeframe;\n  summaryText: string;\n  highlights: string[];\n  period: HighlightPeriod;\n  generatedAt: string; // ISO date-time string\n}\n\nexport type GetHighlightsResponse = Highlight[];\n\n/**\n * Get precomputed highlights for user's Telegram chats\n * REST API endpoint: GET /telegram/highlights?timeframe=daily|weekly\n */\nexport async function getHighlightsRest(\n  timeframe: HighlightsTimeframe,\n): Promise<GetHighlightsResponse> {\n  log('REQUEST', `Getting highlights via REST API: timeframe=${timeframe}`);\n  const response = await makeRestRequest<undefined, Highlight[]>(\n    'GET',\n    '/telegram/highlights',\n    undefined,\n    { timeframe },\n  );\n  log('RESPONSE', 'Highlights:', response);\n  return response || [];\n}\n","import { makeRestRequest } from './restHelpers';\n\nexport interface AlphahumanThread {\n  id: string;\n  title: string;\n  isActive: boolean;\n  messageCount: number;\n  lastMessageAt: string; // ISO date-time string\n  createdAt: string; // ISO date-time string\n  chatId: string;\n}\n\nexport interface GetThreadsResponse {\n  threads: AlphahumanThread[];\n  count: number;\n}\n\n/**\n * Get threads for a Telegram user\n * REST API endpoint: GET /telegram/threads\n */\nexport async function getThreadsRest(): Promise<GetThreadsResponse> {\n  const response = await makeRestRequest<undefined, { threads: AlphahumanThread[]; count: number }>(\n    'GET',\n    '/telegram/threads',\n  );\n  return {\n    threads: response.threads || [],\n    count: response.count || 0,\n  };\n}\n","import { log } from '../logger';\nimport { makeRestRequest } from './restHelpers';\n\nexport interface CreateThreadResponse {\n  id: string;\n}\n\n/**\n * Create a new thread for a Telegram user\n * REST API endpoint: POST /telegram/threads\n */\nexport async function createThreadRest(chatId?: string): Promise<CreateThreadResponse> {\n  log('REQUEST', 'Creating new thread via REST API');\n  const response = await makeRestRequest<{ chatId: string }, { id: string }>(\n    'POST',\n    '/telegram/threads',\n    { chatId: chatId || '' },\n  );\n  log('RESPONSE', 'Thread created:', response);\n  return {\n    id: response.id,\n  };\n}\n","import type { AlphahumanThreadMessage } from '../types';\n\nimport { log } from '../logger';\nimport { makeRestRequest } from './restHelpers';\n\nexport interface GetThreadMessagesResponse {\n  messages: AlphahumanThreadMessage[];\n  count: number;\n}\n\n/**\n * Get messages for a specific thread\n * REST API endpoint: GET /telegram/threads/{threadId}/messages\n */\nexport async function getThreadMessagesRest(\n  threadId: string,\n): Promise<GetThreadMessagesResponse> {\n  log('REQUEST', `Getting thread messages via REST API: threadId=${threadId}`);\n  const response = await makeRestRequest<undefined, { messages: AlphahumanThreadMessage[]; count: number }>(\n    'GET',\n    `/telegram/threads/${encodeURIComponent(threadId)}/messages`,\n  );\n  log('RESPONSE', 'Thread messages:', response);\n  return {\n    messages: response.messages || [],\n    count: response.count || 0,\n  };\n}\n","import { BACKEND_API_URL } from '../../../config';\nimport { log } from '../logger';\n\nexport interface CreateLoginTokenResponse {\n  token: string;\n  expiresAt: string; // ISO date string\n}\n\nexport interface ConsumeLoginTokenResponse {\n  jwtToken: string;\n}\n\n/**\n * Make an unauthenticated REST API request (for login token endpoints)\n */\nasync function makeUnauthenticatedRequest<ReqBody = unknown, Response = unknown>(\n  method: 'GET' | 'POST' | 'PUT' | 'DELETE',\n  path: string,\n  data?: ReqBody,\n): Promise<Response> {\n  const backendUrl = BACKEND_API_URL || '';\n  if (!backendUrl) {\n    throw new Error('Backend API URL not configured');\n  }\n\n  const url = new URL(path, backendUrl);\n\n  const headers: HeadersInit = {\n    'Content-Type': 'application/json',\n  };\n\n  const options: RequestInit = {\n    method,\n    headers,\n  };\n\n  // Add body for POST/PUT requests\n  if (data && (method === 'POST' || method === 'PUT')) {\n    options.body = JSON.stringify(data);\n  }\n\n  log('REQUEST', `${method} ${url.pathname} (unauthenticated)`);\n\n  try {\n    const response = await fetch(url.toString(), options);\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      let errorMessage = `HTTP ${response.status}: ${response.statusText}`;\n      try {\n        const errorJson = JSON.parse(errorText);\n        errorMessage = errorJson.error || errorJson.message || errorMessage;\n      } catch {\n        if (errorText) {\n          errorMessage = errorText;\n        }\n      }\n\n      log('BACKEND ERROR', errorMessage);\n      throw new Error(errorMessage);\n    }\n\n    const result = await response.json();\n    log('RESPONSE', `Response from ${method} ${path}:`, result);\n\n    // Backend returns { success: true, data: ... }\n    if (result.success && result.data !== undefined) {\n      return result.data as Response;\n    }\n\n    return result as Response;\n  } catch (error) {\n    log('BACKEND ERROR', `Failed to make ${method} request to ${path}:`, error);\n    if (error instanceof Error) {\n      throw error;\n    }\n    throw new Error(`Failed to make ${method} request to ${path}`);\n  }\n}\n\n/**\n * Create a login token\n * REST API endpoint: POST /telegram/login-tokens\n * Anonymous endpoint - no authentication required\n */\nexport async function createLoginTokenRest(): Promise<CreateLoginTokenResponse> {\n  log('REQUEST', 'Creating login token via REST API');\n  const response = await makeUnauthenticatedRequest<undefined, CreateLoginTokenResponse>(\n    'POST',\n    '/telegram/login-tokens',\n  );\n  log('RESPONSE', 'Login token created:', response);\n  return response;\n}\n\n/**\n * Consume a verified login token and get JWT\n * REST API endpoint: POST /telegram/login-tokens/:token/consume\n * Anonymous endpoint - no authentication required\n */\nexport async function consumeLoginTokenRest(token: string): Promise<ConsumeLoginTokenResponse> {\n  log('REQUEST', `Consuming login token via REST API: token=${token.substring(0, 8)}...`);\n  const response = await makeUnauthenticatedRequest<undefined, ConsumeLoginTokenResponse>(\n    'POST',\n    `/telegram/login-tokens/${encodeURIComponent(token)}/consume`,\n  );\n  log('RESPONSE', 'Login token consumed, JWT received');\n  return response;\n}\n","import { makeRestRequest } from './restHelpers';\n\nexport interface NotionOAuthResponse {\n  success: boolean;\n  oauthUrl: string;\n  state: string;\n}\n\n/**\n * Initiate Notion OAuth 2.0 flow\n * @returns Promise that resolves with OAuth URL and state token\n */\nexport async function connectNotionRest(): Promise<NotionOAuthResponse> {\n  return makeRestRequest<void, NotionOAuthResponse>('GET', '/auth/notion/connect');\n}\n","import { makeRestRequest } from './restHelpers';\n\nexport interface GoogleOAuthResponse {\n  success: boolean;\n  oauthUrl: string;\n  state: string;\n}\n\n/**\n * Initiate Google OAuth 2.0 flow\n * @returns Promise that resolves with OAuth URL and state token\n */\nexport async function connectGoogleRest(): Promise<GoogleOAuthResponse> {\n  return makeRestRequest<void, GoogleOAuthResponse>('GET', '/auth/google/connect');\n}\n","import { type TeactNode } from '../lib/teact/teact';\n\nimport type { LangFn } from './localization';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../config';\nimport { formatStarsAsIcon, formatTonAsIcon } from './localization/format';\n\nexport function convertCurrencyFromBaseUnit(amount: number, currency: string) {\n  return amount / 10 ** getCurrencyExp(currency);\n}\n\nexport function convertCurrencyToBaseUnit(amount: number, currency: string) {\n  return amount * 10 ** getCurrencyExp(currency);\n}\n\nexport function convertTonFromNanos(nanos: number): number {\n  return convertCurrencyFromBaseUnit(nanos, TON_CURRENCY_CODE);\n}\n\nexport function convertTonToNanos(ton: number): number {\n  return convertCurrencyToBaseUnit(ton, TON_CURRENCY_CODE);\n}\n\nexport function formatCurrency(\n  lang: LangFn,\n  totalPrice: number,\n  currency: string,\n  options?: {\n    shouldOmitFractions?: boolean;\n    iconClassName?: string;\n    asFontIcon?: boolean;\n  },\n): TeactNode {\n  const price = convertCurrencyFromBaseUnit(totalPrice, currency);\n\n  if (currency === STARS_CURRENCY_CODE) {\n    return formatStarsAsIcon(lang, price, { asFont: options?.asFontIcon, className: options?.iconClassName });\n  }\n\n  if (currency === TON_CURRENCY_CODE) {\n    return formatTonAsIcon(lang, price, { className: options?.iconClassName });\n  }\n\n  return formatCurrencyAsString(totalPrice, currency, lang.code, options);\n}\n\nexport function convertTonToUsd(amount: number, usdRate: number, isInNanos: boolean = false): number {\n  const tonInRegularUnits = isInNanos ? convertTonFromNanos(amount) : amount;\n  return tonInRegularUnits * usdRate * 100;\n}\n\nexport function formatCurrencyAsString(\n  totalPrice: number,\n  currency: string,\n  locale: string = 'en',\n  options?: {\n    shouldOmitFractions?: boolean;\n  },\n) {\n  const price = convertCurrencyFromBaseUnit(totalPrice, currency);\n\n  if ((options?.shouldOmitFractions || currency === STARS_CURRENCY_CODE) && Number.isInteger(price)) {\n    return new Intl.NumberFormat(locale, {\n      style: 'currency',\n      currency,\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 0,\n    }).format(price);\n  }\n\n  if (currency === TON_CURRENCY_CODE) {\n    return new Intl.NumberFormat(locale, {\n      style: 'currency',\n      currency,\n      minimumFractionDigits: 0,\n      maximumFractionDigits: 10,\n    }).format(price);\n  }\n\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency,\n  }).format(price);\n}\n\nfunction getCurrencyExp(currency: string) {\n  if (currency === TON_CURRENCY_CODE) {\n    return 9;\n  }\n  if (currency === 'CLF') {\n    return 4;\n  }\n  if (['BHD', 'IQD', 'JOD', 'KWD', 'LYD', 'OMR', 'TND'].includes(currency)) {\n    return 3;\n  }\n  if ([\n    'BIF', 'BYR', 'CLP', 'CVE', 'DJF', 'GNF', 'ISK', 'JPY', 'KMF', 'KRW', 'MGA', 'PYG', 'RWF', 'UGX', 'UYI',\n    'VND', 'VUV', 'XAF', 'XOF', 'XPF', STARS_CURRENCY_CODE,\n  ].includes(currency)) {\n    return 0;\n  }\n  if (currency === 'MRO') {\n    return 1;\n  }\n  return 2;\n}\n","import EMOJI_REGEX from '../../lib/twemojiRegex';\nimport fixNonStandardEmoji from './fixNonStandardEmoji';\n\nconst DETECT_UP_TO = 100;\nconst MAX_LENGTH = DETECT_UP_TO * 8; // Maximum 8 code points per one emoji.\n\nexport default function parseEmojiOnlyString(text: string): number | false {\n  const standardizedText = fixNonStandardEmoji(text);\n  const lines = standardizedText.split('\\n');\n  const textWithoutNewlines = lines.join('');\n  if (textWithoutNewlines.length > MAX_LENGTH) {\n    return false;\n  }\n\n  const totalCount = countIfEmojiOnly(textWithoutNewlines);\n  if (!totalCount || totalCount > DETECT_UP_TO) {\n    return false;\n  }\n\n  // Calculate max emoji count per column or line. Used in UI to determine the size of the emoji.\n  let max = lines.length;\n  for (const line of lines) {\n    const count = countIfEmojiOnly(line);\n    if (count === false) {\n      return false;\n    }\n    if (count > max) {\n      max = count;\n    }\n  }\n\n  return max;\n}\n\nfunction countIfEmojiOnly(line: string): false | number {\n  const iterator = line.matchAll(EMOJI_REGEX);\n  let count = 0;\n  let currentIndex = 0;\n\n  for (const match of iterator) {\n    if (match.index !== currentIndex) {\n      return false;\n    }\n\n    count++;\n    currentIndex = match.index + match[0].length;\n  }\n\n  if (currentIndex !== line.length) {\n    return false;\n  }\n\n  return count;\n}\n","import type {\n  GlobalState,\n} from '../types';\n\nexport function updateAuth<T extends GlobalState>(\n  global: T, update: Partial<T['auth']>,\n): T {\n  return {\n    ...global,\n    auth: {\n      ...global.auth,\n      ...update,\n    },\n  };\n}\n","import type { OldLangFn } from '../../hooks/useOldLang';\nimport type { TimeFormat } from '../../types';\nimport type { LangFn } from '../localization';\n\nimport { getServerTime } from '../serverTime';\nimport withCache from '../withCache';\nimport { getDays, getHours, getMinutes } from './units';\n\nconst WEEKDAYS_FULL = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\nconst MONTHS_FULL = [\n  'January', 'February', 'March', 'April', 'May', 'June',\n  'July', 'August', 'September', 'October', 'November', 'December',\n];\n\nconst MONTHS_FULL_LOWERCASE = MONTHS_FULL.map((month) => month.toLowerCase());\nconst MIN_SEARCH_YEAR = 2015;\nconst MAX_DAY_IN_MONTH = 31;\nconst MAX_MONTH_IN_YEAR = 12;\nexport const MILLISECONDS_IN_DAY = 24 * 60 * 60 * 1000;\n\nexport function isToday(date: Date) {\n  return getDayStartAt(new Date()) === getDayStartAt(date);\n}\n\nexport function getDayStart(datetime: number | Date) {\n  const date = new Date(datetime);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}\n\nexport function getDayStartAt(datetime: number | Date) {\n  return getDayStart(datetime).getTime();\n}\n\nexport function toYearMonth(timestamp: number) {\n  const date = new Date(timestamp * 1000);\n  return `${date.getFullYear()}-${date.getMonth()}`;\n}\n\nfunction toIsoString(date: Date) {\n  return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;\n}\n\n// @optimization `toLocaleTimeString` is avoided because of bad performance\nexport function formatTime(lang: OldLangFn, datetime: number | Date) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  const timeFormat = lang.timeFormat || '24h';\n\n  let hours = date.getHours();\n  let marker = '';\n  if (timeFormat === '12h') {\n    marker = hours >= 12 ? '\\xa0PM' : '\\xa0AM'; // NBSP\n    hours = hours > 12 ? hours % 12 : hours;\n  }\n\n  return `${String(hours).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}${marker}`;\n}\n\nexport function formatPastTimeShort(lang: OldLangFn, datetime: number | Date, alwaysShowTime = false) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const time = formatTime(lang, date);\n\n  const today = getDayStart(new Date());\n  if (date >= today) {\n    return time;\n  }\n\n  const weekAgo = new Date(today);\n  weekAgo.setDate(today.getDate() - 7);\n  if (date >= weekAgo) {\n    const weekday = lang(`Weekday.Short${WEEKDAYS_FULL[date.getDay()]}`);\n    return alwaysShowTime ? lang('FullDateTimeFormat', [weekday, time]) : weekday;\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n\n  const formattedDate = formatDateToString(date, lang.code, noYear);\n  return alwaysShowTime ? lang('FullDateTimeFormat', [formattedDate, time]) : formattedDate;\n}\n\nexport function formatFullDate(lang: OldLangFn | LangFn, datetime: number | Date) {\n  return formatDateToString(datetime, lang.code, false, 'numeric');\n}\n\nexport function formatMonthAndYear(lang: OldLangFn | LangFn, date: Date, isShort = false) {\n  return formatDateToString(date, lang.code, false, isShort ? 'short' : 'long', true);\n}\n\nexport function formatCountdown(\n  lang: LangFn,\n  secondsLeft: number,\n) {\n  const days = getDays(secondsLeft);\n  if (secondsLeft < 0) {\n    return 0;\n  } else if (days < 1) {\n    return formatMediaDuration(secondsLeft);\n  } else if (days < 7) {\n    const count = days;\n    return lang('Days', { count }, { pluralValue: count });\n  } else if (days < 30) {\n    const count = Math.floor(days / 7);\n    return lang('Weeks', { count }, { pluralValue: count });\n  } else if (days < 365) {\n    const count = Math.floor(days / 30);\n    return lang('Months', { count }, { pluralValue: count });\n  } else {\n    const count = Math.floor(days / 365);\n    return lang('Years', { count }, { pluralValue: count });\n  }\n}\n\nexport function formatCountdownDays(\n  lang: LangFn,\n  days: number,\n) {\n  if (days < 7) {\n    return lang('Days', { count: days }, { pluralValue: days });\n  } else if (days < 30) {\n    const count = Math.floor(days / 7);\n    return lang('Weeks', { count }, { pluralValue: count });\n  } else if (days < 360) {\n    const count = Math.floor(days / 30);\n    return lang('Months', { count }, { pluralValue: count });\n  } else {\n    const count = Math.floor(days / 360);\n    return lang('Years', { count }, { pluralValue: count });\n  }\n}\n\nexport function formatCountdownShort(lang: OldLangFn, msLeft: number): string {\n  if (msLeft < 60 * 1000) {\n    return Math.ceil(msLeft / 1000).toString();\n  } else if (msLeft < 60 * 60 * 1000) {\n    return Math.ceil(msLeft / (60 * 1000)).toString();\n  } else if (msLeft < MILLISECONDS_IN_DAY) {\n    return lang('MessageTimer.ShortHours', Math.ceil(msLeft / (60 * 60 * 1000)));\n  } else {\n    return lang('MessageTimer.ShortDays', Math.ceil(msLeft / MILLISECONDS_IN_DAY));\n  }\n}\n\nexport function formatLocationLastUpdate(lang: OldLangFn, currentTime: number, lastUpdated = currentTime) {\n  const seconds = currentTime - lastUpdated;\n  if (seconds < 60) {\n    return lang('LiveLocationUpdated.JustNow');\n  } else if (seconds < 60 * 60) {\n    return lang('LiveLocationUpdated.MinutesAgo', Math.floor(seconds / 60));\n  } else {\n    return lang('LiveLocationUpdated.TodayAt', formatTime(lang, lastUpdated));\n  }\n}\n\nexport function formatRelativePastTime(lang: OldLangFn, currentTime: number, lastUpdated = currentTime) {\n  const seconds = currentTime - lastUpdated;\n\n  if (seconds < 60) {\n    return lang('Time.JustNow');\n  }\n\n  // within an hour\n  if (seconds < 60 * 60) {\n    return lang('Time.MinutesAgo', Math.floor(seconds / 60));\n  }\n\n  const lastUpdatedDate = new Date(lastUpdated * 1000);\n  const today = getDayStart(new Date());\n  if (lastUpdatedDate >= today) {\n    return lang('Time.TodayAt', formatTime(lang, lastUpdatedDate));\n  }\n\n  const yesterday = new Date(today);\n  yesterday.setDate(today.getDate() - 1);\n  if (lastUpdatedDate > yesterday) {\n    return lang('Time.YesterdayAt', formatTime(lang, lastUpdatedDate));\n  }\n\n  return lang('Time.AtDate', formatFullDate(lang, lastUpdatedDate));\n}\n\nexport function formatPastDatetime(lang: LangFn, pastTime: number, currentTime = getServerTime()) {\n  const seconds = currentTime - pastTime;\n  const minutes = getMinutes(seconds);\n  const hours = getHours(seconds);\n  const days = getDays(seconds);\n\n  if (seconds < 60) {\n    return lang('JustNowAgo');\n  }\n\n  if (minutes < 60) {\n    return lang('MinutesAgo', { count: minutes }, { pluralValue: minutes });\n  }\n\n  if (hours < 24) {\n    return lang('HoursAgo', { count: hours }, { pluralValue: hours });\n  }\n\n  if (days < 28) {\n    return lang('DaysAgo', { count: days }, { pluralValue: days });\n  }\n\n  return lang('AtDateAgo', { date: formatFullDate(lang, pastTime) });\n}\n\ntype DurationType = 'Seconds' | 'Minutes' | 'Hours' | 'Days' | 'Weeks';\n\nexport function formatTimeDuration(lang: OldLangFn, duration: number, showLast = 2) {\n  if (!duration) {\n    return undefined;\n  }\n\n  const durationRecords: { duration: number; type: DurationType }[] = [];\n  const labels = [\n    { multiplier: 1, type: 'Seconds' },\n    { multiplier: 60, type: 'Minutes' },\n    { multiplier: 60, type: 'Hours' },\n    { multiplier: 24, type: 'Days' },\n    { multiplier: 7, type: 'Weeks' },\n  ] as Array<{ multiplier: number; type: DurationType }>;\n  let t = 1;\n  labels.forEach((label, idx) => {\n    t *= label.multiplier;\n\n    if (duration < t) {\n      return;\n    }\n\n    const modulus = labels[idx === (labels.length - 1) ? idx : idx + 1].multiplier;\n    durationRecords.push({\n      duration: Math.floor((duration / t) % modulus),\n      type: label.type,\n    });\n  });\n\n  const out = durationRecords.slice(-showLast).reverse();\n  for (let i = out.length - 1; i >= 0; --i) {\n    if (out[i].duration === 0) {\n      out.splice(i, 1);\n    }\n  }\n\n  // TODO In arabic we don't use \",\" as delimiter rather we use \"and\" each time\n  return out.map((part) => lang(part.type, part.duration, 'i')).join(', ');\n}\n\nexport function formatScheduledDateTime(\n  scheduleDateTimestamp: number,\n  lang: LangFn,\n  oldLang: OldLangFn,\n): string {\n  const scheduleDate = new Date(scheduleDateTimestamp * 1000);\n\n  return lang('FormatDateAtTime', {\n    date: isToday(scheduleDate)\n      ? lang('WeekdayToday')\n      : formatHumanDate(oldLang, scheduleDateTimestamp * 1000, true, false, true),\n    time: formatTime(oldLang, scheduleDateTimestamp * 1000),\n  });\n}\n\nexport function formatHumanDate(\n  lang: OldLangFn,\n  datetime: number | Date,\n  isShort = false,\n  noWeekdays = false,\n  isUpperFirst?: boolean,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const today = getDayStart(new Date());\n\n  if (!noWeekdays) {\n    if (toIsoString(date) === toIsoString(today)) {\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(lang('Weekday.Today'));\n    }\n\n    const yesterday = new Date(today);\n    yesterday.setDate(today.getDate() - 1);\n    if (toIsoString(date) === toIsoString(yesterday)) {\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(lang('Weekday.Yesterday'));\n    }\n\n    const limitBefore = new Date(today);\n    limitBefore.setDate(today.getDate() - 6); // Avoid returning same weekday as today\n    const limitAhead = new Date(today);\n    limitAhead.setDate(today.getDate() + 6);\n\n    if (date >= limitBefore && date <= limitAhead) {\n      const weekDayString = formatWeekday(lang, date.getDay(), isShort);\n      return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(weekDayString);\n    }\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n  const formattedDate = formatDateToString(date, lang.code, noYear, isShort ? 'short' : 'long');\n\n  return (isUpperFirst || !isShort ? upperFirst : lowerFirst)(formattedDate);\n}\n\n/**\n * Returns weekday name\n * @param day 0 - Sunday, 1 - Monday, ...\n */\nexport function formatWeekday(lang: OldLangFn, day: number, isShort = false) {\n  const weekDay = WEEKDAYS_FULL[day];\n  return isShort ? lang(`Weekday.Short${weekDay}`) : lang(`Weekday.${weekDay}`);\n}\n\nexport function formatMediaDateTime(\n  lang: OldLangFn,\n  datetime: number | Date,\n  isUpperFirst?: boolean,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  return `${formatHumanDate(lang, date, true, undefined, isUpperFirst)}, ${formatTime(lang, date)}`;\n}\n\nexport function formatMediaDuration(duration: number, maxValue?: number) {\n  const hours = Math.floor(duration / 3600);\n  const minutes = Math.floor((duration % 3600) / 60);\n  const seconds = Math.floor(duration % 3600 % 60);\n\n  const maxHours = maxValue ? Math.floor(maxValue / 3600) : 0;\n  const maxMinutes = maxValue ? Math.floor((maxValue % 3600) / 60) : 0;\n  let string = '';\n  if (hours > 0 || maxHours > 0) {\n    string += `${String(hours).padStart(2, '0')}:`;\n    string += `${String(minutes).padStart(2, '0')}:`;\n  } else if (maxMinutes >= 10) {\n    string += `${String(minutes).padStart(2, '0')}:`;\n  } else {\n    string += `${String(minutes)}:`;\n  }\n  string += String(seconds).padStart(2, '0');\n\n  return string;\n}\n\nexport function formatVoiceRecordDuration(durationInMs: number) {\n  const parts = [];\n\n  let milliseconds = durationInMs % 1000;\n  durationInMs -= milliseconds;\n  milliseconds = Math.floor(milliseconds / 10);\n\n  durationInMs = Math.floor(durationInMs / 1000);\n  const seconds = durationInMs % 60;\n  durationInMs -= seconds;\n\n  durationInMs = Math.floor(durationInMs / 60);\n  const minutes = durationInMs % 60;\n  durationInMs -= minutes;\n\n  durationInMs = Math.floor(durationInMs / 60);\n  const hours = durationInMs % 60;\n\n  if (hours > 0) {\n    parts.push(String(hours).padStart(2, '0'));\n  }\n  parts.push(String(minutes).padStart(hours > 0 ? 2 : 1, '0'));\n  parts.push(String(seconds).padStart(2, '0'));\n\n  return `${parts.join(':')},${String(milliseconds).padStart(2, '0')}`;\n}\n\nconst formatDayToStringWithCache = withCache((\n  dayStartAt: number,\n  locale: string,\n  noYear?: boolean,\n  monthFormat: 'short' | 'long' | 'numeric' = 'short',\n  noDay?: boolean,\n) => {\n  return new Date(dayStartAt).toLocaleString(\n    locale,\n    {\n      year: noYear ? undefined : 'numeric',\n      month: monthFormat,\n      day: noDay ? undefined : 'numeric',\n    },\n  );\n});\n\nexport function formatDateToString(\n  datetime: Date | number,\n  locale = 'en-US',\n  noYear = false,\n  monthFormat: 'short' | 'long' | 'numeric' = 'short',\n  noDay = false,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  const dayStartAt = getDayStartAt(date);\n\n  return formatDayToStringWithCache(dayStartAt, locale, noYear, monthFormat, noDay);\n}\n\nexport function formatDateTimeToString(\n  datetime: Date | number, locale = 'en-US', noSeconds?: boolean,\n  timeFormat?: TimeFormat, noYear?: boolean,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n  return date.toLocaleString(\n    locale,\n    {\n      year: noYear ? undefined : 'numeric',\n      month: 'short',\n      day: 'numeric',\n      hour: 'numeric',\n      minute: 'numeric',\n      second: noSeconds ? undefined : 'numeric',\n      hourCycle: timeFormat === '12h' ? 'h12' : 'h23',\n    },\n  );\n}\n\nexport function formatDateAtTime(\n  lang: OldLangFn,\n  datetime: number | Date,\n) {\n  const date = typeof datetime === 'number' ? new Date(datetime) : datetime;\n\n  const today = getDayStart(new Date());\n  const time = formatTime(lang, date);\n\n  if (toIsoString(date) === toIsoString(today)) {\n    return lang('Time.TodayAt', time);\n  }\n\n  const yesterday = new Date(today);\n  yesterday.setDate(today.getDate() - 1);\n  if (toIsoString(date) === toIsoString(yesterday)) {\n    return lang('Time.YesterdayAt', time);\n  }\n\n  const noYear = date.getFullYear() === today.getFullYear();\n  const formattedDate = formatDateToString(date, lang.code, noYear);\n\n  return lang('formatDateAtTime', [formattedDate, time]);\n}\n\nexport function formatShortDuration(lang: LangFn, duration: number, hoursPriority?: boolean) {\n  if (duration < 0) {\n    return lang('RightNow');\n  }\n\n  if (duration < 60) {\n    const count = Math.ceil(duration);\n    return lang('Seconds', { count }, { pluralValue: duration });\n  }\n\n  if (duration < 60 * 60) {\n    const count = Math.ceil(duration / 60);\n    return lang('Minutes', { count }, { pluralValue: count });\n  }\n\n  if (duration < 60 * 60 * 24 || (hoursPriority && duration <= 60 * 60 * 24 * 2)) {\n    const count = Math.ceil(duration / (60 * 60));\n    return lang('Hours', { count }, { pluralValue: count });\n  }\n\n  const count = Math.ceil(duration / (60 * 60 * 24));\n  return lang('Days', { count }, { pluralValue: count });\n}\n\nfunction isValidDate(day: number, month: number, year = 2021): boolean {\n  if (month > (MAX_MONTH_IN_YEAR - 1) || day > MAX_DAY_IN_MONTH) {\n    return false;\n  }\n  const date = new Date(year, month, day);\n  return !Number.isNaN(date.getTime()) && date.getDate() === day;\n}\n\nexport function parseDateString(query = ''): string | undefined {\n  const matchStringDate = query.match(/\\d{1,2}\\s[a-zA-Z]{3,}/);\n  const matchEuropeStringDate = query.match(/[a-zA-Z]{3,}\\s\\d{1,2}/);\n  const matchNumberDate = query.match(/\\d{1,2}[./-]\\d{1,2}([./-]\\d{2,4})?/);\n  if (!matchStringDate && !matchNumberDate && !matchEuropeStringDate) {\n    return undefined;\n  }\n\n  if (matchNumberDate) {\n    const [date, month, year] = query.split(/[./-]/).map(Number);\n    return !(year && year < MIN_SEARCH_YEAR) && isValidDate(date, month - 1, year || undefined)\n      ? `${year ? `${year}-` : ''}${String(month).padStart(2, '0')}-${String(date).padStart(2, '0')}`\n      : undefined;\n  }\n\n  const dateParts = query.split(' ');\n  const date = matchStringDate ? dateParts[0] : dateParts[1];\n  const month = (matchStringDate ? dateParts[1] : dateParts[0]).toLowerCase();\n  const monthIndex = MONTHS_FULL_LOWERCASE.findIndex((item) => item.startsWith(month));\n\n  return monthIndex !== -1 && isValidDate(Number(date), monthIndex)\n    ? `${String(monthIndex + 1).padStart(2, '0')}-${String(date).padStart(2, '0')}`\n    : undefined;\n}\n\nexport function timestampPlusDay(timestamp: number) {\n  return timestamp + MILLISECONDS_IN_DAY / 1000;\n}\n\nfunction lowerFirst(str: string) {\n  return `${str[0].toLowerCase()}${str.slice(1)}`;\n}\n\nfunction upperFirst(str: string) {\n  return `${str[0].toUpperCase()}${str.slice(1)}`;\n}\n\nexport function formatRegistrationMonth(lang: string, dateString: string) {\n  const [month, year] = dateString.split('.');\n  const date = new Date(`${year}-${month}`);\n\n  return new Intl.DateTimeFormat(lang, { month: 'long', year: 'numeric' }).format(date);\n}\n","import { useCallback } from '../lib/teact/teact';\n\nimport { useStateRef } from './useStateRef';\n\nexport default function useLastCallback<T extends AnyFunction>(callback?: T) {\n  const ref = useStateRef(callback);\n\n  // No need for ref dependency\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  return useCallback((...args: Parameters<T>) => ref.current?.(...args), []) as T;\n}\n","import type { ElementRef, FC } from '../../lib/teact/teact';\nimport {\n  getIsHeavyAnimating,\n  memo,\n  useEffect,\n  useRef,\n  useState,\n  useUnmountCleanup,\n} from '../../lib/teact/teact';\n\nimport type RLottieInstance from '../../lib/rlottie/RLottie';\n\nimport { requestMeasure } from '../../lib/fasterdom/fasterdom';\nimport { ensureRLottie, getRLottie } from '../../lib/rlottie/RLottie.async';\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\nimport { hex2rgbaObj } from '../../util/colors.ts';\nimport generateUniqueId from '../../util/generateUniqueId';\n\nimport useColorFilter from '../../hooks/stickers/useColorFilter';\nimport useEffectWithPrevDeps from '../../hooks/useEffectWithPrevDeps';\nimport useFlag from '../../hooks/useFlag';\nimport useHeavyAnimation from '../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport usePriorityPlaybackCheck, { isPriorityPlaybackActive } from '../../hooks/usePriorityPlaybackCheck';\nimport useSharedIntersectionObserver from '../../hooks/useSharedIntersectionObserver';\nimport { useStateRef } from '../../hooks/useStateRef';\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useThrottledCallback from '../../hooks/useThrottledCallback';\nimport useUniqueId from '../../hooks/useUniqueId';\nimport useBackgroundMode, { isBackgroundModeActive } from '../../hooks/window/useBackgroundMode';\n\nexport type OwnProps = {\n  ref?: ElementRef<HTMLDivElement>;\n  renderId?: string;\n  className?: string;\n  style?: string;\n  tgsUrl?: string;\n  play?: boolean | string;\n  playSegment?: [number, number];\n  speed?: number;\n  noLoop?: boolean;\n  size: number;\n  quality?: number;\n  color?: string;\n  isLowPriority?: boolean;\n  forceAlways?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  sharedCanvas?: HTMLCanvasElement;\n  sharedCanvasCoords?: { x: number; y: number };\n  onClick?: NoneToVoidFunction;\n  onMouseEnter?: NoneToVoidFunction;\n  onMouseLeave?: NoneToVoidFunction;\n  onLoad?: NoneToVoidFunction;\n  onEnded?: NoneToVoidFunction;\n  onLoop?: NoneToVoidFunction;\n};\n\nconst THROTTLE_MS = 150;\n\nconst AnimatedSticker: FC<OwnProps> = ({\n  ref,\n  renderId,\n  className,\n  style,\n  tgsUrl,\n  play,\n  playSegment,\n  speed,\n  noLoop,\n  size,\n  quality,\n  isLowPriority,\n  color,\n  forceAlways,\n  forceOnHeavyAnimation,\n  sharedCanvas,\n  sharedCanvasCoords,\n  onClick,\n  onMouseEnter,\n  onMouseLeave,\n  onLoad,\n  onEnded,\n  onLoop,\n}) => {\n  let containerRef = useRef<HTMLDivElement>();\n  if (ref) {\n    containerRef = ref;\n  }\n\n  const viewId = useUniqueId();\n\n  const [animation, setAnimation] = useState<RLottieInstance>();\n  const animationRef = useRef<RLottieInstance>();\n  const isFirstRender = useRef(true);\n\n  const shouldUseColorFilter = !sharedCanvas && color;\n  const colorFilter = useColorFilter(shouldUseColorFilter ? color : undefined);\n\n  const playKey = play || (play === false ? false : playSegment);\n  const playRef = useStateRef(play);\n  const playSegmentRef = useStateRef(playSegment);\n\n  const rgbColor = useRef<[number, number, number] | undefined>();\n\n  const shouldForceOnHeavyAnimation = forceAlways || forceOnHeavyAnimation;\n  // Delay initialization until heavy animation ends\n  const [\n    canInitialize, markCanInitialize, unmarkCanInitialize,\n  ] = useFlag(!getIsHeavyAnimating() || shouldForceOnHeavyAnimation);\n  useHeavyAnimation(unmarkCanInitialize, markCanInitialize, shouldForceOnHeavyAnimation);\n  useEffect(() => {\n    if (shouldForceOnHeavyAnimation) markCanInitialize();\n  }, [shouldForceOnHeavyAnimation]);\n\n  useSyncEffect(() => {\n    if (color && !shouldUseColorFilter) {\n      const { r, g, b } = hex2rgbaObj(color);\n      rgbColor.current = [r, g, b];\n    } else {\n      rgbColor.current = undefined;\n    }\n  }, [color, shouldUseColorFilter]);\n\n  const isUnmountedRef = useRef(false);\n  useUnmountCleanup(() => {\n    isUnmountedRef.current = true;\n  });\n\n  const init = useLastCallback(() => {\n    if (\n      animationRef.current\n      || isUnmountedRef.current\n      || !tgsUrl\n      || (sharedCanvas && (!sharedCanvasCoords || !sharedCanvas.offsetWidth || !sharedCanvas.offsetHeight))\n      || (getIsHeavyAnimating() && !shouldForceOnHeavyAnimation)\n    ) {\n      return;\n    }\n\n    const container = containerRef.current || sharedCanvas;\n    if (!container) {\n      return;\n    }\n\n    const newAnimation = getRLottie().init(\n      tgsUrl,\n      container,\n      renderId || generateUniqueId(),\n      {\n        size,\n        noLoop,\n        quality,\n        isLowPriority,\n        coords: sharedCanvasCoords,\n      },\n      viewId,\n      rgbColor.current,\n      onLoad,\n      onEnded,\n      onLoop,\n    );\n\n    if (speed) {\n      newAnimation.setSpeed(speed);\n    }\n\n    setAnimation(newAnimation);\n    animationRef.current = newAnimation;\n  });\n\n  useEffect(() => {\n    if (!canInitialize) return;\n    if (getRLottie()) {\n      init();\n    } else {\n      ensureRLottie().then(init);\n    }\n  }, [init, tgsUrl, sharedCanvas, sharedCanvasCoords, canInitialize]);\n\n  const throttledInit = useThrottledCallback(init, [init], THROTTLE_MS);\n  useSharedIntersectionObserver(sharedCanvas, throttledInit);\n\n  useEffect(() => {\n    animation?.setColor(rgbColor.current);\n  }, [color, animation]);\n\n  useEffect(() => {\n    if (typeof speed === 'number') {\n      animation?.setSpeed(speed);\n    }\n  }, [speed, animation]);\n\n  useUnmountCleanup(() => {\n    animationRef.current?.removeView(viewId);\n  });\n\n  const playAnimation = useLastCallback((shouldRestart = false) => {\n    if (\n      !animation\n      || !(playRef.current || playSegmentRef.current)\n      || isFrozen(forceAlways)\n    ) {\n      return;\n    }\n\n    if (playSegmentRef.current) {\n      animation.playSegment(playSegmentRef.current, shouldRestart, viewId);\n    } else {\n      animation.play(shouldRestart, viewId);\n    }\n  });\n\n  const playAnimationOnRaf = useLastCallback(() => {\n    requestMeasure(playAnimation);\n  });\n\n  const pauseAnimation = useLastCallback(() => {\n    if (animation?.isPlaying()) {\n      animation.pause(viewId);\n    }\n  });\n\n  useEffectWithPrevDeps(([prevNoLoop]) => {\n    if (prevNoLoop !== undefined && noLoop !== prevNoLoop) {\n      animation?.setNoLoop(noLoop);\n    }\n  }, [noLoop, animation]);\n\n  useEffectWithPrevDeps(([prevSharedCanvasCoords]) => {\n    if (prevSharedCanvasCoords !== undefined && sharedCanvasCoords !== prevSharedCanvasCoords) {\n      animation?.setSharedCanvasCoords(viewId, sharedCanvasCoords);\n    }\n  }, [sharedCanvasCoords, viewId, animation]);\n\n  useEffect(() => {\n    if (!animation) {\n      return;\n    }\n\n    if (playKey) {\n      if (!isFrozen(forceAlways, forceOnHeavyAnimation)) {\n        playAnimation(noLoop);\n      }\n    } else {\n      pauseAnimation();\n    }\n  }, [animation, playKey, noLoop, playAnimation, pauseAnimation, forceAlways, forceOnHeavyAnimation]);\n\n  useEffect(() => {\n    if (animation) {\n      if (isFirstRender.current) {\n        isFirstRender.current = false;\n      } else if (tgsUrl) {\n        animation.changeData(tgsUrl);\n        playAnimation();\n      }\n    }\n  }, [playAnimation, animation, tgsUrl]);\n\n  useHeavyAnimation(pauseAnimation, playAnimation, !playKey || shouldForceOnHeavyAnimation);\n  usePriorityPlaybackCheck(pauseAnimation, playAnimation, !playKey || forceAlways);\n  // Pausing frame may not happen in background,\n  // so we need to make sure it happens right after focusing,\n  // then we can play again.\n  useBackgroundMode(pauseAnimation, playAnimationOnRaf, !playKey || forceAlways);\n\n  if (sharedCanvas) {\n    return undefined;\n  }\n\n  return (\n    <div\n      ref={containerRef}\n      className={buildClassName('AnimatedSticker', className)}\n      style={buildStyle(\n        size !== undefined && `width: ${size}px; height: ${size}px;`,\n        onClick && !IS_TAURI && 'cursor: pointer',\n        colorFilter,\n        style,\n      )}\n      onClick={onClick}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n    />\n  );\n};\n\nexport default memo(AnimatedSticker);\n\nfunction isFrozen(forceAlways = false, forceOnHeavyAnimation = false) {\n  if (forceAlways) return false;\n  return (!forceOnHeavyAnimation && getIsHeavyAnimating()) || isPriorityPlaybackActive() || isBackgroundModeActive();\n}\n","import type { AriaRole } from 'react';\nimport type { ElementRef } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\n\nimport type { IconName } from '../../../types/icons';\n\nimport buildClassName from '../../../util/buildClassName';\n\ntype OwnProps = {\n  name: IconName;\n  className?: string;\n  style?: string;\n  role?: AriaRole;\n  ariaLabel?: string;\n  character?: string;\n  ref?: ElementRef<HTMLElement>;\n  onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\n};\n\nconst Icon = ({\n  name,\n  ref,\n  className,\n  style,\n  role,\n  ariaLabel,\n  character,\n  onClick,\n}: OwnProps) => {\n  return (\n    <i\n      ref={ref}\n      className={buildClassName(`icon icon-${name}`, className)}\n      style={style}\n      aria-hidden={!ariaLabel}\n      aria-label={ariaLabel}\n      data-char={character}\n      role={role}\n      onClick={onClick}\n    />\n  );\n};\n\nexport default Icon;\n","import {\n  type TeactNode,\n  useRef,\n} from '../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useCollapsibleLines from '../../hooks/element/useCollapsibleLines';\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Icon from './icons/Icon';\n\nimport styles from './Blockquote.module.scss';\n\ntype OwnProps = {\n  canBeCollapsible?: boolean;\n  isToggleDisabled?: boolean;\n  children: TeactNode;\n};\n\nconst MAX_LINES = 4;\n\nconst Blockquote = ({ canBeCollapsible, isToggleDisabled, children }: OwnProps) => {\n  const ref = useRef<HTMLQuoteElement>();\n  const {\n    isCollapsed, isCollapsible, setIsCollapsed,\n  } = useCollapsibleLines(ref, MAX_LINES, undefined, !canBeCollapsible);\n\n  const canExpand = !isToggleDisabled && isCollapsed;\n\n  const handleExpand = useLastCallback(() => {\n    setIsCollapsed(false);\n  });\n\n  const handleToggle = useLastCallback(() => {\n    setIsCollapsed((prev) => !prev);\n  });\n\n  return (\n    <span\n      className={buildClassName(styles.root, isCollapsed && styles.collapsed)}\n      onClick={canExpand ? handleExpand : undefined}\n    >\n      <blockquote\n        className={styles.blockquote}\n        ref={ref}\n        data-entity-type={ApiMessageEntityTypes.Blockquote}\n      >\n        <div className={styles.gradientContainer}>\n          {children}\n        </div>\n        {isCollapsible && (\n          <div\n            className={buildClassName(styles.collapseIcon, !isToggleDisabled && styles.clickable)}\n            onClick={!isToggleDisabled ? handleToggle : undefined}\n            aria-hidden\n          >\n            <Icon name={isCollapsed ? 'down' : 'up'} />\n          </div>\n        )}\n      </blockquote>\n    </span>\n  );\n};\n\nexport default Blockquote;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"KU67Uur0\",\"collapsed\":\"y_uRZXtA\",\"blockquote\":\"m3sD7_cn\",\"gradientContainer\":\"JNVT2DU9\",\"collapseIcon\":\"pyX4NpPB\",\"clickable\":\"RmvXwV0W\"};","const PRETTY_BY_ALIAS: Record<string, string | undefined> = {\n  js: 'JavaScript',\n  javascript: 'JavaScript',\n  ts: 'TypeScript',\n  typescript: 'TypeScript',\n  python: 'Python',\n  py: 'Python',\n  go: 'Go',\n  rust: 'Rust',\n  func: 'FunC',\n  c: 'C',\n  'c++': 'C++',\n  cpp: 'C++',\n  fortran: 'Fortran',\n  f90: 'Fortran',\n  f: 'Fortran',\n  java: 'Java',\n  sql: 'SQL',\n  swift: 'Swift',\n  'objective-c': 'Objective-C',\n  kotlin: 'Kotlin',\n  ruby: 'Ruby',\n  rb: 'Ruby',\n  php: 'PHP',\n  perl: 'Perl',\n  bash: 'Bash',\n  sh: 'Shell',\n  markdown: 'Markdown',\n  'c#': 'C#',\n  cs: 'C#',\n  json: 'JSON',\n  yaml: 'YAML',\n  yml: 'YAML',\n  solidity: 'Solidity',\n  sol: 'Solidity',\n  tl: 'TL',\n};\n\nexport function getPrettyCodeLanguageName(codeLanguage: string) {\n  const prettyLangName = PRETTY_BY_ALIAS[codeLanguage.toLowerCase()];\n  return prettyLangName ?? codeLanguage;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"overlay\":\"pMUccFN9\",\"copy\":\"auCNtLQ4\",\"wrap\":\"a44ZN3hD\",\"wrapOn\":\"jq1KLfVD\",\"content\":\"L95Dh7wN\",\"hidden\":\"zctwFUQ8\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useCallback, useEffect, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { areLinesWrapping } from '../helpers/renderText';\n\nimport useOldLang from '../../../hooks/useOldLang';\nimport useWindowSize from '../../../hooks/window/useWindowSize';\n\nimport Icon from '../icons/Icon';\n\nimport styles from './CodeOverlay.module.scss';\n\nexport type OwnProps = {\n  className?: string;\n  text: string;\n  noCopy?: boolean;\n  onWordWrapToggle?: (wrap: boolean) => void;\n};\n\nconst CodeOverlay: FC<OwnProps> = ({\n  text, className, noCopy, onWordWrapToggle,\n}) => {\n  const { showNotification } = getActions();\n  const ref = useRef<HTMLDivElement>();\n  const windowSize = useWindowSize();\n  const lang = useOldLang();\n  const [isWordWrap, setIsWordWrap] = useState(true);\n  const [withWordWrapButton, setWithWordWrapButton] = useState(false);\n\n  const checkWordWrap = useCallback(() => {\n    const isWrap = areLinesWrapping(text, ref.current!.parentElement!);\n    setWithWordWrapButton(isWrap);\n  }, [text]);\n\n  useEffect(() => {\n    if (isWordWrap) {\n      checkWordWrap();\n    }\n  }, [checkWordWrap, isWordWrap, text, windowSize]);\n\n  const handleCopy = useCallback(() => {\n    copyTextToClipboard(text);\n    showNotification({\n      message: lang('TextCopied'),\n    });\n  }, [lang, showNotification, text]);\n\n  const handleWordWrapClick = useCallback(() => {\n    setIsWordWrap(!isWordWrap);\n    onWordWrapToggle?.(!isWordWrap);\n  }, [isWordWrap, onWordWrapToggle]);\n\n  const contentClass = buildClassName(styles.content, !withWordWrapButton && noCopy && styles.hidden);\n  const overlayClass = buildClassName(styles.overlay, className);\n  const wrapClass = buildClassName(styles.wrap, isWordWrap && styles.wrapOn);\n\n  return (\n    <div className={overlayClass} ref={ref}>\n      <div className={contentClass}>\n        {withWordWrapButton && (\n          <div className={wrapClass} onClick={handleWordWrapClick} title=\"Word Wrap\">\n            <Icon name=\"word-wrap\" />\n          </div>\n        )}\n        {!noCopy && (\n          <div className={styles.copy} onClick={handleCopy} title={lang('Copy')}>\n            <Icon name=\"copy\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(CodeOverlay);\n","import type { FC } from '../../../lib/teact/teact';\nimport { memo, useCallback, useState } from '../../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { getPrettyCodeLanguageName } from '../../../util/prettyCodeLanguageNames';\n\nimport useAsync from '../../../hooks/useAsync';\n\nimport PeerColorWrapper from '../PeerColorWrapper';\nimport CodeOverlay from './CodeOverlay';\n\nimport './CodeBlock.scss';\n\nexport type OwnProps = {\n  text: string;\n  language?: string;\n  noCopy?: boolean;\n};\n\nconst CodeBlock: FC<OwnProps> = ({ text, language, noCopy }) => {\n  const [isWordWrap, setWordWrap] = useState(true);\n\n  const { result: highlighted } = useAsync(() => {\n    if (!language) return Promise.resolve(undefined);\n    return import('../../../util/highlightCode')\n      .then((lib) => lib.default(text, language));\n  }, [language, text]);\n\n  const handleWordWrapToggle = useCallback((wrap) => {\n    setWordWrap(wrap);\n  }, []);\n\n  const blockClass = buildClassName(\n    'code-block',\n    !isWordWrap && 'no-word-wrap',\n  );\n\n  return (\n    <PeerColorWrapper\n      className=\"CodeBlock\"\n    >\n      {language && (<p className=\"code-title\">{getPrettyCodeLanguageName(language)}</p>)}\n      <pre className={blockClass} data-entity-type={ApiMessageEntityTypes.Pre} data-language={language}>\n        {highlighted ?? text}\n        <CodeOverlay\n          text={text}\n          className=\"code-overlay\"\n          onWordWrapToggle={handleWordWrapToggle}\n          noCopy={noCopy}\n        />\n      </pre>\n    </PeerColorWrapper>\n  );\n};\n\nexport default memo(CodeBlock);\n","import type { TeactNode } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\nimport { memo, useEffect, useRef } from '../../../lib/teact/teact';\n\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport { createClassNameBuilder } from '../../../util/buildClassName';\nimport stopEvent from '../../../util/stopEvent';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport './Spoiler.scss';\n\ntype OwnProps = {\n  children?: TeactNode;\n  containerId?: string;\n};\n\nconst revealByContainerId = new Map<string, VoidFunction[]>();\n\nconst buildClassName = createClassNameBuilder('Spoiler');\n\nconst Spoiler = ({\n  children,\n  containerId,\n}: OwnProps) => {\n  const contentRef = useRef<HTMLDivElement>();\n\n  const [isRevealed, revealSpoiler] = useFlag();\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (!containerId) return;\n\n    if (!isRevealed) {\n      stopEvent(e);\n    }\n\n    revealByContainerId.get(containerId)?.forEach((reveal) => reveal());\n  });\n\n  useEffect(() => {\n    if (!containerId) {\n      return undefined;\n    }\n\n    if (revealByContainerId.has(containerId)) {\n      revealByContainerId.get(containerId)!.push(revealSpoiler);\n    } else {\n      revealByContainerId.set(containerId, [revealSpoiler]);\n    }\n\n    return () => {\n      revealByContainerId.delete(containerId);\n    };\n  }, [containerId]);\n\n  return (\n    <span\n      className={buildClassName(\n        '&',\n        !isRevealed && 'concealed',\n        !isRevealed && Boolean(containerId) && 'animated',\n      )}\n      onClick={containerId && !isRevealed ? handleClick : undefined}\n      data-entity-type={ApiMessageEntityTypes.Spoiler}\n    >\n      <span className={buildClassName('content')} ref={contentRef}>\n        {children}\n      </span>\n    </span>\n  );\n};\n\nexport default memo(Spoiler);\n","import type { ElementRef } from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport type { ApiFormattedText, ApiMessageEntity } from '../../../api/types';\nimport type { ObserveFn } from '../../../hooks/useIntersectionObserver';\nimport type { TextPart, ThreadId } from '../../../types';\nimport type { TextFilter } from './renderText';\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport buildClassName from '../../../util/buildClassName';\nimport { copyTextToClipboard } from '../../../util/clipboard';\nimport { buildCustomEmojiHtmlFromEntity } from '../../middle/composer/helpers/customEmoji';\nimport renderText from './renderText';\n\nimport MentionLink from '../../middle/message/MentionLink';\nimport Blockquote from '../Blockquote';\nimport CodeBlock from '../code/CodeBlock';\nimport CustomEmoji from '../CustomEmoji';\nimport SafeLink from '../SafeLink';\nimport Spoiler from '../spoiler/Spoiler';\n\ninterface IOrganizedEntity {\n  entity: ApiMessageEntity;\n  organizedIndexes: Set<number>;\n  nestedEntities: IOrganizedEntity[];\n}\ntype RenderTextParams = Parameters<typeof renderText>[2];\n\nconst HQ_EMOJI_THRESHOLD = 64;\n\nexport function renderTextWithEntities({\n  text,\n  entities,\n  highlight,\n  emojiSize,\n  shouldRenderAsHtml,\n  containerId,\n  asPreview,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  cacheBuster,\n  forcePlayback,\n  noCustomEmojiPlayback,\n  isInSelectMode,\n  chatId,\n  messageId,\n  threadId,\n  maxTimestamp,\n}: {\n  text: string;\n  entities?: ApiMessageEntity[];\n  highlight?: string;\n  emojiSize?: number;\n  shouldRenderAsHtml?: boolean;\n  containerId?: string;\n  asPreview?: boolean;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  sharedCanvasRef?: ElementRef<HTMLCanvasElement>;\n  sharedCanvasHqRef?: ElementRef<HTMLCanvasElement>;\n  cacheBuster?: string;\n  forcePlayback?: boolean;\n  noCustomEmojiPlayback?: boolean;\n  isInSelectMode?: boolean;\n  chatId?: string;\n  messageId?: number;\n  threadId?: ThreadId;\n  maxTimestamp?: number;\n}) {\n  if (!entities?.length) {\n    return renderMessagePart({\n      content: text,\n      highlight,\n      emojiSize,\n      shouldRenderAsHtml,\n      asPreview,\n    });\n  }\n\n  const result: TextPart[] = [];\n  let deleteLineBreakAfterPre = false;\n\n  const organizedEntities = organizeEntities(entities);\n\n  // Recursive function to render regular and nested entities\n  function renderEntity(\n    textPartStart: number,\n    textPartEnd: number,\n    organizedEntity: IOrganizedEntity,\n    isLastEntity: boolean,\n  ) {\n    const renderResult: TextPart[] = [];\n    const { entity, nestedEntities } = organizedEntity;\n    const { offset, length, type } = entity;\n\n    // Render text before the entity\n    let textBefore = text.substring(textPartStart, offset);\n    const textBeforeLength = textBefore.length;\n    if (textBefore) {\n      if (deleteLineBreakAfterPre && textBefore.length > 0 && textBefore[0] === '\\n') {\n        textBefore = textBefore.substr(1);\n        deleteLineBreakAfterPre = false;\n      }\n      if (textBefore) {\n        renderResult.push(...renderMessagePart({\n          content: textBefore,\n          highlight,\n          emojiSize,\n          shouldRenderAsHtml,\n          asPreview,\n        }));\n      }\n    }\n\n    const entityStartIndex = textPartStart + textBeforeLength;\n    const entityEndIndex = entityStartIndex + length;\n\n    let entityContent: TextPart = text.substring(offset, offset + length);\n    const nestedEntityContent: TextPart[] = [];\n\n    if (deleteLineBreakAfterPre && entityContent.length > 0 && entityContent[0] === '\\n') {\n      entityContent = entityContent.substr(1);\n      deleteLineBreakAfterPre = false;\n    }\n\n    if (type === ApiMessageEntityTypes.Pre) {\n      deleteLineBreakAfterPre = true;\n    }\n\n    // Render nested entities, if any\n    if (nestedEntities.length) {\n      let nestedIndex = entityStartIndex;\n\n      nestedEntities.forEach((nestedEntity, nestedEntityIndex) => {\n        const {\n          renderResult: nestedResult,\n          entityEndIndex: nestedEntityEndIndex,\n        } = renderEntity(\n          nestedIndex,\n          entityEndIndex,\n          nestedEntity,\n          nestedEntityIndex === nestedEntities.length - 1,\n        );\n\n        nestedEntityContent.push(...nestedResult);\n        nestedIndex = nestedEntityEndIndex;\n      });\n    }\n\n    // Render the entity itself\n    const newEntity = shouldRenderAsHtml\n      ? processEntityAsHtml(entity, entityContent, nestedEntityContent)\n      : processEntity({\n        entity,\n        entityContent,\n        nestedEntityContent,\n        highlight,\n        containerId,\n        asPreview,\n        isProtected,\n        observeIntersectionForLoading,\n        observeIntersectionForPlaying,\n        withTranslucentThumbs,\n        emojiSize,\n        sharedCanvasRef,\n        sharedCanvasHqRef,\n        cacheBuster,\n        forcePlayback,\n        noCustomEmojiPlayback,\n        isInSelectMode,\n        chatId,\n        messageId,\n        threadId,\n        maxTimestamp,\n      });\n\n    if (Array.isArray(newEntity)) {\n      renderResult.push(...newEntity);\n    } else {\n      renderResult.push(newEntity);\n    }\n\n    // Render text after the entity, if it is the last entity in the text,\n    // or the last nested entity inside of another entity\n    if (isLastEntity && entityEndIndex < textPartEnd) {\n      let textAfter = text.substring(entityEndIndex, textPartEnd);\n      if (deleteLineBreakAfterPre && textAfter.length > 0 && textAfter[0] === '\\n') {\n        textAfter = textAfter.substring(1);\n      }\n      if (textAfter) {\n        renderResult.push(...renderMessagePart({\n          content: textAfter,\n          highlight,\n          emojiSize,\n          shouldRenderAsHtml,\n          asPreview,\n        }));\n      }\n    }\n\n    return {\n      renderResult,\n      entityEndIndex,\n    };\n  }\n\n  // Process highest-level entities\n  let index = 0;\n\n  organizedEntities.forEach((entity, arrayIndex) => {\n    const { renderResult, entityEndIndex } = renderEntity(\n      index,\n      text.length,\n      entity,\n      arrayIndex === organizedEntities.length - 1,\n    );\n\n    result.push(...renderResult);\n    index = entityEndIndex;\n  });\n\n  return result;\n}\n\nexport function getTextWithEntitiesAsHtml(formattedText?: ApiFormattedText) {\n  const { text, entities } = formattedText || {};\n  if (!text) {\n    return '';\n  }\n\n  const result = renderTextWithEntities({\n    text,\n    entities,\n    shouldRenderAsHtml: true,\n  }) as string[];\n\n  if (Array.isArray(result)) {\n    return result.join('');\n  }\n\n  return result;\n}\n\nfunction renderMessagePart({\n  content,\n  highlight,\n  focusedQuote,\n  emojiSize,\n  shouldRenderAsHtml,\n  asPreview,\n}: {\n  content: TextPart | TextPart[];\n  highlight?: string;\n  focusedQuote?: string;\n  emojiSize?: number;\n  shouldRenderAsHtml?: boolean;\n  asPreview?: boolean;\n}) {\n  if (Array.isArray(content)) {\n    const result: TextPart[] = [];\n\n    content.forEach((c) => {\n      result.push(...renderMessagePart({\n        content: c,\n        highlight,\n        focusedQuote,\n        emojiSize,\n        shouldRenderAsHtml,\n        asPreview,\n      }));\n    });\n\n    return result;\n  }\n\n  if (shouldRenderAsHtml) {\n    return renderText(content, ['escape_html', 'emoji_html', 'br_html']);\n  }\n\n  const emojiFilter = emojiSize && emojiSize > HQ_EMOJI_THRESHOLD ? 'hq_emoji' : 'emoji';\n\n  const filters: TextFilter[] = [emojiFilter];\n  const params: RenderTextParams = {};\n  if (!asPreview) {\n    filters.push('br');\n  }\n\n  if (highlight) {\n    filters.push('highlight');\n    params.highlight = highlight;\n  }\n\n  return renderText(content, filters, params);\n}\n\nexport function insertTextEntities(entities: ApiMessageEntity[], newEntities: ApiMessageEntity[]) {\n  return newEntities.reduce((acc, newEntity) => {\n    return insertTextEntity(acc, newEntity);\n  }, entities);\n}\n\nexport function insertTextEntity(entities: ApiMessageEntity[], newEntity: ApiMessageEntity) {\n  const resultEntities: ApiMessageEntity[] = [];\n\n  const newEntityStart = newEntity.offset;\n  const newEntityEnd = newEntity.offset + newEntity.length;\n\n  for (const existingEntity of entities) {\n    const existingEntityStart = existingEntity.offset;\n    const existingEntityEnd = existingEntity.offset + existingEntity.length;\n    // Push as is if edges do not overlap\n    if (existingEntityEnd <= newEntityStart\n      || existingEntityStart > newEntityEnd\n      || (existingEntityStart > newEntityStart\n        && existingEntityEnd < newEntityEnd)\n      || (existingEntityStart === newEntityStart && existingEntityEnd === newEntityEnd)) {\n      resultEntities.push(existingEntity);\n      continue;\n    }\n\n    // If start edge overlaps\n    if (existingEntityStart < newEntityStart && existingEntityEnd > newEntityStart) {\n      // Split entity in two\n      resultEntities.push({\n        ...existingEntity,\n        length: newEntityStart - existingEntityStart,\n      });\n      resultEntities.push({\n        ...existingEntity,\n        offset: newEntityStart,\n        length: existingEntityEnd - newEntityStart,\n      });\n    }\n\n    // If end edge overlaps\n    if (existingEntityStart < newEntityEnd\n      && existingEntityEnd > newEntityEnd) {\n      // Split entity in two\n      resultEntities.push({\n        ...existingEntity,\n        offset: newEntityEnd,\n        length: existingEntityEnd - newEntityStart - newEntity.length,\n      });\n      resultEntities.push({\n        ...existingEntity,\n        length: newEntityEnd - existingEntityStart,\n      });\n    }\n  }\n\n  resultEntities.push(newEntity);\n  // Sort entities by offset, longer entities first\n  return resultEntities.sort((a, b) => a.offset - b.offset || b.length - a.length);\n}\n\n// Organize entities in a tree-like structure to better represent how the text will be displayed\nfunction organizeEntities(entities: ApiMessageEntity[]) {\n  const organizedEntityIndexes = new Set<number>();\n  const organizedEntities: IOrganizedEntity[] = [];\n\n  entities.forEach((entity, index) => {\n    if (organizedEntityIndexes.has(index)) {\n      return;\n    }\n\n    const organizedEntity = organizeEntity(entity, index, entities, organizedEntityIndexes);\n    if (organizedEntity) {\n      organizedEntity.organizedIndexes.forEach((organizedIndex) => {\n        organizedEntityIndexes.add(organizedIndex);\n      });\n\n      organizedEntities.push(organizedEntity);\n    }\n  });\n\n  return organizedEntities;\n}\n\nfunction organizeEntity(\n  entity: ApiMessageEntity,\n  index: number,\n  entities: ApiMessageEntity[],\n  organizedEntityIndexes: Set<number>,\n): IOrganizedEntity | undefined {\n  const { offset, length } = entity;\n  const organizedIndexes = new Set([index]);\n\n  if (organizedEntityIndexes.has(index)) {\n    return undefined;\n  }\n\n  // Determine any nested entities inside current entity\n  const nestedEntities: IOrganizedEntity[] = [];\n  const parsedNestedEntities = entities\n    .filter((e, i) => i > index && e.offset >= offset && e.offset < offset + length)\n    .map((e) => organizeEntity(e, entities.indexOf(e), entities, organizedEntityIndexes))\n    .filter(Boolean);\n\n  parsedNestedEntities.forEach((parsedEntity) => {\n    let isChanged = false;\n\n    parsedEntity.organizedIndexes.forEach((organizedIndex) => {\n      if (!isChanged && !organizedIndexes.has(organizedIndex)) {\n        isChanged = true;\n      }\n\n      organizedIndexes.add(organizedIndex);\n    });\n\n    if (isChanged) {\n      nestedEntities.push(parsedEntity);\n    }\n  });\n\n  return {\n    entity,\n    organizedIndexes,\n    nestedEntities,\n  };\n}\n\nfunction processEntity({\n  entity,\n  entityContent,\n  nestedEntityContent,\n  highlight,\n  containerId,\n  asPreview,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  emojiSize,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  cacheBuster,\n  forcePlayback,\n  noCustomEmojiPlayback,\n  isInSelectMode,\n  chatId,\n  messageId,\n  threadId,\n  maxTimestamp,\n}: {\n  entity: ApiMessageEntity;\n  entityContent: TextPart;\n  nestedEntityContent: TextPart[];\n  highlight?: string;\n  focusedQuote?: string;\n  containerId?: string;\n  asPreview?: boolean;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  emojiSize?: number;\n  sharedCanvasRef?: ElementRef<HTMLCanvasElement>;\n  sharedCanvasHqRef?: ElementRef<HTMLCanvasElement>;\n  cacheBuster?: string;\n  forcePlayback?: boolean;\n  noCustomEmojiPlayback?: boolean;\n  isInSelectMode?: boolean;\n  chatId?: string;\n  messageId?: number;\n  threadId?: ThreadId;\n  maxTimestamp?: number;\n}) {\n  const entityText = typeof entityContent === 'string' && entityContent;\n  const renderedContent = nestedEntityContent.length ? nestedEntityContent : entityContent;\n\n  function renderNestedMessagePart() {\n    return renderMessagePart({\n      content: renderedContent,\n      highlight,\n      emojiSize,\n      asPreview,\n    });\n  }\n\n  if (!entityText) {\n    return renderNestedMessagePart();\n  }\n\n  if (asPreview) {\n    const text = renderNestedMessagePart();\n    if (entity.type === ApiMessageEntityTypes.Spoiler) {\n      return <Spoiler>{text}</Spoiler>;\n    }\n\n    if (entity.type === ApiMessageEntityTypes.CustomEmoji) {\n      return (\n        <CustomEmoji\n          key={cacheBuster ? `${cacheBuster}-${entity.offset}` : undefined}\n          documentId={entity.documentId}\n          size={emojiSize}\n          isSelectable\n          withSharedAnimation\n          sharedCanvasRef={sharedCanvasRef}\n          sharedCanvasHqRef={sharedCanvasHqRef}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withTranslucentThumb={withTranslucentThumbs}\n          forceAlways={forcePlayback}\n          noPlay={noCustomEmojiPlayback}\n        />\n      );\n    }\n    return text;\n  }\n\n  switch (entity.type) {\n    case ApiMessageEntityTypes.Bold:\n      return <strong data-entity-type={entity.type}>{renderNestedMessagePart()}</strong>;\n    case ApiMessageEntityTypes.Blockquote:\n      return (\n        <Blockquote canBeCollapsible={entity.canCollapse} isToggleDisabled={isInSelectMode}>\n          {renderNestedMessagePart()}\n        </Blockquote>\n      );\n    case ApiMessageEntityTypes.BotCommand:\n      return (\n        <a\n          onClick={handleBotCommandClick}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Hashtag: {\n      const [tag, username] = entityContent.split('@');\n      return (\n        <a\n          onClick={() => handleHashtagClick(tag, username)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    }\n    case ApiMessageEntityTypes.Cashtag: {\n      const [tag, username] = entityContent.split('@');\n      return (\n        <a\n          onClick={() => handleHashtagClick(tag, username)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    }\n    case ApiMessageEntityTypes.Code:\n      return (\n        <code\n          className={buildClassName('text-entity-code', 'clickable')}\n          onClick={handleCodeClick}\n          role=\"textbox\"\n          tabIndex={0}\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </code>\n      );\n    case ApiMessageEntityTypes.Email:\n      return (\n        <a\n          href={`mailto:${entityText}`}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Italic:\n      return <em data-entity-type={entity.type}>{renderNestedMessagePart()}</em>;\n    case ApiMessageEntityTypes.MentionName:\n      return (\n        <MentionLink userId={entity.userId}>\n          {renderNestedMessagePart()}\n        </MentionLink>\n      );\n    case ApiMessageEntityTypes.Mention:\n      return (\n        <MentionLink username={entityText}>\n          {renderNestedMessagePart()}\n        </MentionLink>\n      );\n    case ApiMessageEntityTypes.Phone:\n      return (\n        <a\n          href={`tel:${entityText}`}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Pre:\n      return <CodeBlock text={entityText} language={entity.language} noCopy={isProtected} />;\n    case ApiMessageEntityTypes.Strike:\n      return <del data-entity-type={entity.type}>{renderNestedMessagePart()}</del>;\n    case ApiMessageEntityTypes.TextUrl:\n    case ApiMessageEntityTypes.Url:\n      return (\n        <SafeLink\n          url={getLinkUrl(entityText, entity)}\n          text={entityText}\n          chatId={chatId}\n          messageId={messageId}\n          threadId={threadId}\n          entityType={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </SafeLink>\n      );\n    case ApiMessageEntityTypes.Underline:\n      return <ins data-entity-type={entity.type}>{renderNestedMessagePart()}</ins>;\n    case ApiMessageEntityTypes.Timestamp:\n      if (!chatId || !messageId || !maxTimestamp || entity.timestamp > maxTimestamp) {\n        return renderNestedMessagePart();\n      }\n\n      return (\n        <a\n          onClick={() => handleTimecodeClick(chatId, messageId, threadId, entity.timestamp)}\n          className=\"text-entity-link\"\n          dir=\"auto\"\n          data-entity-type={entity.type}\n        >\n          {renderNestedMessagePart()}\n        </a>\n      );\n    case ApiMessageEntityTypes.Spoiler:\n      return <Spoiler containerId={containerId}>{renderNestedMessagePart()}</Spoiler>;\n    case ApiMessageEntityTypes.CustomEmoji:\n      return (\n        <CustomEmoji\n          key={cacheBuster ? `${cacheBuster}-${entity.offset}` : undefined}\n          documentId={entity.documentId}\n          size={emojiSize}\n          isSelectable\n          withSharedAnimation\n          sharedCanvasRef={sharedCanvasRef}\n          sharedCanvasHqRef={sharedCanvasHqRef}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withTranslucentThumb={withTranslucentThumbs}\n          forceAlways={forcePlayback}\n          noPlay={noCustomEmojiPlayback}\n        />\n      );\n    case ApiMessageEntityTypes.QuoteFocus:\n      return (\n        <span className=\"matching-text-highlight is-quote\">{renderNestedMessagePart()}</span>\n      );\n    default:\n      return renderNestedMessagePart();\n  }\n}\n\nfunction processEntityAsHtml(\n  entity: ApiMessageEntity,\n  entityContent: TextPart,\n  nestedEntityContent: TextPart[],\n) {\n  const rawEntityText = typeof entityContent === 'string' ? entityContent : undefined;\n\n  // Prevent adding newlines when editing\n  const content = entity.type === ApiMessageEntityTypes.Pre ? (entityContent as string).trimEnd() : entityContent;\n\n  const renderedContent = nestedEntityContent.length\n    ? (nestedEntityContent as string[]).join('')\n    : (renderText(content, ['escape_html', 'emoji_html', 'br_html']) as string[]).join('');\n\n  if (!rawEntityText) {\n    return renderedContent;\n  }\n\n  switch (entity.type) {\n    case ApiMessageEntityTypes.Bold:\n      return `<b>${renderedContent}</b>`;\n    case ApiMessageEntityTypes.Italic:\n      return `<i>${renderedContent}</i>`;\n    case ApiMessageEntityTypes.Underline:\n      return `<u>${renderedContent}</u>`;\n    case ApiMessageEntityTypes.Code:\n      return `<code class=\"text-entity-code\">${renderedContent}</code>`;\n    case ApiMessageEntityTypes.Pre:\n      // eslint-disable-next-line @stylistic/max-len\n      return `\\`\\`\\`${renderText(entity.language || '', ['escape_html'])[0] as string}<br/>${renderedContent}<br/>\\`\\`\\`<br/>`;\n    case ApiMessageEntityTypes.Strike:\n      return `<del>${renderedContent}</del>`;\n    case ApiMessageEntityTypes.MentionName:\n      return `<a\n        class=\"text-entity-link\"\n        data-entity-type=\"${ApiMessageEntityTypes.MentionName}\"\n        data-user-id=\"${entity.userId}\"\n        contenteditable=\"false\"\n        dir=\"auto\"\n      >${renderedContent}</a>`;\n    case ApiMessageEntityTypes.Url:\n    case ApiMessageEntityTypes.TextUrl:\n      return `<a\n        class=\"text-entity-link\"\n        href=${getLinkUrl(rawEntityText, entity)}\n        data-entity-type=\"${entity.type}\"\n        dir=\"auto\"\n      >${renderedContent}</a>`;\n    case ApiMessageEntityTypes.Spoiler:\n      return `<span\n        class=\"spoiler\"\n        data-entity-type=\"${ApiMessageEntityTypes.Spoiler}\"\n        >${renderedContent}</span>`;\n    case ApiMessageEntityTypes.CustomEmoji:\n      return buildCustomEmojiHtmlFromEntity(rawEntityText, entity);\n    case ApiMessageEntityTypes.Blockquote:\n      return `<blockquote\n        class=\"blockquote\"\n        data-entity-type=\"${ApiMessageEntityTypes.Blockquote}\"\n        >${renderedContent}</blockquote>`;\n    default:\n      return renderedContent;\n  }\n}\n\nfunction getLinkUrl(entityContent: string, entity: ApiMessageEntity) {\n  const { type } = entity;\n  return type === ApiMessageEntityTypes.TextUrl && entity.url ? entity.url : entityContent;\n}\n\nfunction handleBotCommandClick(e: React.MouseEvent<HTMLAnchorElement>) {\n  getActions().sendBotCommand({ command: e.currentTarget.innerText });\n}\n\nfunction handleHashtagClick(hashtag?: string, username?: string) {\n  if (!hashtag) return;\n  if (username) {\n    getActions().openChatByUsername({\n      username,\n      onChatChanged: {\n        action: 'searchHashtag',\n        payload: { hashtag },\n      },\n    });\n    return;\n  }\n  getActions().searchHashtag({ hashtag });\n}\n\nfunction handleCodeClick(e: React.MouseEvent<HTMLElement>) {\n  copyTextToClipboard(e.currentTarget.innerText);\n  getActions().showNotification({\n    message: {\n      key: 'TextCopied',\n    },\n  });\n}\n\nfunction handleTimecodeClick(\n  chatId: string, messageId: number, threadId: ThreadId | undefined, timestamp: number,\n) {\n  getActions().openMediaFromTimestamp({\n    chatId, messageId, threadId, timestamp,\n  });\n}\n","import { memo } from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type {\n  ApiFormattedText, ApiMessage, ApiPoll, ApiTypeStory,\n  ApiWebPage,\n} from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport {\n  extractMessageText,\n  getMessagePollId,\n  groupStatefulContent,\n  isActionMessage,\n} from '../../global/helpers';\nimport {\n  getMessageSummaryDescription,\n  getMessageSummaryEmoji,\n  getMessageSummaryText,\n  TRUNCATED_SUMMARY_LENGTH,\n} from '../../global/helpers/messageSummary';\nimport { selectPeerStory, selectPollFromMessage, selectWebPageFromMessage } from '../../global/selectors';\nimport trimText from '../../util/trimText';\nimport renderText from './helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\n\nimport ActionMessageText from '../middle/message/ActionMessageText';\nimport MessageText from './MessageText';\n\ntype OwnProps = {\n  message: ApiMessage;\n  translatedText?: ApiFormattedText;\n  noEmoji?: boolean;\n  highlight?: string;\n  truncateLength?: number;\n  withTranslucentThumbs?: boolean;\n  inChatList?: boolean;\n  emojiSize?: number;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n};\n\ntype StateProps = {\n  poll?: ApiPoll;\n  story?: ApiTypeStory;\n  webPage?: ApiWebPage;\n};\n\nfunction MessageSummary({\n  message,\n  translatedText,\n  noEmoji,\n  highlight,\n  truncateLength = TRUNCATED_SUMMARY_LENGTH,\n  withTranslucentThumbs,\n  inChatList,\n  emojiSize,\n  poll,\n  story,\n  webPage,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n}: OwnProps & StateProps) {\n  const lang = useLang();\n  const extractedText = extractMessageText(message, inChatList);\n  const hasPoll = Boolean(getMessagePollId(message));\n  const isAction = isActionMessage(message);\n\n  const statefulContent = groupStatefulContent({ poll, story, webPage });\n\n  if (!extractedText && !hasPoll && !isAction) {\n    const summaryText = translatedText?.text\n      || getMessageSummaryText(lang, message, statefulContent, noEmoji, truncateLength);\n    const trimmedText = trimText(summaryText, truncateLength);\n\n    return (\n      <span>\n        {highlight ? (\n          renderText(trimmedText, ['emoji', 'highlight'], { highlight })\n        ) : (\n          renderText(trimmedText)\n        )}\n      </span>\n    );\n  }\n\n  function renderMessageText() {\n    if (isAction) {\n      return <ActionMessageText message={message} asPreview />;\n    }\n\n    return (\n      <MessageText\n        messageOrStory={message}\n        translatedText={translatedText}\n        highlight={highlight}\n        asPreview\n        observeIntersectionForLoading={observeIntersectionForLoading}\n        observeIntersectionForPlaying={observeIntersectionForPlaying}\n        withTranslucentThumbs={withTranslucentThumbs}\n        truncateLength={truncateLength}\n        inChatList={inChatList}\n        emojiSize={emojiSize}\n      />\n    );\n  }\n\n  const emoji = !noEmoji && getMessageSummaryEmoji(message);\n\n  return (\n    <>\n      {[\n        emoji ? renderText(`${emoji} `) : undefined,\n        getMessageSummaryDescription(lang, message, statefulContent, renderMessageText()),\n      ].flat().filter(Boolean)}\n    </>\n  );\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { message }): Complete<StateProps> => {\n    const poll = selectPollFromMessage(global, message);\n    const webPage = selectWebPageFromMessage(global, message);\n    const storyData = message.content.storyData;\n    const story = storyData && selectPeerStory(global, storyData.peerId, storyData.id);\n\n    return {\n      poll,\n      story,\n      webPage,\n    };\n  },\n)(MessageSummary));\n","import { useRef } from '../lib/teact/teact';\n\nimport type { Signal } from '../util/signals';\n\nimport useForceUpdate from './useForceUpdate';\nimport { useSignalEffect } from './useSignalEffect';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\n\ntype SyncResolver<T> = () => T;\ntype AsyncResolver<T> = (setter: (newValue: T) => void) => void;\ntype Resolver<T> =\n  SyncResolver<T>\n  | AsyncResolver<T>;\n\nfunction useDerivedState<T>(resolver: SyncResolver<T>, dependencies: readonly any[]): T;\nfunction useDerivedState<T>(resolver: AsyncResolver<T>, dependencies: readonly any[], isAsync: true): T;\nfunction useDerivedState<T>(signal: Signal<T>): T;\n\nfunction useDerivedState<T>(resolverOrSignal: Resolver<T> | T, dependencies?: readonly any[], isAsync = false) {\n  const resolver = dependencies ? resolverOrSignal as Resolver<T> : () => ((resolverOrSignal as Signal<T>)());\n  dependencies ??= [resolverOrSignal];\n\n  const valueRef = useRef<T>();\n  const forceUpdate = useForceUpdate();\n  const resolverRef = useStateRef(resolver);\n\n  function runCurrentResolver(isSync = false) {\n    const currentResolver = resolverRef.current;\n    if (isAsync) {\n      (currentResolver as AsyncResolver<T>)((newValue) => {\n        if (valueRef.current !== newValue) {\n          valueRef.current = newValue;\n          forceUpdate();\n        }\n      });\n    } else {\n      const newValue = (currentResolver as SyncResolver<T>)();\n      if (valueRef.current !== newValue) {\n        valueRef.current = newValue;\n\n        if (!isSync) {\n          forceUpdate();\n        }\n      }\n    }\n  }\n\n  useSyncEffect(() => {\n    runCurrentResolver(true);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies);\n\n  useSignalEffect(runCurrentResolver, dependencies);\n\n  return valueRef.current as T;\n}\n\nexport default useDerivedState;\n","const cache = new WeakMap<AnyFunction, Map<string, any>>();\n\nexport default function withCache<T extends AnyFunction>(fn: T) {\n  return (...args: Parameters<T>): ReturnType<T> => {\n    let fnCache = cache.get(fn);\n    const cacheKey = args.map(String).join('_');\n\n    if (fnCache) {\n      const cached = fnCache.get(cacheKey);\n      if (cached) {\n        return cached;\n      }\n    } else {\n      fnCache = new Map();\n      cache.set(fn, fnCache);\n    }\n\n    const newValue = fn(...args);\n\n    fnCache.set(cacheKey, newValue);\n\n    return newValue;\n  };\n}\n","import type {\n  ApiChat,\n  ApiInputMessageReplyInfo,\n  ApiMessage,\n  ApiMessageEntityCustomEmoji,\n  ApiMessageForwardInfo,\n  ApiMessageOutgoingStatus,\n  ApiPeer, ApiRestrictionReason, ApiSponsoredMessage,\n  ApiStickerSetInfo,\n  MediaContainer,\n} from '../../api/types';\nimport type {\n  ChatTranslatedMessages,\n  MessageListType,\n  TabThread,\n  Thread,\n  ThreadId,\n} from '../../types';\nimport type { IAllowedAttachmentOptions } from '../helpers';\nimport type {\n  GlobalState, TabArgs,\n} from '../types';\nimport { ApiMessageEntityTypes, MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  ANONYMOUS_USER_ID, GENERAL_TOPIC_ID, SERVICE_NOTIFICATIONS_USER_ID,\n  WEB_APP_PLATFORM,\n} from '../../config';\nimport { IS_TRANSLATION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { isUserId } from '../../util/entities/ids';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { findLast } from '../../util/iteratees';\nimport { getMessageKey, isLocalMessageId } from '../../util/keys/messageKey';\nimport { isIpRevealingMedia } from '../../util/media/ipRevealingMedia';\nimport { MEMO_EMPTY_ARRAY } from '../../util/memo';\nimport { getServerTime } from '../../util/serverTime';\nimport { getDocumentExtension } from '../../components/common/helpers/documentInfo';\nimport { API_GENERAL_ID_LIMIT } from '../../limits';\nimport {\n  canSendReaction,\n  getAllowedAttachmentOptions,\n  getCanPostInChat,\n  getHasAdminRight,\n  getIsSavedDialog,\n  getMessageAudio,\n  getMessageDocument,\n  getMessageLink,\n  getMessagePaidMedia,\n  getMessagePhoto,\n  getMessageVideo,\n  getMessageVoice,\n  getSendingState,\n  getWebPagePhoto,\n  getWebPageVideo,\n  hasMessageTtl,\n  isActionMessage,\n  isChatBasicGroup,\n  isChatChannel,\n  isChatGroup,\n  isChatSuperGroup,\n  isCommonBoxChat,\n  isExpiredMessage,\n  isForwardedMessage,\n  isMessageDocumentSticker,\n  isMessageFailed,\n  isMessageLocal,\n  isMessageTranslatable,\n  isOwnMessage,\n  isServiceNotificationMessage,\n  isUserRightBanned,\n} from '../helpers';\nimport { getMessageReplyInfo } from '../helpers/replies';\nimport {\n  selectChat,\n  selectChatFullInfo,\n  selectChatLastMessageId,\n  selectIsChatRestricted,\n  selectIsChatWithBot,\n  selectIsChatWithSelf,\n  selectRequestedChatTranslationLanguage,\n} from './chats';\nimport { selectCurrentLimit } from './limits';\nimport { selectMessageDownloadableMedia } from './media';\nimport { selectPeer, selectPeerPaidMessagesStars } from './peers';\nimport { selectPeerStory } from './stories';\nimport { selectCustomEmoji, selectIsStickerFavorite } from './symbols';\nimport { selectTabState } from './tabs';\nimport { selectTopic } from './topics';\nimport {\n  selectBot, selectUser, selectUserStatus,\n} from './users';\n\nexport function selectCurrentMessageList<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageLists } = selectTabState(global, tabId);\n\n  if (messageLists.length) {\n    return messageLists[messageLists.length - 1];\n  }\n\n  return undefined;\n}\n\nexport function selectCurrentChat<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId } = selectCurrentMessageList(global, tabId) || {};\n\n  return chatId ? selectChat(global, chatId) : undefined;\n}\n\nexport function selectChatMessages<T extends GlobalState>(global: T, chatId: string) {\n  return global.messages.byChatId[chatId]?.byId;\n}\n\nexport function selectChatScheduledMessages<T extends GlobalState>(global: T, chatId: string) {\n  return global.scheduledMessages.byChatId[chatId]?.byId;\n}\n\nexport function selectTabThreadParam<T extends GlobalState, K extends keyof TabThread>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  key: K,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).tabThreads[chatId]?.[threadId]?.[key];\n}\n\nexport function selectThreadParam<T extends GlobalState, K extends keyof Thread>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  key: K,\n) {\n  return selectThread(global, chatId, threadId)?.[key];\n}\n\nexport function selectThread<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n) {\n  const messageInfo = global.messages.byChatId[chatId];\n  if (!messageInfo) {\n    return undefined;\n  }\n\n  const thread = messageInfo.threadsById[threadId];\n  if (!thread) {\n    return undefined;\n  }\n\n  return thread;\n}\n\nexport function selectListedIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'listedIds');\n}\n\nexport function selectChatThreads<T extends GlobalState>(global: T, chatId: string) {\n  const messageInfo = global.messages.byChatId[chatId];\n  if (!messageInfo) {\n    return undefined;\n  }\n\n  return messageInfo.threadsById;\n}\n\nexport function selectOutlyingListByMessageId<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, messageId: number,\n) {\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  if (!outlyingLists) {\n    return undefined;\n  }\n\n  return outlyingLists.find((list) => {\n    return list[0] <= messageId && list[list.length - 1] >= messageId;\n  });\n}\n\nexport function selectOutlyingLists<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n) {\n  return selectThreadParam(global, chatId, threadId, 'outlyingLists');\n}\n\nexport function selectCurrentMessageIds<T extends GlobalState>(\n  global: T,\n  chatId: string, threadId: ThreadId, messageListType: MessageListType,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  switch (messageListType) {\n    case 'thread':\n      return selectViewportIds(global, chatId, threadId, tabId);\n    case 'pinned':\n      return selectPinnedIds(global, chatId, threadId);\n    case 'scheduled':\n      return selectScheduledIds(global, chatId, threadId);\n  }\n\n  return undefined;\n}\n\nexport function selectViewportIds<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'viewportIds', tabId);\n}\n\nexport function selectPinnedIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'pinnedIds');\n}\n\nexport function selectScheduledIds<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'scheduledIds');\n}\n\nexport function selectScrollOffset<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'scrollOffset', tabId);\n}\n\nexport function selectLastScrollOffset<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'lastScrollOffset');\n}\n\nexport function selectEditingId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'editingId');\n}\n\nexport function selectEditingDraft<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'editingDraft');\n}\n\nexport function selectEditingScheduledId<T extends GlobalState>(global: T, chatId: string) {\n  return selectThreadParam(global, chatId, MAIN_THREAD_ID, 'editingScheduledId');\n}\n\nexport function selectEditingScheduledDraft<T extends GlobalState>(global: T, chatId: string) {\n  return selectThreadParam(global, chatId, MAIN_THREAD_ID, 'editingScheduledDraft');\n}\n\nexport function selectDraft<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'draft');\n}\n\nexport function selectNoWebPage<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'noWebPage');\n}\n\nexport function selectThreadInfo<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'threadInfo');\n}\n\nexport function selectFirstMessageId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectThreadParam(global, chatId, threadId, 'firstMessageId');\n}\n\nexport function selectReplyStack<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabThreadParam(global, chatId, threadId, 'replyStack', tabId);\n}\n\nexport function selectThreadMessagesCount(global: GlobalState, chatId: string, threadId: ThreadId) {\n  const chat = selectChat(global, chatId);\n  const threadInfo = selectThreadInfo(global, chatId, threadId);\n  if (!chat || !threadInfo || threadInfo.messagesCount === undefined) return undefined;\n  // In forum topics first message is ignored, but not in General\n  if (chat.isForum && threadId !== GENERAL_TOPIC_ID) return threadInfo.messagesCount - 1;\n  return threadInfo.messagesCount;\n}\n\nexport function selectThreadByMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const threadId = selectThreadIdFromMessage(global, message);\n  if (!threadId || threadId === MAIN_THREAD_ID) {\n    return undefined;\n  }\n\n  return global.messages.byChatId[message.chatId].threadsById[threadId];\n}\n\nexport function selectIsMessageInCurrentMessageList<T extends GlobalState>(\n  global: T, chatId: string, message: ApiMessage,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const currentMessageList = selectCurrentMessageList(global, tabId);\n  if (!currentMessageList) {\n    return false;\n  }\n\n  const { threadInfo } = selectThreadByMessage(global, message) || {};\n  return (\n    chatId === currentMessageList.chatId\n    && (\n      (currentMessageList.threadId === MAIN_THREAD_ID)\n      || (threadInfo && currentMessageList.threadId === threadInfo.threadId)\n    )\n  );\n}\n\nexport function selectIsViewportNewest<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n  if (!viewportIds || !viewportIds.length) {\n    return true;\n  }\n\n  const isSavedDialog = getIsSavedDialog(chatId, threadId, global.currentUserId);\n\n  let lastMessageId: number;\n\n  if (threadId === MAIN_THREAD_ID) {\n    const id = selectChatLastMessageId(global, chatId);\n    if (!id) {\n      return true;\n    }\n    lastMessageId = id;\n  } else if (isSavedDialog) {\n    const id = selectChatLastMessageId(global, String(threadId), 'saved');\n    if (!id) {\n      return true;\n    }\n    lastMessageId = id;\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo || !threadInfo.lastMessageId) {\n      if (!threadInfo?.threadId) return undefined;\n      // No messages in thread, except for the thread message itself\n      lastMessageId = Number(threadInfo?.threadId);\n    } else {\n      lastMessageId = threadInfo.lastMessageId;\n    }\n  }\n\n  // Edge case: outgoing `lastMessage` is updated with a delay to optimize animation\n  if (isLocalMessageId(lastMessageId) && !selectChatMessage(global, chatId, lastMessageId)) {\n    return true;\n  }\n\n  return viewportIds[viewportIds.length - 1] >= lastMessageId;\n}\n\nexport function selectChatMessage<T extends GlobalState>(global: T, chatId: string, messageId: number) {\n  const chatMessages = selectChatMessages(global, chatId);\n\n  return chatMessages ? chatMessages[messageId] : undefined;\n}\n\nexport function selectScheduledMessage<T extends GlobalState>(global: T, chatId: string, messageId: number) {\n  const chatMessages = selectChatScheduledMessages(global, chatId);\n\n  return chatMessages ? chatMessages[messageId] : undefined;\n}\n\nexport function selectQuickReplyMessage<T extends GlobalState>(global: T, messageId: number) {\n  return global.quickReplies.messagesById[messageId];\n}\n\nexport function selectEditingMessage<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, messageListType: MessageListType,\n) {\n  if (messageListType === 'scheduled') {\n    const messageId = selectEditingScheduledId(global, chatId);\n    return messageId ? selectScheduledMessage(global, chatId, messageId) : undefined;\n  } else {\n    const messageId = selectEditingId(global, chatId, threadId);\n    return messageId ? selectChatMessage(global, chatId, messageId) : undefined;\n  }\n}\n\nexport function selectFocusedMessageId<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId: focusedChatId, messageId } = selectTabState(global, tabId).focusedMessage || {};\n\n  return focusedChatId === chatId ? messageId : undefined;\n}\n\nexport function selectIsMessageFocused<T extends GlobalState>(\n  global: T, message: ApiMessage, currentThreadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const focusedId = selectFocusedMessageId(global, message.chatId, tabId);\n  const threadId = selectTabState(global, tabId).focusedMessage?.threadId;\n\n  if (currentThreadId !== threadId) return false;\n\n  return focusedId ? focusedId === message.id || focusedId === message.previousLocalId : false;\n}\n\nexport function selectIsMessageUnread<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { lastReadOutboxMessageId } = selectChat(global, message.chatId) || {};\n  return isMessageLocal(message) || !lastReadOutboxMessageId || lastReadOutboxMessageId < message.id;\n}\n\nexport function selectOutgoingStatus<T extends GlobalState>(\n  global: T, message: ApiMessage, isScheduledList = false,\n): ApiMessageOutgoingStatus {\n  if (!selectIsMessageUnread(global, message) && !isScheduledList) {\n    return 'read';\n  }\n\n  return getSendingState(message);\n}\n\nexport function selectSender<T extends GlobalState>(global: T, message: ApiMessage): ApiPeer | undefined {\n  const { senderId } = message;\n  const chat = selectChat(global, message.chatId);\n  const currentUser = selectUser(global, global.currentUserId!);\n  if (!senderId) {\n    return message.isOutgoing ? currentUser : chat;\n  }\n\n  if (chat && isChatChannel(chat) && !chat.areProfilesShown) return chat;\n\n  return selectPeer(global, senderId);\n}\n\nexport function getSendersFromSelectedMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n) {\n  return messageIds.map((id) => {\n    const message = selectChatMessage(global, chatId, id);\n    return message && selectSender(global, message);\n  }).filter(Boolean);\n}\n\nexport function selectSenderFromMessage<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageId: number,\n): ApiPeer | undefined {\n  const message = selectChatMessage(global, chatId, messageId);\n\n  return message && selectSender(global, message);\n}\n\nexport function selectSenderFromHeader<T extends GlobalState>(\n  global: T,\n  header: ApiMessageForwardInfo,\n) {\n  const { fromId } = header;\n  if (fromId) {\n    return selectPeer(global, fromId);\n  }\n\n  return undefined;\n}\n\nexport function selectForwardedSender<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): ApiPeer | undefined {\n  const isStoryForward = Boolean(message.content.storyData);\n  if (isStoryForward) {\n    const peerId = message.content.storyData!.peerId;\n    return selectPeer(global, peerId);\n  }\n\n  const { forwardInfo } = message;\n  if (!forwardInfo) {\n    return undefined;\n  }\n\n  if (forwardInfo.isChannelPost && forwardInfo.fromChatId) {\n    return selectChat(global, forwardInfo.fromChatId);\n  }\n\n  if (forwardInfo.hiddenUserName) {\n    return undefined;\n  }\n\n  if (forwardInfo.fromId) {\n    return selectPeer(global, forwardInfo.fromId);\n  }\n\n  if (forwardInfo.savedFromPeerId) {\n    return selectPeer(global, forwardInfo.savedFromPeerId);\n  }\n\n  return undefined;\n}\n\nexport function selectPoll<T extends GlobalState>(global: T, pollId: string) {\n  return global.messages.pollById[pollId];\n}\n\nexport function selectPollFromMessage<T extends GlobalState>(global: T, message: MediaContainer) {\n  if (!message.content.pollId) return undefined;\n  return selectPoll(global, message.content.pollId);\n}\n\nexport function selectWebPage<T extends GlobalState>(global: T, webPageId: string) {\n  return global.messages.webPageById[webPageId];\n}\n\nexport function selectWebPageFromMessage<T extends GlobalState>(global: T, message: MediaContainer) {\n  if (!message.content.webPage) return undefined;\n  return selectWebPage(global, message.content.webPage.id);\n}\n\nexport function selectFullWebPage<T extends GlobalState>(global: T, webPageId: string) {\n  const webPage = selectWebPage(global, webPageId);\n  if (!webPage || webPage.webpageType !== 'full') return undefined;\n  return webPage;\n}\n\nexport function selectFullWebPageFromMessage<T extends GlobalState>(global: T, message: MediaContainer) {\n  if (!message.content.webPage) return undefined;\n  return selectFullWebPage(global, message.content.webPage.id);\n}\n\nexport function selectTopicFromMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { chatId } = message;\n  const chat = selectChat(global, chatId);\n  if (!chat?.isForum) return undefined;\n\n  const threadId = selectThreadIdFromMessage(global, message);\n  return selectTopic(global, chatId, threadId);\n}\n\nconst MAX_MESSAGES_TO_DELETE_OWNER_TOPIC = 10;\nexport function selectCanDeleteOwnerTopic<T extends GlobalState>(global: T, chatId: string, topicId: number) {\n  const topic = selectTopic(global, chatId, topicId);\n  if (topic && !topic.isOwner) return false;\n\n  const thread = selectThread(global, chatId, topicId);\n  if (!thread) return false;\n\n  const { listedIds } = thread;\n  if (!listedIds\n    // Plus one for root message\n    || listedIds.length + 1 >= MAX_MESSAGES_TO_DELETE_OWNER_TOPIC) {\n    return false;\n  }\n\n  const hasNotOutgoingMessages = listedIds.some((messageId) => {\n    const message = selectChatMessage(global, chatId, messageId);\n    return !message || !message.isOutgoing;\n  });\n\n  return !hasNotOutgoingMessages;\n}\n\nexport function selectCanDeleteTopic<T extends GlobalState>(global: T, chatId: string, topicId: number) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  if (topicId === GENERAL_TOPIC_ID) return false;\n\n  return chat.isBotForum\n    || chat.isCreator\n    || getHasAdminRight(chat, 'deleteMessages')\n    || (chat.isForum\n      && selectCanDeleteOwnerTopic(global, chat.id, topicId));\n}\n\nexport function selectSavedDialogIdFromMessage<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): string | undefined {\n  const {\n    chatId, senderId, forwardInfo, savedPeerId,\n  } = message;\n\n  if (savedPeerId) return savedPeerId;\n\n  if (chatId !== global.currentUserId) {\n    return undefined;\n  }\n\n  if (forwardInfo?.savedFromPeerId) {\n    return forwardInfo.savedFromPeerId;\n  }\n\n  if (forwardInfo?.fromId) {\n    return forwardInfo.fromId;\n  }\n\n  if (forwardInfo?.hiddenUserName) {\n    return ANONYMOUS_USER_ID;\n  }\n\n  return senderId;\n}\n\nexport function selectThreadIdFromMessage<T extends GlobalState>(global: T, message: ApiMessage): ThreadId {\n  const savedDialogId = selectSavedDialogIdFromMessage(global, message);\n  if (savedDialogId) {\n    return savedDialogId;\n  }\n\n  const chat = selectChat(global, message.chatId);\n  const { content } = message;\n  const { replyToMsgId, replyToTopId, isForumTopic } = getMessageReplyInfo(message) || {};\n  if (content.action?.type === 'topicCreate') {\n    return message.id;\n  }\n\n  if (!chat?.isForum) {\n    if (chat && isChatBasicGroup(chat)) return MAIN_THREAD_ID;\n\n    if (chat && isChatSuperGroup(chat)) {\n      return replyToTopId || replyToMsgId || MAIN_THREAD_ID;\n    }\n    return MAIN_THREAD_ID;\n  }\n  if (!isForumTopic) return GENERAL_TOPIC_ID;\n  return replyToTopId || replyToMsgId || GENERAL_TOPIC_ID;\n}\n\nexport function selectCanReplyToMessage<T extends GlobalState>(global: T, message: ApiMessage, threadId: ThreadId) {\n  const chat = selectChat(global, message.chatId);\n  const isRestricted = selectIsChatRestricted(global, message.chatId);\n  if (!chat || isRestricted || chat.isForbidden) return false;\n\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n\n  if (isLocal || isServiceNotification) return false;\n\n  const threadInfo = selectThreadInfo(global, message.chatId, threadId);\n  const isMessageThread = Boolean(!threadInfo?.isCommentsInfo && threadInfo?.fromChannelId);\n  const chatFullInfo = selectChatFullInfo(global, chat.id);\n  const topic = selectTopic(global, chat.id, threadId);\n  const canPostInChat = getCanPostInChat(chat, topic, isMessageThread, chatFullInfo);\n  if (!canPostInChat) return false;\n\n  const messageTopic = selectTopicFromMessage(global, message);\n  return !messageTopic || !messageTopic.isClosed || messageTopic.isOwner || getHasAdminRight(chat, 'manageTopics');\n}\n\nexport function selectCanForwardMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isAction = isActionMessage(message);\n  const hasTtl = hasMessageTtl(message);\n  const { content } = message;\n\n  const webPage = selectFullWebPageFromMessage(global, message);\n\n  const story = content.storyData\n    ? selectPeerStory(global, content.storyData.peerId, content.storyData.id)\n    : (webPage?.story\n      ? selectPeerStory(global, webPage.story.peerId, webPage.story.id)\n      : undefined\n    );\n  const isChatProtected = selectIsChatProtected(global, message.chatId);\n  const isStoryForwardForbidden = story && ('isDeleted' in story || ('noForwards' in story && story.noForwards));\n  const canForward = (\n    !isLocal && !isAction && !isChatProtected && !isStoryForwardForbidden\n    && (message.isForwardingAllowed || isServiceNotification) && !hasTtl\n  );\n\n  return canForward;\n}\n\n// This selector is slow and not to be used within lists (e.g. Message component)\nexport function selectAllowedMessageActionsSlow<T extends GlobalState>(\n  global: T, message: ApiMessage, threadId: ThreadId,\n) {\n  const chat = selectChat(global, message.chatId);\n  const isRestricted = selectIsChatRestricted(global, message.chatId);\n  if (!chat || isRestricted) {\n    return {};\n  }\n\n  const chatFullInfo = selectChatFullInfo(global, message.chatId);\n  const isPrivate = isUserId(chat.id);\n  const isChatWithSelf = selectIsChatWithSelf(global, message.chatId);\n  const isBasicGroup = isChatBasicGroup(chat);\n  const isSuperGroup = isChatSuperGroup(chat);\n  const isChannel = isChatChannel(chat);\n  const isBotChat = Boolean(selectBot(global, chat.id));\n  const isLocal = isMessageLocal(message);\n  const isFailed = isMessageFailed(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isOwn = isOwnMessage(message);\n  const isForwarded = isForwardedMessage(message);\n  const isAction = isActionMessage(message);\n  const hasTtl = hasMessageTtl(message);\n  const { content } = message;\n  const isDocumentSticker = isMessageDocumentSticker(message);\n  const isBoostMessage = message.content.action?.type === 'boostApply';\n  const isMonoforum = chat.isMonoforum;\n\n  // https://github.com/telegramdesktop/tdesktop/blob/6627de646022af1394134974477109cd1439e1bb/Telegram/SourceFiles/data/data_peer_values.cpp#L367C2-L372C3\n  const canPinMessage = (() => {\n    if (isPrivate || chat.isCreator) return true;\n\n    if (isChannel) {\n      return getHasAdminRight(chat, 'editMessages');\n    }\n\n    const hasPinMessageRight = getHasAdminRight(chat, 'pinMessages');\n    const isPinMessageRightBanned = isUserRightBanned(chat, 'pinMessages', chatFullInfo);\n\n    if (isSuperGroup) {\n      const hasUsernameOrGeo = chat.hasUsername || chat.hasGeo;\n      return (hasPinMessageRight || !hasUsernameOrGeo) && !isPinMessageRightBanned;\n    }\n\n    if (isBasicGroup) {\n      return !chat.isForbidden && !chat.isNotJoined && hasPinMessageRight && !isPinMessageRightBanned;\n    }\n\n    return hasPinMessageRight;\n  })();\n\n  // https://github.com/telegramdesktop/tdesktop/blob/335095a332607c41a8d20b47e61f5bbd66366d4b/Telegram/SourceFiles/data/data_peer.cpp#L653\n  const canEditMessagesIndefinitely = (() => {\n    if (content.todo) return true;\n    if (isPrivate) return isChatWithSelf;\n    if (isBasicGroup) return false;\n    if (isSuperGroup) return canPinMessage;\n    if (isChannel) return chat.isCreator || getHasAdminRight(chat, 'editMessages');\n    return false;\n  })();\n\n  const isMessageEditable = (\n    (\n      canEditMessagesIndefinitely\n      || getServerTime() - message.date < (global.config?.editTimeLimit || Infinity)\n    ) && !(\n      content.sticker || content.contact || content.pollId || content.action\n      || (content.video?.isRound) || content.location || content.invoice || content.giveaway || content.giveawayResults\n      || isDocumentSticker\n    )\n    && !isForwarded\n    && !message.viaBotId\n    && !chat.isForbidden\n  );\n\n  const isSavedDialog = getIsSavedDialog(chat.id, threadId, global.currentUserId);\n\n  const canReply = selectCanReplyToMessage(global, message, threadId);\n  const canReplyGlobally = canReply || (!isSavedDialog && !isLocal && !isServiceNotification\n    && (isSuperGroup || isBasicGroup || isChatChannel(chat)));\n\n  let canPin = !isLocal && !isServiceNotification && !isAction && canPinMessage && !isSavedDialog;\n  let canUnpin = false;\n\n  const pinnedMessageIds = selectPinnedIds(global, chat.id, threadId);\n\n  if (canPin) {\n    canUnpin = Boolean(pinnedMessageIds && pinnedMessageIds.includes(message.id));\n    canPin = !canUnpin;\n  }\n\n  const canNotDeleteBoostMessage = isBoostMessage && isOwn\n    && !chat.isCreator && !getHasAdminRight(chat, 'deleteMessages');\n\n  const canDelete = (!isLocal || isFailed) && !isServiceNotification && !canNotDeleteBoostMessage && (\n    isPrivate\n    || isOwn\n    || isBasicGroup\n    || chat.isCreator\n    || getHasAdminRight(chat, 'deleteMessages')\n  );\n\n  const canReport = !isPrivate && !isOwn;\n\n  const canDeleteForAll = canDelete && !chat.isForbidden && (\n    (isPrivate && !isChatWithSelf && !isBotChat)\n    || (isBasicGroup && (\n      isOwn || getHasAdminRight(chat, 'deleteMessages') || chat.isCreator\n    ))\n  );\n\n  const hasMessageEditRight = isOwn || (isChannel && (chat.isCreator || getHasAdminRight(chat, 'editMessages')));\n\n  const canEdit = !isLocal && !isAction && isMessageEditable && hasMessageEditRight;\n\n  const hasSticker = Boolean(message.content.sticker);\n  const hasFavoriteSticker = hasSticker && selectIsStickerFavorite(global, message.content.sticker!);\n  const canFaveSticker = !isAction && hasSticker && !hasFavoriteSticker;\n  const canUnfaveSticker = !isAction && hasFavoriteSticker;\n  const canCopy = !isAction;\n  const canCopyLink = !isLocal && !isAction && (isChannel || isSuperGroup) && !isMonoforum;\n  const canSelect = !isLocal && !isAction;\n\n  const canDownload = selectMessageDownloadableMedia(global, message) && !hasTtl;\n\n  const canSaveGif = message.content.video?.isGif;\n\n  const poll = content.pollId ? selectPoll(global, content.pollId) : undefined;\n  const canRevote = !poll?.summary.closed && !poll?.summary.quiz && poll?.results.results?.some((r) => r.isChosen);\n  const canClosePoll = hasMessageEditRight && poll && !poll.summary.closed && !isForwarded;\n\n  const noOptions = [\n    canReply,\n    canReplyGlobally,\n    canEdit,\n    canPin,\n    canUnpin,\n    canReport,\n    canDelete,\n    canDeleteForAll,\n    canFaveSticker,\n    canUnfaveSticker,\n    canCopy,\n    canCopyLink,\n    canSelect,\n    canDownload,\n    canSaveGif,\n    canRevote,\n    canClosePoll,\n  ].every((ability) => !ability);\n\n  return {\n    noOptions,\n    canReply,\n    canReplyGlobally,\n    canEdit,\n    canPin,\n    canUnpin,\n    canReport,\n    canDelete,\n    canDeleteForAll,\n    canFaveSticker,\n    canUnfaveSticker,\n    canCopy,\n    canCopyLink,\n    canSelect,\n    canDownload,\n    canSaveGif,\n    canRevote,\n    canClosePoll,\n  };\n}\n\nexport function selectCanDeleteMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  messageIds: number[],\n) {\n  const chatMessages = selectChatMessages(global, chatId);\n\n  if (messageIds.length > API_GENERAL_ID_LIMIT) {\n    return {};\n  }\n\n  const messageActions = messageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return {\n    canDelete: messageActions.every((actions) => actions.canDelete),\n    canDeleteForAll: messageActions.every((actions) => actions.canDeleteForAll),\n  };\n}\n\nexport function selectCanDeleteSelectedMessages<T extends GlobalState>(\n  global: T,\n  messageIds?: number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const messageIdList = messageIds?.length ? messageIds : selectedMessageIds;\n  if (!chatId || !threadId || !messageIdList) {\n    return {};\n  }\n\n  return selectCanDeleteMessages(global, chatId, threadId, messageIdList);\n}\n\nexport function selectCanReportSelectedMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const chatMessages = chatId && selectChatMessages(global, chatId);\n  if (!chatMessages || !selectedMessageIds || !threadId) {\n    return false;\n  }\n\n  const messageActions = selectedMessageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return messageActions.every((actions) => actions.canReport);\n}\n\nexport function selectCanDownloadSelectedMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedMessageIds } = selectTabState(global, tabId).selectedMessages || {};\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  const chatMessages = chatId && selectChatMessages(global, chatId);\n  if (!chatMessages || !selectedMessageIds || !threadId) {\n    return false;\n  }\n\n  const messageActions = selectedMessageIds\n    .map((id) => chatMessages[id] && selectAllowedMessageActionsSlow(global, chatMessages[id], threadId))\n    .filter(Boolean);\n\n  return messageActions.some((actions) => actions.canDownload);\n}\n\nexport function selectActiveDownloads<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).activeDownloads;\n}\n\nexport function selectUploadProgress<T extends GlobalState>(global: T, message: ApiMessage) {\n  return global.fileUploads.byMessageKey[getMessageKey(message)]?.progress;\n}\n\nexport function selectRealLastReadId<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  if (threadId === MAIN_THREAD_ID) {\n    const chat = selectChat(global, chatId);\n    if (!chat) {\n      return undefined;\n    }\n\n    // `lastReadInboxMessageId` is empty for new chats\n    if (!chat.lastReadInboxMessageId) {\n      return undefined;\n    }\n\n    const lastMessageId = selectChatLastMessageId(global, chatId);\n\n    if (!lastMessageId || chat.unreadCount) {\n      return chat.lastReadInboxMessageId;\n    }\n\n    return lastMessageId;\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo) {\n      return undefined;\n    }\n\n    if (!threadInfo.lastReadInboxMessageId) {\n      return Number(threadInfo.threadId);\n    }\n\n    // Some previously read messages may be deleted\n    return Math.min(threadInfo.lastReadInboxMessageId, threadInfo.lastMessageId || Infinity);\n  }\n}\n\nexport function selectFirstUnreadId<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId,\n) {\n  const chat = selectChat(global, chatId);\n\n  if (threadId === MAIN_THREAD_ID) {\n    if (!chat) {\n      return undefined;\n    }\n  } else {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n    if (!threadInfo\n      || (threadInfo.lastMessageId !== undefined && threadInfo.lastMessageId === threadInfo.lastReadInboxMessageId)) {\n      return undefined;\n    }\n  }\n\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  const listedIds = selectListedIds(global, chatId, threadId);\n  const byId = selectChatMessages(global, chatId);\n  if (!byId || !(outlyingLists?.length || listedIds)) {\n    return undefined;\n  }\n\n  const lastReadId = selectRealLastReadId(global, chatId, threadId);\n  if (!lastReadId && chat && chat.isNotJoined) {\n    return undefined;\n  }\n\n  const lastReadServiceNotificationId = chatId === SERVICE_NOTIFICATIONS_USER_ID\n    ? global.serviceNotifications.reduce((max, notification) => {\n      return !notification.isUnread && notification.id > max ? notification.id : max;\n    }, -1)\n    : -1;\n\n  function findAfterLastReadId(listIds: number[]) {\n    return listIds.find((id) => {\n      return (\n        (!lastReadId || id > lastReadId)\n        && byId[id]\n        && (!byId[id].isOutgoing || byId[id].isFromScheduled)\n        && id > lastReadServiceNotificationId\n      );\n    });\n  }\n\n  if (outlyingLists?.length) {\n    const found = outlyingLists.map((list) => findAfterLastReadId(list)).filter(Boolean)[0];\n    if (found) {\n      return found;\n    }\n  }\n\n  if (listedIds) {\n    const found = findAfterLastReadId(listedIds);\n    if (found) {\n      return found;\n    }\n  }\n\n  return undefined;\n}\n\nexport function selectIsForwardModalOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { isShareMessageModalShown } = selectTabState(global, tabId);\n  return Boolean(isShareMessageModalShown);\n}\n\nexport function selectCommonBoxChatId<T extends GlobalState>(global: T, messageId: number) {\n  const fromLastMessage = Object.values(global.chats.byId).find((chat) => (\n    isCommonBoxChat(chat) && selectChatLastMessageId(global, chat.id) === messageId\n  ));\n  if (fromLastMessage) {\n    return fromLastMessage.id;\n  }\n\n  const { byChatId } = global.messages;\n  return Object.keys(byChatId).find((chatId) => {\n    const chat = selectChat(global, chatId);\n    return chat && isCommonBoxChat(chat) && byChatId[chat.id].byId[messageId];\n  });\n}\n\nexport function selectIsInSelectMode<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { selectedMessages } = selectTabState(global, tabId);\n\n  return Boolean(selectedMessages);\n}\n\nexport function selectIsMessageSelected<T extends GlobalState>(\n  global: T, messageId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds } = selectTabState(global, tabId).selectedMessages || {};\n  if (!messageIds) {\n    return false;\n  }\n\n  return messageIds.includes(messageId);\n}\n\nexport function selectForwardedMessageIdsByGroupId<T extends GlobalState>(\n  global: T, chatId: string, groupedId: string,\n) {\n  const chatMessages = selectChatMessages(global, chatId);\n  if (!chatMessages) {\n    return undefined;\n  }\n\n  return Object.values(chatMessages)\n    .filter((message) => message.groupedId === groupedId && message.forwardInfo)\n    .map(({ forwardInfo }) => forwardInfo!.fromMessageId);\n}\n\nexport function selectMessageIdsByGroupId<T extends GlobalState>(global: T, chatId: string, groupedId: string) {\n  const chatMessages = selectChatMessages(global, chatId);\n  if (!chatMessages) {\n    return undefined;\n  }\n\n  return Object.keys(chatMessages)\n    .map(Number)\n    .filter((id) => chatMessages[id].groupedId === groupedId);\n}\n\nexport function selectIsDocumentGroupSelected<T extends GlobalState>(\n  global: T, chatId: string, groupedId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds: selectedIds } = selectTabState(global, tabId).selectedMessages || {};\n  if (!selectedIds) {\n    return false;\n  }\n\n  const groupIds = selectMessageIdsByGroupId(global, chatId, groupedId);\n  return groupIds && groupIds.every((id) => selectedIds.includes(id));\n}\n\nexport function selectSelectedMessagesCount<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds } = selectTabState(global, tabId).selectedMessages || {};\n\n  return messageIds ? messageIds.length : 0;\n}\n\nexport function selectNewestMessageWithBotKeyboardButtons<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId = MAIN_THREAD_ID,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ApiMessage | undefined {\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const chatMessages = selectChatMessages(global, chatId);\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n  if (!chatMessages || !viewportIds) {\n    return undefined;\n  }\n\n  const messageId = findLast(viewportIds, (id) => {\n    const message = chatMessages[id];\n    return message && selectShouldDisplayReplyKeyboard(global, message);\n  });\n\n  const replyHideMessageId = findLast(viewportIds, (id) => {\n    const message = chatMessages[id];\n    return message && selectShouldHideReplyKeyboard(global, message);\n  });\n\n  if (messageId && replyHideMessageId && replyHideMessageId > messageId) {\n    return undefined;\n  }\n\n  return messageId ? chatMessages[messageId] : undefined;\n}\n\nfunction selectShouldHideReplyKeyboard<T extends GlobalState>(global: T, message: ApiMessage) {\n  const {\n    shouldHideKeyboardButtons,\n    isHideKeyboardSelective,\n    isMentioned,\n  } = message;\n  if (!shouldHideKeyboardButtons) return false;\n\n  const replyToMessageId = getMessageReplyInfo(message)?.replyToMsgId;\n\n  if (isHideKeyboardSelective) {\n    if (isMentioned) return true;\n    if (!replyToMessageId) return false;\n\n    const replyMessage = selectChatMessage(global, message.chatId, replyToMessageId);\n    return Boolean(replyMessage?.senderId === global.currentUserId);\n  }\n  return true;\n}\n\nfunction selectShouldDisplayReplyKeyboard<T extends GlobalState>(global: T, message: ApiMessage) {\n  const {\n    keyboardButtons,\n    shouldHideKeyboardButtons,\n    isKeyboardSelective,\n    isMentioned,\n  } = message;\n  if (!keyboardButtons || shouldHideKeyboardButtons) return false;\n\n  const replyToMessageId = getMessageReplyInfo(message)?.replyToMsgId;\n\n  if (isKeyboardSelective) {\n    if (isMentioned) return true;\n    if (!replyToMessageId) return false;\n\n    const replyMessage = selectChatMessage(global, message.chatId, replyToMessageId);\n    return Boolean(replyMessage?.senderId === global.currentUserId);\n  }\n\n  return true;\n}\n\nexport function selectCanAutoLoadMedia<T extends GlobalState>(\n  global: T, message: ApiMessage | ApiSponsoredMessage,\n) {\n  const chat = selectChat(global, message.chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const sender = 'id' in message ? selectSender(global, message) : undefined;\n\n  const webPage = selectWebPageFromMessage(global, message);\n  const isPhoto = Boolean(getMessagePhoto(message) || getWebPagePhoto(webPage));\n  const isVideo = Boolean(getMessageVideo(message) || getWebPageVideo(webPage));\n  const isFile = Boolean(getMessageAudio(message) || getMessageVoice(message) || getMessageDocument(message));\n\n  const {\n    canAutoLoadPhotoFromContacts,\n    canAutoLoadPhotoInPrivateChats,\n    canAutoLoadPhotoInGroups,\n    canAutoLoadPhotoInChannels,\n    canAutoLoadVideoFromContacts,\n    canAutoLoadVideoInPrivateChats,\n    canAutoLoadVideoInGroups,\n    canAutoLoadVideoInChannels,\n    canAutoLoadFileFromContacts,\n    canAutoLoadFileInPrivateChats,\n    canAutoLoadFileInGroups,\n    canAutoLoadFileInChannels,\n  } = global.settings.byKey;\n\n  if (isPhoto) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadPhotoFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadPhotoInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadPhotoInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadPhotoInChannels,\n    });\n  }\n\n  if (isVideo) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadVideoFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadVideoInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadVideoInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadVideoInChannels,\n    });\n  }\n\n  if (isFile) {\n    return canAutoLoadMedia({\n      global,\n      chat,\n      sender,\n      canAutoLoadMediaFromContacts: canAutoLoadFileFromContacts,\n      canAutoLoadMediaInPrivateChats: canAutoLoadFileInPrivateChats,\n      canAutoLoadMediaInGroups: canAutoLoadFileInGroups,\n      canAutoLoadMediaInChannels: canAutoLoadFileInChannels,\n    });\n  }\n\n  return true;\n}\n\nfunction canAutoLoadMedia<T extends GlobalState>({\n  global,\n  chat,\n  sender,\n  canAutoLoadMediaFromContacts,\n  canAutoLoadMediaInPrivateChats,\n  canAutoLoadMediaInGroups,\n  canAutoLoadMediaInChannels,\n}: {\n  global: T;\n  chat: ApiChat;\n  canAutoLoadMediaFromContacts: boolean;\n  canAutoLoadMediaInPrivateChats: boolean;\n  canAutoLoadMediaInGroups: boolean;\n  canAutoLoadMediaInChannels: boolean;\n  sender?: ApiPeer;\n}) {\n  const isMediaFromContact = Boolean(sender && (\n    selectIsChatWithSelf(global, sender.id) || selectUser(global, sender.id)?.isContact\n  ));\n\n  return Boolean(\n    (isMediaFromContact && canAutoLoadMediaFromContacts)\n    || (!isMediaFromContact && canAutoLoadMediaInPrivateChats && isUserId(chat.id))\n    || (canAutoLoadMediaInGroups && isChatGroup(chat))\n    || (canAutoLoadMediaInChannels && isChatChannel(chat)),\n  );\n}\n\nexport function selectLastServiceNotification<T extends GlobalState>(global: T) {\n  const { serviceNotifications } = global;\n  const maxId = Math.max(...serviceNotifications.map(({ id }) => id));\n\n  return serviceNotifications.find(({ id, isDeleted }) => !isDeleted && id === maxId);\n}\n\nexport function selectIsMessageProtected<T extends GlobalState>(global: T, message?: ApiMessage) {\n  return Boolean(message && (\n    message.isProtected || selectIsChatProtected(global, message.chatId) || hasMessageTtl(message)\n    || getMessagePaidMedia(message)\n  ));\n}\n\nexport function selectIsChatProtected<T extends GlobalState>(global: T, chatId: string) {\n  return selectChat(global, chatId)?.isProtected || false;\n}\n\nexport function selectHasProtectedMessage<T extends GlobalState>(global: T, chatId: string, messageIds?: number[]) {\n  if (selectChat(global, chatId)?.isProtected) {\n    return true;\n  }\n\n  if (!messageIds) {\n    return false;\n  }\n\n  const messages = selectChatMessages(global, chatId);\n\n  return messageIds.some((messageId) => messages[messageId]?.isProtected);\n}\n\nexport function selectCanForwardMessages<T extends GlobalState>(global: T, chatId: string, messageIds?: number[]) {\n  if (selectChat(global, chatId)?.isProtected) {\n    return false;\n  }\n\n  if (!messageIds) {\n    return false;\n  }\n\n  const messages = selectChatMessages(global, chatId);\n\n  return messageIds\n    .map((id) => messages[id])\n    .every((message) => message && !hasMessageTtl(message)\n      && (message.isForwardingAllowed || isServiceNotificationMessage(message)));\n}\n\nexport function selectHasIpRevealingMedia<T extends GlobalState>(global: T, chatId: string, messageIds: number[]) {\n  const messages = selectChatMessages(global, chatId);\n\n  return messageIds\n    .map((id) => messages[id])\n    .some((message) => {\n      if (!message) return false;\n\n      const document = getMessageDocument(message);\n      if (!document) return false;\n\n      const extension = getDocumentExtension(document);\n      if (!extension) return false;\n\n      return isIpRevealingMedia({ mimeType: document.mimeType, extension });\n    });\n}\n\nexport function selectSponsoredMessage<T extends GlobalState>(global: T, chatId: string) {\n  const message = global.messages.sponsoredByChatId[chatId];\n\n  return message && message.expiresAt >= Math.round(Date.now() / 1000) ? message : undefined;\n}\n\nexport function selectDefaultReaction<T extends GlobalState>(global: T, chatId: string) {\n  if (chatId === SERVICE_NOTIFICATIONS_USER_ID) return undefined;\n\n  const isPrivate = isUserId(chatId);\n  const defaultReaction = global.config?.defaultReaction;\n  if (!defaultReaction) {\n    return undefined;\n  }\n\n  if (isPrivate) {\n    return defaultReaction;\n  }\n\n  const chatReactions = selectChatFullInfo(global, chatId)?.enabledReactions;\n  if (!chatReactions || !canSendReaction(defaultReaction, chatReactions)) {\n    return undefined;\n  }\n\n  return defaultReaction;\n}\n\nexport function selectMaxUserReactions<T extends GlobalState>(global: T): number {\n  return selectCurrentLimit(global, 'maxReactions');\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectVisibleUsers<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const messageIds = selectTabThreadParam(global, chatId, threadId, 'viewportIds', tabId);\n  if (!messageIds) {\n    return undefined;\n  }\n\n  return messageIds.map((messageId) => {\n    const { senderId } = selectChatMessage(global, chatId, messageId) || {};\n    return senderId ? selectUser(global, senderId) : undefined;\n  }).filter(Boolean);\n}\n\nexport function selectShouldSchedule<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectCurrentMessageList(global, tabId)?.type === 'scheduled';\n}\n\nexport function selectCanSchedule<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chatId = selectCurrentMessageList(global, tabId)?.chatId;\n  const paidMessagesStars = chatId ? selectPeerPaidMessagesStars(global, chatId) : undefined;\n  return !paidMessagesStars;\n}\n\nexport function selectCanScheduleUntilOnline<T extends GlobalState>(global: T, id: string) {\n  const isChatWithSelf = selectIsChatWithSelf(global, id);\n  const chatBot = selectBot(global, id);\n  const paidMessagesStars = selectPeerPaidMessagesStars(global, id);\n  return Boolean(!paidMessagesStars\n    && !isChatWithSelf && !chatBot && isUserId(id) && selectUserStatus(global, id)?.wasOnline);\n}\n\nexport function selectCustomEmojis(message: ApiMessage) {\n  const entities = message.content.text?.entities;\n  return entities?.filter((entity): entity is ApiMessageEntityCustomEmoji => (\n    entity.type === ApiMessageEntityTypes.CustomEmoji\n  ));\n}\n\nexport function selectMessageCustomEmojiSets<T extends GlobalState>(\n  global: T, message: ApiMessage,\n): ApiStickerSetInfo[] | undefined {\n  const customEmojis = selectCustomEmojis(message);\n  if (!customEmojis) return MEMO_EMPTY_ARRAY;\n  const documents = customEmojis.map((entity) => selectCustomEmoji(global, entity.documentId));\n  // If some emoji still loading, do not return empty array\n  if (!documents.every(Boolean)) return undefined;\n  const sets = documents.map((doc) => doc.stickerSetInfo);\n\n  return sets.reduce((acc, set) => {\n    if ('shortName' in set) {\n      if (acc.some((s) => 'shortName' in s && s.shortName === set.shortName)) {\n        return acc;\n      }\n    }\n\n    if ('id' in set) {\n      if (acc.some((s) => 'id' in s && s.id === set.id)) {\n        return acc;\n      }\n    }\n    acc.push(set); // Optimization\n    return acc;\n  }, [] as ApiStickerSetInfo[]);\n}\n\nexport function selectForwardsContainVoiceMessages<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds, fromChatId } = selectTabState(global, tabId).forwardMessages;\n  if (!messageIds) return false;\n  const chatMessages = selectChatMessages(global, fromChatId!);\n  return messageIds.some((messageId) => {\n    const message = chatMessages[messageId];\n    return Boolean(message.content.voice) || Boolean(message.content.video?.isRound);\n  });\n}\n\nexport function selectChatTranslations<T extends GlobalState>(\n  global: T, chatId: string,\n): ChatTranslatedMessages {\n  return global.translations.byChatId[chatId];\n}\n\nexport function selectMessageTranslations<T extends GlobalState>(\n  global: T, chatId: string, toLanguageCode: string,\n) {\n  return selectChatTranslations(global, chatId)?.byLangCode[toLanguageCode] || {};\n}\n\nexport function selectRequestedMessageTranslationLanguage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): string | undefined {\n  const requestedInChat = selectTabState(global, tabId).requestedTranslations.byChatId[chatId];\n  return requestedInChat?.toLanguage || requestedInChat?.manualMessages?.[messageId];\n}\nexport function selectReplyCanBeSentToChat<T extends GlobalState>(\n  global: T,\n  toChatId: string,\n  fromChatId: string,\n  replyInfo: ApiInputMessageReplyInfo,\n) {\n  if (!replyInfo.replyToMsgId) return false;\n  const fromRealChatId = replyInfo?.replyToPeerId ?? fromChatId;\n  if (toChatId === fromRealChatId) return true;\n  const chatMessages = selectChatMessages(global, fromRealChatId);\n  const message = chatMessages[replyInfo.replyToMsgId];\n\n  return !isExpiredMessage(message);\n}\nexport function selectForwardsCanBeSentToChat<T extends GlobalState>(\n  global: T,\n  toChatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { messageIds, storyId, fromChatId } = selectTabState(global, tabId).forwardMessages;\n  const chat = selectChat(global, toChatId);\n  if ((!messageIds && !storyId) || !chat) return false;\n\n  if (storyId) {\n    return true;\n  }\n\n  const chatFullInfo = selectChatFullInfo(global, toChatId);\n  const chatMessages = selectChatMessages(global, fromChatId!);\n\n  const isSavedMessages = toChatId ? selectIsChatWithSelf(global, toChatId) : undefined;\n  const isChatWithBot = toChatId ? selectIsChatWithBot(global, chat) : undefined;\n  const options = getAllowedAttachmentOptions(chat, chatFullInfo, isChatWithBot, isSavedMessages);\n  return !messageIds!.some((messageId) => heckMessageSendingDenied(chatMessages[messageId], options));\n}\nfunction heckMessageSendingDenied(message: ApiMessage, options: IAllowedAttachmentOptions) {\n  const isVoice = message.content.voice;\n  const isRoundVideo = message.content.video?.isRound;\n  const isPhoto = message.content.photo;\n  const isGif = message.content.video?.isGif;\n  const isVideo = message.content.video && !isRoundVideo && !isGif;\n  const isAudio = message.content.audio;\n  const isDocument = message.content.document;\n  const isSticker = message.content.sticker;\n  const isPlainText = message.content.text\n    && !isVoice && !isRoundVideo && !isSticker && !isDocument && !isAudio && !isVideo && !isPhoto && !isGif;\n\n  return (isVoice && !options.canSendVoices)\n    || (isRoundVideo && !options.canSendRoundVideos)\n    || (isSticker && !options.canSendStickers)\n    || (isDocument && !options.canSendDocuments)\n    || (isAudio && !options.canSendAudios)\n    || (isVideo && !options.canSendVideos)\n    || (isPhoto && !options.canSendPhotos)\n    || (isGif && !options.canSendGifs)\n    || (isPlainText && !options.canSendPlainText);\n}\n\nexport function selectCanTranslateMessage<T extends GlobalState>(\n  global: T, message: ApiMessage, detectedLanguage?: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { canTranslate: isTranslationEnabled, doNotTranslate } = global.settings.byKey;\n\n  const canTranslateLanguage = !detectedLanguage || !doNotTranslate.includes(detectedLanguage);\n\n  const isTranslatable = isMessageTranslatable(message);\n\n  // Separate translations are disabled when chat translation enabled\n  const chatRequestedLanguage = selectRequestedChatTranslationLanguage(global, message.chatId, tabId);\n\n  return IS_TRANSLATION_SUPPORTED && isTranslationEnabled && canTranslateLanguage && isTranslatable\n    && !chatRequestedLanguage;\n}\n\nexport function selectTopicLink<T extends GlobalState>(\n  global: T, chatId: string, topicId?: ThreadId,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat || !chat.isForum || chat.isBotForum) {\n    return undefined;\n  }\n\n  return getMessageLink(chat, topicId);\n}\n\nexport function selectMessageReplyInfo<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, additionalReplyInfo?: ApiInputMessageReplyInfo,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n  const isMainThread = threadId === MAIN_THREAD_ID;\n  if (!additionalReplyInfo && isMainThread) return undefined;\n\n  const replyInfo: ApiInputMessageReplyInfo = {\n    type: 'message',\n    ...additionalReplyInfo,\n    replyToMsgId: additionalReplyInfo?.replyToMsgId || Number(threadId),\n    replyToTopId: additionalReplyInfo?.replyToTopId || (!isMainThread ? Number(threadId) : undefined),\n  };\n\n  return replyInfo;\n}\n\nexport function selectReplyMessage<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { replyToMsgId, replyToPeerId } = getMessageReplyInfo(message) || {};\n  const replyMessage = replyToMsgId\n    ? selectChatMessage(global, replyToPeerId || message.chatId, replyToMsgId) : undefined;\n\n  return replyMessage;\n}\n\nexport function selectActiveRestrictionReasons<T extends GlobalState>(\n  global: T, restrictionReasons?: ApiRestrictionReason[],\n): ApiRestrictionReason[] {\n  if (!restrictionReasons) return [];\n\n  const { ignoreRestrictionReasons } = global.appConfig;\n\n  return restrictionReasons.filter((reason) => {\n    const isForCurrentPlatform = reason.platform === 'all' || reason.platform === WEB_APP_PLATFORM;\n    if (!isForCurrentPlatform) return false;\n\n    const shouldIgnore = ignoreRestrictionReasons?.includes(reason.reason);\n    return !shouldIgnore;\n  });\n}\n","import { getActions } from '../global';\n\nimport { PRODUCTION_HOSTNAME, WEB_VERSION_BASE } from '../config';\nimport { clearWebsync } from './websync';\n\ntype AvailableVersions = 'Z' | 'K';\n\nconst SEARCH_ENGINE_REGEX = /(^|\\.)(google|bing|duckduckgo|ya|yandex)\\./i;\n// Handled by the legacy version. Cannot be updated\nconst PERMANENT_VERSION_KEY = 'kz_version';\nconst CLIENT_VERSION: AvailableVersions = 'Z';\n\nfunction setPermanentWebVersion(version: AvailableVersions) {\n  localStorage.setItem(PERMANENT_VERSION_KEY, JSON.stringify(version));\n}\n\nexport function getPermanentWebVersion(): AvailableVersions | undefined {\n  const version = localStorage.getItem(PERMANENT_VERSION_KEY);\n  if (version) {\n    return JSON.parse(version);\n  }\n\n  return undefined;\n}\n\nexport function switchPermanentWebVersion(version: AvailableVersions) {\n  setPermanentWebVersion(version);\n  clearWebsync();\n  getActions().skipLockOnUnload();\n  window.location.assign(`${WEB_VERSION_BASE}${version.toLowerCase()}`);\n}\n\nexport function checkAndAssignPermanentWebVersion() {\n  if (window.location.hostname !== PRODUCTION_HOSTNAME) return;\n\n  const referrer = document.referrer.toLowerCase();\n  if (!referrer) return;\n  try {\n    const isSearchEngine = new URL(referrer).host.match(SEARCH_ENGINE_REGEX);\n    if (!isSearchEngine) return;\n\n    const currentVersion = getPermanentWebVersion();\n    if (currentVersion) {\n      if (currentVersion !== CLIENT_VERSION) {\n        switchPermanentWebVersion(currentVersion);\n      }\n      return;\n    }\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const hasTest = (urlParams.get('test') ?? undefined) !== undefined;\n    const shouldRedirect = Math.random() < 0.5;\n\n    if (hasTest || !shouldRedirect) {\n      setPermanentWebVersion('Z');\n      return;\n    }\n\n    switchPermanentWebVersion('K');\n  } catch (e) {\n    // Ignore\n  }\n}\n","import type { ChangeEvent } from 'react';\nimport type { FC, TeactNode } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport {\n  memo,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\n\nimport type { ApiPeer } from '../../api/types';\nimport type { IconName } from '../../types/icons';\nimport type { IRadioOption } from './CheckboxGroup';\n\nimport buildClassName from '../../util/buildClassName';\nimport { REM } from '../common/helpers/mediaDimensions';\nimport renderText from '../common/helpers/renderText';\n\nimport useCurrentOrPrev from '../../hooks/useCurrentOrPrev';\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Avatar from '../common/Avatar';\nimport Icon from '../common/icons/Icon';\nimport Button from './Button';\nimport Spinner from './Spinner';\n\nimport './Checkbox.scss';\n\ntype OwnProps = {\n  id?: string;\n  name?: string;\n  value?: string;\n  peer?: ApiPeer;\n  label?: TeactNode;\n  labelText?: TeactNode;\n  subLabel?: string;\n  checked?: boolean;\n  rightIcon?: IconName;\n  disabled?: boolean;\n  tabIndex?: number;\n  withIcon?: boolean;\n  blocking?: boolean;\n  permissionGroup?: boolean;\n  isLoading?: boolean;\n  withCheckedCallback?: boolean;\n  onlyInput?: boolean;\n  isRound?: boolean;\n  className?: string;\n  nestedCheckbox?: boolean;\n  nestedCheckboxCount?: number | undefined;\n  nestedOptionList?: IRadioOption[];\n  leftElement?: TeactNode;\n  values?: string[];\n  onChange?: (e: ChangeEvent<HTMLInputElement>, nestedOptionList?: IRadioOption[]) => void;\n  onCheck?: (isChecked: boolean) => void;\n  onClickLabel?: (e: React.MouseEvent, value?: string) => void;\n};\nconst AVATAR_SIZE = 1.25 * REM;\n\nconst Checkbox: FC<OwnProps> = ({\n  id,\n  name,\n  value,\n  label,\n  peer,\n  labelText,\n  subLabel,\n  checked,\n  tabIndex,\n  disabled,\n  withIcon,\n  blocking,\n  permissionGroup,\n  isLoading,\n  className,\n  rightIcon,\n  onlyInput,\n  isRound,\n  nestedCheckbox,\n  nestedCheckboxCount,\n  nestedOptionList,\n  leftElement,\n  values,\n  onChange,\n  onCheck,\n  onClickLabel,\n}) => {\n  const lang = useLang();\n  const labelRef = useRef<HTMLLabelElement>();\n  const [showNested, setShowNested] = useState(false);\n  const renderingPeer = useCurrentOrPrev(peer, true);\n\n  const handleChange = useLastCallback((event: ChangeEvent<HTMLInputElement>) => {\n    if (disabled) {\n      return;\n    }\n\n    if (onChange) {\n      onChange(event, nestedOptionList);\n    }\n\n    if (onCheck) {\n      onCheck(event.currentTarget.checked);\n    }\n  });\n\n  const toggleNested = useLastCallback(() => {\n    setShowNested(!showNested);\n  });\n\n  function handleClick(event: React.MouseEvent) {\n    if (event.target !== labelRef.current) {\n      onClickLabel?.(event, value);\n    }\n  }\n\n  function handleInputClick(event: React.MouseEvent) {\n    event.stopPropagation();\n  }\n\n  const labelClassName = buildClassName(\n    'Checkbox',\n    disabled && 'disabled',\n    withIcon && 'withIcon',\n    isLoading && 'loading',\n    blocking && 'blocking',\n    nestedCheckbox && 'nested',\n    subLabel && 'withSubLabel',\n    permissionGroup && 'permission-group',\n    Boolean(leftElement) && 'avatar',\n    onlyInput && 'onlyInput',\n    isRound && 'round',\n    Boolean(rightIcon) && 'withNestedList',\n    className,\n  );\n\n  return (\n    <>\n      {/* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */}\n      <label\n        className={labelClassName}\n        dir={lang.isRtl ? 'rtl' : undefined}\n        onClick={onClickLabel ? handleClick : undefined}\n        ref={labelRef}\n      >\n        <input\n          type=\"checkbox\"\n          id={id}\n          name={name}\n          value={value}\n          checked={checked}\n          disabled={disabled}\n          tabIndex={tabIndex}\n          onChange={handleChange}\n          onClick={onClickLabel ? handleInputClick : undefined}\n        />\n        <div className={buildClassName(\n          'Checkbox-main',\n          Boolean(leftElement) && 'Nested-avatar-list',\n        )}\n        >\n          <div className={buildClassName('user-avatar', renderingPeer && 'user-avatar-visible')}>\n            {renderingPeer && (\n              <Avatar\n                peer={renderingPeer}\n                size={AVATAR_SIZE}\n              />\n            )}\n          </div>\n          <span className=\"label\" dir=\"auto\">\n            {leftElement}\n            {typeof label === 'string' ? renderText(label) : label}\n            {Boolean(labelText) && <span className=\"ml-1\">{renderText(labelText)}</span>}\n          </span>\n          {subLabel && <span className=\"subLabel\" dir=\"auto\">{renderText(subLabel)}</span>}\n          {rightIcon && <Icon name={rightIcon} className=\"right-icon\" />}\n        </div>\n        {nestedCheckbox && (\n          <span className=\"nestedButton\" dir=\"auto\">\n            <Button className=\"button\" color=\"translucent\" size=\"smaller\" onClick={toggleNested}>\n              <Icon name=\"group-filled\" className=\"group-icon\" />\n              {nestedCheckboxCount}\n              <Icon name={showNested ? 'up' : 'down'} />\n            </Button>\n          </span>\n        )}\n        {isLoading && <Spinner />}\n      </label>\n      {nestedCheckbox && (\n        <div\n          className={buildClassName('nested-checkbox-group', showNested && 'nested-checkbox-group-open')}\n        >\n          {nestedOptionList?.map((nestedOption) => (\n            <Checkbox\n              key={nestedOption.value}\n              leftElement={leftElement}\n              onChange={handleChange}\n              checked={values?.indexOf(nestedOption.value) !== -1}\n              values={values}\n\n              {...nestedOption}\n            />\n          ))}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default memo(Checkbox);\n","import type { Scheduler } from './schedulers';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\n\ninterface AnimationInstance {\n  isCancelled: boolean;\n}\ntype TickFunction = () => boolean | undefined;\n\nlet currentInstance: AnimationInstance | undefined;\n\nexport function animateSingle(tick: TickFunction, schedulerFn: Scheduler, instance?: AnimationInstance) {\n  if (!instance) {\n    if (currentInstance && !currentInstance.isCancelled) {\n      currentInstance.isCancelled = true;\n    }\n\n    instance = { isCancelled: false };\n    currentInstance = instance;\n  }\n\n  if (!instance.isCancelled && tick()) {\n    schedulerFn(() => {\n      animateSingle(tick, schedulerFn, instance);\n    });\n  }\n}\n\nexport function cancelSingleAnimation() {\n  const dumbScheduler = (cb: AnyFunction) => cb;\n  const dumbCb = () => undefined;\n\n  animateSingle(dumbCb, dumbScheduler);\n}\n\nexport function animate(tick: TickFunction, schedulerFn: Scheduler) {\n  schedulerFn(() => {\n    if (tick()) {\n      animate(tick, schedulerFn);\n    }\n  });\n}\n\nexport function animateInstantly(tick: TickFunction, schedulerFn: Scheduler) {\n  if (tick()) {\n    schedulerFn(() => {\n      animateInstantly(tick, schedulerFn);\n    });\n  }\n}\n\ntype TimingFn = (t: number) => number;\n\ntype AnimateNumberProps<T extends number | number[]> = {\n  to: T;\n  from: T;\n  duration: number;\n  onUpdate: (value: T) => void;\n  timing?: TimingFn;\n  onEnd?: (isCanceled?: boolean) => void;\n};\n\nexport const timingFunctions = {\n  linear: (t: number) => t,\n  easeIn: (t: number) => t ** 1.675,\n  easeOut: (t: number) => -1 * t ** 1.675,\n  easeInOut: (t: number) => 0.5 * (Math.sin((t - 0.5) * Math.PI) + 1),\n  easeInQuad: (t: number) => t * t,\n  easeOutQuad: (t: number) => t * (2 - t),\n  easeInOutQuad: (t: number) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\n  easeInCubic: (t: number) => t ** 3,\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\n  easeInOutCubic: (t: number) => (t < 0.5 ? 4 * t ** 3 : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1),\n  easeInQuart: (t: number) => t ** 4,\n  easeOutQuart: (t: number) => 1 - (--t) * t ** 3,\n  easeInOutQuart: (t: number) => (t < 0.5 ? 8 * t ** 4 : 1 - 8 * (--t) * t ** 3),\n  easeInQuint: (t: number) => t ** 5,\n  easeOutQuint: (t: number) => 1 + (--t) * t ** 4,\n  easeInOutQuint: (t: number) => (t < 0.5 ? 16 * t ** 5 : 1 + 16 * (--t) * t ** 4),\n};\n\nexport function animateNumber<T extends number | number[]>({\n  timing = timingFunctions.linear,\n  onUpdate,\n  duration,\n  onEnd,\n  from,\n  to,\n}: AnimateNumberProps<T>) {\n  const t0 = Date.now();\n\n  let isCanceled = false;\n\n  animateInstantly(() => {\n    if (isCanceled) return false;\n\n    const t1 = Date.now();\n    const t = Math.min((t1 - t0) / duration, 1);\n\n    const progress = timing(t);\n    if (typeof from === 'number' && typeof to === 'number') {\n      onUpdate((from + ((to - from) * progress)) as T);\n    } else if (Array.isArray(from) && Array.isArray(to)) {\n      const result = from.map((f, i) => f + ((to[i] - f) * progress));\n      onUpdate(result as T);\n    }\n\n    if (t === 1) {\n      onEnd?.();\n    }\n\n    return t < 1;\n  }, requestMeasure);\n\n  return () => {\n    isCanceled = true;\n    onEnd?.(true);\n  };\n}\n\nexport function applyStyles(element: HTMLElement, css: Record<string, string>) {\n  Object.assign(element.style, css);\n}\n","import type {\n  ApiUser, ApiUserCommonChats,\n  ApiUserFullInfo, ApiUserStatus,\n} from '../../api/types';\nimport type { BotAppPermissions } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { isUserBot } from '../helpers';\n\nexport function selectUser<T extends GlobalState>(global: T, userId: string): ApiUser | undefined {\n  return global.users.byId[userId];\n}\n\nexport function selectUserStatus<T extends GlobalState>(global: T, userId: string): ApiUserStatus | undefined {\n  return global.users.statusesById[userId];\n}\n\nexport function selectUserFullInfo<T extends GlobalState>(global: T, userId: string): ApiUserFullInfo | undefined {\n  return global.users.fullInfoById[userId];\n}\n\nexport function selectUserCommonChats<T extends GlobalState>(\n  global: T, userId: string,\n): ApiUserCommonChats | undefined {\n  return global.users.commonChatsById[userId];\n}\n\nexport function selectIsUserBlocked<T extends GlobalState>(global: T, userId: string) {\n  return selectUserFullInfo(global, userId)?.isBlocked;\n}\n\nexport function selectIsCurrentUserPremium<T extends GlobalState>(global: T) {\n  if (!global.currentUserId) return false;\n\n  return Boolean(global.users.byId[global.currentUserId].isPremium);\n}\n\nexport function selectIsCurrentUserFrozen<T extends GlobalState>(global: T) {\n  return Boolean(global.appConfig.freezeUntilDate);\n}\n\nexport function selectIsPremiumPurchaseBlocked<T extends GlobalState>(global: T) {\n  return global.appConfig.isPremiumPurchaseBlocked ?? true;\n}\n\nexport function selectIsGiveawayGiftsPurchaseAvailable<T extends GlobalState>(global: T) {\n  return global.appConfig.isGiveawayGiftsPurchaseAvailable ?? true;\n}\n\n/**\n * Slow, not to be used in `withGlobal`\n */\nexport function selectUserByPhoneNumber<T extends GlobalState>(global: T, phoneNumber: string) {\n  const phoneNumberCleaned = phoneNumber.replace(/[^0-9]/g, '');\n\n  return Object.values(global.users.byId).find((user) => user?.phoneNumber === phoneNumberCleaned);\n}\n\nexport function selectBot<T extends GlobalState>(global: T, userId: string): ApiUser | undefined {\n  const user = selectUser(global, userId);\n  if (!user || !isUserBot(user)) {\n    return undefined;\n  }\n\n  return user;\n}\n\nexport function selectBotAppPermissions<T extends GlobalState>(\n  global: T, userId: string,\n): BotAppPermissions | undefined {\n  return global.users.botAppPermissionsById[userId];\n}\n","import Teact, { type Props } from './teact';\nexport type { JSX } from 'react';\nexport const Fragment = Teact.Fragment;\n\nfunction create(type: any, props: Props = {}, key?: any) {\n  if (key !== undefined) props.key = key;\n  const children = props.children;\n  if (props.children !== undefined) props.children = undefined;\n  return Teact.createElement(type, props, children);\n}\n\nexport function jsx(type: any, props: Props, key?: any) {\n  return create(type, props, key);\n}\n\n// Not implemented, reusing jsx for now\nexport const jsxs = jsx;\nexport const jsxDEV = jsx;\n","import type { ApiChatType, ApiPhoto } from '../../api/types';\nimport type { WebApp } from '../../types/webapp';\n\nimport { REPLIES_USER_ID, VERIFICATION_CODES_USER_ID } from '../../config';\n\nexport function getBotCoverMediaHash(photo: ApiPhoto) {\n  return `photo${photo.id}?size=x`;\n}\n\nexport function convertToApiChatType(type: string): ApiChatType | undefined {\n  if (type === 'channels') return 'channels';\n  if (type === 'chats' || type === 'groups') return 'chats';\n  if (type === 'users') return 'users';\n  if (type === 'bots') return 'bots';\n  return undefined;\n}\n\nexport function getWebAppKey(webApp: Partial<WebApp>) {\n  if (webApp.requestUrl) return webApp.requestUrl;\n  if (webApp.appName) return `${webApp.botId}?appName=${webApp.appName}`;\n  return webApp.botId!;\n}\n\nexport function isSystemBot(botId: string) {\n  return botId === REPLIES_USER_ID || botId === VERIFICATION_CODES_USER_ID;\n}\n","import type { PerformanceType } from '../types';\nimport type { GlobalState, SharedState, TabState } from './types';\nimport { LeftColumnContent, NewChatMembersProgress, SettingsScreens } from '../types';\n\nimport {\n  ANIMATION_LEVEL_DEFAULT,\n  DARK_THEME_PATTERN_COLOR,\n  DEFAULT_GIFT_PROFILE_FILTER_OPTIONS,\n  DEFAULT_MESSAGE_TEXT_SIZE_PX,\n  DEFAULT_PATTERN_COLOR,\n  DEFAULT_PLAYBACK_RATE,\n  DEFAULT_RESALE_GIFTS_FILTER_OPTIONS,\n  DEFAULT_VOLUME,\n  FOLDERS_POSITION_DEFAULT,\n  IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX,\n  MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX,\n} from '../config';\nimport { IS_IOS, IS_MAC_OS } from '../util/browser/windowEnvironment';\nimport { DEFAULT_APP_CONFIG } from '../limits';\n\nexport const INITIAL_PERFORMANCE_STATE_MAX: PerformanceType = {\n  animatedEmoji: true,\n  autoplayGifs: true,\n  autoplayVideos: true,\n  contextMenuAnimations: true,\n  contextMenuBlur: true,\n  loopAnimatedStickers: true,\n  mediaViewerAnimations: true,\n  messageComposerAnimations: true,\n  messageSendingAnimations: true,\n  pageTransitions: true,\n  reactionEffects: true,\n  rightColumnAnimations: true,\n  stickerEffects: true,\n  storyRibbonAnimations: true,\n  snapEffect: true,\n};\n\nexport const INITIAL_PERFORMANCE_STATE_MED: PerformanceType = {\n  animatedEmoji: true,\n  autoplayGifs: true,\n  autoplayVideos: true,\n  contextMenuAnimations: true,\n  contextMenuBlur: true,\n  loopAnimatedStickers: true,\n  mediaViewerAnimations: true,\n  messageComposerAnimations: true,\n  messageSendingAnimations: true,\n  pageTransitions: true,\n  reactionEffects: true,\n  rightColumnAnimations: false,\n  stickerEffects: true,\n  storyRibbonAnimations: true,\n  snapEffect: false,\n};\n\nexport const INITIAL_PERFORMANCE_STATE_MIN: PerformanceType = {\n  animatedEmoji: false,\n  autoplayGifs: false,\n  autoplayVideos: false,\n  contextMenuAnimations: false,\n  contextMenuBlur: false,\n  loopAnimatedStickers: false,\n  mediaViewerAnimations: false,\n  messageComposerAnimations: false,\n  messageSendingAnimations: false,\n  pageTransitions: false,\n  reactionEffects: false,\n  rightColumnAnimations: false,\n  stickerEffects: false,\n  storyRibbonAnimations: false,\n  snapEffect: false,\n};\n\nexport const INITIAL_SHARED_STATE: SharedState = {\n  settings: {\n    theme: 'light',\n    shouldUseSystemTheme: true,\n    messageTextSize: IS_IOS\n      ? IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX\n      : (IS_MAC_OS ? MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX : DEFAULT_MESSAGE_TEXT_SIZE_PX),\n    animationLevel: ANIMATION_LEVEL_DEFAULT,\n    foldersPosition: FOLDERS_POSITION_DEFAULT,\n    messageSendKeyCombo: 'enter',\n    performance: INITIAL_PERFORMANCE_STATE_MAX,\n    shouldSkipWebAppCloseConfirmation: false,\n    language: 'en',\n    timeFormat: '24h',\n    wasTimeFormatSetManually: false,\n    isConnectionStatusMinimized: true,\n    canDisplayChatInTitle: true,\n    shouldAllowHttpTransport: true,\n    shouldWarnAboutFiles: true,\n  },\n  isInitial: true,\n};\n\nexport const INITIAL_GLOBAL_STATE: GlobalState = {\n  cacheVersion: 2,\n  isInited: true,\n  attachMenu: { bots: {} },\n  passcode: {},\n  twoFaSettings: {},\n  isAppUpdateAvailable: false,\n  shouldShowContextMenuHint: true,\n  appConfig: DEFAULT_APP_CONFIG,\n\n  audioPlayer: {\n    volume: DEFAULT_VOLUME,\n    lastPlaybackRate: DEFAULT_PLAYBACK_RATE,\n  },\n\n  mediaViewer: {\n    lastPlaybackRate: DEFAULT_PLAYBACK_RATE,\n  },\n\n  auth: {\n    rememberMe: true,\n  },\n  countryList: {\n    phoneCodes: [],\n    general: [],\n  },\n\n  blocked: {\n    ids: [],\n    totalCount: 0,\n  },\n\n  users: {\n    byId: {},\n    statusesById: {},\n    fullInfoById: {},\n    previewMediaByBotId: {},\n    commonChatsById: {},\n    botAppPermissionsById: {},\n  },\n\n  peers: {\n    profilePhotosById: {},\n  },\n\n  chats: {\n    listIds: {},\n    isFullyLoaded: {},\n    orderedPinnedIds: {},\n    totalCount: {},\n    lastMessageIds: {},\n    byId: {},\n    fullInfoById: {},\n    similarChannelsById: {},\n    similarBotsById: {},\n    topicsInfoById: {},\n    notifyExceptionById: {},\n    loadingParameters: {\n      active: {},\n      archived: {},\n      saved: {},\n    },\n  },\n\n  messages: {\n    byChatId: {},\n    sponsoredByChatId: {},\n    pollById: {},\n    webPageById: {},\n    playbackByChatId: {},\n  },\n\n  stories: {\n    byPeerId: {},\n    albumsByPeerId: {},\n    orderedPeerIds: {\n      archived: [],\n      active: [],\n    },\n    hasNext: true,\n    hasNextInArchive: true,\n    stealthMode: {},\n  },\n\n  groupCalls: {\n    byId: {},\n  },\n\n  attachmentSettings: {\n    shouldCompress: true,\n    defaultAttachmentCompression: 'compress',\n    shouldSendGrouped: true,\n    isInvertedMedia: undefined,\n    webPageMediaSize: undefined,\n    shouldSendInHighQuality: false,\n  },\n\n  scheduledMessages: {\n    byChatId: {},\n  },\n\n  quickReplies: {\n    byId: {},\n    messagesById: {},\n  },\n\n  chatFolders: {\n    byId: {},\n    invites: {},\n    areTagsEnabled: false,\n  },\n\n  fileUploads: {\n    byMessageKey: {},\n  },\n\n  recentEmojis: ['grinning', 'kissing_heart', 'christmas_tree', 'brain', 'trophy', 'duck', 'cherries'],\n  recentCustomEmojis: ['5377305978079288312'],\n\n  reactions: {\n    defaultTags: [],\n    topReactions: [],\n    recentReactions: [],\n    effectReactions: [],\n    hash: {},\n  },\n  availableEffectById: {},\n\n  stickers: {\n    setsById: {},\n    added: {},\n    recent: {\n      stickers: [],\n    },\n    favorite: {\n      stickers: [],\n    },\n    greeting: {\n      stickers: [],\n    },\n    premium: {\n      stickers: [],\n    },\n    featured: {\n      setIds: [],\n    },\n    effect: {\n      stickers: [],\n      emojis: [],\n    },\n    forEmoji: {},\n  },\n\n  customEmojis: {\n    lastRendered: [],\n    byId: {},\n    added: {},\n    forEmoji: {},\n    statusRecent: {},\n  },\n\n  emojiKeywords: {},\n\n  gifs: {\n    saved: {},\n  },\n\n  topPeers: {},\n\n  topInlineBots: {},\n  topBotApps: {},\n\n  activeSessions: {\n    byHash: {},\n    orderedHashes: [],\n  },\n\n  activeWebSessions: {\n    byHash: {},\n    orderedHashes: [],\n  },\n\n  settings: {\n    byKey: {\n      canAutoLoadPhotoFromContacts: true,\n      canAutoLoadPhotoInPrivateChats: true,\n      canAutoLoadPhotoInGroups: true,\n      canAutoLoadPhotoInChannels: true,\n      canAutoLoadVideoFromContacts: true,\n      canAutoLoadVideoInPrivateChats: true,\n      canAutoLoadVideoInGroups: true,\n      canAutoLoadVideoInChannels: true,\n      canAutoLoadFileFromContacts: false,\n      canAutoLoadFileInPrivateChats: false,\n      canAutoLoadFileInGroups: false,\n      canAutoLoadFileInChannels: false,\n      autoLoadFileMaxSizeMb: 10,\n      hasWebNotifications: true,\n      hasPushNotifications: true,\n      notificationSoundVolume: 5,\n      shouldSuggestStickers: true,\n      shouldSuggestCustomEmoji: true,\n      shouldPaidMessageAutoApprove: false,\n      shouldUpdateStickerSetOrder: true,\n      shouldArchiveAndMuteNewNonContact: false,\n      shouldNewNonContactPeersRequirePremium: false,\n      disallowedGifts: undefined,\n      nonContactPeersPaidStars: 0,\n      shouldHideReadMarks: false,\n      canTranslate: false,\n      canTranslateChats: true,\n      doNotTranslate: [],\n    },\n    privacy: {},\n    botVerificationShownPeerIds: [],\n    themes: {\n      light: {\n        isBlurred: true,\n        patternColor: DEFAULT_PATTERN_COLOR,\n      },\n      dark: {\n        isBlurred: true,\n        patternColor: DARK_THEME_PATTERN_COLOR,\n      },\n    },\n    accountDaysTtl: 365,\n  },\n\n  serviceNotifications: [],\n  trustedBotIds: [],\n\n  transcriptions: {},\n  translations: {\n    byChatId: {},\n  },\n\n  byTabId: {},\n  sharedState: INITIAL_SHARED_STATE,\n\n  archiveSettings: {\n    isMinimized: false,\n    isHidden: false,\n  },\n\n  layout: {\n    agentColumnState: 'collapsed',\n    agentColumnWidth: 0,\n    contentMode: 'chat',\n    isPinned: false,\n  },\n\n  alphahuman: {\n    jwtToken: undefined,\n    isThreadsSidebarOpen: false,\n    socketState: 'disconnected',\n    lastAgentUpdate: undefined,\n    streamingContent: undefined,\n    isStreaming: false,\n    isLoggingIn: false,\n  },\n};\n\nexport const INITIAL_TAB_STATE: TabState = {\n  id: 0,\n  isMasterTab: false,\n  isLeftColumnShown: true,\n  newChatMembersProgress: NewChatMembersProgress.Closed,\n  uiReadyState: 0,\n  shouldInit: true,\n\n  gifSearch: {},\n  stickerSearch: {},\n\n  messageLists: [],\n  activeChatFolder: 0,\n  tabThreads: {},\n\n  inlineBots: {\n    isLoading: false,\n    byUsername: {},\n  },\n\n  webApps: {\n    openedWebApps: {},\n    openedOrderedKeys: [],\n    sessionKeys: [],\n    modalState: 'maximized',\n    isModalOpen: false,\n    isMoreAppsTabActive: false,\n  },\n\n  globalSearch: {},\n\n  userSearch: {},\n\n  leftColumn: {\n    contentKey: LeftColumnContent.ChatList,\n    settingsScreen: SettingsScreens.Main,\n  },\n\n  middleSearch: {\n    byChatThreadKey: {},\n  },\n\n  sharedMediaSearch: {\n    byChatThreadKey: {},\n  },\n\n  chatMediaSearch: {\n    byChatThreadKey: {},\n  },\n\n  management: {\n    byChatId: {},\n  },\n\n  chatInfo: {\n    isOpen: false,\n  },\n  agentChat: {\n    isOpen: false,\n  },\n  threadHistory: {\n    isOpen: false,\n  },\n\n  savedGifts: {\n    filter: {\n      ...DEFAULT_GIFT_PROFILE_FILTER_OPTIONS,\n    },\n    collectionsByPeerId: {},\n    activeCollectionByPeerId: {},\n  },\n\n  resaleGifts: {\n    gifts: [],\n    count: 0,\n    updateIteration: 0,\n    filter: {\n      ...DEFAULT_RESALE_GIFTS_FILTER_OPTIONS,\n    },\n  },\n\n  storyViewer: {\n    isMuted: true,\n    isRibbonShown: false,\n  },\n\n  mediaViewer: {\n    volume: DEFAULT_VOLUME,\n    playbackRate: DEFAULT_PLAYBACK_RATE,\n    isMuted: false,\n  },\n\n  audioPlayer: {\n    playbackRate: DEFAULT_PLAYBACK_RATE,\n    isMuted: false,\n  },\n\n  isShareMessageModalShown: false,\n\n  isWebAppsCloseConfirmationModalOpen: false,\n\n  forwardMessages: {},\n\n  replyingMessage: {},\n\n  pollResults: {},\n\n  payment: {},\n  starsPayment: {},\n\n  notifications: [],\n\n  dialogs: [],\n\n  activeReactions: {},\n\n  activeDownloads: {},\n\n  statistics: {\n    byChatId: {},\n  },\n\n  pollModal: {\n    isOpen: false,\n  },\n\n  requestedTranslations: {\n    byChatId: {},\n  },\n\n  isPaymentMessageConfirmDialogOpen: false,\n};\n","import type { ChatListType } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\nimport {\n  type ApiChat, type ApiChatFullInfo, type ApiChatType,\n} from '../../api/types';\n\nimport {\n  ALL_FOLDER_ID, ARCHIVED_FOLDER_ID, MEMBERS_LOAD_SLICE, SAVED_FOLDER_ID, SERVICE_NOTIFICATIONS_USER_ID,\n} from '../../config';\nimport { IS_TRANSLATION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { isUserId } from '../../util/entities/ids';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  getHasAdminRight,\n  getPrivateChatUserId,\n  isChatChannel,\n  isChatPublic,\n  isChatSuperGroup,\n  isHistoryClearMessage,\n  isUserBot,\n  isUserOnline,\n} from '../helpers';\nimport { selectActiveRestrictionReasons } from './messages';\nimport { selectTabState } from './tabs';\nimport {\n  selectBot, selectIsCurrentUserPremium, selectUser, selectUserFullInfo,\n} from './users';\n\nexport function selectChat<T extends GlobalState>(global: T, chatId: string): ApiChat | undefined {\n  return global.chats.byId[chatId];\n}\n\nexport function selectChatFullInfo<T extends GlobalState>(global: T, chatId: string): ApiChatFullInfo | undefined {\n  return global.chats.fullInfoById[chatId];\n}\n\nexport function selectPeerFullInfo<T extends GlobalState>(global: T, peerId: string) {\n  if (isUserId(peerId)) return selectUserFullInfo(global, peerId);\n  return selectChatFullInfo(global, peerId);\n}\n\nexport function selectChatListLoadingParameters<T extends GlobalState>(\n  global: T, listType: ChatListType,\n) {\n  return global.chats.loadingParameters[listType];\n}\n\nexport function selectChatUser<T extends GlobalState>(global: T, chat: ApiChat) {\n  const userId = getPrivateChatUserId(chat);\n  if (!userId) {\n    return false;\n  }\n\n  return selectUser(global, userId);\n}\n\nexport function selectIsChatWithSelf<T extends GlobalState>(global: T, chatId: string) {\n  return chatId === global.currentUserId;\n}\n\nexport function selectIsChatWithBot<T extends GlobalState>(global: T, chat: ApiChat) {\n  const user = selectChatUser(global, chat);\n  return user && isUserBot(user);\n}\n\nexport function selectSupportChat<T extends GlobalState>(global: T) {\n  return Object.values(global.chats.byId).find(({ isSupport }: ApiChat) => isSupport);\n}\n\nexport function selectChatOnlineCount<T extends GlobalState>(global: T, chat: ApiChat) {\n  const fullInfo = selectChatFullInfo(global, chat.id);\n  if (isUserId(chat.id) || isChatChannel(chat) || !fullInfo) {\n    return undefined;\n  }\n\n  if (!fullInfo.members || fullInfo.members.length === MEMBERS_LOAD_SLICE) {\n    return fullInfo.onlineCount;\n  }\n\n  return fullInfo.members.reduce((onlineCount, { userId }) => {\n    if (\n      !selectIsChatWithSelf(global, userId)\n      && global.users.byId[userId]\n      && isUserOnline(global.users.byId[userId], global.users.statusesById[userId])\n    ) {\n      return onlineCount + 1;\n    }\n\n    return onlineCount;\n  }, 0);\n}\n\nexport function selectIsTrustedBot<T extends GlobalState>(global: T, botId: string) {\n  return global.trustedBotIds.includes(botId) || global.appConfig.whitelistedBotIds?.includes(botId);\n}\n\nexport function selectChatType<T extends GlobalState>(global: T, chatId: string): ApiChatType | undefined {\n  const bot = selectBot(global, chatId);\n  if (bot) {\n    return 'bots';\n  }\n\n  const user = selectUser(global, chatId);\n  if (user) {\n    return 'users';\n  }\n\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n\n  if (isChatChannel(chat)) {\n    return 'channels';\n  }\n\n  return 'chats';\n}\n\nexport function selectIsChatBotNotStarted<T extends GlobalState>(global: T, chatId: string) {\n  const bot = selectBot(global, chatId);\n  if (!bot) {\n    return false;\n  }\n\n  const lastMessage = selectChatLastMessage(global, chatId);\n  if (lastMessage && isHistoryClearMessage(lastMessage)) {\n    return true;\n  }\n\n  return Boolean(!lastMessage);\n}\n\nexport function selectAreActiveChatsLoaded<T extends GlobalState>(global: T): boolean {\n  return Boolean(global.chats.listIds.active);\n}\n\nexport function selectIsChatListed<T extends GlobalState>(\n  global: T, chatId: string, type?: ChatListType,\n): boolean {\n  const { listIds } = global.chats;\n  if (type) {\n    const targetList = listIds[type];\n    return Boolean(targetList && targetList.includes(chatId));\n  }\n\n  return Object.values(listIds).some((list) => list && list.includes(chatId));\n}\n\nexport function selectChatListType<T extends GlobalState>(\n  global: T, chatId: string,\n): 'active' | 'archived' | undefined {\n  const chat = selectChat(global, chatId);\n  if (!chat || !selectIsChatListed(global, chatId)) {\n    return undefined;\n  }\n\n  return chat.folderId === ARCHIVED_FOLDER_ID ? 'archived' : 'active';\n}\n\nexport function selectChatFolder<T extends GlobalState>(global: T, folderId: number) {\n  return global.chatFolders.byId[folderId];\n}\n\nexport function selectTotalChatCount<T extends GlobalState>(global: T, listType: 'active' | 'archived'): number {\n  const { totalCount } = global.chats;\n  const allChatsCount = totalCount.all;\n  const archivedChatsCount = totalCount.archived || 0;\n\n  if (listType === 'archived') {\n    return archivedChatsCount;\n  }\n\n  return allChatsCount ? allChatsCount - archivedChatsCount : 0;\n}\n\nexport function selectIsChatPinned<T extends GlobalState>(\n  global: T, chatId: string, folderId = ALL_FOLDER_ID,\n): boolean {\n  const { active, archived, saved } = global.chats.orderedPinnedIds;\n\n  if (folderId === ALL_FOLDER_ID) {\n    return Boolean(active?.includes(chatId));\n  }\n\n  if (folderId === ARCHIVED_FOLDER_ID) {\n    return Boolean(archived?.includes(chatId));\n  }\n\n  if (folderId === SAVED_FOLDER_ID) {\n    return Boolean(saved?.includes(chatId));\n  }\n\n  const { byId: chatFoldersById } = global.chatFolders;\n\n  const { pinnedChatIds } = chatFoldersById[folderId] || {};\n  return Boolean(pinnedChatIds?.includes(chatId));\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectChatByUsername<T extends GlobalState>(global: T, username: string) {\n  const usernameLowered = username.toLowerCase();\n  return Object.values(global.chats.byId).find(\n    (chat) => chat.usernames?.some((c) => c.username.toLowerCase() === usernameLowered),\n  );\n}\n\nexport function selectIsServiceChatReady<T extends GlobalState>(global: T) {\n  return Boolean(selectChat(global, SERVICE_NOTIFICATIONS_USER_ID));\n}\n\nexport function selectSendAs<T extends GlobalState>(global: T, chatId: string) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return undefined;\n\n  const id = selectChatFullInfo(global, chatId)?.sendAsId;\n  if (!id) return undefined;\n\n  return selectUser(global, id) || selectChat(global, id);\n}\n\nexport function selectRequestedDraft<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedDraft } = selectTabState(global, tabId);\n  if (requestedDraft?.chatId === chatId && !requestedDraft.files?.length) {\n    return requestedDraft.text;\n  }\n  return undefined;\n}\n\nexport function selectRequestedDraftFiles<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedDraft } = selectTabState(global, tabId);\n  if (requestedDraft?.chatId === chatId) {\n    return requestedDraft.files;\n  }\n  return undefined;\n}\n\nexport function filterChatIdsByType<T extends GlobalState>(\n  global: T, chatIds: string[], filter: readonly ApiChatType[],\n) {\n  return chatIds.filter((id) => {\n    const type = selectChatType(global, id);\n    if (!type) {\n      return false;\n    }\n    return filter.includes(type);\n  });\n}\n\nexport function selectCanInviteToChat<T extends GlobalState>(global: T, chatId: string) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  // https://github.com/TelegramMessenger/Telegram-iOS/blob/5126be83b3b9578fb014eb52ca553da9e7a8b83a/submodules/TelegramCore/Sources/TelegramEngine/Peers/Communities.swift#L6\n  return !chat.migratedTo && Boolean(!isUserId(chatId) && ((isChatChannel(chat) || isChatSuperGroup(chat)) ? (\n    chat.isCreator || getHasAdminRight(chat, 'inviteUsers')\n    || (isChatPublic(chat) && !chat.isJoinRequest)\n  ) : (chat.isCreator || getHasAdminRight(chat, 'inviteUsers'))));\n}\n\nexport function selectCanShareFolder<T extends GlobalState>(global: T, folderId: number) {\n  const folder = selectChatFolder(global, folderId);\n  if (!folder) return false;\n\n  const {\n    bots, groups, channels, contacts, nonContacts, includedChatIds, pinnedChatIds,\n    excludeArchived, excludeMuted, excludeRead, excludedChatIds,\n  } = folder;\n\n  return !bots && !groups && !channels && !contacts && !nonContacts\n    && !excludeArchived && !excludeMuted && !excludeRead && !excludedChatIds?.length\n    && (pinnedChatIds?.length || includedChatIds.length)\n    && folder.includedChatIds.concat(folder.pinnedChatIds || []).some((chatId) => {\n      return selectCanInviteToChat(global, chatId);\n    });\n}\n\nexport function selectShouldDetectChatLanguage<T extends GlobalState>(\n  global: T, chatId: string,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  if (chat.hasAutoTranslation) return true;\n\n  const { canTranslateChats } = global.settings.byKey;\n\n  const isPremium = selectIsCurrentUserPremium(global);\n  const isSavedMessages = selectIsChatWithSelf(global, chatId);\n\n  return IS_TRANSLATION_SUPPORTED && canTranslateChats && isPremium && !isSavedMessages;\n}\n\nexport function selectCanTranslateChat<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  const requestedTranslation = selectRequestedChatTranslationLanguage(global, chatId, tabId);\n  if (requestedTranslation) return true; // Prevent translation dropping on reevaluation\n\n  const isLanguageDetectable = selectShouldDetectChatLanguage(global, chatId);\n  const detectedLanguage = chat.detectedLanguage;\n\n  const { doNotTranslate } = global.settings.byKey;\n\n  return Boolean(isLanguageDetectable && detectedLanguage && !doNotTranslate.includes(detectedLanguage));\n}\n\nexport function selectRequestedChatTranslationLanguage<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { requestedTranslations } = selectTabState(global, tabId);\n\n  return requestedTranslations.byChatId[chatId]?.toLanguage;\n}\n\nexport function selectSimilarChannelIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  return global.chats.similarChannelsById[chatId];\n}\n\nexport function selectSimilarBotsIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  return global.chats.similarBotsById[chatId];\n}\n\nexport function selectChatLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, listType: 'all' | 'saved' = 'all',\n) {\n  return global.chats.lastMessageIds[listType]?.[chatId];\n}\n\nexport function selectChatLastMessage<T extends GlobalState>(\n  global: T, chatId: string, listType: 'all' | 'saved' = 'all',\n) {\n  const id = selectChatLastMessageId(global, chatId, listType);\n  if (!id) return undefined;\n\n  const realChatId = listType === 'saved' ? global.currentUserId! : chatId;\n  return global.messages.byChatId[realChatId]?.byId[id];\n}\n\nexport function selectIsMonoforumAdmin<T extends GlobalState>(\n  global: T, chatId: string,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat?.isMonoforum) return;\n\n  const channel = selectMonoforumChannel(global, chatId);\n  if (!channel) return;\n\n  return Boolean(chat.isCreator || chat.adminRights || channel.isCreator || channel.adminRights);\n}\n\n/**\n * Only selects monoforum channel for monoforum chats.\n * Returns `undefined` for other chats, including channels that have linked monoforum.\n */\nexport function selectMonoforumChannel<T extends GlobalState>(\n  global: T, chatId: string,\n) {\n  const chat = selectChat(global, chatId);\n  if (!chat) return;\n\n  return chat.isMonoforum ? selectChat(global, chat.linkedMonoforumId!) : undefined;\n}\n\nexport function selectIsChatRestricted<T extends GlobalState>(global: T, chatId: string): boolean {\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  const activeRestrictions = selectActiveRestrictionReasons(global, chat.restrictionReasons);\n  return activeRestrictions.length > 0;\n}\n\nexport function selectAreFoldersPresent<T extends GlobalState>(global: T) {\n  const ids = global.chatFolders.orderedIds;\n  return Boolean(ids && ids.length > 1);\n}\n","/// In seconds\nexport const MINUTE = 60;\nexport const HOUR = 3600;\nexport const DAY = 86400;\nexport const WEEK = 7 * DAY;\nexport const MONTH = 30 * DAY;\n\nexport function getMinutes(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / MINUTE);\n}\n\nexport function getHours(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / HOUR);\n}\n\nexport function getDays(seconds: number, roundDown?: boolean) {\n  const roundFunc = roundDown ? Math.floor : Math.ceil;\n  return roundFunc(seconds / DAY);\n}\n\nexport function getSeconds(hours: number, minutes: number, seconds: number) {\n  return hours * HOUR + minutes * MINUTE + seconds;\n}\n","import type { PerformanceType } from '../types';\n\nexport function applyPerformanceSettings(performanceType: PerformanceType) {\n  const {\n    pageTransitions,\n    messageSendingAnimations,\n    mediaViewerAnimations,\n    messageComposerAnimations,\n    contextMenuAnimations,\n    contextMenuBlur,\n    rightColumnAnimations,\n  } = performanceType;\n\n  const root = document.body;\n\n  root.classList.toggle('no-page-transitions', !pageTransitions);\n  root.classList.toggle('no-message-sending-animations', !messageSendingAnimations);\n  root.classList.toggle('no-media-viewer-animations', !mediaViewerAnimations);\n  root.classList.toggle('no-message-composer-animations', !messageComposerAnimations);\n  root.classList.toggle('no-context-menu-animations', !contextMenuAnimations);\n  root.classList.toggle('no-menu-blur', !contextMenuBlur);\n  root.classList.toggle('no-right-column-animations', !rightColumnAnimations);\n}\n","import type { MouseEvent as ReactMouseEvent } from 'react';\nimport type { TeactNode } from '../../lib/teact/teact';\nimport { memo, useMemo, useRef } from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type {\n  ApiPeer, ApiPhoto, ApiWebDocument,\n} from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport type { CustomPeer, StoryViewerOrigin } from '../../types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { IS_TEST } from '../../config';\nimport {\n  getChatAvatarHash,\n  getChatTitle,\n  getPeerColorKey,\n  getPeerStoryHtmlId,\n  getUserFullName,\n  getVideoProfilePhotoMediaHash,\n  getWebDocumentHash,\n  isAnonymousForwardsChat,\n  isChatWithRepliesBot,\n  isDeletedUser,\n} from '../../global/helpers';\nimport { isApiPeerChat, isApiPeerUser } from '../../global/helpers/peers';\nimport buildClassName, { createClassNameBuilder } from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\nimport { isUserId } from '../../util/entities/ids';\nimport { getFirstLetters } from '../../util/textFormat';\nimport { REM } from './helpers/mediaDimensions';\nimport renderText from './helpers/renderText';\n\nimport { useFastClick } from '../../hooks/useFastClick';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMedia from '../../hooks/useMedia';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport useOldLang from '../../hooks/useOldLang';\nimport { getPeerColorClass } from '../../hooks/usePeerColor';\n\nimport OptimizedVideo from '../ui/OptimizedVideo';\nimport AvatarStoryCircle from './AvatarStoryCircle';\nimport Icon from './icons/Icon';\n\nimport './Avatar.scss';\n\nconst LOOP_COUNT = 3;\n\nexport const AVATAR_SIZES = {\n  micro: REM,\n  mini: 1.5 * REM,\n  tiny: 2 * REM,\n  small: 2.125 * REM,\n  medium: 2.75 * REM,\n  large: 3.375 * REM,\n  giant: 5.625 * REM,\n  jumbo: 7.5 * REM,\n};\n\nexport type AvatarSize =\n  'micro' | 'mini' | 'tiny' | 'small' | 'medium' | 'large' | 'giant' | 'jumbo' | number;\n\nconst cn = createClassNameBuilder('Avatar');\ncn.media = cn('media');\ncn.icon = cn('icon');\n\ntype OwnProps = {\n  className?: string;\n  style?: string;\n  size?: AvatarSize;\n  peer?: ApiPeer | CustomPeer;\n  photo?: ApiPhoto;\n  webPhoto?: ApiWebDocument;\n  previewUrl?: string;\n  text?: string;\n  isSavedMessages?: boolean;\n  isSavedDialog?: boolean;\n  withVideo?: boolean;\n  withStory?: boolean;\n  forPremiumPromo?: boolean;\n  withStoryGap?: boolean;\n  withStorySolid?: boolean;\n  storyColors?: string[];\n  forceFriendStorySolid?: boolean;\n  forceUnreadStorySolid?: boolean;\n  storyViewerOrigin?: StoryViewerOrigin;\n  storyViewerMode?: 'full' | 'single-peer' | 'disabled';\n  loopIndefinitely?: boolean;\n  noPersonalPhoto?: boolean;\n  asMessageBubble?: boolean;\n  observeIntersection?: ObserveFn;\n  onClick?: (e: ReactMouseEvent<HTMLDivElement, MouseEvent>, hasMedia: boolean) => void;\n  onContextMenu?: (e: React.MouseEvent) => void;\n  onMouseMove?: (e: React.MouseEvent) => void;\n};\n\nconst Avatar = ({\n  className,\n  style,\n  size = 'large',\n  peer,\n  photo,\n  webPhoto,\n  previewUrl,\n  text,\n  isSavedMessages,\n  isSavedDialog,\n  withVideo,\n  withStory,\n  forPremiumPromo,\n  withStoryGap,\n  withStorySolid,\n  storyColors,\n  forceFriendStorySolid,\n  forceUnreadStorySolid,\n  storyViewerOrigin,\n  storyViewerMode = 'single-peer',\n  loopIndefinitely,\n  noPersonalPhoto,\n  asMessageBubble,\n  onClick,\n  onContextMenu,\n  onMouseMove,\n}: OwnProps) => {\n  const { openStoryViewer } = getActions();\n\n  const ref = useRef<HTMLDivElement>();\n  const videoLoopCountRef = useRef(0);\n  const isCustomPeer = peer && 'isCustomPeer' in peer;\n  const realPeer = peer && !isCustomPeer ? peer : undefined;\n  const user = realPeer && isApiPeerUser(realPeer) ? realPeer : undefined;\n  const chat = realPeer && isApiPeerChat(realPeer) ? realPeer : undefined;\n  const isDeleted = user && isDeletedUser(user);\n  const isReplies = realPeer && isChatWithRepliesBot(realPeer.id);\n  const isAnonymousForwards = realPeer && isAnonymousForwardsChat(realPeer.id);\n  const isForum = chat?.isForum;\n\n  const peerColorKey = getPeerColorKey(peer, true);\n  const peerColorClass = peerColorKey !== undefined ? getPeerColorClass(peerColorKey) : undefined;\n\n  const isStoryClickable = withStory && storyViewerMode !== 'disabled' && realPeer?.hasStories;\n\n  let imageHash: string | undefined;\n  let videoHash: string | undefined;\n\n  const pxSize = typeof size === 'number' ? size : AVATAR_SIZES[size];\n\n  const shouldLoadVideo = withVideo && photo?.isVideo;\n\n  const isBig = pxSize >= AVATAR_SIZES.jumbo;\n  if (!isSavedMessages && !isDeleted) {\n    if ((user && !noPersonalPhoto) || chat) {\n      imageHash = getChatAvatarHash(peer as ApiPeer, isBig ? 'big' : undefined);\n    } else if (photo) {\n      imageHash = `photo${photo.id}?size=m`;\n      if (photo.isVideo && withVideo) {\n        videoHash = getVideoProfilePhotoMediaHash(photo);\n      }\n    } else if (webPhoto) {\n      imageHash = getWebDocumentHash(webPhoto);\n    }\n  }\n\n  const specialIcon = useMemo(() => {\n    if (isCustomPeer) {\n      return peer.avatarIcon;\n    }\n\n    if (isSavedMessages) {\n      return isSavedDialog ? 'my-notes' : 'avatar-saved-messages';\n    }\n\n    if (isDeleted) {\n      return 'avatar-deleted-account';\n    }\n\n    if (isReplies) {\n      return 'reply-filled';\n    }\n\n    if (isAnonymousForwards) {\n      return 'author-hidden';\n    }\n\n    return undefined;\n  }, [isCustomPeer, isSavedMessages, isDeleted, isReplies, isAnonymousForwards, peer, isSavedDialog]);\n\n  const imgBlobUrl = useMedia(imageHash, false, ApiMediaFormat.BlobUrl);\n  const videoBlobUrl = useMedia(videoHash, !shouldLoadVideo, ApiMediaFormat.BlobUrl);\n  const imgUrl = imgBlobUrl || previewUrl;\n  const hasBlobUrl = Boolean(imgUrl || videoBlobUrl);\n  // `videoBlobUrl` can be taken from memory cache, so we need to check `shouldLoadVideo` again\n  const shouldPlayVideo = Boolean(videoBlobUrl && shouldLoadVideo);\n\n  const { ref: mediaRef } = useMediaTransition<HTMLImageElement>({ hasMediaData: hasBlobUrl });\n\n  const handleVideoEnded = useLastCallback((e) => {\n    const video = e.currentTarget;\n    if (!videoBlobUrl) return;\n\n    if (loopIndefinitely) return;\n\n    videoLoopCountRef.current += 1;\n    if (videoLoopCountRef.current >= LOOP_COUNT) {\n      video.style.display = 'none';\n    }\n  });\n\n  const lang = useOldLang();\n\n  let content: TeactNode | undefined;\n  const author = user ? getUserFullName(user) : (chat ? getChatTitle(lang, chat) : text);\n\n  if (specialIcon) {\n    content = (\n      <Icon\n        name={specialIcon}\n        className={cn.icon}\n        role=\"img\"\n        ariaLabel={author}\n      />\n    );\n  } else if (hasBlobUrl) {\n    content = (\n      <>\n        <img\n          ref={mediaRef}\n          src={imgUrl}\n          className={buildClassName(cn.media, 'avatar-media', videoBlobUrl && 'poster')}\n          alt={author}\n          decoding=\"async\"\n          draggable={false}\n        />\n        {shouldPlayVideo && (\n          <OptimizedVideo\n            canPlay\n            src={videoBlobUrl}\n            className={buildClassName(cn.media, 'avatar-media', 'poster')}\n            muted\n            loop={loopIndefinitely}\n            autoPlay\n            disablePictureInPicture\n            playsInline\n            draggable={false}\n            onEnded={handleVideoEnded}\n          />\n        )}\n      </>\n    );\n  } else if (user) {\n    const userFullName = getUserFullName(user);\n    content = userFullName ? getFirstLetters(userFullName, 2) : undefined;\n  } else if (chat) {\n    const title = getChatTitle(lang, chat);\n    content = title && getFirstLetters(title, isUserId(chat.id) ? 2 : 1);\n  } else if (isCustomPeer) {\n    const title = peer.title || lang(peer.titleKey!);\n    content = title && getFirstLetters(title, 1);\n  } else if (text) {\n    content = getFirstLetters(text, 2);\n  }\n\n  const isRoundedRect = (isCustomPeer && peer.isAvatarSquare)\n    || (isForum && !((withStory || withStorySolid) && realPeer?.hasStories));\n  const isPremiumGradient = isCustomPeer && peer.withPremiumGradient;\n  const customColor = isCustomPeer && peer.customPeerAvatarColor;\n\n  const fullClassName = buildClassName(\n    'Avatar',\n    className,\n    peerColorClass,\n    !peer && text && 'hidden-user',\n    isSavedMessages && 'saved-messages',\n    isAnonymousForwards && 'anonymous-forwards',\n    isDeleted && 'deleted-account',\n    isReplies && 'replies-bot-account',\n    isPremiumGradient && 'premium-gradient-bg',\n    isRoundedRect && 'forum',\n    asMessageBubble && 'message-bubble',\n    (photo || webPhoto) && 'force-fit',\n    ((withStory && realPeer?.hasStories) || forPremiumPromo) && 'with-story-circle',\n    withStorySolid && realPeer?.hasStories && 'with-story-solid',\n    withStorySolid && forceFriendStorySolid && 'close-friend',\n    withStorySolid && (realPeer?.hasUnreadStories || forceUnreadStorySolid) && 'has-unread-story',\n    (onClick || isStoryClickable) && 'interactive',\n    (!isSavedMessages && !imgUrl) && 'no-photo',\n  );\n\n  const fullStyle = buildStyle(\n    `--_size: ${pxSize}px;`,\n    customColor && `--color-user: ${customColor}`,\n    style,\n  );\n\n  const hasMedia = Boolean(isSavedMessages || imgUrl);\n\n  const { handleClick, handleMouseDown } = useFastClick((e: ReactMouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (isStoryClickable) {\n      e.stopPropagation();\n\n      openStoryViewer({\n        peerId: realPeer.id,\n        isSinglePeer: storyViewerMode === 'single-peer',\n        origin: storyViewerOrigin,\n      });\n      return;\n    }\n\n    if (onClick) {\n      onClick(e, hasMedia);\n    }\n  });\n\n  return (\n    <div\n      ref={ref}\n      className={fullClassName}\n      id={realPeer?.id && withStory ? getPeerStoryHtmlId(realPeer.id) : undefined}\n      data-peer-id={realPeer?.id}\n      data-test-sender-id={IS_TEST ? realPeer?.id : undefined}\n      aria-label={typeof content === 'string' ? author : undefined}\n      style={fullStyle}\n      onClick={handleClick}\n      onContextMenu={onContextMenu}\n      onMouseDown={handleMouseDown}\n      onMouseMove={onMouseMove}\n    >\n      <div className=\"inner\">\n        {typeof content === 'string' ? renderText(content, [isBig ? 'hq_emoji' : 'emoji']) : content}\n      </div>\n      {withStory && realPeer?.hasStories && (\n        <AvatarStoryCircle\n          peerId={realPeer.id}\n          size={pxSize}\n          withExtraGap={withStoryGap}\n          colors={storyColors}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default memo(Avatar);\n","import type { CallbackManager } from './callbacks';\n\nimport { createCallbackManager } from './callbacks';\n\ninterface SignalState<T> {\n  value: T;\n  effects: CallbackManager;\n}\n\nconst SIGNAL_MARK = Symbol('SIGNAL_MARK');\n\nexport type Signal<T = unknown> = ((() => T) & {\n  readonly [SIGNAL_MARK]: symbol;\n  subscribe: (cb: AnyToVoidFunction) => NoneToVoidFunction;\n  once: (cb: AnyToVoidFunction) => NoneToVoidFunction;\n});\n\nexport type SignalSetter<T = unknown> = (newValue: T) => void;\n\nexport function isSignal(obj: unknown): obj is Signal {\n  return typeof obj === 'function' && SIGNAL_MARK in obj;\n}\n\n// A shorthand to unsubscribe effect from all signals\nconst unsubscribesByEffect = new Map<NoneToVoidFunction, Set<NoneToVoidFunction>>();\n\nlet currentEffect: NoneToVoidFunction | undefined;\n\nexport function createSignal<T>(defaultValue?: T) {\n  const state: SignalState<typeof defaultValue> = {\n    value: defaultValue,\n    effects: createCallbackManager(),\n  };\n\n  function subscribe(effect: NoneToVoidFunction) {\n    const unsubscribe = state.effects.addCallback(effect);\n\n    if (!unsubscribesByEffect.has(effect)) {\n      unsubscribesByEffect.set(effect, new Set([unsubscribe]));\n    } else {\n      unsubscribesByEffect.get(effect)!.add(unsubscribe);\n    }\n\n    return () => {\n      unsubscribe();\n\n      const unsubscribes = unsubscribesByEffect.get(effect)!;\n      unsubscribes.delete(unsubscribe);\n      if (!unsubscribes.size) {\n        unsubscribesByEffect.delete(effect);\n      }\n    };\n  }\n\n  function once(effect: NoneToVoidFunction) {\n    const unsub = subscribe(() => {\n      unsub();\n      effect();\n    });\n\n    return unsub;\n  }\n\n  function getter() {\n    if (currentEffect) {\n      subscribe(currentEffect);\n    }\n\n    return state.value;\n  }\n\n  function setter(newValue: T) {\n    if (state.value === newValue) {\n      return;\n    }\n\n    state.value = newValue;\n    state.effects.runCallbacks();\n  }\n\n  const signal = Object.assign(getter as Signal<T>, {\n    [SIGNAL_MARK]: SIGNAL_MARK,\n    subscribe,\n    once,\n  });\n\n  return [signal, setter] as const;\n}\n\nexport function cleanupEffect(effect: NoneToVoidFunction) {\n  unsubscribesByEffect.get(effect)?.forEach((unsubscribe) => {\n    unsubscribe();\n  });\n  unsubscribesByEffect.delete(effect);\n}\n","import type { FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport {\n  useCallback, useMemo, useRef, useState,\n} from '../../lib/teact/teact';\n\nimport Button from './Button';\nimport Menu from './Menu';\n\nimport './DropdownMenu.scss';\n\ntype OwnProps = {\n  className?: string;\n  bubbleClassName?: string;\n  trigger?: FC<{ onTrigger: () => void; isOpen?: boolean }>;\n  transformOriginX?: number;\n  transformOriginY?: number;\n  positionX?: 'left' | 'right';\n  positionY?: 'top' | 'bottom';\n  footer?: string;\n  forceOpen?: boolean;\n  onOpen?: NoneToVoidFunction;\n  onClose?: NoneToVoidFunction;\n  onHide?: NoneToVoidFunction;\n  onTransitionEnd?: NoneToVoidFunction;\n  onMouseEnterBackdrop?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n  children: React.ReactNode;\n  autoClose?: boolean;\n};\n\nconst DropdownMenu: FC<OwnProps> = ({\n  trigger,\n  className,\n  bubbleClassName,\n  children,\n  transformOriginX,\n  transformOriginY,\n  positionX = 'left',\n  positionY = 'top',\n  footer,\n  forceOpen,\n  onOpen,\n  onClose,\n  onTransitionEnd,\n  onMouseEnterBackdrop,\n  onHide,\n  autoClose = true,\n}) => {\n  const menuRef = useRef<HTMLDivElement>();\n  const [isOpen, setIsOpen] = useState(false);\n\n  const toggleIsOpen = () => {\n    setIsOpen(!isOpen);\n\n    if (isOpen) {\n      onClose?.();\n    } else {\n      onOpen?.();\n    }\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent<any>) => {\n    const menu = menuRef.current;\n\n    if (!isOpen || e.keyCode !== 40 || !menu) {\n      return;\n    }\n\n    const focusedElement = document.activeElement;\n    const elementChildren = Array.from(menu.children);\n\n    if (!focusedElement || elementChildren.indexOf(focusedElement) === -1) {\n      (elementChildren[0] as HTMLElement).focus();\n    }\n  };\n\n  const handleClose = useCallback(() => {\n    setIsOpen(false);\n    onClose?.();\n  }, [onClose]);\n\n  const triggerComponent: FC<{ onTrigger: () => void; isOpen?: boolean }> = useMemo(() => {\n    if (trigger) return trigger;\n\n    return ({ onTrigger, isOpen: isMenuOpen }) => (\n      <Button\n        round\n        size=\"smaller\"\n        color=\"translucent\"\n        className={isMenuOpen ? 'active' : ''}\n        iconName=\"more\"\n        onClick={onTrigger}\n        ariaLabel=\"More actions\"\n      />\n    );\n  }, [trigger]);\n\n  return (\n    <div\n      className={`DropdownMenu ${className || ''}`}\n      onKeyDown={handleKeyDown}\n      onTransitionEnd={onTransitionEnd}\n    >\n      {triggerComponent({ onTrigger: toggleIsOpen, isOpen })}\n\n      <Menu\n        ref={menuRef}\n        isOpen={isOpen || Boolean(forceOpen)}\n        className={className || ''}\n        bubbleClassName={bubbleClassName || ''}\n        transformOriginX={transformOriginX}\n        transformOriginY={transformOriginY}\n        positionX={positionX}\n        positionY={positionY}\n        footer={footer}\n        autoClose={autoClose}\n        onClose={handleClose}\n        onCloseAnimationEnd={onHide}\n        onMouseEnterBackdrop={onMouseEnterBackdrop}\n      >\n        {children}\n      </Menu>\n    </div>\n  );\n};\n\nexport default DropdownMenu;\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useEffect } from '../lib/teact/teact';\n\nimport { hasActiveViewTransition } from './animations/useViewTransition';\n\nconst BACKDROP_CLASSNAME = 'backdrop';\n\n// This effect implements closing menus by clicking outside of them\n// without adding extra elements to the DOM\nexport default function useVirtualBackdrop(\n  isOpen: boolean,\n  containerRef: ElementRef<HTMLElement>,\n  onClose?: () => void | undefined,\n  ignoreRightClick?: boolean,\n  excludedClosestSelector?: string,\n) {\n  useEffect(() => {\n    if (!isOpen || !onClose) {\n      return undefined;\n    }\n\n    const handleEvent = (e: MouseEvent) => {\n      const container = containerRef.current;\n      const target = e.target as HTMLElement | null;\n      if (!container || !target || (ignoreRightClick && e.button === 2) || hasActiveViewTransition()) {\n        return;\n      }\n\n      if ((\n        !container.contains(e.target as Node | null)\n        || target.classList.contains(BACKDROP_CLASSNAME)\n      ) && !(excludedClosestSelector && (\n        target.matches(excludedClosestSelector) || target.closest(excludedClosestSelector)\n      ))) {\n        e.preventDefault();\n        e.stopPropagation();\n        onClose?.();\n      }\n    };\n\n    document.addEventListener('mousedown', handleEvent);\n\n    return () => {\n      document.removeEventListener('mousedown', handleEvent);\n    };\n  }, [excludedClosestSelector, ignoreRightClick, isOpen, containerRef, onClose]);\n}\n","export function areDeepEqual<T>(value1: T, value2: T): boolean {\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n  if (type1 !== type2) {\n    return false;\n  }\n\n  // eslint-disable-next-line no-null/no-null\n  if (type1 !== 'object' || value1 === null || value2 === null) {\n    return value1 === value2;\n  }\n\n  const isArray1 = Array.isArray(value1);\n  const isArray2 = Array.isArray(value2);\n\n  if (isArray1 !== isArray2) {\n    return false;\n  }\n\n  if (isArray1) {\n    const array1 = value1 as any[];\n    const array2 = value2 as any[];\n\n    if (array1.length !== array2.length) {\n      return false;\n    }\n\n    return array1.every((member1, i) => areDeepEqual(member1, array2[i]));\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n\n  return keys1.length === Object.keys(object2).length\n    && keys1.every((key1) => areDeepEqual(object1[key1], object2[key1]));\n}\n","import EMOJI_REGEX from '../../lib/twemojiRegex';\n\n// Non-standard variations of emojis, used on some devices\nconst EMOJI_EXCEPTIONS: [string | RegExp, string][] = [\n  [/\\u{1f3f3}\\u200d\\u{1f308}/gu, '\\u{1f3f3}\\ufe0f\\u200d\\u{1f308}'], // \n  [/\\u{1f3f3}\\u200d\\u26a7\\ufe0f?/gu, '\\u{1f3f3}\\ufe0f\\u200d\\u26a7\\ufe0f'], // \n  [/\\u26d3\\u200d\\u{1f4a5}/gu, '\\u26d3\\ufe0f\\u200d\\u{1f4a5}'], // \n  [/\\u200d([\\u2640\\u2642])(?!\\ufe0f)/gu, '\\u200d$1\\ufe0f'], // Gender variation without 0xFE0F\n];\n\nexport default function fixNonStandardEmoji(text: string) {\n  // Non-standard sequences typically parsed as separate emojis, so no need to fix text without any\n  if (!text.match(EMOJI_REGEX)) return text;\n\n  for (const [regex, replacement] of EMOJI_EXCEPTIONS) {\n    text = text.replace(regex, replacement);\n  }\n\n  return text;\n}\n","import type { IconName } from '../../types/icons';\n\nimport { IS_TEST } from '../../config';\nimport buildClassName from '../../util/buildClassName';\n\nimport useAppLayout from '../../hooks/useAppLayout';\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Icon from '../common/icons/Icon';\n\nimport './MenuItem.scss';\n\nexport type MenuItemProps = {\n  customIcon?: React.ReactNode;\n  className?: string;\n  children: React.ReactNode;\n  href?: string;\n  rel?: string;\n  target?: string;\n  download?: string;\n  disabled?: boolean;\n  destructive?: boolean;\n  ariaLabel?: string;\n  withWrap?: boolean;\n  withPreventDefaultOnMouseDown?: boolean;\n  clickArg?: number;\n  onClick?: (e: React.SyntheticEvent<HTMLDivElement | HTMLAnchorElement>, arg?: number) => void;\n  onContextMenu?: (e: React.UIEvent) => void;\n} & ({\n  icon: 'A' | 'K';\n  isCharIcon: true;\n} | {\n  icon?: IconName;\n  isCharIcon?: false;\n});\n\nconst MenuItem = (props: MenuItemProps) => {\n  const {\n    icon,\n    isCharIcon,\n    customIcon,\n    className,\n    children,\n    href,\n    target,\n    download,\n    disabled,\n    destructive,\n    ariaLabel,\n    withWrap,\n    rel = 'noopener noreferrer',\n    withPreventDefaultOnMouseDown,\n    clickArg,\n    onClick,\n    onContextMenu,\n  } = props;\n\n  const lang = useLang();\n  const { isTouchScreen } = useAppLayout();\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    if (disabled || !onClick) {\n      e.preventDefault();\n      return;\n    }\n    onClick(e, clickArg);\n  });\n\n  const handleKeyDown = useLastCallback((e: React.KeyboardEvent<HTMLDivElement>) => {\n    if (e.keyCode !== 13 && e.keyCode !== 32) {\n      return;\n    }\n\n    if (disabled || !onClick) {\n      e.preventDefault();\n\n      return;\n    }\n    onClick(e, clickArg);\n  });\n  const handleMouseDown = useLastCallback((e: React.SyntheticEvent<HTMLDivElement | HTMLAnchorElement>) => {\n    if (withPreventDefaultOnMouseDown) {\n      e.preventDefault();\n    }\n  });\n\n  const fullClassName = buildClassName(\n    'MenuItem',\n    className,\n    disabled && 'disabled',\n    destructive && 'destructive',\n    !isTouchScreen && 'compact',\n    withWrap && 'wrap',\n  );\n\n  const content = (\n    <>\n      {!customIcon && icon && (\n        <Icon name={isCharIcon ? 'char' : icon} character={isCharIcon ? icon : undefined} />\n      )}\n      {customIcon}\n      {children}\n    </>\n  );\n\n  if (href && !disabled) {\n    return (\n      <a\n        tabIndex={0}\n        className={fullClassName}\n        href={href}\n        download={download}\n        aria-label={ariaLabel}\n        title={ariaLabel}\n        target={target || (href.startsWith(window.location.origin) || IS_TEST ? '_self' : '_blank')}\n        rel={rel}\n        dir={lang.isRtl ? 'rtl' : undefined}\n        onClick={onClick}\n        onMouseDown={handleMouseDown}\n      >\n        {content}\n      </a>\n    );\n  }\n\n  return (\n    <div\n      role=\"menuitem\"\n      tabIndex={0}\n      className={fullClassName}\n      onClick={handleClick}\n      onKeyDown={handleKeyDown}\n      onMouseDown={handleMouseDown}\n      onContextMenu={onContextMenu}\n      aria-label={ariaLabel}\n      title={ariaLabel}\n      dir={lang.isRtl ? 'rtl' : undefined}\n    >\n      {content}\n    </div>\n  );\n};\n\nexport default MenuItem;\n","const utf16 = {\n  // The utf16-class is necessary to convert from javascripts internal character representation to unicode and back.\n  decode: (input) => {\n    const output = [];\n    let i = 0;\n    const len = input.length;\n    let value;\n    let extra;\n\n    while (i < len) {\n      value = input.charCodeAt(i++);\n      if ((value & 0xf800) === 0xd800) {\n        extra = input.charCodeAt(i++);\n        if ((value & 0xfc00) !== 0xd800 || (extra & 0xfc00) !== 0xdc00) {\n          throw new RangeError('UTF-16(decode): Illegal UTF-16 sequence');\n        }\n        value = ((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000;\n      }\n      output.push(value);\n    }\n    return output;\n  },\n  encode: (input) => {\n    const output = [];\n    let i = 0;\n    const len = input.length;\n    let value;\n\n    while (i < len) {\n      value = input[i++];\n      if ((value & 0xf800) === 0xd800) {\n        throw new RangeError('UTF-16(encode): Illegal UTF-16 value');\n      }\n      if (value > 0xffff) {\n        value -= 0x10000;\n        output.push(String.fromCharCode(((value >>> 10) & 0x3ff) | 0xd800));\n        value = 0xdc00 | (value & 0x3ff);\n      }\n      output.push(String.fromCharCode(value));\n    }\n    return output.join('');\n  },\n};\n\n// Default parameters\nconst initial_n = 0x80;\nconst initial_bias = 72;\nconst delimiter = '\\x2D';\nconst base = 36;\nconst damp = 700;\nconst tmin = 1;\nconst tmax = 26;\nconst skew = 38;\nconst maxint = 0x7fffffff;\n\n// decode_digit(cp) returns the numeric value of a basic code\n// point (for use in representing integers) in the range 0 to\n// base-1, or base if cp is does not represent a value.\n\nfunction decode_digit(cp) {\n  return cp - 48 < 10 ? cp - 22 : cp - 65 < 26 ? cp - 65 : cp - 97 < 26 ? cp - 97 : base;\n}\n\n// ** Bias adaptation function **\nfunction adapt(delta, numpoints, firsttime) {\n  let k;\n  delta = firsttime ? Math.floor(delta / damp) : delta >> 1;\n  delta += Math.floor(delta / numpoints);\n\n  for (k = 0; delta > ((base - tmin) * tmax) >> 1; k += base) {\n    delta = Math.floor(delta / (base - tmin));\n  }\n  return Math.floor(k + ((base - tmin + 1) * delta) / (delta + skew));\n}\n\n// Main decode\nfunction decode(input, preserveCase) {\n  // Dont use utf16\n  const output = [];\n  const case_flags = [];\n  const input_length = input.length;\n\n  let n;\n  let out;\n  let i;\n  let bias;\n  let basic;\n  let j;\n  let ic;\n  let oldi;\n  let w;\n  let k;\n  let digit;\n  let t;\n  let len;\n\n  // Initialize the state:\n\n  n = initial_n;\n  i = 0;\n  bias = initial_bias;\n\n  // Handle the basic code points: Let basic be the number of input code\n  // points before the last delimiter, or 0 if there is none, then\n  // copy the first basic code points to the output.\n\n  basic = input.lastIndexOf(delimiter);\n  if (basic < 0) basic = 0;\n\n  for (j = 0; j < basic; ++j) {\n    if (preserveCase) case_flags[output.length] = input.charCodeAt(j) - 65 < 26;\n    if (input.charCodeAt(j) >= 0x80) {\n      throw new RangeError('Illegal input >= 0x80');\n    }\n    output.push(input.charCodeAt(j));\n  }\n\n  // Main decoding loop: Start just after the last delimiter if any\n  // basic code points were copied; start at the beginning otherwise.\n\n  for (ic = basic > 0 ? basic + 1 : 0; ic < input_length;) {\n    // ic is the index of the next character to be consumed,\n\n    // Decode a generalized variable-length integer into delta,\n    // which gets added to i. The overflow checking is easier\n    // if we increase i as we go, then subtract off its starting\n    // value at the end to obtain delta.\n    for (oldi = i, w = 1, k = base; ; k += base) {\n      if (ic >= input_length) {\n        throw RangeError('punycode_bad_input(1)');\n      }\n      digit = decode_digit(input.charCodeAt(ic++));\n\n      if (digit >= base) {\n        throw RangeError('punycode_bad_input(2)');\n      }\n      if (digit > Math.floor((maxint - i) / w)) {\n        throw RangeError('punycode_overflow(1)');\n      }\n      i += digit * w;\n      t = k <= bias ? tmin : k >= bias + tmax ? tmax : k - bias;\n      if (digit < t) {\n        break;\n      }\n      if (w > Math.floor(maxint / (base - t))) {\n        throw RangeError('punycode_overflow(2)');\n      }\n      w *= base - t;\n    }\n\n    out = output.length + 1;\n    bias = adapt(i - oldi, out, oldi === 0);\n\n    // i was supposed to wrap around from out to 0,\n    // incrementing n each time, so we'll fix that now:\n    if (Math.floor(i / out) > maxint - n) {\n      throw RangeError('punycode_overflow(3)');\n    }\n    n += Math.floor(i / out);\n    i %= out;\n\n    // Insert n at position i of the output:\n    // Case of last character determines uppercase flag:\n    if (preserveCase) {\n      case_flags.splice(i, 0, input.charCodeAt(ic - 1) - 65 < 26);\n    }\n\n    output.splice(i, 0, n);\n    i++;\n  }\n  if (preserveCase) {\n    for (i = 0, len = output.length; i < len; i++) {\n      if (case_flags[i]) {\n        output[i] = String.fromCharCode(output[i])\n          .toUpperCase()\n          .charCodeAt(0);\n      }\n    }\n  }\n  return utf16.encode(output);\n}\n\nfunction toUnicode(domain) {\n  const domain_array = domain.split('.');\n  const out = [];\n  for (let i = 0; i < domain_array.length; ++i) {\n    const s = domain_array[i];\n    out.push(s.match(/^xn--/) ? decode(s.slice(4)) : s);\n  }\n  return out.join('.');\n}\n\nexport default toUnicode;\n","import { DEBUG } from '../../config';\nimport convertPunycode from '../../lib/punycode';\n\nconst PROTOCOL_WHITELIST = new Set(['http:', 'https:', 'tg:', 'ton:', 'mailto:', 'tel:']);\nconst FALLBACK_PREFIX = 'https://';\n\nexport function ensureProtocol(url: string) {\n  try {\n    const parsedUrl = new URL(url);\n\n    if (!PROTOCOL_WHITELIST.has(parsedUrl.protocol)) {\n      return `${FALLBACK_PREFIX}${url}`;\n    }\n\n    return url;\n  } catch (err) {\n    return `${FALLBACK_PREFIX}${url}`;\n  }\n}\n\nexport function getUnicodeUrl(url: string) {\n  const href = ensureProtocol(url);\n\n  try {\n    const parsedUrl = new URL(href);\n    const unicodeDomain = convertPunycode(parsedUrl.hostname);\n\n    try {\n      return decodeURI(parsedUrl.toString()).replace(parsedUrl.hostname, unicodeDomain);\n    } catch (err) { // URL contains invalid sequences, keep it as it is\n      return parsedUrl.toString().replace(parsedUrl.hostname, unicodeDomain);\n    }\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('SafeLink.getDecodedUrl error ', url, error);\n    }\n  }\n\n  return undefined;\n}\n\nexport function isMixedScriptUrl(url: string): boolean {\n  let domain;\n  try {\n    domain = convertPunycode(new URL(ensureProtocol(url)).hostname);\n  } catch (e) {\n    return true; // If URL is invalid, treat it as mixed script\n  }\n\n  let hasLatin = false;\n  let hasNonLatin = false;\n\n  for (const char of Array.from(domain)) {\n    if (!/\\p{L}/u.test(char)) continue; // Ignore non-letter characters\n\n    if (/\\p{Script=Latin}/u.test(char)) {\n      hasLatin = true;\n    } else {\n      hasNonLatin = true;\n    }\n\n    if (hasLatin && hasNonLatin) return true;\n  }\n\n  return false;\n}\n","import type { ThreadId } from '../../types';\n\nexport function buildChatThreadKey(chatId: string, threadId: ThreadId) {\n  return `${chatId}_${threadId}`;\n}\n","import { getAverageColor, getColorLuma } from './colors';\n\nconst LUMA_THRESHOLD = 240;\n\nexport function scaleImage(image: string | Blob, ratio: number, outputType: string = 'image/png'): Promise<string> {\n  const url = image instanceof Blob ? URL.createObjectURL(image) : image;\n  const img = new Image();\n  return new Promise((resolve) => {\n    img.onload = () => {\n      scale(img, img.width * ratio, img.height * ratio, outputType)\n        .then((blob) => {\n          if (!blob) throw new Error('Image resize failed!');\n          return URL.createObjectURL(blob);\n        })\n        .then(resolve)\n        .finally(() => {\n          if (image instanceof Blob) {\n            URL.revokeObjectURL(url); // Revoke blob url that we created\n          }\n        });\n    };\n    img.src = url;\n  });\n}\n\nexport function resizeImage(\n  image: string | Blob, width: number, height: number, outputType: string = 'image/png',\n): Promise<string> {\n  const url = image instanceof Blob ? URL.createObjectURL(image) : image;\n  const img = new Image();\n  return new Promise((resolve) => {\n    img.onload = () => {\n      scale(img, width, height, outputType)\n        .then((blob) => {\n          if (!blob) throw new Error('Image resize failed!');\n          return URL.createObjectURL(blob);\n        })\n        .then(resolve)\n        .finally(() => {\n          if (image instanceof Blob) {\n            URL.revokeObjectURL(url); // Revoke blob url that we created\n          }\n        });\n    };\n    img.src = url;\n  });\n}\n\nasync function scale(\n  img: HTMLImageElement, width: number, height: number, outputType: string = 'image/png',\n): Promise<Blob | null> {\n  // Safari does not have built-in resize method with quality control\n  if ('createImageBitmap' in window) {\n    try {\n      const bitmap = await window.createImageBitmap(img,\n        { resizeWidth: width, resizeHeight: height, resizeQuality: 'high' });\n      if (bitmap.height !== height || bitmap.width !== width) {\n        throw new Error('Image bitmap resize not supported!'); // FF93 added support for options, but not resize\n      }\n      const averageColor = await getAverageColor(img.src);\n      const fillColor = getColorLuma(averageColor) < LUMA_THRESHOLD ? '#fff' : '#000';\n      return await new Promise((res) => {\n        const canvas = document.createElement('canvas');\n        canvas.width = bitmap.width;\n        canvas.height = bitmap.height;\n        const ctx2D = canvas.getContext('2d')!;\n        ctx2D.fillStyle = fillColor;\n        ctx2D.fillRect(0, 0, canvas.width, canvas.height);\n        const ctx = canvas.getContext('bitmaprenderer');\n        if (ctx) {\n          ctx.transferFromImageBitmap(bitmap);\n        } else {\n          ctx2D.drawImage(bitmap, 0, 0);\n        }\n        canvas.toBlob(res, outputType);\n      });\n    } catch (e) {\n      // Fallback. Firefox below 93 does not recognize `createImageBitmap` with 2 parameters\n      return steppedScale(img, width, height, undefined, outputType);\n    }\n  } else {\n    return steppedScale(img, width, height, undefined, outputType);\n  }\n}\n\nasync function steppedScale(\n  img: HTMLImageElement, width: number, height: number, step: number = 0.5, outputType: string = 'image/png',\n): Promise<Blob | null> {\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d')!;\n  const oc = document.createElement('canvas');\n  const octx = oc.getContext('2d')!;\n\n  canvas.width = width;\n  canvas.height = height;\n\n  if (img.width * step > width) { // For performance avoid unnecessary drawing\n    const mul = 1 / step;\n    let cur = {\n      width: Math.floor(img.width * step),\n      height: Math.floor(img.height * step),\n    };\n\n    oc.width = cur.width;\n    oc.height = cur.height;\n\n    octx.drawImage(img, 0, 0, cur.width, cur.height);\n\n    while (cur.width * step > width) {\n      cur = {\n        width: Math.floor(cur.width * step),\n        height: Math.floor(cur.height * step),\n      };\n      octx.drawImage(oc, 0, 0, cur.width * mul, cur.height * mul, 0, 0, cur.width, cur.height);\n    }\n\n    ctx.drawImage(oc, 0, 0, cur.width, cur.height, 0, 0, canvas.width, canvas.height);\n  } else {\n    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n  }\n\n  const averageColor = await getAverageColor(img.src);\n  const fillColor = getColorLuma(averageColor) < LUMA_THRESHOLD ? '#fff' : '#000';\n  ctx.fillStyle = fillColor;\n  ctx.globalCompositeOperation = 'destination-over';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  return new Promise((resolve) => {\n    canvas.toBlob(resolve, outputType);\n  });\n}\n","// Sometimes event is fired earlier than animation completes\nconst ANIMATION_END_DELAY = 50;\n\nexport function waitForTransitionEnd(\n  node: Node, handler: NoneToVoidFunction, propertyName?: string, fallbackMs?: number,\n) {\n  return waitForEndEvent('transitionend', node, handler, propertyName, fallbackMs);\n}\n\nexport function waitForAnimationEnd(\n  node: Node, handler: NoneToVoidFunction, animationName?: string, fallbackMs?: number,\n) {\n  return waitForEndEvent('animationend', node, handler, animationName, fallbackMs);\n}\n\nfunction waitForEndEvent(\n  eventType: 'transitionend' | 'animationend',\n  node: Node,\n  handler: NoneToVoidFunction,\n  detailedName?: string,\n  fallbackMs?: number,\n) {\n  let isHandled = false;\n\n  function cleanup() {\n    node.removeEventListener(eventType, handleAnimationEnd);\n  }\n\n  function handleAnimationEnd(e: TransitionEvent | AnimationEvent | Event) {\n    if (isHandled || e.target !== e.currentTarget) {\n      return;\n    }\n\n    if (detailedName && (\n      (e instanceof TransitionEvent && e.propertyName === detailedName)\n      || (e instanceof AnimationEvent && e.animationName === detailedName)\n    )) {\n      return;\n    }\n\n    isHandled = true;\n\n    cleanup();\n\n    setTimeout(() => {\n      handler();\n    }, ANIMATION_END_DELAY);\n  }\n\n  node.addEventListener(eventType, handleAnimationEnd);\n\n  if (fallbackMs) {\n    setTimeout(() => {\n      if (isHandled) return;\n\n      cleanup();\n\n      handler();\n    }, fallbackMs);\n  }\n\n  return cleanup;\n}\n","import { useCallback, useRef } from '../lib/teact/teact';\nimport { getActions } from '../global';\n\nimport { IS_TEST } from '../config';\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from '../util/browser/windowEnvironment';\nimport useEffectOnce from './useEffectOnce';\nimport useLastCallback from './useLastCallback';\nimport useSyncEffect from './useSyncEffect';\n\nconst PATH_BASE = `${window.location.pathname}${window.location.search}`;\n// Carefully selected by swiping and observing visual changes\n// TODO: may be different on other devices such as iPad, maybe take dpi into account?\nconst SAFARI_EDGE_BACK_GESTURE_LIMIT = 300;\nconst SAFARI_EDGE_BACK_GESTURE_DURATION = 350;\n\ntype HistoryRecord = {\n  index: number;\n  // Should this record be replaced by the next record (for example Menu)\n  shouldBeReplaced?: boolean;\n  // Mark this record as replaced by the next record. Only used to check if needed to perform effectBack\n  markReplaced?: VoidFunction;\n  onBack?: VoidFunction;\n  // Set if the element is closed in the UI, but not in the real history\n  isClosed?: boolean;\n};\n\ntype HistoryOperationGo = {\n  type: 'go';\n  delta: number;\n};\n\ntype HistoryOperationState = {\n  type: 'pushState' | 'replaceState';\n  data: any;\n  hash?: string;\n};\n\ntype HistoryOperation = HistoryOperationGo | HistoryOperationState;\n\n// Needed to dismiss any 'trashed' history records from the previous page reloads.\nconst historyUniqueSessionId = Number(new Date());\n// Reflects real history state, but also contains information on which records should be replaced by the next record and\n// which records are deferred to close on the next operation\nlet historyState: HistoryRecord[];\n// Reflects current real history index\nlet historyCursor: number;\n// If we alter real history programmatically, the popstate event will be fired, which we don't need\nlet isAlteringHistory = false;\n// Unfortunately Safari doesn't really like when there's 2+ consequent history operations in one frame, so we need\n// to delay them to the next raf\nlet deferredHistoryOperations: HistoryOperation[] = [];\nlet deferredPopstateOperations: HistoryOperationState[] = [];\nlet isSafariGestureAnimation = false;\n\n// Do not remove: used for history unit tests\nif (IS_TEST) {\n  (window as any).TEST_getHistoryState = () => historyState;\n  (window as any).TEST_getHistoryCursor = () => historyCursor;\n}\n\nfunction handleTouchStart(event: TouchEvent) {\n  const x = event.touches[0].pageX;\n\n  if (x <= SAFARI_EDGE_BACK_GESTURE_LIMIT || x >= window.innerWidth - SAFARI_EDGE_BACK_GESTURE_LIMIT) {\n    isSafariGestureAnimation = true;\n  }\n}\n\nfunction handleTouchEnd() {\n  if (!isSafariGestureAnimation) {\n    return;\n  }\n\n  setTimeout(() => {\n    isSafariGestureAnimation = false;\n  }, SAFARI_EDGE_BACK_GESTURE_DURATION);\n}\n\nif (IS_IOS) {\n  window.addEventListener('touchstart', handleTouchStart);\n  window.addEventListener('touchend', handleTouchEnd);\n  window.addEventListener('popstate', handleTouchEnd);\n}\n\nfunction applyDeferredHistoryOperations() {\n  const goOperations = deferredHistoryOperations.filter((op) => op.type === 'go');\n  const stateOperations = deferredHistoryOperations.filter((op) => op.type !== 'go');\n  const goCount = goOperations.reduce((acc, op) => acc + op.delta, 0);\n\n  deferredHistoryOperations = [];\n\n  if (goCount) {\n    window.history.go(goCount);\n\n    // If we have some `state` operations after the `go` operations, we need to wait until the popstate event\n    // so the order of operations is correctly preserved\n    if (stateOperations.length) {\n      deferredPopstateOperations.push(...stateOperations);\n      return;\n    }\n  }\n\n  processStateOperations(stateOperations);\n}\n\nfunction processStateOperations(stateOperations: HistoryOperationState[]) {\n  stateOperations.forEach((op) => window.history[op.type](op.data, '', op.hash));\n}\n\nfunction deferHistoryOperation(historyOperation: HistoryOperation) {\n  if (!deferredHistoryOperations.length) {\n    requestMeasure(applyDeferredHistoryOperations);\n  }\n\n  deferredHistoryOperations.push(historyOperation);\n}\n\n// Resets history to the `root` state\nfunction resetHistory() {\n  historyCursor = 0;\n  historyState = [{\n    index: 0,\n    onBack: () => window.history.back(),\n  }];\n\n  window.history.replaceState({ index: 0, historyUniqueSessionId }, '', PATH_BASE);\n}\n\nresetHistory();\n\nfunction cleanupClosed(alreadyClosedCount = 1) {\n  let countClosed = alreadyClosedCount;\n  for (let i = historyCursor - 1; i > 0; i--) {\n    if (!historyState[i].isClosed) break;\n    countClosed++;\n  }\n  if (countClosed) {\n    isAlteringHistory = true;\n    deferHistoryOperation({\n      type: 'go',\n      delta: -countClosed,\n    });\n  }\n  return countClosed;\n}\n\nfunction cleanupTrashedState() {\n  // Navigation to previous page reload, state of which was trashed by reload\n  let isAnimationDisabled = false;\n  for (let i = historyState.length - 1; i > 0; i--) {\n    if (historyState[i].isClosed) {\n      continue;\n    }\n    // TODO[history]: probably we should not call this inside the loop\n    if (!isAnimationDisabled && isSafariGestureAnimation) {\n      getActions().disableHistoryAnimations();\n      isAnimationDisabled = true;\n    }\n    historyState[i].onBack?.();\n  }\n\n  resetHistory();\n}\n\nwindow.addEventListener('popstate', ({ state }: PopStateEvent) => {\n  if (isAlteringHistory) {\n    isAlteringHistory = false;\n    if (deferredPopstateOperations.length) {\n      processStateOperations(deferredPopstateOperations);\n      deferredPopstateOperations = [];\n    }\n    return;\n  }\n\n  if (!state) {\n    cleanupTrashedState();\n\n    if (!window.location.hash) {\n      return;\n    }\n    return;\n  }\n\n  const { index, historyUniqueSessionId: previousUniqueSessionId } = state;\n  if (previousUniqueSessionId !== historyUniqueSessionId) {\n    cleanupTrashedState();\n    return;\n  }\n\n  // New real history state matches the old virtual one. Not possible in theory, but in practice we have Safari\n  if (index === historyCursor) {\n    return;\n  }\n\n  if (index < historyCursor) {\n    // Navigating back\n    let alreadyClosedCount = 0;\n    let isAnimationDisabled = false;\n    for (let i = historyCursor; i > index - alreadyClosedCount; i--) {\n      if (historyState[i].isClosed) {\n        alreadyClosedCount++;\n        continue;\n      }\n      // TODO[history]: probably we should not call this inside the loop\n      if (!isAnimationDisabled && isSafariGestureAnimation) {\n        getActions().disableHistoryAnimations();\n        isAnimationDisabled = true;\n      }\n      historyState[i].onBack?.();\n    }\n\n    const countClosed = cleanupClosed(alreadyClosedCount);\n    historyCursor += index - historyCursor - countClosed;\n\n    // Can happen when we have deferred a real back for some element (for example Menu), closed via UI,\n    // pressed back button and caused a pushState.\n    if (historyCursor < 0) {\n      historyCursor = 0;\n    }\n  } else if (index > historyCursor) {\n    // Forward navigation is not yet supported\n    isAlteringHistory = true;\n    deferHistoryOperation({\n      type: 'go',\n      delta: -(index - historyCursor),\n    });\n  }\n});\n\nexport default function useHistoryBack({\n  isActive,\n  shouldBeReplaced,\n  shouldResetUrlHash,\n  hash,\n  onBack,\n}: {\n  isActive?: boolean;\n  shouldBeReplaced?: boolean;\n  hash?: string;\n  shouldResetUrlHash?: boolean;\n  onBack: VoidFunction;\n}) {\n  const lastOnBack = useLastCallback(onBack);\n\n  // Active index of the record\n  const indexRef = useRef<number>();\n  const wasReplaced = useRef(false);\n\n  const isFirstRender = useRef(true);\n\n  const pushState = useCallback((forceReplace = false) => {\n    // Check if the old state should be replaced\n    const shouldReplace = forceReplace || historyState[historyCursor].shouldBeReplaced;\n    indexRef.current = shouldReplace ? historyCursor : ++historyCursor;\n\n    historyCursor = indexRef.current;\n\n    // Mark the previous record as replaced so effectBack doesn't perform back operation on the new record\n    const previousRecord = historyState[indexRef.current];\n    if (previousRecord && !previousRecord.isClosed) {\n      previousRecord.markReplaced?.();\n    }\n\n    historyState[indexRef.current] = {\n      index: indexRef.current,\n      onBack: lastOnBack,\n      shouldBeReplaced,\n      markReplaced: () => {\n        wasReplaced.current = true;\n      },\n    };\n\n    deferHistoryOperation({\n      type: shouldReplace ? 'replaceState' : 'pushState',\n      data: {\n        index: indexRef.current,\n        historyUniqueSessionId,\n      },\n      // Space is a hack to make the browser completely remove the hash\n      hash: hash ? `#${hash}` : (shouldResetUrlHash ? ' ' : undefined),\n    });\n  }, [hash, shouldBeReplaced, shouldResetUrlHash]);\n\n  const processBack = useCallback(() => {\n    // Only process back on open records\n    if (indexRef.current && historyState[indexRef.current] && !wasReplaced.current) {\n      historyState[indexRef.current].isClosed = true;\n      wasReplaced.current = true;\n      if (indexRef.current === historyCursor && !shouldBeReplaced) {\n        historyCursor -= cleanupClosed();\n      }\n    }\n  }, [shouldBeReplaced]);\n\n  // Process back navigation when element is unmounted\n  useEffectOnce(() => {\n    isFirstRender.current = false;\n    return () => {\n      if (!isActive || wasReplaced.current) return;\n      processBack();\n    };\n  });\n\n  useSyncEffect(([prevIsActive]) => {\n    if (prevIsActive === isActive) return;\n    if (isFirstRender.current && !isActive) return;\n\n    if (isActive) {\n      pushState();\n    } else {\n      processBack();\n    }\n  }, [isActive, processBack, pushState]);\n}\n","import { getGlobal } from '../global';\n\nimport { DEBUG } from '../config';\nimport { selectTabState } from '../global/selectors';\nimport { IS_TAURI } from './browser/globalEnvironment';\n\nexport function updateAppBadge(unreadCount: number, isMuted?: boolean) {\n  if (IS_TAURI) {\n    window.tauri?.setNotificationsCount?.(unreadCount, isMuted);\n    return;\n  }\n\n  if (!selectTabState(getGlobal()).isMasterTab) return;\n  if (typeof window.navigator.setAppBadge !== 'function') {\n    return;\n  }\n\n  window.navigator.setAppBadge(unreadCount).catch((err) => {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n    }\n  });\n}\n","import type { ApiMessage, ApiMessageReplyInfo, ApiStoryReplyInfo } from '../../api/types';\n\nexport function getMessageReplyInfo(message: ApiMessage): ApiMessageReplyInfo | undefined {\n  const { replyInfo } = message;\n  if (!replyInfo || replyInfo.type !== 'message') return undefined;\n  return replyInfo;\n}\n\nexport function getStoryReplyInfo(message: ApiMessage): ApiStoryReplyInfo | undefined {\n  const { replyInfo } = message;\n  if (!replyInfo || replyInfo.type !== 'story') return undefined;\n  return replyInfo;\n}\n","import type { ApiPrivacySettings, ApiUsername } from '../../../api/types';\nimport type { ActionReturnType } from '../../types';\nimport {\n  ProfileEditProgress,\n  SettingsScreens,\n  UPLOADING_WALLPAPER_SLUG,\n} from '../../../types';\n\nimport {\n  APP_CONFIG_REFETCH_INTERVAL,\n  COUNTRIES_WITH_12H_TIME_FORMAT,\n  MUTE_INDEFINITE_TIMESTAMP,\n  UNMUTE_TIMESTAMP,\n} from '../../../config';\nimport { toCredentialCreationOptions } from '../../../util/browser/passkeys';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { buildCollectionByKey } from '../../../util/iteratees';\nimport { requestPermission, subscribe, unsubscribe } from '../../../util/notifications';\nimport { setTimeFormat } from '../../../util/oldLangProvider';\nimport requestActionTimeout from '../../../util/requestActionTimeout';\nimport { getServerTime } from '../../../util/serverTime';\nimport { callApi } from '../../../api/gramjs';\nimport { buildApiInputPrivacyRules } from '../../helpers';\nimport { addActionHandler, getGlobal, getPromiseActions, setGlobal } from '../../index';\nimport {\n  addBlockedUser, addNotifyExceptions, deletePeerPhoto,\n  removeBlockedUser, replaceSettings, updateChat,\n  updateNotifyDefaults, updateSharedSettings, updateUser, updateUserFullInfo,\n} from '../../reducers';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectChat, selectIsCurrentUserFrozen,\n  selectTabState, selectUser,\n} from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\n\naddActionHandler('updateProfile', async (global, actions, payload): Promise<void> => {\n  const {\n    photo, firstName, lastName, bio: about, username,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: ProfileEditProgress.InProgress,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  if (photo) {\n    await callApi('uploadProfilePhoto', photo);\n  }\n\n  if (firstName || lastName || about) {\n    const result = await callApi('updateProfile', { firstName, lastName, about });\n    if (result) {\n      global = getGlobal();\n      const currentUser = currentUserId && selectUser(global, currentUserId);\n\n      if (currentUser) {\n        global = updateUser(\n          global,\n          currentUser.id,\n          {\n            firstName,\n            lastName,\n          },\n        );\n        global = updateUserFullInfo(global, currentUser.id, { bio: about });\n        setGlobal(global);\n      }\n    }\n  }\n\n  if (username !== undefined) {\n    const result = await callApi('updateUsername', username);\n    global = getGlobal();\n    const currentUser = currentUserId && selectUser(global, currentUserId);\n\n    if (result && currentUser) {\n      const shouldUsernameUpdate = currentUser.usernames?.find((u) => u.isEditable);\n      const usernames = shouldUsernameUpdate\n        ? currentUser.usernames?.map((u) => (u.isEditable ? { ...u, username } : u))\n        : [{ username, isEditable: true, isActive: true } as ApiUsername, ...currentUser.usernames || []];\n      global = updateUser(global, currentUserId, { usernames });\n      setGlobal(global);\n    }\n  }\n\n  global = getGlobal();\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: ProfileEditProgress.Complete,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  if (photo) {\n    actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n  }\n});\n\naddActionHandler('updateBirthday', async (global, actions, payload): Promise<void> => {\n  const { birthday } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) return;\n\n  const result = await callApi('updateBirthday', birthday);\n  if (!result) return;\n\n  actions.loadFullUser({ userId: currentUserId });\n});\n\naddActionHandler('updateProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const { photo, isFallback } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) return;\n  const currentUser = selectUser(global, currentUserId);\n  if (!currentUser) return;\n\n  global = updateUser(global, currentUserId, { avatarPhotoId: undefined });\n  global = updateUserFullInfo(global, currentUserId, { profilePhoto: undefined });\n\n  setGlobal(global);\n\n  const result = await callApi('updateProfilePhoto', photo, isFallback);\n  if (!result) return;\n\n  actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n});\n\naddActionHandler('deleteProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const { photo } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) return;\n\n  const isDeleted = await callApi('deleteProfilePhotos', [photo]);\n  if (!isDeleted) return;\n\n  global = getGlobal();\n  global = deletePeerPhoto(global, currentUserId, photo.id);\n  setGlobal(global);\n\n  actions.loadFullUser({ userId: currentUserId, withPhotos: true });\n});\n\naddActionHandler('checkUsername', async (global, actions, payload): Promise<void> => {\n  const { username, tabId = getCurrentTabId() } = payload;\n\n  let tabState = selectTabState(global, tabId);\n  // No need to check the username if profile update is already in progress\n  if (tabState.profileEdit && tabState.profileEdit.progress === ProfileEditProgress.InProgress) {\n    return;\n  }\n\n  global = updateTabState(global, {\n    profileEdit: {\n      progress: tabState.profileEdit ? tabState.profileEdit.progress : ProfileEditProgress.Idle,\n      checkedUsername: undefined,\n      isUsernameAvailable: undefined,\n      error: undefined,\n    },\n  }, tabId);\n  setGlobal(global);\n\n  const { result, error } = (await callApi('checkUsername', username));\n\n  global = getGlobal();\n  tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    profileEdit: {\n      ...tabState.profileEdit!,\n      checkedUsername: username,\n      isUsernameAvailable: result === true,\n      error,\n    },\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('loadWallpapers', async (global): Promise<void> => {\n  const result = await callApi('fetchWallpapers');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: result.wallpapers,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('uploadWallpaper', async (global, actions, payload): Promise<void> => {\n  const file = payload;\n  const previewBlobUrl = URL.createObjectURL(file);\n\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: [\n        {\n          slug: UPLOADING_WALLPAPER_SLUG,\n          document: {\n            mediaType: 'document',\n            fileName: '',\n            size: file.size,\n            mimeType: file.type,\n            previewBlobUrl,\n          },\n        },\n        ...(global.settings.loadedWallpapers || []),\n      ],\n    },\n  };\n  setGlobal(global);\n\n  const result = await callApi('uploadWallpaper', file);\n  if (!result) {\n    return;\n  }\n\n  const { wallpaper } = result;\n\n  global = getGlobal();\n  if (!global.settings.loadedWallpapers) {\n    return;\n  }\n\n  const firstWallpaper = global.settings.loadedWallpapers[0];\n  if (!firstWallpaper || firstWallpaper.slug !== UPLOADING_WALLPAPER_SLUG) {\n    return;\n  }\n\n  const withLocalMedia = {\n    ...wallpaper,\n    document: {\n      ...wallpaper.document,\n      previewBlobUrl,\n    },\n  };\n\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      loadedWallpapers: [\n        withLocalMedia,\n        ...global.settings.loadedWallpapers.slice(1),\n      ],\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadBlockedUsers', async (global): Promise<void> => {\n  const result = await callApi('fetchBlockedUsers', {});\n  if (!result) return;\n\n  global = getGlobal();\n\n  global = {\n    ...global,\n    blocked: {\n      ids: result.blockedIds,\n      totalCount: result.totalCount,\n    },\n  };\n\n  setGlobal(global);\n});\n\naddActionHandler('blockUser', async (global, actions, payload): Promise<void> => {\n  const { userId, isOnlyStories } = payload;\n\n  const user = selectUser(global, userId);\n  if (!user) return;\n\n  const result = await callApi('blockUser', {\n    user,\n    isOnlyStories: isOnlyStories || undefined,\n  });\n  if (!result) return;\n\n  global = getGlobal();\n  global = addBlockedUser(global, userId);\n  setGlobal(global);\n});\n\naddActionHandler('unblockUser', async (global, actions, payload): Promise<void> => {\n  const { userId, isOnlyStories } = payload;\n\n  const user = selectUser(global, userId);\n  if (!user) return;\n\n  const result = await callApi('unblockUser', {\n    user,\n    isOnlyStories: isOnlyStories || undefined,\n  });\n  if (!result) return;\n\n  global = getGlobal();\n  global = removeBlockedUser(global, userId);\n  setGlobal(global);\n});\n\naddActionHandler('loadNotificationExceptions', async (global): Promise<void> => {\n  const result = await callApi('fetchNotificationExceptions');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = addNotifyExceptions(global, result);\n  setGlobal(global);\n});\n\naddActionHandler('loadNotificationSettings', async (global): Promise<void> => {\n  const [signUpNotification, notifyDefaults] = await Promise.all([\n    callApi('fetchContactSignUpSetting'),\n    callApi('fetchNotifyDefaultSettings'),\n  ]);\n\n  if (!notifyDefaults) return;\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    hasContactJoinedNotifications: signUpNotification,\n  });\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      notifyDefaults,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('updateNotificationSettings', async (global, actions, payload): Promise<void> => {\n  const { peerType, isMuted, shouldShowPreviews } = payload;\n\n  const result = await callApi('updateNotificationSettings', peerType, { isMuted, shouldShowPreviews });\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = updateNotifyDefaults(global, peerType, {\n    mutedUntil: isMuted ? MUTE_INDEFINITE_TIMESTAMP : UNMUTE_TIMESTAMP,\n    shouldShowPreviews,\n  });\n  setGlobal(global);\n});\n\naddActionHandler('updateWebNotificationSettings', async (global, actions, payload): Promise<void> => {\n  const oldSettings = global.settings.byKey;\n  global = replaceSettings(global, payload);\n  setGlobal(global);\n  const { hasWebNotifications, hasPushNotifications } = global.settings.byKey;\n  if (!oldSettings.hasPushNotifications && hasPushNotifications) {\n    await subscribe();\n  }\n  if (oldSettings.hasPushNotifications && !hasPushNotifications) {\n    await unsubscribe();\n  }\n  if (!oldSettings.hasWebNotifications && hasWebNotifications) {\n    const isGranted = await requestPermission();\n    if (!isGranted) {\n      global = getGlobal();\n      global = replaceSettings(global, { hasWebNotifications: false });\n      setGlobal(global);\n    }\n  }\n});\n\naddActionHandler('updateContactSignUpNotification', async (global, actions, payload): Promise<void> => {\n  const { isSilent } = payload;\n\n  const result = await callApi('updateContactSignUpNotification', isSilent);\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = replaceSettings(global, { hasContactJoinedNotifications: !isSilent });\n  setGlobal(global);\n});\n\naddActionHandler('loadLanguages', async (global): Promise<void> => {\n  const result = await callApi('fetchLanguages');\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = updateSharedSettings(global, { languages: result });\n  setGlobal(global);\n});\n\naddActionHandler('loadPrivacySettings', async (global, actions, payload): Promise<void> => {\n  const { skipIfCached } = payload;\n  if (skipIfCached && Object.keys(global.settings.privacy).length > 0) {\n    return;\n  }\n\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const result = await Promise.all([\n    callApi('fetchPrivacySettings', 'phoneNumber'),\n    callApi('fetchPrivacySettings', 'addByPhone'),\n    callApi('fetchPrivacySettings', 'lastSeen'),\n    callApi('fetchPrivacySettings', 'profilePhoto'),\n    callApi('fetchPrivacySettings', 'forwards'),\n    callApi('fetchPrivacySettings', 'chatInvite'),\n    callApi('fetchPrivacySettings', 'phoneCall'),\n    callApi('fetchPrivacySettings', 'phoneP2P'),\n    callApi('fetchPrivacySettings', 'voiceMessages'),\n    callApi('fetchPrivacySettings', 'bio'),\n    callApi('fetchPrivacySettings', 'birthday'),\n    callApi('fetchPrivacySettings', 'gifts'),\n    callApi('fetchPrivacySettings', 'noPaidMessages'),\n  ]);\n\n  if (result.some((e) => e === undefined)) {\n    return;\n  }\n\n  const [\n    phoneNumberSettings,\n    addByPhoneSettings,\n    lastSeenSettings,\n    profilePhotoSettings,\n    forwardsSettings,\n    chatInviteSettings,\n    phoneCallSettings,\n    phoneP2PSettings,\n    voiceMessagesSettings,\n    bioSettings,\n    birthdaySettings,\n    giftsSettings,\n    noPaidMessagesSettings,\n  ] = result as {\n    rules: ApiPrivacySettings;\n  }[];\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        phoneNumber: phoneNumberSettings.rules,\n        addByPhone: addByPhoneSettings.rules,\n        lastSeen: lastSeenSettings.rules,\n        profilePhoto: profilePhotoSettings.rules,\n        forwards: forwardsSettings.rules,\n        chatInvite: chatInviteSettings.rules,\n        phoneCall: phoneCallSettings.rules,\n        phoneP2P: phoneP2PSettings.rules,\n        voiceMessages: voiceMessagesSettings.rules,\n        bio: bioSettings.rules,\n        birthday: birthdaySettings.rules,\n        gifts: giftsSettings.rules,\n        noPaidMessages: noPaidMessagesSettings.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('setPrivacyVisibility', async (global, actions, payload): Promise<void> => {\n  const { privacyKey, visibility, onSuccess } = payload;\n\n  if (!global.settings.privacy[privacyKey]) {\n    const result = await callApi('fetchPrivacySettings', privacyKey);\n    if (!result) {\n      return;\n    }\n\n    global = getGlobal();\n    global = {\n      ...global,\n      settings: {\n        ...global.settings,\n        privacy: {\n          ...global.settings.privacy,\n          [privacyKey]: result.rules,\n        },\n      },\n    };\n    setGlobal(global);\n  }\n\n  const {\n    privacy: { [privacyKey]: settings },\n  } = global.settings;\n\n  if (!settings) {\n    return;\n  }\n\n  const rules = buildApiInputPrivacyRules(global, {\n    visibility,\n    allowedIds: [...settings.allowUserIds, ...settings.allowChatIds],\n    blockedIds: [...settings.blockUserIds, ...settings.blockChatIds],\n    botsPrivacy: settings.botsPrivacy,\n  });\n\n  const result = await callApi('setPrivacySettings', privacyKey, rules);\n  if (!result) {\n    return;\n  }\n\n  onSuccess?.();\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        [privacyKey]: result.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('setPrivacySettings', async (global, actions, payload): Promise<void> => {\n  const {\n    privacyKey, isAllowList, updatedIds, isPremiumAllowed, botsPrivacy,\n  } = payload;\n  const {\n    privacy: { [privacyKey]: settings },\n  } = global.settings;\n\n  if (!settings) {\n    return;\n  }\n\n  if (privacyKey === 'noPaidMessages') {\n    global = getGlobal();\n    const idsForUpdate = [\n      ...updatedIds.filter((id) => !settings.allowUserIds.includes(id)),\n      ...settings.allowUserIds.filter((id) => !updatedIds.includes(id)),\n    ];\n\n    idsForUpdate.forEach((userId) => {\n      global = updateUserFullInfo(global, userId, {\n        settings: undefined,\n      });\n    });\n    setGlobal(global);\n  }\n\n  const rules = buildApiInputPrivacyRules(global, {\n    visibility: settings.visibility,\n    isUnspecified: settings.isUnspecified,\n    shouldAllowPremium: isPremiumAllowed,\n    allowedIds: isAllowList ? updatedIds : [...settings.allowUserIds, ...settings.allowChatIds],\n    blockedIds: !isAllowList ? updatedIds : [...settings.blockUserIds, ...settings.blockChatIds],\n    botsPrivacy,\n  });\n\n  const result = await callApi('setPrivacySettings', privacyKey, rules);\n  if (!result) {\n    return;\n  }\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      privacy: {\n        ...global.settings.privacy,\n        [privacyKey]: result.rules,\n      },\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('updateIsOnline', (global, actions, payload): ActionReturnType => {\n  if (global.connectionState !== 'connectionStateReady') return;\n  callApi('updateIsOnline', payload.isOnline);\n});\n\naddActionHandler('loadContentSettings', async (global): Promise<void> => {\n  if (selectIsCurrentUserFrozen(global)) return;\n\n  const result = await callApi('fetchContentSettings');\n  if (!result) return;\n\n  global = getGlobal();\n  global = replaceSettings(global, result);\n  setGlobal(global);\n});\n\naddActionHandler('updateContentSettings', async (global, actions, payload): Promise<void> => {\n  global = replaceSettings(global, { isSensitiveEnabled: payload.isSensitiveEnabled });\n  setGlobal(global);\n\n  const result = await callApi('updateContentSettings', payload.isSensitiveEnabled);\n  if (!result) {\n    global = getGlobal();\n    global = replaceSettings(global, { isSensitiveEnabled: !payload.isSensitiveEnabled });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadCountryList', async (global, actions, payload): Promise<void> => {\n  let { langCode } = payload;\n  if (!langCode) langCode = selectSharedSettings(global).language;\n\n  const countryList = await callApi('fetchCountryList', { langCode });\n  if (!countryList) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    countryList,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('ensureTimeFormat', async (global, actions): Promise<void> => {\n  if (global.auth.nearestCountry) {\n    const timeFormat = COUNTRIES_WITH_12H_TIME_FORMAT\n      .has(global.auth.nearestCountry.toUpperCase()) ? '12h' : '24h';\n    actions.setSharedSettingOption({ timeFormat });\n    setTimeFormat(timeFormat);\n  }\n\n  if (selectSharedSettings(global).wasTimeFormatSetManually) {\n    return;\n  }\n\n  const nearestCountryCode = await callApi('fetchNearestCountry');\n  if (nearestCountryCode) {\n    const timeFormat = COUNTRIES_WITH_12H_TIME_FORMAT.has(nearestCountryCode.toUpperCase()) ? '12h' : '24h';\n    actions.setSharedSettingOption({ timeFormat });\n    setTimeFormat(timeFormat);\n  }\n});\n\naddActionHandler('loadAppConfig', async (global, actions, payload): Promise<void> => {\n  const hash = payload?.hash;\n\n  const appConfig = await callApi('fetchAppConfig', { hash });\n  if (!appConfig) return;\n\n  requestActionTimeout({\n    action: 'loadAppConfig',\n    payload: { hash: appConfig.hash },\n  }, APP_CONFIG_REFETCH_INTERVAL);\n\n  global = getGlobal();\n  global = {\n    ...global,\n    appConfig,\n    isAppConfigLoaded: true,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadConfig', async (global): Promise<void> => {\n  const config = await callApi('fetchConfig');\n  if (!config) return;\n\n  global = getGlobal();\n  const timeout = config.expiresAt - getServerTime();\n  requestActionTimeout({\n    action: 'loadConfig',\n    payload: undefined,\n  }, timeout * 1000);\n\n  global = {\n    ...global,\n    config,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadPromoData', async (global): Promise<void> => {\n  const promoData = await callApi('fetchPromoData');\n\n  global = getGlobal();\n  const timeout = (promoData?.expires || 0) - getServerTime();\n  if (timeout > 0) {\n    requestActionTimeout({\n      action: 'loadPromoData',\n      payload: undefined,\n    }, timeout * 1000);\n  }\n\n  global = {\n    ...global,\n    promoData,\n  };\n  setGlobal(global);\n});\n\naddActionHandler('dismissSuggestion', async (global, actions, payload): Promise<void> => {\n  const { suggestion } = payload;\n  await callApi('dismissSuggestion', suggestion);\n\n  actions.loadPromoData();\n});\n\naddActionHandler('loadPeerColors', async (global): Promise<void> => {\n  const generalHash = global.peerColors?.generalHash;\n  const profileHash = global.peerColors?.profileHash;\n  const [generalResult, profileResult] = await Promise.all([\n    callApi('fetchPeerColors', generalHash),\n    callApi('fetchPeerProfileColors', profileHash),\n  ]);\n\n  if (!generalResult && !profileResult) return;\n\n  global = getGlobal();\n\n  const currentPeerColors = global.peerColors! || {};\n\n  global = {\n    ...global,\n    peerColors: {\n      ...currentPeerColors,\n      general: generalResult?.colors || currentPeerColors.general,\n      generalHash: generalResult?.hash || currentPeerColors.generalHash,\n      profile: profileResult?.colors || currentPeerColors.profile,\n      profileHash: profileResult?.hash || currentPeerColors.profileHash,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadTimezones', async (global): Promise<void> => {\n  const hash = global.timezones?.hash;\n  const result = await callApi('fetchTimezones', hash);\n  if (!result) return;\n\n  global = getGlobal();\n  global = {\n    ...global,\n    timezones: {\n      byId: buildCollectionByKey(result.timezones, 'id'),\n      hash: result.hash,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('loadGlobalPrivacySettings', async (global): Promise<void> => {\n  const globalSettings = await callApi('fetchGlobalPrivacySettings');\n  if (!globalSettings) {\n    return;\n  }\n\n  global = getGlobal();\n  global = replaceSettings(global, { ...globalSettings });\n  setGlobal(global);\n});\n\naddActionHandler('updateGlobalPrivacySettings', async (global, actions, payload): Promise<void> => {\n  const shouldArchiveAndMuteNewNonContact = payload.shouldArchiveAndMuteNewNonContact\n    ?? Boolean(global.settings.byKey.shouldArchiveAndMuteNewNonContact);\n  const shouldHideReadMarks = payload.shouldHideReadMarks ?? Boolean(global.settings.byKey.shouldHideReadMarks);\n  const shouldNewNonContactPeersRequirePremium = payload.shouldNewNonContactPeersRequirePremium\n    ?? Boolean(global.settings.byKey.shouldNewNonContactPeersRequirePremium);\n    // eslint-disable-next-line no-null/no-null\n  const nonContactPeersPaidStars = payload.nonContactPeersPaidStars === null ? undefined\n    : payload.nonContactPeersPaidStars || global.settings.byKey.nonContactPeersPaidStars;\n  const shouldDisplayGiftsButton = payload.shouldDisplayGiftsButton\n    ?? Boolean(global.settings.byKey.shouldDisplayGiftsButton);\n  const disallowedGifts = payload.disallowedGifts\n    ?? global.settings.byKey.disallowedGifts;\n\n  // eslint-disable-next-line no-null/no-null\n  const shouldUpdateUsersSettings = (payload.nonContactPeersPaidStars === null)\n    || payload.nonContactPeersPaidStars;\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars,\n    shouldDisplayGiftsButton,\n    disallowedGifts,\n  });\n  setGlobal(global);\n\n  const result = await callApi('updateGlobalPrivacySettings', {\n    shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars,\n    shouldDisplayGiftsButton,\n    disallowedGifts,\n  });\n\n  global = getGlobal();\n  global = replaceSettings(global, {\n    shouldArchiveAndMuteNewNonContact: !result\n      ? !shouldArchiveAndMuteNewNonContact\n      : result.shouldArchiveAndMuteNewNonContact,\n    shouldHideReadMarks: !result ? !shouldHideReadMarks : result.shouldHideReadMarks,\n    shouldNewNonContactPeersRequirePremium: !result\n      ? !shouldNewNonContactPeersRequirePremium\n      : result.shouldNewNonContactPeersRequirePremium,\n    nonContactPeersPaidStars: !result\n      ? undefined\n      : result.nonContactPeersPaidStars,\n    shouldDisplayGiftsButton: !result ? !shouldDisplayGiftsButton : result.shouldDisplayGiftsButton,\n    disallowedGifts: !result ? disallowedGifts : result.disallowedGifts,\n  });\n\n  if (shouldUpdateUsersSettings) {\n    Object.keys(global.users.fullInfoById).forEach((userId) => {\n      global = updateUserFullInfo(global, userId, {\n        settings: undefined,\n      });\n    });\n  }\n\n  setGlobal(global);\n});\n\naddActionHandler('toggleUsername', async (global, actions, payload): Promise<void> => {\n  const { username, isActive } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  const currentUser = selectUser(global, currentUserId);\n  if (!currentUser?.usernames) {\n    return;\n  }\n\n  const usernames = currentUser.usernames.map((item) => {\n    if (item.username !== username) {\n      return item;\n    }\n\n    return { ...item, isActive: isActive || undefined };\n  });\n\n  global = updateUser(global, currentUserId, { usernames });\n  setGlobal(global);\n\n  const result = await callApi('toggleUsername', { username, isActive });\n\n  if (!result) {\n    actions.loadFullUser({ userId: currentUserId });\n  }\n});\n\naddActionHandler('toggleChatUsername', async (global, actions, payload): Promise<void> => {\n  const {\n    chatId, username, isActive,\n  } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat?.usernames) {\n    return;\n  }\n\n  const usernames = chat.usernames.map((item) => {\n    if (item.username !== username) {\n      return item;\n    }\n\n    return { ...item, isActive: isActive || undefined };\n  });\n\n  global = updateChat(global, chatId, { usernames });\n  setGlobal(global);\n\n  const result = await callApi('toggleUsername', {\n    chatId: chat.id,\n    accessHash: chat.accessHash,\n    username,\n    isActive,\n  });\n\n  if (!result) {\n    actions.loadFullChat({ chatId });\n  }\n});\n\naddActionHandler('sortUsernames', async (global, actions, payload): Promise<void> => {\n  const { usernames } = payload;\n  const { currentUserId } = global;\n  if (!currentUserId) {\n    return;\n  }\n\n  const result = await callApi('reorderUsernames', { usernames });\n\n  // After saving the order of usernames, server sends an update with the necessary data,\n  // so there is no need to update the state in this place\n  if (!result) {\n    actions.loadUser({ userId: currentUserId });\n  }\n});\n\naddActionHandler('sortChatUsernames', async (global, actions, payload): Promise<void> => {\n  const { chatId, usernames } = payload;\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return;\n  }\n\n  const prevUsernames = [...chat.usernames!];\n  const sortedUsernames = chat.usernames!.reduce((res, currentUsername) => {\n    const idx = usernames.findIndex((username) => username === currentUsername.username);\n    res[idx] = currentUsername;\n\n    return res;\n  }, [] as ApiUsername[]);\n\n  global = updateChat(global, chatId, { usernames: sortedUsernames });\n  setGlobal(global);\n\n  const result = await callApi('reorderUsernames', {\n    chatId: chat.id,\n    accessHash: chat.accessHash,\n    usernames,\n  });\n\n  if (!result) {\n    global = getGlobal();\n    global = updateChat(global, chatId, { usernames: prevUsernames });\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadPasskeys', async (global): Promise<void> => {\n  const result = await callApi('fetchPasskeys');\n  if (!result) {\n    global = getGlobal();\n    global = {\n      ...global,\n      settings: {\n        ...global.settings,\n        passkeys: undefined,\n      },\n    };\n    setGlobal(global);\n    return;\n  }\n\n  global = getGlobal();\n  global = {\n    ...global,\n    settings: {\n      ...global.settings,\n      passkeys: result.passkeys,\n    },\n  };\n  setGlobal(global);\n});\n\naddActionHandler('startPasskeyRegistration', async (global, actions, payload): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  const preparedOptions = await callApi('initPasskeyRegistration');\n  if (!preparedOptions) return;\n\n  const options = toCredentialCreationOptions(preparedOptions);\n  const credential = await navigator.credentials.create(options).catch((e: unknown) => {\n    if (e instanceof DOMException && e.name === 'NotAllowedError') {\n      actions.showNotification({\n        message: {\n          key: 'PasskeyCreateError',\n        },\n        tabId,\n      });\n      return undefined;\n    }\n    throw e;\n  });\n  if (!credential) return;\n  const publicKeyCredential = credential as PublicKeyCredential;\n\n  const result = await callApi('registerPasskey', publicKeyCredential.toJSON());\n  if (!result) return;\n\n  await getPromiseActions().loadPasskeys();\n  actions.openSettingsScreen({ screen: SettingsScreens.Passkeys, tabId });\n});\n\naddActionHandler('deletePasskey', async (global, actions, payload): Promise<void> => {\n  const { id } = payload;\n\n  const passkeys = global.settings.passkeys;\n  if (passkeys?.length) {\n    const filteredPasskeys = passkeys.filter((passkey) => passkey.id !== id);\n    global = {\n      ...global,\n      settings: {\n        ...global.settings,\n        passkeys: filteredPasskeys,\n      },\n    };\n    setGlobal(global);\n  }\n\n  await callApi('deletePasskey', { id });\n\n  actions.loadPasskeys();\n});\n","import type {\n  ApiChat,\n  ApiNotifyPeerType,\n  ApiPeer,\n  ApiPeerNotifySettings,\n} from '../../api/types';\n\nimport { isUserId } from '../../util/entities/ids';\nimport { omitUndefined } from '../../util/iteratees';\nimport { getServerTime } from '../../util/serverTime';\nimport { isChatChannel } from './chats';\n\nexport function getIsChatMuted(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  if (!settings?.mutedUntil) return false;\n  return getServerTime() < settings.mutedUntil;\n}\n\nexport function getIsChatSilent(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  if (!settings) return false;\n  return !settings.hasSound;\n}\n\nexport function getShouldShowMessagePreview(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n) {\n  const settings = getChatNotifySettings(chat, notifyDefaults, notifyException);\n  return Boolean(settings?.shouldShowPreviews);\n}\n\nexport function getChatNotifySettings(\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyException?: ApiPeerNotifySettings,\n): ApiPeerNotifySettings | undefined {\n  const defaults = notifyDefaults?.[getNotificationPeerType(chat)];\n\n  if (!notifyException && !defaults) {\n    return undefined;\n  }\n\n  return {\n    ...defaults,\n    ...(notifyException && omitUndefined(notifyException)),\n  };\n}\n\nexport function getNotificationPeerType(peer: ApiPeer): ApiNotifyPeerType {\n  if (isUserId(peer.id)) {\n    return 'users';\n  }\n\n  const chat = peer as ApiChat;\n  return isChatChannel(chat) ? 'channels' : 'groups';\n}\n","import { SVG_NAMESPACE } from '../config';\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport jsxToHtml from './element/jsxToHtml';\nimport generateUniqueId from './generateUniqueId';\n\nconst DEFINITION_MAP = new Map<string, Element>();\n\nlet defs: SVGElement | undefined;\n\nfunction init() {\n  if (defs) return;\n\n  const container = document.createElementNS(SVG_NAMESPACE, 'svg');\n  container.setAttribute('width', '0');\n  container.setAttribute('height', '0');\n  container.setAttribute('viewBox', '0 0 1 1');\n  container.classList.add('svg-definitions');\n  document.body.appendChild(container);\n\n  defs = document.createElementNS(SVG_NAMESPACE, 'defs');\n  container.appendChild(defs);\n}\n\nfunction appendElement(element: Element) {\n  requestMutation(() => {\n    if (!defs) init();\n    defs!.appendChild(element);\n  });\n}\n\nexport function addSvgDefinition(element: React.JSX.Element, id?: string) {\n  id ??= generateUniqueId();\n  element.props.id = id;\n\n  const htmlElement = jsxToHtml(element)[0];\n  DEFINITION_MAP.set(element.props.id, htmlElement);\n  appendElement(htmlElement);\n  return id;\n}\n\nexport function removeSvgDefinition(id: string) {\n  const element = DEFINITION_MAP.get(id);\n  if (element) {\n    requestMutation(() => {\n      element.remove();\n    });\n    DEFINITION_MAP.delete(id);\n  }\n}\n","import { useRef } from '../lib/teact/teact';\n\n// This is not render-dependent and will never allow previous to match current\nexport default function usePrevious<T>(current: T) {\n  const prevRef = useRef<T>();\n  const lastRef = useRef<T>();\n\n  if (lastRef.current !== current) {\n    prevRef.current = lastRef.current;\n  }\n\n  lastRef.current = current;\n\n  return prevRef.current;\n}\n","import type { ApiSticker, ApiStickerSet, ApiStickerSetInfo } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { RESTRICTED_EMOJI_SET_ID, TON_CURRENCY_CODE } from '../../config';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { convertCurrencyFromBaseUnit } from '../../util/formatCurrency';\nimport { selectTabState } from './tabs';\nimport { selectIsCurrentUserPremium } from './users';\n\n// Duration in days\nconst MONTH = 30;\nconst QUARTER_YEAR = MONTH * 3;\nconst HALF_YEAR = MONTH * 6;\nconst YEAR = MONTH * 12;\nconst TWO_YEARS = MONTH * 24;\n\nconst DURATION_DELTA = 5;\n\n// https://github.com/DrKLO/Telegram/blob/c319639e9a4dff2f22da6762dcebd12d49f5afa1/TMessagesProj/src/main/java/org/telegram/ui/Components/Premium/boosts/cells/msg/GiveawayMessageCell.java#L59\nconst DURATION_EMOTICON: Record<number, string> = {\n  [MONTH]: `${1}\\u{FE0F}\\u20E3`, // 1 month\n  [QUARTER_YEAR]: `${2}\\u{FE0F}\\u20E3`, // 3 months\n  [HALF_YEAR]: `${3}\\u{FE0F}\\u20E3`, // 6 months\n  [YEAR]: `${4}\\u{FE0F}\\u20E3`, // 12 months\n  [TWO_YEARS]: `${5}\\u{FE0F}\\u20E3`, // 24 months\n};\n\nconst STAR_EMOTICON: Record<number, string> = {\n  1000: `${2}\\u{FE0F}\\u20E3`,\n  2500: `${3}\\u{FE0F}\\u20E3`,\n  5000: `${4}\\u{FE0F}\\u20E3`,\n};\n\nconst TON_EMOTICON: Record<number, string> = {\n  1: `${1}\\u{FE0F}\\u20E3`,\n  10: `${2}\\u{FE0F}\\u20E3`,\n  50: `${3}\\u{FE0F}\\u20E3`,\n};\n\nexport function selectIsStickerFavorite<T extends GlobalState>(global: T, sticker: ApiSticker) {\n  const { stickers } = global.stickers.favorite;\n  return stickers && stickers.some(({ id }) => id === sticker.id);\n}\n\nexport function selectCurrentStickerSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).stickerSearch;\n}\n\nexport function selectCurrentGifSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).gifSearch;\n}\n\nexport function selectStickerSet<T extends GlobalState>(global: T, id: string | ApiStickerSetInfo) {\n  if (typeof id === 'string') {\n    return global.stickers.setsById[id];\n  }\n\n  if ('id' in id) {\n    return global.stickers.setsById[id.id];\n  }\n\n  if ('isMissing' in id) return undefined;\n\n  return Object.values(global.stickers.setsById).find(({ shortName }) => (\n    shortName.toLowerCase() === id.shortName.toLowerCase()\n  ));\n}\n\nexport function selectStickersForEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const addedSets = global.stickers.added.setIds;\n  let stickersForEmoji: ApiSticker[] = [];\n  // Favorites\n  global.stickers.favorite.stickers.forEach((sticker) => {\n    if (sticker.emoji === emoji) stickersForEmoji.push(sticker);\n  });\n\n  // Added sets\n  addedSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n\n    stickersForEmoji = stickersForEmoji.concat(packs[emoji] || [], packs[cleanEmoji(emoji)] || []);\n  });\n  return stickersForEmoji;\n}\n\nexport function selectCustomEmojiForEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n  const addedCustomSets = global.customEmojis.added.setIds;\n  let customEmojiForEmoji: ApiSticker[] = [];\n\n  // Added sets\n  addedCustomSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n\n    customEmojiForEmoji = customEmojiForEmoji.concat(packs[emoji] || [], packs[cleanEmoji(emoji)] || []);\n  });\n  return isCurrentUserPremium ? customEmojiForEmoji : customEmojiForEmoji.filter(({ isFree }) => isFree);\n}\n\n// Slow, not to be used in `withGlobal`\nexport function selectCustomEmojiForEmojis<T extends GlobalState>(global: T, emojis: string[]) {\n  const isCurrentUserPremium = selectIsCurrentUserPremium(global);\n  const addedCustomSets = global.customEmojis.added.setIds;\n  let customEmojiForEmoji: ApiSticker[] = [];\n\n  // Added sets\n  addedCustomSets?.forEach((id) => {\n    const packs = global.stickers.setsById[id].packs;\n    if (!packs) {\n      return;\n    }\n    const customEmojis = Object.entries(packs).filter(([emoji]) => (\n      emojis.includes(emoji) || emojis.includes(cleanEmoji(emoji))\n    )).flatMap(([, stickers]) => stickers);\n    customEmojiForEmoji = customEmojiForEmoji.concat(customEmojis);\n  });\n  return isCurrentUserPremium ? customEmojiForEmoji : customEmojiForEmoji.filter(({ isFree }) => isFree);\n}\n\nexport function selectIsSetPremium(stickerSet: Pick<ApiStickerSet, 'stickers' | 'isEmoji'>) {\n  return stickerSet.isEmoji && stickerSet.stickers?.some((sticker) => !sticker.isFree);\n}\n\nfunction cleanEmoji(emoji: string) {\n  // Some emojis ( for example) with a service symbol 'VARIATION SELECTOR-16' are not recognized as animated\n  return emoji.replace('\\ufe0f', '');\n}\n\nexport function selectAnimatedEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const { animatedEmojis } = global;\n  if (!animatedEmojis || !animatedEmojis.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return animatedEmojis.stickers.find((sticker) => sticker.emoji === emoji || sticker.emoji === cleanedEmoji);\n}\n\nexport function selectRestrictedEmoji<T extends GlobalState>(global: T, emoji: string) {\n  const { restrictedEmoji } = global;\n  if (!restrictedEmoji || !restrictedEmoji.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return restrictedEmoji.stickers.find((sticker) => {\n    if (!sticker.emoji) return undefined;\n    const cleanedStickerEmoji = cleanEmoji(sticker.emoji);\n    return cleanedStickerEmoji === cleanedEmoji;\n  });\n}\n\nexport function selectAnimatedEmojiEffect<T extends GlobalState>(global: T, emoji: string) {\n  const { animatedEmojiEffects } = global;\n  if (!animatedEmojiEffects || !animatedEmojiEffects.stickers) {\n    return undefined;\n  }\n\n  const cleanedEmoji = cleanEmoji(emoji);\n\n  return animatedEmojiEffects.stickers.find((sticker) => sticker.emoji === emoji || sticker.emoji === cleanedEmoji);\n}\n\nexport function selectAnimatedEmojiSound<T extends GlobalState>(global: T, emoji: string) {\n  return global?.appConfig.emojiSounds[cleanEmoji(emoji)];\n}\n\nexport function selectIsAlwaysHighPriorityEmoji<T extends GlobalState>(\n  global: T, stickerSet: ApiStickerSetInfo | ApiStickerSet,\n) {\n  if (!('id' in stickerSet)) return false;\n  return stickerSet.id === global.appConfig.defaultEmojiStatusesStickerSetId\n    || stickerSet.id === RESTRICTED_EMOJI_SET_ID;\n}\n\nfunction findDurationEmoji(days: number): string {\n  if (days <= MONTH) {\n    return DURATION_EMOTICON[MONTH];\n  }\n  if (days <= QUARTER_YEAR) {\n    return DURATION_EMOTICON[QUARTER_YEAR];\n  }\n  if (days <= HALF_YEAR + DURATION_DELTA) {\n    return DURATION_EMOTICON[HALF_YEAR];\n  }\n  if (days <= YEAR + DURATION_DELTA) {\n    return DURATION_EMOTICON[YEAR];\n  }\n\n  return DURATION_EMOTICON[TWO_YEARS];\n}\n\nexport function selectGiftStickerForDuration<T extends GlobalState>(global: T, days = 30) {\n  const stickers = global.premiumGifts?.stickers;\n  if (!stickers) return undefined;\n\n  const emoji = findDurationEmoji(days);\n\n  return stickers.find((sticker) => sticker.emoji === emoji) || stickers[0];\n}\n\nexport function selectGiftStickerForStars<T extends GlobalState>(global: T, starCount?: number) {\n  const stickers = global.premiumGifts?.stickers;\n\n  if (!stickers || !starCount) return undefined;\n\n  let emoji;\n  if (starCount <= 1000) {\n    emoji = STAR_EMOTICON[1000];\n  } else if (starCount < 2500) {\n    emoji = STAR_EMOTICON[2500];\n  } else {\n    emoji = STAR_EMOTICON[5000];\n  }\n\n  return stickers.find((sticker) => sticker.emoji === emoji) || stickers[0];\n}\n\nexport function selectGiftStickerForTon<T extends GlobalState>(global: T, amount?: number) {\n  const stickers = global.tonGifts?.stickers;\n  if (!stickers || !amount) return undefined;\n  const convertedAmount = convertCurrencyFromBaseUnit(amount, TON_CURRENCY_CODE);\n\n  let emoji;\n  if (convertedAmount < 10) {\n    emoji = TON_EMOTICON[1];\n  } else if (convertedAmount < 50) {\n    emoji = TON_EMOTICON[10];\n  } else {\n    emoji = TON_EMOTICON[50];\n  }\n\n  return stickers.find((sticker) => sticker.emoji === emoji) || stickers[0];\n}\n\nexport function selectCustomEmoji<T extends GlobalState>(global: T, documentId: string) {\n  return global.customEmojis.byId[documentId];\n}\n","import type { GlobalState } from '../types';\n\nexport function selectSharedState<T extends GlobalState>(\n  global: T,\n) {\n  return global.sharedState;\n}\n\nexport function selectSharedSettings<T extends GlobalState>(\n  global: T,\n) {\n  return selectSharedState(global).settings;\n}\n\nexport function selectAnimationLevel<T extends GlobalState>(\n  global: T,\n) {\n  return selectSharedSettings(global).animationLevel;\n}\n","import type { GlobalState } from '../types';\n\nimport { ACCOUNT_SLOT, getAccountsInfo } from '../../util/multiaccount';\nimport { selectSharedSettings } from './sharedState';\n\nexport function selectNotifySettings<T extends GlobalState>(global: T) {\n  return global.settings.byKey;\n}\n\nexport function selectNotifyDefaults<T extends GlobalState>(global: T) {\n  return global.settings.notifyDefaults;\n}\n\nexport function selectNotifyException<T extends GlobalState>(global: T, chatId: string) {\n  return global.chats.notifyExceptionById?.[chatId];\n}\n\nexport function selectLanguageCode<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).language.replace('-raw', '');\n}\n\nexport function selectCanSetPasscode<T extends GlobalState>(global: T) {\n  // TODO[passcode]: remove this when multiacc passcode is implemented\n  const accounts = getAccountsInfo();\n  return global.auth.rememberMe && !ACCOUNT_SLOT && Object.keys(accounts).length === 1;\n}\n\nexport function selectTranslationLanguage<T extends GlobalState>(global: T) {\n  return global.settings.byKey.translationLanguage || selectLanguageCode(global);\n}\n\nexport function selectNewNoncontactPeersRequirePremium<T extends GlobalState>(global: T) {\n  return global.settings.byKey.shouldNewNonContactPeersRequirePremium;\n}\n\nexport function selectNonContactPeersPaidStars<T extends GlobalState>(global: T) {\n  return global.settings.byKey.nonContactPeersPaidStars;\n}\n\nexport function selectShouldHideReadMarks<T extends GlobalState>(global: T) {\n  return global.settings.byKey.shouldHideReadMarks;\n}\n\nexport function selectSettingsKeys<T extends GlobalState>(global: T) {\n  return global.settings.byKey;\n}\n","import { useCallback, useState } from '../lib/teact/teact';\n\nconst useForceUpdate = () => {\n  const [, setTrigger] = useState<boolean>(false);\n\n  return useCallback(() => {\n    setTrigger((trigger) => !trigger);\n  }, []);\n};\n\nexport default useForceUpdate;\n","import type {\n  ApiLimitTypeForPromo,\n  ApiPremiumSection,\n  ApiReactionEmoji,\n} from './api/types';\nimport type {\n  GiftProfileFilterOptions,\n  ResaleGiftsFilterOptions,\n} from './types';\n\nexport const APP_CODE_NAME = 'A';\nexport const APP_NAME = `AlphaHuman Web`;\n\nexport const PRODUCTION_HOSTNAME = 'telegram.alphahuman.xyz';\nexport const PRODUCTION_URL = 'https://telegram.alphahuman.xyz';\nexport const WEB_VERSION_BASE = 'https://telegram.alphahuman.xyz/'; // Used to redirect to other versions\nexport const BASE_URL = process.env.BASE_URL;\nexport const ACCOUNT_QUERY = 'account';\n\nexport const IS_MOCKED_CLIENT = process.env.APP_MOCKED_CLIENT === '1';\nexport const IS_TEST = process.env.APP_ENV === 'test';\nexport const IS_PERF = process.env.APP_ENV === 'perf';\nexport const IS_BETA = process.env.APP_ENV === 'staging';\n\nexport const PAID_MESSAGES_PURPOSE = 'paid_messages';\n\nexport const DEBUG = process.env.APP_ENV !== 'production';\nexport const DEBUG_MORE = false;\nexport const DEBUG_LOG_FILENAME = 'tt-log.json';\nexport const STRICTERDOM_ENABLED = DEBUG;\nexport const FORCE_FALLBACK_LANG = false;\n\nexport const BETA_CHANGELOG_URL = 'https://telegra.ph/WebA-Beta-03-20';\n\nexport const DEBUG_ALERT_MSG =\n  'Shoot!\\nSomething went wrong, please see the error details in Dev Tools Console.';\nexport const DEBUG_GRAMJS = false;\n\nexport const PAGE_TITLE = process.env.APP_TITLE!;\nexport const PAGE_TITLE_TAURI = 'Telegram Air';\nexport const INACTIVE_MARKER = '[Inactive]';\n\nexport const DEBUG_PAYMENT_SMART_GLOCAL = false;\n\nexport const SESSION_LEGACY_USER_KEY = 'user_auth';\nexport const SESSION_ACCOUNT_PREFIX = 'account';\nexport const LEGACY_PASSCODE_CACHE_NAME = 'tt-passcode';\n\nexport const MULTIACCOUNT_MAX_SLOTS = 6;\nexport const GLOBAL_STATE_CACHE_DISABLED = false;\nexport const GLOBAL_STATE_CACHE_PREFIX = 'tt-global-state';\nexport const SHARED_STATE_CACHE_KEY = 'tt-shared-state';\nexport const GLOBAL_STATE_CACHE_USER_LIST_LIMIT = 500;\nexport const GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT = 200;\nexport const GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT = 10;\nexport const GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT = 150;\n\nexport const IS_SCREEN_LOCKED_CACHE_KEY = 'tt-is-screen-locked';\nexport const HAS_COMPLETED_WELCOME_KEY = 'tt-has-completed-welcome';\n\nexport const MEDIA_CACHE_DISABLED = false;\nexport const MEDIA_CACHE_NAME = 'tt-media';\nexport const MEDIA_CACHE_NAME_AVATARS = 'tt-media-avatars';\nexport const MEDIA_PROGRESSIVE_CACHE_DISABLED = false;\nexport const MEDIA_PROGRESSIVE_CACHE_NAME = 'tt-media-progressive';\nexport const MEDIA_CACHE_MAX_BYTES = 512 * 1024; // 512 KB\nexport const CUSTOM_BG_CACHE_NAME = 'tt-custom-bg';\nexport const LANG_CACHE_NAME = 'tt-lang-packs-v50';\nexport const ASSET_CACHE_NAME = 'tt-assets';\nexport const AUTODOWNLOAD_FILESIZE_MB_LIMITS = [1, 5, 10, 50, 100, 500];\nexport const DATA_BROADCAST_CHANNEL_PREFIX = 'tt-global';\nexport const ESTABLISH_BROADCAST_CHANNEL_PREFIX = 'tt-establish';\nexport const MULTITAB_LOCALSTORAGE_KEY_PREFIX = 'tt-multitab';\nexport const INTERCLIENT_BROADCAST_CHANNEL = 'tgweb';\nexport const DC_IDS = [1, 2, 3, 4, 5] as const;\n\nexport const DOWNLOAD_WORKERS = 16;\nexport const UPLOAD_WORKERS = 16;\n\nconst isBigScreen = typeof window !== 'undefined' && window.innerHeight >= 900;\n\nexport const MIN_PASSWORD_LENGTH = 1;\n\nexport const MESSAGE_LIST_SLICE = isBigScreen ? 60 : 40;\nexport const MESSAGE_LIST_VIEWPORT_LIMIT = MESSAGE_LIST_SLICE * 2;\n\nexport const ARCHIVE_MINIMIZED_HEIGHT = 36;\nexport const CHAT_HEIGHT_PX = 72;\nexport const TOPIC_HEIGHT_PX = 65;\nexport const PEER_PICKER_ITEM_HEIGHT_PX = 56;\nexport const CHAT_LIST_SLICE = isBigScreen ? 30 : 25;\nexport const CHAT_LIST_LOAD_SLICE = 100;\nexport const SHARED_MEDIA_SLICE = 42;\nexport const CHAT_MEDIA_SLICE = 42;\nexport const MESSAGE_SEARCH_SLICE = 42;\nexport const GLOBAL_SEARCH_SLICE = 20;\nexport const GLOBAL_TOPIC_SEARCH_SLICE = 5;\nexport const MEMBERS_SLICE = 30;\nexport const MEMBERS_LOAD_SLICE = 200;\nexport const PROFILE_SENSITIVE_AREA = 500;\nexport const TOPIC_LIST_SENSITIVE_AREA = 600;\n\n// Public Posts Search defaults\nexport const PUBLIC_POSTS_SEARCH_DEFAULT_STARS_AMOUNT = 10;\nexport const PUBLIC_POSTS_SEARCH_DEFAULT_TOTAL_DAILY = 2;\n\n// Suggested Posts defaults\nexport const TON_CURRENCY_CODE = 'TON';\nexport const VERIFY_AGE_MIN_DEFAULT = 18;\n\nexport const STORY_VIEWS_MIN_SEARCH = 15;\nexport const STORY_MIN_REACTIONS_SORT = 10;\nexport const STORY_VIEWS_MIN_CONTACTS_FILTER = 20;\n\nexport const MEDIA_TIMESTAMP_SAVE_MINIMUM_DURATION = 30; // 30s\n\nexport const GLOBAL_SUGGESTED_CHANNELS_ID = 'global';\n\n// As in Telegram for Android\n// https://github.com/DrKLO/Telegram/blob/51e9947527/TMessagesProj/src/main/java/org/telegram/messenger/MediaDataController.java#L7781\nexport const REACTION_UNREAD_SLICE = 100;\nexport const MENTION_UNREAD_SLICE = 100;\nexport const TOPICS_SLICE = 20;\nexport const TOPICS_SLICE_SECOND_LOAD = 500;\n\nexport const TOP_CHAT_MESSAGES_PRELOAD_LIMIT = 20;\n\nexport const SPONSORED_MESSAGE_CACHE_MS = 300000; // 5 min\n\nexport const DEFAULT_CHARGE_FOR_MESSAGES = 250;\nexport const MINIMUM_CHARGE_FOR_MESSAGES = 1;\nexport const DEFAULT_MAXIMUM_CHARGE_FOR_MESSAGES = 10000;\n\nexport const DEFAULT_VOLUME = 1;\nexport const DEFAULT_PLAYBACK_RATE = 1;\nexport const PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION = 20 * 60; // 20 min\n\nexport const ANIMATION_LEVEL_CUSTOM = -1;\nexport const ANIMATION_LEVEL_MIN = 0;\nexport const ANIMATION_LEVEL_MED = 1;\nexport const ANIMATION_LEVEL_MAX = 2;\nexport const ANIMATION_LEVEL_DEFAULT = ANIMATION_LEVEL_MED;\n\nexport const DEFAULT_MESSAGE_TEXT_SIZE_PX = 16;\nexport const IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX = 17;\nexport const MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX = 15;\n\nexport const FOLDERS_POSITION_TOP = 'top';\nexport const FOLDERS_POSITION_LEFT = 'left';\nexport const FOLDERS_POSITION_DEFAULT = FOLDERS_POSITION_TOP;\n\nexport const PREVIEW_AVATAR_COUNT = 3;\n\nexport const DRAFT_DEBOUNCE = 10000; // 10s\nexport const SEND_MESSAGE_ACTION_INTERVAL = 3000; // 3s\n// 10000s from https://corefork.telegram.org/api/url-authorization#automatic-authorization\nexport const APP_CONFIG_REFETCH_INTERVAL = 10000 * 1000;\nexport const GENERAL_REFETCH_INTERVAL = 60 * 60 * 1000; // 1h\n\nexport const EDITABLE_INPUT_ID = 'editable-message-text';\nexport const EDITABLE_INPUT_MODAL_ID = 'editable-message-text-modal';\nexport const EDITABLE_STORY_INPUT_ID = 'editable-story-input-text';\n// eslint-disable-next-line @stylistic/max-len\nexport const EDITABLE_INPUT_CSS_SELECTOR = `.messages-layout .Transition_slide-active #${EDITABLE_INPUT_ID}, .messages-layout .Transition > .Transition_slide-to #${EDITABLE_INPUT_ID}`;\nexport const EDITABLE_INPUT_MODAL_CSS_SELECTOR = `#${EDITABLE_INPUT_MODAL_ID}`;\nexport const EDITABLE_STORY_INPUT_CSS_SELECTOR = `#${EDITABLE_STORY_INPUT_ID}`;\n\nexport const CUSTOM_APPENDIX_ATTRIBUTE = 'data-has-custom-appendix';\nexport const MESSAGE_CONTENT_CLASS_NAME = 'message-content';\nexport const MESSAGE_CONTENT_SELECTOR = '.message-content';\nexport const VT_CLASS_NAME = 'active-view-transition';\nexport const VT_TYPE_CLASS_PREFIX = 'active-vt-';\n\nexport const RESIZE_HANDLE_CLASS_NAME = 'resizeHandle';\nexport const RESIZE_HANDLE_SELECTOR = `.${RESIZE_HANDLE_CLASS_NAME}`;\n\nexport const SNAP_EFFECT_CONTAINER_ID = 'snap-effect-container';\nexport const SNAP_EFFECT_ID = 'snap-effect';\n\nexport const STARS_ICON_PLACEHOLDER = '';\nexport const STARS_CURRENCY_CODE = 'XTR';\n\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN = 1275; // px\nexport const MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN = 925; // px\nexport const MOBILE_SCREEN_MAX_WIDTH = 600; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH = 950; // px\nexport const MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT = 450; // px\n\nexport const MAX_INT_32 = 2 ** 31 - 1;\nexport const TMP_CHAT_ID = '0';\n\nexport const MUTE_INDEFINITE_TIMESTAMP = MAX_INT_32;\nexport const UNMUTE_TIMESTAMP = 0;\n\nexport const ANIMATION_END_DELAY = 100;\nexport const ANIMATION_WAVE_MIN_INTERVAL = 200;\nexport const MESSAGE_APPEARANCE_DELAY = 10;\nexport const PAID_SEND_DELAY = 5000;\n\nexport const SCROLL_MIN_DURATION = 300;\nexport const SCROLL_MAX_DURATION = 600;\nexport const SCROLL_MAX_DISTANCE = 800;\nexport const SCROLL_SHORT_TRANSITION_MAX_DISTANCE = 300; // px\n\n// Average duration of message sending animation\nexport const API_UPDATE_THROTTLE = Math.round(\n  (SCROLL_MIN_DURATION + SCROLL_MAX_DURATION) / 2,\n);\nexport const API_THROTTLE_RESET_UPDATES = new Set([\n  'newMessage',\n  'newScheduledMessage',\n  'deleteMessages',\n  'deleteScheduledMessages',\n  'deleteHistory',\n  'deleteParticipantHistory',\n]);\n\nexport const LOCK_SCREEN_ANIMATION_DURATION_MS = 200;\n\nexport const STICKER_SIZE_INLINE_DESKTOP_FACTOR = 13;\nexport const STICKER_SIZE_INLINE_MOBILE_FACTOR = 11;\nexport const STICKER_SIZE_AUTH = 160;\nexport const STICKER_SIZE_AUTH_MOBILE = 120;\nexport const STICKER_SIZE_PICKER = 72;\nexport const EMOJI_SIZE_PICKER = 36;\nexport const COMPOSER_EMOJI_SIZE_PICKER = 32;\nexport const STICKER_SIZE_GENERAL_SETTINGS = 40;\nexport const STICKER_SIZE_PICKER_HEADER = 32;\nexport const STICKER_PICKER_MAX_SHARED_COVERS = 20;\nexport const STICKER_SIZE_SEARCH = 72;\nexport const STICKER_SIZE_MODAL = 72;\nexport const EMOJI_SIZE_MODAL = 36;\nexport const STICKER_SIZE_TWO_FA = 160;\nexport const STICKER_SIZE_PASSCODE = 160;\nexport const STICKER_SIZE_DISCUSSION_GROUPS = 140;\nexport const STICKER_SIZE_FOLDER_SETTINGS = 100;\nexport const STICKER_SIZE_INLINE_BOT_RESULT = 100;\nexport const STICKER_SIZE_JOIN_REQUESTS = 140;\nexport const STICKER_SIZE_INVITES = 140;\nexport const RECENT_STICKERS_LIMIT = 20;\nexport const RECENT_STATUS_LIMIT = 20;\nexport const EMOJI_STATUS_LOOP_LIMIT = 2;\nexport const EMOJI_SIZES = 7;\nexport const TOP_SYMBOL_SET_ID = 'top';\nexport const POPULAR_SYMBOL_SET_ID = 'popular';\nexport const RECENT_SYMBOL_SET_ID = 'recent';\nexport const COLLECTIBLE_STATUS_SET_ID = 'collectibleStatus';\nexport const FAVORITE_SYMBOL_SET_ID = 'favorite';\nexport const EFFECT_STICKERS_SET_ID = 'effectStickers';\nexport const EFFECT_EMOJIS_SET_ID = 'effectEmojis';\nexport const CHAT_STICKER_SET_ID = 'chatStickers';\nexport const DEFAULT_TOPIC_ICON_STICKER_ID = 'topic-default-icon';\nexport const DEFAULT_STATUS_ICON_ID = 'status-default-icon';\nexport const EMOJI_IMG_REGEX =\n  /<img[^>]+alt=\"([^\"]+)\"(?![^>]*data-document-id)[^>]*>/gm;\n\nexport const BASE_EMOJI_KEYWORD_LANG = 'en';\n\nexport const MENU_TRANSITION_DURATION = 200;\nexport const SLIDE_TRANSITION_DURATION = 450;\n\nexport const BIRTHDAY_NUMBERS_SET = 'FestiveFontEmoji';\nexport const RESTRICTED_EMOJI_SET = 'RestrictedEmoji';\n\nexport const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\nexport const SVG_EXTENSIONS = new Set(['svg', 'svgz']);\n\nexport const VIDEO_WEBM_TYPE = 'video/webm';\nexport const GIF_MIME_TYPE = 'image/gif';\n\nexport const LOTTIE_STICKER_MIME_TYPE = 'application/x-tgsticker';\nexport const VIDEO_STICKER_MIME_TYPE = VIDEO_WEBM_TYPE;\n\nexport const SUPPORTED_PHOTO_CONTENT_TYPES = new Set([\n  'image/png',\n  'image/jpeg',\n  GIF_MIME_TYPE,\n]);\n\nexport const SUPPORTED_VIDEO_CONTENT_TYPES = new Set([\n  'video/mp4',\n  'video/quicktime',\n]);\n\nexport const SUPPORTED_AUDIO_CONTENT_TYPES = new Set([\n  'audio/mp3',\n  'audio/ogg',\n  'audio/wav',\n  'audio/mpeg',\n  'audio/flac',\n  'audio/aac',\n  'audio/m4a',\n  'audio/mp4',\n  'audio/x-m4a',\n]);\n\nexport const CONTENT_TYPES_WITH_PREVIEW = new Set([\n  ...SUPPORTED_PHOTO_CONTENT_TYPES,\n  ...SUPPORTED_VIDEO_CONTENT_TYPES,\n]);\n\n// Taken from https://github.com/telegramdesktop/tdesktop/blob/41d9a9fcbd0c809c60ddbd9350791b1436aff7d9/Telegram/SourceFiles/ui/boxes/choose_language_box.cpp#L28\nexport const SUPPORTED_TRANSLATION_LANGUAGES = [\n  // Official\n  'en',\n  'ar',\n  'be',\n  'ca',\n  'zh',\n  'nl',\n  'fr',\n  'de',\n  'id',\n  'it',\n  'ja',\n  'ko',\n  'pl',\n  'pt',\n  'ru',\n  'es',\n  'uk',\n  // Unofficial\n  'af',\n  'sq',\n  'am',\n  'hy',\n  'az',\n  'eu',\n  'bn',\n  'bs',\n  'bg',\n  'ceb',\n  'zh-CN',\n  'zh-TW',\n  'co',\n  'hr',\n  'cs',\n  'da',\n  'eo',\n  'et',\n  'fi',\n  'fy',\n  'gl',\n  'ka',\n  'el',\n  'gu',\n  'ht',\n  'ha',\n  'haw',\n  'he',\n  'iw',\n  'hi',\n  'hmn',\n  'hu',\n  'is',\n  'ig',\n  'ga',\n  'jv',\n  'kn',\n  'kk',\n  'km',\n  'rw',\n  'ku',\n  'ky',\n  'lo',\n  'la',\n  'lv',\n  'lt',\n  'lb',\n  'mk',\n  'mg',\n  'ms',\n  'ml',\n  'mt',\n  'mi',\n  'mr',\n  'mn',\n  'my',\n  'ne',\n  'no',\n  'ny',\n  'or',\n  'ps',\n  'fa',\n  'pa',\n  'ro',\n  'sm',\n  'gd',\n  'sr',\n  'st',\n  'sn',\n  'sd',\n  'si',\n  'sk',\n  'sl',\n  'so',\n  'su',\n  'sw',\n  'sv',\n  'tl',\n  'tg',\n  'ta',\n  'tt',\n  'te',\n  'th',\n  'tr',\n  'tk',\n  'ur',\n  'ug',\n  'uz',\n  'vi',\n  'cy',\n  'xh',\n  'yi',\n  'yo',\n  'zu',\n];\n\nexport const RE_LINK_TEMPLATE =\n  '((ftp|https?):\\\\/\\\\/)?((www\\\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\\\.[a-zA-Z]' +\n  '[-a-zA-Z0-9]{1,62})\\\\b([-a-zA-Z0-9()@:%_+.,~#?&/=]*)';\nexport const RE_MENTION_TEMPLATE = '(@[\\\\w\\\\d_-]+)';\nexport const RE_TG_LINK = /^tg:(\\/\\/)?/i;\nexport const RE_TME_LINK =\n  /^(https?:\\/\\/)?([-a-zA-Z0-9@:%_+~#=]{1,32}\\.)?t\\.me/i;\nexport const RE_TELEGRAM_LINK = /^(https?:\\/\\/)?telegram\\.org\\//i;\nexport const TME_LINK_PREFIX = 'https://t.me/';\nexport const BOT_FATHER_USERNAME = 'botfather';\nexport const USERNAME_PURCHASE_ERROR = 'USERNAME_PURCHASE_AVAILABLE';\nexport const MESSAGE_ID_REQUIRED_ERROR = 'MESSAGE_ID_REQUIRED';\nexport const PURCHASE_USERNAME = 'auction';\nexport const ACCEPTABLE_USERNAME_ERRORS = new Set([\n  USERNAME_PURCHASE_ERROR,\n  'USERNAME_INVALID',\n]);\nexport const TME_WEB_DOMAINS = new Set([\n  't.me',\n  'web.t.me',\n  'a.t.me',\n  'k.t.me',\n  'z.t.me',\n]);\nexport const WEB_APP_PLATFORM = 'weba';\nexport const LANG_PACK = 'weba';\n\nexport const NSFW_RESTRICTION_REASON = 'sensitive';\n\nexport const COUNTRIES_WITH_12H_TIME_FORMAT = new Set([\n  'AU',\n  'BD',\n  'CA',\n  'CO',\n  'EG',\n  'HN',\n  'IE',\n  'IN',\n  'JO',\n  'MX',\n  'MY',\n  'NI',\n  'NZ',\n  'PH',\n  'PK',\n  'SA',\n  'SV',\n  'US',\n]);\n\nexport const API_CHAT_TYPES = [\n  'bots',\n  'channels',\n  'chats',\n  'users',\n  'groups',\n] as const;\n\nexport const HEART_REACTION: ApiReactionEmoji = {\n  type: 'emoji',\n  emoticon: '',\n};\n\n// MTProto constants\nexport const SERVICE_NOTIFICATIONS_USER_ID = '777000';\nexport const REPLIES_USER_ID = '1271266957'; // TODO For Test connection ID must be equal to 708513\nexport const VERIFICATION_CODES_USER_ID = '489000';\nexport const ANONYMOUS_USER_ID = '2666000';\nexport const RESTRICTED_EMOJI_SET_ID = '7173162320003080';\nexport const LOCAL_MESSAGES_LIMIT = 1e6; // 1M\nexport const CHANNEL_ID_BASE = 10n ** 12n;\nexport const DEFAULT_GIF_SEARCH_BOT_USERNAME = 'gif';\nexport const ALL_FOLDER_ID = 0;\nexport const ARCHIVED_FOLDER_ID = 1;\nexport const SAVED_FOLDER_ID = -1;\nexport const FOLDER_TITLE_MAX_LENGTH = 12;\nexport const DELETED_COMMENTS_CHANNEL_ID = (-CHANNEL_ID_BASE - 777n).toString();\nexport const MAX_MEDIA_FILES_FOR_ALBUM = 10;\nexport const MAX_ACTIVE_PINNED_CHATS = 5;\nexport const SCHEDULED_WHEN_ONLINE = 0x7ffffffe;\nexport const LANG_PACKS = ['android', 'ios', 'tdesktop', 'macos'] as const;\nexport const FEEDBACK_URL = 'https://alphahuman.canny.io/';\nexport const FAQ_URL = 'https://telegram.org/faq';\nexport const PRIVACY_URL = 'https://telegram.org/privacy';\nexport const MINI_APP_TOS_URL = 'https://telegram.org/tos/mini-apps';\nexport const FRAGMENT_ADS_URL = 'https://fragment.com/ads';\nexport const GENERAL_TOPIC_ID = 1;\nexport const FRESH_AUTH_PERIOD = 86400; // 1 day\nexport const GIVEAWAY_BOOST_PER_PREMIUM = 4;\nexport const GIVEAWAY_MAX_ADDITIONAL_CHANNELS = 10;\nexport const GIVEAWAY_MAX_ADDITIONAL_USERS = 10;\nexport const GIVEAWAY_MAX_ADDITIONAL_COUNTRIES = 10;\nexport const FRAGMENT_PHONE_CODE = '888';\nexport const FRAGMENT_PHONE_LENGTH = 11;\nexport const BOT_VERIFICATION_PEERS_LIMIT = 20;\n\nexport const LIGHT_THEME_BG_COLOR = '#99BA92';\nexport const DARK_THEME_BG_COLOR = '#0F0F0F';\nexport const DEFAULT_PATTERN_COLOR = '#4A8E3A8C';\nexport const DARK_THEME_PATTERN_COLOR = '#48576166';\nexport const PEER_COLOR_BG_OPACITY = '1a';\nexport const PEER_COLOR_BG_ACTIVE_OPACITY = '2b';\nexport const PEER_COLOR_GRADIENT_STEP = 5; // px\nexport const MAX_UPLOAD_FILEPART_SIZE = 524288;\n\nexport const IGNORE_UNHANDLED_ERRORS = new Set(['USER_CANCELED']);\n\n// Group calls\nexport const GROUP_CALL_VOLUME_MULTIPLIER = 100;\nexport const GROUP_CALL_DEFAULT_VOLUME = 100 * GROUP_CALL_VOLUME_MULTIPLIER;\n\nexport const ONE_TIME_MEDIA_TTL_SECONDS = 2147483647;\n\n// Premium\nexport const PREMIUM_FEATURE_SECTIONS = [\n  'stories',\n  'double_limits',\n  'more_upload',\n  'faster_download',\n  'voice_to_text',\n  'no_ads',\n  'infinite_reactions',\n  'premium_stickers',\n  'animated_emoji',\n  'advanced_chat_management',\n  'profile_badge',\n  'animated_userpics',\n  'emoji_status',\n  'translations',\n  'saved_tags',\n  'last_seen',\n  'message_privacy',\n  'effects',\n  'todo',\n] as const;\n\nexport const PREMIUM_BOTTOM_VIDEOS: ApiPremiumSection[] = [\n  'faster_download',\n  'voice_to_text',\n  'advanced_chat_management',\n  'infinite_reactions',\n  'profile_badge',\n  'animated_userpics',\n  'emoji_status',\n  'translations',\n  'saved_tags',\n  'last_seen',\n  'message_privacy',\n  'effects',\n  'todo',\n];\n\nexport const PREMIUM_LIMITS_ORDER: ApiLimitTypeForPromo[] = [\n  'channels',\n  'dialogFolderPinned',\n  'channelsPublic',\n  'savedGifs',\n  'stickersFaved',\n  'aboutLength',\n  'captionLength',\n  'dialogFilters',\n  'dialogFiltersChats',\n  'moreAccounts',\n  'recommendedChannels',\n];\n\nexport const DEFAULT_GIFT_PROFILE_FILTER_OPTIONS: GiftProfileFilterOptions = {\n  sortType: 'byDate',\n  shouldIncludeUnlimited: true,\n  shouldIncludeLimited: true,\n  shouldIncludeUnique: true,\n  shouldIncludeDisplayed: true,\n  shouldIncludeHidden: true,\n  shouldIncludeUpgradable: true,\n} as const;\n\nexport const DEFAULT_RESALE_GIFTS_FILTER_OPTIONS: ResaleGiftsFilterOptions = {\n  sortType: 'byDate',\n};\n\nexport const ACCOUNT_TTL_OPTIONS = [1, 3, 6, 12, 18, 24];\n\nexport const BACKEND_API_URL = process.env.BACKEND_API_URL || 'https://staging-api.alphahuman.xyz';\nexport const ALPHAHUMAN_BOT_USERNAME = process.env.ALPHAHUMAN_BOT_USERNAME || '';\nexport const ALPHAHUMAN_BOT_ID = process.env.ALPHAHUMAN_BOT_ID || '';\n","import { useEffect } from '../../lib/teact/teact';\n\nimport useLastCallback from '../useLastCallback';\n\nfunction useInterval(callback: NoneToVoidFunction, delay?: number, noFirst = false) {\n  const savedCallback = useLastCallback(callback);\n\n  useEffect(() => {\n    if (delay === undefined) {\n      return undefined;\n    }\n\n    const id = setInterval(() => savedCallback(), delay);\n    if (!noFirst) savedCallback();\n\n    return () => clearInterval(id);\n  }, [delay, noFirst]);\n}\n\nexport default useInterval;\n","import type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\n\nexport function updateTabState<T extends GlobalState>(\n  global: T,\n  tabStatePartial: Partial<TabState>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return {\n    ...global,\n    byTabId: {\n      ...global.byTabId,\n      [tabId]: {\n        ...global.byTabId[tabId],\n        ...tabStatePartial,\n      },\n    },\n  };\n}\n","import { getActions } from '../global';\n\nimport type { CallbackAction } from '../global/types';\n\nconst callbacks = new Map<string, number>();\n\n// TODO Pass callbacks to the master tab. Sync them on master change\nexport default function requestActionTimeout(action: CallbackAction, timeout: number) {\n  const name = action.action;\n  clearTimeout(callbacks.get(name));\n  const timerId = window.setTimeout(() => {\n    // @ts-expect-error -- No idea how to properly type this\n    getActions()[name](action.payload);\n  }, timeout);\n  callbacks.set(name, timerId);\n}\n","import type { DiffObject } from './deepDiff';\n\nimport { isLiteralObject, unique } from './iteratees';\n\nexport function deepMerge<T extends object>(value1: T, value2: DiffObject<T>): T {\n  if (value1 === value2) {\n    return value2 as unknown as T;\n  }\n\n  if (!isLiteralObject(value2)) {\n    return value2;\n  }\n\n  if (!isLiteralObject(value1)) {\n    return reduceDiff(value2) as T;\n  }\n\n  if ('__deleteAllChildren' in value2) {\n    return {} as T;\n  }\n\n  const allKeys = unique(Object.keys(value1).concat(Object.keys(value2)));\n\n  return allKeys.reduce((acc: AnyLiteral, key) => {\n    const oldValue = (value1 as AnyLiteral)[key];\n\n    if (!value2.hasOwnProperty(key)) {\n      acc[key] = oldValue;\n    } else {\n      const newValue = value2[key];\n\n      if (!newValue?.__delete) {\n        acc[key] = deepMerge(oldValue, newValue);\n      }\n    }\n\n    return acc;\n  }, {}) as T;\n}\n\nfunction reduceDiff(diff: AnyLiteral) {\n  if (diff.__deleteAllChildren) {\n    return {};\n  }\n\n  return Object.entries(diff).reduce((acc: AnyLiteral, [key, value]) => {\n    if (!value?.__delete) {\n      acc[key] = isLiteralObject(value) ? reduceDiff(value) : value;\n    }\n\n    return acc;\n  }, {});\n}\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useLayoutEffect, useRef, useSignal } from '../lib/teact/teact';\nimport { addExtraClass, toggleExtraClass } from '../lib/teact/teact-dom';\n\nimport type { Signal } from '../util/signals';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport useDerivedSignal from './useDerivedSignal';\nimport useDerivedState from './useDerivedState';\nimport useLastCallback from './useLastCallback';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\nimport useSyncEffectWithPrevDeps from './useSyncEffectWithPrevDeps';\n\nconst CLOSE_DURATION = 350;\n\ntype BaseHookParams<RefType extends HTMLElement> = {\n  isOpen: boolean | undefined;\n  ref?: ElementRef<RefType>;\n  noMountTransition?: boolean;\n  noOpenTransition?: boolean;\n  noCloseTransition?: boolean;\n  closeDuration?: number;\n  className?: string | false;\n  prefix?: string;\n  shouldForceOpen?: boolean;\n  onCloseAnimationEnd?: NoneToVoidFunction;\n};\n\nexport type HookParams<RefType extends HTMLElement> = BaseHookParams<RefType> & {\n  withShouldRender?: never;\n};\n\nexport type HookParamsWithShouldRender<RefType extends HTMLElement> = BaseHookParams<RefType> & {\n  withShouldRender: true;\n};\n\nexport type HookResult<RefType extends HTMLElement> = {\n  ref: ElementRef<RefType>;\n  getIsClosing: Signal<boolean>;\n};\n\nexport type HookResultWithShouldRender<RefType extends HTMLElement> = HookResult<RefType> & {\n  shouldRender: boolean;\n};\n\ntype State =\n  'closed'\n  | 'scheduled-open'\n  | 'open'\n  | 'closing';\n\n/**\n * Use for showing and hiding small elements with transitions. For large elements, use {@link useMediaTransition}.\n */\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParams<RefType>,\n): HookResult<RefType>;\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParamsWithShouldRender<RefType>,\n): HookResultWithShouldRender<RefType>;\nexport default function useShowTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParams<RefType> | HookParamsWithShouldRender<RefType>,\n): HookResult<RefType> | HookResultWithShouldRender<RefType> {\n  const {\n    isOpen,\n    noMountTransition = false,\n    noOpenTransition = false,\n    noCloseTransition = false,\n    closeDuration = CLOSE_DURATION,\n    className = 'fast',\n    prefix = '',\n    shouldForceOpen,\n    onCloseAnimationEnd,\n  } = params;\n\n  const localRef = useRef<RefType>();\n  const ref = params.ref || localRef;\n  const closingTimeoutRef = useRef<number>();\n  const [getState, setState] = useSignal<State | undefined>();\n  const optionsRef = useStateRef({\n    closeDuration, noMountTransition, noOpenTransition, noCloseTransition,\n  });\n  const onCloseEndLast = useLastCallback(onCloseAnimationEnd);\n\n  useSyncEffectWithPrevDeps(([prevIsOpen]) => {\n    const options = optionsRef.current;\n\n    if (shouldForceOpen) {\n      setState('open');\n      return;\n    }\n\n    if (isOpen) {\n      if (closingTimeoutRef.current) {\n        clearTimeout(closingTimeoutRef.current);\n        closingTimeoutRef.current = undefined;\n      }\n\n      if (options.noOpenTransition || (prevIsOpen === undefined && options.noMountTransition)) {\n        setState('open');\n      } else {\n        setState('scheduled-open');\n        requestMeasure(() => {\n          setState('open');\n        });\n      }\n    } else if (prevIsOpen === undefined || options.noCloseTransition) {\n      setState('closed');\n    } else {\n      setState('closing');\n\n      closingTimeoutRef.current = window.setTimeout(() => {\n        setState('closed');\n        onCloseEndLast();\n      }, options.closeDuration);\n    }\n  }, [isOpen, shouldForceOpen]);\n\n  const applyClassNames = useLastCallback(() => {\n    const element = ref.current;\n    if (!element) return;\n\n    if (className !== false) {\n      addExtraClass(element, 'opacity-transition');\n      addExtraClass(element, className);\n    }\n\n    const state = getState();\n    const shouldRender = state !== 'closed';\n    const hasOpenClass = state === 'open';\n    const isClosing = state === 'closing';\n\n    toggleExtraClass(element, `${prefix}shown`, shouldRender);\n    toggleExtraClass(element, `${prefix}not-shown`, !shouldRender);\n    toggleExtraClass(element, `${prefix}open`, hasOpenClass);\n    toggleExtraClass(element, `${prefix}not-open`, !hasOpenClass);\n    toggleExtraClass(element, `${prefix}closing`, isClosing);\n  });\n\n  // Workaround for Chrome causing forced reflow in the middle of mutation phase when unmounting a focused element.\n  // Due to such forced reflow setting initial class names in the first layout effect causes transitions to start.\n  useSyncEffect(() => {\n    ref.onChange = () => {\n      ref.onChange = undefined;\n      applyClassNames();\n    };\n  }, [applyClassNames, ref]);\n\n  useLayoutEffect(applyClassNames, [applyClassNames, getState]);\n\n  const withShouldRender = 'withShouldRender' in params && params.withShouldRender;\n  const shouldRender = useDerivedState(\n    () => (withShouldRender && getState() !== 'closed'),\n    [withShouldRender, getState],\n  );\n\n  const getIsClosing = useDerivedSignal(() => getState() === 'closing', [getState]);\n\n  if (withShouldRender) {\n    return { ref, shouldRender, getIsClosing };\n  }\n\n  return { ref, getIsClosing };\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nconst startCallbacks = createCallbackManager();\nconst endCallbacks = createCallbackManager();\n\nlet timeout: number | undefined;\nlet isActive = false;\n\nconst usePriorityPlaybackCheck = (\n  onStart?: AnyToVoidFunction,\n  onEnd?: AnyToVoidFunction,\n  isDisabled = false,\n) => {\n  const lastOnStart = useLastCallback(onStart);\n  const lastOnEnd = useLastCallback(onEnd);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (isActive) {\n      lastOnStart();\n    }\n\n    startCallbacks.addCallback(lastOnStart);\n    endCallbacks.addCallback(lastOnEnd);\n\n    return () => {\n      endCallbacks.removeCallback(lastOnEnd);\n      startCallbacks.removeCallback(lastOnStart);\n    };\n  }, [isDisabled, lastOnStart, lastOnEnd]);\n};\n\nexport function isPriorityPlaybackActive() {\n  return isActive;\n}\n\nexport function dispatchPriorityPlaybackEvent() {\n  if (!isActive) {\n    isActive = true;\n    startCallbacks.runCallbacks();\n  }\n\n  if (timeout) {\n    clearTimeout(timeout);\n    timeout = undefined;\n  }\n\n  // Race condition may happen if another `dispatchPriorityPlaybackEvent` is called before `onEnd`\n  function onEnd() {\n    if (timeout) {\n      clearTimeout(timeout);\n      timeout = undefined;\n    }\n\n    isActive = false;\n    endCallbacks.runCallbacks();\n  }\n\n  return onEnd;\n}\n\nexport default usePriorityPlaybackCheck;\n","import type { ApiSavedStarGift } from '../../api/types';\n\nexport function getSavedGiftKey(gift: ApiSavedStarGift, withoutTag?: boolean) {\n  return [\n    gift.date,\n    gift.fromId,\n    gift.gift.id,\n    gift.gift.type === 'starGiftUnique' ? gift.gift.number : undefined,\n    !withoutTag ? gift.localTag : undefined,\n  ].filter(Boolean).join('-');\n}\n","import { useRef, useUnmountCleanup } from '../lib/teact/teact';\n\nimport usePreviousDeprecated from './usePreviousDeprecated';\n\nexport default function useSyncEffect<const T extends readonly any[]>(\n  effect: (args: T | readonly []) => NoneToVoidFunction | void,\n  dependencies: T,\n) {\n  const prevDeps = usePreviousDeprecated<T>(dependencies);\n  const cleanupRef = useRef<NoneToVoidFunction>();\n\n  if (!prevDeps || dependencies.some((d, i) => d !== prevDeps[i])) {\n    cleanupRef.current?.();\n    cleanupRef.current = effect(prevDeps || []) ?? undefined;\n  }\n\n  useUnmountCleanup(() => {\n    cleanupRef.current?.();\n  });\n}\n","// We cache avatars as Data URI for faster initial load\n// and messages media as Blob for smaller size.\n\nexport enum ApiMediaFormat {\n  BlobUrl,\n  Progressive,\n  DownloadUrl,\n  Text,\n}\n\nexport type ApiParsedMedia = string | Blob | ArrayBuffer;\nexport type ApiPreparedMedia = string;\n","import QrPlane from '../../../assets/tgs/auth/QrPlane.tgs';\nimport BannedDuck from '../../../assets/tgs/BannedDuck.tgs';\nimport CameraFlip from '../../../assets/tgs/calls/CameraFlip.tgs';\nimport HandFilled from '../../../assets/tgs/calls/HandFilled.tgs';\nimport HandOutline from '../../../assets/tgs/calls/HandOutline.tgs';\nimport Speaker from '../../../assets/tgs/calls/Speaker.tgs';\nimport VoiceAllowTalk from '../../../assets/tgs/calls/VoiceAllowTalk.tgs';\nimport VoiceMini from '../../../assets/tgs/calls/VoiceMini.tgs';\nimport VoiceMuted from '../../../assets/tgs/calls/VoiceMuted.tgs';\nimport VoiceOutlined from '../../../assets/tgs/calls/VoiceOutlined.tgs';\nimport Diamond from '../../../assets/tgs/Diamond.tgs';\nimport DuckNothingFound from '../../../assets/tgs/DuckNothingFound.tgs';\nimport Flame from '../../../assets/tgs/general/Flame.tgs';\nimport Fragment from '../../../assets/tgs/general/Fragment.tgs';\nimport Mention from '../../../assets/tgs/general/Mention.tgs';\nimport PartyPopper from '../../../assets/tgs/general/PartyPopper.tgs';\nimport Invite from '../../../assets/tgs/invites/Invite.tgs';\nimport JoinRequest from '../../../assets/tgs/invites/Requests.tgs';\nimport LastSeen from '../../../assets/tgs/LastSeen.tgs';\nimport MonkeyClose from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyClose.tgs';\nimport MonkeyIdle from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyIdle.tgs';\nimport MonkeyPeek from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyPeek.tgs';\nimport MonkeyTracking from '../../../assets/tgs/monkeys/TwoFactorSetupMonkeyTracking.tgs';\nimport ReadTime from '../../../assets/tgs/ReadTime.tgs';\nimport Report from '../../../assets/tgs/Report.tgs';\nimport Search from '../../../assets/tgs/Search.tgs';\nimport SearchingDuck from '../../../assets/tgs/SearchingDuck.tgs';\nimport Congratulations from '../../../assets/tgs/settings/Congratulations.tgs';\nimport DiscussionGroups from '../../../assets/tgs/settings/DiscussionGroupsDucks.tgs';\nimport DuckCake from '../../../assets/tgs/settings/DuckCake.tgs';\nimport Experimental from '../../../assets/tgs/settings/Experimental.tgs';\nimport FoldersAll from '../../../assets/tgs/settings/FoldersAll.tgs';\nimport FoldersNew from '../../../assets/tgs/settings/FoldersNew.tgs';\nimport FoldersShare from '../../../assets/tgs/settings/FoldersShare.tgs';\nimport Lock from '../../../assets/tgs/settings/Lock.tgs';\nimport Passkeys from '../../../assets/tgs/settings/Passkeys.tgs';\nimport StarReaction from '../../../assets/tgs/stars/StarReaction.tgs';\nimport StarReactionEffect from '../../../assets/tgs/stars/StarReactionEffect.tgs';\nimport Unlock from '../../../assets/tgs/Unlock.tgs';\nimport DuckNothingFoundPreview from '../../../assets/tgs-previews/DuckNothingFound.svg';\nimport SearchPreview from '../../../assets/tgs-previews/Search.svg';\nimport PasskeysPreview from '../../../assets/tgs-previews/settings/Passkeys.svg';\n\nexport const LOCAL_TGS_PREVIEW_URLS = {\n  DuckNothingFound: DuckNothingFoundPreview,\n  Search: SearchPreview,\n  Passkeys: PasskeysPreview,\n};\n\nexport const LOCAL_TGS_URLS = {\n  MonkeyIdle,\n  MonkeyTracking,\n  MonkeyClose,\n  MonkeyPeek,\n  FoldersAll,\n  FoldersNew,\n  FoldersShare,\n  DiscussionGroups,\n  Lock,\n  CameraFlip,\n  HandFilled,\n  HandOutline,\n  Speaker,\n  VoiceAllowTalk,\n  VoiceMini,\n  VoiceMuted,\n  VoiceOutlined,\n  JoinRequest,\n  Invite,\n  QrPlane,\n  Congratulations,\n  Experimental,\n  PartyPopper,\n  Flame,\n  ReadTime,\n  Unlock,\n  LastSeen,\n  Mention,\n  Fragment,\n  StarReactionEffect,\n  StarReaction,\n  HealthyStar: StarReaction,\n  Report,\n  SearchingDuck,\n  BannedDuck,\n  Diamond,\n  Search,\n  DuckNothingFound,\n  Passkeys,\n  DuckCake,\n};\n","import { useEffect } from '../../lib/teact/teact';\n\nimport { SVG_NAMESPACE } from '../../config';\nimport { hex2rgbaObj } from '../../util/colors.ts';\nimport { addSvgDefinition, removeSvgDefinition } from '../../util/svgController';\n\nconst SVG_MAP = new Map<string, SvgColorFilter>();\n\nclass SvgColorFilter {\n  public filterId: string;\n\n  private referenceCount = 0;\n\n  constructor(public color: string) {\n    this.filterId = `color-filter-${color.slice(1)}`;\n\n    const rgbColor = hex2rgbaObj(color);\n    addSvgDefinition(\n      <filter color-interpolation-filters=\"sRGB\" xmlns={SVG_NAMESPACE}>\n        <feColorMatrix\n          type=\"matrix\"\n          values={`0 0 0 0 ${rgbColor.r / 255} 0 0 0 0 ${rgbColor.g / 255} 0 0 0 0 ${rgbColor.b / 255} 0 0 0 1 0`}\n        />\n      </filter>,\n      this.filterId,\n    );\n  }\n\n  public getFilterId() {\n    this.referenceCount += 1;\n    return this.filterId;\n  }\n\n  public removeReference() {\n    this.referenceCount -= 1;\n    if (this.referenceCount === 0) {\n      removeSvgDefinition(this.filterId);\n    }\n  }\n\n  public isUsed() {\n    return this.referenceCount > 0;\n  }\n}\n\nexport default function useColorFilter(color?: string, asValue?: boolean) {\n  useEffect(() => {\n    if (!color) return undefined;\n\n    return () => {\n      const colorFilter = SVG_MAP.get(color);\n      if (colorFilter) {\n        colorFilter.removeReference();\n        if (!colorFilter.isUsed()) {\n          SVG_MAP.delete(colorFilter.color);\n        }\n      }\n    };\n  }, [color]);\n\n  if (!color) return undefined;\n\n  if (SVG_MAP.has(color)) {\n    const svg = SVG_MAP.get(color)!;\n    return prepareStyle(svg.getFilterId(), asValue);\n  }\n\n  const svg = new SvgColorFilter(color);\n  SVG_MAP.set(color, svg);\n\n  return prepareStyle(svg.getFilterId(), asValue);\n}\n\nfunction prepareStyle(filterId: string, asValue?: boolean) {\n  if (asValue) {\n    return `url(#${filterId})`;\n  }\n\n  return `filter: url(#${filterId});`;\n}\n","import { useCallback, useState } from '../lib/teact/teact';\n\nconst useFlag = (initial = false, debugKey?: string): [boolean, NoneToVoidFunction, NoneToVoidFunction] => {\n  const [value, setValue] = useState(initial, debugKey);\n\n  const setTrue = useCallback(() => {\n    setValue(true);\n  }, []);\n\n  const setFalse = useCallback(() => {\n    setValue(false);\n  }, []);\n\n  return [value, setTrue, setFalse];\n};\n\nexport default useFlag;\n","export type Scheduler = typeof requestAnimationFrame | typeof onTickEnd;\n\nexport function debounce<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n  shouldRunLast = true,\n) {\n  let waitingTimeout: number | undefined;\n\n  return (...args: Parameters<F>) => {\n    if (waitingTimeout) {\n      clearTimeout(waitingTimeout);\n      waitingTimeout = undefined;\n    } else if (shouldRunFirst) {\n      fn(...args);\n    }\n\n    waitingTimeout = self.setTimeout(() => {\n      if (shouldRunLast) {\n        fn(...args);\n      }\n\n      waitingTimeout = undefined;\n    }, ms);\n  };\n}\n\nexport function throttle<F extends AnyToVoidFunction>(\n  fn: F,\n  ms: number,\n  shouldRunFirst = true,\n) {\n  let interval: number | undefined;\n  let isPending: boolean;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    isPending = true;\n    args = _args;\n\n    if (!interval) {\n      if (shouldRunFirst) {\n        isPending = false;\n        fn(...args);\n      }\n\n      interval = self.setInterval(() => {\n        if (!isPending) {\n          self.clearInterval(interval);\n          interval = undefined;\n          return;\n        }\n\n        isPending = false;\n        fn(...args);\n      }, ms);\n    }\n  };\n}\n\nexport function throttleWithTickEnd<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith(onTickEnd, fn);\n}\n\nexport function throttleWith<F extends AnyToVoidFunction>(schedulerFn: Scheduler, fn: F) {\n  let waiting = false;\n  let args: Parameters<F>;\n\n  return (..._args: Parameters<F>) => {\n    args = _args;\n\n    if (!waiting) {\n      waiting = true;\n\n      schedulerFn(() => {\n        waiting = false;\n        fn(...args);\n      });\n    }\n  };\n}\n\nexport const pause = (ms: number) => new Promise<void>((resolve) => {\n  setTimeout(() => resolve(), ms);\n});\n\nexport function rafPromise() {\n  return new Promise<void>((resolve) => {\n    fastRaf(resolve);\n  });\n}\n\nconst FAST_RAF_TIMEOUT_FALLBACK_MS = 35; // < 30 FPS\n\nlet fastRafCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackCallbacks: Set<NoneToVoidFunction> | undefined;\nlet fastRafFallbackTimeout: number | undefined;\n\n// May result in an immediate execution if called from another RAF callback which was scheduled\n// (and therefore is executed) earlier than RAF callback scheduled by `fastRaf`\nexport function fastRaf(callback: NoneToVoidFunction, withTimeoutFallback = false) {\n  if (!fastRafCallbacks) {\n    fastRafCallbacks = new Set([callback]);\n\n    requestAnimationFrame(() => {\n      const currentCallbacks = fastRafCallbacks!;\n\n      fastRafCallbacks = undefined;\n      fastRafFallbackCallbacks = undefined;\n\n      if (fastRafFallbackTimeout) {\n        clearTimeout(fastRafFallbackTimeout);\n        fastRafFallbackTimeout = undefined;\n      }\n\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    fastRafCallbacks.add(callback);\n  }\n\n  if (withTimeoutFallback) {\n    if (!fastRafFallbackCallbacks) {\n      fastRafFallbackCallbacks = new Set([callback]);\n    } else {\n      fastRafFallbackCallbacks.add(callback);\n    }\n\n    if (!fastRafFallbackTimeout) {\n      fastRafFallbackTimeout = window.setTimeout(() => {\n        const currentTimeoutCallbacks = fastRafFallbackCallbacks!;\n\n        if (fastRafCallbacks) {\n          const currentCallbacks = fastRafCallbacks;\n          currentTimeoutCallbacks.forEach((c) => currentCallbacks.delete(c));\n        }\n        fastRafFallbackCallbacks = undefined;\n\n        if (fastRafFallbackTimeout) {\n          clearTimeout(fastRafFallbackTimeout);\n          fastRafFallbackTimeout = undefined;\n        }\n\n        currentTimeoutCallbacks.forEach((cb) => cb());\n      }, FAST_RAF_TIMEOUT_FALLBACK_MS);\n    }\n  }\n}\n\nlet onTickEndCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onTickEnd(callback: NoneToVoidFunction) {\n  if (!onTickEndCallbacks) {\n    onTickEndCallbacks = [callback];\n\n    Promise.resolve().then(() => {\n      const currentCallbacks = onTickEndCallbacks!;\n      onTickEndCallbacks = undefined;\n      currentCallbacks.forEach((cb) => cb());\n    });\n  } else {\n    onTickEndCallbacks.push(callback);\n  }\n}\n\nconst IDLE_TIMEOUT = 500;\n\nlet onIdleCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onIdle(callback: NoneToVoidFunction) {\n  if (!self.requestIdleCallback) {\n    onTickEnd(callback);\n    return;\n  }\n\n  if (!onIdleCallbacks) {\n    onIdleCallbacks = [callback];\n\n    requestIdleCallback((deadline) => {\n      const currentCallbacks = onIdleCallbacks!;\n      onIdleCallbacks = undefined;\n\n      while (currentCallbacks.length) {\n        const cb = currentCallbacks.shift()!;\n        cb();\n\n        if (!deadline.timeRemaining()) break;\n      }\n\n      if (currentCallbacks.length) {\n        if (onIdleCallbacks) {\n          // Prepend the remaining callbacks if the next pass is already planned\n          onIdleCallbacks = currentCallbacks.concat(onIdleCallbacks);\n        } else {\n          currentCallbacks.forEach(onIdle);\n        }\n      }\n    }, { timeout: IDLE_TIMEOUT });\n  } else {\n    onIdleCallbacks.push(callback);\n  }\n}\n\nlet beforeUnloadCallbacks: NoneToVoidFunction[] | undefined;\n\nexport function onBeforeUnload(callback: NoneToVoidFunction, isLast = false) {\n  if (!beforeUnloadCallbacks) {\n    beforeUnloadCallbacks = [];\n\n    self.addEventListener('beforeunload', () => {\n      beforeUnloadCallbacks!.forEach((cb) => cb());\n    });\n  }\n\n  if (isLast) {\n    beforeUnloadCallbacks.push(callback);\n  } else {\n    beforeUnloadCallbacks.unshift(callback);\n  }\n\n  return () => {\n    beforeUnloadCallbacks = beforeUnloadCallbacks!.filter((cb) => cb !== callback);\n  };\n}\n","import type { FC, FC_withDebug, Props } from './teact';\n\nimport { DEBUG, DEBUG_MORE } from '../../config';\nimport arePropsShallowEqual, { logUnequalProps } from '../../util/arePropsShallowEqual';\nimport Deferred from '../../util/Deferred';\nimport { handleError } from '../../util/handleError';\nimport { orderBy } from '../../util/iteratees';\nimport { throttleWithTickEnd } from '../../util/schedulers';\nimport React, { DEBUG_resolveComponentName, getIsHeavyAnimating, useUnmountCleanup } from './teact';\n\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport useUniqueId from '../../hooks/useUniqueId';\n\nexport default React;\n\ninterface Container {\n  mapStateToProps: MapStateToProps<any>;\n  activationFn?: ActivationFn<any>;\n  stuckTo?: any;\n  ownProps: Props;\n  mappedProps?: Props;\n  forceUpdate: VoidFunction;\n  DEBUG_updates: number;\n  DEBUG_componentName: string;\n}\n\ntype GlobalState =\n  AnyLiteral\n  & { DEBUG_randomId?: number };\ntype ActionNames = string;\ntype ActionPayload = any;\n\nexport interface ActionOptions {\n  forceOnHeavyAnimation?: boolean;\n  // Workaround for iOS gesture history navigation\n  forceSyncOnIOs?: boolean;\n  forceOutdated?: boolean;\n}\n\ntype Actions = Record<ActionNames, (payload?: ActionPayload, options?: ActionOptions) => void>;\n\ntype ActionHandler = (\n  global: GlobalState,\n  actions: Actions,\n  payload: any,\n) => GlobalState | void | Promise<void>;\n\ntype MapStateToProps<OwnProps = undefined> = (global: GlobalState, ownProps: OwnProps) => AnyLiteral;\ntype StickToFirstFn = (value: any) => boolean;\ntype ActivationFn<OwnProps = undefined> = (\n  global: GlobalState, ownProps: OwnProps, stickToFirst: StickToFirstFn,\n) => boolean;\n// TODO: Add callback to typify\ntype GlobalCallback = (global: any) => void;\n\nlet currentGlobal = {\n  isInited: false,\n} as GlobalState;\n\nlet DEBUG_currentRandomId: number | undefined;\n\nconst DEBUG_invalidateGlobalOnTickEnd = throttleWithTickEnd(() => {\n  DEBUG_currentRandomId = Math.random();\n});\n\nconst actionHandlers: Record<string, ActionHandler[]> = {};\nconst callbacks: GlobalCallback[] = [updateContainers];\nconst actions = {} as Actions;\nconst containers = new Map<string, Container>();\n\nconst runCallbacksThrottled = throttleWithTickEnd(runCallbacks);\n\nlet forceOnHeavyAnimation = true;\n\nfunction runCallbacks() {\n  if (forceOnHeavyAnimation) {\n    forceOnHeavyAnimation = false;\n  } else if (getIsHeavyAnimating()) {\n    getIsHeavyAnimating.once(runCallbacksThrottled);\n    return;\n  }\n\n  callbacks.forEach((cb) => cb(currentGlobal));\n}\n\nexport function setUntypedGlobal(newGlobal?: GlobalState, options?: ActionOptions) {\n  if (typeof newGlobal === 'object' && newGlobal !== currentGlobal) {\n    if (DEBUG) {\n      if (\n        !options?.forceOutdated\n        && newGlobal.DEBUG_randomId && newGlobal.DEBUG_randomId !== DEBUG_currentRandomId\n      ) {\n        throw new Error('[TeactN.setGlobal] Attempt to set an outdated global');\n      }\n\n      DEBUG_currentRandomId = Math.random();\n    }\n\n    currentGlobal = newGlobal;\n\n    if (options?.forceSyncOnIOs) {\n      forceOnHeavyAnimation = true;\n      runCallbacks();\n    } else {\n      if (options?.forceOnHeavyAnimation) {\n        forceOnHeavyAnimation = true;\n      }\n\n      runCallbacksThrottled();\n    }\n  }\n}\n\nexport function getUntypedGlobal() {\n  if (DEBUG) {\n    currentGlobal = {\n      ...currentGlobal,\n      DEBUG_randomId: DEBUG_currentRandomId,\n    };\n    DEBUG_invalidateGlobalOnTickEnd();\n  }\n\n  return currentGlobal;\n}\n\nexport function getUntypedActions() {\n  return actions;\n}\n\nexport function forceOnHeavyAnimationOnce() {\n  forceOnHeavyAnimation = true;\n}\n\nlet actionQueue: NoneToVoidFunction[] = [];\nlet afterActionQueue: NoneToVoidFunction[] = [];\n\nfunction handleAction(name: string, payload?: ActionPayload, options?: ActionOptions): Promise<void> {\n  const deferred = new Deferred<void>();\n  actionQueue.push(() => {\n    actionHandlers[name]?.forEach((handler) => {\n      const result = handler(DEBUG ? getUntypedGlobal() : currentGlobal, actions, payload);\n      if (!result) {\n        deferred.resolve();\n        return;\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(() => {\n          deferred.resolve();\n        });\n        return;\n      }\n\n      setUntypedGlobal(result as GlobalState, options);\n      deferred.resolve();\n    });\n  });\n\n  // Important: Keep 1 as start requirement to avoid immediate nested action calls\n  // Do not remove element from array before it is executed for the same reason\n  if (actionQueue.length === 1) {\n    try {\n      while (actionQueue.length) {\n        actionQueue[0]();\n        actionQueue.shift();\n      }\n      while (afterActionQueue.length) {\n        afterActionQueue[0]();\n        afterActionQueue.shift();\n      }\n    } finally {\n      actionQueue = [];\n      afterActionQueue = [];\n    }\n  }\n\n  return deferred.promise;\n}\n\n/**\n * Execute a function after all actions in stack are executed\n * Call only from action handlers\n */\nexport function execAfterActions(fn: NoneToVoidFunction) {\n  afterActionQueue.push(fn);\n}\n\nfunction updateContainers() {\n  let DEBUG_startAt: number | undefined;\n  if (DEBUG) {\n    DEBUG_startAt = performance.now();\n  }\n\n  for (const container of containers.values()) {\n    const {\n      mapStateToProps, ownProps, mappedProps, forceUpdate,\n    } = container;\n\n    if (!activateContainer(container, currentGlobal, ownProps)) {\n      continue;\n    }\n\n    let newMappedProps;\n\n    try {\n      newMappedProps = mapStateToProps(currentGlobal, ownProps);\n    } catch (err: any) {\n      handleError(err);\n\n      return;\n    }\n\n    if (DEBUG) {\n      if (Object.values(newMappedProps).some(Number.isNaN)) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          // eslint-disable-next-line @stylistic/max-len\n          `[TeactN] Some of \\`${container.DEBUG_componentName}\\` mappers contain NaN values. This may cause redundant updates because of incorrect equality check.`,\n        );\n      }\n    }\n\n    if (Object.keys(newMappedProps).length && !arePropsShallowEqual(mappedProps!, newMappedProps)) {\n      if (DEBUG_MORE) {\n        logUnequalProps(\n          mappedProps!,\n          newMappedProps,\n          `[TeactN] Will update ${container.DEBUG_componentName} caused by:`,\n        );\n      }\n\n      container.mappedProps = newMappedProps;\n      container.DEBUG_updates++;\n\n      forceUpdate();\n    }\n  }\n\n  if (DEBUG) {\n    const updateTime = performance.now() - DEBUG_startAt!;\n    if (updateTime > 7) {\n      // eslint-disable-next-line no-console\n      console.warn(`[TeactN] Slow containers update: ${Math.round(updateTime)} ms`);\n    }\n  }\n}\n\nexport function addUntypedActionHandler(name: ActionNames, handler: ActionHandler) {\n  if (!actionHandlers[name]) {\n    actionHandlers[name] = [];\n\n    actions[name] = (payload?: ActionPayload, options?: ActionOptions) => {\n      return handleAction(name, payload, options);\n    };\n  }\n\n  actionHandlers[name].push(handler);\n}\n\nexport function addCallback(cb: GlobalCallback) {\n  callbacks.push(cb);\n}\n\nexport function removeCallback(cb: GlobalCallback) {\n  const index = callbacks.indexOf(cb);\n  if (index !== -1) {\n    callbacks.splice(index, 1);\n  }\n}\n\nexport function withUntypedGlobal<OwnProps extends AnyLiteral>(\n  mapStateToProps: MapStateToProps<OwnProps> = () => ({}),\n  activationFn?: ActivationFn<OwnProps>,\n) {\n  return (Component: FC) => {\n    function TeactNContainer(props: OwnProps) {\n      const id = useUniqueId();\n      const forceUpdate = useForceUpdate();\n\n      useUnmountCleanup(() => {\n        containers.delete(id);\n      });\n\n      let container = containers.get(id)!;\n      if (!container) {\n        container = {\n          mapStateToProps,\n          activationFn,\n          ownProps: props,\n          forceUpdate,\n          DEBUG_updates: 0,\n          DEBUG_componentName: Component.name,\n        };\n\n        containers.set(id, container);\n      }\n\n      if (\n        (!container.mappedProps || !arePropsShallowEqual(container.ownProps, props))\n        && activateContainer(container, currentGlobal, props)\n      ) {\n        try {\n          container.mappedProps = mapStateToProps(currentGlobal, props);\n        } catch (err: any) {\n          handleError(err);\n        }\n      }\n\n      container.ownProps = props;\n\n      return <Component {...container.mappedProps} {...props} />;\n    }\n\n    (TeactNContainer as FC_withDebug).DEBUG_contentComponentName = DEBUG_resolveComponentName(Component);\n\n    return TeactNContainer;\n  };\n}\n\nfunction activateContainer(container: Container, global: GlobalState, props: Props) {\n  const { activationFn, stuckTo } = container;\n  if (!activationFn) {\n    return true;\n  }\n\n  return activationFn(global, props, (stickTo: any) => {\n    if (stuckTo) {\n      return stuckTo === stickTo;\n    } else if (stickTo !== undefined) {\n      container.stuckTo = stickTo;\n    }\n\n    return true;\n  });\n}\n\nexport function typify<\n  ProjectGlobalState,\n  ActionPayloads,\n>() {\n  type ProjectActionNames = keyof ActionPayloads;\n\n  // When payload is allowed to be `undefined` we consider it optional\n  type ProjectActions<ReturnType = void> = {\n    [ActionName in ProjectActionNames]:\n    (undefined extends ActionPayloads[ActionName] ? (\n      (payload?: ActionPayloads[ActionName], options?: ActionOptions) => ReturnType\n    ) : (\n      (payload: ActionPayloads[ActionName], options?: ActionOptions) => ReturnType\n    ))\n  };\n\n  type ActionHandlers = {\n    [ActionName in keyof ActionPayloads]: (\n      global: ProjectGlobalState,\n      actions: ProjectActions,\n      payload: ActionPayloads[ActionName],\n    ) => ProjectGlobalState | void | Promise<void>;\n  };\n\n  type WithGlobalFn = <OwnProps extends AnyLiteral>(\n    mapStateToProps: (global: ProjectGlobalState, ownProps: OwnProps) => AnyLiteral,\n    activationFn?: (global: ProjectGlobalState, ownProps: OwnProps, stickToFirst: StickToFirstFn) => boolean,\n  ) => (Component: FC) => FC<OwnProps>;\n\n  return {\n    getGlobal: getUntypedGlobal as <T extends ProjectGlobalState>() => T,\n    setGlobal: setUntypedGlobal as (state: ProjectGlobalState, options?: ActionOptions) => void,\n    getActions: getUntypedActions as () => ProjectActions,\n    getPromiseActions: getUntypedActions as () => ProjectActions<Promise<void>>,\n    addActionHandler: addUntypedActionHandler as <ActionName extends ProjectActionNames>(\n      name: ActionName,\n      handler: ActionHandlers[ActionName],\n    ) => void,\n    withGlobal: withUntypedGlobal as WithGlobalFn,\n    execAfterActions,\n  };\n}\n\nif (DEBUG) {\n  (window as any).getGlobal = getUntypedGlobal;\n  (window as any).setGlobal = setUntypedGlobal;\n  (window as any).getActions = getUntypedActions;\n\n  document.addEventListener('dblclick', () => {\n    // eslint-disable-next-line no-console\n    console.warn(\n      'GLOBAL CONTAINERS',\n      orderBy(\n        Array.from(containers.values())\n          .map(({ DEBUG_componentName, DEBUG_updates }) => ({ DEBUG_componentName, DEBUG_updates })),\n        'DEBUG_updates',\n        'desc',\n      ),\n    );\n  });\n}\n","import useShowTransition, {\n  type HookParams,\n  type HookParamsWithShouldRender,\n  type HookResult,\n  type HookResultWithShouldRender,\n} from './useShowTransition';\n\ntype HookParamsWithMediaData<RefType extends HTMLElement> = Omit<HookParams<RefType>, 'isOpen'> & {\n  hasMediaData: boolean;\n};\ntype HookParamsWithMediaDataAndShouldRender<RefType extends HTMLElement>\n  = Omit<HookParamsWithShouldRender<RefType>, 'isOpen'> & {\n    hasMediaData: boolean;\n  };\n\nexport default function useMediaTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParamsWithMediaData<RefType>,\n): HookResult<RefType>;\nexport default function useMediaTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParamsWithMediaDataAndShouldRender<RefType>,\n): HookResultWithShouldRender<RefType>;\nexport default function useMediaTransition<RefType extends HTMLElement = HTMLDivElement>(\n  params: HookParamsWithMediaData<RefType> | HookParamsWithMediaDataAndShouldRender<RefType>,\n): HookResult<RefType> | HookResultWithShouldRender<RefType> {\n  const result = useShowTransition<RefType>({\n    isOpen: params.hasMediaData,\n    noMountTransition: params.hasMediaData,\n    className: 'slow',\n    ...params,\n  } as HookParams<RefType>);\n\n  return result;\n}\n","import { useState } from '../../lib/teact/teact';\n\nimport { createCallbackManager } from '../../util/callbacks';\nimport useEffectOnce from '../useEffectOnce';\n\nconst callbacks = createCallbackManager();\n\nfunction createListener() {\n  window.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)\n    .addEventListener('change', callbacks.runCallbacks, { once: true });\n}\n\nexport default function useDevicePixelRatio() {\n  const [dpr, setDpr] = useState(window.devicePixelRatio);\n\n  useEffectOnce(() => {\n    return callbacks.addCallback(() => {\n      setDpr(window.devicePixelRatio);\n    });\n  });\n\n  return dpr;\n}\n\ncreateListener();\n\n// Set up new listener for the next `devicePixelRatio` change\ncallbacks.addCallback(createListener);\n","import {\n  addLocalizationCallback,\n  getTranslationFn,\n  type LangFn,\n} from '../util/localization';\nimport useEffectOnce from './useEffectOnce';\nimport useForceUpdate from './useForceUpdate';\n\nconst useLang = (): LangFn => {\n  const forceUpdate = useForceUpdate();\n\n  useEffectOnce(() => {\n    return addLocalizationCallback(forceUpdate);\n  });\n\n  return getTranslationFn();\n};\n\nexport default useLang;\n","import { useEffect, useMemo, useState } from '../../lib/teact/teact';\n\nimport { throttle } from '../../util/schedulers';\nimport windowSize from '../../util/windowSize';\nimport useDebouncedCallback from '../useDebouncedCallback';\n\nconst THROTTLE = 250;\n\nexport default function useWindowSize() {\n  const { width: initialWidth, height: initialHeight } = windowSize.get();\n  const [width, setWidth] = useState(initialWidth);\n  const [height, setHeight] = useState(initialHeight);\n  const [isResizing, setIsResizing] = useState(false);\n  const setIsResizingDebounced = useDebouncedCallback(setIsResizing, [setIsResizing], THROTTLE, true);\n\n  useEffect(() => {\n    const throttledSetIsResizing = throttle(() => {\n      setIsResizing(true);\n    }, THROTTLE, true);\n\n    const throttledSetSize = throttle(() => {\n      const { width: newWidth, height: newHeight } = windowSize.get();\n      setWidth(newWidth);\n      setHeight(newHeight);\n      setIsResizingDebounced(false);\n    }, THROTTLE, false);\n\n    const handleResize = () => {\n      throttledSetIsResizing();\n      throttledSetSize();\n    };\n\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [setIsResizingDebounced]);\n\n  return useMemo(() => ({ width, height, isResizing }), [height, isResizing, width]);\n}\n","export default function unloadVideo(video: HTMLVideoElement) {\n  video.pause();\n  // https://github.com/shaka-project/shaka-player/commit/0e3d10e61cb08cc35750e48face4e58f24542fc8\n  video.removeAttribute('src');\n  while (video.firstChild) {\n    video.removeChild(video.firstChild);\n  }\n\n  video.load();\n}\n","import {\n  memo, useEffect, useRef, useState,\n} from '../../../lib/teact/teact';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { getStickerMediaHash } from '../../../global/helpers';\nimport buildClassName from '../../../util/buildClassName';\nimport { preloadImage } from '../../../util/files';\nimport { REM } from '../helpers/mediaDimensions';\n\nimport useDynamicColorListener from '../../../hooks/stickers/useDynamicColorListener';\nimport { useThrottleForHeavyAnimation } from '../../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useMedia from '../../../hooks/useMedia';\nimport useOldLang from '../../../hooks/useOldLang';\nimport useResizeObserver from '../../../hooks/useResizeObserver';\nimport useDevicePixelRatio from '../../../hooks/window/useDevicePixelRatio';\nimport useCustomEmoji from '../hooks/useCustomEmoji';\n\nimport styles from './EmojiIconBackground.module.scss';\n\ntype IconPosition = {\n  inline: number;\n  block: number;\n  opacity: number;\n  scale: number;\n};\n\nconst ICON_POSITIONS: IconPosition[] = [\n  {\n    inline: 22, block: 38, opacity: 0.35, scale: 0.75,\n  },\n  {\n    inline: 32, block: 12, opacity: 0.3, scale: 1,\n  },\n  {\n    inline: 60, block: 22, opacity: 0.25, scale: 0.75,\n  },\n  {\n    inline: 75, block: 44, opacity: 0.25, scale: 1,\n  },\n  {\n    inline: 75, block: 2, opacity: 0.2, scale: 0.625,\n  },\n  {\n    inline: 95, block: 18, opacity: 0.2, scale: 1,\n  },\n  {\n    inline: 115, block: 38, opacity: 0.2, scale: 0.625,\n  },\n  {\n    inline: 125, block: 12, opacity: 0.1, scale: 0.75,\n  },\n];\n\nconst EMOJI_SIZE = REM;\nconst LOTTIE_TINT_OPACITY = 'ff';\nconst NON_LOTTIE_TINT_OPACITY = 'bb';\nconst EMOJI_SPACE = 0.75 * REM;\n\ntype OwnProps = {\n  emojiDocumentId: string;\n  className?: string;\n  withEmojiSpace?: boolean;\n};\n\nconst EmojiIconBackground = ({\n  emojiDocumentId,\n  className,\n  withEmojiSpace,\n}: OwnProps) => {\n  const canvasRef = useRef<HTMLCanvasElement>();\n  const containerRef = useRef<HTMLDivElement>();\n\n  const [emojiImage, setEmojiImage] = useState<HTMLImageElement | undefined>();\n\n  const dpr = useDevicePixelRatio();\n\n  const lang = useOldLang();\n\n  const { customEmoji } = useCustomEmoji(emojiDocumentId);\n  const previewMediaHash = customEmoji ? getStickerMediaHash(customEmoji, 'preview') : undefined;\n  const previewUrl = useMedia(previewMediaHash);\n\n  const customColor = useDynamicColorListener(containerRef);\n\n  const preloadAfterHeavyAnimation = useThrottleForHeavyAnimation(() => {\n    if (!previewUrl) return;\n    preloadImage(previewUrl).then(setEmojiImage);\n  }, [previewUrl]);\n\n  useEffect(() => {\n    preloadAfterHeavyAnimation();\n  }, [preloadAfterHeavyAnimation]);\n\n  const updateCanvas = useLastCallback(() => {\n    const canvas = canvasRef.current;\n    if (!canvas || !emojiImage || !customColor) return;\n\n    const context = canvas.getContext('2d')!;\n    const { width, height } = canvas;\n\n    context.clearRect(0, 0, width, height);\n\n    ICON_POSITIONS.forEach(({\n      inline, block, opacity, scale,\n    }) => {\n      const xShift = withEmojiSpace ? -EMOJI_SPACE : 0;\n      const x = ((lang.isRtl ? inline : width / dpr - inline) + xShift) * dpr;\n      const y = block * dpr;\n\n      const emojiSize = EMOJI_SIZE * dpr;\n\n      context.save();\n      context.globalAlpha = opacity;\n      context.translate(x, y);\n      context.scale(scale, scale);\n      context.drawImage(emojiImage, -emojiSize / 2, -emojiSize / 2, emojiSize, emojiSize);\n      context.restore();\n    });\n\n    const tintColor = `${customColor}${customEmoji!.isLottie ? LOTTIE_TINT_OPACITY : NON_LOTTIE_TINT_OPACITY}`;\n\n    context.save();\n    context.fillStyle = tintColor;\n    context.globalCompositeOperation = 'source-atop';\n    context.fillRect(0, 0, width, height);\n    context.restore();\n  });\n\n  const updateCanvasAfterHeavyAnimation = useThrottleForHeavyAnimation(updateCanvas, [updateCanvas]);\n\n  useEffect(() => {\n    updateCanvasAfterHeavyAnimation();\n  }, [emojiImage, lang.isRtl, customColor, updateCanvasAfterHeavyAnimation, withEmojiSpace]);\n\n  const updateCanvasSize = useThrottleForHeavyAnimation((parentWidth: number, parentHeight: number) => {\n    requestMutation(() => {\n      const canvas = canvasRef.current;\n      if (!canvas) return;\n\n      canvas.width = parentWidth * dpr;\n      canvas.height = parentHeight * dpr;\n\n      canvas.style.width = `${parentWidth}px`;\n      canvas.style.height = `${parentHeight}px`;\n\n      updateCanvas();\n    });\n  }, [dpr]);\n\n  const handleResize = useThrottleForHeavyAnimation((entry: ResizeObserverEntry) => {\n    const { width, height } = entry.contentRect;\n\n    updateCanvasSize(width, height);\n  }, [updateCanvasSize]);\n\n  useResizeObserver(containerRef, handleResize);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const { width, height } = container.getBoundingClientRect();\n\n    updateCanvasSize(width, height);\n  }, [updateCanvasSize]);\n\n  return (\n    <div className={buildClassName(styles.root, className)} ref={containerRef}>\n      <canvas ref={canvasRef} />\n    </div>\n  );\n};\n\nexport default memo(EmojiIconBackground);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"pTWe_CYU\"};","import { useRef } from '@teact';\n\nimport type { ApiPeer, ApiTypePeerColor } from '../api/types';\nimport type { CustomPeer, ThemeKey } from '../types';\n\nimport { getPeerColorCollectibleColorCount, getPeerColorCount, getPeerColorKey } from '../global/helpers';\nimport buildStyle from '../util/buildStyle';\nimport { generateColorVariations, generatePeerColorGradient } from '../util/theme';\nimport useSyncEffect from './useSyncEffect';\n\ntype PeerColorAttributes = {\n  className?: string;\n  style?: string;\n};\n\ntype PeerColorProperties = PeerColorAttributes & {\n  backgroundEmojiId?: string;\n  giftEmojiId?: string;\n};\n\nexport default function usePeerColor({\n  peer,\n  color,\n  noUserColors,\n  shouldReset,\n  theme,\n}: {\n  peer?: ApiPeer | CustomPeer;\n  color?: ApiTypePeerColor;\n  noUserColors?: boolean;\n  shouldReset?: boolean;\n  theme: ThemeKey;\n}): PeerColorProperties {\n  const propertiesRef = useRef<PeerColorAttributes>({});\n  const realPeer = peer && !('isCustomPeer' in peer) ? peer : undefined;\n\n  useSyncEffect(() => {\n    if (!peer) {\n      if (!shouldReset) {\n        propertiesRef.current = {};\n        return;\n      }\n\n      propertiesRef.current = {\n        className: noUserColors ? getPeerColorCountClass(1) : getPeerColorClass(0),\n      };\n      return;\n    }\n\n    if ('isCustomPeer' in peer) {\n      if (peer.peerColorId === undefined) {\n        propertiesRef.current = {};\n        return;\n      }\n\n      propertiesRef.current = { className: `peer-color-${peer.peerColorId}`, style: undefined };\n      return;\n    }\n\n    const peerColor = color || peer.color;\n    const isCollectible = peerColor?.type === 'collectible';\n    const colorCount = peer ? getPeerColorCount(peer)\n      : isCollectible ? getPeerColorCollectibleColorCount(peerColor) : 1;\n    const colorCountClass = getPeerColorCountClass(colorCount);\n    const key = (isCollectible || !peerColor?.color) ? getPeerColorKey(peer) : peerColor.color;\n\n    if (noUserColors) {\n      propertiesRef.current = { className: colorCountClass };\n      return;\n    }\n\n    if (peerColor?.type === 'collectible' && !noUserColors) {\n      const accentColor = theme === 'dark' && peerColor.darkAccentColor\n        ? peerColor.darkAccentColor : peerColor.accentColor;\n      const colors = theme === 'dark' && peerColor.darkColors ? peerColor.darkColors : peerColor.colors;\n      const gradient = generatePeerColorGradient(colors);\n      const { bg, bgActive } = generateColorVariations(accentColor);\n      propertiesRef.current = {\n        className: colorCountClass,\n        style: buildStyle(\n          `--bar-gradient: ${gradient}`,\n          `--accent-color: ${accentColor}`,\n          `--accent-background-color: ${bg}`,\n          `--accent-background-active-color: ${bgActive}`,\n        ),\n      };\n      return;\n    }\n\n    const className = (noUserColors || key === undefined) ? colorCountClass : getPeerColorClass(key);\n    propertiesRef.current = { className, style: undefined };\n  }, [noUserColors, shouldReset, theme, color, peer]);\n\n  return {\n    style: propertiesRef.current.style,\n    className: propertiesRef.current.className,\n    backgroundEmojiId: realPeer?.color?.backgroundEmojiId,\n    giftEmojiId: realPeer?.color?.type === 'collectible' ? realPeer.color.giftEmojiId : undefined,\n  };\n}\n\nexport function getPeerColorClass(colorIndex: number) {\n  return `peer-color-${colorIndex}`;\n}\n\nexport function getPeerColorCountClass(colorCount: number) {\n  return `peer-color-count-${colorCount}`;\n}\n","import type {\n  ChangeEvent, FormEvent,\n} from 'react';\nimport type { ElementRef } from '../../lib/teact/teact';\nimport { memo } from '../../lib/teact/teact';\n\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport buildClassName from '../../util/buildClassName';\n\nimport useLang from '../../hooks/useLang';\n\ntype OwnProps = {\n  ref?: ElementRef<HTMLInputElement>;\n  id?: string;\n  className?: string;\n  value?: string;\n  label?: string;\n  error?: string;\n  success?: string;\n  disabled?: boolean;\n  readOnly?: boolean;\n  placeholder?: string;\n  autoComplete?: string;\n  maxLength?: number;\n  tabIndex?: number;\n  teactExperimentControlled?: boolean;\n  inputMode?: 'text' | 'none' | 'tel' | 'url' | 'email' | 'numeric' | 'decimal' | 'search';\n  onChange?: (e: ChangeEvent<HTMLInputElement>) => void;\n  onInput?: (e: FormEvent<HTMLInputElement>) => void;\n  onKeyPress?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n  onKeyDown?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n  onBlur?: (e: React.FocusEvent<HTMLInputElement>) => void;\n  onPaste?: (e: React.ClipboardEvent<HTMLInputElement>) => void;\n  onClick?: (e: React.MouseEvent<HTMLInputElement>) => void;\n};\n\nconst InputText = ({\n  ref,\n  id,\n  className,\n  value,\n  label,\n  error,\n  success,\n  disabled,\n  readOnly,\n  placeholder,\n  autoComplete,\n  inputMode,\n  maxLength,\n  tabIndex,\n  teactExperimentControlled,\n  onChange,\n  onInput,\n  onKeyPress,\n  onKeyDown,\n  onBlur,\n  onPaste,\n  onClick,\n}: OwnProps) => {\n  const lang = useLang();\n  const labelText = error || success || label;\n  const fullClassName = buildClassName(\n    'input-group',\n    value && 'touched',\n    error ? 'error' : success && 'success',\n    disabled && 'disabled',\n    readOnly && 'disabled',\n    labelText && 'with-label',\n    className,\n  );\n\n  return (\n    <div className={fullClassName} dir={lang.isRtl ? 'rtl' : undefined}>\n      <input\n        ref={ref}\n        className=\"form-control\"\n        type=\"text\"\n        id={id}\n        dir=\"auto\"\n        value={value || ''}\n        tabIndex={tabIndex}\n        placeholder={placeholder}\n        maxLength={maxLength}\n        autoComplete={autoComplete}\n        spellCheck={IS_TAURI ? false : undefined}\n        inputMode={inputMode}\n        disabled={disabled}\n        readOnly={readOnly}\n        onChange={onChange}\n        onInput={onInput}\n        onKeyPress={onKeyPress}\n        onKeyDown={onKeyDown}\n        onBlur={onBlur}\n        onPaste={onPaste}\n        aria-label={labelText}\n        teactExperimentControlled={teactExperimentControlled}\n        onClick={onClick}\n      />\n      {labelText && (\n        <label htmlFor={id}>{labelText}</label>\n      )}\n    </div>\n  );\n};\n\nexport default memo(InputText);\n","import type { ElementRef } from '@teact';\nimport { beginHeavyAnimation, useEffect, useLayoutEffect, useRef } from '@teact';\nimport { addExtraClass, removeExtraClass, setExtraStyles, toggleExtraClass } from '@teact/teact-dom';\nimport { getGlobal } from '../../global';\n\nimport { requestForcedReflow, requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { selectCanAnimateInterface } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { waitForAnimationEnd, waitForTransitionEnd } from '../../util/cssAnimationEndListeners';\nimport forceReflow from '../../util/forceReflow';\nimport { omit } from '../../util/iteratees';\nimport { allowSwipeControlForTransition } from '../../util/swipeController';\n\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport usePreviousDeprecated from '../../hooks/usePreviousDeprecated';\nimport useSyncEffectWithPrevDeps from '../../hooks/useSyncEffectWithPrevDeps.ts';\n\nimport './Transition.scss';\n\ntype AnimationName = (\n  'none' | 'slide' | 'slideRtl' | 'slideFade' | 'zoomFade' | 'zoomBounceSemiFade' | 'slideLayers'\n  | 'fade' | 'pushSlide' | 'reveal' | 'slideOptimized' | 'slideOptimizedRtl' | 'semiFade'\n  | 'slideVertical' | 'slideVerticalFade' | 'slideFadeAndroid'\n);\nexport type ChildrenFn = (isActive: boolean, isFrom: boolean, currentKey: number, activeKey: number) => React.ReactNode;\nexport type TransitionProps = {\n  ref?: ElementRef<HTMLDivElement>;\n  activeKey: number;\n  nextKey?: number;\n  name: AnimationName;\n  direction?: 'auto' | 'inverse' | 1 | -1;\n  renderCount?: number;\n  shouldRestoreHeight?: boolean;\n  shouldCleanup?: boolean;\n  cleanupExceptionKey?: number;\n  cleanupOnlyKey?: number;\n  // Used by async components which are usually remounted during first animation\n  shouldWrap?: boolean;\n  wrapExceptionKey?: number;\n  id?: string;\n  className?: string;\n  slideClassName?: string;\n  withSwipeControl?: boolean;\n  isBlockingAnimation?: boolean;\n  children: React.ReactNode | ChildrenFn;\n  'data-tauri-drag-region'?: true;\n  contentSelector?: string;\n  restoreHeightKey?: number;\n  onStart?: NoneToVoidFunction;\n  onStop?: NoneToVoidFunction;\n  onScroll?: NoneToVoidFunction;\n  onWheel?: (e: React.WheelEvent<HTMLDivElement>) => void;\n  onMouseDown?: (e: React.MouseEvent<HTMLDivElement>) => void;\n};\n\nconst FALLBACK_ANIMATION_END = 1000;\nconst CLASSES = {\n  slide: 'Transition_slide',\n  active: 'Transition_slide-active',\n  from: 'Transition_slide-from',\n  to: 'Transition_slide-to',\n  inactive: 'Transition_slide-inactive',\n};\n\nexport const ACTIVE_SLIDE_CLASS_NAME = CLASSES.active;\nexport const TO_SLIDE_CLASS_NAME = CLASSES.to;\n\nconst DISABLEABLE_ANIMATIONS = new Set<AnimationName>([\n  'slide', 'slideRtl', 'slideFade', 'zoomFade', 'zoomBounceSemiFade', 'slideLayers', 'pushSlide', 'reveal',\n  'slideOptimized', 'slideOptimizedRtl', 'slideVertical', 'slideVerticalFade',\n]);\n\nfunction Transition({\n  ref,\n  activeKey,\n  nextKey,\n  name,\n  direction = 'auto',\n  renderCount,\n  shouldRestoreHeight,\n  shouldCleanup,\n  cleanupExceptionKey,\n  cleanupOnlyKey,\n  shouldWrap,\n  wrapExceptionKey,\n  id,\n  className,\n  slideClassName,\n  withSwipeControl,\n  isBlockingAnimation,\n  children,\n  'data-tauri-drag-region': dataTauriDragRegion,\n  contentSelector,\n  restoreHeightKey,\n  onStart,\n  onStop,\n  onScroll,\n  onMouseDown,\n  onWheel,\n}: TransitionProps) {\n  const currentKeyRef = useRef<number>();\n  // No need for a container to update on change\n  const shouldDisableAnimation = DISABLEABLE_ANIMATIONS.has(name)\n    && !selectCanAnimateInterface(getGlobal());\n\n  let containerRef = useRef<HTMLDivElement>();\n  if (ref) {\n    containerRef = ref;\n  }\n\n  const rendersRef = useRef<Record<number, React.ReactNode | ChildrenFn>>({});\n  const prevActiveKey = usePreviousDeprecated<any>(activeKey);\n  const forceUpdate = useForceUpdate();\n  const isAnimatingRef = useRef(false);\n  const isSwipeJustCancelledRef = useRef(false);\n\n  const hasActiveKeyChanged = prevActiveKey !== undefined && activeKey !== prevActiveKey;\n\n  if (!renderCount && hasActiveKeyChanged) {\n    rendersRef.current = { [prevActiveKey]: rendersRef.current[prevActiveKey] };\n  }\n\n  rendersRef.current[activeKey] = children;\n  if (nextKey) {\n    rendersRef.current[nextKey] = children;\n  }\n\n  // Reset when switching from/to \"optimized\" transitions\n  useSyncEffectWithPrevDeps(([prevName]) => {\n    if (!prevName) return;\n\n    const prevIsSliceOptimized = prevName === 'slideOptimized' || prevName === 'slideOptimizedRtl';\n    const isSlideOptimized = name === 'slideOptimized' || name === 'slideOptimizedRtl';\n    const shouldReset = (prevIsSliceOptimized && !isSlideOptimized) || (!prevIsSliceOptimized && isSlideOptimized);\n    if (!shouldReset) return;\n\n    rendersRef.current = { [activeKey]: children };\n\n    if (prevIsSliceOptimized) {\n      requestMutation(() => {\n        const container = containerRef.current!;\n\n        ['slideOptimized', 'slideOptimizedBackwards', 'slideOptimizedRtl', 'slideOptimizedRtlBackwards']\n          .forEach((cn) => removeExtraClass(container, `Transition-${cn}`));\n      });\n    }\n  }, [name]);\n\n  const isBackwards = (\n    direction === -1\n    || (direction === 'auto' && prevActiveKey > activeKey)\n    || (direction === 'inverse' && prevActiveKey < activeKey)\n  );\n\n  useLayoutEffect(() => {\n    function cleanup() {\n      if (!shouldCleanup) return;\n\n      if (cleanupExceptionKey !== undefined) {\n        rendersRef.current = { [cleanupExceptionKey]: rendersRef.current[cleanupExceptionKey] };\n      } else if (cleanupOnlyKey !== undefined) {\n        rendersRef.current = omit(rendersRef.current, [cleanupOnlyKey]);\n      } else {\n        rendersRef.current = {};\n      }\n\n      forceUpdate();\n    }\n\n    const isSlideOptimized = name === 'slideOptimized' || name === 'slideOptimizedRtl';\n    const container = containerRef.current!;\n    const keys = Object.keys(rendersRef.current).map(Number);\n    const prevActiveIndex = renderCount ? prevActiveKey : keys.indexOf(prevActiveKey);\n    const activeIndex = renderCount ? activeKey : keys.indexOf(activeKey);\n\n    const childNodes = Array.from(container.childNodes);\n    if (!childNodes.length) {\n      return;\n    }\n\n    const childElements = Array.from(container.children) as HTMLElement[];\n    childElements.forEach((el) => {\n      addExtraClass(el, CLASSES.slide);\n\n      if (slideClassName) {\n        slideClassName.split(/\\s+/).forEach((token) => {\n          addExtraClass(el, token);\n        });\n      }\n    });\n\n    if (!hasActiveKeyChanged) {\n      if (isAnimatingRef.current) {\n        return;\n      }\n\n      childElements.forEach((childElement) => {\n        if (childElement === childNodes[activeIndex]) {\n          addExtraClass(childElement, CLASSES.active);\n\n          if (isSlideOptimized) {\n            setExtraStyles(childElement, {\n              transition: 'none',\n              transform: 'translate3d(0, 0, 0)',\n            });\n          }\n        } else if (!isSlideOptimized) {\n          addExtraClass(childElement, CLASSES.inactive);\n        }\n      });\n\n      return;\n    }\n\n    currentKeyRef.current = activeKey;\n\n    if (isSlideOptimized) {\n      if (!childNodes[activeIndex]) {\n        return;\n      }\n\n      performSlideOptimized(\n        shouldDisableAnimation,\n        name,\n        isBackwards,\n        cleanup,\n        activeKey,\n        currentKeyRef,\n        isAnimatingRef,\n        container,\n        childNodes[activeIndex],\n        childNodes[prevActiveIndex],\n        shouldRestoreHeight,\n        isBlockingAnimation,\n        onStart,\n        onStop,\n      );\n\n      return;\n    }\n\n    if (name === 'none' || shouldDisableAnimation || isSwipeJustCancelledRef.current) {\n      if (isSwipeJustCancelledRef.current) {\n        isSwipeJustCancelledRef.current = false;\n      }\n\n      childNodes.forEach((node, i) => {\n        if (node instanceof HTMLElement) {\n          removeExtraClass(node, CLASSES.from);\n          removeExtraClass(node, CLASSES.to);\n          toggleExtraClass(node, CLASSES.active, i === activeIndex);\n          toggleExtraClass(node, CLASSES.inactive, i !== activeIndex);\n        }\n      });\n\n      cleanup();\n\n      return;\n    }\n\n    childNodes.forEach((node, i) => {\n      if (node instanceof HTMLElement) {\n        removeExtraClass(node, CLASSES.active);\n        toggleExtraClass(node, CLASSES.from, i === prevActiveIndex);\n        toggleExtraClass(node, CLASSES.to, i === activeIndex);\n        toggleExtraClass(node, CLASSES.inactive, i !== prevActiveIndex && i !== activeIndex);\n      }\n    });\n\n    isAnimatingRef.current = true;\n    const endHeavyAnimation = beginHeavyAnimation(undefined, isBlockingAnimation);\n    onStart?.();\n\n    toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n    toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n    function onAnimationEnd() {\n      const activeElement = container.querySelector<HTMLDivElement>(`.${CLASSES.active}`);\n      const { clientHeight } = activeElement || {};\n\n      requestMutation(() => {\n        if (activeKey !== currentKeyRef.current) {\n          endHeavyAnimation();\n          return;\n        }\n\n        removeExtraClass(container, `Transition-${name}`);\n        removeExtraClass(container, `Transition-${name}Backwards`);\n\n        childNodes.forEach((node, i) => {\n          if (node instanceof HTMLElement) {\n            removeExtraClass(node, CLASSES.from);\n            removeExtraClass(node, CLASSES.to);\n            toggleExtraClass(node, CLASSES.active, i === activeIndex);\n            toggleExtraClass(node, CLASSES.inactive, i !== activeIndex);\n          }\n        });\n\n        if (shouldRestoreHeight) {\n          if (activeElement) {\n            setExtraStyles(activeElement, { height: 'auto' });\n            setExtraStyles(container, { height: `${clientHeight}px` });\n          }\n        }\n\n        onStop?.();\n        endHeavyAnimation();\n        isAnimatingRef.current = false;\n\n        cleanup();\n      });\n    }\n\n    const watchedNode = (name === 'reveal' || name === 'slideFadeAndroid') && isBackwards\n      ? childNodes[prevActiveIndex]\n      : childNodes[activeIndex];\n\n    if (watchedNode) {\n      if (withSwipeControl && childNodes[prevActiveIndex]) {\n        const giveUpAnimationEnd = waitForAnimationEnd(watchedNode, onAnimationEnd);\n\n        allowSwipeControlForTransition(\n          childNodes[prevActiveIndex] as HTMLElement,\n          childNodes[activeIndex] as HTMLElement,\n          () => {\n            giveUpAnimationEnd();\n            isSwipeJustCancelledRef.current = true;\n            onStop?.();\n            endHeavyAnimation();\n            isAnimatingRef.current = false;\n          },\n        );\n      } else {\n        waitForAnimationEnd(watchedNode, onAnimationEnd, undefined, FALLBACK_ANIMATION_END);\n      }\n    } else {\n      onAnimationEnd();\n    }\n  }, [\n    activeKey,\n    nextKey,\n    prevActiveKey,\n    hasActiveKeyChanged,\n    isBackwards,\n    name,\n    onStart,\n    onStop,\n    renderCount,\n    shouldRestoreHeight,\n    shouldCleanup,\n    slideClassName,\n    cleanupExceptionKey,\n    shouldDisableAnimation,\n    forceUpdate,\n    withSwipeControl,\n    isBlockingAnimation,\n    cleanupOnlyKey,\n  ]);\n\n  useEffect(() => {\n    if (!shouldRestoreHeight) {\n      return;\n    }\n\n    const container = containerRef.current!;\n    const activeElement = container.querySelector<HTMLDivElement>(`:scope > .${CLASSES.active}`)\n      || container.querySelector<HTMLDivElement>(`:scope > .${CLASSES.from}`);\n    if (!activeElement) {\n      return;\n    }\n\n    const contentElement = contentSelector\n      ? activeElement.querySelector<HTMLDivElement>(contentSelector) : activeElement;\n\n    const { clientHeight, clientWidth } = contentElement || activeElement || {};\n    if (!clientHeight || !clientWidth) {\n      return;\n    }\n\n    requestMutation(() => {\n      setExtraStyles(activeElement, { height: 'auto' });\n      setExtraStyles(container, {\n        height: `${clientHeight}px`,\n        flexBasis: `${clientHeight}px`,\n      });\n    });\n  }, [shouldRestoreHeight, children, restoreHeightKey, contentSelector]);\n\n  const asFastList = !renderCount;\n  const renders = rendersRef.current;\n  const renderKeys = Object.keys(renderCount ? new Array(renderCount).fill(undefined) : renders).map(Number);\n  const contents = renderKeys.map((key) => {\n    const render = renders[key];\n    if (!render) {\n      return undefined;\n    }\n\n    const rendered = typeof render === 'function'\n      ? render(key === activeKey, key === prevActiveKey, key, activeKey)\n      : render;\n\n    return (shouldWrap && key !== wrapExceptionKey) || asFastList\n      ? <div key={key} teactOrderKey={key}>{rendered}</div>\n      : rendered;\n  });\n\n  return (\n    <div\n      ref={containerRef}\n      id={id}\n      className={buildClassName('Transition', className)}\n      teactFastList={asFastList}\n      data-tauri-drag-region={dataTauriDragRegion}\n      onScroll={onScroll}\n      onMouseDown={onMouseDown}\n      onWheel={onWheel}\n    >\n      {contents}\n    </div>\n  );\n}\n\nexport default Transition;\n\nfunction performSlideOptimized(\n  shouldDisableAnimation: boolean,\n  name: 'slideOptimized' | 'slideOptimizedRtl',\n  isBackwards: boolean,\n  cleanup: NoneToVoidFunction,\n  activeKey: number,\n  currentKeyRef: { current: number | undefined },\n  isAnimatingRef: { current: boolean | undefined },\n  container: HTMLElement,\n  toSlide: ChildNode,\n  fromSlide?: ChildNode,\n  shouldRestoreHeight?: boolean,\n  isBlockingAnimation?: boolean,\n  onStart?: NoneToVoidFunction,\n  onStop?: NoneToVoidFunction,\n) {\n  if (shouldDisableAnimation) {\n    toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n    toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n    if (fromSlide instanceof HTMLElement) {\n      removeExtraClass(fromSlide, CLASSES.active);\n      setExtraStyles(fromSlide, {\n        transition: 'none',\n        transform: '',\n      });\n    }\n\n    if (toSlide instanceof HTMLElement) {\n      addExtraClass(toSlide, CLASSES.active);\n      setExtraStyles(toSlide, {\n        transition: 'none',\n        transform: 'translate3d(0, 0, 0)',\n      });\n    }\n\n    cleanup();\n\n    return;\n  }\n\n  if (name === 'slideOptimizedRtl') {\n    isBackwards = !isBackwards;\n  }\n\n  isAnimatingRef.current = true;\n  const endHeavyAnimation = beginHeavyAnimation(undefined, isBlockingAnimation);\n  onStart?.();\n\n  toggleExtraClass(container, `Transition-${name}`, !isBackwards);\n  toggleExtraClass(container, `Transition-${name}Backwards`, isBackwards);\n\n  if (fromSlide instanceof HTMLElement) {\n    setExtraStyles(fromSlide, {\n      transition: 'none',\n      transform: 'translate3d(0, 0, 0)',\n    });\n  }\n\n  if (toSlide instanceof HTMLElement) {\n    setExtraStyles(toSlide, {\n      transition: 'none',\n      transform: `translate3d(${isBackwards ? '-' : ''}100%, 0, 0)`,\n    });\n  }\n\n  requestForcedReflow(() => {\n    if (toSlide instanceof HTMLElement) {\n      forceReflow(toSlide);\n    }\n\n    return () => {\n      if (fromSlide instanceof HTMLElement) {\n        removeExtraClass(fromSlide, CLASSES.active);\n        setExtraStyles(fromSlide, {\n          transition: '',\n          transform: `translate3d(${isBackwards ? '' : '-'}100%, 0, 0)`,\n        });\n      }\n\n      if (toSlide instanceof HTMLElement) {\n        addExtraClass(toSlide, CLASSES.active);\n        setExtraStyles(toSlide, {\n          transition: '',\n          transform: 'translate3d(0, 0, 0)',\n        });\n      }\n    };\n  });\n\n  waitForTransitionEnd(toSlide, () => {\n    const clientHeight = toSlide instanceof HTMLElement ? toSlide.clientHeight : undefined;\n\n    requestMutation(() => {\n      if (activeKey !== currentKeyRef.current) {\n        endHeavyAnimation();\n        return;\n      }\n\n      if (fromSlide instanceof HTMLElement) {\n        setExtraStyles(fromSlide, {\n          transition: 'none',\n          transform: '',\n        });\n      }\n\n      if (shouldRestoreHeight && clientHeight && toSlide instanceof HTMLElement) {\n        setExtraStyles(toSlide, { height: 'auto' });\n        setExtraStyles(container, { height: `${clientHeight}px` });\n      }\n\n      onStop?.();\n      endHeavyAnimation();\n      isAnimatingRef.current = false;\n\n      cleanup();\n    });\n  });\n}\n","import { useRef } from '../lib/teact/teact';\n\n// Allows to use state value as \"silent\" dependency in hooks (not causing updates).\n// Also useful for state values that update frequently (such as controlled input value).\nexport function useStateRef<T>(value: T) {\n  const ref = useRef<T>(value);\n  ref.current = value;\n  return ref;\n}\n","// Used before applying CSS transition\nexport default function forceReflow(element: HTMLElement) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetWidth;\n}\n","import { DEBUG } from '../config';\n\nconst safePlay = (mediaEl: HTMLMediaElement) => {\n  mediaEl.play().catch((err) => {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn(err, mediaEl);\n    }\n  });\n};\n\nexport const getIsVideoPlaying = (video: HTMLVideoElement) => {\n  return video.currentTime > 0 && !video.paused && !video.ended && video.readyState > 2;\n};\n\nexport default safePlay;\n","const PACKET_TYPES = Object.create(null); // no Map = no polyfill\nPACKET_TYPES[\"open\"] = \"0\";\nPACKET_TYPES[\"close\"] = \"1\";\nPACKET_TYPES[\"ping\"] = \"2\";\nPACKET_TYPES[\"pong\"] = \"3\";\nPACKET_TYPES[\"message\"] = \"4\";\nPACKET_TYPES[\"upgrade\"] = \"5\";\nPACKET_TYPES[\"noop\"] = \"6\";\nconst PACKET_TYPES_REVERSE = Object.create(null);\nObject.keys(PACKET_TYPES).forEach((key) => {\n    PACKET_TYPES_REVERSE[PACKET_TYPES[key]] = key;\n});\nconst ERROR_PACKET = { type: \"error\", data: \"parser error\" };\nexport { PACKET_TYPES, PACKET_TYPES_REVERSE, ERROR_PACKET };\n","import { PACKET_TYPES } from \"./commons.js\";\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        Object.prototype.toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\n// ArrayBuffer.isView method is not defined in IE10\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj && obj.buffer instanceof ArrayBuffer;\n};\nconst encodePacket = ({ type, data }, supportsBinary, callback) => {\n    if (withNativeBlob && data instanceof Blob) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(data, callback);\n        }\n    }\n    else if (withNativeArrayBuffer &&\n        (data instanceof ArrayBuffer || isView(data))) {\n        if (supportsBinary) {\n            return callback(data);\n        }\n        else {\n            return encodeBlobAsBase64(new Blob([data]), callback);\n        }\n    }\n    // plain string\n    return callback(PACKET_TYPES[type] + (data || \"\"));\n};\nconst encodeBlobAsBase64 = (data, callback) => {\n    const fileReader = new FileReader();\n    fileReader.onload = function () {\n        const content = fileReader.result.split(\",\")[1];\n        callback(\"b\" + (content || \"\"));\n    };\n    return fileReader.readAsDataURL(data);\n};\nfunction toArray(data) {\n    if (data instanceof Uint8Array) {\n        return data;\n    }\n    else if (data instanceof ArrayBuffer) {\n        return new Uint8Array(data);\n    }\n    else {\n        return new Uint8Array(data.buffer, data.byteOffset, data.byteLength);\n    }\n}\nlet TEXT_ENCODER;\nexport function encodePacketToBinary(packet, callback) {\n    if (withNativeBlob && packet.data instanceof Blob) {\n        return packet.data.arrayBuffer().then(toArray).then(callback);\n    }\n    else if (withNativeArrayBuffer &&\n        (packet.data instanceof ArrayBuffer || isView(packet.data))) {\n        return callback(toArray(packet.data));\n    }\n    encodePacket(packet, false, (encoded) => {\n        if (!TEXT_ENCODER) {\n            TEXT_ENCODER = new TextEncoder();\n        }\n        callback(TEXT_ENCODER.encode(encoded));\n    });\n}\nexport { encodePacket };\n","// imported from https://github.com/socketio/base64-arraybuffer\nconst chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nconst lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (let i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nexport const encode = (arraybuffer) => {\n    let bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nexport const decode = (base64) => {\n    let bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    const arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n","import { ERROR_PACKET, PACKET_TYPES_REVERSE, } from \"./commons.js\";\nimport { decode } from \"./contrib/base64-arraybuffer.js\";\nconst withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nexport const decodePacket = (encodedPacket, binaryType) => {\n    if (typeof encodedPacket !== \"string\") {\n        return {\n            type: \"message\",\n            data: mapBinary(encodedPacket, binaryType),\n        };\n    }\n    const type = encodedPacket.charAt(0);\n    if (type === \"b\") {\n        return {\n            type: \"message\",\n            data: decodeBase64Packet(encodedPacket.substring(1), binaryType),\n        };\n    }\n    const packetType = PACKET_TYPES_REVERSE[type];\n    if (!packetType) {\n        return ERROR_PACKET;\n    }\n    return encodedPacket.length > 1\n        ? {\n            type: PACKET_TYPES_REVERSE[type],\n            data: encodedPacket.substring(1),\n        }\n        : {\n            type: PACKET_TYPES_REVERSE[type],\n        };\n};\nconst decodeBase64Packet = (data, binaryType) => {\n    if (withNativeArrayBuffer) {\n        const decoded = decode(data);\n        return mapBinary(decoded, binaryType);\n    }\n    else {\n        return { base64: true, data }; // fallback for old browsers\n    }\n};\nconst mapBinary = (data, binaryType) => {\n    switch (binaryType) {\n        case \"blob\":\n            if (data instanceof Blob) {\n                // from WebSocket + binaryType \"blob\"\n                return data;\n            }\n            else {\n                // from HTTP long-polling or WebTransport\n                return new Blob([data]);\n            }\n        case \"arraybuffer\":\n        default:\n            if (data instanceof ArrayBuffer) {\n                // from HTTP long-polling (base64) or WebSocket + binaryType \"arraybuffer\"\n                return data;\n            }\n            else {\n                // from WebTransport (Uint8Array)\n                return data.buffer;\n            }\n    }\n};\n","import { encodePacket, encodePacketToBinary } from \"./encodePacket.js\";\nimport { decodePacket } from \"./decodePacket.js\";\nimport { ERROR_PACKET, } from \"./commons.js\";\nconst SEPARATOR = String.fromCharCode(30); // see https://en.wikipedia.org/wiki/Delimiter#ASCII_delimited_text\nconst encodePayload = (packets, callback) => {\n    // some packets may be added to the array while encoding, so the initial length must be saved\n    const length = packets.length;\n    const encodedPackets = new Array(length);\n    let count = 0;\n    packets.forEach((packet, i) => {\n        // force base64 encoding for binary packets\n        encodePacket(packet, false, (encodedPacket) => {\n            encodedPackets[i] = encodedPacket;\n            if (++count === length) {\n                callback(encodedPackets.join(SEPARATOR));\n            }\n        });\n    });\n};\nconst decodePayload = (encodedPayload, binaryType) => {\n    const encodedPackets = encodedPayload.split(SEPARATOR);\n    const packets = [];\n    for (let i = 0; i < encodedPackets.length; i++) {\n        const decodedPacket = decodePacket(encodedPackets[i], binaryType);\n        packets.push(decodedPacket);\n        if (decodedPacket.type === \"error\") {\n            break;\n        }\n    }\n    return packets;\n};\nexport function createPacketEncoderStream() {\n    return new TransformStream({\n        transform(packet, controller) {\n            encodePacketToBinary(packet, (encodedPacket) => {\n                const payloadLength = encodedPacket.length;\n                let header;\n                // inspired by the WebSocket format: https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers#decoding_payload_length\n                if (payloadLength < 126) {\n                    header = new Uint8Array(1);\n                    new DataView(header.buffer).setUint8(0, payloadLength);\n                }\n                else if (payloadLength < 65536) {\n                    header = new Uint8Array(3);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 126);\n                    view.setUint16(1, payloadLength);\n                }\n                else {\n                    header = new Uint8Array(9);\n                    const view = new DataView(header.buffer);\n                    view.setUint8(0, 127);\n                    view.setBigUint64(1, BigInt(payloadLength));\n                }\n                // first bit indicates whether the payload is plain text (0) or binary (1)\n                if (packet.data && typeof packet.data !== \"string\") {\n                    header[0] |= 0x80;\n                }\n                controller.enqueue(header);\n                controller.enqueue(encodedPacket);\n            });\n        },\n    });\n}\nlet TEXT_DECODER;\nfunction totalLength(chunks) {\n    return chunks.reduce((acc, chunk) => acc + chunk.length, 0);\n}\nfunction concatChunks(chunks, size) {\n    if (chunks[0].length === size) {\n        return chunks.shift();\n    }\n    const buffer = new Uint8Array(size);\n    let j = 0;\n    for (let i = 0; i < size; i++) {\n        buffer[i] = chunks[0][j++];\n        if (j === chunks[0].length) {\n            chunks.shift();\n            j = 0;\n        }\n    }\n    if (chunks.length && j < chunks[0].length) {\n        chunks[0] = chunks[0].slice(j);\n    }\n    return buffer;\n}\nexport function createPacketDecoderStream(maxPayload, binaryType) {\n    if (!TEXT_DECODER) {\n        TEXT_DECODER = new TextDecoder();\n    }\n    const chunks = [];\n    let state = 0 /* State.READ_HEADER */;\n    let expectedLength = -1;\n    let isBinary = false;\n    return new TransformStream({\n        transform(chunk, controller) {\n            chunks.push(chunk);\n            while (true) {\n                if (state === 0 /* State.READ_HEADER */) {\n                    if (totalLength(chunks) < 1) {\n                        break;\n                    }\n                    const header = concatChunks(chunks, 1);\n                    isBinary = (header[0] & 0x80) === 0x80;\n                    expectedLength = header[0] & 0x7f;\n                    if (expectedLength < 126) {\n                        state = 3 /* State.READ_PAYLOAD */;\n                    }\n                    else if (expectedLength === 126) {\n                        state = 1 /* State.READ_EXTENDED_LENGTH_16 */;\n                    }\n                    else {\n                        state = 2 /* State.READ_EXTENDED_LENGTH_64 */;\n                    }\n                }\n                else if (state === 1 /* State.READ_EXTENDED_LENGTH_16 */) {\n                    if (totalLength(chunks) < 2) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 2);\n                    expectedLength = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length).getUint16(0);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else if (state === 2 /* State.READ_EXTENDED_LENGTH_64 */) {\n                    if (totalLength(chunks) < 8) {\n                        break;\n                    }\n                    const headerArray = concatChunks(chunks, 8);\n                    const view = new DataView(headerArray.buffer, headerArray.byteOffset, headerArray.length);\n                    const n = view.getUint32(0);\n                    if (n > Math.pow(2, 53 - 32) - 1) {\n                        // the maximum safe integer in JavaScript is 2^53 - 1\n                        controller.enqueue(ERROR_PACKET);\n                        break;\n                    }\n                    expectedLength = n * Math.pow(2, 32) + view.getUint32(4);\n                    state = 3 /* State.READ_PAYLOAD */;\n                }\n                else {\n                    if (totalLength(chunks) < expectedLength) {\n                        break;\n                    }\n                    const data = concatChunks(chunks, expectedLength);\n                    controller.enqueue(decodePacket(isBinary ? data : TEXT_DECODER.decode(data), binaryType));\n                    state = 0 /* State.READ_HEADER */;\n                }\n                if (expectedLength === 0 || expectedLength > maxPayload) {\n                    controller.enqueue(ERROR_PACKET);\n                    break;\n                }\n            }\n        },\n    });\n}\nexport const protocol = 4;\nexport { encodePacket, encodePayload, decodePacket, decodePayload, };\n","/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nexport function Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n\n  // Remove event specific arrays for event types that no\n  // one is subscribed for to avoid memory leak.\n  if (callbacks.length === 0) {\n    delete this._callbacks['$' + event];\n  }\n\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n\n  var args = new Array(arguments.length - 1)\n    , callbacks = this._callbacks['$' + event];\n\n  for (var i = 1; i < arguments.length; i++) {\n    args[i - 1] = arguments[i];\n  }\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n// alias used for reserved events (protected method)\nEmitter.prototype.emitReserved = Emitter.prototype.emit;\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n","export const nextTick = (() => {\n    const isPromiseAvailable = typeof Promise === \"function\" && typeof Promise.resolve === \"function\";\n    if (isPromiseAvailable) {\n        return (cb) => Promise.resolve().then(cb);\n    }\n    else {\n        return (cb, setTimeoutFn) => setTimeoutFn(cb, 0);\n    }\n})();\nexport const globalThisShim = (() => {\n    if (typeof self !== \"undefined\") {\n        return self;\n    }\n    else if (typeof window !== \"undefined\") {\n        return window;\n    }\n    else {\n        return Function(\"return this\")();\n    }\n})();\nexport const defaultBinaryType = \"arraybuffer\";\nexport function createCookieJar() { }\n","import { globalThisShim as globalThis } from \"./globals.node.js\";\nexport function pick(obj, ...attr) {\n    return attr.reduce((acc, k) => {\n        if (obj.hasOwnProperty(k)) {\n            acc[k] = obj[k];\n        }\n        return acc;\n    }, {});\n}\n// Keep a reference to the real timeout functions so they can be used when overridden\nconst NATIVE_SET_TIMEOUT = globalThis.setTimeout;\nconst NATIVE_CLEAR_TIMEOUT = globalThis.clearTimeout;\nexport function installTimerFunctions(obj, opts) {\n    if (opts.useNativeTimers) {\n        obj.setTimeoutFn = NATIVE_SET_TIMEOUT.bind(globalThis);\n        obj.clearTimeoutFn = NATIVE_CLEAR_TIMEOUT.bind(globalThis);\n    }\n    else {\n        obj.setTimeoutFn = globalThis.setTimeout.bind(globalThis);\n        obj.clearTimeoutFn = globalThis.clearTimeout.bind(globalThis);\n    }\n}\n// base64 encoded buffers are about 33% bigger (https://en.wikipedia.org/wiki/Base64)\nconst BASE64_OVERHEAD = 1.33;\n// we could also have used `new Blob([obj]).size`, but it isn't supported in IE9\nexport function byteLength(obj) {\n    if (typeof obj === \"string\") {\n        return utf8Length(obj);\n    }\n    // arraybuffer or blob\n    return Math.ceil((obj.byteLength || obj.size) * BASE64_OVERHEAD);\n}\nfunction utf8Length(str) {\n    let c = 0, length = 0;\n    for (let i = 0, l = str.length; i < l; i++) {\n        c = str.charCodeAt(i);\n        if (c < 0x80) {\n            length += 1;\n        }\n        else if (c < 0x800) {\n            length += 2;\n        }\n        else if (c < 0xd800 || c >= 0xe000) {\n            length += 3;\n        }\n        else {\n            i++;\n            length += 4;\n        }\n    }\n    return length;\n}\n/**\n * Generates a random 8-characters string.\n */\nexport function randomString() {\n    return (Date.now().toString(36).substring(3) +\n        Math.random().toString(36).substring(2, 5));\n}\n","import { decodePacket } from \"engine.io-parser\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions } from \"./util.js\";\nimport { encode } from \"./contrib/parseqs.js\";\nexport class TransportError extends Error {\n    constructor(reason, description, context) {\n        super(reason);\n        this.description = description;\n        this.context = context;\n        this.type = \"TransportError\";\n    }\n}\nexport class Transport extends Emitter {\n    /**\n     * Transport abstract constructor.\n     *\n     * @param {Object} opts - options\n     * @protected\n     */\n    constructor(opts) {\n        super();\n        this.writable = false;\n        installTimerFunctions(this, opts);\n        this.opts = opts;\n        this.query = opts.query;\n        this.socket = opts.socket;\n        this.supportsBinary = !opts.forceBase64;\n    }\n    /**\n     * Emits an error.\n     *\n     * @param {String} reason\n     * @param description\n     * @param context - the error context\n     * @return {Transport} for chaining\n     * @protected\n     */\n    onError(reason, description, context) {\n        super.emitReserved(\"error\", new TransportError(reason, description, context));\n        return this;\n    }\n    /**\n     * Opens the transport.\n     */\n    open() {\n        this.readyState = \"opening\";\n        this.doOpen();\n        return this;\n    }\n    /**\n     * Closes the transport.\n     */\n    close() {\n        if (this.readyState === \"opening\" || this.readyState === \"open\") {\n            this.doClose();\n            this.onClose();\n        }\n        return this;\n    }\n    /**\n     * Sends multiple packets.\n     *\n     * @param {Array} packets\n     */\n    send(packets) {\n        if (this.readyState === \"open\") {\n            this.write(packets);\n        }\n        else {\n            // this might happen if the transport was silently closed in the beforeunload event handler\n        }\n    }\n    /**\n     * Called upon open\n     *\n     * @protected\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        this.writable = true;\n        super.emitReserved(\"open\");\n    }\n    /**\n     * Called with data.\n     *\n     * @param {String} data\n     * @protected\n     */\n    onData(data) {\n        const packet = decodePacket(data, this.socket.binaryType);\n        this.onPacket(packet);\n    }\n    /**\n     * Called with a decoded packet.\n     *\n     * @protected\n     */\n    onPacket(packet) {\n        super.emitReserved(\"packet\", packet);\n    }\n    /**\n     * Called upon close.\n     *\n     * @protected\n     */\n    onClose(details) {\n        this.readyState = \"closed\";\n        super.emitReserved(\"close\", details);\n    }\n    /**\n     * Pauses the transport, in order not to lose packets during an upgrade.\n     *\n     * @param onPause\n     */\n    pause(onPause) { }\n    createUri(schema, query = {}) {\n        return (schema +\n            \"://\" +\n            this._hostname() +\n            this._port() +\n            this.opts.path +\n            this._query(query));\n    }\n    _hostname() {\n        const hostname = this.opts.hostname;\n        return hostname.indexOf(\":\") === -1 ? hostname : \"[\" + hostname + \"]\";\n    }\n    _port() {\n        if (this.opts.port &&\n            ((this.opts.secure && Number(this.opts.port) !== 443) ||\n                (!this.opts.secure && Number(this.opts.port) !== 80))) {\n            return \":\" + this.opts.port;\n        }\n        else {\n            return \"\";\n        }\n    }\n    _query(query) {\n        const encodedQuery = encode(query);\n        return encodedQuery.length ? \"?\" + encodedQuery : \"\";\n    }\n}\n","// imported from https://github.com/galkn/querystring\n/**\n * Compiles a querystring\n * Returns string representation of the object\n *\n * @param {Object}\n * @api private\n */\nexport function encode(obj) {\n    let str = '';\n    for (let i in obj) {\n        if (obj.hasOwnProperty(i)) {\n            if (str.length)\n                str += '&';\n            str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\n        }\n    }\n    return str;\n}\n/**\n * Parses a simple querystring into an object\n *\n * @param {String} qs\n * @api private\n */\nexport function decode(qs) {\n    let qry = {};\n    let pairs = qs.split('&');\n    for (let i = 0, l = pairs.length; i < l; i++) {\n        let pair = pairs[i].split('=');\n        qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n    }\n    return qry;\n}\n","import { Transport } from \"../transport.js\";\nimport { randomString } from \"../util.js\";\nimport { encodePayload, decodePayload } from \"engine.io-parser\";\nexport class Polling extends Transport {\n    constructor() {\n        super(...arguments);\n        this._polling = false;\n    }\n    get name() {\n        return \"polling\";\n    }\n    /**\n     * Opens the socket (triggers polling). We write a PING message to determine\n     * when the transport is open.\n     *\n     * @protected\n     */\n    doOpen() {\n        this._poll();\n    }\n    /**\n     * Pauses polling.\n     *\n     * @param {Function} onPause - callback upon buffers are flushed and transport is paused\n     * @package\n     */\n    pause(onPause) {\n        this.readyState = \"pausing\";\n        const pause = () => {\n            this.readyState = \"paused\";\n            onPause();\n        };\n        if (this._polling || !this.writable) {\n            let total = 0;\n            if (this._polling) {\n                total++;\n                this.once(\"pollComplete\", function () {\n                    --total || pause();\n                });\n            }\n            if (!this.writable) {\n                total++;\n                this.once(\"drain\", function () {\n                    --total || pause();\n                });\n            }\n        }\n        else {\n            pause();\n        }\n    }\n    /**\n     * Starts polling cycle.\n     *\n     * @private\n     */\n    _poll() {\n        this._polling = true;\n        this.doPoll();\n        this.emitReserved(\"poll\");\n    }\n    /**\n     * Overloads onData to detect payloads.\n     *\n     * @protected\n     */\n    onData(data) {\n        const callback = (packet) => {\n            // if its the first message we consider the transport open\n            if (\"opening\" === this.readyState && packet.type === \"open\") {\n                this.onOpen();\n            }\n            // if its a close packet, we close the ongoing requests\n            if (\"close\" === packet.type) {\n                this.onClose({ description: \"transport closed by the server\" });\n                return false;\n            }\n            // otherwise bypass onData and handle the message\n            this.onPacket(packet);\n        };\n        // decode payload\n        decodePayload(data, this.socket.binaryType).forEach(callback);\n        // if an event did not trigger closing\n        if (\"closed\" !== this.readyState) {\n            // if we got data we're not polling\n            this._polling = false;\n            this.emitReserved(\"pollComplete\");\n            if (\"open\" === this.readyState) {\n                this._poll();\n            }\n            else {\n            }\n        }\n    }\n    /**\n     * For polling, send a close packet.\n     *\n     * @protected\n     */\n    doClose() {\n        const close = () => {\n            this.write([{ type: \"close\" }]);\n        };\n        if (\"open\" === this.readyState) {\n            close();\n        }\n        else {\n            // in case we're trying to close while\n            // handshaking is in progress (GH-164)\n            this.once(\"open\", close);\n        }\n    }\n    /**\n     * Writes a packets payload.\n     *\n     * @param {Array} packets - data packets\n     * @protected\n     */\n    write(packets) {\n        this.writable = false;\n        encodePayload(packets, (data) => {\n            this.doWrite(data, () => {\n                this.writable = true;\n                this.emitReserved(\"drain\");\n            });\n        });\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"https\" : \"http\";\n        const query = this.query || {};\n        // cache busting is forced\n        if (false !== this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        if (!this.supportsBinary && !query.sid) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\n","// imported from https://github.com/component/has-cors\nlet value = false;\ntry {\n    value = typeof XMLHttpRequest !== 'undefined' &&\n        'withCredentials' in new XMLHttpRequest();\n}\ncatch (err) {\n    // if XMLHttp support is disabled in IE then it will throw\n    // when trying to create\n}\nexport const hasCORS = value;\n","import { Polling } from \"./polling.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { installTimerFunctions, pick } from \"../util.js\";\nimport { globalThisShim as globalThis } from \"../globals.node.js\";\nimport { hasCORS } from \"../contrib/has-cors.js\";\nfunction empty() { }\nexport class BaseXHR extends Polling {\n    /**\n     * XHR Polling constructor.\n     *\n     * @param {Object} opts\n     * @package\n     */\n    constructor(opts) {\n        super(opts);\n        if (typeof location !== \"undefined\") {\n            const isSSL = \"https:\" === location.protocol;\n            let port = location.port;\n            // some user agents have empty `location.port`\n            if (!port) {\n                port = isSSL ? \"443\" : \"80\";\n            }\n            this.xd =\n                (typeof location !== \"undefined\" &&\n                    opts.hostname !== location.hostname) ||\n                    port !== opts.port;\n        }\n    }\n    /**\n     * Sends data.\n     *\n     * @param {String} data to send.\n     * @param {Function} called upon flush.\n     * @private\n     */\n    doWrite(data, fn) {\n        const req = this.request({\n            method: \"POST\",\n            data: data,\n        });\n        req.on(\"success\", fn);\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr post error\", xhrStatus, context);\n        });\n    }\n    /**\n     * Starts a poll cycle.\n     *\n     * @private\n     */\n    doPoll() {\n        const req = this.request();\n        req.on(\"data\", this.onData.bind(this));\n        req.on(\"error\", (xhrStatus, context) => {\n            this.onError(\"xhr poll error\", xhrStatus, context);\n        });\n        this.pollXhr = req;\n    }\n}\nexport class Request extends Emitter {\n    /**\n     * Request constructor\n     *\n     * @param {Object} options\n     * @package\n     */\n    constructor(createRequest, uri, opts) {\n        super();\n        this.createRequest = createRequest;\n        installTimerFunctions(this, opts);\n        this._opts = opts;\n        this._method = opts.method || \"GET\";\n        this._uri = uri;\n        this._data = undefined !== opts.data ? opts.data : null;\n        this._create();\n    }\n    /**\n     * Creates the XHR object and sends the request.\n     *\n     * @private\n     */\n    _create() {\n        var _a;\n        const opts = pick(this._opts, \"agent\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"autoUnref\");\n        opts.xdomain = !!this._opts.xd;\n        const xhr = (this._xhr = this.createRequest(opts));\n        try {\n            xhr.open(this._method, this._uri, true);\n            try {\n                if (this._opts.extraHeaders) {\n                    // @ts-ignore\n                    xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n                    for (let i in this._opts.extraHeaders) {\n                        if (this._opts.extraHeaders.hasOwnProperty(i)) {\n                            xhr.setRequestHeader(i, this._opts.extraHeaders[i]);\n                        }\n                    }\n                }\n            }\n            catch (e) { }\n            if (\"POST\" === this._method) {\n                try {\n                    xhr.setRequestHeader(\"Content-type\", \"text/plain;charset=UTF-8\");\n                }\n                catch (e) { }\n            }\n            try {\n                xhr.setRequestHeader(\"Accept\", \"*/*\");\n            }\n            catch (e) { }\n            (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.addCookies(xhr);\n            // ie6 check\n            if (\"withCredentials\" in xhr) {\n                xhr.withCredentials = this._opts.withCredentials;\n            }\n            if (this._opts.requestTimeout) {\n                xhr.timeout = this._opts.requestTimeout;\n            }\n            xhr.onreadystatechange = () => {\n                var _a;\n                if (xhr.readyState === 3) {\n                    (_a = this._opts.cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(\n                    // @ts-ignore\n                    xhr.getResponseHeader(\"set-cookie\"));\n                }\n                if (4 !== xhr.readyState)\n                    return;\n                if (200 === xhr.status || 1223 === xhr.status) {\n                    this._onLoad();\n                }\n                else {\n                    // make sure the `error` event handler that's user-set\n                    // does not throw in the same tick and gets caught here\n                    this.setTimeoutFn(() => {\n                        this._onError(typeof xhr.status === \"number\" ? xhr.status : 0);\n                    }, 0);\n                }\n            };\n            xhr.send(this._data);\n        }\n        catch (e) {\n            // Need to defer since .create() is called directly from the constructor\n            // and thus the 'error' event can only be only bound *after* this exception\n            // occurs.  Therefore, also, we cannot throw here at all.\n            this.setTimeoutFn(() => {\n                this._onError(e);\n            }, 0);\n            return;\n        }\n        if (typeof document !== \"undefined\") {\n            this._index = Request.requestsCount++;\n            Request.requests[this._index] = this;\n        }\n    }\n    /**\n     * Called upon error.\n     *\n     * @private\n     */\n    _onError(err) {\n        this.emitReserved(\"error\", err, this._xhr);\n        this._cleanup(true);\n    }\n    /**\n     * Cleans up house.\n     *\n     * @private\n     */\n    _cleanup(fromError) {\n        if (\"undefined\" === typeof this._xhr || null === this._xhr) {\n            return;\n        }\n        this._xhr.onreadystatechange = empty;\n        if (fromError) {\n            try {\n                this._xhr.abort();\n            }\n            catch (e) { }\n        }\n        if (typeof document !== \"undefined\") {\n            delete Request.requests[this._index];\n        }\n        this._xhr = null;\n    }\n    /**\n     * Called upon load.\n     *\n     * @private\n     */\n    _onLoad() {\n        const data = this._xhr.responseText;\n        if (data !== null) {\n            this.emitReserved(\"data\", data);\n            this.emitReserved(\"success\");\n            this._cleanup();\n        }\n    }\n    /**\n     * Aborts the request.\n     *\n     * @package\n     */\n    abort() {\n        this._cleanup();\n    }\n}\nRequest.requestsCount = 0;\nRequest.requests = {};\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\nif (typeof document !== \"undefined\") {\n    // @ts-ignore\n    if (typeof attachEvent === \"function\") {\n        // @ts-ignore\n        attachEvent(\"onunload\", unloadHandler);\n    }\n    else if (typeof addEventListener === \"function\") {\n        const terminationEvent = \"onpagehide\" in globalThis ? \"pagehide\" : \"unload\";\n        addEventListener(terminationEvent, unloadHandler, false);\n    }\n}\nfunction unloadHandler() {\n    for (let i in Request.requests) {\n        if (Request.requests.hasOwnProperty(i)) {\n            Request.requests[i].abort();\n        }\n    }\n}\nconst hasXHR2 = (function () {\n    const xhr = newRequest({\n        xdomain: false,\n    });\n    return xhr && xhr.responseType !== null;\n})();\n/**\n * HTTP long-polling based on the built-in `XMLHttpRequest` object.\n *\n * Usage: browser\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n */\nexport class XHR extends BaseXHR {\n    constructor(opts) {\n        super(opts);\n        const forceBase64 = opts && opts.forceBase64;\n        this.supportsBinary = hasXHR2 && !forceBase64;\n    }\n    request(opts = {}) {\n        Object.assign(opts, { xd: this.xd }, this.opts);\n        return new Request(newRequest, this.uri(), opts);\n    }\n}\nfunction newRequest(opts) {\n    const xdomain = opts.xdomain;\n    // XMLHttpRequest can be disabled on IE\n    try {\n        if (\"undefined\" !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n            return new XMLHttpRequest();\n        }\n    }\n    catch (e) { }\n    if (!xdomain) {\n        try {\n            return new globalThis[[\"Active\"].concat(\"Object\").join(\"X\")](\"Microsoft.XMLHTTP\");\n        }\n        catch (e) { }\n    }\n}\n","import { Transport } from \"../transport.js\";\nimport { pick, randomString } from \"../util.js\";\nimport { encodePacket } from \"engine.io-parser\";\nimport { globalThisShim as globalThis, nextTick } from \"../globals.node.js\";\n// detect ReactNative environment\nconst isReactNative = typeof navigator !== \"undefined\" &&\n    typeof navigator.product === \"string\" &&\n    navigator.product.toLowerCase() === \"reactnative\";\nexport class BaseWS extends Transport {\n    get name() {\n        return \"websocket\";\n    }\n    doOpen() {\n        const uri = this.uri();\n        const protocols = this.opts.protocols;\n        // React Native only supports the 'headers' option, and will print a warning if anything else is passed\n        const opts = isReactNative\n            ? {}\n            : pick(this.opts, \"agent\", \"perMessageDeflate\", \"pfx\", \"key\", \"passphrase\", \"cert\", \"ca\", \"ciphers\", \"rejectUnauthorized\", \"localAddress\", \"protocolVersion\", \"origin\", \"maxPayload\", \"family\", \"checkServerIdentity\");\n        if (this.opts.extraHeaders) {\n            opts.headers = this.opts.extraHeaders;\n        }\n        try {\n            this.ws = this.createSocket(uri, protocols, opts);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this.ws.binaryType = this.socket.binaryType;\n        this.addEventListeners();\n    }\n    /**\n     * Adds event listeners to the socket\n     *\n     * @private\n     */\n    addEventListeners() {\n        this.ws.onopen = () => {\n            if (this.opts.autoUnref) {\n                this.ws._socket.unref();\n            }\n            this.onOpen();\n        };\n        this.ws.onclose = (closeEvent) => this.onClose({\n            description: \"websocket connection closed\",\n            context: closeEvent,\n        });\n        this.ws.onmessage = (ev) => this.onData(ev.data);\n        this.ws.onerror = (e) => this.onError(\"websocket error\", e);\n    }\n    write(packets) {\n        this.writable = false;\n        // encodePacket efficient as it uses WS framing\n        // no need for encodePayload\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            encodePacket(packet, this.supportsBinary, (data) => {\n                // Sometimes the websocket has already been closed but the browser didn't\n                // have a chance of informing us about it yet, in that case send will\n                // throw an error\n                try {\n                    this.doWrite(packet, data);\n                }\n                catch (e) {\n                }\n                if (lastPacket) {\n                    // fake drain\n                    // defer to next tick to allow Socket to clear writeBuffer\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        if (typeof this.ws !== \"undefined\") {\n            this.ws.onerror = () => { };\n            this.ws.close();\n            this.ws = null;\n        }\n    }\n    /**\n     * Generates uri for connection.\n     *\n     * @private\n     */\n    uri() {\n        const schema = this.opts.secure ? \"wss\" : \"ws\";\n        const query = this.query || {};\n        // append timestamp to URI\n        if (this.opts.timestampRequests) {\n            query[this.opts.timestampParam] = randomString();\n        }\n        // communicate binary support capabilities\n        if (!this.supportsBinary) {\n            query.b64 = 1;\n        }\n        return this.createUri(schema, query);\n    }\n}\nconst WebSocketCtor = globalThis.WebSocket || globalThis.MozWebSocket;\n/**\n * WebSocket transport based on the built-in `WebSocket` object.\n *\n * Usage: browser, Node.js (since v21), Deno, Bun\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket\n * @see https://caniuse.com/mdn-api_websocket\n * @see https://nodejs.org/api/globals.html#websocket\n */\nexport class WS extends BaseWS {\n    createSocket(uri, protocols, opts) {\n        return !isReactNative\n            ? protocols\n                ? new WebSocketCtor(uri, protocols)\n                : new WebSocketCtor(uri)\n            : new WebSocketCtor(uri, protocols, opts);\n    }\n    doWrite(_packet, data) {\n        this.ws.send(data);\n    }\n}\n","import { XHR } from \"./polling-xhr.node.js\";\nimport { WS } from \"./websocket.node.js\";\nimport { WT } from \"./webtransport.js\";\nexport const transports = {\n    websocket: WS,\n    webtransport: WT,\n    polling: XHR,\n};\n","import { Transport } from \"../transport.js\";\nimport { nextTick } from \"../globals.node.js\";\nimport { createPacketDecoderStream, createPacketEncoderStream, } from \"engine.io-parser\";\n/**\n * WebTransport transport based on the built-in `WebTransport` object.\n *\n * Usage: browser, Node.js (with the `@fails-components/webtransport` package)\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/WebTransport\n * @see https://caniuse.com/webtransport\n */\nexport class WT extends Transport {\n    get name() {\n        return \"webtransport\";\n    }\n    doOpen() {\n        try {\n            // @ts-ignore\n            this._transport = new WebTransport(this.createUri(\"https\"), this.opts.transportOptions[this.name]);\n        }\n        catch (err) {\n            return this.emitReserved(\"error\", err);\n        }\n        this._transport.closed\n            .then(() => {\n            this.onClose();\n        })\n            .catch((err) => {\n            this.onError(\"webtransport error\", err);\n        });\n        // note: we could have used async/await, but that would require some additional polyfills\n        this._transport.ready.then(() => {\n            this._transport.createBidirectionalStream().then((stream) => {\n                const decoderStream = createPacketDecoderStream(Number.MAX_SAFE_INTEGER, this.socket.binaryType);\n                const reader = stream.readable.pipeThrough(decoderStream).getReader();\n                const encoderStream = createPacketEncoderStream();\n                encoderStream.readable.pipeTo(stream.writable);\n                this._writer = encoderStream.writable.getWriter();\n                const read = () => {\n                    reader\n                        .read()\n                        .then(({ done, value }) => {\n                        if (done) {\n                            return;\n                        }\n                        this.onPacket(value);\n                        read();\n                    })\n                        .catch((err) => {\n                    });\n                };\n                read();\n                const packet = { type: \"open\" };\n                if (this.query.sid) {\n                    packet.data = `{\"sid\":\"${this.query.sid}\"}`;\n                }\n                this._writer.write(packet).then(() => this.onOpen());\n            });\n        });\n    }\n    write(packets) {\n        this.writable = false;\n        for (let i = 0; i < packets.length; i++) {\n            const packet = packets[i];\n            const lastPacket = i === packets.length - 1;\n            this._writer.write(packet).then(() => {\n                if (lastPacket) {\n                    nextTick(() => {\n                        this.writable = true;\n                        this.emitReserved(\"drain\");\n                    }, this.setTimeoutFn);\n                }\n            });\n        }\n    }\n    doClose() {\n        var _a;\n        (_a = this._transport) === null || _a === void 0 ? void 0 : _a.close();\n    }\n}\n","// imported from https://github.com/galkn/parseuri\n/**\n * Parses a URI\n *\n * Note: we could also have used the built-in URL object, but it isn't supported on all platforms.\n *\n * See:\n * - https://developer.mozilla.org/en-US/docs/Web/API/URL\n * - https://caniuse.com/url\n * - https://www.rfc-editor.org/rfc/rfc3986#appendix-B\n *\n * History of the parse() method:\n * - first commit: https://github.com/socketio/socket.io-client/commit/4ee1d5d94b3906a9c052b459f1a818b15f38f91c\n * - export into its own module: https://github.com/socketio/engine.io-client/commit/de2c561e4564efeb78f1bdb1ba39ef81b2822cb3\n * - reimport: https://github.com/socketio/engine.io-client/commit/df32277c3f6d622eec5ed09f493cae3f3391d242\n *\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\n * @api private\n */\nconst re = /^(?:(?![^:@\\/?#]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@\\/?#]*)(?::([^:@\\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\nconst parts = [\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\n];\nexport function parse(str) {\n    if (str.length > 8000) {\n        throw \"URI too long\";\n    }\n    const src = str, b = str.indexOf('['), e = str.indexOf(']');\n    if (b != -1 && e != -1) {\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\n    }\n    let m = re.exec(str || ''), uri = {}, i = 14;\n    while (i--) {\n        uri[parts[i]] = m[i] || '';\n    }\n    if (b != -1 && e != -1) {\n        uri.source = src;\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\n        uri.ipv6uri = true;\n    }\n    uri.pathNames = pathNames(uri, uri['path']);\n    uri.queryKey = queryKey(uri, uri['query']);\n    return uri;\n}\nfunction pathNames(obj, path) {\n    const regx = /\\/{2,9}/g, names = path.replace(regx, \"/\").split(\"/\");\n    if (path.slice(0, 1) == '/' || path.length === 0) {\n        names.splice(0, 1);\n    }\n    if (path.slice(-1) == '/') {\n        names.splice(names.length - 1, 1);\n    }\n    return names;\n}\nfunction queryKey(uri, query) {\n    const data = {};\n    query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g, function ($0, $1, $2) {\n        if ($1) {\n            data[$1] = $2;\n        }\n    });\n    return data;\n}\n","import { transports as DEFAULT_TRANSPORTS } from \"./transports/index.js\";\nimport { installTimerFunctions, byteLength } from \"./util.js\";\nimport { decode } from \"./contrib/parseqs.js\";\nimport { parse } from \"./contrib/parseuri.js\";\nimport { Emitter } from \"@socket.io/component-emitter\";\nimport { protocol } from \"engine.io-parser\";\nimport { createCookieJar, defaultBinaryType, nextTick, } from \"./globals.node.js\";\nconst withEventListeners = typeof addEventListener === \"function\" &&\n    typeof removeEventListener === \"function\";\nconst OFFLINE_EVENT_LISTENERS = [];\nif (withEventListeners) {\n    // within a ServiceWorker, any event handler for the 'offline' event must be added on the initial evaluation of the\n    // script, so we create one single event listener here which will forward the event to the socket instances\n    addEventListener(\"offline\", () => {\n        OFFLINE_EVENT_LISTENERS.forEach((listener) => listener());\n    }, false);\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes without upgrade mechanism, which means that it will keep the first low-level transport that\n * successfully establishes the connection.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithoutUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithoutUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithUpgrade\n * @see Socket\n */\nexport class SocketWithoutUpgrade extends Emitter {\n    /**\n     * Socket constructor.\n     *\n     * @param {String|Object} uri - uri or options\n     * @param {Object} opts - options\n     */\n    constructor(uri, opts) {\n        super();\n        this.binaryType = defaultBinaryType;\n        this.writeBuffer = [];\n        this._prevBufferLen = 0;\n        this._pingInterval = -1;\n        this._pingTimeout = -1;\n        this._maxPayload = -1;\n        /**\n         * The expiration timestamp of the {@link _pingTimeoutTimer} object is tracked, in case the timer is throttled and the\n         * callback is not fired on time. This can happen for example when a laptop is suspended or when a phone is locked.\n         */\n        this._pingTimeoutTime = Infinity;\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = null;\n        }\n        if (uri) {\n            const parsedUri = parse(uri);\n            opts.hostname = parsedUri.host;\n            opts.secure =\n                parsedUri.protocol === \"https\" || parsedUri.protocol === \"wss\";\n            opts.port = parsedUri.port;\n            if (parsedUri.query)\n                opts.query = parsedUri.query;\n        }\n        else if (opts.host) {\n            opts.hostname = parse(opts.host).host;\n        }\n        installTimerFunctions(this, opts);\n        this.secure =\n            null != opts.secure\n                ? opts.secure\n                : typeof location !== \"undefined\" && \"https:\" === location.protocol;\n        if (opts.hostname && !opts.port) {\n            // if no port is specified manually, use the protocol default\n            opts.port = this.secure ? \"443\" : \"80\";\n        }\n        this.hostname =\n            opts.hostname ||\n                (typeof location !== \"undefined\" ? location.hostname : \"localhost\");\n        this.port =\n            opts.port ||\n                (typeof location !== \"undefined\" && location.port\n                    ? location.port\n                    : this.secure\n                        ? \"443\"\n                        : \"80\");\n        this.transports = [];\n        this._transportsByName = {};\n        opts.transports.forEach((t) => {\n            const transportName = t.prototype.name;\n            this.transports.push(transportName);\n            this._transportsByName[transportName] = t;\n        });\n        this.opts = Object.assign({\n            path: \"/engine.io\",\n            agent: false,\n            withCredentials: false,\n            upgrade: true,\n            timestampParam: \"t\",\n            rememberUpgrade: false,\n            addTrailingSlash: true,\n            rejectUnauthorized: true,\n            perMessageDeflate: {\n                threshold: 1024,\n            },\n            transportOptions: {},\n            closeOnBeforeunload: false,\n        }, opts);\n        this.opts.path =\n            this.opts.path.replace(/\\/$/, \"\") +\n                (this.opts.addTrailingSlash ? \"/\" : \"\");\n        if (typeof this.opts.query === \"string\") {\n            this.opts.query = decode(this.opts.query);\n        }\n        if (withEventListeners) {\n            if (this.opts.closeOnBeforeunload) {\n                // Firefox closes the connection when the \"beforeunload\" event is emitted but not Chrome. This event listener\n                // ensures every browser behaves the same (no \"disconnect\" event at the Socket.IO level when the page is\n                // closed/reloaded)\n                this._beforeunloadEventListener = () => {\n                    if (this.transport) {\n                        // silently close the transport\n                        this.transport.removeAllListeners();\n                        this.transport.close();\n                    }\n                };\n                addEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n            }\n            if (this.hostname !== \"localhost\") {\n                this._offlineEventListener = () => {\n                    this._onClose(\"transport close\", {\n                        description: \"network connection lost\",\n                    });\n                };\n                OFFLINE_EVENT_LISTENERS.push(this._offlineEventListener);\n            }\n        }\n        if (this.opts.withCredentials) {\n            this._cookieJar = createCookieJar();\n        }\n        this._open();\n    }\n    /**\n     * Creates transport of the given type.\n     *\n     * @param {String} name - transport name\n     * @return {Transport}\n     * @private\n     */\n    createTransport(name) {\n        const query = Object.assign({}, this.opts.query);\n        // append engine.io protocol identifier\n        query.EIO = protocol;\n        // transport name\n        query.transport = name;\n        // session id if we already have one\n        if (this.id)\n            query.sid = this.id;\n        const opts = Object.assign({}, this.opts, {\n            query,\n            socket: this,\n            hostname: this.hostname,\n            secure: this.secure,\n            port: this.port,\n        }, this.opts.transportOptions[name]);\n        return new this._transportsByName[name](opts);\n    }\n    /**\n     * Initializes transport to use and starts probe.\n     *\n     * @private\n     */\n    _open() {\n        if (this.transports.length === 0) {\n            // Emit error on next tick so it can be listened to\n            this.setTimeoutFn(() => {\n                this.emitReserved(\"error\", \"No transports available\");\n            }, 0);\n            return;\n        }\n        const transportName = this.opts.rememberUpgrade &&\n            SocketWithoutUpgrade.priorWebsocketSuccess &&\n            this.transports.indexOf(\"websocket\") !== -1\n            ? \"websocket\"\n            : this.transports[0];\n        this.readyState = \"opening\";\n        const transport = this.createTransport(transportName);\n        transport.open();\n        this.setTransport(transport);\n    }\n    /**\n     * Sets the current transport. Disables the existing one (if any).\n     *\n     * @private\n     */\n    setTransport(transport) {\n        if (this.transport) {\n            this.transport.removeAllListeners();\n        }\n        // set up transport\n        this.transport = transport;\n        // set up transport listeners\n        transport\n            .on(\"drain\", this._onDrain.bind(this))\n            .on(\"packet\", this._onPacket.bind(this))\n            .on(\"error\", this._onError.bind(this))\n            .on(\"close\", (reason) => this._onClose(\"transport close\", reason));\n    }\n    /**\n     * Called when connection is deemed open.\n     *\n     * @private\n     */\n    onOpen() {\n        this.readyState = \"open\";\n        SocketWithoutUpgrade.priorWebsocketSuccess =\n            \"websocket\" === this.transport.name;\n        this.emitReserved(\"open\");\n        this.flush();\n    }\n    /**\n     * Handles a packet.\n     *\n     * @private\n     */\n    _onPacket(packet) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            this.emitReserved(\"packet\", packet);\n            // Socket is live - any packet counts\n            this.emitReserved(\"heartbeat\");\n            switch (packet.type) {\n                case \"open\":\n                    this.onHandshake(JSON.parse(packet.data));\n                    break;\n                case \"ping\":\n                    this._sendPacket(\"pong\");\n                    this.emitReserved(\"ping\");\n                    this.emitReserved(\"pong\");\n                    this._resetPingTimeout();\n                    break;\n                case \"error\":\n                    const err = new Error(\"server error\");\n                    // @ts-ignore\n                    err.code = packet.data;\n                    this._onError(err);\n                    break;\n                case \"message\":\n                    this.emitReserved(\"data\", packet.data);\n                    this.emitReserved(\"message\", packet.data);\n                    break;\n            }\n        }\n        else {\n        }\n    }\n    /**\n     * Called upon handshake completion.\n     *\n     * @param {Object} data - handshake obj\n     * @private\n     */\n    onHandshake(data) {\n        this.emitReserved(\"handshake\", data);\n        this.id = data.sid;\n        this.transport.query.sid = data.sid;\n        this._pingInterval = data.pingInterval;\n        this._pingTimeout = data.pingTimeout;\n        this._maxPayload = data.maxPayload;\n        this.onOpen();\n        // In case open handler closes socket\n        if (\"closed\" === this.readyState)\n            return;\n        this._resetPingTimeout();\n    }\n    /**\n     * Sets and resets ping timeout timer based on server pings.\n     *\n     * @private\n     */\n    _resetPingTimeout() {\n        this.clearTimeoutFn(this._pingTimeoutTimer);\n        const delay = this._pingInterval + this._pingTimeout;\n        this._pingTimeoutTime = Date.now() + delay;\n        this._pingTimeoutTimer = this.setTimeoutFn(() => {\n            this._onClose(\"ping timeout\");\n        }, delay);\n        if (this.opts.autoUnref) {\n            this._pingTimeoutTimer.unref();\n        }\n    }\n    /**\n     * Called on `drain` event\n     *\n     * @private\n     */\n    _onDrain() {\n        this.writeBuffer.splice(0, this._prevBufferLen);\n        // setting prevBufferLen = 0 is very important\n        // for example, when upgrading, upgrade packet is sent over,\n        // and a nonzero prevBufferLen could cause problems on `drain`\n        this._prevBufferLen = 0;\n        if (0 === this.writeBuffer.length) {\n            this.emitReserved(\"drain\");\n        }\n        else {\n            this.flush();\n        }\n    }\n    /**\n     * Flush write buffers.\n     *\n     * @private\n     */\n    flush() {\n        if (\"closed\" !== this.readyState &&\n            this.transport.writable &&\n            !this.upgrading &&\n            this.writeBuffer.length) {\n            const packets = this._getWritablePackets();\n            this.transport.send(packets);\n            // keep track of current length of writeBuffer\n            // splice writeBuffer and callbackBuffer on `drain`\n            this._prevBufferLen = packets.length;\n            this.emitReserved(\"flush\");\n        }\n    }\n    /**\n     * Ensure the encoded size of the writeBuffer is below the maxPayload value sent by the server (only for HTTP\n     * long-polling)\n     *\n     * @private\n     */\n    _getWritablePackets() {\n        const shouldCheckPayloadSize = this._maxPayload &&\n            this.transport.name === \"polling\" &&\n            this.writeBuffer.length > 1;\n        if (!shouldCheckPayloadSize) {\n            return this.writeBuffer;\n        }\n        let payloadSize = 1; // first packet type\n        for (let i = 0; i < this.writeBuffer.length; i++) {\n            const data = this.writeBuffer[i].data;\n            if (data) {\n                payloadSize += byteLength(data);\n            }\n            if (i > 0 && payloadSize > this._maxPayload) {\n                return this.writeBuffer.slice(0, i);\n            }\n            payloadSize += 2; // separator + packet type\n        }\n        return this.writeBuffer;\n    }\n    /**\n     * Checks whether the heartbeat timer has expired but the socket has not yet been notified.\n     *\n     * Note: this method is private for now because it does not really fit the WebSocket API, but if we put it in the\n     * `write()` method then the message would not be buffered by the Socket.IO client.\n     *\n     * @return {boolean}\n     * @private\n     */\n    /* private */ _hasPingExpired() {\n        if (!this._pingTimeoutTime)\n            return true;\n        const hasExpired = Date.now() > this._pingTimeoutTime;\n        if (hasExpired) {\n            this._pingTimeoutTime = 0;\n            nextTick(() => {\n                this._onClose(\"ping timeout\");\n            }, this.setTimeoutFn);\n        }\n        return hasExpired;\n    }\n    /**\n     * Sends a message.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    write(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a message. Alias of {@link Socket#write}.\n     *\n     * @param {String} msg - message.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @return {Socket} for chaining.\n     */\n    send(msg, options, fn) {\n        this._sendPacket(\"message\", msg, options, fn);\n        return this;\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param {String} type: packet type.\n     * @param {String} data.\n     * @param {Object} options.\n     * @param {Function} fn - callback function.\n     * @private\n     */\n    _sendPacket(type, data, options, fn) {\n        if (\"function\" === typeof data) {\n            fn = data;\n            data = undefined;\n        }\n        if (\"function\" === typeof options) {\n            fn = options;\n            options = null;\n        }\n        if (\"closing\" === this.readyState || \"closed\" === this.readyState) {\n            return;\n        }\n        options = options || {};\n        options.compress = false !== options.compress;\n        const packet = {\n            type: type,\n            data: data,\n            options: options,\n        };\n        this.emitReserved(\"packetCreate\", packet);\n        this.writeBuffer.push(packet);\n        if (fn)\n            this.once(\"flush\", fn);\n        this.flush();\n    }\n    /**\n     * Closes the connection.\n     */\n    close() {\n        const close = () => {\n            this._onClose(\"forced close\");\n            this.transport.close();\n        };\n        const cleanupAndClose = () => {\n            this.off(\"upgrade\", cleanupAndClose);\n            this.off(\"upgradeError\", cleanupAndClose);\n            close();\n        };\n        const waitForUpgrade = () => {\n            // wait for upgrade to finish since we can't send packets while pausing a transport\n            this.once(\"upgrade\", cleanupAndClose);\n            this.once(\"upgradeError\", cleanupAndClose);\n        };\n        if (\"opening\" === this.readyState || \"open\" === this.readyState) {\n            this.readyState = \"closing\";\n            if (this.writeBuffer.length) {\n                this.once(\"drain\", () => {\n                    if (this.upgrading) {\n                        waitForUpgrade();\n                    }\n                    else {\n                        close();\n                    }\n                });\n            }\n            else if (this.upgrading) {\n                waitForUpgrade();\n            }\n            else {\n                close();\n            }\n        }\n        return this;\n    }\n    /**\n     * Called upon transport error\n     *\n     * @private\n     */\n    _onError(err) {\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        if (this.opts.tryAllTransports &&\n            this.transports.length > 1 &&\n            this.readyState === \"opening\") {\n            this.transports.shift();\n            return this._open();\n        }\n        this.emitReserved(\"error\", err);\n        this._onClose(\"transport error\", err);\n    }\n    /**\n     * Called upon transport close.\n     *\n     * @private\n     */\n    _onClose(reason, description) {\n        if (\"opening\" === this.readyState ||\n            \"open\" === this.readyState ||\n            \"closing\" === this.readyState) {\n            // clear timers\n            this.clearTimeoutFn(this._pingTimeoutTimer);\n            // stop event from firing again for transport\n            this.transport.removeAllListeners(\"close\");\n            // ensure transport won't stay open\n            this.transport.close();\n            // ignore further transport communication\n            this.transport.removeAllListeners();\n            if (withEventListeners) {\n                if (this._beforeunloadEventListener) {\n                    removeEventListener(\"beforeunload\", this._beforeunloadEventListener, false);\n                }\n                if (this._offlineEventListener) {\n                    const i = OFFLINE_EVENT_LISTENERS.indexOf(this._offlineEventListener);\n                    if (i !== -1) {\n                        OFFLINE_EVENT_LISTENERS.splice(i, 1);\n                    }\n                }\n            }\n            // set ready state\n            this.readyState = \"closed\";\n            // clear session id\n            this.id = null;\n            // emit close event\n            this.emitReserved(\"close\", reason, description);\n            // clean buffers after, so users can still\n            // grab the buffers on `close` event\n            this.writeBuffer = [];\n            this._prevBufferLen = 0;\n        }\n    }\n}\nSocketWithoutUpgrade.protocol = protocol;\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * In order to allow tree-shaking, there are no transports included, that's why the `transports` option is mandatory.\n *\n * @example\n * import { SocketWithUpgrade, WebSocket } from \"engine.io-client\";\n *\n * const socket = new SocketWithUpgrade({\n *   transports: [WebSocket]\n * });\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see Socket\n */\nexport class SocketWithUpgrade extends SocketWithoutUpgrade {\n    constructor() {\n        super(...arguments);\n        this._upgrades = [];\n    }\n    onOpen() {\n        super.onOpen();\n        if (\"open\" === this.readyState && this.opts.upgrade) {\n            for (let i = 0; i < this._upgrades.length; i++) {\n                this._probe(this._upgrades[i]);\n            }\n        }\n    }\n    /**\n     * Probes a transport.\n     *\n     * @param {String} name - transport name\n     * @private\n     */\n    _probe(name) {\n        let transport = this.createTransport(name);\n        let failed = false;\n        SocketWithoutUpgrade.priorWebsocketSuccess = false;\n        const onTransportOpen = () => {\n            if (failed)\n                return;\n            transport.send([{ type: \"ping\", data: \"probe\" }]);\n            transport.once(\"packet\", (msg) => {\n                if (failed)\n                    return;\n                if (\"pong\" === msg.type && \"probe\" === msg.data) {\n                    this.upgrading = true;\n                    this.emitReserved(\"upgrading\", transport);\n                    if (!transport)\n                        return;\n                    SocketWithoutUpgrade.priorWebsocketSuccess =\n                        \"websocket\" === transport.name;\n                    this.transport.pause(() => {\n                        if (failed)\n                            return;\n                        if (\"closed\" === this.readyState)\n                            return;\n                        cleanup();\n                        this.setTransport(transport);\n                        transport.send([{ type: \"upgrade\" }]);\n                        this.emitReserved(\"upgrade\", transport);\n                        transport = null;\n                        this.upgrading = false;\n                        this.flush();\n                    });\n                }\n                else {\n                    const err = new Error(\"probe error\");\n                    // @ts-ignore\n                    err.transport = transport.name;\n                    this.emitReserved(\"upgradeError\", err);\n                }\n            });\n        };\n        function freezeTransport() {\n            if (failed)\n                return;\n            // Any callback called by transport should be ignored since now\n            failed = true;\n            cleanup();\n            transport.close();\n            transport = null;\n        }\n        // Handle any error that happens while probing\n        const onerror = (err) => {\n            const error = new Error(\"probe error: \" + err);\n            // @ts-ignore\n            error.transport = transport.name;\n            freezeTransport();\n            this.emitReserved(\"upgradeError\", error);\n        };\n        function onTransportClose() {\n            onerror(\"transport closed\");\n        }\n        // When the socket is closed while we're probing\n        function onclose() {\n            onerror(\"socket closed\");\n        }\n        // When the socket is upgraded while we're probing\n        function onupgrade(to) {\n            if (transport && to.name !== transport.name) {\n                freezeTransport();\n            }\n        }\n        // Remove all listeners on the transport and on self\n        const cleanup = () => {\n            transport.removeListener(\"open\", onTransportOpen);\n            transport.removeListener(\"error\", onerror);\n            transport.removeListener(\"close\", onTransportClose);\n            this.off(\"close\", onclose);\n            this.off(\"upgrading\", onupgrade);\n        };\n        transport.once(\"open\", onTransportOpen);\n        transport.once(\"error\", onerror);\n        transport.once(\"close\", onTransportClose);\n        this.once(\"close\", onclose);\n        this.once(\"upgrading\", onupgrade);\n        if (this._upgrades.indexOf(\"webtransport\") !== -1 &&\n            name !== \"webtransport\") {\n            // favor WebTransport\n            this.setTimeoutFn(() => {\n                if (!failed) {\n                    transport.open();\n                }\n            }, 200);\n        }\n        else {\n            transport.open();\n        }\n    }\n    onHandshake(data) {\n        this._upgrades = this._filterUpgrades(data.upgrades);\n        super.onHandshake(data);\n    }\n    /**\n     * Filters upgrades, returning only those matching client transports.\n     *\n     * @param {Array} upgrades - server upgrades\n     * @private\n     */\n    _filterUpgrades(upgrades) {\n        const filteredUpgrades = [];\n        for (let i = 0; i < upgrades.length; i++) {\n            if (~this.transports.indexOf(upgrades[i]))\n                filteredUpgrades.push(upgrades[i]);\n        }\n        return filteredUpgrades;\n    }\n}\n/**\n * This class provides a WebSocket-like interface to connect to an Engine.IO server. The connection will be established\n * with one of the available low-level transports, like HTTP long-polling, WebSocket or WebTransport.\n *\n * This class comes with an upgrade mechanism, which means that once the connection is established with the first\n * low-level transport, it will try to upgrade to a better transport.\n *\n * @example\n * import { Socket } from \"engine.io-client\";\n *\n * const socket = new Socket();\n *\n * socket.on(\"open\", () => {\n *   socket.send(\"hello\");\n * });\n *\n * @see SocketWithoutUpgrade\n * @see SocketWithUpgrade\n */\nexport class Socket extends SocketWithUpgrade {\n    constructor(uri, opts = {}) {\n        const o = typeof uri === \"object\" ? uri : opts;\n        if (!o.transports ||\n            (o.transports && typeof o.transports[0] === \"string\")) {\n            o.transports = (o.transports || [\"polling\", \"websocket\", \"webtransport\"])\n                .map((transportName) => DEFAULT_TRANSPORTS[transportName])\n                .filter((t) => !!t);\n        }\n        super(uri, o);\n    }\n}\n","const withNativeArrayBuffer = typeof ArrayBuffer === \"function\";\nconst isView = (obj) => {\n    return typeof ArrayBuffer.isView === \"function\"\n        ? ArrayBuffer.isView(obj)\n        : obj.buffer instanceof ArrayBuffer;\n};\nconst toString = Object.prototype.toString;\nconst withNativeBlob = typeof Blob === \"function\" ||\n    (typeof Blob !== \"undefined\" &&\n        toString.call(Blob) === \"[object BlobConstructor]\");\nconst withNativeFile = typeof File === \"function\" ||\n    (typeof File !== \"undefined\" &&\n        toString.call(File) === \"[object FileConstructor]\");\n/**\n * Returns true if obj is a Buffer, an ArrayBuffer, a Blob or a File.\n *\n * @private\n */\nexport function isBinary(obj) {\n    return ((withNativeArrayBuffer && (obj instanceof ArrayBuffer || isView(obj))) ||\n        (withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File));\n}\nexport function hasBinary(obj, toJSON) {\n    if (!obj || typeof obj !== \"object\") {\n        return false;\n    }\n    if (Array.isArray(obj)) {\n        for (let i = 0, l = obj.length; i < l; i++) {\n            if (hasBinary(obj[i])) {\n                return true;\n            }\n        }\n        return false;\n    }\n    if (isBinary(obj)) {\n        return true;\n    }\n    if (obj.toJSON &&\n        typeof obj.toJSON === \"function\" &&\n        arguments.length === 1) {\n        return hasBinary(obj.toJSON(), true);\n    }\n    for (const key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n            return true;\n        }\n    }\n    return false;\n}\n","import { isBinary } from \"./is-binary.js\";\n/**\n * Replaces every Buffer | ArrayBuffer | Blob | File in packet with a numbered placeholder.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @public\n */\nexport function deconstructPacket(packet) {\n    const buffers = [];\n    const packetData = packet.data;\n    const pack = packet;\n    pack.data = _deconstructPacket(packetData, buffers);\n    pack.attachments = buffers.length; // number of binary 'attachments'\n    return { packet: pack, buffers: buffers };\n}\nfunction _deconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (isBinary(data)) {\n        const placeholder = { _placeholder: true, num: buffers.length };\n        buffers.push(data);\n        return placeholder;\n    }\n    else if (Array.isArray(data)) {\n        const newData = new Array(data.length);\n        for (let i = 0; i < data.length; i++) {\n            newData[i] = _deconstructPacket(data[i], buffers);\n        }\n        return newData;\n    }\n    else if (typeof data === \"object\" && !(data instanceof Date)) {\n        const newData = {};\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                newData[key] = _deconstructPacket(data[key], buffers);\n            }\n        }\n        return newData;\n    }\n    return data;\n}\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @public\n */\nexport function reconstructPacket(packet, buffers) {\n    packet.data = _reconstructPacket(packet.data, buffers);\n    delete packet.attachments; // no longer useful\n    return packet;\n}\nfunction _reconstructPacket(data, buffers) {\n    if (!data)\n        return data;\n    if (data && data._placeholder === true) {\n        const isIndexValid = typeof data.num === \"number\" &&\n            data.num >= 0 &&\n            data.num < buffers.length;\n        if (isIndexValid) {\n            return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n        }\n        else {\n            throw new Error(\"illegal attachments\");\n        }\n    }\n    else if (Array.isArray(data)) {\n        for (let i = 0; i < data.length; i++) {\n            data[i] = _reconstructPacket(data[i], buffers);\n        }\n    }\n    else if (typeof data === \"object\") {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key)) {\n                data[key] = _reconstructPacket(data[key], buffers);\n            }\n        }\n    }\n    return data;\n}\n","import { Emitter } from \"@socket.io/component-emitter\";\nimport { deconstructPacket, reconstructPacket } from \"./binary.js\";\nimport { isBinary, hasBinary } from \"./is-binary.js\";\n/**\n * These strings must not be used as event names, as they have a special meaning.\n */\nconst RESERVED_EVENTS = [\n    \"connect\", // used on the client side\n    \"connect_error\", // used on the client side\n    \"disconnect\", // used on both sides\n    \"disconnecting\", // used on the server side\n    \"newListener\", // used by the Node.js EventEmitter\n    \"removeListener\", // used by the Node.js EventEmitter\n];\n/**\n * Protocol version.\n *\n * @public\n */\nexport const protocol = 5;\nexport var PacketType;\n(function (PacketType) {\n    PacketType[PacketType[\"CONNECT\"] = 0] = \"CONNECT\";\n    PacketType[PacketType[\"DISCONNECT\"] = 1] = \"DISCONNECT\";\n    PacketType[PacketType[\"EVENT\"] = 2] = \"EVENT\";\n    PacketType[PacketType[\"ACK\"] = 3] = \"ACK\";\n    PacketType[PacketType[\"CONNECT_ERROR\"] = 4] = \"CONNECT_ERROR\";\n    PacketType[PacketType[\"BINARY_EVENT\"] = 5] = \"BINARY_EVENT\";\n    PacketType[PacketType[\"BINARY_ACK\"] = 6] = \"BINARY_ACK\";\n})(PacketType || (PacketType = {}));\n/**\n * A socket.io Encoder instance\n */\nexport class Encoder {\n    /**\n     * Encoder constructor\n     *\n     * @param {function} replacer - custom replacer to pass down to JSON.parse\n     */\n    constructor(replacer) {\n        this.replacer = replacer;\n    }\n    /**\n     * Encode a packet as a single string if non-binary, or as a\n     * buffer sequence, depending on packet type.\n     *\n     * @param {Object} obj - packet object\n     */\n    encode(obj) {\n        if (obj.type === PacketType.EVENT || obj.type === PacketType.ACK) {\n            if (hasBinary(obj)) {\n                return this.encodeAsBinary({\n                    type: obj.type === PacketType.EVENT\n                        ? PacketType.BINARY_EVENT\n                        : PacketType.BINARY_ACK,\n                    nsp: obj.nsp,\n                    data: obj.data,\n                    id: obj.id,\n                });\n            }\n        }\n        return [this.encodeAsString(obj)];\n    }\n    /**\n     * Encode packet as string.\n     */\n    encodeAsString(obj) {\n        // first is type\n        let str = \"\" + obj.type;\n        // attachments if we have them\n        if (obj.type === PacketType.BINARY_EVENT ||\n            obj.type === PacketType.BINARY_ACK) {\n            str += obj.attachments + \"-\";\n        }\n        // if we have a namespace other than `/`\n        // we append it followed by a comma `,`\n        if (obj.nsp && \"/\" !== obj.nsp) {\n            str += obj.nsp + \",\";\n        }\n        // immediately followed by the id\n        if (null != obj.id) {\n            str += obj.id;\n        }\n        // json data\n        if (null != obj.data) {\n            str += JSON.stringify(obj.data, this.replacer);\n        }\n        return str;\n    }\n    /**\n     * Encode packet as 'buffer sequence' by removing blobs, and\n     * deconstructing packet into object with placeholders and\n     * a list of buffers.\n     */\n    encodeAsBinary(obj) {\n        const deconstruction = deconstructPacket(obj);\n        const pack = this.encodeAsString(deconstruction.packet);\n        const buffers = deconstruction.buffers;\n        buffers.unshift(pack); // add packet info to beginning of data list\n        return buffers; // write all the buffers\n    }\n}\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n */\nexport class Decoder extends Emitter {\n    /**\n     * Decoder constructor\n     *\n     * @param {function} reviver - custom reviver to pass down to JSON.stringify\n     */\n    constructor(reviver) {\n        super();\n        this.reviver = reviver;\n    }\n    /**\n     * Decodes an encoded packet string into packet JSON.\n     *\n     * @param {String} obj - encoded packet\n     */\n    add(obj) {\n        let packet;\n        if (typeof obj === \"string\") {\n            if (this.reconstructor) {\n                throw new Error(\"got plaintext data when reconstructing a packet\");\n            }\n            packet = this.decodeString(obj);\n            const isBinaryEvent = packet.type === PacketType.BINARY_EVENT;\n            if (isBinaryEvent || packet.type === PacketType.BINARY_ACK) {\n                packet.type = isBinaryEvent ? PacketType.EVENT : PacketType.ACK;\n                // binary packet's json\n                this.reconstructor = new BinaryReconstructor(packet);\n                // no attachments, labeled binary but no binary data to follow\n                if (packet.attachments === 0) {\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n            else {\n                // non-binary full packet\n                super.emitReserved(\"decoded\", packet);\n            }\n        }\n        else if (isBinary(obj) || obj.base64) {\n            // raw binary data\n            if (!this.reconstructor) {\n                throw new Error(\"got binary data when not reconstructing a packet\");\n            }\n            else {\n                packet = this.reconstructor.takeBinaryData(obj);\n                if (packet) {\n                    // received final buffer\n                    this.reconstructor = null;\n                    super.emitReserved(\"decoded\", packet);\n                }\n            }\n        }\n        else {\n            throw new Error(\"Unknown type: \" + obj);\n        }\n    }\n    /**\n     * Decode a packet String (JSON data)\n     *\n     * @param {String} str\n     * @return {Object} packet\n     */\n    decodeString(str) {\n        let i = 0;\n        // look up type\n        const p = {\n            type: Number(str.charAt(0)),\n        };\n        if (PacketType[p.type] === undefined) {\n            throw new Error(\"unknown packet type \" + p.type);\n        }\n        // look up attachments if type binary\n        if (p.type === PacketType.BINARY_EVENT ||\n            p.type === PacketType.BINARY_ACK) {\n            const start = i + 1;\n            while (str.charAt(++i) !== \"-\" && i != str.length) { }\n            const buf = str.substring(start, i);\n            if (buf != Number(buf) || str.charAt(i) !== \"-\") {\n                throw new Error(\"Illegal attachments\");\n            }\n            p.attachments = Number(buf);\n        }\n        // look up namespace (if any)\n        if (\"/\" === str.charAt(i + 1)) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (\",\" === c)\n                    break;\n                if (i === str.length)\n                    break;\n            }\n            p.nsp = str.substring(start, i);\n        }\n        else {\n            p.nsp = \"/\";\n        }\n        // look up id\n        const next = str.charAt(i + 1);\n        if (\"\" !== next && Number(next) == next) {\n            const start = i + 1;\n            while (++i) {\n                const c = str.charAt(i);\n                if (null == c || Number(c) != c) {\n                    --i;\n                    break;\n                }\n                if (i === str.length)\n                    break;\n            }\n            p.id = Number(str.substring(start, i + 1));\n        }\n        // look up json data\n        if (str.charAt(++i)) {\n            const payload = this.tryParse(str.substr(i));\n            if (Decoder.isPayloadValid(p.type, payload)) {\n                p.data = payload;\n            }\n            else {\n                throw new Error(\"invalid payload\");\n            }\n        }\n        return p;\n    }\n    tryParse(str) {\n        try {\n            return JSON.parse(str, this.reviver);\n        }\n        catch (e) {\n            return false;\n        }\n    }\n    static isPayloadValid(type, payload) {\n        switch (type) {\n            case PacketType.CONNECT:\n                return isObject(payload);\n            case PacketType.DISCONNECT:\n                return payload === undefined;\n            case PacketType.CONNECT_ERROR:\n                return typeof payload === \"string\" || isObject(payload);\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                return (Array.isArray(payload) &&\n                    (typeof payload[0] === \"number\" ||\n                        (typeof payload[0] === \"string\" &&\n                            RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                return Array.isArray(payload);\n        }\n    }\n    /**\n     * Deallocates a parser's resources\n     */\n    destroy() {\n        if (this.reconstructor) {\n            this.reconstructor.finishedReconstruction();\n            this.reconstructor = null;\n        }\n    }\n}\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n */\nclass BinaryReconstructor {\n    constructor(packet) {\n        this.packet = packet;\n        this.buffers = [];\n        this.reconPack = packet;\n    }\n    /**\n     * Method to be called when binary data received from connection\n     * after a BINARY_EVENT packet.\n     *\n     * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n     * @return {null | Object} returns null if more binary data is expected or\n     *   a reconstructed packet object if all buffers have been received.\n     */\n    takeBinaryData(binData) {\n        this.buffers.push(binData);\n        if (this.buffers.length === this.reconPack.attachments) {\n            // done with buffer list\n            const packet = reconstructPacket(this.reconPack, this.buffers);\n            this.finishedReconstruction();\n            return packet;\n        }\n        return null;\n    }\n    /**\n     * Cleans up binary packet reconstruction variables.\n     */\n    finishedReconstruction() {\n        this.reconPack = null;\n        this.buffers = [];\n    }\n}\nfunction isNamespaceValid(nsp) {\n    return typeof nsp === \"string\";\n}\n// see https://caniuse.com/mdn-javascript_builtins_number_isinteger\nconst isInteger = Number.isInteger ||\n    function (value) {\n        return (typeof value === \"number\" &&\n            isFinite(value) &&\n            Math.floor(value) === value);\n    };\nfunction isAckIdValid(id) {\n    return id === undefined || isInteger(id);\n}\n// see https://stackoverflow.com/questions/8511281/check-if-a-value-is-an-object-in-javascript\nfunction isObject(value) {\n    return Object.prototype.toString.call(value) === \"[object Object]\";\n}\nfunction isDataValid(type, payload) {\n    switch (type) {\n        case PacketType.CONNECT:\n            return payload === undefined || isObject(payload);\n        case PacketType.DISCONNECT:\n            return payload === undefined;\n        case PacketType.EVENT:\n            return (Array.isArray(payload) &&\n                (typeof payload[0] === \"number\" ||\n                    (typeof payload[0] === \"string\" &&\n                        RESERVED_EVENTS.indexOf(payload[0]) === -1)));\n        case PacketType.ACK:\n            return Array.isArray(payload);\n        case PacketType.CONNECT_ERROR:\n            return typeof payload === \"string\" || isObject(payload);\n        default:\n            return false;\n    }\n}\nexport function isPacketValid(packet) {\n    return (isNamespaceValid(packet.nsp) &&\n        isAckIdValid(packet.id) &&\n        isDataValid(packet.type, packet.data));\n}\n","export function on(obj, ev, fn) {\n    obj.on(ev, fn);\n    return function subDestroy() {\n        obj.off(ev, fn);\n    };\n}\n","import { PacketType } from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\n/**\n * Internal events.\n * These events can't be emitted by the user.\n */\nconst RESERVED_EVENTS = Object.freeze({\n    connect: 1,\n    connect_error: 1,\n    disconnect: 1,\n    disconnecting: 1,\n    // EventEmitter reserved events: https://nodejs.org/api/events.html#events_event_newlistener\n    newListener: 1,\n    removeListener: 1,\n});\n/**\n * A Socket is the fundamental class for interacting with the server.\n *\n * A Socket belongs to a certain Namespace (by default /) and uses an underlying {@link Manager} to communicate.\n *\n * @example\n * const socket = io();\n *\n * socket.on(\"connect\", () => {\n *   console.log(\"connected\");\n * });\n *\n * // send an event to the server\n * socket.emit(\"foo\", \"bar\");\n *\n * socket.on(\"foobar\", () => {\n *   // an event was received from the server\n * });\n *\n * // upon disconnection\n * socket.on(\"disconnect\", (reason) => {\n *   console.log(`disconnected due to ${reason}`);\n * });\n */\nexport class Socket extends Emitter {\n    /**\n     * `Socket` constructor.\n     */\n    constructor(io, nsp, opts) {\n        super();\n        /**\n         * Whether the socket is currently connected to the server.\n         *\n         * @example\n         * const socket = io();\n         *\n         * socket.on(\"connect\", () => {\n         *   console.log(socket.connected); // true\n         * });\n         *\n         * socket.on(\"disconnect\", () => {\n         *   console.log(socket.connected); // false\n         * });\n         */\n        this.connected = false;\n        /**\n         * Whether the connection state was recovered after a temporary disconnection. In that case, any missed packets will\n         * be transmitted by the server.\n         */\n        this.recovered = false;\n        /**\n         * Buffer for packets received before the CONNECT packet\n         */\n        this.receiveBuffer = [];\n        /**\n         * Buffer for packets that will be sent once the socket is connected\n         */\n        this.sendBuffer = [];\n        /**\n         * The queue of packets to be sent with retry in case of failure.\n         *\n         * Packets are sent one by one, each waiting for the server acknowledgement, in order to guarantee the delivery order.\n         * @private\n         */\n        this._queue = [];\n        /**\n         * A sequence to generate the ID of the {@link QueuedPacket}.\n         * @private\n         */\n        this._queueSeq = 0;\n        this.ids = 0;\n        /**\n         * A map containing acknowledgement handlers.\n         *\n         * The `withError` attribute is used to differentiate handlers that accept an error as first argument:\n         *\n         * - `socket.emit(\"test\", (err, value) => { ... })` with `ackTimeout` option\n         * - `socket.timeout(5000).emit(\"test\", (err, value) => { ... })`\n         * - `const value = await socket.emitWithAck(\"test\")`\n         *\n         * From those that don't:\n         *\n         * - `socket.emit(\"test\", (value) => { ... });`\n         *\n         * In the first case, the handlers will be called with an error when:\n         *\n         * - the timeout is reached\n         * - the socket gets disconnected\n         *\n         * In the second case, the handlers will be simply discarded upon disconnection, since the client will never receive\n         * an acknowledgement from the server.\n         *\n         * @private\n         */\n        this.acks = {};\n        this.flags = {};\n        this.io = io;\n        this.nsp = nsp;\n        if (opts && opts.auth) {\n            this.auth = opts.auth;\n        }\n        this._opts = Object.assign({}, opts);\n        if (this.io._autoConnect)\n            this.open();\n    }\n    /**\n     * Whether the socket is currently disconnected\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"connect\", () => {\n     *   console.log(socket.disconnected); // false\n     * });\n     *\n     * socket.on(\"disconnect\", () => {\n     *   console.log(socket.disconnected); // true\n     * });\n     */\n    get disconnected() {\n        return !this.connected;\n    }\n    /**\n     * Subscribe to open, close and packet events\n     *\n     * @private\n     */\n    subEvents() {\n        if (this.subs)\n            return;\n        const io = this.io;\n        this.subs = [\n            on(io, \"open\", this.onopen.bind(this)),\n            on(io, \"packet\", this.onpacket.bind(this)),\n            on(io, \"error\", this.onerror.bind(this)),\n            on(io, \"close\", this.onclose.bind(this)),\n        ];\n    }\n    /**\n     * Whether the Socket will try to reconnect when its Manager connects or reconnects.\n     *\n     * @example\n     * const socket = io();\n     *\n     * console.log(socket.active); // true\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   if (reason === \"io server disconnect\") {\n     *     // the disconnection was initiated by the server, you need to manually reconnect\n     *     console.log(socket.active); // false\n     *   }\n     *   // else the socket will automatically try to reconnect\n     *   console.log(socket.active); // true\n     * });\n     */\n    get active() {\n        return !!this.subs;\n    }\n    /**\n     * \"Opens\" the socket.\n     *\n     * @example\n     * const socket = io({\n     *   autoConnect: false\n     * });\n     *\n     * socket.connect();\n     */\n    connect() {\n        if (this.connected)\n            return this;\n        this.subEvents();\n        if (!this.io[\"_reconnecting\"])\n            this.io.open(); // ensure open\n        if (\"open\" === this.io._readyState)\n            this.onopen();\n        return this;\n    }\n    /**\n     * Alias for {@link connect()}.\n     */\n    open() {\n        return this.connect();\n    }\n    /**\n     * Sends a `message` event.\n     *\n     * This method mimics the WebSocket.send() method.\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send\n     *\n     * @example\n     * socket.send(\"hello\");\n     *\n     * // this is equivalent to\n     * socket.emit(\"message\", \"hello\");\n     *\n     * @return self\n     */\n    send(...args) {\n        args.unshift(\"message\");\n        this.emit.apply(this, args);\n        return this;\n    }\n    /**\n     * Override `emit`.\n     * If the event is in `events`, it's emitted normally.\n     *\n     * @example\n     * socket.emit(\"hello\", \"world\");\n     *\n     * // all serializable datastructures are supported (no need to call JSON.stringify)\n     * socket.emit(\"hello\", 1, \"2\", { 3: [\"4\"], 5: Uint8Array.from([6]) });\n     *\n     * // with an acknowledgement from the server\n     * socket.emit(\"hello\", \"world\", (val) => {\n     *   // ...\n     * });\n     *\n     * @return self\n     */\n    emit(ev, ...args) {\n        var _a, _b, _c;\n        if (RESERVED_EVENTS.hasOwnProperty(ev)) {\n            throw new Error('\"' + ev.toString() + '\" is a reserved event name');\n        }\n        args.unshift(ev);\n        if (this._opts.retries && !this.flags.fromQueue && !this.flags.volatile) {\n            this._addToQueue(args);\n            return this;\n        }\n        const packet = {\n            type: PacketType.EVENT,\n            data: args,\n        };\n        packet.options = {};\n        packet.options.compress = this.flags.compress !== false;\n        // event ack callback\n        if (\"function\" === typeof args[args.length - 1]) {\n            const id = this.ids++;\n            const ack = args.pop();\n            this._registerAckCallback(id, ack);\n            packet.id = id;\n        }\n        const isTransportWritable = (_b = (_a = this.io.engine) === null || _a === void 0 ? void 0 : _a.transport) === null || _b === void 0 ? void 0 : _b.writable;\n        const isConnected = this.connected && !((_c = this.io.engine) === null || _c === void 0 ? void 0 : _c._hasPingExpired());\n        const discardPacket = this.flags.volatile && !isTransportWritable;\n        if (discardPacket) {\n        }\n        else if (isConnected) {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        }\n        else {\n            this.sendBuffer.push(packet);\n        }\n        this.flags = {};\n        return this;\n    }\n    /**\n     * @private\n     */\n    _registerAckCallback(id, ack) {\n        var _a;\n        const timeout = (_a = this.flags.timeout) !== null && _a !== void 0 ? _a : this._opts.ackTimeout;\n        if (timeout === undefined) {\n            this.acks[id] = ack;\n            return;\n        }\n        // @ts-ignore\n        const timer = this.io.setTimeoutFn(() => {\n            delete this.acks[id];\n            for (let i = 0; i < this.sendBuffer.length; i++) {\n                if (this.sendBuffer[i].id === id) {\n                    this.sendBuffer.splice(i, 1);\n                }\n            }\n            ack.call(this, new Error(\"operation has timed out\"));\n        }, timeout);\n        const fn = (...args) => {\n            // @ts-ignore\n            this.io.clearTimeoutFn(timer);\n            ack.apply(this, args);\n        };\n        fn.withError = true;\n        this.acks[id] = fn;\n    }\n    /**\n     * Emits an event and waits for an acknowledgement\n     *\n     * @example\n     * // without timeout\n     * const response = await socket.emitWithAck(\"hello\", \"world\");\n     *\n     * // with a specific timeout\n     * try {\n     *   const response = await socket.timeout(1000).emitWithAck(\"hello\", \"world\");\n     * } catch (err) {\n     *   // the server did not acknowledge the event in the given delay\n     * }\n     *\n     * @return a Promise that will be fulfilled when the server acknowledges the event\n     */\n    emitWithAck(ev, ...args) {\n        return new Promise((resolve, reject) => {\n            const fn = (arg1, arg2) => {\n                return arg1 ? reject(arg1) : resolve(arg2);\n            };\n            fn.withError = true;\n            args.push(fn);\n            this.emit(ev, ...args);\n        });\n    }\n    /**\n     * Add the packet to the queue.\n     * @param args\n     * @private\n     */\n    _addToQueue(args) {\n        let ack;\n        if (typeof args[args.length - 1] === \"function\") {\n            ack = args.pop();\n        }\n        const packet = {\n            id: this._queueSeq++,\n            tryCount: 0,\n            pending: false,\n            args,\n            flags: Object.assign({ fromQueue: true }, this.flags),\n        };\n        args.push((err, ...responseArgs) => {\n            if (packet !== this._queue[0]) {\n            }\n            const hasError = err !== null;\n            if (hasError) {\n                if (packet.tryCount > this._opts.retries) {\n                    this._queue.shift();\n                    if (ack) {\n                        ack(err);\n                    }\n                }\n            }\n            else {\n                this._queue.shift();\n                if (ack) {\n                    ack(null, ...responseArgs);\n                }\n            }\n            packet.pending = false;\n            return this._drainQueue();\n        });\n        this._queue.push(packet);\n        this._drainQueue();\n    }\n    /**\n     * Send the first packet of the queue, and wait for an acknowledgement from the server.\n     * @param force - whether to resend a packet that has not been acknowledged yet\n     *\n     * @private\n     */\n    _drainQueue(force = false) {\n        if (!this.connected || this._queue.length === 0) {\n            return;\n        }\n        const packet = this._queue[0];\n        if (packet.pending && !force) {\n            return;\n        }\n        packet.pending = true;\n        packet.tryCount++;\n        this.flags = packet.flags;\n        this.emit.apply(this, packet.args);\n    }\n    /**\n     * Sends a packet.\n     *\n     * @param packet\n     * @private\n     */\n    packet(packet) {\n        packet.nsp = this.nsp;\n        this.io._packet(packet);\n    }\n    /**\n     * Called upon engine `open`.\n     *\n     * @private\n     */\n    onopen() {\n        if (typeof this.auth == \"function\") {\n            this.auth((data) => {\n                this._sendConnectPacket(data);\n            });\n        }\n        else {\n            this._sendConnectPacket(this.auth);\n        }\n    }\n    /**\n     * Sends a CONNECT packet to initiate the Socket.IO session.\n     *\n     * @param data\n     * @private\n     */\n    _sendConnectPacket(data) {\n        this.packet({\n            type: PacketType.CONNECT,\n            data: this._pid\n                ? Object.assign({ pid: this._pid, offset: this._lastOffset }, data)\n                : data,\n        });\n    }\n    /**\n     * Called upon engine or manager `error`.\n     *\n     * @param err\n     * @private\n     */\n    onerror(err) {\n        if (!this.connected) {\n            this.emitReserved(\"connect_error\", err);\n        }\n    }\n    /**\n     * Called upon engine `close`.\n     *\n     * @param reason\n     * @param description\n     * @private\n     */\n    onclose(reason, description) {\n        this.connected = false;\n        delete this.id;\n        this.emitReserved(\"disconnect\", reason, description);\n        this._clearAcks();\n    }\n    /**\n     * Clears the acknowledgement handlers upon disconnection, since the client will never receive an acknowledgement from\n     * the server.\n     *\n     * @private\n     */\n    _clearAcks() {\n        Object.keys(this.acks).forEach((id) => {\n            const isBuffered = this.sendBuffer.some((packet) => String(packet.id) === id);\n            if (!isBuffered) {\n                // note: handlers that do not accept an error as first argument are ignored here\n                const ack = this.acks[id];\n                delete this.acks[id];\n                if (ack.withError) {\n                    ack.call(this, new Error(\"socket has been disconnected\"));\n                }\n            }\n        });\n    }\n    /**\n     * Called with socket packet.\n     *\n     * @param packet\n     * @private\n     */\n    onpacket(packet) {\n        const sameNamespace = packet.nsp === this.nsp;\n        if (!sameNamespace)\n            return;\n        switch (packet.type) {\n            case PacketType.CONNECT:\n                if (packet.data && packet.data.sid) {\n                    this.onconnect(packet.data.sid, packet.data.pid);\n                }\n                else {\n                    this.emitReserved(\"connect_error\", new Error(\"It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)\"));\n                }\n                break;\n            case PacketType.EVENT:\n            case PacketType.BINARY_EVENT:\n                this.onevent(packet);\n                break;\n            case PacketType.ACK:\n            case PacketType.BINARY_ACK:\n                this.onack(packet);\n                break;\n            case PacketType.DISCONNECT:\n                this.ondisconnect();\n                break;\n            case PacketType.CONNECT_ERROR:\n                this.destroy();\n                const err = new Error(packet.data.message);\n                // @ts-ignore\n                err.data = packet.data.data;\n                this.emitReserved(\"connect_error\", err);\n                break;\n        }\n    }\n    /**\n     * Called upon a server event.\n     *\n     * @param packet\n     * @private\n     */\n    onevent(packet) {\n        const args = packet.data || [];\n        if (null != packet.id) {\n            args.push(this.ack(packet.id));\n        }\n        if (this.connected) {\n            this.emitEvent(args);\n        }\n        else {\n            this.receiveBuffer.push(Object.freeze(args));\n        }\n    }\n    emitEvent(args) {\n        if (this._anyListeners && this._anyListeners.length) {\n            const listeners = this._anyListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, args);\n            }\n        }\n        super.emit.apply(this, args);\n        if (this._pid && args.length && typeof args[args.length - 1] === \"string\") {\n            this._lastOffset = args[args.length - 1];\n        }\n    }\n    /**\n     * Produces an ack callback to emit with an event.\n     *\n     * @private\n     */\n    ack(id) {\n        const self = this;\n        let sent = false;\n        return function (...args) {\n            // prevent double callbacks\n            if (sent)\n                return;\n            sent = true;\n            self.packet({\n                type: PacketType.ACK,\n                id: id,\n                data: args,\n            });\n        };\n    }\n    /**\n     * Called upon a server acknowledgement.\n     *\n     * @param packet\n     * @private\n     */\n    onack(packet) {\n        const ack = this.acks[packet.id];\n        if (typeof ack !== \"function\") {\n            return;\n        }\n        delete this.acks[packet.id];\n        // @ts-ignore FIXME ack is incorrectly inferred as 'never'\n        if (ack.withError) {\n            packet.data.unshift(null);\n        }\n        // @ts-ignore\n        ack.apply(this, packet.data);\n    }\n    /**\n     * Called upon server connect.\n     *\n     * @private\n     */\n    onconnect(id, pid) {\n        this.id = id;\n        this.recovered = pid && this._pid === pid;\n        this._pid = pid; // defined only if connection state recovery is enabled\n        this.connected = true;\n        this.emitBuffered();\n        this._drainQueue(true);\n        this.emitReserved(\"connect\");\n    }\n    /**\n     * Emit buffered events (received and emitted).\n     *\n     * @private\n     */\n    emitBuffered() {\n        this.receiveBuffer.forEach((args) => this.emitEvent(args));\n        this.receiveBuffer = [];\n        this.sendBuffer.forEach((packet) => {\n            this.notifyOutgoingListeners(packet);\n            this.packet(packet);\n        });\n        this.sendBuffer = [];\n    }\n    /**\n     * Called upon server disconnect.\n     *\n     * @private\n     */\n    ondisconnect() {\n        this.destroy();\n        this.onclose(\"io server disconnect\");\n    }\n    /**\n     * Called upon forced client/server side disconnections,\n     * this method ensures the manager stops tracking us and\n     * that reconnections don't get triggered for this.\n     *\n     * @private\n     */\n    destroy() {\n        if (this.subs) {\n            // clean subscriptions to avoid reconnections\n            this.subs.forEach((subDestroy) => subDestroy());\n            this.subs = undefined;\n        }\n        this.io[\"_destroy\"](this);\n    }\n    /**\n     * Disconnects the socket manually. In that case, the socket will not try to reconnect.\n     *\n     * If this is the last active Socket instance of the {@link Manager}, the low-level connection will be closed.\n     *\n     * @example\n     * const socket = io();\n     *\n     * socket.on(\"disconnect\", (reason) => {\n     *   // console.log(reason); prints \"io client disconnect\"\n     * });\n     *\n     * socket.disconnect();\n     *\n     * @return self\n     */\n    disconnect() {\n        if (this.connected) {\n            this.packet({ type: PacketType.DISCONNECT });\n        }\n        // remove socket from pool\n        this.destroy();\n        if (this.connected) {\n            // fire events\n            this.onclose(\"io client disconnect\");\n        }\n        return this;\n    }\n    /**\n     * Alias for {@link disconnect()}.\n     *\n     * @return self\n     */\n    close() {\n        return this.disconnect();\n    }\n    /**\n     * Sets the compress flag.\n     *\n     * @example\n     * socket.compress(false).emit(\"hello\");\n     *\n     * @param compress - if `true`, compresses the sending data\n     * @return self\n     */\n    compress(compress) {\n        this.flags.compress = compress;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the event message will be dropped when this socket is not\n     * ready to send messages.\n     *\n     * @example\n     * socket.volatile.emit(\"hello\"); // the server may or may not receive it\n     *\n     * @returns self\n     */\n    get volatile() {\n        this.flags.volatile = true;\n        return this;\n    }\n    /**\n     * Sets a modifier for a subsequent event emission that the callback will be called with an error when the\n     * given number of milliseconds have elapsed without an acknowledgement from the server:\n     *\n     * @example\n     * socket.timeout(5000).emit(\"my-event\", (err) => {\n     *   if (err) {\n     *     // the server did not acknowledge the event in the given delay\n     *   }\n     * });\n     *\n     * @returns self\n     */\n    timeout(timeout) {\n        this.flags.timeout = timeout;\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * @example\n     * socket.onAny((event, ...args) => {\n     *   console.log(`got ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * @example\n     * socket.prependAny((event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAny(listener) {\n        this._anyListeners = this._anyListeners || [];\n        this._anyListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`got event ${event}`);\n     * }\n     *\n     * socket.onAny(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAny(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAny();\n     *\n     * @param listener\n     */\n    offAny(listener) {\n        if (!this._anyListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAny() {\n        return this._anyListeners || [];\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.onAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    onAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.push(listener);\n        return this;\n    }\n    /**\n     * Adds a listener that will be fired when any event is emitted. The event name is passed as the first argument to the\n     * callback. The listener is added to the beginning of the listeners array.\n     *\n     * Note: acknowledgements sent to the server are not included.\n     *\n     * @example\n     * socket.prependAnyOutgoing((event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * });\n     *\n     * @param listener\n     */\n    prependAnyOutgoing(listener) {\n        this._anyOutgoingListeners = this._anyOutgoingListeners || [];\n        this._anyOutgoingListeners.unshift(listener);\n        return this;\n    }\n    /**\n     * Removes the listener that will be fired when any event is emitted.\n     *\n     * @example\n     * const catchAllListener = (event, ...args) => {\n     *   console.log(`sent event ${event}`);\n     * }\n     *\n     * socket.onAnyOutgoing(catchAllListener);\n     *\n     * // remove a specific listener\n     * socket.offAnyOutgoing(catchAllListener);\n     *\n     * // or remove all listeners\n     * socket.offAnyOutgoing();\n     *\n     * @param [listener] - the catch-all listener (optional)\n     */\n    offAnyOutgoing(listener) {\n        if (!this._anyOutgoingListeners) {\n            return this;\n        }\n        if (listener) {\n            const listeners = this._anyOutgoingListeners;\n            for (let i = 0; i < listeners.length; i++) {\n                if (listener === listeners[i]) {\n                    listeners.splice(i, 1);\n                    return this;\n                }\n            }\n        }\n        else {\n            this._anyOutgoingListeners = [];\n        }\n        return this;\n    }\n    /**\n     * Returns an array of listeners that are listening for any event that is specified. This array can be manipulated,\n     * e.g. to remove listeners.\n     */\n    listenersAnyOutgoing() {\n        return this._anyOutgoingListeners || [];\n    }\n    /**\n     * Notify the listeners for each packet sent\n     *\n     * @param packet\n     *\n     * @private\n     */\n    notifyOutgoingListeners(packet) {\n        if (this._anyOutgoingListeners && this._anyOutgoingListeners.length) {\n            const listeners = this._anyOutgoingListeners.slice();\n            for (const listener of listeners) {\n                listener.apply(this, packet.data);\n            }\n        }\n    }\n}\n","/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\nexport function Backoff(opts) {\n    opts = opts || {};\n    this.ms = opts.min || 100;\n    this.max = opts.max || 10000;\n    this.factor = opts.factor || 2;\n    this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n    this.attempts = 0;\n}\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\nBackoff.prototype.duration = function () {\n    var ms = this.ms * Math.pow(this.factor, this.attempts++);\n    if (this.jitter) {\n        var rand = Math.random();\n        var deviation = Math.floor(rand * this.jitter * ms);\n        ms = (Math.floor(rand * 10) & 1) == 0 ? ms - deviation : ms + deviation;\n    }\n    return Math.min(ms, this.max) | 0;\n};\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\nBackoff.prototype.reset = function () {\n    this.attempts = 0;\n};\n/**\n * Set the minimum duration\n *\n * @api public\n */\nBackoff.prototype.setMin = function (min) {\n    this.ms = min;\n};\n/**\n * Set the maximum duration\n *\n * @api public\n */\nBackoff.prototype.setMax = function (max) {\n    this.max = max;\n};\n/**\n * Set the jitter\n *\n * @api public\n */\nBackoff.prototype.setJitter = function (jitter) {\n    this.jitter = jitter;\n};\n","import { Socket as Engine, installTimerFunctions, nextTick, } from \"engine.io-client\";\nimport { Socket } from \"./socket.js\";\nimport * as parser from \"socket.io-parser\";\nimport { on } from \"./on.js\";\nimport { Backoff } from \"./contrib/backo2.js\";\nimport { Emitter, } from \"@socket.io/component-emitter\";\nexport class Manager extends Emitter {\n    constructor(uri, opts) {\n        var _a;\n        super();\n        this.nsps = {};\n        this.subs = [];\n        if (uri && \"object\" === typeof uri) {\n            opts = uri;\n            uri = undefined;\n        }\n        opts = opts || {};\n        opts.path = opts.path || \"/socket.io\";\n        this.opts = opts;\n        installTimerFunctions(this, opts);\n        this.reconnection(opts.reconnection !== false);\n        this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n        this.reconnectionDelay(opts.reconnectionDelay || 1000);\n        this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n        this.randomizationFactor((_a = opts.randomizationFactor) !== null && _a !== void 0 ? _a : 0.5);\n        this.backoff = new Backoff({\n            min: this.reconnectionDelay(),\n            max: this.reconnectionDelayMax(),\n            jitter: this.randomizationFactor(),\n        });\n        this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n        this._readyState = \"closed\";\n        this.uri = uri;\n        const _parser = opts.parser || parser;\n        this.encoder = new _parser.Encoder();\n        this.decoder = new _parser.Decoder();\n        this._autoConnect = opts.autoConnect !== false;\n        if (this._autoConnect)\n            this.open();\n    }\n    reconnection(v) {\n        if (!arguments.length)\n            return this._reconnection;\n        this._reconnection = !!v;\n        if (!v) {\n            this.skipReconnect = true;\n        }\n        return this;\n    }\n    reconnectionAttempts(v) {\n        if (v === undefined)\n            return this._reconnectionAttempts;\n        this._reconnectionAttempts = v;\n        return this;\n    }\n    reconnectionDelay(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelay;\n        this._reconnectionDelay = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMin(v);\n        return this;\n    }\n    randomizationFactor(v) {\n        var _a;\n        if (v === undefined)\n            return this._randomizationFactor;\n        this._randomizationFactor = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setJitter(v);\n        return this;\n    }\n    reconnectionDelayMax(v) {\n        var _a;\n        if (v === undefined)\n            return this._reconnectionDelayMax;\n        this._reconnectionDelayMax = v;\n        (_a = this.backoff) === null || _a === void 0 ? void 0 : _a.setMax(v);\n        return this;\n    }\n    timeout(v) {\n        if (!arguments.length)\n            return this._timeout;\n        this._timeout = v;\n        return this;\n    }\n    /**\n     * Starts trying to reconnect if reconnection is enabled and we have not\n     * started reconnecting yet\n     *\n     * @private\n     */\n    maybeReconnectOnOpen() {\n        // Only try to reconnect if it's the first time we're connecting\n        if (!this._reconnecting &&\n            this._reconnection &&\n            this.backoff.attempts === 0) {\n            // keeps reconnection from firing twice for the same reconnection loop\n            this.reconnect();\n        }\n    }\n    /**\n     * Sets the current transport `socket`.\n     *\n     * @param {Function} fn - optional, callback\n     * @return self\n     * @public\n     */\n    open(fn) {\n        if (~this._readyState.indexOf(\"open\"))\n            return this;\n        this.engine = new Engine(this.uri, this.opts);\n        const socket = this.engine;\n        const self = this;\n        this._readyState = \"opening\";\n        this.skipReconnect = false;\n        // emit `open`\n        const openSubDestroy = on(socket, \"open\", function () {\n            self.onopen();\n            fn && fn();\n        });\n        const onError = (err) => {\n            this.cleanup();\n            this._readyState = \"closed\";\n            this.emitReserved(\"error\", err);\n            if (fn) {\n                fn(err);\n            }\n            else {\n                // Only do this if there is no fn to handle the error\n                this.maybeReconnectOnOpen();\n            }\n        };\n        // emit `error`\n        const errorSub = on(socket, \"error\", onError);\n        if (false !== this._timeout) {\n            const timeout = this._timeout;\n            // set timer\n            const timer = this.setTimeoutFn(() => {\n                openSubDestroy();\n                onError(new Error(\"timeout\"));\n                socket.close();\n            }, timeout);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n        this.subs.push(openSubDestroy);\n        this.subs.push(errorSub);\n        return this;\n    }\n    /**\n     * Alias for open()\n     *\n     * @return self\n     * @public\n     */\n    connect(fn) {\n        return this.open(fn);\n    }\n    /**\n     * Called upon transport open.\n     *\n     * @private\n     */\n    onopen() {\n        // clear old subs\n        this.cleanup();\n        // mark as open\n        this._readyState = \"open\";\n        this.emitReserved(\"open\");\n        // add new subs\n        const socket = this.engine;\n        this.subs.push(on(socket, \"ping\", this.onping.bind(this)), on(socket, \"data\", this.ondata.bind(this)), on(socket, \"error\", this.onerror.bind(this)), on(socket, \"close\", this.onclose.bind(this)), \n        // @ts-ignore\n        on(this.decoder, \"decoded\", this.ondecoded.bind(this)));\n    }\n    /**\n     * Called upon a ping.\n     *\n     * @private\n     */\n    onping() {\n        this.emitReserved(\"ping\");\n    }\n    /**\n     * Called with data.\n     *\n     * @private\n     */\n    ondata(data) {\n        try {\n            this.decoder.add(data);\n        }\n        catch (e) {\n            this.onclose(\"parse error\", e);\n        }\n    }\n    /**\n     * Called when parser fully decodes a packet.\n     *\n     * @private\n     */\n    ondecoded(packet) {\n        // the nextTick call prevents an exception in a user-provided event listener from triggering a disconnection due to a \"parse error\"\n        nextTick(() => {\n            this.emitReserved(\"packet\", packet);\n        }, this.setTimeoutFn);\n    }\n    /**\n     * Called upon socket error.\n     *\n     * @private\n     */\n    onerror(err) {\n        this.emitReserved(\"error\", err);\n    }\n    /**\n     * Creates a new socket for the given `nsp`.\n     *\n     * @return {Socket}\n     * @public\n     */\n    socket(nsp, opts) {\n        let socket = this.nsps[nsp];\n        if (!socket) {\n            socket = new Socket(this, nsp, opts);\n            this.nsps[nsp] = socket;\n        }\n        else if (this._autoConnect && !socket.active) {\n            socket.connect();\n        }\n        return socket;\n    }\n    /**\n     * Called upon a socket close.\n     *\n     * @param socket\n     * @private\n     */\n    _destroy(socket) {\n        const nsps = Object.keys(this.nsps);\n        for (const nsp of nsps) {\n            const socket = this.nsps[nsp];\n            if (socket.active) {\n                return;\n            }\n        }\n        this._close();\n    }\n    /**\n     * Writes a packet.\n     *\n     * @param packet\n     * @private\n     */\n    _packet(packet) {\n        const encodedPackets = this.encoder.encode(packet);\n        for (let i = 0; i < encodedPackets.length; i++) {\n            this.engine.write(encodedPackets[i], packet.options);\n        }\n    }\n    /**\n     * Clean up transport subscriptions and packet buffer.\n     *\n     * @private\n     */\n    cleanup() {\n        this.subs.forEach((subDestroy) => subDestroy());\n        this.subs.length = 0;\n        this.decoder.destroy();\n    }\n    /**\n     * Close the current socket.\n     *\n     * @private\n     */\n    _close() {\n        this.skipReconnect = true;\n        this._reconnecting = false;\n        this.onclose(\"forced close\");\n    }\n    /**\n     * Alias for close()\n     *\n     * @private\n     */\n    disconnect() {\n        return this._close();\n    }\n    /**\n     * Called when:\n     *\n     * - the low-level engine is closed\n     * - the parser encountered a badly formatted packet\n     * - all sockets are disconnected\n     *\n     * @private\n     */\n    onclose(reason, description) {\n        var _a;\n        this.cleanup();\n        (_a = this.engine) === null || _a === void 0 ? void 0 : _a.close();\n        this.backoff.reset();\n        this._readyState = \"closed\";\n        this.emitReserved(\"close\", reason, description);\n        if (this._reconnection && !this.skipReconnect) {\n            this.reconnect();\n        }\n    }\n    /**\n     * Attempt a reconnection.\n     *\n     * @private\n     */\n    reconnect() {\n        if (this._reconnecting || this.skipReconnect)\n            return this;\n        const self = this;\n        if (this.backoff.attempts >= this._reconnectionAttempts) {\n            this.backoff.reset();\n            this.emitReserved(\"reconnect_failed\");\n            this._reconnecting = false;\n        }\n        else {\n            const delay = this.backoff.duration();\n            this._reconnecting = true;\n            const timer = this.setTimeoutFn(() => {\n                if (self.skipReconnect)\n                    return;\n                this.emitReserved(\"reconnect_attempt\", self.backoff.attempts);\n                // check again for the case socket closed in above events\n                if (self.skipReconnect)\n                    return;\n                self.open((err) => {\n                    if (err) {\n                        self._reconnecting = false;\n                        self.reconnect();\n                        this.emitReserved(\"reconnect_error\", err);\n                    }\n                    else {\n                        self.onreconnect();\n                    }\n                });\n            }, delay);\n            if (this.opts.autoUnref) {\n                timer.unref();\n            }\n            this.subs.push(() => {\n                this.clearTimeoutFn(timer);\n            });\n        }\n    }\n    /**\n     * Called upon successful reconnect.\n     *\n     * @private\n     */\n    onreconnect() {\n        const attempt = this.backoff.attempts;\n        this._reconnecting = false;\n        this.backoff.reset();\n        this.emitReserved(\"reconnect\", attempt);\n    }\n}\n","import { url } from \"./url.js\";\nimport { Manager } from \"./manager.js\";\nimport { Socket } from \"./socket.js\";\n/**\n * Managers cache.\n */\nconst cache = {};\nfunction lookup(uri, opts) {\n    if (typeof uri === \"object\") {\n        opts = uri;\n        uri = undefined;\n    }\n    opts = opts || {};\n    const parsed = url(uri, opts.path || \"/socket.io\");\n    const source = parsed.source;\n    const id = parsed.id;\n    const path = parsed.path;\n    const sameNamespace = cache[id] && path in cache[id][\"nsps\"];\n    const newConnection = opts.forceNew ||\n        opts[\"force new connection\"] ||\n        false === opts.multiplex ||\n        sameNamespace;\n    let io;\n    if (newConnection) {\n        io = new Manager(source, opts);\n    }\n    else {\n        if (!cache[id]) {\n            cache[id] = new Manager(source, opts);\n        }\n        io = cache[id];\n    }\n    if (parsed.query && !opts.query) {\n        opts.query = parsed.queryKey;\n    }\n    return io.socket(parsed.path, opts);\n}\n// so that \"lookup\" can be used both as a function (e.g. `io(...)`) and as a\n// namespace (e.g. `io.connect(...)`), for backward compatibility\nObject.assign(lookup, {\n    Manager,\n    Socket,\n    io: lookup,\n    connect: lookup,\n});\n/**\n * Protocol version.\n *\n * @public\n */\nexport { protocol } from \"socket.io-parser\";\n/**\n * Expose constructors for standalone build.\n *\n * @public\n */\nexport { Manager, Socket, lookup as io, lookup as connect, lookup as default, };\nexport { Fetch, NodeXHR, XHR, NodeWebSocket, WebSocket, WebTransport, } from \"engine.io-client\";\n","import { parse } from \"engine.io-client\";\n/**\n * URL parser.\n *\n * @param uri - url\n * @param path - the request path of the connection\n * @param loc - An object meant to mimic window.location.\n *        Defaults to window.location.\n * @public\n */\nexport function url(uri, path = \"\", loc) {\n    let obj = uri;\n    // default to window.location\n    loc = loc || (typeof location !== \"undefined\" && location);\n    if (null == uri)\n        uri = loc.protocol + \"//\" + loc.host;\n    // relative path support\n    if (typeof uri === \"string\") {\n        if (\"/\" === uri.charAt(0)) {\n            if (\"/\" === uri.charAt(1)) {\n                uri = loc.protocol + uri;\n            }\n            else {\n                uri = loc.host + uri;\n            }\n        }\n        if (!/^(https?|wss?):\\/\\//.test(uri)) {\n            if (\"undefined\" !== typeof loc) {\n                uri = loc.protocol + \"//\" + uri;\n            }\n            else {\n                uri = \"https://\" + uri;\n            }\n        }\n        // parse\n        obj = parse(uri);\n    }\n    // make sure we treat `localhost:80` and `localhost` equally\n    if (!obj.port) {\n        if (/^(http|ws)$/.test(obj.protocol)) {\n            obj.port = \"80\";\n        }\n        else if (/^(http|ws)s$/.test(obj.protocol)) {\n            obj.port = \"443\";\n        }\n    }\n    obj.path = obj.path || \"/\";\n    const ipv6 = obj.host.indexOf(\":\") !== -1;\n    const host = ipv6 ? \"[\" + obj.host + \"]\" : obj.host;\n    // define unique id\n    obj.id = obj.protocol + \"://\" + host + \":\" + obj.port + path;\n    // define href\n    obj.href =\n        obj.protocol +\n            \"://\" +\n            host +\n            (loc && loc.port === obj.port ? \"\" : \":\" + obj.port);\n    return obj;\n}\n","/**\n * Validation utilities for MCP tools\n */\n\nexport class ValidationError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = 'ValidationError';\n  }\n}\n\n/**\n * Validate chat_id or user_id parameter\n * Supports integer IDs, string IDs, and usernames\n */\nexport function validateId(\n  value: unknown,\n  paramName: string,\n): number | string {\n  if (typeof value === 'number') {\n    if (!Number.isInteger(value) || value < -(2 ** 63) || value > 2 ** 63 - 1) {\n      throw new ValidationError(\n        `Invalid ${paramName}: ${value}. ID is out of the valid integer range.`,\n      );\n    }\n    return value;\n  }\n\n  if (typeof value === 'string') {\n    // Try to parse as integer\n    const intValue = Number.parseInt(value, 10);\n    if (!Number.isNaN(intValue) && Number.isFinite(intValue)) {\n      if (intValue < -(2 ** 63) || intValue > 2 ** 63 - 1) {\n        throw new ValidationError(\n          `Invalid ${paramName}: ${value}. ID is out of the valid integer range.`,\n        );\n      }\n      return intValue;\n    }\n\n    // Check if it's a valid username format\n    if (/^@?[a-zA-Z0-9_]{5,}$/.test(value)) {\n      return value.startsWith('@') ? value : `@${value}`;\n    }\n\n    throw new ValidationError(\n      `Invalid ${paramName}: '${value}'. Must be a valid integer ID or a username string.`,\n    );\n  }\n\n  throw new ValidationError(\n    `Invalid ${paramName}: ${value}. Type must be an integer or a string.`,\n  );\n}\n\n/**\n * Validate list of IDs\n */\nexport function validateIdList(\n  value: unknown,\n  paramName: string,\n): Array<number | string> {\n  if (!Array.isArray(value)) {\n    throw new ValidationError(\n      `Invalid ${paramName}: must be an array of IDs.`,\n    );\n  }\n\n  return value.map((item: unknown, index: number) => {\n    try {\n      return validateId(item, `${paramName}[${index}]`);\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        throw error;\n      }\n      if (error instanceof ValidationError) {\n        throw error;\n      }\n      const errorMsg = error instanceof Error ? error.message : String(error);\n      const errorText = `Invalid ${paramName}[${index}]: ${errorMsg}`;\n      throw new ValidationError(errorText);\n    }\n  });\n}\n\n/**\n * Validate optional ID (can be undefined)\n */\nexport function validateOptionalId(\n  value: unknown,\n  paramName: string,\n): number | string | undefined {\n  if (value === undefined || value === null) {\n    return undefined;\n  }\n  return validateId(value, paramName);\n}\n","/**\n * Error handling utilities for MCP server\n */\n\nimport type { MCPToolResult } from './types';\n\nimport { ValidationError } from './validation';\n\nexport enum ErrorCategory {\n  CHAT = 'CHAT',\n  MSG = 'MSG',\n  CONTACT = 'CONTACT',\n  GROUP = 'GROUP',\n  MEDIA = 'MEDIA',\n  PROFILE = 'PROFILE',\n  AUTH = 'AUTH',\n  ADMIN = 'ADMIN',\n  VALIDATION = 'VALIDATION',\n  SEARCH = 'SEARCH',\n  DRAFT = 'DRAFT',\n}\n\n/**\n * Generate error code from function name and category\n */\nfunction generateErrorCode(\n  functionName: string,\n  category?: ErrorCategory | string,\n): string {\n  if (category === 'VALIDATION-001' || category === ErrorCategory.VALIDATION) {\n    return 'VALIDATION-001';\n  }\n\n  const prefix = category\n    ? typeof category === 'string' && category.startsWith('VALIDATION')\n      ? category\n      : category\n    : 'GEN';\n\n  const hash = Math.abs(\n    functionName.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0),\n  ) % 1000;\n\n  return `${prefix}-ERR-${hash.toString().padStart(3, '0')}`;\n}\n\n/**\n * Log and format error for MCP response\n */\nexport function logAndFormatError(\n  functionName: string,\n  error: Error,\n  category?: ErrorCategory | string,\n  context?: Record<string, unknown>,\n): MCPToolResult {\n  const errorCode = generateErrorCode(functionName, category);\n  const contextStr = context\n    ? Object.entries(context)\n      .map(([k, v]) => `${k}=${String(v)}`)\n      .join(', ')\n    : '';\n\n  // Log the full technical error\n  // eslint-disable-next-line no-console\n  console.error(`[MCP] Error in ${functionName} (${contextStr}) - Code: ${errorCode}`, error);\n\n  // Return user-friendly message\n  const userMessage = error instanceof ValidationError\n    ? error.message\n    : `An error occurred (code: ${errorCode}). Check logs for details.`;\n\n  return {\n    content: [\n      {\n        type: 'text',\n        text: userMessage,\n      },\n    ],\n    isError: true,\n  };\n}\n\n/**\n * Wrap async function with error handling\n */\nexport function withErrorHandling<T extends (...args: any[]) => Promise<MCPToolResult>>(\n  fn: T,\n  category?: ErrorCategory,\n): T {\n  return (async (...args: Parameters<T>): Promise<MCPToolResult> => {\n    try {\n      return await fn(...args);\n    } catch (error) {\n      const functionName = fn.name || 'unknown';\n      return logAndFormatError(\n        functionName,\n        error instanceof Error ? error : new Error(String(error)),\n        category,\n        { args: JSON.stringify(args) },\n      );\n    }\n  }) as T;\n}\n","/**\n * Telegram API helpers for MCP tools\n * Wraps callApi calls with proper error handling\n */\n\nimport { getGlobal } from '../../../global';\n\nimport type { ApiChat, ApiInputMessageReplyInfo, ApiMessage, ApiUser } from '../../../api/types';\n\nimport { selectChat, selectUser } from '../../../global/selectors';\nimport { callApi } from '../../../api/gramjs/worker/connector';\n\n/**\n * Get chat by ID or username\n */\nexport function getChatById(chatId: string | number): ApiChat | undefined {\n  const global = getGlobal();\n  const chatIdStr = String(chatId);\n\n  // Try to get from global state first\n  const chat = selectChat(global, chatIdStr);\n  if (chat) {\n    return chat;\n  }\n\n  // If not found, try to fetch\n  // For username, we need to resolve it first\n  if (typeof chatId === 'string' && chatId.startsWith('@')) {\n    // This would require searchChats or resolveUsername\n    // For now, return undefined and let the tool handle it\n    return undefined;\n  }\n\n  return undefined;\n}\n\n/**\n * Get user by ID or username\n */\nexport function getUserById(userId: string | number): ApiUser | undefined {\n  const global = getGlobal();\n  const userIdStr = String(userId);\n\n  const user = selectUser(global, userIdStr);\n  if (user) {\n    return user;\n  }\n\n  return undefined;\n}\n\n/**\n * Get messages from a chat\n */\nexport async function getMessages(\n  chatId: string | number,\n  limit: number = 20,\n  offsetId?: number,\n): Promise<ApiMessage[] | undefined> {\n  const chat = getChatById(chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const result = await callApi('fetchMessages', {\n    chat,\n    limit,\n    offsetId,\n  });\n\n  return result?.messages;\n}\n\n/**\n * Send a message to a chat\n */\nexport async function sendMessage(\n  chatId: string | number,\n  message: string,\n  replyToMessageId?: number,\n): Promise<ApiMessage | undefined> {\n  const chat = getChatById(chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  const replyInfo: ApiInputMessageReplyInfo | undefined = replyToMessageId\n    ? {\n      type: 'message',\n      replyToMsgId: replyToMessageId,\n    }\n    : undefined;\n\n  const result = await callApi('sendMessage', {\n    chat,\n    text: message,\n    ...(replyInfo && { replyInfo }),\n  });\n\n  return result || undefined;\n}\n\n/**\n * Get list of chats\n */\nexport async function getChats(limit: number = 20): Promise<ApiChat[]> {\n  const result = await callApi('fetchChats', {\n    limit,\n  });\n\n  if (!result) {\n    return [];\n  }\n\n  const global = getGlobal();\n  const chats: ApiChat[] = [];\n\n  // Extract chat IDs from result\n  if (result && 'chatIds' in result && Array.isArray(result.chatIds)) {\n    const chatIds = result.chatIds;\n    for (const chatId of chatIds.slice(0, limit)) {\n      const chat = selectChat(global, chatId);\n      if (chat) {\n        chats.push(chat);\n      }\n    }\n  }\n\n  return chats;\n}\n\n/**\n * Search for chats\n */\nexport async function searchChats(query: string): Promise<ApiChat[]> {\n  const result = await callApi('searchChats', { query });\n  if (!result || Array.isArray(result)) {\n    return Array.isArray(result) ? result : [];\n  }\n  // If result has accountResultIds/globalResultIds, extract chats\n  const global = getGlobal();\n  const chats: ApiChat[] = [];\n  if ('accountResultIds' in result) {\n    for (const chatId of result.accountResultIds) {\n      const chat = selectChat(global, chatId);\n      if (chat) chats.push(chat);\n    }\n  }\n  if ('globalResultIds' in result) {\n    for (const chatId of result.globalResultIds) {\n      const chat = selectChat(global, chatId);\n      if (chat) chats.push(chat);\n    }\n  }\n  return chats;\n}\n\n/**\n * Get current user info\n */\nexport function getCurrentUser(): ApiUser | undefined {\n  const global = getGlobal();\n  const currentUserId = global.currentUserId;\n  if (!currentUserId) {\n    return undefined;\n  }\n\n  return selectUser(global, currentUserId);\n}\n\n/**\n * Format entity (chat or user) for display\n */\nexport function formatEntity(entity: ApiChat | ApiUser): {\n  id: string;\n  name: string;\n  type: string;\n  username?: string;\n  phone?: string;\n} {\n  if ('title' in entity) {\n    // It's a chat\n    return {\n      id: entity.id,\n      name: entity.title,\n      type: entity.type === 'chatTypeChannel' ? 'channel' : 'group',\n      username: entity.usernames?.[0]?.username,\n    };\n  } else {\n    // It's a user\n    const name = [entity.firstName, entity.lastName].filter(Boolean).join(' ') || 'Unknown';\n    return {\n      id: entity.id,\n      name,\n      type: 'user',\n      username: entity.usernames?.[0]?.username,\n      phone: entity.phoneNumber,\n    };\n  }\n}\n\n/**\n * Format message for display\n */\nexport function formatMessage(message: ApiMessage): {\n  id: number;\n  date: string;\n  text: string;\n  from_id?: string;\n  has_media?: boolean;\n  media_type?: string;\n} {\n  let text = '';\n  if (message.content && 'text' in message.content) {\n    text = message.content.text?.text || '';\n  }\n\n  const result: ReturnType<typeof formatMessage> = {\n    id: message.id,\n    date: new Date(message.date * 1000).toISOString(),\n    text,\n  };\n\n  if (message.senderId) {\n    result.from_id = String(message.senderId);\n  }\n\n  if (\n    message.content\n    && (('photo' in message.content) || ('video' in message.content) || ('document' in message.content))\n  ) {\n    result.has_media = true;\n    if ('photo' in message.content) {\n      result.media_type = 'MessageMediaPhoto';\n    } else if ('video' in message.content) {\n      result.media_type = 'MessageMediaDocument';\n    } else if ('document' in message.content) {\n      result.media_type = 'MessageMediaDocument';\n    }\n  }\n\n  return result;\n}\n","/**\n * Get Chats tool - Get a paginated list of chats\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity, getChats as getChatsApi } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'get_chats',\n  description: 'Get a paginated list of chats',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      page: {\n        type: 'number',\n        description: 'Page number (1-indexed)',\n        default: 1,\n      },\n      page_size: {\n        type: 'number',\n        description: 'Number of chats per page',\n        default: 20,\n      },\n    },\n  },\n};\n\nexport async function getChats(\n  args: { page?: number; page_size?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const page = args.page || 1;\n    const pageSize = args.page_size || 20;\n    const start = (page - 1) * pageSize;\n\n    const chats = await getChatsApi(pageSize + start);\n    const paginatedChats = chats.slice(start, start + pageSize);\n\n    if (paginatedChats.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Page out of range.',\n          },\n        ],\n      };\n    }\n\n    const lines = paginatedChats.map((chat) => {\n      const entity = formatEntity(chat);\n      return `Chat ID: ${entity.id}, Title: ${entity.name}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_chats',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * List Chats tool - List available chats with metadata\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity, getChats as getChatsApi } from '../telegramApi';\nimport { toHumanReadableAction } from '../toolActionParser';\n\nexport const tool: MCPTool = {\n  name: 'list_chats',\n  description: 'List available chats with metadata',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_type: {\n        type: 'string',\n        enum: ['user', 'group', 'channel'],\n        description: 'Filter by chat type (\\'user\\', \\'group\\', \\'channel\\', or omit for all)',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of chats to retrieve',\n        default: 20,\n      },\n    },\n  },\n  toHumanReadableAction: (args) => toHumanReadableAction('list_chats', args),\n};\n\nexport async function listChats(\n  args: { chat_type?: string; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const limit = args.limit || 20;\n    const chatType = args.chat_type?.toLowerCase();\n\n    const chats = await getChatsApi(limit);\n\n    const contentItems: Array<{ type: 'text'; text: string }> = [];\n    for (const chat of chats) {\n      const entity = formatEntity(chat);\n\n      // Filter by type if requested\n      if (chatType && entity.type !== chatType) {\n        continue;\n      }\n\n      let chatInfo = `Chat ID: ${entity.id}`;\n      chatInfo += `, Title: ${entity.name}`;\n      chatInfo += `, Type: ${entity.type}`;\n\n      if (entity.username) {\n        chatInfo += `, Username: @${entity.username}`;\n      }\n\n      // Add unread count if available\n      if ('unreadCount' in chat && chat.unreadCount) {\n        chatInfo += `, Unread: ${chat.unreadCount}`;\n      } else {\n        chatInfo += ', No unread messages';\n      }\n\n      contentItems.push({\n        type: 'text',\n        text: chatInfo,\n      });\n    }\n\n    if (contentItems.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No chats found matching the criteria.',\n          },\n        ],\n      };\n    }\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'list_chats',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Get Chat tool - Get detailed information about a specific chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity, getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_chat',\n  description: 'Get detailed information about a specific chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  await Promise.resolve(); // Ensure async\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const chat = getChatById(chatId);\n\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const entity = formatEntity(chat);\n    const result: string[] = [];\n\n    result.push(`ID: ${entity.id}`);\n    result.push(`Title: ${entity.name}`);\n    result.push(`Type: ${entity.type}`);\n\n    if (entity.username) {\n      result.push(`Username: @${entity.username}`);\n    }\n\n    if ('membersCount' in chat && chat.membersCount) {\n      result.push(`Participants: ${chat.membersCount}`);\n    }\n\n    if ('unreadCount' in chat) {\n      result.push(`Unread Messages: ${chat.unreadCount || 0}`);\n    }\n\n    // Get last message if available\n    const lastMessageId = context.global.chats.lastMessageIds?.all?.[chat.id];\n    if (lastMessageId) {\n      const lastMessage = context.global.messages.byChatId[chat.id]?.byId[lastMessageId];\n      if (lastMessage && lastMessage.content.text) {\n        const senderName = lastMessage.senderId ? String(lastMessage.senderId) : 'Unknown';\n        const messageText = lastMessage.content.text.text || '[Media/No text]';\n        result.push(`Last Message: From ${senderName} at ${new Date(lastMessage.date * 1000).toISOString()}`);\n        result.push(`Message: ${messageText}`);\n      }\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: result.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError('get_chat', error instanceof Error ? error : new Error(String(error)), ErrorCategory.CHAT);\n  }\n}\n","/**\n * Create Group tool - Create a new group chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'create_group',\n  description: 'Create a new group chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      title: {\n        type: 'string',\n        description: 'The title of the group',\n      },\n      user_ids: {\n        type: 'array',\n        items: {\n          type: ['string', 'number'],\n        },\n        description: 'Array of user IDs to add to the group',\n      },\n    },\n    required: ['title', 'user_ids'],\n  },\n};\n\nexport async function createGroup(\n  args: { title: string; user_ids: (string | number)[] },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { title, user_ids } = args;\n\n    if (!title || typeof title !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Group title is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!user_ids || !Array.isArray(user_ids) || user_ids.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'At least one user ID is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get user objects\n    const users = [];\n    for (const userId of user_ids) {\n      const validatedId = validateId(userId, 'user_ids');\n      const user = getUserById(validatedId);\n      if (!user) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: `User with ID ${validatedId} not found`,\n            },\n          ],\n          isError: true,\n        };\n      }\n      users.push(user);\n    }\n\n    const result = await callApi('createGroupChat', {\n      title,\n      users,\n    });\n\n    if (!result?.chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to create group',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Group \"${title}\" created successfully with ID: ${result.chat.id}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'create_group',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Invite To Group tool - Invite users to a group or channel\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'invite_to_group',\n  description: 'Invite users to a group or channel',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      group_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the group/channel',\n      },\n      user_ids: {\n        type: 'array',\n        items: {\n          type: ['string', 'number'],\n        },\n        description: 'Array of user IDs to invite',\n      },\n    },\n    required: ['group_id', 'user_ids'],\n  },\n};\n\nexport async function inviteToGroup(\n  args: { group_id: string | number; user_ids: (string | number)[] },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const groupId = validateId(args.group_id, 'group_id');\n    const { user_ids } = args;\n\n    const chat = getChatById(groupId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Group/channel with ID or username \"${groupId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!user_ids || !Array.isArray(user_ids) || user_ids.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'At least one user ID is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get user objects\n    const users = [];\n    for (const userId of user_ids) {\n      const validatedId = validateId(userId, 'user_ids');\n      const user = getUserById(validatedId);\n      if (!user) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: `User with ID ${validatedId} not found`,\n            },\n          ],\n          isError: true,\n        };\n      }\n      users.push(user);\n    }\n\n    const result = await callApi('addChatMembers', chat, users);\n\n    if (result && result.length > 0) {\n      const missingUsers = result.map((u: { id: string }) => u.id).join(', ');\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Some users could not be invited: ${missingUsers}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Successfully invited ${users.length} user(s) to the group/channel.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'invite_to_group',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Create Channel tool - Create a new channel or supergroup\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'create_channel',\n  description: 'Create a new channel or supergroup',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      title: {\n        type: 'string',\n        description: 'The title of the channel',\n      },\n      about: {\n        type: 'string',\n        description: 'Description/about text for the channel',\n      },\n      megagroup: {\n        type: 'boolean',\n        description: 'If true, create a supergroup instead of a channel',\n        default: false,\n      },\n    },\n    required: ['title'],\n  },\n};\n\nexport async function createChannel(\n  args: { title: string; about?: string; megagroup?: boolean },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { title, about, megagroup = false } = args;\n\n    if (!title || typeof title !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Channel title is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('createChannel', {\n      title,\n      about: about || '',\n      isMegagroup: megagroup ? true : undefined,\n      isBroadcast: megagroup ? undefined : true,\n    });\n\n    if (!result?.channel) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to create channel',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const channelType = megagroup ? 'supergroup' : 'channel';\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `${channelType} \"${title}\" created successfully with ID: ${result.channel.id}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'create_channel',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Edit Chat Title tool - Change chat/group/channel title\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'edit_chat_title',\n  description: 'Change chat/group/channel title',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      title: {\n        type: 'string',\n        description: 'The new title',\n      },\n    },\n    required: ['chat_id', 'title'],\n  },\n};\n\nexport async function editChatTitle(\n  args: { chat_id: string | number; title: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { title } = args;\n\n    if (!title || typeof title !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Title is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('updateChatTitle', chat, title);\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat title updated to \"${title}\".`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'edit_chat_title',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Delete Chat Photo tool - Remove chat/group/channel photo\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'delete_chat_photo',\n  description: 'Remove chat/group/channel photo',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function deleteChatPhoto(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('editChatPhoto', {\n      chatId: chat.id,\n      accessHash: chat.accessHash,\n      photo: undefined,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat photo deleted successfully.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'delete_chat_photo',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Leave Chat tool - Leave a group or channel\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'leave_chat',\n  description: 'Leave a group or channel',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat to leave',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function leaveChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Check if it's a channel or group\n    if (chat.type === 'chatTypeChannel' || chat.type === 'chatTypeSuperGroup') {\n      if (!chat.accessHash) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: 'Cannot leave channel: access hash not available.',\n            },\n          ],\n          isError: true,\n        };\n      }\n      await callApi('deleteChannel', {\n        channelId: chat.id,\n        accessHash: chat.accessHash,\n      });\n    } else {\n      await callApi('deleteChat', {\n        chatId: chat.id,\n      });\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Left chat \"${chat.title || chatId}\" successfully.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'leave_chat',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Get Participants tool - List all participants in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_participants',\n  description: 'List all participants in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getParticipants(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // For channels/supergroups, use fetchMembers\n    if (chat.type === 'chatTypeChannel' || chat.type === 'chatTypeSuperGroup') {\n      const result = await callApi('fetchMembers', {\n        chat,\n        memberFilter: 'recent',\n      });\n\n      if (!result?.members) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: 'No participants found or unable to fetch participants.',\n            },\n          ],\n        };\n      }\n\n      const lines = result.members.map((member: { userId: string; isAdmin?: boolean; isOwner?: boolean }) => {\n        const user = context.global.users.byId[member.userId];\n        const name = user ? `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown' : 'Unknown';\n        const role = member.isOwner ? 'Owner' : member.isAdmin ? 'Admin' : 'Member';\n        return `ID: ${member.userId}, Name: ${name}, Role: ${role}`;\n      });\n\n      return {\n        content: [\n          {\n            type: 'text',\n            text: lines.length > 0 ? lines.join('\\n') : 'No participants found.',\n          },\n        ],\n      };\n    }\n\n    // For basic groups, we need to get full chat info\n    const fullInfo = await callApi('fetchFullChat', chat);\n    if (!fullInfo?.fullInfo?.members) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No participants found or unable to fetch participants.',\n          },\n        ],\n      };\n    }\n\n    const lines = fullInfo.fullInfo.members.map((member: { userId: string; isAdmin?: boolean; isOwner?: boolean }) => {\n      const user = context.global.users.byId[member.userId];\n      const name = user ? `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown' : 'Unknown';\n      const role = member.isOwner ? 'Owner' : member.isAdmin ? 'Admin' : 'Member';\n      return `ID: ${member.userId}, Name: ${name}, Role: ${role}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.length > 0 ? lines.join('\\n') : 'No participants found.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_participants',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Get Admins tool - List all admins in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_admins',\n  description: 'List all admins in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getAdmins(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // For channels/supergroups, use fetchMembers with admin filter\n    if (chat.type === 'chatTypeChannel' || chat.type === 'chatTypeSuperGroup') {\n      const result = await callApi('fetchMembers', {\n        chat,\n        memberFilter: 'admin',\n      });\n\n      if (!result?.members) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: 'No admins found or unable to fetch admins.',\n            },\n          ],\n        };\n      }\n\n      const lines = result.members.map((member: { userId: string; isOwner?: boolean; customTitle?: string }) => {\n        const user = context.global.users.byId[member.userId];\n        const name = user ? `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown' : 'Unknown';\n        const role = member.isOwner ? 'Owner' : 'Admin';\n        const title = member.customTitle ? ` (${member.customTitle})` : '';\n        return `ID: ${member.userId}, Name: ${name}, Role: ${role}${title}`;\n      });\n\n      return {\n        content: [\n          {\n            type: 'text',\n            text: lines.length > 0 ? lines.join('\\n') : 'No admins found.',\n          },\n        ],\n      };\n    }\n\n    // For basic groups, get full chat info and filter admins\n    const fullInfo = await callApi('fetchFullChat', chat);\n    if (!fullInfo?.fullInfo?.members) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No admins found or unable to fetch admins.',\n          },\n        ],\n      };\n    }\n\n    const adminMembers = fullInfo.fullInfo.members.filter(\n      (member: { isAdmin?: boolean; isOwner?: boolean }) => member.isAdmin || member.isOwner,\n    );\n\n    const lines = adminMembers.map((member: { userId: string; isOwner?: boolean }) => {\n      const user = context.global.users.byId[member.userId];\n      const name = user ? `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown' : 'Unknown';\n      const role = member.isOwner ? 'Owner' : 'Admin';\n      return `ID: ${member.userId}, Name: ${name}, Role: ${role}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.length > 0 ? lines.join('\\n') : 'No admins found.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_admins',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Get Banned Users tool - List all banned users in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_banned_users',\n  description: 'List all banned users in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getBannedUsers(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Only channels/supergroups support banned users\n    if (chat.type !== 'chatTypeChannel' && chat.type !== 'chatTypeSuperGroup') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Banned users are only available for channels and supergroups.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('fetchMembers', {\n      chat,\n      memberFilter: 'kicked',\n    });\n\n    if (!result?.members) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No banned users found or unable to fetch banned users.',\n          },\n        ],\n      };\n    }\n\n    const lines = result.members.map((member: { userId: string; kickedByUserId?: string; bannedRights?: any }) => {\n      const user = context.global.users.byId[member.userId];\n      const name = user ? `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown' : 'Unknown';\n      const kickedBy = member.kickedByUserId ? ` (kicked by ${member.kickedByUserId})` : '';\n      return `ID: ${member.userId}, Name: ${name}${kickedBy}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.length > 0 ? lines.join('\\n') : 'No banned users found.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_banned_users',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Promote Admin tool - Promote a user to admin\n */\n\nimport type { ApiChatAdminRights } from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'promote_admin',\n  description: 'Promote a user to admin in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the user to promote',\n      },\n    },\n    required: ['chat_id', 'user_id'],\n  },\n};\n\nexport async function promoteAdmin(\n  args: { chat_id: string | number; user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const userId = validateId(args.user_id, 'user_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Basic admin rights - can be customized\n    const adminRights: ApiChatAdminRights = {\n      changeInfo: true,\n      postMessages: true,\n      editMessages: true,\n      deleteMessages: true,\n      banUsers: true,\n      inviteUsers: true,\n      pinMessages: true,\n      // addAdmins: false, // Don't allow adding admins by default\n    };\n\n    await callApi('updateChatAdmin', {\n      chat,\n      user,\n      adminRights,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} promoted to admin in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'promote_admin',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Demote Admin tool - Demote an admin to regular user\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'demote_admin',\n  description: 'Demote an admin to regular user',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the admin to demote',\n      },\n    },\n    required: ['chat_id', 'user_id'],\n  },\n};\n\nexport async function demoteAdmin(\n  args: { chat_id: string | number; user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const userId = validateId(args.user_id, 'user_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Remove all admin rights\n    const adminRights = {};\n\n    await callApi('updateChatAdmin', {\n      chat,\n      user,\n      adminRights,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} demoted from admin in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'demote_admin',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Ban User tool - Ban a user from a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\nimport { toHumanReadableAction } from '../toolActionParser';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'ban_user',\n  description: 'Ban a user from a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the user to ban',\n      },\n    },\n    required: ['chat_id', 'user_id'],\n  },\n  toHumanReadableAction: (args) => toHumanReadableAction('ban_user', args),\n};\n\nexport async function banUser(\n  args: { chat_id: string | number; user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const userId = validateId(args.user_id, 'user_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Ban rights - restrict all permissions\n    const bannedRights: {\n      viewMessages?: true;\n      sendMessages?: true;\n      sendMedia?: true;\n      sendStickers?: true;\n      sendGifs?: true;\n      sendGames?: true;\n      sendInline?: true;\n      embedLinks?: true;\n      sendPolls?: true;\n      changeInfo?: true;\n      inviteUsers?: true;\n      pinMessages?: true;\n    } = {\n      viewMessages: true, // Can't view messages\n      sendMessages: true,\n      sendMedia: true,\n      sendStickers: true,\n      sendGifs: true,\n      sendGames: true,\n      sendInline: true,\n      embedLinks: true,\n      sendPolls: true,\n      changeInfo: true,\n      inviteUsers: true,\n      pinMessages: true,\n    };\n\n    await callApi('updateChatMemberBannedRights', {\n      chat,\n      user,\n      bannedRights,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} banned from chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'ban_user',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Unban User tool - Unban a user from a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'unban_user',\n  description: 'Unban a user from a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the user to unban',\n      },\n    },\n    required: ['chat_id', 'user_id'],\n  },\n};\n\nexport async function unbanUser(\n  args: { chat_id: string | number; user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const userId = validateId(args.user_id, 'user_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Remove all banned rights\n    const bannedRights = {};\n\n    await callApi('updateChatMemberBannedRights', {\n      chat,\n      user,\n      bannedRights,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} unbanned from chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'unban_user',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Get Invite Link tool - Get invite link for a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_invite_link',\n  description: 'Get invite link for a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getInviteLink(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get full chat info to access invite link\n    const fullInfo = await callApi('loadFullChat', { chatId: chat.id });\n    const inviteLink = fullInfo?.fullInfo?.inviteLink;\n\n    if (!inviteLink) {\n      // Try to export a new invite link\n      const newLink = await callApi('exportChatInvite', {\n        peer: chat,\n      });\n\n      if (!newLink?.link) {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: 'Unable to get or create invite link for this chat.',\n            },\n          ],\n          isError: true,\n        };\n      }\n\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Invite link: ${newLink.link}`,\n          },\n        ],\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Invite link: ${inviteLink}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_invite_link',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Export Chat Invite tool - Export/create invite link for a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'export_chat_invite',\n  description: 'Export/create invite link for a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function exportChatInvite(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('exportChatInvite', {\n      peer: chat,\n    });\n\n    if (!result?.link) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to export invite link.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Invite link: ${result.link}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'export_chat_invite',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Import Chat Invite tool - Join chat by invite hash\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'import_chat_invite',\n  description: 'Join chat by invite hash',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      hash: {\n        type: 'string',\n        description: 'The invite hash from the invite link',\n      },\n    },\n    required: ['hash'],\n  },\n};\n\nexport async function importChatInvite(\n  args: { hash: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { hash } = args;\n\n    if (!hash || typeof hash !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Invite hash is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('importChatInvite', {\n      hash,\n    });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to join chat with the provided invite hash.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Successfully joined chat with ID: ${result.id}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'import_chat_invite',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Join Chat By Link tool - Join chat by invite link\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'join_chat_by_link',\n  description: 'Join chat by invite link',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      link: {\n        type: 'string',\n        description: 'The invite link (e.g., https://t.me/joinchat/...)',\n      },\n    },\n    required: ['link'],\n  },\n};\n\nexport async function joinChatByLink(\n  args: { link: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { link } = args;\n\n    if (!link || typeof link !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Invite link is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Extract hash from link\n    // Links can be: https://t.me/joinchat/HASH or https://t.me/+HASH\n    let hash = '';\n    if (link.includes('/joinchat/')) {\n      hash = link.split('/joinchat/')[1]?.split('?')[0] || '';\n    } else if (link.includes('t.me/+')) {\n      hash = link.split('t.me/+')[1]?.split('?')[0] || '';\n    } else if (link.startsWith('+')) {\n      hash = link.split('?')[0].substring(1);\n    } else {\n      // Assume it's just the hash\n      hash = link.split('?')[0];\n    }\n\n    if (!hash) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Invalid invite link format. Expected format: https://t.me/joinchat/HASH or https://t.me/+HASH',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('importChatInvite', {\n      hash,\n    });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to join chat with the provided invite link.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Successfully joined chat with ID: ${result.id}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'join_chat_by_link',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Subscribe Public Channel tool - Subscribe to a public channel or supergroup\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'subscribe_public_channel',\n  description: 'Subscribe to a public channel or supergroup by username or ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      channel: {\n        type: ['string', 'number'],\n        description: 'The username (e.g., @channel) or ID of the channel',\n      },\n    },\n    required: ['channel'],\n  },\n};\n\nexport async function subscribePublicChannel(\n  args: { channel: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const channelId = validateId(args.channel, 'channel');\n\n    // Try to get the channel first\n    let chat = getChatById(channelId);\n\n    // If not found, try to resolve username\n    if (!chat && typeof channelId === 'string' && channelId.startsWith('@')) {\n      // Search for the channel\n      const searchResult = await callApi('searchChats', {\n        query: channelId.substring(1),\n      });\n\n      if (searchResult && Array.isArray(searchResult)) {\n        chat = searchResult.find((c: { usernames?: Array<{ username: string }> }) =>\n          c.usernames?.some((u) => u.username === channelId.substring(1)),\n        );\n      }\n    }\n\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Channel with ID or username \"${channelId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Join the channel\n    if (chat.accessHash) {\n      await callApi('joinChannel', {\n        channelId: chat.id,\n        accessHash: chat.accessHash,\n      });\n    } else {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Unable to join channel. Access hash not available.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Successfully subscribed to channel \"${chat.title || channelId}\".`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'subscribe_public_channel',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Mute Chat tool - Mute notifications for a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'mute_chat',\n  description: 'Mute notifications for a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function muteChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Mute indefinitely (far future timestamp)\n    await callApi('updateChatNotifySettings', {\n      chat,\n      settings: {\n        mutedUntil: 2147483647, // Max 32-bit integer (year 2038)\n      },\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat ${chatId} muted.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'mute_chat',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Unmute Chat tool - Unmute notifications for a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'unmute_chat',\n  description: 'Unmute notifications for a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function unmuteChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Unmute (set to 0 or current time)\n    await callApi('updateChatNotifySettings', {\n      chat,\n      settings: {\n        mutedUntil: 0,\n      },\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat ${chatId} unmuted.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'unmute_chat',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Archive Chat tool - Archive a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ARCHIVED_FOLDER_ID } from '../../../../config';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'archive_chat',\n  description: 'Archive a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function archiveChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('toggleChatArchived', {\n      chat,\n      folderId: ARCHIVED_FOLDER_ID,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat ${chatId} archived.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'archive_chat',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Unarchive Chat tool - Unarchive a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ALL_FOLDER_ID } from '../../../../config';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'unarchive_chat',\n  description: 'Unarchive a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function unarchiveChat(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('toggleChatArchived', {\n      chat,\n      folderId: ALL_FOLDER_ID,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat ${chatId} unarchived.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'unarchive_chat',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Get Messages tool - Get paginated messages from a specific chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById, getMessages as getMessagesApi } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_messages',\n  description: 'Get paginated messages from a specific chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      page: {\n        type: 'number',\n        description: 'Page number (1-indexed)',\n        default: 1,\n      },\n      page_size: {\n        type: 'number',\n        description: 'Number of messages per page',\n        default: 20,\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getMessages(\n  args: { chat_id: string | number; page?: number; page_size?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const page = args.page || 1;\n    const pageSize = args.page_size || 20;\n    const offset = (page - 1) * pageSize;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const messages = await getMessagesApi(chatId, pageSize, offset);\n    if (!messages || messages.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No messages found for this page.',\n          },\n        ],\n      };\n    }\n\n    const lines = messages.map((msg) => {\n      const formatted = formatMessage(msg);\n      const senderName = msg.senderId ? String(msg.senderId) : 'Unknown';\n      const replyInfoStr = msg.replyInfo?.type === 'message' && msg.replyInfo.replyToMsgId\n        ? ` | reply to ${msg.replyInfo.replyToMsgId}`\n        : '';\n      const engagementInfo = ''; // TODO: Add views, forwards, reactions\n\n      const msgText = formatted.text || '[Media/No text]';\n      const dateStr = formatted.date;\n      const line =\n        `ID: ${formatted.id} | ${senderName} | Date: ${dateStr}${replyInfoStr}${engagementInfo} | Message: ${msgText}`;\n      return line;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    const err = error instanceof Error ? error : new Error(String(error));\n    return logAndFormatError('get_messages', err, ErrorCategory.MSG);\n  }\n}\n","/**\n * List Messages tool - Retrieve messages with optional filters\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById, getMessages as getMessagesApi } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'list_messages',\n  description: 'Retrieve messages with optional filters',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat to get messages from',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of messages to retrieve',\n        default: 20,\n      },\n      search_query: {\n        type: 'string',\n        description: 'Filter messages containing this text',\n      },\n      from_date: {\n        type: 'string',\n        description: 'Filter messages starting from this date (format: YYYY-MM-DD)',\n      },\n      to_date: {\n        type: 'string',\n        description: 'Filter messages until this date (format: YYYY-MM-DD)',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function listMessages(\n  args: {\n    chat_id: string | number;\n    limit?: number;\n    search_query?: string;\n    from_date?: string;\n    to_date?: string;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const limit = args.limit || 20;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // For now, we'll get messages and filter client-side\n    // In a full implementation, we'd use search parameter in fetchMessages\n    const messages = await getMessagesApi(chatId, limit * 2); // Get more to filter\n\n    if (!messages || messages.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No messages found matching the criteria.',\n          },\n        ],\n      };\n    }\n\n    // Apply filters\n    let filteredMessages = messages;\n\n    if (args.search_query) {\n      const query = args.search_query.toLowerCase();\n      filteredMessages = filteredMessages.filter((msg) => {\n        if (msg.content && 'text' in msg.content) {\n          return msg.content.text?.text?.toLowerCase().includes(query);\n        }\n        return false;\n      });\n    }\n\n    if (args.from_date || args.to_date) {\n      filteredMessages = filteredMessages.filter((msg) => {\n        const msgDate = new Date(msg.date * 1000);\n        if (args.from_date) {\n          const fromDate = new Date(args.from_date);\n          if (msgDate < fromDate) return false;\n        }\n        if (args.to_date) {\n          const toDate = new Date(args.to_date);\n          toDate.setHours(23, 59, 59, 999); // End of day\n          if (msgDate > toDate) return false;\n        }\n        return true;\n      });\n    }\n\n    // Limit results\n    filteredMessages = filteredMessages.slice(0, limit);\n\n    const contentItems = filteredMessages.map((msg) => {\n      const formatted = formatMessage(msg);\n      const senderName = msg.senderId ? String(msg.senderId) : 'Unknown';\n      const replyInfoStr = msg.replyInfo?.type === 'message' && msg.replyInfo.replyToMsgId\n        ? ` | reply to ${msg.replyInfo.replyToMsgId}`\n        : '';\n      const engagementInfo = ''; // TODO: Add views, forwards, reactions\n\n      const msgText = formatted.text || '[Media/No text]';\n      const dateStr = formatted.date;\n      const text =\n        `ID: ${formatted.id} | ${senderName} | Date: ${dateStr}${replyInfoStr}${engagementInfo} | Message: ${msgText}`;\n      return {\n        type: 'text' as const,\n        text,\n      };\n    });\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    const err = error instanceof Error ? error : new Error(String(error));\n    return logAndFormatError('list_messages', err, ErrorCategory.MSG);\n  }\n}\n","/**\n * List Topics tool - List forum topics in a supergroup\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'list_topics',\n  description: 'List forum topics in a supergroup with forum feature enabled',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the forum-enabled chat (supergroup)',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of topics to retrieve',\n        default: 200,\n      },\n      offset_topic: {\n        type: 'number',\n        description: 'Topic ID offset for pagination',\n        default: 0,\n      },\n      search_query: {\n        type: 'string',\n        description: 'Optional query to filter topics by title',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function listTopics(\n  args: {\n    chat_id: string | number;\n    limit?: number;\n    offset_topic?: number;\n    search_query?: string;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { limit = 200, offset_topic: offsetTopic = 0, search_query: searchQuery } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (chat.type !== 'chatTypeSuperGroup') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'The specified chat is not a supergroup.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!chat.isForum) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'The specified supergroup does not have forum topics enabled.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('fetchTopics', {\n      chat,\n      limit,\n      offsetTopicId: offsetTopic,\n      query: searchQuery,\n    });\n\n    if (!result?.topics || result.topics.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No topics found for this chat.',\n          },\n        ],\n      };\n    }\n\n    const contentItems = result.topics.map((topic: {\n      id: number;\n      title?: string;\n      messageCount?: number;\n      unreadCount?: number;\n      isClosed?: boolean;\n      isHidden?: boolean;\n      lastMessageId?: number;\n    }) => {\n      const parts = [`Topic ID: ${topic.id}`];\n      parts.push(`Title: ${topic.title || '(no title)'}`);\n\n      if (topic.messageCount !== undefined) {\n        parts.push(`Messages: ${topic.messageCount}`);\n      }\n\n      if (topic.unreadCount) {\n        parts.push(`Unread: ${topic.unreadCount}`);\n      }\n\n      if (topic.isClosed) {\n        parts.push('Closed: Yes');\n      }\n\n      if (topic.isHidden) {\n        parts.push('Hidden: Yes');\n      }\n\n      return {\n        type: 'text' as const,\n        text: parts.join(' | '),\n      };\n    });\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'list_topics',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.GROUP,\n    );\n  }\n}\n","/**\n * Send Message tool - Send a message to a specific chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { sendMessage as sendMessageApi } from '../telegramApi';\nimport { toHumanReadableAction } from '../toolActionParser';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'send_message',\n  description: 'Send a message to a specific chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message: {\n        type: 'string',\n        description: 'The message content to send',\n      },\n    },\n    required: ['chat_id', 'message'],\n  },\n  toHumanReadableAction: (args) => toHumanReadableAction('send_message', args),\n};\n\nexport async function sendMessage(\n  args: { chat_id: string | number; message: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message } = args;\n\n    if (!message || typeof message !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Message content is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await sendMessageApi(chatId, message);\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Failed to send message to chat ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: 'Message sent successfully.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'send_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Reply To Message tool - Reply to a specific message in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { toHumanReadableAction } from '../toolActionParser';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'reply_to_message',\n  description: 'Reply to a specific message in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to reply to',\n      },\n      text: {\n        type: 'string',\n        description: 'The reply message text',\n      },\n    },\n    required: ['chat_id', 'message_id', 'text'],\n  },\n  toHumanReadableAction: (args) => toHumanReadableAction('reply_to_message', args),\n};\n\nexport async function replyToMessage(\n  args: { chat_id: string | number; message_id: number; text: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, text } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('sendMessage', {\n      chat,\n      text,\n      replyInfo: {\n        type: 'message',\n        replyToMsgId: message_id,\n      },\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Replied to message ${message_id} in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'reply_to_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Edit Message tool - Edit a message you sent\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'edit_message',\n  description: 'Edit a message you sent',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to edit',\n      },\n      new_text: {\n        type: 'string',\n        description: 'The new message text',\n      },\n    },\n    required: ['chat_id', 'message_id', 'new_text'],\n  },\n};\n\nexport async function editMessage(\n  args: { chat_id: string | number; message_id: number; new_text: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, new_text } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get the message first\n    const messageResult = await callApi('fetchMessage', {\n      chat,\n      messageId: message_id,\n    });\n\n    if (!messageResult || messageResult === 'MESSAGE_DELETED' || !('message' in messageResult)) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found in chat ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('editMessage', {\n      chat,\n      message: messageResult.message,\n      text: new_text,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Message ${message_id} edited.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'edit_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Delete Message tool - Delete a message by ID\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'delete_message',\n  description: 'Delete a message by ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to delete',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function deleteMessage(\n  args: { chat_id: string | number; message_id: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('deleteMessages', {\n      chat,\n      messageIds: [message_id],\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Message ${message_id} deleted.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'delete_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Forward Message tool - Forward a message from one chat to another\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { toHumanReadableAction } from '../toolActionParser';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'forward_message',\n  description: 'Forward a message from one chat to another',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      from_chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the source chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to forward',\n      },\n      to_chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the destination chat',\n      },\n    },\n    required: ['from_chat_id', 'message_id', 'to_chat_id'],\n  },\n  toHumanReadableAction: (args) => toHumanReadableAction('forward_message', args),\n};\n\nexport async function forwardMessage(\n  args: {\n    from_chat_id: string | number;\n    message_id: number;\n    to_chat_id: string | number;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const fromChatId = validateId(args.from_chat_id, 'from_chat_id');\n    const toChatId = validateId(args.to_chat_id, 'to_chat_id');\n    const { message_id } = args;\n\n    const fromChat = getChatById(fromChatId);\n    if (!fromChat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Source chat not found: ${fromChatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const toChat = getChatById(toChatId);\n    if (!toChat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Destination chat not found: ${toChatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get the message first\n    const messageResult = await callApi('fetchMessage', {\n      chat: fromChat,\n      messageId: message_id,\n    });\n\n    if (!messageResult || messageResult === 'MESSAGE_DELETED' || !('message' in messageResult)) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found in source chat ${fromChatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('forwardMessages', {\n      fromChat,\n      toChat,\n      messages: [messageResult.message],\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Message ${message_id} forwarded from ${fromChatId} to ${toChatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'forward_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Pin Message tool - Pin a message in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'pin_message',\n  description: 'Pin a message in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to pin',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function pinMessage(\n  args: { chat_id: string | number; message_id: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('pinMessage', {\n      chat,\n      messageId: message_id,\n      isUnpin: false,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Message ${message_id} pinned in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'pin_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Unpin Message tool - Unpin a message in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'unpin_message',\n  description: 'Unpin a message in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to unpin',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function unpinMessage(\n  args: { chat_id: string | number; message_id: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('pinMessage', {\n      chat,\n      messageId: message_id,\n      isUnpin: true,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Message ${message_id} unpinned in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'unpin_message',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Mark As Read tool - Mark all messages as read in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'mark_as_read',\n  description: 'Mark all messages as read in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function markAsRead(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('markMessageListRead', {\n      chat,\n      threadId: 0, // Main thread\n      maxId: 0, // Mark all as read\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `All messages marked as read in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'mark_as_read',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get Message Context tool - Retrieve context around a specific message\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById, getMessages as getMessagesApi } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_message_context',\n  description: 'Retrieve context around a specific message',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The ID of the central message',\n      },\n      context_size: {\n        type: 'number',\n        description: 'Number of messages before and after to include',\n        default: 3,\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function getMessageContext(\n  args: {\n    chat_id: string | number;\n    message_id: number;\n    context_size?: number;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, context_size = 3 } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat not found: ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get central message\n    const centralResult = await callApi('fetchMessage', {\n      chat,\n      messageId: message_id,\n    });\n\n    if (!centralResult || centralResult === 'MESSAGE_DELETED' || !('message' in centralResult)) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message with ID ${message_id} not found in chat ${chatId}.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get messages before and after\n    const allMessages = await getMessagesApi(chatId, context_size * 2 + 1, message_id);\n\n    if (!allMessages) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Could not retrieve messages around ${message_id}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Find the central message and get context\n    const centralIndex = allMessages.findIndex((msg) => msg.id === message_id);\n    if (centralIndex === -1) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found in retrieved messages`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const startIndex = Math.max(0, centralIndex - context_size);\n    const endIndex = Math.min(allMessages.length, centralIndex + context_size + 1);\n    const contextMessages = allMessages.slice(startIndex, endIndex);\n\n    const results = [`Context for message ${message_id} in chat ${chatId}:`];\n    for (const msg of contextMessages) {\n      const formatted = formatMessage(msg);\n      const senderName = msg.senderId ? String(msg.senderId) : 'Unknown';\n      const highlight = msg.id === message_id ? ' [THIS MESSAGE]' : '';\n      const replyInfoStr = msg.replyInfo?.type === 'message' && msg.replyInfo.replyToMsgId\n        ? ` | reply to ${msg.replyInfo.replyToMsgId}`\n        : '';\n\n      results.push(\n        `ID: ${formatted.id} | ${senderName} | ${formatted.date}${highlight}${replyInfoStr}\\n${formatted.text}\\n`,\n      );\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: results.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_message_context',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get History tool - Get full chat history\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\nimport { MAIN_THREAD_ID } from '../../../../api/types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_history',\n  description: 'Get full chat history',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of messages to retrieve',\n        default: 100,\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getHistory(\n  args: { chat_id: string | number; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { limit = 100 } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('fetchMessages', {\n      chat,\n      limit,\n      threadId: MAIN_THREAD_ID,\n    });\n\n    if (!result?.messages || result.messages.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No messages found in chat history.',\n          },\n        ],\n      };\n    }\n\n    const contentItems = result.messages.map((msg: any) => {\n      const formatted = formatMessage(msg);\n      const senderName = msg.senderId ? String(msg.senderId) : 'Unknown';\n      const replyInfoStr = msg.replyInfo?.type === 'message' && msg.replyInfo.replyToMsgId\n        ? ` | reply to ${msg.replyInfo.replyToMsgId}`\n        : '';\n      const messageText = formatted.text || '[Media/No text]';\n      const text =\n        `ID: ${formatted.id} | ${senderName} | Date: ${formatted.date}${replyInfoStr} | Message: ${messageText}`;\n      return {\n        type: 'text' as const,\n        text,\n      };\n    });\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_history',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get Pinned Messages tool - List pinned messages in a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_pinned_messages',\n  description: 'List pinned messages in a chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getPinnedMessages(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get messages and filter for pinned ones\n    const result = await callApi('fetchMessages', {\n      chat,\n      limit: 100,\n    });\n\n    if (!result?.messages) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No messages found or unable to fetch messages.',\n          },\n        ],\n      };\n    }\n\n    const pinnedMessages = result.messages.filter((msg: { isPinned?: boolean }) => msg.isPinned);\n\n    if (pinnedMessages.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No pinned messages found in this chat.',\n          },\n        ],\n      };\n    }\n\n    const lines = pinnedMessages.map((msg: any) => {\n      const formatted = formatMessage(msg);\n      const senderName = msg.senderId ? String(msg.senderId) : 'Unknown';\n      return `ID: ${formatted.id} | ${senderName} | Date: ${formatted.date} | Message: ${formatted.text || '[Media/No text]'}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_pinned_messages',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Send Reaction tool - Add a reaction to a message\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'send_reaction',\n  description: 'Add a reaction to a message',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to react to',\n      },\n      emoji: {\n        type: 'string',\n        description: 'The emoji reaction (e.g., , , )',\n      },\n      big: {\n        type: 'boolean',\n        description: 'Whether to send a big reaction',\n        default: false,\n      },\n    },\n    required: ['chat_id', 'message_id', 'emoji'],\n  },\n};\n\nexport async function sendReaction(\n  args: { chat_id: string | number; message_id: number; emoji: string; big?: boolean },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, emoji, big = false } = args;\n\n    if (!emoji || typeof emoji !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Emoji is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Build reaction object\n    const reaction = {\n      type: 'reactionEmoji' as const,\n      emoji: emoji,\n    };\n\n    await callApi('sendReaction', {\n      chat,\n      messageId: message_id,\n      reactions: [reaction],\n      shouldAddToRecent: true,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Reaction ${emoji} added to message ${message_id}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'send_reaction',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Remove Reaction tool - Remove a reaction from a message\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'remove_reaction',\n  description: 'Remove a reaction from a message',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to remove reaction from',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function removeReaction(\n  args: { chat_id: string | number; message_id: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Remove all reactions by passing empty array\n    await callApi('sendReaction', {\n      chat,\n      messageId: message_id,\n      reactions: [],\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Reaction removed from message ${message_id}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'remove_reaction',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get Message Reactions tool - Get all reactions on a message\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_message_reactions',\n  description: 'Get all reactions on a message',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the chat',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to get reactions for',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of reactions to retrieve',\n        default: 50,\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function getMessageReactions(\n  args: { chat_id: string | number; message_id: number; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat with ID or username \"${chatId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get message first to check reactions\n    const messageResult = await callApi('fetchMessage', {\n      chat,\n      messageId: message_id,\n    });\n\n    if (!messageResult || messageResult === 'MESSAGE_DELETED' || !('message' in messageResult)) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message with ID ${message_id} not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const message = messageResult.message;\n    if (!message.reactions) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No reactions found on this message.',\n          },\n        ],\n      };\n    }\n\n    const lines: string[] = [];\n    if (message.reactions.results) {\n      for (const reaction of message.reactions.results) {\n        const emoji = reaction.reaction.type === 'emoji' ? reaction.reaction.emoticon : 'Custom';\n        lines.push(`${emoji}: ${reaction.count} reaction(s)`);\n      }\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.length > 0 ? lines.join('\\n') : 'No reactions found on this message.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_message_reactions',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * List Inline Buttons tool - Inspect inline keyboards to discover button text/index\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { selectChatMessage } from '../../../../global/selectors';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'list_inline_buttons',\n  description: 'Inspect inline keyboards to discover button text/index',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID to inspect',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of buttons to return',\n        default: 50,\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function listInlineButtons(\n  args: { chat_id: string | number; message_id: number; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  await Promise.resolve(); // Ensure async\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, limit = 50 } = args;\n\n    const { global } = context;\n    const message = selectChatMessage(global, String(chatId), message_id);\n\n    if (!message) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found in chat ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const buttons: Array<{\n      row: number;\n      column: number;\n      text: string;\n      type: string;\n      data?: string;\n      url?: string;\n    }> = [];\n\n    if (message.inlineButtons) {\n      message.inlineButtons.forEach((row, rowIndex) => {\n        row.forEach((button, colIndex) => {\n          if (buttons.length < limit) {\n            buttons.push({\n              row: rowIndex,\n              column: colIndex,\n              text: button.text,\n              type: button.type,\n              ...(button.type === 'callback' && { data: button.data }),\n              ...(button.type === 'url' && { url: button.url }),\n            });\n          }\n        });\n      });\n    }\n\n    if (buttons.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No inline buttons found in message ${message_id}`,\n          },\n        ],\n      };\n    }\n\n    const contentItems = buttons.map((button) => {\n      const parts = [\n        `Row: ${button.row}`,\n        `Column: ${button.column}`,\n        `Text: ${button.text}`,\n        `Type: ${button.type}`,\n      ];\n\n      if (button.data) {\n        parts.push(`Data: ${button.data}`);\n      }\n\n      if (button.url) {\n        parts.push(`URL: ${button.url}`);\n      }\n\n      return {\n        type: 'text' as const,\n        text: parts.join(' | '),\n      };\n    });\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'list_inline_buttons',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Press Inline Button tool - Trigger inline keyboard callbacks by label or index\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { selectChatMessage } from '../../../../global/selectors';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'press_inline_button',\n  description: 'Trigger inline keyboard callbacks by label or index',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID containing the inline keyboard',\n      },\n      button_text: {\n        type: 'string',\n        description: 'The button text to press (optional if button_index is provided)',\n      },\n      button_index: {\n        type: 'number',\n        description: 'The button index (row,column format as single number) (optional if button_text is provided)',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function pressInlineButton(\n  args: {\n    chat_id: string | number;\n    message_id: number;\n    button_text?: string;\n    button_index?: number;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id, button_text, button_index } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const { global } = context;\n    const message = selectChatMessage(global, String(chatId), message_id);\n\n    if (!message) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found in chat ${chatId}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!message.inlineButtons || message.inlineButtons.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No inline buttons found in message ${message_id}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    let targetButton;\n    if (button_index !== undefined) {\n      // Find button by index (flattened)\n      let currentIndex = 0;\n      for (const row of message.inlineButtons) {\n        for (const button of row) {\n          if (currentIndex === button_index) {\n            targetButton = button;\n            break;\n          }\n          currentIndex++;\n        }\n        if (targetButton) break;\n      }\n    } else if (button_text) {\n      // Find button by text\n      for (const row of message.inlineButtons) {\n        for (const button of row) {\n          if (button.text === button_text) {\n            targetButton = button;\n            break;\n          }\n        }\n        if (targetButton) break;\n      }\n    } else {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Either button_text or button_index must be provided',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!targetButton) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Button not found${button_text ? ` with text \"${button_text}\"` : ` at index ${button_index}`}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Handle different button types\n    if (targetButton.type === 'callback') {\n      await callApi('answerCallbackButton', {\n        chatId: String(chatId),\n        accessHash: chat.accessHash,\n        messageId: message_id,\n        data: targetButton.data,\n      });\n    } else if (targetButton.type === 'url') {\n      // URL buttons can't be \"pressed\" programmatically, they just open URLs\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Button \"${targetButton.text}\" is a URL button. URL: ${targetButton.url}`,\n          },\n        ],\n      };\n    } else {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Button type \"${targetButton.type}\" is not supported for programmatic pressing`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Button \"${targetButton.text}\" pressed successfully.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'press_inline_button',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Save Draft tool - Save a draft message to a chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'save_draft',\n  description: 'Save a draft message to a chat or channel',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username to save the draft to',\n      },\n      message: {\n        type: 'string',\n        description: 'The draft message text',\n      },\n      reply_to_msg_id: {\n        type: 'number',\n        description: 'Optional message ID to reply to',\n      },\n      no_webpage: {\n        type: 'boolean',\n        description: 'If true, disable link preview in the draft',\n      },\n    },\n    required: ['chat_id', 'message'],\n  },\n};\n\nexport async function saveDraft(\n  args: {\n    chat_id: string | number;\n    message: string;\n    reply_to_msg_id?: number;\n    no_webpage?: boolean;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message, reply_to_msg_id, no_webpage } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const draft = {\n      text: {\n        text: message,\n        entities: [],\n      },\n      ...(reply_to_msg_id && {\n        replyInfo: {\n          type: 'message' as const,\n          replyToMsgId: reply_to_msg_id,\n        },\n      }),\n    };\n\n    await callApi('saveDraft', {\n      chat,\n      draft,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Draft saved to chat ${chatId}. Open the chat in Telegram to see and send it.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'save_draft',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get Drafts tool - Get all draft messages across all chats\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { selectDraft } from '../../../../global/selectors';\nimport { MAIN_THREAD_ID } from '../../../../api/types';\n\nexport const tool: MCPTool = {\n  name: 'get_drafts',\n  description: 'Get all draft messages across all chats',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getDrafts(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  await Promise.resolve(); // Ensure async\n  try {\n    const { global } = context;\n    const drafts: Array<{\n      chat_id: string;\n      message?: string;\n      date?: number;\n      reply_to_msg_id?: number;\n    }> = [];\n\n    // Iterate through all chats in global state\n    const chatIds = Object.keys(global.chats.byId);\n    for (const chatId of chatIds) {\n      const draft = selectDraft(global, chatId, MAIN_THREAD_ID);\n      if (draft && draft.text) {\n        drafts.push({\n          chat_id: chatId,\n          message: draft.text.text,\n          date: draft.date,\n          reply_to_msg_id: draft.replyInfo?.replyToMsgId,\n        });\n      }\n    }\n\n    if (drafts.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No drafts found.',\n          },\n        ],\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify({ drafts, count: drafts.length }, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_drafts',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Clear Draft tool - Clear/delete a draft from a specific chat\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'clear_draft',\n  description: 'Clear/delete a draft from a specific chat',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username to clear the draft from',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function clearDraft(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Saving an empty draft clears it\n    await callApi('saveDraft', {\n      chat,\n      draft: undefined,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Draft cleared from chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'clear_draft',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * List Contacts tool - List all contacts in your Telegram account\n */\n\nimport type { ApiChat } from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'list_contacts',\n  description: 'List all contacts in your Telegram account',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function listContacts(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    // Get all chats and filter to contacts (private chats)\n    const chatsResult = await callApi('fetchChats', { limit: 1000 });\n\n    if (!chatsResult) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No contacts found.',\n          },\n        ],\n      };\n    }\n\n    // Filter to only users (contacts) - private chats\n    const global = context.global;\n    const chatIds = chatsResult.chatIds || [];\n    const contactChats = chatIds\n      .map((chatId: string) => global.chats.byId[chatId])\n      .filter((chat: ApiChat | undefined): chat is ApiChat => chat?.type === 'chatTypePrivate');\n\n    if (contactChats.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No contacts found.',\n          },\n        ],\n      };\n    }\n\n    const contentItems = contactChats.map((chat: ApiChat) => {\n      const name = chat.title || 'Unknown';\n      const username = chat.usernames?.[0]?.username;\n      // Get user from global state to access phone number\n      const user = context.global.users.byId[chat.id];\n      const phone = user?.phoneNumber;\n\n      let contactInfo = `ID: ${chat.id}, Name: ${name}`;\n      if (username) {\n        contactInfo += `, Username: @${username}`;\n      }\n      if (phone && typeof phone === 'string') {\n        contactInfo += `, Phone: ${phone}`;\n      }\n      return {\n        type: 'text' as const,\n        text: contactInfo,\n      };\n    });\n\n    return {\n      content: contentItems,\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'list_contacts',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Search Contacts tool - Search for contacts by name, username, or phone number\n */\n\nimport type { ApiChat, ApiUser } from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'search_contacts',\n  description: 'Search for contacts by name, username, or phone number',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      query: {\n        type: 'string',\n        description: 'The search term to look for in contact names, usernames, or phone numbers',\n      },\n    },\n    required: ['query'],\n  },\n};\n\nexport async function searchContacts(\n  args: { query: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { query } = args;\n\n    // Use callApi to search contacts\n    const result = await callApi('searchChats', { query });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No contacts found matching '${query}'.`,\n          },\n        ],\n      };\n    }\n\n    // Get all result IDs (both account and global)\n    const allResultIds = [...result.accountResultIds, ...result.globalResultIds];\n    if (allResultIds.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No contacts found matching '${query}'.`,\n          },\n        ],\n      };\n    }\n\n    // Get chats from global state and filter to only users (contacts)\n    const global = context.global;\n    const entities = allResultIds\n      .map((id: string) => {\n        const chat = global.chats.byId[id];\n        const user = global.users.byId[id];\n        return (chat || user) as ApiChat | ApiUser | undefined;\n      })\n      .filter((entity): entity is ApiChat | ApiUser => {\n        if (!entity) return false;\n        if ('type' in entity) {\n          return entity.type === 'chatTypePrivate';\n        }\n        return 'firstName' in entity;\n      });\n\n    if (entities.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No contacts found matching '${query}'.`,\n          },\n        ],\n      };\n    }\n\n    const lines = entities.map((entity: ApiChat | ApiUser) => {\n      let name = 'Unknown';\n      if ('title' in entity) {\n        name = entity.title;\n      } else if ('firstName' in entity) {\n        const firstName = entity.firstName || '';\n        const lastName = entity.lastName || '';\n        name = `${firstName} ${lastName}`.trim() || 'Unknown';\n      }\n      const username = entity.usernames?.[0]?.username;\n      const phone = 'phoneNumber' in entity ? entity.phoneNumber : undefined;\n\n      let contactInfo = `ID: ${entity.id}, Name: ${name}`;\n      if (username) {\n        contactInfo += `, Username: @${username}`;\n      }\n      if (phone && typeof phone === 'string') {\n        contactInfo += `, Phone: ${phone}`;\n      }\n      return contactInfo;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'search_contacts',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Add Contact tool - Add a new contact to your Telegram account\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'add_contact',\n  description: 'Add a new contact to your Telegram account',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      phone: {\n        type: 'string',\n        description: 'The phone number of the contact (with country code)',\n      },\n      first_name: {\n        type: 'string',\n        description: 'The contact\\'s first name',\n      },\n      last_name: {\n        type: 'string',\n        description: 'The contact\\'s last name (optional)',\n      },\n    },\n    required: ['phone', 'first_name'],\n  },\n};\n\nexport async function addContact(\n  args: { phone: string; first_name: string; last_name?: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { phone, first_name, last_name = '' } = args;\n\n    if (!phone || typeof phone !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Phone number is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!first_name || typeof first_name !== 'string') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'First name is required',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('importContact', {\n      phone,\n      firstName: first_name,\n      lastName: last_name || '',\n    });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to add contact.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Contact ${first_name} ${last_name}`.trim() + ' added successfully.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'add_contact',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Delete Contact tool - Delete a contact by user ID\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'delete_contact',\n  description: 'Delete a contact by user ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The Telegram user ID or username of the contact to delete',\n      },\n    },\n    required: ['user_id'],\n  },\n};\n\nexport async function deleteContact(\n  args: { user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const userId = validateId(args.user_id, 'user_id');\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('deleteContact', {\n      id: user.id,\n      accessHash: user.accessHash,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Contact with user ID ${userId} deleted.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'delete_contact',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Block User tool - Block a user by user ID\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'block_user',\n  description: 'Block a user by user ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The Telegram user ID or username to block',\n      },\n    },\n    required: ['user_id'],\n  },\n};\n\nexport async function blockUser(\n  args: { user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const userId = validateId(args.user_id, 'user_id');\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('blockUser', {\n      user,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} blocked.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'block_user',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Unblock User tool - Unblock a user by user ID\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'unblock_user',\n  description: 'Unblock a user by user ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The Telegram user ID or username to unblock',\n      },\n    },\n    required: ['user_id'],\n  },\n};\n\nexport async function unblockUser(\n  args: { user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const userId = validateId(args.user_id, 'user_id');\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    await callApi('unblockUser', {\n      user,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} unblocked.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'unblock_user',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Get Blocked Users tool - Get a list of blocked users\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { selectUser } from '../../../../global/selectors';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_blocked_users',\n  description: 'Get a list of blocked users',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getBlockedUsers(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const result = await callApi('fetchBlockedUsers', {});\n\n    if (!result?.blockedIds || result.blockedIds.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No blocked users found.',\n          },\n        ],\n      };\n    }\n\n    // Get user details from global state\n    const users = result.blockedIds\n      .map((userId: string) => selectUser(context.global, userId))\n      .filter((user): user is NonNullable<typeof user> => user !== undefined);\n\n    if (users.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No blocked users found.',\n          },\n        ],\n      };\n    }\n\n    const lines = users.map((user) => {\n      const name = `${user.firstName || ''} ${user.lastName || ''}`.trim() || 'Unknown';\n      const username = user.usernames?.[0]?.username ? ` (@${user.usernames[0].username})` : '';\n      return `ID: ${user.id}, Name: ${name}${username}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_blocked_users',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Get Me tool - Get your own user information\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity, getCurrentUser } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'get_me',\n  description: 'Get your own user information',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getMe(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  await Promise.resolve(); // Ensure async\n  try {\n    const user = getCurrentUser();\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'User information not available',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const entity = formatEntity(user);\n    const result = {\n      id: entity.id,\n      name: entity.name,\n      type: entity.type,\n      ...(entity.username && { username: entity.username }),\n      ...(entity.phone && { phone: entity.phone }),\n    };\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(result, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_me',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Update Profile tool - Update your profile information\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'update_profile',\n  description: 'Update your profile information (name, bio)',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      first_name: {\n        type: 'string',\n        description: 'First name',\n      },\n      last_name: {\n        type: 'string',\n        description: 'Last name',\n      },\n      about: {\n        type: 'string',\n        description: 'Bio/about text',\n      },\n    },\n  },\n};\n\nexport async function updateProfile(\n  args: { first_name?: string; last_name?: string; about?: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { first_name, last_name, about } = args;\n\n    await callApi('updateProfile', {\n      firstName: first_name,\n      lastName: last_name,\n      about,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: 'Profile updated successfully.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'update_profile',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Get User Photos tool - Get a user's profile photos\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_user_photos',\n  description: 'Get a user\\'s profile photos',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The user ID or username',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of photos to retrieve',\n        default: 20,\n      },\n    },\n    required: ['user_id'],\n  },\n};\n\nexport async function getUserPhotos(\n  args: { user_id: string | number; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const userId = validateId(args.user_id, 'user_id');\n    const { limit = 20 } = args;\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('fetchProfilePhotos', {\n      peer: user,\n      limit,\n    });\n\n    if (!result?.photos || result.photos.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No profile photos found for this user.',\n          },\n        ],\n      };\n    }\n\n    const lines = result.photos.map((photo: { id: string; date?: number }) => {\n      const dateStr = photo.date ? new Date(photo.date * 1000).toISOString() : 'Unknown date';\n      return `Photo ID: ${photo.id}, Date: ${dateStr}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Found ${result.photos.length} profile photo(s):\\n${lines.join('\\n')}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_user_photos',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Get User Status tool - Get a user's online status\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_user_status',\n  description: 'Get a user\\'s online status',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      user_id: {\n        type: ['string', 'number'],\n        description: 'The user ID or username',\n      },\n    },\n    required: ['user_id'],\n  },\n};\n\nexport async function getUserStatus(\n  args: { user_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const userId = validateId(args.user_id, 'user_id');\n\n    const user = getUserById(userId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User with ID or username \"${userId}\" not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get full user info to access status\n    const fullInfo = await callApi('fetchFullUser', {\n      id: user.id,\n      accessHash: user.accessHash,\n    });\n\n    if (!fullInfo?.fullInfo) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Unable to fetch user status.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const status = fullInfo.fullInfo.status;\n    let statusText = 'Unknown';\n\n    if (!status) {\n      statusText = 'No status available';\n    } else if (status.type === 'userStatusOnline') {\n      statusText = 'Online';\n    } else if (status.type === 'userStatusOffline') {\n      const wasOnline = status.wasOnline ? new Date(status.wasOnline * 1000).toISOString() : 'Unknown';\n      statusText = `Last seen: ${wasOnline}`;\n    } else if (status.type === 'userStatusRecently') {\n      statusText = 'Recently online';\n    } else if (status.type === 'userStatusLastWeek') {\n      statusText = 'Last seen within a week';\n    } else if (status.type === 'userStatusLastMonth') {\n      statusText = 'Last seen within a month';\n    } else if (status.type === 'userStatusLongTimeAgo') {\n      statusText = 'Last seen a long time ago';\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `User ${userId} status: ${statusText}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_user_status',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Search Public Chats tool - Search for public chats, channels, or bots\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity, searchChats } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'search_public_chats',\n  description: 'Search for public chats, channels, or bots by username or title',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      query: {\n        type: 'string',\n        description: 'Search query',\n      },\n    },\n    required: ['query'],\n  },\n};\n\nexport async function searchPublicChats(\n  args: { query: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { query } = args;\n\n    const chats = await searchChats(query);\n    const results = chats.map(formatEntity);\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(results, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'search_public_chats',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.SEARCH,\n    );\n  }\n}\n","/**\n * Search Messages tool - Search for messages in a chat by text\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatMessage, getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'search_messages',\n  description: 'Search for messages in a chat by text',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n      query: {\n        type: 'string',\n        description: 'Search query',\n      },\n      limit: {\n        type: 'number',\n        description: 'Maximum number of messages to return',\n        default: 20,\n      },\n    },\n    required: ['chat_id', 'query'],\n  },\n};\n\nexport async function searchMessages(\n  args: { chat_id: string | number; query: string; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { query, limit = 20 } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('searchMessagesInChat', {\n      peer: chat,\n      query,\n      limit,\n      type: 'text',\n    });\n\n    if (!result || !result.messages) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No messages found',\n          },\n        ],\n      };\n    }\n\n    const messages = result.messages.map(formatMessage);\n    const lines = messages.map((msg) => {\n      const replyInfo = msg.from_id ? ` | From: ${msg.from_id}` : '';\n      return `ID: ${msg.id}${replyInfo} | Date: ${msg.date} | Message: ${msg.text}`;\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: lines.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'search_messages',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.SEARCH,\n    );\n  }\n}\n","/**\n * Resolve Username tool - Resolve a username to a user or chat ID\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'resolve_username',\n  description: 'Resolve a username to a user or chat ID',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      username: {\n        type: 'string',\n        description: 'Username to resolve (without @)',\n      },\n    },\n    required: ['username'],\n  },\n};\n\nexport async function resolveUsername(\n  args: { username: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { username } = args;\n    const cleanUsername = username.startsWith('@') ? username.slice(1) : username;\n\n    const result = await callApi('getChatByUsername', {\n      username: cleanUsername,\n    });\n\n    if (!result || !result.chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Username ${username} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const entity = formatEntity(result.chat);\n    const userEntity = result.user ? formatEntity(result.user) : undefined;\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify({\n            chat: entity,\n            ...(userEntity && { user: userEntity }),\n          }, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'resolve_username',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.SEARCH,\n    );\n  }\n}\n","/**\n * Get Media Info tool - Get info about media in a message\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\nimport { MESSAGE_DELETED } from '../../../../api/types/messages';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_media_info',\n  description: 'Get info about media in a message',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n      message_id: {\n        type: 'number',\n        description: 'The message ID',\n      },\n    },\n    required: ['chat_id', 'message_id'],\n  },\n};\n\nexport async function getMediaInfo(\n  args: { chat_id: string | number; message_id: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { message_id } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const messageResult = await callApi('fetchMessage', {\n      chat,\n      messageId: message_id,\n    });\n\n    if (!messageResult || messageResult === MESSAGE_DELETED) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Message ${message_id} not found or has been deleted`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const message = messageResult.message;\n\n    const hasMedia = message.content\n      && ('photo' in message.content || 'video' in message.content || 'document' in message.content\n        || 'audio' in message.content || 'voice' in message.content);\n\n    if (!hasMedia) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No media found in the specified message.',\n          },\n        ],\n      };\n    }\n\n    const mediaInfo: Record<string, any> = {\n      message_id: message.id,\n      chat_id: chatId,\n    };\n\n    if ('photo' in message.content && message.content.photo) {\n      mediaInfo.media_type = 'photo';\n      mediaInfo.photo = {\n        id: message.content.photo.id,\n        sizes: message.content.photo.sizes?.length || 0,\n      };\n    } else if ('video' in message.content && message.content.video) {\n      mediaInfo.media_type = 'video';\n      mediaInfo.video = {\n        id: message.content.video.id,\n        duration: message.content.video.duration,\n        width: message.content.video.width,\n        height: message.content.video.height,\n        mimeType: message.content.video.mimeType,\n      };\n    } else if ('document' in message.content && message.content.document) {\n      mediaInfo.media_type = 'document';\n      mediaInfo.document = {\n        id: message.content.document.id,\n        fileName: message.content.document.fileName,\n        mimeType: message.content.document.mimeType,\n        size: message.content.document.size,\n      };\n    } else if ('audio' in message.content && message.content.audio) {\n      mediaInfo.media_type = 'audio';\n      mediaInfo.audio = {\n        id: message.content.audio.id,\n        duration: message.content.audio.duration,\n        title: message.content.audio.title,\n        performer: message.content.audio.performer,\n      };\n    } else if ('voice' in message.content && message.content.voice) {\n      mediaInfo.media_type = 'voice';\n      mediaInfo.voice = {\n        id: message.content.voice.id,\n        duration: message.content.voice.duration,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(mediaInfo, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_media_info',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MEDIA,\n    );\n  }\n}\n","var S = new Uint8Array(256);\nvar Si = new Uint8Array(256);\nvar T1 = new Uint32Array(256);\nvar T2 = new Uint32Array(256);\nvar T3 = new Uint32Array(256);\nvar T4 = new Uint32Array(256);\nvar T5 = new Uint32Array(256);\nvar T6 = new Uint32Array(256);\nvar T7 = new Uint32Array(256);\nvar T8 = new Uint32Array(256);\nfunction computeTables() {\n    var d = new Uint8Array(256);\n    var t = new Uint8Array(256);\n    var x2;\n    var x4;\n    var x8;\n    var s;\n    var tEnc;\n    var tDec;\n    var x = 0;\n    var xInv = 0;\n    // Compute double and third tables\n    for (var i = 0; i < 256; i++) {\n        d[i] = i << 1 ^ (i >> 7) * 283;\n        t[d[i] ^ i] = i;\n    }\n    for (; !S[x]; x ^= x2 || 1) {\n        // Compute sbox\n        s = xInv ^ xInv << 1 ^ xInv << 2 ^ xInv << 3 ^ xInv << 4;\n        s = s >> 8 ^ s & 255 ^ 99;\n        S[x] = s;\n        Si[s] = x;\n        // Compute MixColumns\n        x8 = d[x4 = d[x2 = d[x]]];\n        tDec = x8 * 0x1010101 ^ x4 * 0x10001 ^ x2 * 0x101 ^ x * 0x1010100;\n        tEnc = d[s] * 0x101 ^ s * 0x1010100;\n        T1[x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n        T2[x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n        T3[x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n        T4[x] = tEnc = tEnc << 24 ^ tEnc >>> 8;\n        T5[s] = tDec = tDec << 24 ^ tDec >>> 8;\n        T6[s] = tDec = tDec << 24 ^ tDec >>> 8;\n        T7[s] = tDec = tDec << 24 ^ tDec >>> 8;\n        T8[s] = tDec = tDec << 24 ^ tDec >>> 8;\n        xInv = t[xInv] || 1;\n    }\n}\n\n/**\n * Gets a uint32 from string in big-endian order order\n */\nfunction s2i(str, pos) {\n    return (str.charCodeAt(pos) << 24\n        ^ str.charCodeAt(pos + 1) << 16\n        ^ str.charCodeAt(pos + 2) << 8\n        ^ str.charCodeAt(pos + 3));\n}\n\n/* eslint-disable import/prefer-default-export */\n/**\n * Helper function for transforming string key to Uint32Array\n */\nfunction getWords(key) {\n    if (key instanceof Uint32Array) {\n        return key;\n    }\n    if (typeof key === 'string') {\n        if (key.length % 4 !== 0)\n            for (var i = key.length % 4; i <= 4; i++)\n                key += '\\0x00';\n        var buf = new Uint32Array(key.length / 4);\n        for (var i = 0; i < key.length; i += 4)\n            buf[i / 4] = s2i(key, i);\n        return buf;\n    }\n    if (key instanceof Uint8Array) {\n        var buf = new Uint32Array(key.length / 4);\n        for (var i = 0; i < key.length; i += 4) {\n            buf[i / 4] = (key[i] << 24\n                ^ key[i + 1] << 16\n                ^ key[i + 2] << 8\n                ^ key[i + 3]);\n        }\n        return buf;\n    }\n    throw new Error('Unable to create 32-bit words');\n}\nfunction xor(left, right, to) {\n    if (to === void 0) { to = left; }\n    for (var i = 0; i < left.length; i++)\n        to[i] = left[i] ^ right[i];\n}\n\ncomputeTables();\n/**\n * Low-level AES Cipher\n */\nvar AES = /** @class */ (function () {\n    function AES(_key) {\n        var key = getWords(_key);\n        if (key.length !== 4 && key.length !== 6 && key.length !== 8) {\n            throw new Error('Invalid key size');\n        }\n        this.encKey = new Uint32Array(4 * key.length + 28);\n        this.decKey = new Uint32Array(4 * key.length + 28);\n        this.encKey.set(key);\n        var rcon = 1;\n        var i = key.length;\n        var tmp;\n        // schedule encryption keys\n        for (; i < 4 * key.length + 28; i++) {\n            tmp = this.encKey[i - 1];\n            // apply sbox\n            if (i % key.length === 0 || (key.length === 8 && i % key.length === 4)) {\n                tmp = S[tmp >>> 24] << 24 ^ S[(tmp >> 16) & 255] << 16 ^ S[(tmp >> 8) & 255] << 8 ^ S[tmp & 255];\n                // shift rows and add rcon\n                if (i % key.length === 0) {\n                    tmp = tmp << 8 ^ tmp >>> 24 ^ (rcon << 24);\n                    rcon = rcon << 1 ^ (rcon >> 7) * 283;\n                }\n            }\n            this.encKey[i] = this.encKey[i - key.length] ^ tmp;\n        }\n        // schedule decryption keys\n        for (var j = 0; i; j++, i--) {\n            tmp = this.encKey[j & 3 ? i : i - 4];\n            if (i <= 4 || j < 4) {\n                this.decKey[j] = tmp;\n            }\n            else {\n                this.decKey[j] = (T5[S[tmp >>> 24]]\n                    ^ T6[S[(tmp >> 16) & 255]]\n                    ^ T7[S[(tmp >> 8) & 255]]\n                    ^ T8[S[tmp & 255]]);\n            }\n        }\n    }\n    AES.prototype.encrypt = function (_message) {\n        var message = getWords(_message);\n        var out = new Uint32Array(4);\n        var a = message[0] ^ this.encKey[0];\n        var b = message[1] ^ this.encKey[1];\n        var c = message[2] ^ this.encKey[2];\n        var d = message[3] ^ this.encKey[3];\n        var rounds = this.encKey.length / 4 - 2;\n        var k = 4;\n        var a2;\n        var b2;\n        var c2;\n        // Inner rounds.  Cribbed from OpenSSL.\n        for (var i = 0; i < rounds; i++) {\n            a2 = T1[a >>> 24] ^ T2[(b >> 16) & 255] ^ T3[(c >> 8) & 255] ^ T4[d & 255] ^ this.encKey[k];\n            b2 = T1[b >>> 24] ^ T2[(c >> 16) & 255] ^ T3[(d >> 8) & 255] ^ T4[a & 255] ^ this.encKey[k + 1];\n            c2 = T1[c >>> 24] ^ T2[(d >> 16) & 255] ^ T3[(a >> 8) & 255] ^ T4[b & 255] ^ this.encKey[k + 2];\n            d = T1[d >>> 24] ^ T2[(a >> 16) & 255] ^ T3[(b >> 8) & 255] ^ T4[c & 255] ^ this.encKey[k + 3];\n            a = a2;\n            b = b2;\n            c = c2;\n            k += 4;\n            // console.log(a, b, c, d);\n        }\n        // Last round.\n        for (var i = 0; i < 4; i++) {\n            out[i] = (S[a >>> 24] << 24\n                ^ S[(b >> 16) & 255] << 16\n                ^ S[(c >> 8) & 255] << 8\n                ^ S[d & 255]\n                ^ this.encKey[k++]);\n            a2 = a;\n            a = b;\n            b = c;\n            c = d;\n            d = a2;\n        }\n        return out;\n    };\n    AES.prototype.decrypt = function (_message) {\n        var message = getWords(_message);\n        var out = new Uint32Array(4);\n        var a = message[0] ^ this.decKey[0];\n        var b = message[3] ^ this.decKey[1];\n        var c = message[2] ^ this.decKey[2];\n        var d = message[1] ^ this.decKey[3];\n        var rounds = this.decKey.length / 4 - 2;\n        var a2;\n        var b2;\n        var c2;\n        var k = 4;\n        // Inner rounds.  Cribbed from OpenSSL.\n        for (var i = 0; i < rounds; i++) {\n            a2 = T5[a >>> 24] ^ T6[(b >> 16) & 255] ^ T7[(c >> 8) & 255] ^ T8[d & 255] ^ this.decKey[k];\n            b2 = T5[b >>> 24] ^ T6[(c >> 16) & 255] ^ T7[(d >> 8) & 255] ^ T8[a & 255] ^ this.decKey[k + 1];\n            c2 = T5[c >>> 24] ^ T6[(d >> 16) & 255] ^ T7[(a >> 8) & 255] ^ T8[b & 255] ^ this.decKey[k + 2];\n            d = T5[d >>> 24] ^ T6[(a >> 16) & 255] ^ T7[(b >> 8) & 255] ^ T8[c & 255] ^ this.decKey[k + 3];\n            a = a2;\n            b = b2;\n            c = c2;\n            k += 4;\n        }\n        // Last round.\n        for (var i = 0; i < 4; i++) {\n            out[3 & -i] = (Si[a >>> 24] << 24\n                ^ Si[(b >> 16) & 255] << 16\n                ^ Si[(c >> 8) & 255] << 8\n                ^ Si[d & 255]\n                ^ this.decKey[k++]);\n            a2 = a;\n            a = b;\n            b = c;\n            c = d;\n            d = a2;\n        }\n        return out;\n    };\n    return AES;\n}());\n\n/**\n * AES-IGE mode.\n */\nvar AES_IGE = /** @class */ (function () {\n    function AES_IGE(key, iv, blockSize) {\n        if (blockSize === void 0) { blockSize = 16; }\n        this.key = getWords(key);\n        this.iv = getWords(iv);\n        this.cipher = new AES(key);\n        this.blockSize = blockSize / 4;\n    }\n    /**\n     * Encrypts plain text with AES-IGE mode.\n     */\n    AES_IGE.prototype.encrypt = function (message, buf) {\n        var text = getWords(message);\n        var cipherText = buf || new Uint32Array(text.length);\n        var prevX = this.iv.subarray(this.blockSize, this.iv.length);\n        var prevY = this.iv.subarray(0, this.blockSize);\n        var yXOR = new Uint32Array(this.blockSize);\n        for (var i = 0; i < text.length; i += this.blockSize) {\n            var x = text.subarray(i, i + this.blockSize);\n            xor(x, prevY, yXOR);\n            var y = this.cipher.encrypt(yXOR);\n            xor(y, prevX);\n            prevX = x;\n            prevY = y;\n            for (var j = i, k = 0; j < text.length && k < 4; j++, k++)\n                cipherText[j] = y[k];\n        }\n        return cipherText;\n    };\n    /**\n     * Decrypts cipher text with AES-IGE mode.\n     */\n    AES_IGE.prototype.decrypt = function (message, buf) {\n        var cipherText = getWords(message);\n        var text = buf || new Uint32Array(cipherText.length);\n        var prevY = this.iv.subarray(this.blockSize, this.iv.length);\n        var prevX = this.iv.subarray(0, this.blockSize);\n        var yXOR = new Uint32Array(this.blockSize);\n        for (var i = 0; i < text.length; i += this.blockSize) {\n            var x = cipherText.subarray(i, i + this.blockSize);\n            xor(x, prevY, yXOR);\n            var y = this.cipher.decrypt(yXOR);\n            xor(y, prevX);\n            prevX = x;\n            prevY = y;\n            for (var j = i, k = 0; j < text.length && k < 4; j++, k++)\n                text[j] = y[k];\n        }\n        return text;\n    };\n    return AES_IGE;\n}());\n\n/**\n * AES-IGE mode.\n */\nvar AES_IGE$1 = /** @class */ (function () {\n    function AES_IGE(key, counter, blockSize) {\n        if (blockSize === void 0) { blockSize = 16; }\n        this.offset = 0;\n        this.key = getWords(key);\n        this.counter = getWords(counter);\n        this.cipher = new AES(key);\n        this.blockSize = blockSize / 4;\n        if (this.counter.length !== 4) {\n            throw new Error('AES-CTR mode counter must be 16 bytes length');\n        }\n    }\n    /**\n     * Encrypts plain text with AES-IGE mode.\n     */\n    AES_IGE.prototype.encrypt = function (message, buf) {\n        var text = getWords(message);\n        var cipherText = buf || new Uint32Array(text.length);\n        var offset = this.offset;\n        for (var i = 0; i < text.length; i += this.blockSize) {\n            var x = this.cipher.encrypt(this.counter);\n            for (var j = i, k = offset; j < text.length && k < this.blockSize; j++, k++)\n                cipherText[j] = x[k] ^ text[j];\n            if (text.length - i >= this.blockSize)\n                this.incrementCounter();\n            if (offset) {\n                i -= offset;\n                offset = 0;\n            }\n        }\n        this.offset = (this.offset + (text.length % 4)) % 4;\n        return cipherText;\n    };\n    /**\n     * Decrypts cipher text with AES-IGE mode.\n     */\n    AES_IGE.prototype.decrypt = function (message, buf) {\n        return this.encrypt(message, buf);\n    };\n    AES_IGE.prototype.incrementCounter = function () {\n        // increment counter\n        for (var carry = this.counter.length - 1; carry >= 0; carry--) {\n            if (++this.counter[carry] < 0xFFFFFFFF)\n                break; // If overflowing, it'll be 0 and we'll have to continue propagating the carry\n        }\n    };\n    return AES_IGE;\n}());\n\nexport default AES;\nexport { AES_IGE$1 as CTR, AES_IGE as IGE };\n","import { createHash, randomBytes } from './crypto/crypto';\n\nexport function readBigIntFromBuffer(buffer: Buffer, little = true, signed = false): bigint {\n  const len = buffer.length;\n  if (len === 0) return 0n;\n\n  // Hot path for longs\n  if (len === 8) {\n    if (signed) {\n      return little ? buffer.readBigInt64LE(0) : buffer.readBigInt64BE(0);\n    } else {\n      return little ? buffer.readBigUInt64LE(0) : buffer.readBigUInt64BE(0);\n    }\n  }\n\n  // Parse unsigned value\n  let x = 0n;\n  if (little) {\n    for (let i = len - 1; i >= 0; i--) x = (x << 8n) | BigInt(buffer[i]);\n  } else {\n    for (let i = 0; i < len; i++) x = (x << 8n) | BigInt(buffer[i]);\n  }\n\n  // Apply two's-complement decode if signed and sign bit is set\n  if (signed) {\n    const signBit = 1n << BigInt(len * 8 - 1);\n    if ((x & signBit) !== 0n) x -= 1n << BigInt(len * 8);\n  }\n  return x;\n}\n\nexport function toSignedLittleBuffer(big: bigint, number = 8) {\n  const buffer = Buffer.allocUnsafe(number);\n\n  // Use Buffer method for 8-byte buffers\n  if (number === 8) {\n    buffer.writeBigInt64LE(big);\n    return buffer;\n  }\n\n  // For other sizes, extract bytes manually\n  for (let i = 0; i < number; i++) {\n    buffer[i] = Number((big >> BigInt(8 * i)) & 0xFFn);\n  }\n\n  return buffer;\n}\n\nexport function readBufferFromBigInt(\n  value: bigint,\n  bytesNumber: number,\n  little = true,\n  signed = false,\n): Buffer<ArrayBuffer> {\n  if (!Number.isInteger(bytesNumber) || bytesNumber <= 0) {\n    throw new RangeError('bytesNumber must be a positive integer');\n  }\n  if (!signed && value < 0n) {\n    throw new RangeError('Cannot convert negative to unsigned');\n  }\n\n  const bits = 8n * BigInt(bytesNumber);\n  const min = signed ? -(1n << (bits - 1n)) : 0n;\n  const max = signed ? (1n << (bits - 1n)) - 1n : (1n << bits) - 1n;\n\n  if (value < min || value > max) {\n    throw new RangeError(\n      `Value ${value} does not fit in ${bytesNumber} ${signed ? 'signed' : 'unsigned'} bytes`,\n    );\n  }\n\n  // Two's complement encode if negative\n  let v = signed && value < 0n ? (1n << bits) + value : value;\n\n  const buf = Buffer.allocUnsafe(bytesNumber);\n  if (little) {\n    for (let i = 0; i < bytesNumber; i++) {\n      buf[i] = Number(v & 0xFFn);\n      v >>= 8n;\n    }\n  } else {\n    for (let i = bytesNumber - 1; i >= 0; i--) {\n      buf[i] = Number(v & 0xFFn);\n      v >>= 8n;\n    }\n  }\n  return buf;\n}\n\nexport function generateRandomLong(signed = true) {\n  return readBigIntFromBuffer(generateRandomBytes(8), true, signed);\n}\n\nexport function mod(n: number, m: number) {\n  return ((n % m) + m) % m;\n}\n\nexport function bigIntMod(n: bigint, m: bigint) {\n  return ((n % m) + m) % m;\n}\n\nexport function generateRandomBytes(count: number) {\n  return Buffer.from(randomBytes(count));\n}\n\nexport function generateRandomBigInt(bytes: number = 8) {\n  return readBigIntFromBuffer(generateRandomBytes(bytes), true, true);\n}\n\nexport function generateRandomInt32() {\n  return Number(readBigIntFromBuffer(generateRandomBytes(4), true, true));\n}\n\nexport async function generateKeyDataFromNonce(\n  serverNonceBigInt: bigint, newNonceBigInt: bigint,\n) {\n  const serverNonce = toSignedLittleBuffer(serverNonceBigInt, 16);\n  const newNonce = toSignedLittleBuffer(newNonceBigInt, 32);\n  const [hash1, hash2, hash3] = await Promise.all([\n    sha1(Buffer.concat([newNonce, serverNonce])),\n    sha1(Buffer.concat([serverNonce, newNonce])),\n    sha1(Buffer.concat([newNonce, newNonce])),\n  ]);\n  const keyBuffer = Buffer.concat([hash1, hash2.slice(0, 12)]);\n  const ivBuffer = Buffer.concat([hash2.slice(12, 20), hash3, newNonce.slice(0, 4)]);\n  return {\n    key: keyBuffer,\n    iv: ivBuffer,\n  };\n}\n\nexport function convertToLittle(buf: Uint32Array) {\n  const correct = Buffer.allocUnsafe(buf.length * 4);\n\n  for (let i = 0; i < buf.length; i++) {\n    correct.writeUInt32BE(buf[i], i * 4);\n  }\n  return correct;\n}\n\nexport function sha1(data: Buffer): Promise<Buffer<ArrayBuffer>> {\n  const shaSum = createHash('sha1');\n  shaSum.update(data);\n  return shaSum.digest();\n}\n\nexport function sha256(data: Buffer): Promise<Buffer<ArrayBuffer>> {\n  const shaSum = createHash('sha256');\n  shaSum.update(data);\n  return shaSum.digest();\n}\n\nexport function modExp(\n  a: bigint,\n  b: bigint,\n  n: bigint,\n) {\n  a = a % n;\n  let result = 1n;\n  let x = a;\n  while (b > 0n) {\n    const leastSignificantBit = b % 2n;\n    b = b / 2n;\n    if (leastSignificantBit === 1n) {\n      result = result * x;\n      result = result % n;\n    }\n    x = x * x;\n    x = x % n;\n  }\n  return result;\n}\n\nexport function getByteArray(integer: bigint, signed = false): Buffer<ArrayBuffer> {\n  if (!signed && integer < 0n) {\n    throw new RangeError('Cannot convert negative to unsigned');\n  }\n\n  let bytes: number;\n  if (signed) {\n    if (integer >= 0n) {\n      const bits = bitLength(integer) + 1;\n      bytes = Math.max(1, Math.ceil(bits / 8));\n    } else {\n      const bits = bitLength(-integer - 1n) + 1;\n      bytes = Math.max(1, Math.ceil(bits / 8));\n    }\n  } else {\n    const bits = bitLength(integer);\n    bytes = Math.max(1, Math.ceil(bits / 8));\n  }\n\n  return readBufferFromBigInt(integer, bytes, false, signed);\n}\n\nexport function randomBits(k: number): bigint {\n  if (k <= 0) return 0n;\n\n  const bytes = randomBytes(Math.ceil(k / 8));\n\n  let r = 0n;\n  for (let i = 0; i < bytes.length; i++) {\n    r = (r << 8n) | BigInt(bytes[i]);\n  }\n\n  return r & ((1n << BigInt(k)) - 1n);\n}\n\nexport function randBetweenBigInt(a: bigint, b: bigint): bigint {\n  const low = a < b ? a : b;\n  const high = a < b ? b : a;\n  const range = high - low + 1n;\n\n  if (range <= 1n) return low;\n\n  const k = bitLength(range - 1n);\n  const twoPowK = 1n << BigInt(k);\n  const limit = (twoPowK / range) * range;\n\n  for (;;) {\n    const r = randomBits(k);\n    if (r < limit) return low + (r % range);\n  }\n}\n\nexport function sleep(ms: number) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\nexport function bufferXor(a: Buffer, b: Buffer) {\n  const res = [];\n  for (let i = 0; i < a.length; i++) {\n    res.push(a[i] ^ b[i]);\n  }\n  return Buffer.from(res);\n}\n\n// Taken from https://stackoverflow.com/questions/18638900/javascript-crc32/18639999#18639999\nexport const CRC32_TABLE = (() => {\n  let c;\n  const crcTable = [];\n  for (let n = 0; n < 256; n++) {\n    c = n;\n    for (let k = 0; k < 8; k++) {\n      c = ((c & 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\n    }\n    crcTable[n] = c;\n  }\n  return crcTable;\n})();\n\nexport function crc32(buf: Buffer | string) {\n  if (!Buffer.isBuffer(buf)) {\n    buf = Buffer.from(buf);\n  }\n  let crc = -1;\n\n  for (let index = 0; index < buf.length; index++) {\n    const byte = buf[index];\n    crc = CRC32_TABLE[(crc ^ byte) & 0xff] ^ (crc >>> 8);\n  }\n  return (crc ^ (-1)) >>> 0;\n}\n\nconst testersCoeff: number[] = [];\nconst testersBigCoeff: bigint[] = [];\nconst testers: bigint[] = [];\nlet testersN = 0;\n\n// https://stackoverflow.com/a/76616288\nexport function bitLength(x: bigint) {\n  let k = 0;\n  while (true) {\n    if (testersN === k) {\n      testersCoeff.push(32 << testersN);\n      testersBigCoeff.push(BigInt(testersCoeff[testersN]));\n      testers.push(1n << testersBigCoeff[testersN]);\n      testersN++;\n    }\n    if (x < testers[k]) break;\n    k++;\n  }\n\n  if (!k) return 32 - Math.clz32(Number(x));\n\n  // determine length by bisection\n  k--;\n  let i = testersCoeff[k];\n  let a = x >> testersBigCoeff[k];\n  while (k--) {\n    const b = a >> testersBigCoeff[k];\n    if (b) {\n      i += testersCoeff[k];\n      a = b;\n    }\n  }\n\n  return i + 32 - Math.clz32(Number(a));\n}\n\nexport const BigMath = {\n  abs(x: bigint) {\n    return x < 0n ? -x : x;\n  },\n  sign(x: bigint) {\n    if (x === 0n) return 0n;\n    return x < 0n ? -1n : 1n;\n  },\n  pow(base: bigint, exponent: bigint) {\n    return base ** exponent;\n  },\n  min(value: bigint, ...values: bigint[]) {\n    for (const v of values) {\n      if (v < value) value = v;\n    }\n    return value;\n  },\n  max(value: bigint, ...values: bigint[]) {\n    for (const v of values) {\n      if (v > value) value = v;\n    }\n    return value;\n  },\n};\n\nexport function jsonStringifyWithBigInt(obj: any) {\n  return JSON.stringify(obj, (key, value) => {\n    if (typeof value === 'bigint') {\n      return value.toString();\n    }\n    return value;\n  });\n}\n","import { crc32 } from '../Helpers';\n\nexport interface GenerationEntryConfig {\n    name: string;\n    constructorId: number;\n    argsConfig: Record<string, GenerationArgConfig>;\n    subclassOfId: number;\n    result: string;\n    isFunction?: boolean;\n    namespace: string | undefined;\n}\n\nexport interface GenerationArgConfig {\n    isVector: boolean;\n    isFlag: boolean;\n    skipConstructorId: boolean;\n    flagGroup: number;\n    flagIndex: number;\n    flagIndicator: boolean;\n    type: string;\n    useVectorId: boolean | undefined;\n}\n\nconst snakeToCamelCase = (name: string) => {\n    const result = name.replace(/(?:^|_)([a-z])/g, (_, g) => g.toUpperCase());\n    return result.replace(/_/g, '');\n};\nconst variableSnakeToCamelCase = (str: string) => str.replace(\n    /([-_][a-z])/g,\n    (group) => group.toUpperCase()\n        .replace('-', '')\n        .replace('_', ''),\n);\n\nconst CORE_TYPES = new Set([\n    0xbc799737, // boolFalse#bc799737 = Bool;\n    0x997275b5, // boolTrue#997275b5 = Bool;\n    0x3fedd339, // true#3fedd339 = True;\n    0xc4b9f9bb, // error#c4b9f9bb code:int text:string = Error;\n    0x56730bcc, // null#56730bcc = Null;\n]);\nconst AUTH_KEY_TYPES = new Set([\n    0x05162463, // resPQ,\n    0x83c95aec, // p_q_inner_data\n    0xa9f55f95, // p_q_inner_data_dc\n    0x3c6a84d4, // p_q_inner_data_temp\n    0x56fddf88, // p_q_inner_data_temp_dc\n    0xd0e8075c, // server_DH_params_ok\n    0xb5890dba, // server_DH_inner_data\n    0x6643b654, // client_DH_inner_data\n    0xd712e4be, // req_DH_params\n    0xf5045f1f, // set_client_DH_params\n    0x3072cfa1, // gzip_packed\n]);\n\nconst findAll = (regex: RegExp, str: string, matches: string[][] = []) => {\n    if (!regex.flags.includes('g')) {\n        regex = new RegExp(regex.source, 'g');\n    }\n\n    const res = regex.exec(str);\n\n    if (res) {\n        matches.push(res.slice(1));\n        findAll(regex, str, matches);\n    }\n\n    return matches;\n};\n\nconst fromLine = (line: string, isFunction?: boolean) => {\n    const match = line.match(/([\\w.]+)(?:#([0-9a-fA-F]+))?(?:\\s{?\\w+:[\\w\\d<>#.?!]+}?)*\\s=\\s([\\w\\d<>#.?]+);$/);\n    if (!match) {\n        // Probably \"vector#1cb5c415 {t:Type} # [ t ] = Vector t;\"\n        throw new Error(`Cannot parse TLObject ${line}`);\n    }\n\n    const argsMatch = findAll(/({)?(\\w+):([\\w\\d<>#.?!]+)}?/, line);\n    const currentConfig: GenerationEntryConfig = {\n        name: match[1],\n        constructorId: parseInt(match[2], 16),\n        argsConfig: {},\n        subclassOfId: crc32(match[3]),\n        result: match[3],\n        isFunction,\n        namespace: undefined,\n    };\n    if (!currentConfig.constructorId) {\n        const hexId = '';\n        let args;\n\n        if (Object.values(currentConfig.argsConfig).length) {\n            args = ` ${Object.keys(currentConfig.argsConfig)\n                .map((arg) => arg.toString())\n                .join(' ')}`;\n        } else {\n            args = '';\n        }\n\n        const representation = `${currentConfig.name}${hexId}${args} = ${currentConfig.result}`\n            .replace(/(:|\\?)bytes /g, '$1string ')\n            .replace(/</g, ' ')\n            .replace(/>|{|}/g, '')\n            .replace(/ \\w+:flags\\d*\\.\\d+\\?true/g, '');\n\n        if (currentConfig.name === 'inputMediaInvoice') {\n            // eslint-disable-next-line no-empty\n            if (currentConfig.name === 'inputMediaInvoice') {\n            }\n        }\n\n        currentConfig.constructorId = crc32(Buffer.from(representation, 'utf8'));\n    }\n    for (const [brace, name, argType] of argsMatch) {\n        if (brace === undefined) {\n            currentConfig.argsConfig[variableSnakeToCamelCase(name)] = buildArgConfig(name, argType);\n        }\n    }\n    if (currentConfig.name.includes('.')) {\n        [currentConfig.namespace, currentConfig.name] = currentConfig.name.split(/\\.(.+)/);\n    }\n    currentConfig.name = snakeToCamelCase(currentConfig.name);\n    /*\n    for (const arg in currentConfig.argsConfig){\n      if (currentConfig.argsConfig.hasOwnProperty(arg)){\n        if (currentConfig.argsConfig[arg].flagIndicator){\n          delete  currentConfig.argsConfig[arg]\n        }\n      }\n    } */\n    return currentConfig;\n};\n\nfunction buildArgConfig(name: string, argType: string) {\n    name = name === 'self' ? 'is_self' : name;\n    // Default values\n    const currentConfig: GenerationArgConfig = {\n        isVector: false,\n        isFlag: false,\n        skipConstructorId: false,\n        flagGroup: 0,\n        flagIndex: -1,\n        flagIndicator: true,\n        type: '',\n        useVectorId: undefined,\n    };\n\n    // The type can be an indicator that other arguments will be flags\n    if (argType !== '#') {\n        currentConfig.flagIndicator = false;\n        // Strip the exclamation mark always to have only the name\n        currentConfig.type = argType.replace(/^!+/, '');\n\n        // The type may be a flag (flags[N].IDX?REAL_TYPE)\n        // Note that 'flags' is NOT the flags name; this\n        // is determined by a previous argument\n        // However, we assume that the argument will always be called 'flags[N]'\n        const flagMatch = currentConfig.type.match(/flags(\\d*)\\.(\\d+)\\?([\\w<>.]+)/);\n\n        if (flagMatch) {\n            currentConfig.isFlag = true;\n            currentConfig.flagGroup = Number(flagMatch[1] || 1);\n            currentConfig.flagIndex = Number(flagMatch[2]);\n            // Update the type to match the exact type, not the \"flagged\" one\n            [, , , currentConfig.type] = flagMatch;\n        }\n\n        // Then check if the type is a Vector<REAL_TYPE>\n        const vectorMatch = currentConfig.type.match(/[Vv]ector<([\\w\\d.]+)>/);\n\n        if (vectorMatch) {\n            currentConfig.isVector = true;\n\n            // If the type's first letter is not uppercase, then\n            // it is a constructor and we use (read/write) its ID.\n            currentConfig.useVectorId = currentConfig.type.charAt(0) === 'V';\n\n            // Update the type to match the one inside the vector\n            [, currentConfig.type] = vectorMatch;\n        }\n\n        // See use_vector_id. An example of such case is ipPort in\n        // help.configSpecial\n        if (/^[a-z]$/.test(currentConfig.type.split('.')\n            .pop()!\n            .charAt(0))\n        ) {\n            currentConfig.skipConstructorId = true;\n        }\n\n        // The name may contain \"date\" in it, if this is the case and\n        // the type is \"int\", we can safely assume that this should be\n        // treated as a \"date\" object. Note that this is not a valid\n        // Telegram object, but it's easier to work with\n        // if (\n        //     this.type === 'int' &&\n        //     (/(\\b|_)([dr]ate|until|since)(\\b|_)/.test(name) ||\n        //         ['expires', 'expires_at', 'was_online'].includes(name))\n        // ) {\n        //     this.type = 'date';\n        // }\n    }\n    return currentConfig;\n}\n\nexport function* parseTl(content: string, methods: any[] = [], ignoreIds = CORE_TYPES) {\n    (methods || []).reduce((o, m) => ({\n        ...o,\n        [m.name]: m,\n    }), {});\n    const objAll: GenerationEntryConfig[] = [];\n    const objByName: Record<string, GenerationEntryConfig> = {};\n    const objByType: Record<string, GenerationEntryConfig[]> = {};\n\n    const file = content;\n\n    let isFunction = false;\n\n    for (let line of file.split('\\n')) {\n        const commentIndex = line.indexOf('//');\n\n        if (commentIndex !== -1) {\n            line = line.slice(0, commentIndex);\n        }\n\n        line = line.trim();\n\n        if (!line) {\n            continue;\n        }\n\n        const match = line.match(/---(\\w+)---/);\n\n        if (match) {\n            const [, followingTypes] = match;\n            isFunction = followingTypes === 'functions';\n            continue;\n        }\n\n        try {\n            const result = fromLine(line, isFunction);\n\n            if (ignoreIds.has(result.constructorId)) {\n                continue;\n            }\n\n            objAll.push(result);\n\n            if (!result.isFunction) {\n                if (!objByType[result.result]) {\n                    objByType[result.result] = [];\n                }\n\n                objByName[result.name] = result;\n                objByType[result.result].push(result);\n            }\n        } catch (e: any) {\n            if (!e.toString()\n                .includes('vector#1cb5c415')) {\n                throw e;\n            }\n        }\n    }\n\n    // Once all objects have been parsed, replace the\n    // string type from the arguments with references\n    for (const obj of objAll) {\n        // console.log(obj)\n        if (AUTH_KEY_TYPES.has(obj.constructorId)) {\n            for (const arg in obj.argsConfig) {\n                if (obj.argsConfig[arg].type === 'string') {\n                    obj.argsConfig[arg].type = 'bytes';\n                }\n            }\n        }\n    }\n\n    for (const obj of objAll) {\n        yield obj;\n    }\n}\n\nexport function serializeBytes(data: Buffer | string | any) {\n    if (!(data instanceof Buffer)) {\n        if (typeof data === 'string') {\n            data = Buffer.from(data);\n        } else {\n            throw Error(`Bytes or str expected, not ${data.constructor.name}`);\n        }\n    }\n    const r = [];\n    let padding;\n    if (data.length < 254) {\n        padding = (data.length + 1) % 4;\n        if (padding !== 0) {\n            padding = 4 - padding;\n        }\n        r.push(Buffer.from([data.length]));\n        r.push(data);\n    } else {\n        padding = data.length % 4;\n        if (padding !== 0) {\n            padding = 4 - padding;\n        }\n        r.push(Buffer.from([254, data.length % 256, (data.length >> 8) % 256, (data.length >> 16) % 256]));\n        r.push(data);\n    }\n    r.push(Buffer.alloc(padding)\n        .fill(0));\n\n    return Buffer.concat(r);\n}\n\nexport function serializeDate(dt: Date | number) {\n    if (!dt) {\n        return Buffer.alloc(4)\n            .fill(0);\n    }\n    if (dt instanceof Date) {\n        dt = Math.floor((Date.now() - dt.getTime()) / 1000);\n    }\n    if (typeof dt === 'number') {\n        const t = Buffer.alloc(4);\n        t.writeInt32LE(dt, 0);\n        return t;\n    }\n    throw Error(`Cannot interpret \"${dt}\" as a date`);\n}\n","import type { BinaryReader } from '../extensions';\n\nimport tlContent from './apiTl';\nimport {\n    type GenerationArgConfig, type GenerationEntryConfig, parseTl, serializeBytes, serializeDate,\n} from './generationHelpers';\nimport schemeContent from './schemaTl';\n\nimport { toSignedLittleBuffer } from '../Helpers';\n\n// eslint-disable-next-line no-restricted-globals\nconst CACHING_SUPPORTED = typeof self !== 'undefined' && self.localStorage !== undefined;\n\nconst CACHE_KEY = 'GramJs:apiCache';\n\ntype UnsaveVirtualClass = Record<string, any>;\n\nexport function buildApiFromTlSchema() {\n    let definitions;\n    const fromCache = CACHING_SUPPORTED && loadFromCache();\n\n    if (fromCache) {\n        definitions = fromCache;\n    } else {\n        definitions = loadFromTlSchemas();\n\n        if (CACHING_SUPPORTED) {\n            localStorage.setItem(CACHE_KEY, JSON.stringify(definitions));\n        }\n    }\n\n    return mergeWithNamespaces(\n        createClasses('constructor', definitions.constructors),\n        createClasses('request', definitions.requests),\n    );\n}\n\nfunction loadFromCache(): { constructors: GenerationEntryConfig[]; requests: GenerationEntryConfig[] } {\n    const jsonCache = localStorage.getItem(CACHE_KEY);\n    return jsonCache && JSON.parse(jsonCache);\n}\n\nfunction loadFromTlSchemas() {\n    const [constructorParamsApi, functionParamsApi] = extractParams(tlContent);\n    const [constructorParamsSchema, functionParamsSchema] = extractParams(schemeContent);\n    const constructors = ([] as GenerationEntryConfig[]).concat(constructorParamsApi, constructorParamsSchema);\n    const requests = ([] as GenerationEntryConfig[]).concat(functionParamsApi, functionParamsSchema);\n\n    return {\n        constructors,\n        requests,\n    };\n}\n\nfunction mergeWithNamespaces<T extends unknown>(obj1: Record<string, T>, obj2: Record<string, T>): Record<string, T> {\n    const result: Record<string, any> = { ...obj1 };\n\n    Object.keys(obj2)\n        .forEach((key) => {\n            if (typeof obj2[key] === 'function' || !result[key]) {\n                result[key] = obj2[key];\n            } else {\n                Object.assign(result[key], obj2[key]);\n            }\n        });\n\n    return result;\n}\n\nfunction extractParams(fileContent: string) {\n    const f = parseTl(fileContent);\n    const constructors = [];\n    const functions = [];\n    for (const d of f) {\n        if (d.isFunction) {\n            functions.push(d);\n        } else {\n            constructors.push(d);\n        }\n    }\n    return [constructors, functions];\n}\n\nfunction argToBytes(x: any, type: string) {\n    switch (type) {\n        case 'int': {\n            const i = Buffer.alloc(4);\n            i.writeInt32LE(x, 0);\n            return i;\n        }\n        case 'long':\n            return toSignedLittleBuffer(x, 8);\n        case 'int128':\n            return toSignedLittleBuffer(x, 16);\n        case 'int256':\n            return toSignedLittleBuffer(x, 32);\n        case 'double': {\n            const d = Buffer.alloc(8);\n            d.writeDoubleLE(x, 0);\n            return d;\n        }\n        case 'string':\n            return serializeBytes(x);\n        case 'Bool':\n            return x ? Buffer.from('b5757299', 'hex') : Buffer.from('379779bc', 'hex');\n        case 'true':\n            return Buffer.alloc(0);\n        case 'bytes':\n            return serializeBytes(x);\n        case 'date':\n            return serializeDate(x);\n        default:\n            return x.getBytes();\n    }\n}\n\nfunction getArgFromReader(reader: BinaryReader, arg: GenerationArgConfig): any {\n    if (arg.isVector) {\n        if (arg.useVectorId) {\n            reader.readInt();\n        }\n        const temp = [];\n        const len = reader.readInt();\n        arg.isVector = false;\n        for (let i = 0; i < len; i++) {\n            temp.push(getArgFromReader(reader, arg));\n        }\n        arg.isVector = true;\n        return temp;\n    } else if (arg.flagIndicator) {\n        return reader.readInt();\n    } else {\n        switch (arg.type) {\n            case 'int':\n                return reader.readInt();\n            case 'long':\n                return reader.readLong();\n            case 'int128':\n                return reader.readLargeInt(128);\n            case 'int256':\n                return reader.readLargeInt(256);\n            case 'double':\n                return reader.readDouble();\n            case 'string':\n                return reader.tgReadString();\n            case 'Bool':\n                return reader.tgReadBool();\n            case 'true':\n                return true;\n            case 'bytes':\n                return reader.tgReadBytes();\n            case 'date':\n                return reader.tgReadDate();\n            default:\n                if (!arg.skipConstructorId) {\n                    return reader.tgReadObject();\n                } else {\n                    throw new Error(`Unknown type ${arg}`);\n                }\n        }\n    }\n}\n\nfunction createClasses(classesType: 'constructor' | 'request', params: GenerationEntryConfig[]) {\n    const classes: Record<string, any> = {};\n    for (const classParams of params) {\n        const {\n            name,\n            constructorId,\n            subclassOfId,\n            argsConfig,\n            namespace,\n            result,\n        } = classParams;\n        const fullName = [namespace, name].join('.')\n            .replace(/^\\./, '');\n\n        class VirtualClass {\n            static CONSTRUCTOR_ID = constructorId;\n\n            static SUBCLASS_OF_ID = subclassOfId;\n\n            static className = fullName;\n\n            static classType = classesType;\n\n            CONSTRUCTOR_ID = constructorId;\n\n            SUBCLASS_OF_ID = subclassOfId;\n\n            className = fullName;\n\n            classType = classesType;\n\n            constructor(args: Record<string, any>) {\n                args = args || {};\n                Object.keys(args)\n                    .forEach((argName) => {\n                        (this as UnsaveVirtualClass)[argName] = args[argName];\n                    });\n            }\n\n            static fromReader(reader: BinaryReader) {\n                const args: Record<string, any> = {};\n\n                for (const argName in argsConfig) {\n                    if (argsConfig.hasOwnProperty(argName)) {\n                        const arg = argsConfig[argName];\n                        if (arg.isFlag) {\n                            const flagGroupSuffix = arg.flagGroup > 1 ? arg.flagGroup : '';\n                            const flagValue = args[`flags${flagGroupSuffix}`] & (1 << arg.flagIndex);\n                            if (arg.type === 'true') {\n                                args[argName] = Boolean(flagValue);\n                                continue;\n                            }\n\n                            args[argName] = flagValue ? getArgFromReader(reader, arg) : undefined;\n                        } else {\n                            args[argName] = getArgFromReader(reader, arg);\n                        }\n                    }\n                }\n                return new VirtualClass(args);\n            }\n\n            getBytes() {\n                // The next is pseudo-code:\n                const idForBytes = this.CONSTRUCTOR_ID;\n                const c = Buffer.alloc(4);\n                c.writeUInt32LE(idForBytes, 0);\n                const buffers = [c];\n                for (const arg in argsConfig) {\n                    if (argsConfig.hasOwnProperty(arg)) {\n                        if (argsConfig[arg].isFlag) {\n                            if (((this as UnsaveVirtualClass)[arg] === false && argsConfig[arg].type === 'true')\n                                || (this as UnsaveVirtualClass)[arg] === undefined) {\n                                continue;\n                            }\n                        }\n                        if (argsConfig[arg].isVector) {\n                            if (argsConfig[arg].useVectorId) {\n                                buffers.push(Buffer.from('15c4b51c', 'hex'));\n                            }\n                            const l = Buffer.alloc(4);\n                            l.writeInt32LE((this as UnsaveVirtualClass)[arg].length, 0);\n                            buffers.push(l, Buffer.concat((this as UnsaveVirtualClass)[arg].map((x: any) => (\n                                argToBytes(x, argsConfig[arg].type)\n                            ))));\n                        } else if (argsConfig[arg].flagIndicator) {\n                            if (!Object.values(argsConfig)\n                                .some((f) => f.isFlag)) {\n                                buffers.push(Buffer.alloc(4));\n                            } else {\n                                let flagCalculate = 0;\n                                for (const f in argsConfig) {\n                                    if (argsConfig[f].isFlag) {\n                                        if (((this as UnsaveVirtualClass)[f] === false && argsConfig[f].type === 'true')\n                                            || (this as UnsaveVirtualClass)[f] === undefined) {\n                                            flagCalculate |= 0;\n                                        } else {\n                                            flagCalculate |= 1 << argsConfig[f].flagIndex;\n                                        }\n                                    }\n                                }\n                                const f = Buffer.alloc(4);\n                                f.writeUInt32LE(flagCalculate, 0);\n                                buffers.push(f);\n                            }\n                        } else {\n                            buffers.push(argToBytes((this as UnsaveVirtualClass)[arg], argsConfig[arg].type));\n\n                            if ((this as UnsaveVirtualClass)[arg]\n                                && typeof (this as UnsaveVirtualClass)[arg].getBytes === 'function') {\n                                const firstChar = (argsConfig[arg].type.charAt(argsConfig[arg].type.indexOf('.') + 1));\n                                const boxed = firstChar === firstChar.toUpperCase();\n                                if (!boxed) {\n                                    buffers.shift();\n                                }\n                            }\n                        }\n                    }\n                }\n                return Buffer.concat(buffers);\n            }\n\n            readResult(reader: BinaryReader) {\n                if (classesType !== 'request') {\n                    throw new Error('`readResult()` called for non-request instance');\n                }\n\n                const m = result.match(/Vector<(int|long)>/);\n                if (m) {\n                    reader.readInt();\n                    const temp = [];\n                    const len = reader.readInt();\n                    if (m[1] === 'int') {\n                        for (let i = 0; i < len; i++) {\n                            temp.push(reader.readInt());\n                        }\n                    } else {\n                        for (let i = 0; i < len; i++) {\n                            temp.push(reader.readLong());\n                        }\n                    }\n                    return temp;\n                } else {\n                    return reader.tgReadObject();\n                }\n            }\n        }\n\n        if (namespace) {\n            if (!classes[namespace]) {\n                classes[namespace] = {};\n            }\n            classes[namespace][name] = VirtualClass;\n        } else {\n            classes[name] = VirtualClass;\n        }\n    }\n\n    return classes;\n}\n","import { buildApiFromTlSchema } from './apiHelpers.ts';\n\nconst Api = buildApiFromTlSchema();\n\nexport default Api;\n","export default `boolFalse#bc799737 = Bool;\nboolTrue#997275b5 = Bool;\ntrue#3fedd339 = True;\nvector#1cb5c415 {t:Type} # [ t ] = Vector t;\nerror#c4b9f9bb code:int text:string = Error;\nnull#56730bcc = Null;\ninputPeerEmpty#7f3b18ea = InputPeer;\ninputPeerSelf#7da07ec9 = InputPeer;\ninputPeerChat#35a95cb9 chat_id:long = InputPeer;\ninputPeerUser#dde8a54c user_id:long access_hash:long = InputPeer;\ninputPeerChannel#27bcbbfc channel_id:long access_hash:long = InputPeer;\ninputPeerUserFromMessage#a87b0a1c peer:InputPeer msg_id:int user_id:long = InputPeer;\ninputPeerChannelFromMessage#bd2a0840 peer:InputPeer msg_id:int channel_id:long = InputPeer;\ninputUserEmpty#b98886cf = InputUser;\ninputUserSelf#f7c1b13f = InputUser;\ninputUser#f21158c6 user_id:long access_hash:long = InputUser;\ninputUserFromMessage#1da448e2 peer:InputPeer msg_id:int user_id:long = InputUser;\ninputPhoneContact#6a1dc4be flags:# client_id:long phone:string first_name:string last_name:string note:flags.0?TextWithEntities = InputContact;\ninputFile#f52ff27f id:long parts:int name:string md5_checksum:string = InputFile;\ninputFileBig#fa4f0bb5 id:long parts:int name:string = InputFile;\ninputFileStoryDocument#62dc8b48 id:InputDocument = InputFile;\ninputMediaEmpty#9664f57f = InputMedia;\ninputMediaUploadedPhoto#1e287d04 flags:# spoiler:flags.2?true file:InputFile stickers:flags.0?Vector<InputDocument> ttl_seconds:flags.1?int = InputMedia;\ninputMediaPhoto#b3ba0635 flags:# spoiler:flags.1?true id:InputPhoto ttl_seconds:flags.0?int = InputMedia;\ninputMediaGeoPoint#f9c44144 geo_point:InputGeoPoint = InputMedia;\ninputMediaContact#f8ab7dfb phone_number:string first_name:string last_name:string vcard:string = InputMedia;\ninputMediaUploadedDocument#37c9330 flags:# nosound_video:flags.3?true force_file:flags.4?true spoiler:flags.5?true file:InputFile thumb:flags.2?InputFile mime_type:string attributes:Vector<DocumentAttribute> stickers:flags.0?Vector<InputDocument> video_cover:flags.6?InputPhoto video_timestamp:flags.7?int ttl_seconds:flags.1?int = InputMedia;\ninputMediaDocument#a8763ab5 flags:# spoiler:flags.2?true id:InputDocument video_cover:flags.3?InputPhoto video_timestamp:flags.4?int ttl_seconds:flags.0?int query:flags.1?string = InputMedia;\ninputMediaVenue#c13d1c11 geo_point:InputGeoPoint title:string address:string provider:string venue_id:string venue_type:string = InputMedia;\ninputMediaPhotoExternal#e5bbfe1a flags:# spoiler:flags.1?true url:string ttl_seconds:flags.0?int = InputMedia;\ninputMediaDocumentExternal#779600f9 flags:# spoiler:flags.1?true url:string ttl_seconds:flags.0?int video_cover:flags.2?InputPhoto video_timestamp:flags.3?int = InputMedia;\ninputMediaGame#d33f43f3 id:InputGame = InputMedia;\ninputMediaInvoice#405fef0d flags:# title:string description:string photo:flags.0?InputWebDocument invoice:Invoice payload:bytes provider:flags.3?string provider_data:DataJSON start_param:flags.1?string extended_media:flags.2?InputMedia = InputMedia;\ninputMediaGeoLive#971fa843 flags:# stopped:flags.0?true geo_point:InputGeoPoint heading:flags.2?int period:flags.1?int proximity_notification_radius:flags.3?int = InputMedia;\ninputMediaPoll#f94e5f1 flags:# poll:Poll correct_answers:flags.0?Vector<bytes> solution:flags.1?string solution_entities:flags.1?Vector<MessageEntity> = InputMedia;\ninputMediaDice#e66fbf7b emoticon:string = InputMedia;\ninputMediaStory#89fdd778 peer:InputPeer id:int = InputMedia;\ninputMediaWebPage#c21b8849 flags:# force_large_media:flags.0?true force_small_media:flags.1?true optional:flags.2?true url:string = InputMedia;\ninputMediaPaidMedia#c4103386 flags:# stars_amount:long extended_media:Vector<InputMedia> payload:flags.0?string = InputMedia;\ninputMediaTodo#9fc55fde todo:TodoList = InputMedia;\ninputChatPhotoEmpty#1ca48f57 = InputChatPhoto;\ninputChatUploadedPhoto#bdcdaec0 flags:# file:flags.0?InputFile video:flags.1?InputFile video_start_ts:flags.2?double video_emoji_markup:flags.3?VideoSize = InputChatPhoto;\ninputChatPhoto#8953ad37 id:InputPhoto = InputChatPhoto;\ninputGeoPointEmpty#e4c123d6 = InputGeoPoint;\ninputGeoPoint#48222faf flags:# lat:double long:double accuracy_radius:flags.0?int = InputGeoPoint;\ninputPhotoEmpty#1cd7bf0d = InputPhoto;\ninputPhoto#3bb3b94a id:long access_hash:long file_reference:bytes = InputPhoto;\ninputFileLocation#dfdaabe1 volume_id:long local_id:int secret:long file_reference:bytes = InputFileLocation;\ninputEncryptedFileLocation#f5235d55 id:long access_hash:long = InputFileLocation;\ninputDocumentFileLocation#bad07584 id:long access_hash:long file_reference:bytes thumb_size:string = InputFileLocation;\ninputSecureFileLocation#cbc7ee28 id:long access_hash:long = InputFileLocation;\ninputTakeoutFileLocation#29be5899 = InputFileLocation;\ninputPhotoFileLocation#40181ffe id:long access_hash:long file_reference:bytes thumb_size:string = InputFileLocation;\ninputPhotoLegacyFileLocation#d83466f3 id:long access_hash:long file_reference:bytes volume_id:long local_id:int secret:long = InputFileLocation;\ninputPeerPhotoFileLocation#37257e99 flags:# big:flags.0?true peer:InputPeer photo_id:long = InputFileLocation;\ninputStickerSetThumb#9d84f3db stickerset:InputStickerSet thumb_version:int = InputFileLocation;\ninputGroupCallStream#598a92a flags:# call:InputGroupCall time_ms:long scale:int video_channel:flags.0?int video_quality:flags.0?int = InputFileLocation;\npeerUser#59511722 user_id:long = Peer;\npeerChat#36c6019a chat_id:long = Peer;\npeerChannel#a2a5371e channel_id:long = Peer;\nstorage.fileUnknown#aa963b05 = storage.FileType;\nstorage.filePartial#40bc6f52 = storage.FileType;\nstorage.fileJpeg#7efe0e = storage.FileType;\nstorage.fileGif#cae1aadf = storage.FileType;\nstorage.filePng#a4f63c0 = storage.FileType;\nstorage.filePdf#ae1e508d = storage.FileType;\nstorage.fileMp3#528a0677 = storage.FileType;\nstorage.fileMov#4b09ebbc = storage.FileType;\nstorage.fileMp4#b3cea0e4 = storage.FileType;\nstorage.fileWebp#1081464c = storage.FileType;\nuserEmpty#d3bc4b7a id:long = User;\nuser#31774388 flags:# self:flags.10?true contact:flags.11?true mutual_contact:flags.12?true deleted:flags.13?true bot:flags.14?true bot_chat_history:flags.15?true bot_nochats:flags.16?true verified:flags.17?true restricted:flags.18?true min:flags.20?true bot_inline_geo:flags.21?true support:flags.23?true scam:flags.24?true apply_min_photo:flags.25?true fake:flags.26?true bot_attach_menu:flags.27?true premium:flags.28?true attach_menu_enabled:flags.29?true flags2:# bot_can_edit:flags2.1?true close_friend:flags2.2?true stories_hidden:flags2.3?true stories_unavailable:flags2.4?true contact_require_premium:flags2.10?true bot_business:flags2.11?true bot_has_main_app:flags2.13?true bot_forum_view:flags2.16?true id:long access_hash:flags.0?long first_name:flags.1?string last_name:flags.2?string username:flags.3?string phone:flags.4?string photo:flags.5?UserProfilePhoto status:flags.6?UserStatus bot_info_version:flags.14?int restriction_reason:flags.18?Vector<RestrictionReason> bot_inline_placeholder:flags.19?string lang_code:flags.22?string emoji_status:flags.30?EmojiStatus usernames:flags2.0?Vector<Username> stories_max_id:flags2.5?RecentStory color:flags2.8?PeerColor profile_color:flags2.9?PeerColor bot_active_users:flags2.12?int bot_verification_icon:flags2.14?long send_paid_messages_stars:flags2.15?long = User;\nuserProfilePhotoEmpty#4f11bae1 = UserProfilePhoto;\nuserProfilePhoto#82d1f706 flags:# has_video:flags.0?true personal:flags.2?true photo_id:long stripped_thumb:flags.1?bytes dc_id:int = UserProfilePhoto;\nuserStatusEmpty#9d05049 = UserStatus;\nuserStatusOnline#edb93949 expires:int = UserStatus;\nuserStatusOffline#8c703f was_online:int = UserStatus;\nuserStatusRecently#7b197dc8 flags:# by_me:flags.0?true = UserStatus;\nuserStatusLastWeek#541a1d1a flags:# by_me:flags.0?true = UserStatus;\nuserStatusLastMonth#65899777 flags:# by_me:flags.0?true = UserStatus;\nchatEmpty#29562865 id:long = Chat;\nchat#41cbf256 flags:# creator:flags.0?true left:flags.2?true deactivated:flags.5?true call_active:flags.23?true call_not_empty:flags.24?true noforwards:flags.25?true id:long title:string photo:ChatPhoto participants_count:int date:int version:int migrated_to:flags.6?InputChannel admin_rights:flags.14?ChatAdminRights default_banned_rights:flags.18?ChatBannedRights = Chat;\nchatForbidden#6592a1a7 id:long title:string = Chat;\nchannel#1c32b11c flags:# creator:flags.0?true left:flags.2?true broadcast:flags.5?true verified:flags.7?true megagroup:flags.8?true restricted:flags.9?true signatures:flags.11?true min:flags.12?true scam:flags.19?true has_link:flags.20?true has_geo:flags.21?true slowmode_enabled:flags.22?true call_active:flags.23?true call_not_empty:flags.24?true fake:flags.25?true gigagroup:flags.26?true noforwards:flags.27?true join_to_send:flags.28?true join_request:flags.29?true forum:flags.30?true flags2:# stories_hidden:flags2.1?true stories_hidden_min:flags2.2?true stories_unavailable:flags2.3?true signature_profiles:flags2.12?true autotranslation:flags2.15?true broadcast_messages_allowed:flags2.16?true monoforum:flags2.17?true forum_tabs:flags2.19?true id:long access_hash:flags.13?long title:string username:flags.6?string photo:ChatPhoto date:int restriction_reason:flags.9?Vector<RestrictionReason> admin_rights:flags.14?ChatAdminRights banned_rights:flags.15?ChatBannedRights default_banned_rights:flags.18?ChatBannedRights participants_count:flags.17?int usernames:flags2.0?Vector<Username> stories_max_id:flags2.4?RecentStory color:flags2.7?PeerColor profile_color:flags2.8?PeerColor emoji_status:flags2.9?EmojiStatus level:flags2.10?int subscription_until_date:flags2.11?int bot_verification_icon:flags2.13?long send_paid_messages_stars:flags2.14?long linked_monoforum_id:flags2.18?long = Chat;\nchannelForbidden#17d493d5 flags:# broadcast:flags.5?true megagroup:flags.8?true id:long access_hash:long title:string until_date:flags.16?int = Chat;\nchatFull#2633421b flags:# can_set_username:flags.7?true has_scheduled:flags.8?true translations_disabled:flags.19?true id:long about:string participants:ChatParticipants chat_photo:flags.2?Photo notify_settings:PeerNotifySettings exported_invite:flags.13?ExportedChatInvite bot_info:flags.3?Vector<BotInfo> pinned_msg_id:flags.6?int folder_id:flags.11?int call:flags.12?InputGroupCall ttl_period:flags.14?int groupcall_default_join_as:flags.15?Peer theme_emoticon:flags.16?string requests_pending:flags.17?int recent_requesters:flags.17?Vector<long> available_reactions:flags.18?ChatReactions reactions_limit:flags.20?int = ChatFull;\nchannelFull#e4e0b29d flags:# can_view_participants:flags.3?true can_set_username:flags.6?true can_set_stickers:flags.7?true hidden_prehistory:flags.10?true can_set_location:flags.16?true has_scheduled:flags.19?true can_view_stats:flags.20?true blocked:flags.22?true flags2:# can_delete_channel:flags2.0?true antispam:flags2.1?true participants_hidden:flags2.2?true translations_disabled:flags2.3?true stories_pinned_available:flags2.5?true view_forum_as_messages:flags2.6?true restricted_sponsored:flags2.11?true can_view_revenue:flags2.12?true paid_media_allowed:flags2.14?true can_view_stars_revenue:flags2.15?true paid_reactions_available:flags2.16?true stargifts_available:flags2.19?true paid_messages_available:flags2.20?true id:long about:string participants_count:flags.0?int admins_count:flags.1?int kicked_count:flags.2?int banned_count:flags.2?int online_count:flags.13?int read_inbox_max_id:int read_outbox_max_id:int unread_count:int chat_photo:Photo notify_settings:PeerNotifySettings exported_invite:flags.23?ExportedChatInvite bot_info:Vector<BotInfo> migrated_from_chat_id:flags.4?long migrated_from_max_id:flags.4?int pinned_msg_id:flags.5?int stickerset:flags.8?StickerSet available_min_id:flags.9?int folder_id:flags.11?int linked_chat_id:flags.14?long location:flags.15?ChannelLocation slowmode_seconds:flags.17?int slowmode_next_send_date:flags.18?int stats_dc:flags.12?int pts:int call:flags.21?InputGroupCall ttl_period:flags.24?int pending_suggestions:flags.25?Vector<string> groupcall_default_join_as:flags.26?Peer theme_emoticon:flags.27?string requests_pending:flags.28?int recent_requesters:flags.28?Vector<long> default_send_as:flags.29?Peer available_reactions:flags.30?ChatReactions reactions_limit:flags2.13?int stories:flags2.4?PeerStories wallpaper:flags2.7?WallPaper boosts_applied:flags2.8?int boosts_unrestrict:flags2.9?int emojiset:flags2.10?StickerSet bot_verification:flags2.17?BotVerification stargifts_count:flags2.18?int send_paid_messages_stars:flags2.21?long main_tab:flags2.22?ProfileTab = ChatFull;\nchatParticipant#c02d4007 user_id:long inviter_id:long date:int = ChatParticipant;\nchatParticipantCreator#e46bcee4 user_id:long = ChatParticipant;\nchatParticipantAdmin#a0933f5b user_id:long inviter_id:long date:int = ChatParticipant;\nchatParticipantsForbidden#8763d3e1 flags:# chat_id:long self_participant:flags.0?ChatParticipant = ChatParticipants;\nchatParticipants#3cbc93f8 chat_id:long participants:Vector<ChatParticipant> version:int = ChatParticipants;\nchatPhotoEmpty#37c1011c = ChatPhoto;\nchatPhoto#1c6e1c11 flags:# has_video:flags.0?true photo_id:long stripped_thumb:flags.1?bytes dc_id:int = ChatPhoto;\nmessageEmpty#90a6ca84 flags:# id:int peer_id:flags.0?Peer = Message;\nmessage#b92f76cf flags:# out:flags.1?true mentioned:flags.4?true media_unread:flags.5?true silent:flags.13?true post:flags.14?true from_scheduled:flags.18?true legacy:flags.19?true edit_hide:flags.21?true pinned:flags.24?true noforwards:flags.26?true invert_media:flags.27?true flags2:# offline:flags2.1?true video_processing_pending:flags2.4?true paid_suggested_post_stars:flags2.8?true paid_suggested_post_ton:flags2.9?true id:int from_id:flags.8?Peer from_boosts_applied:flags.29?int peer_id:Peer saved_peer_id:flags.28?Peer fwd_from:flags.2?MessageFwdHeader via_bot_id:flags.11?long via_business_bot_id:flags2.0?long reply_to:flags.3?MessageReplyHeader date:int message:string media:flags.9?MessageMedia reply_markup:flags.6?ReplyMarkup entities:flags.7?Vector<MessageEntity> views:flags.10?int forwards:flags.10?int replies:flags.23?MessageReplies edit_date:flags.15?int post_author:flags.16?string grouped_id:flags.17?long reactions:flags.20?MessageReactions restriction_reason:flags.22?Vector<RestrictionReason> ttl_period:flags.25?int quick_reply_shortcut_id:flags.30?int effect:flags2.2?long factcheck:flags2.3?FactCheck report_delivery_until_date:flags2.5?int paid_message_stars:flags2.6?long suggested_post:flags2.7?SuggestedPost schedule_repeat_period:flags2.10?int = Message;\nmessageService#7a800e0a flags:# out:flags.1?true mentioned:flags.4?true media_unread:flags.5?true reactions_are_possible:flags.9?true silent:flags.13?true post:flags.14?true legacy:flags.19?true id:int from_id:flags.8?Peer peer_id:Peer saved_peer_id:flags.28?Peer reply_to:flags.3?MessageReplyHeader date:int action:MessageAction reactions:flags.20?MessageReactions ttl_period:flags.25?int = Message;\nmessageMediaEmpty#3ded6320 = MessageMedia;\nmessageMediaPhoto#695150d7 flags:# spoiler:flags.3?true photo:flags.0?Photo ttl_seconds:flags.2?int = MessageMedia;\nmessageMediaGeo#56e0d474 geo:GeoPoint = MessageMedia;\nmessageMediaContact#70322949 phone_number:string first_name:string last_name:string vcard:string user_id:long = MessageMedia;\nmessageMediaUnsupported#9f84f49e = MessageMedia;\nmessageMediaDocument#52d8ccd9 flags:# nopremium:flags.3?true spoiler:flags.4?true video:flags.6?true round:flags.7?true voice:flags.8?true document:flags.0?Document alt_documents:flags.5?Vector<Document> video_cover:flags.9?Photo video_timestamp:flags.10?int ttl_seconds:flags.2?int = MessageMedia;\nmessageMediaWebPage#ddf10c3b flags:# force_large_media:flags.0?true force_small_media:flags.1?true manual:flags.3?true safe:flags.4?true webpage:WebPage = MessageMedia;\nmessageMediaVenue#2ec0533f geo:GeoPoint title:string address:string provider:string venue_id:string venue_type:string = MessageMedia;\nmessageMediaGame#fdb19008 game:Game = MessageMedia;\nmessageMediaInvoice#f6a548d3 flags:# shipping_address_requested:flags.1?true test:flags.3?true title:string description:string photo:flags.0?WebDocument receipt_msg_id:flags.2?int currency:string total_amount:long start_param:string extended_media:flags.4?MessageExtendedMedia = MessageMedia;\nmessageMediaGeoLive#b940c666 flags:# geo:GeoPoint heading:flags.0?int period:int proximity_notification_radius:flags.1?int = MessageMedia;\nmessageMediaPoll#4bd6e798 poll:Poll results:PollResults = MessageMedia;\nmessageMediaDice#3f7ee58b value:int emoticon:string = MessageMedia;\nmessageMediaStory#68cb6283 flags:# via_mention:flags.1?true peer:Peer id:int story:flags.0?StoryItem = MessageMedia;\nmessageMediaGiveaway#aa073beb flags:# only_new_subscribers:flags.0?true winners_are_visible:flags.2?true channels:Vector<long> countries_iso2:flags.1?Vector<string> prize_description:flags.3?string quantity:int months:flags.4?int stars:flags.5?long until_date:int = MessageMedia;\nmessageMediaGiveawayResults#ceaa3ea1 flags:# only_new_subscribers:flags.0?true refunded:flags.2?true channel_id:long additional_peers_count:flags.3?int launch_msg_id:int winners_count:int unclaimed_count:int winners:Vector<long> months:flags.4?int stars:flags.5?long prize_description:flags.1?string until_date:int = MessageMedia;\nmessageMediaPaidMedia#a8852491 stars_amount:long extended_media:Vector<MessageExtendedMedia> = MessageMedia;\nmessageMediaToDo#8a53b014 flags:# todo:TodoList completions:flags.0?Vector<TodoCompletion> = MessageMedia;\nmessageMediaVideoStream#ca5cab89 flags:# rtmp_stream:flags.0?true call:InputGroupCall = MessageMedia;\nmessageActionEmpty#b6aef7b0 = MessageAction;\nmessageActionChatCreate#bd47cbad title:string users:Vector<long> = MessageAction;\nmessageActionChatEditTitle#b5a1ce5a title:string = MessageAction;\nmessageActionChatEditPhoto#7fcb13a8 photo:Photo = MessageAction;\nmessageActionChatDeletePhoto#95e3fbef = MessageAction;\nmessageActionChatAddUser#15cefd00 users:Vector<long> = MessageAction;\nmessageActionChatDeleteUser#a43f30cc user_id:long = MessageAction;\nmessageActionChatJoinedByLink#31224c3 inviter_id:long = MessageAction;\nmessageActionChannelCreate#95d2ac92 title:string = MessageAction;\nmessageActionChatMigrateTo#e1037f92 channel_id:long = MessageAction;\nmessageActionChannelMigrateFrom#ea3948e9 title:string chat_id:long = MessageAction;\nmessageActionPinMessage#94bd38ed = MessageAction;\nmessageActionHistoryClear#9fbab604 = MessageAction;\nmessageActionGameScore#92a72876 game_id:long score:int = MessageAction;\nmessageActionPaymentSentMe#ffa00ccc flags:# recurring_init:flags.2?true recurring_used:flags.3?true currency:string total_amount:long payload:bytes info:flags.0?PaymentRequestedInfo shipping_option_id:flags.1?string charge:PaymentCharge subscription_until_date:flags.4?int = MessageAction;\nmessageActionPaymentSent#c624b16e flags:# recurring_init:flags.2?true recurring_used:flags.3?true currency:string total_amount:long invoice_slug:flags.0?string subscription_until_date:flags.4?int = MessageAction;\nmessageActionPhoneCall#80e11a7f flags:# video:flags.2?true call_id:long reason:flags.0?PhoneCallDiscardReason duration:flags.1?int = MessageAction;\nmessageActionScreenshotTaken#4792929b = MessageAction;\nmessageActionCustomAction#fae69f56 message:string = MessageAction;\nmessageActionBotAllowed#c516d679 flags:# attach_menu:flags.1?true from_request:flags.3?true domain:flags.0?string app:flags.2?BotApp = MessageAction;\nmessageActionSecureValuesSentMe#1b287353 values:Vector<SecureValue> credentials:SecureCredentialsEncrypted = MessageAction;\nmessageActionSecureValuesSent#d95c6154 types:Vector<SecureValueType> = MessageAction;\nmessageActionContactSignUp#f3f25f76 = MessageAction;\nmessageActionGeoProximityReached#98e0d697 from_id:Peer to_id:Peer distance:int = MessageAction;\nmessageActionGroupCall#7a0d7f42 flags:# call:InputGroupCall duration:flags.0?int = MessageAction;\nmessageActionInviteToGroupCall#502f92f7 call:InputGroupCall users:Vector<long> = MessageAction;\nmessageActionSetMessagesTTL#3c134d7b flags:# period:int auto_setting_from:flags.0?long = MessageAction;\nmessageActionGroupCallScheduled#b3a07661 call:InputGroupCall schedule_date:int = MessageAction;\nmessageActionSetChatTheme#b91bbd3a theme:ChatTheme = MessageAction;\nmessageActionChatJoinedByRequest#ebbca3cb = MessageAction;\nmessageActionWebViewDataSentMe#47dd8079 text:string data:string = MessageAction;\nmessageActionWebViewDataSent#b4c38cb5 text:string = MessageAction;\nmessageActionGiftPremium#48e91302 flags:# currency:string amount:long days:int crypto_currency:flags.0?string crypto_amount:flags.0?long message:flags.1?TextWithEntities = MessageAction;\nmessageActionTopicCreate#d999256 flags:# title_missing:flags.1?true title:string icon_color:int icon_emoji_id:flags.0?long = MessageAction;\nmessageActionTopicEdit#c0944820 flags:# title:flags.0?string icon_emoji_id:flags.1?long closed:flags.2?Bool hidden:flags.3?Bool = MessageAction;\nmessageActionSuggestProfilePhoto#57de635e photo:Photo = MessageAction;\nmessageActionRequestedPeer#31518e9b button_id:int peers:Vector<Peer> = MessageAction;\nmessageActionSetChatWallPaper#5060a3f4 flags:# same:flags.0?true for_both:flags.1?true wallpaper:WallPaper = MessageAction;\nmessageActionGiftCode#31c48347 flags:# via_giveaway:flags.0?true unclaimed:flags.5?true boost_peer:flags.1?Peer days:int slug:string currency:flags.2?string amount:flags.2?long crypto_currency:flags.3?string crypto_amount:flags.3?long message:flags.4?TextWithEntities = MessageAction;\nmessageActionGiveawayLaunch#a80f51e4 flags:# stars:flags.0?long = MessageAction;\nmessageActionGiveawayResults#87e2f155 flags:# stars:flags.0?true winners_count:int unclaimed_count:int = MessageAction;\nmessageActionBoostApply#cc02aa6d boosts:int = MessageAction;\nmessageActionRequestedPeerSentMe#93b31848 button_id:int peers:Vector<RequestedPeer> = MessageAction;\nmessageActionPaymentRefunded#41b3e202 flags:# peer:Peer currency:string total_amount:long payload:flags.0?bytes charge:PaymentCharge = MessageAction;\nmessageActionGiftStars#45d5b021 flags:# currency:string amount:long stars:long crypto_currency:flags.0?string crypto_amount:flags.0?long transaction_id:flags.1?string = MessageAction;\nmessageActionPrizeStars#b00c47a2 flags:# unclaimed:flags.0?true stars:long transaction_id:string boost_peer:Peer giveaway_msg_id:int = MessageAction;\nmessageActionStarGift#ea2c31d3 flags:# name_hidden:flags.0?true saved:flags.2?true converted:flags.3?true upgraded:flags.5?true refunded:flags.9?true can_upgrade:flags.10?true prepaid_upgrade:flags.13?true upgrade_separate:flags.16?true auction_acquired:flags.17?true gift:StarGift message:flags.1?TextWithEntities convert_stars:flags.4?long upgrade_msg_id:flags.5?int upgrade_stars:flags.8?long from_id:flags.11?Peer peer:flags.12?Peer saved_id:flags.12?long prepaid_upgrade_hash:flags.14?string gift_msg_id:flags.15?int to_id:flags.18?Peer gift_num:flags.19?int = MessageAction;\nmessageActionStarGiftUnique#95728543 flags:# upgrade:flags.0?true transferred:flags.1?true saved:flags.2?true refunded:flags.5?true prepaid_upgrade:flags.11?true assigned:flags.13?true from_offer:flags.14?true gift:StarGift can_export_at:flags.3?int transfer_stars:flags.4?long from_id:flags.6?Peer peer:flags.7?Peer saved_id:flags.7?long resale_amount:flags.8?StarsAmount can_transfer_at:flags.9?int can_resell_at:flags.10?int drop_original_details_stars:flags.12?long = MessageAction;\nmessageActionPaidMessagesRefunded#ac1f1fcd count:int stars:long = MessageAction;\nmessageActionPaidMessagesPrice#84b88578 flags:# broadcast_messages_allowed:flags.0?true stars:long = MessageAction;\nmessageActionConferenceCall#2ffe2f7a flags:# missed:flags.0?true active:flags.1?true video:flags.4?true call_id:long duration:flags.2?int other_participants:flags.3?Vector<Peer> = MessageAction;\nmessageActionTodoCompletions#cc7c5c89 completed:Vector<int> incompleted:Vector<int> = MessageAction;\nmessageActionTodoAppendTasks#c7edbc83 list:Vector<TodoItem> = MessageAction;\nmessageActionSuggestedPostApproval#ee7a1596 flags:# rejected:flags.0?true balance_too_low:flags.1?true reject_comment:flags.2?string schedule_date:flags.3?int price:flags.4?StarsAmount = MessageAction;\nmessageActionSuggestedPostSuccess#95ddcf69 price:StarsAmount = MessageAction;\nmessageActionSuggestedPostRefund#69f916f8 flags:# payer_initiated:flags.0?true = MessageAction;\nmessageActionGiftTon#a8a3c699 flags:# currency:string amount:long crypto_currency:string crypto_amount:long transaction_id:flags.0?string = MessageAction;\nmessageActionSuggestBirthday#2c8f2a25 birthday:Birthday = MessageAction;\nmessageActionStarGiftPurchaseOffer#774278d4 flags:# accepted:flags.0?true declined:flags.1?true gift:StarGift price:StarsAmount expires_at:int = MessageAction;\nmessageActionStarGiftPurchaseOfferDeclined#73ada76b flags:# expired:flags.0?true gift:StarGift price:StarsAmount = MessageAction;\ndialog#d58a08c6 flags:# pinned:flags.2?true unread_mark:flags.3?true view_forum_as_messages:flags.6?true peer:Peer top_message:int read_inbox_max_id:int read_outbox_max_id:int unread_count:int unread_mentions_count:int unread_reactions_count:int notify_settings:PeerNotifySettings pts:flags.0?int draft:flags.1?DraftMessage folder_id:flags.4?int ttl_period:flags.5?int = Dialog;\ndialogFolder#71bd134c flags:# pinned:flags.2?true folder:Folder peer:Peer top_message:int unread_muted_peers_count:int unread_unmuted_peers_count:int unread_muted_messages_count:int unread_unmuted_messages_count:int = Dialog;\nphotoEmpty#2331b22d id:long = Photo;\nphoto#fb197a65 flags:# has_stickers:flags.0?true id:long access_hash:long file_reference:bytes date:int sizes:Vector<PhotoSize> video_sizes:flags.1?Vector<VideoSize> dc_id:int = Photo;\nphotoSizeEmpty#e17e23c type:string = PhotoSize;\nphotoSize#75c78e60 type:string w:int h:int size:int = PhotoSize;\nphotoCachedSize#21e1ad6 type:string w:int h:int bytes:bytes = PhotoSize;\nphotoStrippedSize#e0b0bc2e type:string bytes:bytes = PhotoSize;\nphotoSizeProgressive#fa3efb95 type:string w:int h:int sizes:Vector<int> = PhotoSize;\nphotoPathSize#d8214d41 type:string bytes:bytes = PhotoSize;\ngeoPointEmpty#1117dd5f = GeoPoint;\ngeoPoint#b2a2f663 flags:# long:double lat:double access_hash:long accuracy_radius:flags.0?int = GeoPoint;\nauth.sentCode#5e002502 flags:# type:auth.SentCodeType phone_code_hash:string next_type:flags.1?auth.CodeType timeout:flags.2?int = auth.SentCode;\nauth.sentCodeSuccess#2390fe44 authorization:auth.Authorization = auth.SentCode;\nauth.sentCodePaymentRequired#e0955a3c store_product:string phone_code_hash:string support_email_address:string support_email_subject:string currency:string amount:long = auth.SentCode;\nauth.authorization#2ea2c0d4 flags:# setup_password_required:flags.1?true otherwise_relogin_days:flags.1?int tmp_sessions:flags.0?int future_auth_token:flags.2?bytes user:User = auth.Authorization;\nauth.authorizationSignUpRequired#44747e9a flags:# terms_of_service:flags.0?help.TermsOfService = auth.Authorization;\nauth.exportedAuthorization#b434e2b8 id:long bytes:bytes = auth.ExportedAuthorization;\ninputNotifyPeer#b8bc5b0c peer:InputPeer = InputNotifyPeer;\ninputNotifyUsers#193b4417 = InputNotifyPeer;\ninputNotifyChats#4a95e84e = InputNotifyPeer;\ninputNotifyBroadcasts#b1db7c7e = InputNotifyPeer;\ninputNotifyForumTopic#5c467992 peer:InputPeer top_msg_id:int = InputNotifyPeer;\ninputPeerNotifySettings#cacb6ae2 flags:# show_previews:flags.0?Bool silent:flags.1?Bool mute_until:flags.2?int sound:flags.3?NotificationSound stories_muted:flags.6?Bool stories_hide_sender:flags.7?Bool stories_sound:flags.8?NotificationSound = InputPeerNotifySettings;\npeerNotifySettings#99622c0c flags:# show_previews:flags.0?Bool silent:flags.1?Bool mute_until:flags.2?int ios_sound:flags.3?NotificationSound android_sound:flags.4?NotificationSound other_sound:flags.5?NotificationSound stories_muted:flags.6?Bool stories_hide_sender:flags.7?Bool stories_ios_sound:flags.8?NotificationSound stories_android_sound:flags.9?NotificationSound stories_other_sound:flags.10?NotificationSound = PeerNotifySettings;\npeerSettings#f47741f7 flags:# report_spam:flags.0?true add_contact:flags.1?true block_contact:flags.2?true share_contact:flags.3?true need_contacts_exception:flags.4?true report_geo:flags.5?true autoarchived:flags.7?true invite_members:flags.8?true request_chat_broadcast:flags.10?true business_bot_paused:flags.11?true business_bot_can_reply:flags.12?true geo_distance:flags.6?int request_chat_title:flags.9?string request_chat_date:flags.9?int business_bot_id:flags.13?long business_bot_manage_url:flags.13?string charge_paid_message_stars:flags.14?long registration_month:flags.15?string phone_country:flags.16?string name_change_date:flags.17?int photo_change_date:flags.18?int = PeerSettings;\nwallPaper#a437c3ed id:long flags:# creator:flags.0?true default:flags.1?true pattern:flags.3?true dark:flags.4?true access_hash:long slug:string document:Document settings:flags.2?WallPaperSettings = WallPaper;\nwallPaperNoFile#e0804116 id:long flags:# default:flags.1?true dark:flags.4?true settings:flags.2?WallPaperSettings = WallPaper;\ninputReportReasonSpam#58dbcab8 = ReportReason;\ninputReportReasonViolence#1e22c78d = ReportReason;\ninputReportReasonPornography#2e59d922 = ReportReason;\ninputReportReasonChildAbuse#adf44ee3 = ReportReason;\ninputReportReasonOther#c1e4a2b1 = ReportReason;\ninputReportReasonCopyright#9b89f93a = ReportReason;\ninputReportReasonGeoIrrelevant#dbd4feed = ReportReason;\ninputReportReasonFake#f5ddd6e7 = ReportReason;\ninputReportReasonIllegalDrugs#a8eb2be = ReportReason;\ninputReportReasonPersonalDetails#9ec7863d = ReportReason;\nuserFull#a02bc13e flags:# blocked:flags.0?true phone_calls_available:flags.4?true phone_calls_private:flags.5?true can_pin_message:flags.7?true has_scheduled:flags.12?true video_calls_available:flags.13?true voice_messages_forbidden:flags.20?true translations_disabled:flags.23?true stories_pinned_available:flags.26?true blocked_my_stories_from:flags.27?true wallpaper_overridden:flags.28?true contact_require_premium:flags.29?true read_dates_private:flags.30?true flags2:# sponsored_enabled:flags2.7?true can_view_revenue:flags2.9?true bot_can_manage_emoji_status:flags2.10?true display_gifts_button:flags2.16?true id:long about:flags.1?string settings:PeerSettings personal_photo:flags.21?Photo profile_photo:flags.2?Photo fallback_photo:flags.22?Photo notify_settings:PeerNotifySettings bot_info:flags.3?BotInfo pinned_msg_id:flags.6?int common_chats_count:int folder_id:flags.11?int ttl_period:flags.14?int theme:flags.15?ChatTheme private_forward_name:flags.16?string bot_group_admin_rights:flags.17?ChatAdminRights bot_broadcast_admin_rights:flags.18?ChatAdminRights wallpaper:flags.24?WallPaper stories:flags.25?PeerStories business_work_hours:flags2.0?BusinessWorkHours business_location:flags2.1?BusinessLocation business_greeting_message:flags2.2?BusinessGreetingMessage business_away_message:flags2.3?BusinessAwayMessage business_intro:flags2.4?BusinessIntro birthday:flags2.5?Birthday personal_channel_id:flags2.6?long personal_channel_message:flags2.6?int stargifts_count:flags2.8?int starref_program:flags2.11?StarRefProgram bot_verification:flags2.12?BotVerification send_paid_messages_stars:flags2.14?long disallowed_gifts:flags2.15?DisallowedGiftsSettings stars_rating:flags2.17?StarsRating stars_my_pending_rating:flags2.18?StarsRating stars_my_pending_rating_date:flags2.18?int main_tab:flags2.20?ProfileTab saved_music:flags2.21?Document note:flags2.22?TextWithEntities = UserFull;\ncontact#145ade0b user_id:long mutual:Bool = Contact;\nimportedContact#c13e3c50 user_id:long client_id:long = ImportedContact;\ncontactStatus#16d9703b user_id:long status:UserStatus = ContactStatus;\ncontacts.contactsNotModified#b74ba9d2 = contacts.Contacts;\ncontacts.contacts#eae87e42 contacts:Vector<Contact> saved_count:int users:Vector<User> = contacts.Contacts;\ncontacts.importedContacts#77d01c3b imported:Vector<ImportedContact> popular_invites:Vector<PopularContact> retry_contacts:Vector<long> users:Vector<User> = contacts.ImportedContacts;\ncontacts.blocked#ade1591 blocked:Vector<PeerBlocked> chats:Vector<Chat> users:Vector<User> = contacts.Blocked;\ncontacts.blockedSlice#e1664194 count:int blocked:Vector<PeerBlocked> chats:Vector<Chat> users:Vector<User> = contacts.Blocked;\nmessages.dialogs#15ba6c40 dialogs:Vector<Dialog> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.Dialogs;\nmessages.dialogsSlice#71e094f3 count:int dialogs:Vector<Dialog> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.Dialogs;\nmessages.dialogsNotModified#f0e3e596 count:int = messages.Dialogs;\nmessages.messages#1d73e7ea messages:Vector<Message> topics:Vector<ForumTopic> chats:Vector<Chat> users:Vector<User> = messages.Messages;\nmessages.messagesSlice#5f206716 flags:# inexact:flags.1?true count:int next_rate:flags.0?int offset_id_offset:flags.2?int search_flood:flags.3?SearchPostsFlood messages:Vector<Message> topics:Vector<ForumTopic> chats:Vector<Chat> users:Vector<User> = messages.Messages;\nmessages.channelMessages#c776ba4e flags:# inexact:flags.1?true pts:int count:int offset_id_offset:flags.2?int messages:Vector<Message> topics:Vector<ForumTopic> chats:Vector<Chat> users:Vector<User> = messages.Messages;\nmessages.messagesNotModified#74535f21 count:int = messages.Messages;\nmessages.chats#64ff9fd5 chats:Vector<Chat> = messages.Chats;\nmessages.chatsSlice#9cd81144 count:int chats:Vector<Chat> = messages.Chats;\nmessages.chatFull#e5d7d19c full_chat:ChatFull chats:Vector<Chat> users:Vector<User> = messages.ChatFull;\nmessages.affectedHistory#b45c69d1 pts:int pts_count:int offset:int = messages.AffectedHistory;\ninputMessagesFilterEmpty#57e2f66c = MessagesFilter;\ninputMessagesFilterPhotos#9609a51c = MessagesFilter;\ninputMessagesFilterVideo#9fc00e65 = MessagesFilter;\ninputMessagesFilterPhotoVideo#56e9f0e4 = MessagesFilter;\ninputMessagesFilterDocument#9eddf188 = MessagesFilter;\ninputMessagesFilterUrl#7ef0dd87 = MessagesFilter;\ninputMessagesFilterGif#ffc86587 = MessagesFilter;\ninputMessagesFilterVoice#50f5c392 = MessagesFilter;\ninputMessagesFilterMusic#3751b49e = MessagesFilter;\ninputMessagesFilterChatPhotos#3a20ecb8 = MessagesFilter;\ninputMessagesFilterPhoneCalls#80c99768 flags:# missed:flags.0?true = MessagesFilter;\ninputMessagesFilterRoundVoice#7a7c17a4 = MessagesFilter;\ninputMessagesFilterRoundVideo#b549da53 = MessagesFilter;\ninputMessagesFilterMyMentions#c1f8e69a = MessagesFilter;\ninputMessagesFilterGeo#e7026d0d = MessagesFilter;\ninputMessagesFilterContacts#e062db83 = MessagesFilter;\ninputMessagesFilterPinned#1bb00451 = MessagesFilter;\nupdateNewMessage#1f2b0afd message:Message pts:int pts_count:int = Update;\nupdateMessageID#4e90bfd6 id:int random_id:long = Update;\nupdateDeleteMessages#a20db0e5 messages:Vector<int> pts:int pts_count:int = Update;\nupdateUserTyping#2a17bf5c flags:# user_id:long top_msg_id:flags.0?int action:SendMessageAction = Update;\nupdateChatUserTyping#83487af0 chat_id:long from_id:Peer action:SendMessageAction = Update;\nupdateChatParticipants#7761198 participants:ChatParticipants = Update;\nupdateUserStatus#e5bdf8de user_id:long status:UserStatus = Update;\nupdateUserName#a7848924 user_id:long first_name:string last_name:string usernames:Vector<Username> = Update;\nupdateNewAuthorization#8951abef flags:# unconfirmed:flags.0?true hash:long date:flags.0?int device:flags.0?string location:flags.0?string = Update;\nupdateNewEncryptedMessage#12bcbd9a message:EncryptedMessage qts:int = Update;\nupdateEncryptedChatTyping#1710f156 chat_id:int = Update;\nupdateEncryption#b4a2e88d chat:EncryptedChat date:int = Update;\nupdateEncryptedMessagesRead#38fe25b7 chat_id:int max_date:int date:int = Update;\nupdateChatParticipantAdd#3dda5451 chat_id:long user_id:long inviter_id:long date:int version:int = Update;\nupdateChatParticipantDelete#e32f3d77 chat_id:long user_id:long version:int = Update;\nupdateDcOptions#8e5e9873 dc_options:Vector<DcOption> = Update;\nupdateNotifySettings#bec268ef peer:NotifyPeer notify_settings:PeerNotifySettings = Update;\nupdateServiceNotification#ebe46819 flags:# popup:flags.0?true invert_media:flags.2?true inbox_date:flags.1?int type:string message:string media:MessageMedia entities:Vector<MessageEntity> = Update;\nupdatePrivacy#ee3b272a key:PrivacyKey rules:Vector<PrivacyRule> = Update;\nupdateUserPhone#5492a13 user_id:long phone:string = Update;\nupdateReadHistoryInbox#9e84bc99 flags:# folder_id:flags.0?int peer:Peer top_msg_id:flags.1?int max_id:int still_unread_count:int pts:int pts_count:int = Update;\nupdateReadHistoryOutbox#2f2f21bf peer:Peer max_id:int pts:int pts_count:int = Update;\nupdateWebPage#7f891213 webpage:WebPage pts:int pts_count:int = Update;\nupdateReadMessagesContents#f8227181 flags:# messages:Vector<int> pts:int pts_count:int date:flags.0?int = Update;\nupdateChannelTooLong#108d941f flags:# channel_id:long pts:flags.0?int = Update;\nupdateChannel#635b4c09 channel_id:long = Update;\nupdateNewChannelMessage#62ba04d9 message:Message pts:int pts_count:int = Update;\nupdateReadChannelInbox#922e6e10 flags:# folder_id:flags.0?int channel_id:long max_id:int still_unread_count:int pts:int = Update;\nupdateDeleteChannelMessages#c32d5b12 channel_id:long messages:Vector<int> pts:int pts_count:int = Update;\nupdateChannelMessageViews#f226ac08 channel_id:long id:int views:int = Update;\nupdateChatParticipantAdmin#d7ca61a2 chat_id:long user_id:long is_admin:Bool version:int = Update;\nupdateNewStickerSet#688a30aa stickerset:messages.StickerSet = Update;\nupdateStickerSetsOrder#bb2d201 flags:# masks:flags.0?true emojis:flags.1?true order:Vector<long> = Update;\nupdateStickerSets#31c24808 flags:# masks:flags.0?true emojis:flags.1?true = Update;\nupdateSavedGifs#9375341e = Update;\nupdateBotInlineQuery#496f379c flags:# query_id:long user_id:long query:string geo:flags.0?GeoPoint peer_type:flags.1?InlineQueryPeerType offset:string = Update;\nupdateBotInlineSend#12f12a07 flags:# user_id:long query:string geo:flags.0?GeoPoint id:string msg_id:flags.1?InputBotInlineMessageID = Update;\nupdateEditChannelMessage#1b3f4df7 message:Message pts:int pts_count:int = Update;\nupdateBotCallbackQuery#b9cfc48d flags:# query_id:long user_id:long peer:Peer msg_id:int chat_instance:long data:flags.0?bytes game_short_name:flags.1?string = Update;\nupdateEditMessage#e40370a3 message:Message pts:int pts_count:int = Update;\nupdateInlineBotCallbackQuery#691e9052 flags:# query_id:long user_id:long msg_id:InputBotInlineMessageID chat_instance:long data:flags.0?bytes game_short_name:flags.1?string = Update;\nupdateReadChannelOutbox#b75f99a9 channel_id:long max_id:int = Update;\nupdateDraftMessage#edfc111e flags:# peer:Peer top_msg_id:flags.0?int saved_peer_id:flags.1?Peer draft:DraftMessage = Update;\nupdateReadFeaturedStickers#571d2742 = Update;\nupdateRecentStickers#9a422c20 = Update;\nupdateConfig#a229dd06 = Update;\nupdatePtsChanged#3354678f = Update;\nupdateChannelWebPage#2f2ba99f channel_id:long webpage:WebPage pts:int pts_count:int = Update;\nupdateDialogPinned#6e6fe51c flags:# pinned:flags.0?true folder_id:flags.1?int peer:DialogPeer = Update;\nupdatePinnedDialogs#fa0f3ca2 flags:# folder_id:flags.1?int order:flags.0?Vector<DialogPeer> = Update;\nupdateBotWebhookJSON#8317c0c3 data:DataJSON = Update;\nupdateBotWebhookJSONQuery#9b9240a6 query_id:long data:DataJSON timeout:int = Update;\nupdateBotShippingQuery#b5aefd7d query_id:long user_id:long payload:bytes shipping_address:PostAddress = Update;\nupdateBotPrecheckoutQuery#8caa9a96 flags:# query_id:long user_id:long payload:bytes info:flags.0?PaymentRequestedInfo shipping_option_id:flags.1?string currency:string total_amount:long = Update;\nupdatePhoneCall#ab0f6b1e phone_call:PhoneCall = Update;\nupdateLangPackTooLong#46560264 lang_code:string = Update;\nupdateLangPack#56022f4d difference:LangPackDifference = Update;\nupdateFavedStickers#e511996d = Update;\nupdateChannelReadMessagesContents#25f324f7 flags:# channel_id:long top_msg_id:flags.0?int saved_peer_id:flags.1?Peer messages:Vector<int> = Update;\nupdateContactsReset#7084a7be = Update;\nupdateChannelAvailableMessages#b23fc698 channel_id:long available_min_id:int = Update;\nupdateDialogUnreadMark#b658f23e flags:# unread:flags.0?true peer:DialogPeer saved_peer_id:flags.1?Peer = Update;\nupdateMessagePoll#aca1657b flags:# poll_id:long poll:flags.0?Poll results:PollResults = Update;\nupdateChatDefaultBannedRights#54c01850 peer:Peer default_banned_rights:ChatBannedRights version:int = Update;\nupdateFolderPeers#19360dc0 folder_peers:Vector<FolderPeer> pts:int pts_count:int = Update;\nupdatePeerSettings#6a7e7366 peer:Peer settings:PeerSettings = Update;\nupdatePeerLocated#b4afcfb0 peers:Vector<PeerLocated> = Update;\nupdateNewScheduledMessage#39a51dfb message:Message = Update;\nupdateDeleteScheduledMessages#f2a71983 flags:# peer:Peer messages:Vector<int> sent_messages:flags.0?Vector<int> = Update;\nupdateTheme#8216fba3 theme:Theme = Update;\nupdateGeoLiveViewed#871fb939 peer:Peer msg_id:int = Update;\nupdateLoginToken#564fe691 = Update;\nupdateMessagePollVote#24f40e77 poll_id:long peer:Peer options:Vector<bytes> qts:int = Update;\nupdateDialogFilter#26ffde7d flags:# id:int filter:flags.0?DialogFilter = Update;\nupdateDialogFilterOrder#a5d72105 order:Vector<int> = Update;\nupdateDialogFilters#3504914f = Update;\nupdatePhoneCallSignalingData#2661bf09 phone_call_id:long data:bytes = Update;\nupdateChannelMessageForwards#d29a27f4 channel_id:long id:int forwards:int = Update;\nupdateReadChannelDiscussionInbox#d6b19546 flags:# channel_id:long top_msg_id:int read_max_id:int broadcast_id:flags.0?long broadcast_post:flags.0?int = Update;\nupdateReadChannelDiscussionOutbox#695c9e7c channel_id:long top_msg_id:int read_max_id:int = Update;\nupdatePeerBlocked#ebe07752 flags:# blocked:flags.0?true blocked_my_stories_from:flags.1?true peer_id:Peer = Update;\nupdateChannelUserTyping#8c88c923 flags:# channel_id:long top_msg_id:flags.0?int from_id:Peer action:SendMessageAction = Update;\nupdatePinnedMessages#ed85eab5 flags:# pinned:flags.0?true peer:Peer messages:Vector<int> pts:int pts_count:int = Update;\nupdatePinnedChannelMessages#5bb98608 flags:# pinned:flags.0?true channel_id:long messages:Vector<int> pts:int pts_count:int = Update;\nupdateChat#f89a6a4e chat_id:long = Update;\nupdateGroupCallParticipants#f2ebdb4e call:InputGroupCall participants:Vector<GroupCallParticipant> version:int = Update;\nupdateGroupCall#9d2216e0 flags:# live_story:flags.2?true peer:flags.1?Peer call:GroupCall = Update;\nupdatePeerHistoryTTL#bb9bb9a5 flags:# peer:Peer ttl_period:flags.0?int = Update;\nupdateChatParticipant#d087663a flags:# chat_id:long date:int actor_id:long user_id:long prev_participant:flags.0?ChatParticipant new_participant:flags.1?ChatParticipant invite:flags.2?ExportedChatInvite qts:int = Update;\nupdateChannelParticipant#985d3abb flags:# via_chatlist:flags.3?true channel_id:long date:int actor_id:long user_id:long prev_participant:flags.0?ChannelParticipant new_participant:flags.1?ChannelParticipant invite:flags.2?ExportedChatInvite qts:int = Update;\nupdateBotStopped#c4870a49 user_id:long date:int stopped:Bool qts:int = Update;\nupdateGroupCallConnection#b783982 flags:# presentation:flags.0?true params:DataJSON = Update;\nupdateBotCommands#4d712f2e peer:Peer bot_id:long commands:Vector<BotCommand> = Update;\nupdatePendingJoinRequests#7063c3db peer:Peer requests_pending:int recent_requesters:Vector<long> = Update;\nupdateBotChatInviteRequester#11dfa986 peer:Peer date:int user_id:long about:string invite:ExportedChatInvite qts:int = Update;\nupdateMessageReactions#1e297bfa flags:# peer:Peer msg_id:int top_msg_id:flags.0?int saved_peer_id:flags.1?Peer reactions:MessageReactions = Update;\nupdateAttachMenuBots#17b7a20b = Update;\nupdateWebViewResultSent#1592b79d query_id:long = Update;\nupdateBotMenuButton#14b85813 bot_id:long button:BotMenuButton = Update;\nupdateSavedRingtones#74d8be99 = Update;\nupdateTranscribedAudio#84cd5a flags:# pending:flags.0?true peer:Peer msg_id:int transcription_id:long text:string = Update;\nupdateReadFeaturedEmojiStickers#fb4c496c = Update;\nupdateUserEmojiStatus#28373599 user_id:long emoji_status:EmojiStatus = Update;\nupdateRecentEmojiStatuses#30f443db = Update;\nupdateRecentReactions#6f7863f4 = Update;\nupdateMoveStickerSetToTop#86fccf85 flags:# masks:flags.0?true emojis:flags.1?true stickerset:long = Update;\nupdateMessageExtendedMedia#d5a41724 peer:Peer msg_id:int extended_media:Vector<MessageExtendedMedia> = Update;\nupdateUser#20529438 user_id:long = Update;\nupdateAutoSaveSettings#ec05b097 = Update;\nupdateStory#75b3b798 peer:Peer story:StoryItem = Update;\nupdateReadStories#f74e932b peer:Peer max_id:int = Update;\nupdateStoryID#1bf335b9 id:int random_id:long = Update;\nupdateStoriesStealthMode#2c084dc1 stealth_mode:StoriesStealthMode = Update;\nupdateSentStoryReaction#7d627683 peer:Peer story_id:int reaction:Reaction = Update;\nupdateBotChatBoost#904dd49c peer:Peer boost:Boost qts:int = Update;\nupdateChannelViewForumAsMessages#7b68920 channel_id:long enabled:Bool = Update;\nupdatePeerWallpaper#ae3f101d flags:# wallpaper_overridden:flags.1?true peer:Peer wallpaper:flags.0?WallPaper = Update;\nupdateBotMessageReaction#ac21d3ce peer:Peer msg_id:int date:int actor:Peer old_reactions:Vector<Reaction> new_reactions:Vector<Reaction> qts:int = Update;\nupdateBotMessageReactions#9cb7759 peer:Peer msg_id:int date:int reactions:Vector<ReactionCount> qts:int = Update;\nupdateSavedDialogPinned#aeaf9e74 flags:# pinned:flags.0?true peer:DialogPeer = Update;\nupdatePinnedSavedDialogs#686c85a6 flags:# order:flags.0?Vector<DialogPeer> = Update;\nupdateSavedReactionTags#39c67432 = Update;\nupdateSmsJob#f16269d4 job_id:string = Update;\nupdateQuickReplies#f9470ab2 quick_replies:Vector<QuickReply> = Update;\nupdateNewQuickReply#f53da717 quick_reply:QuickReply = Update;\nupdateDeleteQuickReply#53e6f1ec shortcut_id:int = Update;\nupdateQuickReplyMessage#3e050d0f message:Message = Update;\nupdateDeleteQuickReplyMessages#566fe7cd shortcut_id:int messages:Vector<int> = Update;\nupdateBotBusinessConnect#8ae5c97a connection:BotBusinessConnection qts:int = Update;\nupdateBotNewBusinessMessage#9ddb347c flags:# connection_id:string message:Message reply_to_message:flags.0?Message qts:int = Update;\nupdateBotEditBusinessMessage#7df587c flags:# connection_id:string message:Message reply_to_message:flags.0?Message qts:int = Update;\nupdateBotDeleteBusinessMessage#a02a982e connection_id:string peer:Peer messages:Vector<int> qts:int = Update;\nupdateNewStoryReaction#1824e40b story_id:int peer:Peer reaction:Reaction = Update;\nupdateStarsBalance#4e80a379 balance:StarsAmount = Update;\nupdateBusinessBotCallbackQuery#1ea2fda7 flags:# query_id:long user_id:long connection_id:string message:Message reply_to_message:flags.2?Message chat_instance:long data:flags.0?bytes = Update;\nupdateStarsRevenueStatus#a584b019 peer:Peer status:StarsRevenueStatus = Update;\nupdateBotPurchasedPaidMedia#283bd312 user_id:long payload:string qts:int = Update;\nupdatePaidReactionPrivacy#8b725fce private:PaidReactionPrivacy = Update;\nupdateSentPhoneCode#504aa18f sent_code:auth.SentCode = Update;\nupdateGroupCallChainBlocks#a477288f call:InputGroupCall sub_chain_id:int blocks:Vector<bytes> next_offset:int = Update;\nupdateReadMonoForumInbox#77b0e372 channel_id:long saved_peer_id:Peer read_max_id:int = Update;\nupdateReadMonoForumOutbox#a4a79376 channel_id:long saved_peer_id:Peer read_max_id:int = Update;\nupdateMonoForumNoPaidException#9f812b08 flags:# exception:flags.0?true channel_id:long saved_peer_id:Peer = Update;\nupdateGroupCallMessage#d8326f0d call:InputGroupCall message:GroupCallMessage = Update;\nupdateGroupCallEncryptedMessage#c957a766 call:InputGroupCall from_id:Peer encrypted_message:bytes = Update;\nupdatePinnedForumTopic#683b2c52 flags:# pinned:flags.0?true peer:Peer topic_id:int = Update;\nupdatePinnedForumTopics#def143d0 flags:# peer:Peer order:flags.0?Vector<int> = Update;\nupdateDeleteGroupCallMessages#3e85e92c call:InputGroupCall messages:Vector<int> = Update;\nupdateStarGiftAuctionState#48e246c2 gift_id:long state:StarGiftAuctionState = Update;\nupdateStarGiftAuctionUserState#dc58f31e gift_id:long user_state:StarGiftAuctionUserState = Update;\nupdates.state#a56c2a3e pts:int qts:int date:int seq:int unread_count:int = updates.State;\nupdates.differenceEmpty#5d75a138 date:int seq:int = updates.Difference;\nupdates.difference#f49ca0 new_messages:Vector<Message> new_encrypted_messages:Vector<EncryptedMessage> other_updates:Vector<Update> chats:Vector<Chat> users:Vector<User> state:updates.State = updates.Difference;\nupdates.differenceSlice#a8fb1981 new_messages:Vector<Message> new_encrypted_messages:Vector<EncryptedMessage> other_updates:Vector<Update> chats:Vector<Chat> users:Vector<User> intermediate_state:updates.State = updates.Difference;\nupdates.differenceTooLong#4afe8f6d pts:int = updates.Difference;\nupdatesTooLong#e317af7e = Updates;\nupdateShortMessage#313bc7f8 flags:# out:flags.1?true mentioned:flags.4?true media_unread:flags.5?true silent:flags.13?true id:int user_id:long message:string pts:int pts_count:int date:int fwd_from:flags.2?MessageFwdHeader via_bot_id:flags.11?long reply_to:flags.3?MessageReplyHeader entities:flags.7?Vector<MessageEntity> ttl_period:flags.25?int = Updates;\nupdateShortChatMessage#4d6deea5 flags:# out:flags.1?true mentioned:flags.4?true media_unread:flags.5?true silent:flags.13?true id:int from_id:long chat_id:long message:string pts:int pts_count:int date:int fwd_from:flags.2?MessageFwdHeader via_bot_id:flags.11?long reply_to:flags.3?MessageReplyHeader entities:flags.7?Vector<MessageEntity> ttl_period:flags.25?int = Updates;\nupdateShort#78d4dec1 update:Update date:int = Updates;\nupdatesCombined#725b04c3 updates:Vector<Update> users:Vector<User> chats:Vector<Chat> date:int seq_start:int seq:int = Updates;\nupdates#74ae4240 updates:Vector<Update> users:Vector<User> chats:Vector<Chat> date:int seq:int = Updates;\nupdateShortSentMessage#9015e101 flags:# out:flags.1?true id:int pts:int pts_count:int date:int media:flags.9?MessageMedia entities:flags.7?Vector<MessageEntity> ttl_period:flags.25?int = Updates;\nphotos.photos#8dca6aa5 photos:Vector<Photo> users:Vector<User> = photos.Photos;\nphotos.photosSlice#15051f54 count:int photos:Vector<Photo> users:Vector<User> = photos.Photos;\nphotos.photo#20212ca8 photo:Photo users:Vector<User> = photos.Photo;\nupload.file#96a18d5 type:storage.FileType mtime:int bytes:bytes = upload.File;\nupload.fileCdnRedirect#f18cda44 dc_id:int file_token:bytes encryption_key:bytes encryption_iv:bytes file_hashes:Vector<FileHash> = upload.File;\ndcOption#18b7a10d flags:# ipv6:flags.0?true media_only:flags.1?true tcpo_only:flags.2?true cdn:flags.3?true static:flags.4?true this_port_only:flags.5?true id:int ip_address:string port:int secret:flags.10?bytes = DcOption;\nconfig#cc1a241e flags:# default_p2p_contacts:flags.3?true preload_featured_stickers:flags.4?true revoke_pm_inbox:flags.6?true blocked_mode:flags.8?true force_try_ipv6:flags.14?true date:int expires:int test_mode:Bool this_dc:int dc_options:Vector<DcOption> dc_txt_domain_name:string chat_size_max:int megagroup_size_max:int forwarded_count_max:int online_update_period_ms:int offline_blur_timeout_ms:int offline_idle_timeout_ms:int online_cloud_timeout_ms:int notify_cloud_delay_ms:int notify_default_delay_ms:int push_chat_period_ms:int push_chat_limit:int edit_time_limit:int revoke_time_limit:int revoke_pm_time_limit:int rating_e_decay:int stickers_recent_limit:int channels_read_media_period:int tmp_sessions:flags.0?int call_receive_timeout_ms:int call_ring_timeout_ms:int call_connect_timeout_ms:int call_packet_timeout_ms:int me_url_prefix:string autoupdate_url_prefix:flags.7?string gif_search_username:flags.9?string venue_search_username:flags.10?string img_search_username:flags.11?string static_maps_provider:flags.12?string caption_length_max:int message_length_max:int webfile_dc_id:int suggested_lang_code:flags.2?string lang_pack_version:flags.2?int base_lang_pack_version:flags.2?int reactions_default:flags.15?Reaction autologin_token:flags.16?string = Config;\nnearestDc#8e1a1775 country:string this_dc:int nearest_dc:int = NearestDc;\nhelp.appUpdate#ccbbce30 flags:# can_not_skip:flags.0?true id:int version:string text:string entities:Vector<MessageEntity> document:flags.1?Document url:flags.2?string sticker:flags.3?Document = help.AppUpdate;\nhelp.noAppUpdate#c45a6536 = help.AppUpdate;\nhelp.inviteText#18cb9f78 message:string = help.InviteText;\nencryptedChatEmpty#ab7ec0a0 id:int = EncryptedChat;\nencryptedChatWaiting#66b25953 id:int access_hash:long date:int admin_id:long participant_id:long = EncryptedChat;\nencryptedChatRequested#48f1d94c flags:# folder_id:flags.0?int id:int access_hash:long date:int admin_id:long participant_id:long g_a:bytes = EncryptedChat;\nencryptedChat#61f0d4c7 id:int access_hash:long date:int admin_id:long participant_id:long g_a_or_b:bytes key_fingerprint:long = EncryptedChat;\nencryptedChatDiscarded#1e1c7c45 flags:# history_deleted:flags.0?true id:int = EncryptedChat;\ninputEncryptedChat#f141b5e1 chat_id:int access_hash:long = InputEncryptedChat;\nencryptedFileEmpty#c21f497e = EncryptedFile;\nencryptedFile#a8008cd8 id:long access_hash:long size:long dc_id:int key_fingerprint:int = EncryptedFile;\ninputEncryptedFileEmpty#1837c364 = InputEncryptedFile;\ninputEncryptedFileUploaded#64bd0306 id:long parts:int md5_checksum:string key_fingerprint:int = InputEncryptedFile;\ninputEncryptedFile#5a17b5e5 id:long access_hash:long = InputEncryptedFile;\ninputEncryptedFileBigUploaded#2dc173c8 id:long parts:int key_fingerprint:int = InputEncryptedFile;\nencryptedMessage#ed18c118 random_id:long chat_id:int date:int bytes:bytes file:EncryptedFile = EncryptedMessage;\nencryptedMessageService#23734b06 random_id:long chat_id:int date:int bytes:bytes = EncryptedMessage;\nmessages.dhConfigNotModified#c0e24635 random:bytes = messages.DhConfig;\nmessages.dhConfig#2c221edd g:int p:bytes version:int random:bytes = messages.DhConfig;\nmessages.sentEncryptedMessage#560f8935 date:int = messages.SentEncryptedMessage;\nmessages.sentEncryptedFile#9493ff32 date:int file:EncryptedFile = messages.SentEncryptedMessage;\ninputDocumentEmpty#72f0eaae = InputDocument;\ninputDocument#1abfb575 id:long access_hash:long file_reference:bytes = InputDocument;\ndocumentEmpty#36f8c871 id:long = Document;\ndocument#8fd4c4d8 flags:# id:long access_hash:long file_reference:bytes date:int mime_type:string size:long thumbs:flags.0?Vector<PhotoSize> video_thumbs:flags.1?Vector<VideoSize> dc_id:int attributes:Vector<DocumentAttribute> = Document;\nhelp.support#17c6b5f6 phone_number:string user:User = help.Support;\nnotifyPeer#9fd40bd8 peer:Peer = NotifyPeer;\nnotifyUsers#b4c83b4c = NotifyPeer;\nnotifyChats#c007cec3 = NotifyPeer;\nnotifyBroadcasts#d612e8ef = NotifyPeer;\nnotifyForumTopic#226e6308 peer:Peer top_msg_id:int = NotifyPeer;\nsendMessageTypingAction#16bf744e = SendMessageAction;\nsendMessageCancelAction#fd5ec8f5 = SendMessageAction;\nsendMessageRecordVideoAction#a187d66f = SendMessageAction;\nsendMessageUploadVideoAction#e9763aec progress:int = SendMessageAction;\nsendMessageRecordAudioAction#d52f73f7 = SendMessageAction;\nsendMessageUploadAudioAction#f351d7ab progress:int = SendMessageAction;\nsendMessageUploadPhotoAction#d1d34a26 progress:int = SendMessageAction;\nsendMessageUploadDocumentAction#aa0cd9e4 progress:int = SendMessageAction;\nsendMessageGeoLocationAction#176f8ba1 = SendMessageAction;\nsendMessageChooseContactAction#628cbc6f = SendMessageAction;\nsendMessageGamePlayAction#dd6a8f48 = SendMessageAction;\nsendMessageRecordRoundAction#88f27fbc = SendMessageAction;\nsendMessageUploadRoundAction#243e1c66 progress:int = SendMessageAction;\nspeakingInGroupCallAction#d92c2285 = SendMessageAction;\nsendMessageHistoryImportAction#dbda9246 progress:int = SendMessageAction;\nsendMessageChooseStickerAction#b05ac6b1 = SendMessageAction;\nsendMessageEmojiInteraction#25972bcb emoticon:string msg_id:int interaction:DataJSON = SendMessageAction;\nsendMessageEmojiInteractionSeen#b665902e emoticon:string = SendMessageAction;\nsendMessageTextDraftAction#376d975c random_id:long text:TextWithEntities = SendMessageAction;\ncontacts.found#b3134d9d my_results:Vector<Peer> results:Vector<Peer> chats:Vector<Chat> users:Vector<User> = contacts.Found;\ninputPrivacyKeyStatusTimestamp#4f96cb18 = InputPrivacyKey;\ninputPrivacyKeyChatInvite#bdfb0426 = InputPrivacyKey;\ninputPrivacyKeyPhoneCall#fabadc5f = InputPrivacyKey;\ninputPrivacyKeyPhoneP2P#db9e70d2 = InputPrivacyKey;\ninputPrivacyKeyForwards#a4dd4c08 = InputPrivacyKey;\ninputPrivacyKeyProfilePhoto#5719bacc = InputPrivacyKey;\ninputPrivacyKeyPhoneNumber#352dafa = InputPrivacyKey;\ninputPrivacyKeyAddedByPhone#d1219bdd = InputPrivacyKey;\ninputPrivacyKeyVoiceMessages#aee69d68 = InputPrivacyKey;\ninputPrivacyKeyAbout#3823cc40 = InputPrivacyKey;\ninputPrivacyKeyBirthday#d65a11cc = InputPrivacyKey;\ninputPrivacyKeyStarGiftsAutoSave#e1732341 = InputPrivacyKey;\ninputPrivacyKeyNoPaidMessages#bdc597b4 = InputPrivacyKey;\ninputPrivacyKeySavedMusic#4dbe9226 = InputPrivacyKey;\nprivacyKeyStatusTimestamp#bc2eab30 = PrivacyKey;\nprivacyKeyChatInvite#500e6dfa = PrivacyKey;\nprivacyKeyPhoneCall#3d662b7b = PrivacyKey;\nprivacyKeyPhoneP2P#39491cc8 = PrivacyKey;\nprivacyKeyForwards#69ec56a3 = PrivacyKey;\nprivacyKeyProfilePhoto#96151fed = PrivacyKey;\nprivacyKeyPhoneNumber#d19ae46d = PrivacyKey;\nprivacyKeyAddedByPhone#42ffd42b = PrivacyKey;\nprivacyKeyVoiceMessages#697f414 = PrivacyKey;\nprivacyKeyAbout#a486b761 = PrivacyKey;\nprivacyKeyBirthday#2000a518 = PrivacyKey;\nprivacyKeyStarGiftsAutoSave#2ca4fdf8 = PrivacyKey;\nprivacyKeyNoPaidMessages#17d348d2 = PrivacyKey;\nprivacyKeySavedMusic#ff7a571b = PrivacyKey;\ninputPrivacyValueAllowContacts#d09e07b = InputPrivacyRule;\ninputPrivacyValueAllowAll#184b35ce = InputPrivacyRule;\ninputPrivacyValueAllowUsers#131cc67f users:Vector<InputUser> = InputPrivacyRule;\ninputPrivacyValueDisallowContacts#ba52007 = InputPrivacyRule;\ninputPrivacyValueDisallowAll#d66b66c9 = InputPrivacyRule;\ninputPrivacyValueDisallowUsers#90110467 users:Vector<InputUser> = InputPrivacyRule;\ninputPrivacyValueAllowChatParticipants#840649cf chats:Vector<long> = InputPrivacyRule;\ninputPrivacyValueDisallowChatParticipants#e94f0f86 chats:Vector<long> = InputPrivacyRule;\ninputPrivacyValueAllowCloseFriends#2f453e49 = InputPrivacyRule;\ninputPrivacyValueAllowPremium#77cdc9f1 = InputPrivacyRule;\ninputPrivacyValueAllowBots#5a4fcce5 = InputPrivacyRule;\ninputPrivacyValueDisallowBots#c4e57915 = InputPrivacyRule;\nprivacyValueAllowContacts#fffe1bac = PrivacyRule;\nprivacyValueAllowAll#65427b82 = PrivacyRule;\nprivacyValueAllowUsers#b8905fb2 users:Vector<long> = PrivacyRule;\nprivacyValueDisallowContacts#f888fa1a = PrivacyRule;\nprivacyValueDisallowAll#8b73e763 = PrivacyRule;\nprivacyValueDisallowUsers#e4621141 users:Vector<long> = PrivacyRule;\nprivacyValueAllowChatParticipants#6b134e8e chats:Vector<long> = PrivacyRule;\nprivacyValueDisallowChatParticipants#41c87565 chats:Vector<long> = PrivacyRule;\nprivacyValueAllowCloseFriends#f7e8d89b = PrivacyRule;\nprivacyValueAllowPremium#ece9814b = PrivacyRule;\nprivacyValueAllowBots#21461b5d = PrivacyRule;\nprivacyValueDisallowBots#f6a5f82f = PrivacyRule;\naccount.privacyRules#50a04e45 rules:Vector<PrivacyRule> chats:Vector<Chat> users:Vector<User> = account.PrivacyRules;\naccountDaysTTL#b8d0afdf days:int = AccountDaysTTL;\ndocumentAttributeImageSize#6c37c15c w:int h:int = DocumentAttribute;\ndocumentAttributeAnimated#11b58939 = DocumentAttribute;\ndocumentAttributeSticker#6319d612 flags:# mask:flags.1?true alt:string stickerset:InputStickerSet mask_coords:flags.0?MaskCoords = DocumentAttribute;\ndocumentAttributeVideo#43c57c48 flags:# round_message:flags.0?true supports_streaming:flags.1?true nosound:flags.3?true duration:double w:int h:int preload_prefix_size:flags.2?int video_start_ts:flags.4?double video_codec:flags.5?string = DocumentAttribute;\ndocumentAttributeAudio#9852f9c6 flags:# voice:flags.10?true duration:int title:flags.0?string performer:flags.1?string waveform:flags.2?bytes = DocumentAttribute;\ndocumentAttributeFilename#15590068 file_name:string = DocumentAttribute;\ndocumentAttributeHasStickers#9801d2f7 = DocumentAttribute;\ndocumentAttributeCustomEmoji#fd149899 flags:# free:flags.0?true text_color:flags.1?true alt:string stickerset:InputStickerSet = DocumentAttribute;\nmessages.stickersNotModified#f1749a22 = messages.Stickers;\nmessages.stickers#30a6ec7e hash:long stickers:Vector<Document> = messages.Stickers;\nstickerPack#12b299d4 emoticon:string documents:Vector<long> = StickerPack;\nmessages.allStickersNotModified#e86602c3 = messages.AllStickers;\nmessages.allStickers#cdbbcebb hash:long sets:Vector<StickerSet> = messages.AllStickers;\nmessages.affectedMessages#84d19185 pts:int pts_count:int = messages.AffectedMessages;\nwebPageEmpty#211a1788 flags:# id:long url:flags.0?string = WebPage;\nwebPagePending#b0d13e47 flags:# id:long url:flags.0?string date:int = WebPage;\nwebPage#e89c45b2 flags:# has_large_media:flags.13?true video_cover_photo:flags.14?true id:long url:string display_url:string hash:int type:flags.0?string site_name:flags.1?string title:flags.2?string description:flags.3?string photo:flags.4?Photo embed_url:flags.5?string embed_type:flags.5?string embed_width:flags.6?int embed_height:flags.6?int duration:flags.7?int author:flags.8?string document:flags.9?Document cached_page:flags.10?Page attributes:flags.12?Vector<WebPageAttribute> = WebPage;\nwebPageNotModified#7311ca11 flags:# cached_page_views:flags.0?int = WebPage;\nauthorization#ad01d61d flags:# current:flags.0?true official_app:flags.1?true password_pending:flags.2?true encrypted_requests_disabled:flags.3?true call_requests_disabled:flags.4?true unconfirmed:flags.5?true hash:long device_model:string platform:string system_version:string api_id:int app_name:string app_version:string date_created:int date_active:int ip:string country:string region:string = Authorization;\naccount.authorizations#4bff8ea0 authorization_ttl_days:int authorizations:Vector<Authorization> = account.Authorizations;\naccount.password#957b50fb flags:# has_recovery:flags.0?true has_secure_values:flags.1?true has_password:flags.2?true current_algo:flags.2?PasswordKdfAlgo srp_B:flags.2?bytes srp_id:flags.2?long hint:flags.3?string email_unconfirmed_pattern:flags.4?string new_algo:PasswordKdfAlgo new_secure_algo:SecurePasswordKdfAlgo secure_random:bytes pending_reset_date:flags.5?int login_email_pattern:flags.6?string = account.Password;\naccount.passwordSettings#9a5c33e5 flags:# email:flags.0?string secure_settings:flags.1?SecureSecretSettings = account.PasswordSettings;\naccount.passwordInputSettings#c23727c9 flags:# new_algo:flags.0?PasswordKdfAlgo new_password_hash:flags.0?bytes hint:flags.0?string email:flags.1?string new_secure_settings:flags.2?SecureSecretSettings = account.PasswordInputSettings;\nauth.passwordRecovery#137948a5 email_pattern:string = auth.PasswordRecovery;\nreceivedNotifyMessage#a384b779 id:int flags:int = ReceivedNotifyMessage;\nchatInviteExported#a22cbd96 flags:# revoked:flags.0?true permanent:flags.5?true request_needed:flags.6?true link:string admin_id:long date:int start_date:flags.4?int expire_date:flags.1?int usage_limit:flags.2?int usage:flags.3?int requested:flags.7?int subscription_expired:flags.10?int title:flags.8?string subscription_pricing:flags.9?StarsSubscriptionPricing = ExportedChatInvite;\nchatInvitePublicJoinRequests#ed107ab7 = ExportedChatInvite;\nchatInviteAlready#5a686d7c chat:Chat = ChatInvite;\nchatInvite#5c9d3702 flags:# channel:flags.0?true broadcast:flags.1?true public:flags.2?true megagroup:flags.3?true request_needed:flags.6?true verified:flags.7?true scam:flags.8?true fake:flags.9?true can_refulfill_subscription:flags.11?true title:string about:flags.5?string photo:Photo participants_count:int participants:flags.4?Vector<User> color:int subscription_pricing:flags.10?StarsSubscriptionPricing subscription_form_id:flags.12?long bot_verification:flags.13?BotVerification = ChatInvite;\nchatInvitePeek#61695cb0 chat:Chat expires:int = ChatInvite;\ninputStickerSetEmpty#ffb62b95 = InputStickerSet;\ninputStickerSetID#9de7a269 id:long access_hash:long = InputStickerSet;\ninputStickerSetShortName#861cc8a0 short_name:string = InputStickerSet;\ninputStickerSetAnimatedEmoji#28703c8 = InputStickerSet;\ninputStickerSetDice#e67f520e emoticon:string = InputStickerSet;\ninputStickerSetAnimatedEmojiAnimations#cde3739 = InputStickerSet;\ninputStickerSetPremiumGifts#c88b3b02 = InputStickerSet;\ninputStickerSetEmojiGenericAnimations#4c4d4ce = InputStickerSet;\ninputStickerSetEmojiDefaultStatuses#29d0f5ee = InputStickerSet;\ninputStickerSetEmojiDefaultTopicIcons#44c1f8e9 = InputStickerSet;\ninputStickerSetEmojiChannelDefaultStatuses#49748553 = InputStickerSet;\ninputStickerSetTonGifts#1cf671a0 = InputStickerSet;\nstickerSet#2dd14edc flags:# archived:flags.1?true official:flags.2?true masks:flags.3?true emojis:flags.7?true text_color:flags.9?true channel_emoji_status:flags.10?true creator:flags.11?true installed_date:flags.0?int id:long access_hash:long title:string short_name:string thumbs:flags.4?Vector<PhotoSize> thumb_dc_id:flags.4?int thumb_version:flags.4?int thumb_document_id:flags.8?long count:int hash:int = StickerSet;\nmessages.stickerSet#6e153f16 set:StickerSet packs:Vector<StickerPack> keywords:Vector<StickerKeyword> documents:Vector<Document> = messages.StickerSet;\nmessages.stickerSetNotModified#d3f924eb = messages.StickerSet;\nbotCommand#c27ac8c7 command:string description:string = BotCommand;\nbotInfo#4d8a0299 flags:# has_preview_medias:flags.6?true user_id:flags.0?long description:flags.1?string description_photo:flags.4?Photo description_document:flags.5?Document commands:flags.2?Vector<BotCommand> menu_button:flags.3?BotMenuButton privacy_policy_url:flags.7?string app_settings:flags.8?BotAppSettings verifier_settings:flags.9?BotVerifierSettings = BotInfo;\nkeyboardButton#a2fa4880 text:string = KeyboardButton;\nkeyboardButtonUrl#258aff05 text:string url:string = KeyboardButton;\nkeyboardButtonCallback#35bbdb6b flags:# requires_password:flags.0?true text:string data:bytes = KeyboardButton;\nkeyboardButtonRequestPhone#b16a6c29 text:string = KeyboardButton;\nkeyboardButtonRequestGeoLocation#fc796b3f text:string = KeyboardButton;\nkeyboardButtonSwitchInline#93b9fbb5 flags:# same_peer:flags.0?true text:string query:string peer_types:flags.1?Vector<InlineQueryPeerType> = KeyboardButton;\nkeyboardButtonGame#50f41ccf text:string = KeyboardButton;\nkeyboardButtonBuy#afd93fbb text:string = KeyboardButton;\nkeyboardButtonUrlAuth#10b78d29 flags:# text:string fwd_text:flags.0?string url:string button_id:int = KeyboardButton;\ninputKeyboardButtonUrlAuth#d02e7fd4 flags:# request_write_access:flags.0?true text:string fwd_text:flags.1?string url:string bot:InputUser = KeyboardButton;\nkeyboardButtonRequestPoll#bbc7515d flags:# quiz:flags.0?Bool text:string = KeyboardButton;\ninputKeyboardButtonUserProfile#e988037b text:string user_id:InputUser = KeyboardButton;\nkeyboardButtonUserProfile#308660c1 text:string user_id:long = KeyboardButton;\nkeyboardButtonWebView#13767230 text:string url:string = KeyboardButton;\nkeyboardButtonSimpleWebView#a0c0505c text:string url:string = KeyboardButton;\nkeyboardButtonRequestPeer#53d7bfd8 text:string button_id:int peer_type:RequestPeerType max_quantity:int = KeyboardButton;\ninputKeyboardButtonRequestPeer#c9662d05 flags:# name_requested:flags.0?true username_requested:flags.1?true photo_requested:flags.2?true text:string button_id:int peer_type:RequestPeerType max_quantity:int = KeyboardButton;\nkeyboardButtonCopy#75d2698e text:string copy_text:string = KeyboardButton;\nkeyboardButtonRow#77608b83 buttons:Vector<KeyboardButton> = KeyboardButtonRow;\nreplyKeyboardHide#a03e5b85 flags:# selective:flags.2?true = ReplyMarkup;\nreplyKeyboardForceReply#86b40b08 flags:# single_use:flags.1?true selective:flags.2?true placeholder:flags.3?string = ReplyMarkup;\nreplyKeyboardMarkup#85dd99d1 flags:# resize:flags.0?true single_use:flags.1?true selective:flags.2?true persistent:flags.4?true rows:Vector<KeyboardButtonRow> placeholder:flags.3?string = ReplyMarkup;\nreplyInlineMarkup#48a30254 rows:Vector<KeyboardButtonRow> = ReplyMarkup;\nmessageEntityUnknown#bb92ba95 offset:int length:int = MessageEntity;\nmessageEntityMention#fa04579d offset:int length:int = MessageEntity;\nmessageEntityHashtag#6f635b0d offset:int length:int = MessageEntity;\nmessageEntityBotCommand#6cef8ac7 offset:int length:int = MessageEntity;\nmessageEntityUrl#6ed02538 offset:int length:int = MessageEntity;\nmessageEntityEmail#64e475c2 offset:int length:int = MessageEntity;\nmessageEntityBold#bd610bc9 offset:int length:int = MessageEntity;\nmessageEntityItalic#826f8b60 offset:int length:int = MessageEntity;\nmessageEntityCode#28a20571 offset:int length:int = MessageEntity;\nmessageEntityPre#73924be0 offset:int length:int language:string = MessageEntity;\nmessageEntityTextUrl#76a6d327 offset:int length:int url:string = MessageEntity;\nmessageEntityMentionName#dc7b1140 offset:int length:int user_id:long = MessageEntity;\ninputMessageEntityMentionName#208e68c9 offset:int length:int user_id:InputUser = MessageEntity;\nmessageEntityPhone#9b69e34b offset:int length:int = MessageEntity;\nmessageEntityCashtag#4c4e743f offset:int length:int = MessageEntity;\nmessageEntityUnderline#9c4e7e8b offset:int length:int = MessageEntity;\nmessageEntityStrike#bf0693d4 offset:int length:int = MessageEntity;\nmessageEntityBankCard#761e6af4 offset:int length:int = MessageEntity;\nmessageEntitySpoiler#32ca960f offset:int length:int = MessageEntity;\nmessageEntityCustomEmoji#c8cf05f8 offset:int length:int document_id:long = MessageEntity;\nmessageEntityBlockquote#f1ccaaac flags:# collapsed:flags.0?true offset:int length:int = MessageEntity;\ninputChannelEmpty#ee8c1e86 = InputChannel;\ninputChannel#f35aec28 channel_id:long access_hash:long = InputChannel;\ninputChannelFromMessage#5b934f9d peer:InputPeer msg_id:int channel_id:long = InputChannel;\ncontacts.resolvedPeer#7f077ad9 peer:Peer chats:Vector<Chat> users:Vector<User> = contacts.ResolvedPeer;\nmessageRange#ae30253 min_id:int max_id:int = MessageRange;\nupdates.channelDifferenceEmpty#3e11affb flags:# final:flags.0?true pts:int timeout:flags.1?int = updates.ChannelDifference;\nupdates.channelDifferenceTooLong#a4bcc6fe flags:# final:flags.0?true timeout:flags.1?int dialog:Dialog messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = updates.ChannelDifference;\nupdates.channelDifference#2064674e flags:# final:flags.0?true pts:int timeout:flags.1?int new_messages:Vector<Message> other_updates:Vector<Update> chats:Vector<Chat> users:Vector<User> = updates.ChannelDifference;\nchannelMessagesFilterEmpty#94d42ee7 = ChannelMessagesFilter;\nchannelMessagesFilter#cd77d957 flags:# exclude_new_messages:flags.1?true ranges:Vector<MessageRange> = ChannelMessagesFilter;\nchannelParticipant#cb397619 flags:# user_id:long date:int subscription_until_date:flags.0?int = ChannelParticipant;\nchannelParticipantSelf#4f607bef flags:# via_request:flags.0?true user_id:long inviter_id:long date:int subscription_until_date:flags.1?int = ChannelParticipant;\nchannelParticipantCreator#2fe601d3 flags:# user_id:long admin_rights:ChatAdminRights rank:flags.0?string = ChannelParticipant;\nchannelParticipantAdmin#34c3bb53 flags:# can_edit:flags.0?true self:flags.1?true user_id:long inviter_id:flags.1?long promoted_by:long date:int admin_rights:ChatAdminRights rank:flags.2?string = ChannelParticipant;\nchannelParticipantBanned#6df8014e flags:# left:flags.0?true peer:Peer kicked_by:long date:int banned_rights:ChatBannedRights = ChannelParticipant;\nchannelParticipantLeft#1b03f006 peer:Peer = ChannelParticipant;\nchannelParticipantsRecent#de3f3c79 = ChannelParticipantsFilter;\nchannelParticipantsAdmins#b4608969 = ChannelParticipantsFilter;\nchannelParticipantsKicked#a3b54985 q:string = ChannelParticipantsFilter;\nchannelParticipantsBots#b0d1865b = ChannelParticipantsFilter;\nchannelParticipantsBanned#1427a5e1 q:string = ChannelParticipantsFilter;\nchannelParticipantsSearch#656ac4b q:string = ChannelParticipantsFilter;\nchannelParticipantsContacts#bb6ae88d q:string = ChannelParticipantsFilter;\nchannelParticipantsMentions#e04b5ceb flags:# q:flags.0?string top_msg_id:flags.1?int = ChannelParticipantsFilter;\nchannels.channelParticipants#9ab0feaf count:int participants:Vector<ChannelParticipant> chats:Vector<Chat> users:Vector<User> = channels.ChannelParticipants;\nchannels.channelParticipantsNotModified#f0173fe9 = channels.ChannelParticipants;\nchannels.channelParticipant#dfb80317 participant:ChannelParticipant chats:Vector<Chat> users:Vector<User> = channels.ChannelParticipant;\nhelp.termsOfService#780a0310 flags:# popup:flags.0?true id:DataJSON text:string entities:Vector<MessageEntity> min_age_confirm:flags.1?int = help.TermsOfService;\nmessages.savedGifsNotModified#e8025ca2 = messages.SavedGifs;\nmessages.savedGifs#84a02a0d hash:long gifs:Vector<Document> = messages.SavedGifs;\ninputBotInlineMessageMediaAuto#3380c786 flags:# invert_media:flags.3?true message:string entities:flags.1?Vector<MessageEntity> reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageText#3dcd7a87 flags:# no_webpage:flags.0?true invert_media:flags.3?true message:string entities:flags.1?Vector<MessageEntity> reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageMediaGeo#96929a85 flags:# geo_point:InputGeoPoint heading:flags.0?int period:flags.1?int proximity_notification_radius:flags.3?int reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageMediaVenue#417bbf11 flags:# geo_point:InputGeoPoint title:string address:string provider:string venue_id:string venue_type:string reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageMediaContact#a6edbffd flags:# phone_number:string first_name:string last_name:string vcard:string reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageGame#4b425864 flags:# reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageMediaInvoice#d7e78225 flags:# title:string description:string photo:flags.0?InputWebDocument invoice:Invoice payload:bytes provider:string provider_data:DataJSON reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineMessageMediaWebPage#bddcc510 flags:# invert_media:flags.3?true force_large_media:flags.4?true force_small_media:flags.5?true optional:flags.6?true message:string entities:flags.1?Vector<MessageEntity> url:string reply_markup:flags.2?ReplyMarkup = InputBotInlineMessage;\ninputBotInlineResult#88bf9319 flags:# id:string type:string title:flags.1?string description:flags.2?string url:flags.3?string thumb:flags.4?InputWebDocument content:flags.5?InputWebDocument send_message:InputBotInlineMessage = InputBotInlineResult;\ninputBotInlineResultPhoto#a8d864a7 id:string type:string photo:InputPhoto send_message:InputBotInlineMessage = InputBotInlineResult;\ninputBotInlineResultDocument#fff8fdc4 flags:# id:string type:string title:flags.1?string description:flags.2?string document:InputDocument send_message:InputBotInlineMessage = InputBotInlineResult;\ninputBotInlineResultGame#4fa417f2 id:string short_name:string send_message:InputBotInlineMessage = InputBotInlineResult;\nbotInlineMessageMediaAuto#764cf810 flags:# invert_media:flags.3?true message:string entities:flags.1?Vector<MessageEntity> reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageText#8c7f65e2 flags:# no_webpage:flags.0?true invert_media:flags.3?true message:string entities:flags.1?Vector<MessageEntity> reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageMediaGeo#51846fd flags:# geo:GeoPoint heading:flags.0?int period:flags.1?int proximity_notification_radius:flags.3?int reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageMediaVenue#8a86659c flags:# geo:GeoPoint title:string address:string provider:string venue_id:string venue_type:string reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageMediaContact#18d1cdc2 flags:# phone_number:string first_name:string last_name:string vcard:string reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageMediaInvoice#354a9b09 flags:# shipping_address_requested:flags.1?true test:flags.3?true title:string description:string photo:flags.0?WebDocument currency:string total_amount:long reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineMessageMediaWebPage#809ad9a6 flags:# invert_media:flags.3?true force_large_media:flags.4?true force_small_media:flags.5?true manual:flags.7?true safe:flags.8?true message:string entities:flags.1?Vector<MessageEntity> url:string reply_markup:flags.2?ReplyMarkup = BotInlineMessage;\nbotInlineResult#11965f3a flags:# id:string type:string title:flags.1?string description:flags.2?string url:flags.3?string thumb:flags.4?WebDocument content:flags.5?WebDocument send_message:BotInlineMessage = BotInlineResult;\nbotInlineMediaResult#17db940b flags:# id:string type:string photo:flags.0?Photo document:flags.1?Document title:flags.2?string description:flags.3?string send_message:BotInlineMessage = BotInlineResult;\nmessages.botResults#e021f2f6 flags:# gallery:flags.0?true query_id:long next_offset:flags.1?string switch_pm:flags.2?InlineBotSwitchPM switch_webview:flags.3?InlineBotWebView results:Vector<BotInlineResult> cache_time:int users:Vector<User> = messages.BotResults;\nexportedMessageLink#5dab1af4 link:string html:string = ExportedMessageLink;\nmessageFwdHeader#4e4df4bb flags:# imported:flags.7?true saved_out:flags.11?true from_id:flags.0?Peer from_name:flags.5?string date:int channel_post:flags.2?int post_author:flags.3?string saved_from_peer:flags.4?Peer saved_from_msg_id:flags.4?int saved_from_id:flags.8?Peer saved_from_name:flags.9?string saved_date:flags.10?int psa_type:flags.6?string = MessageFwdHeader;\nauth.codeTypeSms#72a3158c = auth.CodeType;\nauth.codeTypeCall#741cd3e3 = auth.CodeType;\nauth.codeTypeFlashCall#226ccefb = auth.CodeType;\nauth.codeTypeMissedCall#d61ad6ee = auth.CodeType;\nauth.codeTypeFragmentSms#6ed998c = auth.CodeType;\nauth.sentCodeTypeApp#3dbb5986 length:int = auth.SentCodeType;\nauth.sentCodeTypeSms#c000bba2 length:int = auth.SentCodeType;\nauth.sentCodeTypeCall#5353e5a7 length:int = auth.SentCodeType;\nauth.sentCodeTypeFlashCall#ab03c6d9 pattern:string = auth.SentCodeType;\nauth.sentCodeTypeMissedCall#82006484 prefix:string length:int = auth.SentCodeType;\nauth.sentCodeTypeEmailCode#f450f59b flags:# apple_signin_allowed:flags.0?true google_signin_allowed:flags.1?true email_pattern:string length:int reset_available_period:flags.3?int reset_pending_date:flags.4?int = auth.SentCodeType;\nauth.sentCodeTypeSetUpEmailRequired#a5491dea flags:# apple_signin_allowed:flags.0?true google_signin_allowed:flags.1?true = auth.SentCodeType;\nauth.sentCodeTypeFragmentSms#d9565c39 url:string length:int = auth.SentCodeType;\nauth.sentCodeTypeFirebaseSms#9fd736 flags:# nonce:flags.0?bytes play_integrity_project_id:flags.2?long play_integrity_nonce:flags.2?bytes receipt:flags.1?string push_timeout:flags.1?int length:int = auth.SentCodeType;\nauth.sentCodeTypeSmsWord#a416ac81 flags:# beginning:flags.0?string = auth.SentCodeType;\nauth.sentCodeTypeSmsPhrase#b37794af flags:# beginning:flags.0?string = auth.SentCodeType;\nmessages.botCallbackAnswer#36585ea4 flags:# alert:flags.1?true has_url:flags.3?true native_ui:flags.4?true message:flags.0?string url:flags.2?string cache_time:int = messages.BotCallbackAnswer;\nmessages.messageEditData#26b5dde6 flags:# caption:flags.0?true = messages.MessageEditData;\ninputBotInlineMessageID#890c3d89 dc_id:int id:long access_hash:long = InputBotInlineMessageID;\ninputBotInlineMessageID64#b6d915d7 dc_id:int owner_id:long id:int access_hash:long = InputBotInlineMessageID;\ninlineBotSwitchPM#3c20629f text:string start_param:string = InlineBotSwitchPM;\nmessages.peerDialogs#3371c354 dialogs:Vector<Dialog> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> state:updates.State = messages.PeerDialogs;\ntopPeer#edcdc05b peer:Peer rating:double = TopPeer;\ntopPeerCategoryBotsPM#ab661b5b = TopPeerCategory;\ntopPeerCategoryBotsInline#148677e2 = TopPeerCategory;\ntopPeerCategoryCorrespondents#637b7ed = TopPeerCategory;\ntopPeerCategoryGroups#bd17a14a = TopPeerCategory;\ntopPeerCategoryChannels#161d9628 = TopPeerCategory;\ntopPeerCategoryPhoneCalls#1e76a78c = TopPeerCategory;\ntopPeerCategoryForwardUsers#a8406ca9 = TopPeerCategory;\ntopPeerCategoryForwardChats#fbeec0f0 = TopPeerCategory;\ntopPeerCategoryBotsApp#fd9e7bec = TopPeerCategory;\ntopPeerCategoryPeers#fb834291 category:TopPeerCategory count:int peers:Vector<TopPeer> = TopPeerCategoryPeers;\ncontacts.topPeersNotModified#de266ef5 = contacts.TopPeers;\ncontacts.topPeers#70b772a8 categories:Vector<TopPeerCategoryPeers> chats:Vector<Chat> users:Vector<User> = contacts.TopPeers;\ncontacts.topPeersDisabled#b52c939d = contacts.TopPeers;\ndraftMessageEmpty#1b0c841a flags:# date:flags.0?int = DraftMessage;\ndraftMessage#96eaa5eb flags:# no_webpage:flags.1?true invert_media:flags.6?true reply_to:flags.4?InputReplyTo message:string entities:flags.3?Vector<MessageEntity> media:flags.5?InputMedia date:int effect:flags.7?long suggested_post:flags.8?SuggestedPost = DraftMessage;\nmessages.featuredStickersNotModified#c6dc0c66 count:int = messages.FeaturedStickers;\nmessages.featuredStickers#be382906 flags:# premium:flags.0?true hash:long count:int sets:Vector<StickerSetCovered> unread:Vector<long> = messages.FeaturedStickers;\nmessages.recentStickersNotModified#b17f890 = messages.RecentStickers;\nmessages.recentStickers#88d37c56 hash:long packs:Vector<StickerPack> stickers:Vector<Document> dates:Vector<int> = messages.RecentStickers;\nmessages.archivedStickers#4fcba9c8 count:int sets:Vector<StickerSetCovered> = messages.ArchivedStickers;\nmessages.stickerSetInstallResultSuccess#38641628 = messages.StickerSetInstallResult;\nmessages.stickerSetInstallResultArchive#35e410a8 sets:Vector<StickerSetCovered> = messages.StickerSetInstallResult;\nstickerSetCovered#6410a5d2 set:StickerSet cover:Document = StickerSetCovered;\nstickerSetMultiCovered#3407e51b set:StickerSet covers:Vector<Document> = StickerSetCovered;\nstickerSetFullCovered#40d13c0e set:StickerSet packs:Vector<StickerPack> keywords:Vector<StickerKeyword> documents:Vector<Document> = StickerSetCovered;\nstickerSetNoCovered#77b15d1c set:StickerSet = StickerSetCovered;\nmaskCoords#aed6dbb2 n:int x:double y:double zoom:double = MaskCoords;\ninputStickeredMediaPhoto#4a992157 id:InputPhoto = InputStickeredMedia;\ninputStickeredMediaDocument#438865b id:InputDocument = InputStickeredMedia;\ngame#bdf9653b flags:# id:long access_hash:long short_name:string title:string description:string photo:Photo document:flags.0?Document = Game;\ninputGameID#32c3e77 id:long access_hash:long = InputGame;\ninputGameShortName#c331e80a bot_id:InputUser short_name:string = InputGame;\nhighScore#73a379eb pos:int user_id:long score:int = HighScore;\nmessages.highScores#9a3bfd99 scores:Vector<HighScore> users:Vector<User> = messages.HighScores;\ntextEmpty#dc3d824f = RichText;\ntextPlain#744694e0 text:string = RichText;\ntextBold#6724abc4 text:RichText = RichText;\ntextItalic#d912a59c text:RichText = RichText;\ntextUnderline#c12622c4 text:RichText = RichText;\ntextStrike#9bf8bb95 text:RichText = RichText;\ntextFixed#6c3f19b9 text:RichText = RichText;\ntextUrl#3c2884c1 text:RichText url:string webpage_id:long = RichText;\ntextEmail#de5a0dd6 text:RichText email:string = RichText;\ntextConcat#7e6260d7 texts:Vector<RichText> = RichText;\ntextSubscript#ed6a8504 text:RichText = RichText;\ntextSuperscript#c7fb5e01 text:RichText = RichText;\ntextMarked#34b8621 text:RichText = RichText;\ntextPhone#1ccb966a text:RichText phone:string = RichText;\ntextImage#81ccf4f document_id:long w:int h:int = RichText;\ntextAnchor#35553762 text:RichText name:string = RichText;\npageBlockUnsupported#13567e8a = PageBlock;\npageBlockTitle#70abc3fd text:RichText = PageBlock;\npageBlockSubtitle#8ffa9a1f text:RichText = PageBlock;\npageBlockAuthorDate#baafe5e0 author:RichText published_date:int = PageBlock;\npageBlockHeader#bfd064ec text:RichText = PageBlock;\npageBlockSubheader#f12bb6e1 text:RichText = PageBlock;\npageBlockParagraph#467a0766 text:RichText = PageBlock;\npageBlockPreformatted#c070d93e text:RichText language:string = PageBlock;\npageBlockFooter#48870999 text:RichText = PageBlock;\npageBlockDivider#db20b188 = PageBlock;\npageBlockAnchor#ce0d37b0 name:string = PageBlock;\npageBlockList#e4e88011 items:Vector<PageListItem> = PageBlock;\npageBlockBlockquote#263d7c26 text:RichText caption:RichText = PageBlock;\npageBlockPullquote#4f4456d3 text:RichText caption:RichText = PageBlock;\npageBlockPhoto#1759c560 flags:# photo_id:long caption:PageCaption url:flags.0?string webpage_id:flags.0?long = PageBlock;\npageBlockVideo#7c8fe7b6 flags:# autoplay:flags.0?true loop:flags.1?true video_id:long caption:PageCaption = PageBlock;\npageBlockCover#39f23300 cover:PageBlock = PageBlock;\npageBlockEmbed#a8718dc5 flags:# full_width:flags.0?true allow_scrolling:flags.3?true url:flags.1?string html:flags.2?string poster_photo_id:flags.4?long w:flags.5?int h:flags.5?int caption:PageCaption = PageBlock;\npageBlockEmbedPost#f259a80b url:string webpage_id:long author_photo_id:long author:string date:int blocks:Vector<PageBlock> caption:PageCaption = PageBlock;\npageBlockCollage#65a0fa4d items:Vector<PageBlock> caption:PageCaption = PageBlock;\npageBlockSlideshow#31f9590 items:Vector<PageBlock> caption:PageCaption = PageBlock;\npageBlockChannel#ef1751b5 channel:Chat = PageBlock;\npageBlockAudio#804361ea audio_id:long caption:PageCaption = PageBlock;\npageBlockKicker#1e148390 text:RichText = PageBlock;\npageBlockTable#bf4dea82 flags:# bordered:flags.0?true striped:flags.1?true title:RichText rows:Vector<PageTableRow> = PageBlock;\npageBlockOrderedList#9a8ae1e1 items:Vector<PageListOrderedItem> = PageBlock;\npageBlockDetails#76768bed flags:# open:flags.0?true blocks:Vector<PageBlock> title:RichText = PageBlock;\npageBlockRelatedArticles#16115a96 title:RichText articles:Vector<PageRelatedArticle> = PageBlock;\npageBlockMap#a44f3ef6 geo:GeoPoint zoom:int w:int h:int caption:PageCaption = PageBlock;\nphoneCallDiscardReasonMissed#85e42301 = PhoneCallDiscardReason;\nphoneCallDiscardReasonDisconnect#e095c1a0 = PhoneCallDiscardReason;\nphoneCallDiscardReasonHangup#57adc690 = PhoneCallDiscardReason;\nphoneCallDiscardReasonBusy#faf7e8c9 = PhoneCallDiscardReason;\nphoneCallDiscardReasonMigrateConferenceCall#9fbbf1f7 slug:string = PhoneCallDiscardReason;\ndataJSON#7d748d04 data:string = DataJSON;\nlabeledPrice#cb296bf8 label:string amount:long = LabeledPrice;\ninvoice#49ee584 flags:# test:flags.0?true name_requested:flags.1?true phone_requested:flags.2?true email_requested:flags.3?true shipping_address_requested:flags.4?true flexible:flags.5?true phone_to_provider:flags.6?true email_to_provider:flags.7?true recurring:flags.9?true currency:string prices:Vector<LabeledPrice> max_tip_amount:flags.8?long suggested_tip_amounts:flags.8?Vector<long> terms_url:flags.10?string subscription_period:flags.11?int = Invoice;\npaymentCharge#ea02c27e id:string provider_charge_id:string = PaymentCharge;\npostAddress#1e8caaeb street_line1:string street_line2:string city:string state:string country_iso2:string post_code:string = PostAddress;\npaymentRequestedInfo#909c3f94 flags:# name:flags.0?string phone:flags.1?string email:flags.2?string shipping_address:flags.3?PostAddress = PaymentRequestedInfo;\npaymentSavedCredentialsCard#cdc27a1f id:string title:string = PaymentSavedCredentials;\nwebDocument#1c570ed1 url:string access_hash:long size:int mime_type:string attributes:Vector<DocumentAttribute> = WebDocument;\nwebDocumentNoProxy#f9c8bcc6 url:string size:int mime_type:string attributes:Vector<DocumentAttribute> = WebDocument;\ninputWebDocument#9bed434d url:string size:int mime_type:string attributes:Vector<DocumentAttribute> = InputWebDocument;\ninputWebFileLocation#c239d686 url:string access_hash:long = InputWebFileLocation;\ninputWebFileGeoPointLocation#9f2221c9 geo_point:InputGeoPoint access_hash:long w:int h:int zoom:int scale:int = InputWebFileLocation;\ninputWebFileAudioAlbumThumbLocation#f46fe924 flags:# small:flags.2?true document:flags.0?InputDocument title:flags.1?string performer:flags.1?string = InputWebFileLocation;\nupload.webFile#21e753bc size:int mime_type:string file_type:storage.FileType mtime:int bytes:bytes = upload.WebFile;\npayments.paymentForm#a0058751 flags:# can_save_credentials:flags.2?true password_missing:flags.3?true form_id:long bot_id:long title:string description:string photo:flags.5?WebDocument invoice:Invoice provider_id:long url:string native_provider:flags.4?string native_params:flags.4?DataJSON additional_methods:flags.6?Vector<PaymentFormMethod> saved_info:flags.0?PaymentRequestedInfo saved_credentials:flags.1?Vector<PaymentSavedCredentials> users:Vector<User> = payments.PaymentForm;\npayments.paymentFormStars#7bf6b15c flags:# form_id:long bot_id:long title:string description:string photo:flags.5?WebDocument invoice:Invoice users:Vector<User> = payments.PaymentForm;\npayments.paymentFormStarGift#b425cfe1 form_id:long invoice:Invoice = payments.PaymentForm;\npayments.validatedRequestedInfo#d1451883 flags:# id:flags.0?string shipping_options:flags.1?Vector<ShippingOption> = payments.ValidatedRequestedInfo;\npayments.paymentResult#4e5f810d updates:Updates = payments.PaymentResult;\npayments.paymentVerificationNeeded#d8411139 url:string = payments.PaymentResult;\npayments.paymentReceipt#70c4fe03 flags:# date:int bot_id:long provider_id:long title:string description:string photo:flags.2?WebDocument invoice:Invoice info:flags.0?PaymentRequestedInfo shipping:flags.1?ShippingOption tip_amount:flags.3?long currency:string total_amount:long credentials_title:string users:Vector<User> = payments.PaymentReceipt;\npayments.paymentReceiptStars#dabbf83a flags:# date:int bot_id:long title:string description:string photo:flags.2?WebDocument invoice:Invoice currency:string total_amount:long transaction_id:string users:Vector<User> = payments.PaymentReceipt;\npayments.savedInfo#fb8fe43c flags:# has_saved_credentials:flags.1?true saved_info:flags.0?PaymentRequestedInfo = payments.SavedInfo;\ninputPaymentCredentialsSaved#c10eb2cf id:string tmp_password:bytes = InputPaymentCredentials;\ninputPaymentCredentials#3417d728 flags:# save:flags.0?true data:DataJSON = InputPaymentCredentials;\ninputPaymentCredentialsApplePay#aa1c39f payment_data:DataJSON = InputPaymentCredentials;\ninputPaymentCredentialsGooglePay#8ac32801 payment_token:DataJSON = InputPaymentCredentials;\naccount.tmpPassword#db64fd34 tmp_password:bytes valid_until:int = account.TmpPassword;\nshippingOption#b6213cdf id:string title:string prices:Vector<LabeledPrice> = ShippingOption;\ninputStickerSetItem#32da9e9c flags:# document:InputDocument emoji:string mask_coords:flags.0?MaskCoords keywords:flags.1?string = InputStickerSetItem;\ninputPhoneCall#1e36fded id:long access_hash:long = InputPhoneCall;\nphoneCallEmpty#5366c915 id:long = PhoneCall;\nphoneCallWaiting#c5226f17 flags:# video:flags.6?true id:long access_hash:long date:int admin_id:long participant_id:long protocol:PhoneCallProtocol receive_date:flags.0?int = PhoneCall;\nphoneCallRequested#14b0ed0c flags:# video:flags.6?true id:long access_hash:long date:int admin_id:long participant_id:long g_a_hash:bytes protocol:PhoneCallProtocol = PhoneCall;\nphoneCallAccepted#3660c311 flags:# video:flags.6?true id:long access_hash:long date:int admin_id:long participant_id:long g_b:bytes protocol:PhoneCallProtocol = PhoneCall;\nphoneCall#30535af5 flags:# p2p_allowed:flags.5?true video:flags.6?true conference_supported:flags.8?true id:long access_hash:long date:int admin_id:long participant_id:long g_a_or_b:bytes key_fingerprint:long protocol:PhoneCallProtocol connections:Vector<PhoneConnection> start_date:int custom_parameters:flags.7?DataJSON = PhoneCall;\nphoneCallDiscarded#50ca4de1 flags:# need_rating:flags.2?true need_debug:flags.3?true video:flags.6?true id:long reason:flags.0?PhoneCallDiscardReason duration:flags.1?int = PhoneCall;\nphoneConnection#9cc123c7 flags:# tcp:flags.0?true id:long ip:string ipv6:string port:int peer_tag:bytes = PhoneConnection;\nphoneConnectionWebrtc#635fe375 flags:# turn:flags.0?true stun:flags.1?true id:long ip:string ipv6:string port:int username:string password:string = PhoneConnection;\nphoneCallProtocol#fc878fc8 flags:# udp_p2p:flags.0?true udp_reflector:flags.1?true min_layer:int max_layer:int library_versions:Vector<string> = PhoneCallProtocol;\nphone.phoneCall#ec82e140 phone_call:PhoneCall users:Vector<User> = phone.PhoneCall;\nupload.cdnFileReuploadNeeded#eea8e46e request_token:bytes = upload.CdnFile;\nupload.cdnFile#a99fca4f bytes:bytes = upload.CdnFile;\ncdnPublicKey#c982eaba dc_id:int public_key:string = CdnPublicKey;\ncdnConfig#5725e40a public_keys:Vector<CdnPublicKey> = CdnConfig;\nlangPackString#cad181f6 key:string value:string = LangPackString;\nlangPackStringPluralized#6c47ac9f flags:# key:string zero_value:flags.0?string one_value:flags.1?string two_value:flags.2?string few_value:flags.3?string many_value:flags.4?string other_value:string = LangPackString;\nlangPackStringDeleted#2979eeb2 key:string = LangPackString;\nlangPackDifference#f385c1f6 lang_code:string from_version:int version:int strings:Vector<LangPackString> = LangPackDifference;\nlangPackLanguage#eeca5ce3 flags:# official:flags.0?true rtl:flags.2?true beta:flags.3?true name:string native_name:string lang_code:string base_lang_code:flags.1?string plural_code:string strings_count:int translated_count:int translations_url:string = LangPackLanguage;\nchannelAdminLogEventActionChangeTitle#e6dfb825 prev_value:string new_value:string = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeAbout#55188a2e prev_value:string new_value:string = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeUsername#6a4afc38 prev_value:string new_value:string = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangePhoto#434bd2af prev_photo:Photo new_photo:Photo = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleInvites#1b7907ae new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleSignatures#26ae0971 new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionUpdatePinned#e9e82c18 message:Message = ChannelAdminLogEventAction;\nchannelAdminLogEventActionEditMessage#709b2405 prev_message:Message new_message:Message = ChannelAdminLogEventAction;\nchannelAdminLogEventActionDeleteMessage#42e047bb message:Message = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantJoin#183040d3 = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantLeave#f89777f2 = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantInvite#e31c34d8 participant:ChannelParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantToggleBan#e6d83d7e prev_participant:ChannelParticipant new_participant:ChannelParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantToggleAdmin#d5676710 prev_participant:ChannelParticipant new_participant:ChannelParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeStickerSet#b1c3caa7 prev_stickerset:InputStickerSet new_stickerset:InputStickerSet = ChannelAdminLogEventAction;\nchannelAdminLogEventActionTogglePreHistoryHidden#5f5c95f1 new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionDefaultBannedRights#2df5fc0a prev_banned_rights:ChatBannedRights new_banned_rights:ChatBannedRights = ChannelAdminLogEventAction;\nchannelAdminLogEventActionStopPoll#8f079643 message:Message = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeLinkedChat#50c7ac8 prev_value:long new_value:long = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeLocation#e6b76ae prev_value:ChannelLocation new_value:ChannelLocation = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleSlowMode#53909779 prev_value:int new_value:int = ChannelAdminLogEventAction;\nchannelAdminLogEventActionStartGroupCall#23209745 call:InputGroupCall = ChannelAdminLogEventAction;\nchannelAdminLogEventActionDiscardGroupCall#db9f9140 call:InputGroupCall = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantMute#f92424d2 participant:GroupCallParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantUnmute#e64429c0 participant:GroupCallParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleGroupCallSetting#56d6a247 join_muted:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantJoinByInvite#fe9fc158 flags:# via_chatlist:flags.0?true invite:ExportedChatInvite = ChannelAdminLogEventAction;\nchannelAdminLogEventActionExportedInviteDelete#5a50fca4 invite:ExportedChatInvite = ChannelAdminLogEventAction;\nchannelAdminLogEventActionExportedInviteRevoke#410a134e invite:ExportedChatInvite = ChannelAdminLogEventAction;\nchannelAdminLogEventActionExportedInviteEdit#e90ebb59 prev_invite:ExportedChatInvite new_invite:ExportedChatInvite = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantVolume#3e7f6847 participant:GroupCallParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeHistoryTTL#6e941a38 prev_value:int new_value:int = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantJoinByRequest#afb6144a invite:ExportedChatInvite approved_by:long = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleNoForwards#cb2ac766 new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionSendMessage#278f2868 message:Message = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeAvailableReactions#be4e0ef8 prev_value:ChatReactions new_value:ChatReactions = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeUsernames#f04fb3a9 prev_value:Vector<string> new_value:Vector<string> = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleForum#2cc6383 new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionCreateTopic#58707d28 topic:ForumTopic = ChannelAdminLogEventAction;\nchannelAdminLogEventActionEditTopic#f06fe208 prev_topic:ForumTopic new_topic:ForumTopic = ChannelAdminLogEventAction;\nchannelAdminLogEventActionDeleteTopic#ae168909 topic:ForumTopic = ChannelAdminLogEventAction;\nchannelAdminLogEventActionPinTopic#5d8d353b flags:# prev_topic:flags.0?ForumTopic new_topic:flags.1?ForumTopic = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleAntiSpam#64f36dfc new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangePeerColor#5796e780 prev_value:PeerColor new_value:PeerColor = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeProfilePeerColor#5e477b25 prev_value:PeerColor new_value:PeerColor = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeWallpaper#31bb5d52 prev_value:WallPaper new_value:WallPaper = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeEmojiStatus#3ea9feb1 prev_value:EmojiStatus new_value:EmojiStatus = ChannelAdminLogEventAction;\nchannelAdminLogEventActionChangeEmojiStickerSet#46d840ab prev_stickerset:InputStickerSet new_stickerset:InputStickerSet = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleSignatureProfiles#60a79c79 new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEventActionParticipantSubExtend#64642db3 prev_participant:ChannelParticipant new_participant:ChannelParticipant = ChannelAdminLogEventAction;\nchannelAdminLogEventActionToggleAutotranslation#c517f77e new_value:Bool = ChannelAdminLogEventAction;\nchannelAdminLogEvent#1fad68cd id:long date:int user_id:long action:ChannelAdminLogEventAction = ChannelAdminLogEvent;\nchannels.adminLogResults#ed8af74d events:Vector<ChannelAdminLogEvent> chats:Vector<Chat> users:Vector<User> = channels.AdminLogResults;\nchannelAdminLogEventsFilter#ea107ae4 flags:# join:flags.0?true leave:flags.1?true invite:flags.2?true ban:flags.3?true unban:flags.4?true kick:flags.5?true unkick:flags.6?true promote:flags.7?true demote:flags.8?true info:flags.9?true settings:flags.10?true pinned:flags.11?true edit:flags.12?true delete:flags.13?true group_call:flags.14?true invites:flags.15?true send:flags.16?true forums:flags.17?true sub_extend:flags.18?true = ChannelAdminLogEventsFilter;\npopularContact#5ce14175 client_id:long importers:int = PopularContact;\nmessages.favedStickersNotModified#9e8fa6d3 = messages.FavedStickers;\nmessages.favedStickers#2cb51097 hash:long packs:Vector<StickerPack> stickers:Vector<Document> = messages.FavedStickers;\nrecentMeUrlUnknown#46e1d13d url:string = RecentMeUrl;\nrecentMeUrlUser#b92c09e2 url:string user_id:long = RecentMeUrl;\nrecentMeUrlChat#b2da71d2 url:string chat_id:long = RecentMeUrl;\nrecentMeUrlChatInvite#eb49081d url:string chat_invite:ChatInvite = RecentMeUrl;\nrecentMeUrlStickerSet#bc0a57dc url:string set:StickerSetCovered = RecentMeUrl;\nhelp.recentMeUrls#e0310d7 urls:Vector<RecentMeUrl> chats:Vector<Chat> users:Vector<User> = help.RecentMeUrls;\ninputSingleMedia#1cc6e91f flags:# media:InputMedia random_id:long message:string entities:flags.0?Vector<MessageEntity> = InputSingleMedia;\nwebAuthorization#a6f8f452 hash:long bot_id:long domain:string browser:string platform:string date_created:int date_active:int ip:string region:string = WebAuthorization;\naccount.webAuthorizations#ed56c9fc authorizations:Vector<WebAuthorization> users:Vector<User> = account.WebAuthorizations;\ninputMessageID#a676a322 id:int = InputMessage;\ninputMessageReplyTo#bad88395 id:int = InputMessage;\ninputMessagePinned#86872538 = InputMessage;\ninputMessageCallbackQuery#acfa1a7e id:int query_id:long = InputMessage;\ninputDialogPeer#fcaafeb7 peer:InputPeer = InputDialogPeer;\ninputDialogPeerFolder#64600527 folder_id:int = InputDialogPeer;\ndialogPeer#e56dbf05 peer:Peer = DialogPeer;\ndialogPeerFolder#514519e2 folder_id:int = DialogPeer;\nmessages.foundStickerSetsNotModified#d54b65d = messages.FoundStickerSets;\nmessages.foundStickerSets#8af09dd2 hash:long sets:Vector<StickerSetCovered> = messages.FoundStickerSets;\nfileHash#f39b035c offset:long limit:int hash:bytes = FileHash;\ninputClientProxy#75588b3f address:string port:int = InputClientProxy;\nhelp.termsOfServiceUpdateEmpty#e3309f7f expires:int = help.TermsOfServiceUpdate;\nhelp.termsOfServiceUpdate#28ecf961 expires:int terms_of_service:help.TermsOfService = help.TermsOfServiceUpdate;\ninputSecureFileUploaded#3334b0f0 id:long parts:int md5_checksum:string file_hash:bytes secret:bytes = InputSecureFile;\ninputSecureFile#5367e5be id:long access_hash:long = InputSecureFile;\nsecureFileEmpty#64199744 = SecureFile;\nsecureFile#7d09c27e id:long access_hash:long size:long dc_id:int date:int file_hash:bytes secret:bytes = SecureFile;\nsecureData#8aeabec3 data:bytes data_hash:bytes secret:bytes = SecureData;\nsecurePlainPhone#7d6099dd phone:string = SecurePlainData;\nsecurePlainEmail#21ec5a5f email:string = SecurePlainData;\nsecureValueTypePersonalDetails#9d2a81e3 = SecureValueType;\nsecureValueTypePassport#3dac6a00 = SecureValueType;\nsecureValueTypeDriverLicense#6e425c4 = SecureValueType;\nsecureValueTypeIdentityCard#a0d0744b = SecureValueType;\nsecureValueTypeInternalPassport#99a48f23 = SecureValueType;\nsecureValueTypeAddress#cbe31e26 = SecureValueType;\nsecureValueTypeUtilityBill#fc36954e = SecureValueType;\nsecureValueTypeBankStatement#89137c0d = SecureValueType;\nsecureValueTypeRentalAgreement#8b883488 = SecureValueType;\nsecureValueTypePassportRegistration#99e3806a = SecureValueType;\nsecureValueTypeTemporaryRegistration#ea02ec33 = SecureValueType;\nsecureValueTypePhone#b320aadb = SecureValueType;\nsecureValueTypeEmail#8e3ca7ee = SecureValueType;\nsecureValue#187fa0ca flags:# type:SecureValueType data:flags.0?SecureData front_side:flags.1?SecureFile reverse_side:flags.2?SecureFile selfie:flags.3?SecureFile translation:flags.6?Vector<SecureFile> files:flags.4?Vector<SecureFile> plain_data:flags.5?SecurePlainData hash:bytes = SecureValue;\ninputSecureValue#db21d0a7 flags:# type:SecureValueType data:flags.0?SecureData front_side:flags.1?InputSecureFile reverse_side:flags.2?InputSecureFile selfie:flags.3?InputSecureFile translation:flags.6?Vector<InputSecureFile> files:flags.4?Vector<InputSecureFile> plain_data:flags.5?SecurePlainData = InputSecureValue;\nsecureValueHash#ed1ecdb0 type:SecureValueType hash:bytes = SecureValueHash;\nsecureValueErrorData#e8a40bd9 type:SecureValueType data_hash:bytes field:string text:string = SecureValueError;\nsecureValueErrorFrontSide#be3dfa type:SecureValueType file_hash:bytes text:string = SecureValueError;\nsecureValueErrorReverseSide#868a2aa5 type:SecureValueType file_hash:bytes text:string = SecureValueError;\nsecureValueErrorSelfie#e537ced6 type:SecureValueType file_hash:bytes text:string = SecureValueError;\nsecureValueErrorFile#7a700873 type:SecureValueType file_hash:bytes text:string = SecureValueError;\nsecureValueErrorFiles#666220e9 type:SecureValueType file_hash:Vector<bytes> text:string = SecureValueError;\nsecureValueError#869d758f type:SecureValueType hash:bytes text:string = SecureValueError;\nsecureValueErrorTranslationFile#a1144770 type:SecureValueType file_hash:bytes text:string = SecureValueError;\nsecureValueErrorTranslationFiles#34636dd8 type:SecureValueType file_hash:Vector<bytes> text:string = SecureValueError;\nsecureCredentialsEncrypted#33f0ea47 data:bytes hash:bytes secret:bytes = SecureCredentialsEncrypted;\naccount.authorizationForm#ad2e1cd8 flags:# required_types:Vector<SecureRequiredType> values:Vector<SecureValue> errors:Vector<SecureValueError> users:Vector<User> privacy_policy_url:flags.0?string = account.AuthorizationForm;\naccount.sentEmailCode#811f854f email_pattern:string length:int = account.SentEmailCode;\nhelp.deepLinkInfoEmpty#66afa166 = help.DeepLinkInfo;\nhelp.deepLinkInfo#6a4ee832 flags:# update_app:flags.0?true message:string entities:flags.1?Vector<MessageEntity> = help.DeepLinkInfo;\nsavedPhoneContact#1142bd56 phone:string first_name:string last_name:string date:int = SavedContact;\naccount.takeout#4dba4501 id:long = account.Takeout;\npasswordKdfAlgoUnknown#d45ab096 = PasswordKdfAlgo;\npasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow#3a912d4a salt1:bytes salt2:bytes g:int p:bytes = PasswordKdfAlgo;\nsecurePasswordKdfAlgoUnknown#4a8537 = SecurePasswordKdfAlgo;\nsecurePasswordKdfAlgoPBKDF2HMACSHA512iter100000#bbf2dda0 salt:bytes = SecurePasswordKdfAlgo;\nsecurePasswordKdfAlgoSHA512#86471d92 salt:bytes = SecurePasswordKdfAlgo;\nsecureSecretSettings#1527bcac secure_algo:SecurePasswordKdfAlgo secure_secret:bytes secure_secret_id:long = SecureSecretSettings;\ninputCheckPasswordEmpty#9880f658 = InputCheckPasswordSRP;\ninputCheckPasswordSRP#d27ff082 srp_id:long A:bytes M1:bytes = InputCheckPasswordSRP;\nsecureRequiredType#829d99da flags:# native_names:flags.0?true selfie_required:flags.1?true translation_required:flags.2?true type:SecureValueType = SecureRequiredType;\nsecureRequiredTypeOneOf#27477b4 types:Vector<SecureRequiredType> = SecureRequiredType;\nhelp.passportConfigNotModified#bfb9f457 = help.PassportConfig;\nhelp.passportConfig#a098d6af hash:int countries_langs:DataJSON = help.PassportConfig;\ninputAppEvent#1d1b1245 time:double type:string peer:long data:JSONValue = InputAppEvent;\njsonObjectValue#c0de1bd9 key:string value:JSONValue = JSONObjectValue;\njsonNull#3f6d7b68 = JSONValue;\njsonBool#c7345e6a value:Bool = JSONValue;\njsonNumber#2be0dfa4 value:double = JSONValue;\njsonString#b71e767a value:string = JSONValue;\njsonArray#f7444763 value:Vector<JSONValue> = JSONValue;\njsonObject#99c1d49d value:Vector<JSONObjectValue> = JSONValue;\npageTableCell#34566b6a flags:# header:flags.0?true align_center:flags.3?true align_right:flags.4?true valign_middle:flags.5?true valign_bottom:flags.6?true text:flags.7?RichText colspan:flags.1?int rowspan:flags.2?int = PageTableCell;\npageTableRow#e0c0c5e5 cells:Vector<PageTableCell> = PageTableRow;\npageCaption#6f747657 text:RichText credit:RichText = PageCaption;\npageListItemText#b92fb6cd text:RichText = PageListItem;\npageListItemBlocks#25e073fc blocks:Vector<PageBlock> = PageListItem;\npageListOrderedItemText#5e068047 num:string text:RichText = PageListOrderedItem;\npageListOrderedItemBlocks#98dd8936 num:string blocks:Vector<PageBlock> = PageListOrderedItem;\npageRelatedArticle#b390dc08 flags:# url:string webpage_id:long title:flags.0?string description:flags.1?string photo_id:flags.2?long author:flags.3?string published_date:flags.4?int = PageRelatedArticle;\npage#98657f0d flags:# part:flags.0?true rtl:flags.1?true v2:flags.2?true url:string blocks:Vector<PageBlock> photos:Vector<Photo> documents:Vector<Document> views:flags.3?int = Page;\nhelp.supportName#8c05f1c9 name:string = help.SupportName;\nhelp.userInfoEmpty#f3ae2eed = help.UserInfo;\nhelp.userInfo#1eb3758 message:string entities:Vector<MessageEntity> author:string date:int = help.UserInfo;\npollAnswer#ff16e2ca text:TextWithEntities option:bytes = PollAnswer;\npoll#58747131 id:long flags:# closed:flags.0?true public_voters:flags.1?true multiple_choice:flags.2?true quiz:flags.3?true question:TextWithEntities answers:Vector<PollAnswer> close_period:flags.4?int close_date:flags.5?int = Poll;\npollAnswerVoters#3b6ddad2 flags:# chosen:flags.0?true correct:flags.1?true option:bytes voters:int = PollAnswerVoters;\npollResults#7adf2420 flags:# min:flags.0?true results:flags.1?Vector<PollAnswerVoters> total_voters:flags.2?int recent_voters:flags.3?Vector<Peer> solution:flags.4?string solution_entities:flags.4?Vector<MessageEntity> = PollResults;\nchatOnlines#f041e250 onlines:int = ChatOnlines;\nstatsURL#47a971e0 url:string = StatsURL;\nchatAdminRights#5fb224d5 flags:# change_info:flags.0?true post_messages:flags.1?true edit_messages:flags.2?true delete_messages:flags.3?true ban_users:flags.4?true invite_users:flags.5?true pin_messages:flags.7?true add_admins:flags.9?true anonymous:flags.10?true manage_call:flags.11?true other:flags.12?true manage_topics:flags.13?true post_stories:flags.14?true edit_stories:flags.15?true delete_stories:flags.16?true manage_direct_messages:flags.17?true = ChatAdminRights;\nchatBannedRights#9f120418 flags:# view_messages:flags.0?true send_messages:flags.1?true send_media:flags.2?true send_stickers:flags.3?true send_gifs:flags.4?true send_games:flags.5?true send_inline:flags.6?true embed_links:flags.7?true send_polls:flags.8?true change_info:flags.10?true invite_users:flags.15?true pin_messages:flags.17?true manage_topics:flags.18?true send_photos:flags.19?true send_videos:flags.20?true send_roundvideos:flags.21?true send_audios:flags.22?true send_voices:flags.23?true send_docs:flags.24?true send_plain:flags.25?true until_date:int = ChatBannedRights;\ninputWallPaper#e630b979 id:long access_hash:long = InputWallPaper;\ninputWallPaperSlug#72091c80 slug:string = InputWallPaper;\ninputWallPaperNoFile#967a462e id:long = InputWallPaper;\naccount.wallPapersNotModified#1c199183 = account.WallPapers;\naccount.wallPapers#cdc3858c hash:long wallpapers:Vector<WallPaper> = account.WallPapers;\ncodeSettings#ad253d78 flags:# allow_flashcall:flags.0?true current_number:flags.1?true allow_app_hash:flags.4?true allow_missed_call:flags.5?true allow_firebase:flags.7?true unknown_number:flags.9?true logout_tokens:flags.6?Vector<bytes> token:flags.8?string app_sandbox:flags.8?Bool = CodeSettings;\nwallPaperSettings#372efcd0 flags:# blur:flags.1?true motion:flags.2?true background_color:flags.0?int second_background_color:flags.4?int third_background_color:flags.5?int fourth_background_color:flags.6?int intensity:flags.3?int rotation:flags.4?int emoticon:flags.7?string = WallPaperSettings;\nautoDownloadSettings#baa57628 flags:# disabled:flags.0?true video_preload_large:flags.1?true audio_preload_next:flags.2?true phonecalls_less_data:flags.3?true stories_preload:flags.4?true photo_size_max:int video_size_max:long file_size_max:long video_upload_maxbitrate:int small_queue_active_operations_max:int large_queue_active_operations_max:int = AutoDownloadSettings;\naccount.autoDownloadSettings#63cacf26 low:AutoDownloadSettings medium:AutoDownloadSettings high:AutoDownloadSettings = account.AutoDownloadSettings;\nemojiKeyword#d5b3b9f9 keyword:string emoticons:Vector<string> = EmojiKeyword;\nemojiKeywordDeleted#236df622 keyword:string emoticons:Vector<string> = EmojiKeyword;\nemojiKeywordsDifference#5cc761bd lang_code:string from_version:int version:int keywords:Vector<EmojiKeyword> = EmojiKeywordsDifference;\nemojiURL#a575739d url:string = EmojiURL;\nemojiLanguage#b3fb5361 lang_code:string = EmojiLanguage;\nfolder#ff544e65 flags:# autofill_new_broadcasts:flags.0?true autofill_public_groups:flags.1?true autofill_new_correspondents:flags.2?true id:int title:string photo:flags.3?ChatPhoto = Folder;\ninputFolderPeer#fbd2c296 peer:InputPeer folder_id:int = InputFolderPeer;\nfolderPeer#e9baa668 peer:Peer folder_id:int = FolderPeer;\nmessages.searchCounter#e844ebff flags:# inexact:flags.1?true filter:MessagesFilter count:int = messages.SearchCounter;\nurlAuthResultRequest#92d33a0e flags:# request_write_access:flags.0?true bot:User domain:string = UrlAuthResult;\nurlAuthResultAccepted#8f8c0e4e url:string = UrlAuthResult;\nurlAuthResultDefault#a9d6db1f = UrlAuthResult;\nchannelLocationEmpty#bfb5ad8b = ChannelLocation;\nchannelLocation#209b82db geo_point:GeoPoint address:string = ChannelLocation;\npeerLocated#ca461b5d peer:Peer expires:int distance:int = PeerLocated;\npeerSelfLocated#f8ec284b expires:int = PeerLocated;\nrestrictionReason#d072acb4 platform:string reason:string text:string = RestrictionReason;\ninputTheme#3c5693e9 id:long access_hash:long = InputTheme;\ninputThemeSlug#f5890df1 slug:string = InputTheme;\ntheme#a00e67d6 flags:# creator:flags.0?true default:flags.1?true for_chat:flags.5?true id:long access_hash:long slug:string title:string document:flags.2?Document settings:flags.3?Vector<ThemeSettings> emoticon:flags.6?string installs_count:flags.4?int = Theme;\naccount.themesNotModified#f41eb622 = account.Themes;\naccount.themes#9a3d8c6d hash:long themes:Vector<Theme> = account.Themes;\nauth.loginToken#629f1980 expires:int token:bytes = auth.LoginToken;\nauth.loginTokenMigrateTo#68e9916 dc_id:int token:bytes = auth.LoginToken;\nauth.loginTokenSuccess#390d5c5e authorization:auth.Authorization = auth.LoginToken;\naccount.contentSettings#57e28221 flags:# sensitive_enabled:flags.0?true sensitive_can_change:flags.1?true = account.ContentSettings;\nmessages.inactiveChats#a927fec5 dates:Vector<int> chats:Vector<Chat> users:Vector<User> = messages.InactiveChats;\nbaseThemeClassic#c3a12462 = BaseTheme;\nbaseThemeDay#fbd81688 = BaseTheme;\nbaseThemeNight#b7b31ea8 = BaseTheme;\nbaseThemeTinted#6d5f77ee = BaseTheme;\nbaseThemeArctic#5b11125a = BaseTheme;\ninputThemeSettings#8fde504f flags:# message_colors_animated:flags.2?true base_theme:BaseTheme accent_color:int outbox_accent_color:flags.3?int message_colors:flags.0?Vector<int> wallpaper:flags.1?InputWallPaper wallpaper_settings:flags.1?WallPaperSettings = InputThemeSettings;\nthemeSettings#fa58b6d4 flags:# message_colors_animated:flags.2?true base_theme:BaseTheme accent_color:int outbox_accent_color:flags.3?int message_colors:flags.0?Vector<int> wallpaper:flags.1?WallPaper = ThemeSettings;\nwebPageAttributeTheme#54b56617 flags:# documents:flags.0?Vector<Document> settings:flags.1?ThemeSettings = WebPageAttribute;\nwebPageAttributeStory#2e94c3e7 flags:# peer:Peer id:int story:flags.0?StoryItem = WebPageAttribute;\nwebPageAttributeStickerSet#50cc03d3 flags:# emojis:flags.0?true text_color:flags.1?true stickers:Vector<Document> = WebPageAttribute;\nwebPageAttributeUniqueStarGift#cf6f6db8 gift:StarGift = WebPageAttribute;\nwebPageAttributeStarGiftCollection#31cad303 icons:Vector<Document> = WebPageAttribute;\nwebPageAttributeStarGiftAuction#1c641c2 gift:StarGift end_date:int = WebPageAttribute;\nmessages.votesList#4899484e flags:# count:int votes:Vector<MessagePeerVote> chats:Vector<Chat> users:Vector<User> next_offset:flags.0?string = messages.VotesList;\nbankCardOpenUrl#f568028a url:string name:string = BankCardOpenUrl;\npayments.bankCardData#3e24e573 title:string open_urls:Vector<BankCardOpenUrl> = payments.BankCardData;\ndialogFilter#aa472651 flags:# contacts:flags.0?true non_contacts:flags.1?true groups:flags.2?true broadcasts:flags.3?true bots:flags.4?true exclude_muted:flags.11?true exclude_read:flags.12?true exclude_archived:flags.13?true title_noanimate:flags.28?true id:int title:TextWithEntities emoticon:flags.25?string color:flags.27?int pinned_peers:Vector<InputPeer> include_peers:Vector<InputPeer> exclude_peers:Vector<InputPeer> = DialogFilter;\ndialogFilterDefault#363293ae = DialogFilter;\ndialogFilterChatlist#96537bd7 flags:# has_my_invites:flags.26?true title_noanimate:flags.28?true id:int title:TextWithEntities emoticon:flags.25?string color:flags.27?int pinned_peers:Vector<InputPeer> include_peers:Vector<InputPeer> = DialogFilter;\ndialogFilterSuggested#77744d4a filter:DialogFilter description:string = DialogFilterSuggested;\nstatsDateRangeDays#b637edaf min_date:int max_date:int = StatsDateRangeDays;\nstatsAbsValueAndPrev#cb43acde current:double previous:double = StatsAbsValueAndPrev;\nstatsPercentValue#cbce2fe0 part:double total:double = StatsPercentValue;\nstatsGraphAsync#4a27eb2d token:string = StatsGraph;\nstatsGraphError#bedc9822 error:string = StatsGraph;\nstatsGraph#8ea464b6 flags:# json:DataJSON zoom_token:flags.0?string = StatsGraph;\nstats.broadcastStats#396ca5fc period:StatsDateRangeDays followers:StatsAbsValueAndPrev views_per_post:StatsAbsValueAndPrev shares_per_post:StatsAbsValueAndPrev reactions_per_post:StatsAbsValueAndPrev views_per_story:StatsAbsValueAndPrev shares_per_story:StatsAbsValueAndPrev reactions_per_story:StatsAbsValueAndPrev enabled_notifications:StatsPercentValue growth_graph:StatsGraph followers_graph:StatsGraph mute_graph:StatsGraph top_hours_graph:StatsGraph interactions_graph:StatsGraph iv_interactions_graph:StatsGraph views_by_source_graph:StatsGraph new_followers_by_source_graph:StatsGraph languages_graph:StatsGraph reactions_by_emotion_graph:StatsGraph story_interactions_graph:StatsGraph story_reactions_by_emotion_graph:StatsGraph recent_posts_interactions:Vector<PostInteractionCounters> = stats.BroadcastStats;\nhelp.promoDataEmpty#98f6ac75 expires:int = help.PromoData;\nhelp.promoData#8a4d87a flags:# proxy:flags.0?true expires:int peer:flags.3?Peer psa_type:flags.1?string psa_message:flags.2?string pending_suggestions:Vector<string> dismissed_suggestions:Vector<string> custom_pending_suggestion:flags.4?PendingSuggestion chats:Vector<Chat> users:Vector<User> = help.PromoData;\nvideoSize#de33b094 flags:# type:string w:int h:int size:int video_start_ts:flags.0?double = VideoSize;\nvideoSizeEmojiMarkup#f85c413c emoji_id:long background_colors:Vector<int> = VideoSize;\nvideoSizeStickerMarkup#da082fe stickerset:InputStickerSet sticker_id:long background_colors:Vector<int> = VideoSize;\nstatsGroupTopPoster#9d04af9b user_id:long messages:int avg_chars:int = StatsGroupTopPoster;\nstatsGroupTopAdmin#d7584c87 user_id:long deleted:int kicked:int banned:int = StatsGroupTopAdmin;\nstatsGroupTopInviter#535f779d user_id:long invitations:int = StatsGroupTopInviter;\nstats.megagroupStats#ef7ff916 period:StatsDateRangeDays members:StatsAbsValueAndPrev messages:StatsAbsValueAndPrev viewers:StatsAbsValueAndPrev posters:StatsAbsValueAndPrev growth_graph:StatsGraph members_graph:StatsGraph new_members_by_source_graph:StatsGraph languages_graph:StatsGraph messages_graph:StatsGraph actions_graph:StatsGraph top_hours_graph:StatsGraph weekdays_graph:StatsGraph top_posters:Vector<StatsGroupTopPoster> top_admins:Vector<StatsGroupTopAdmin> top_inviters:Vector<StatsGroupTopInviter> users:Vector<User> = stats.MegagroupStats;\nglobalPrivacySettings#fe41b34f flags:# archive_and_mute_new_noncontact_peers:flags.0?true keep_archived_unmuted:flags.1?true keep_archived_folders:flags.2?true hide_read_marks:flags.3?true new_noncontact_peers_require_premium:flags.4?true display_gifts_button:flags.7?true noncontact_peers_paid_stars:flags.5?long disallowed_gifts:flags.6?DisallowedGiftsSettings = GlobalPrivacySettings;\nhelp.countryCode#4203c5ef flags:# country_code:string prefixes:flags.0?Vector<string> patterns:flags.1?Vector<string> = help.CountryCode;\nhelp.country#c3878e23 flags:# hidden:flags.0?true iso2:string default_name:string name:flags.1?string country_codes:Vector<help.CountryCode> = help.Country;\nhelp.countriesListNotModified#93cc1f32 = help.CountriesList;\nhelp.countriesList#87d0759e countries:Vector<help.Country> hash:int = help.CountriesList;\nmessageViews#455b853d flags:# views:flags.0?int forwards:flags.1?int replies:flags.2?MessageReplies = MessageViews;\nmessages.messageViews#b6c4f543 views:Vector<MessageViews> chats:Vector<Chat> users:Vector<User> = messages.MessageViews;\nmessages.discussionMessage#a6341782 flags:# messages:Vector<Message> max_id:flags.0?int read_inbox_max_id:flags.1?int read_outbox_max_id:flags.2?int unread_count:int chats:Vector<Chat> users:Vector<User> = messages.DiscussionMessage;\nmessageReplyHeader#6917560b flags:# reply_to_scheduled:flags.2?true forum_topic:flags.3?true quote:flags.9?true reply_to_msg_id:flags.4?int reply_to_peer_id:flags.0?Peer reply_from:flags.5?MessageFwdHeader reply_media:flags.8?MessageMedia reply_to_top_id:flags.1?int quote_text:flags.6?string quote_entities:flags.7?Vector<MessageEntity> quote_offset:flags.10?int todo_item_id:flags.11?int = MessageReplyHeader;\nmessageReplyStoryHeader#e5af939 peer:Peer story_id:int = MessageReplyHeader;\nmessageReplies#83d60fc2 flags:# comments:flags.0?true replies:int replies_pts:int recent_repliers:flags.1?Vector<Peer> channel_id:flags.0?long max_id:flags.2?int read_max_id:flags.3?int = MessageReplies;\npeerBlocked#e8fd8014 peer_id:Peer date:int = PeerBlocked;\nstats.messageStats#7fe91c14 views_graph:StatsGraph reactions_by_emotion_graph:StatsGraph = stats.MessageStats;\ngroupCallDiscarded#7780bcb4 id:long access_hash:long duration:int = GroupCall;\ngroupCall#efb2b617 flags:# join_muted:flags.1?true can_change_join_muted:flags.2?true join_date_asc:flags.6?true schedule_start_subscribed:flags.8?true can_start_video:flags.9?true record_video_active:flags.11?true rtmp_stream:flags.12?true listeners_hidden:flags.13?true conference:flags.14?true creator:flags.15?true messages_enabled:flags.17?true can_change_messages_enabled:flags.18?true min:flags.19?true id:long access_hash:long participants_count:int title:flags.3?string stream_dc_id:flags.4?int record_start_date:flags.5?int schedule_date:flags.7?int unmuted_video_count:flags.10?int unmuted_video_limit:int version:int invite_link:flags.16?string send_paid_messages_stars:flags.20?long default_send_as:flags.21?Peer = GroupCall;\ninputGroupCall#d8aa840f id:long access_hash:long = InputGroupCall;\ninputGroupCallSlug#fe06823f slug:string = InputGroupCall;\ninputGroupCallInviteMessage#8c10603f msg_id:int = InputGroupCall;\ngroupCallParticipant#2a3dc7ac flags:# muted:flags.0?true left:flags.1?true can_self_unmute:flags.2?true just_joined:flags.4?true versioned:flags.5?true min:flags.8?true muted_by_you:flags.9?true volume_by_admin:flags.10?true self:flags.12?true video_joined:flags.15?true peer:Peer date:int active_date:flags.3?int source:int volume:flags.7?int about:flags.11?string raise_hand_rating:flags.13?long video:flags.6?GroupCallParticipantVideo presentation:flags.14?GroupCallParticipantVideo paid_stars_total:flags.16?long = GroupCallParticipant;\nphone.groupCall#9e727aad call:GroupCall participants:Vector<GroupCallParticipant> participants_next_offset:string chats:Vector<Chat> users:Vector<User> = phone.GroupCall;\nphone.groupParticipants#f47751b6 count:int participants:Vector<GroupCallParticipant> next_offset:string chats:Vector<Chat> users:Vector<User> version:int = phone.GroupParticipants;\ninlineQueryPeerTypeSameBotPM#3081ed9d = InlineQueryPeerType;\ninlineQueryPeerTypePM#833c0fac = InlineQueryPeerType;\ninlineQueryPeerTypeChat#d766c50a = InlineQueryPeerType;\ninlineQueryPeerTypeMegagroup#5ec4be43 = InlineQueryPeerType;\ninlineQueryPeerTypeBroadcast#6334ee9a = InlineQueryPeerType;\ninlineQueryPeerTypeBotPM#e3b2d0c = InlineQueryPeerType;\nmessages.historyImport#1662af0b id:long = messages.HistoryImport;\nmessages.historyImportParsed#5e0fb7b9 flags:# pm:flags.0?true group:flags.1?true title:flags.2?string = messages.HistoryImportParsed;\nmessages.affectedFoundMessages#ef8d3e6c pts:int pts_count:int offset:int messages:Vector<int> = messages.AffectedFoundMessages;\nchatInviteImporter#8c5adfd9 flags:# requested:flags.0?true via_chatlist:flags.3?true user_id:long date:int about:flags.2?string approved_by:flags.1?long = ChatInviteImporter;\nmessages.exportedChatInvites#bdc62dcc count:int invites:Vector<ExportedChatInvite> users:Vector<User> = messages.ExportedChatInvites;\nmessages.exportedChatInvite#1871be50 invite:ExportedChatInvite users:Vector<User> = messages.ExportedChatInvite;\nmessages.exportedChatInviteReplaced#222600ef invite:ExportedChatInvite new_invite:ExportedChatInvite users:Vector<User> = messages.ExportedChatInvite;\nmessages.chatInviteImporters#81b6b00a count:int importers:Vector<ChatInviteImporter> users:Vector<User> = messages.ChatInviteImporters;\nchatAdminWithInvites#f2ecef23 admin_id:long invites_count:int revoked_invites_count:int = ChatAdminWithInvites;\nmessages.chatAdminsWithInvites#b69b72d7 admins:Vector<ChatAdminWithInvites> users:Vector<User> = messages.ChatAdminsWithInvites;\nmessages.checkedHistoryImportPeer#a24de717 confirm_text:string = messages.CheckedHistoryImportPeer;\nphone.joinAsPeers#afe5623f peers:Vector<Peer> chats:Vector<Chat> users:Vector<User> = phone.JoinAsPeers;\nphone.exportedGroupCallInvite#204bd158 link:string = phone.ExportedGroupCallInvite;\ngroupCallParticipantVideoSourceGroup#dcb118b7 semantics:string sources:Vector<int> = GroupCallParticipantVideoSourceGroup;\ngroupCallParticipantVideo#67753ac8 flags:# paused:flags.0?true endpoint:string source_groups:Vector<GroupCallParticipantVideoSourceGroup> audio_source:flags.1?int = GroupCallParticipantVideo;\nstickers.suggestedShortName#85fea03f short_name:string = stickers.SuggestedShortName;\nbotCommandScopeDefault#2f6cb2ab = BotCommandScope;\nbotCommandScopeUsers#3c4f04d8 = BotCommandScope;\nbotCommandScopeChats#6fe1a881 = BotCommandScope;\nbotCommandScopeChatAdmins#b9aa606a = BotCommandScope;\nbotCommandScopePeer#db9d897d peer:InputPeer = BotCommandScope;\nbotCommandScopePeerAdmins#3fd863d1 peer:InputPeer = BotCommandScope;\nbotCommandScopePeerUser#a1321f3 peer:InputPeer user_id:InputUser = BotCommandScope;\naccount.resetPasswordFailedWait#e3779861 retry_date:int = account.ResetPasswordResult;\naccount.resetPasswordRequestedWait#e9effc7d until_date:int = account.ResetPasswordResult;\naccount.resetPasswordOk#e926d63e = account.ResetPasswordResult;\nchatTheme#c3dffc04 emoticon:string = ChatTheme;\nchatThemeUniqueGift#3458f9c8 gift:StarGift theme_settings:Vector<ThemeSettings> = ChatTheme;\naccount.chatThemesNotModified#e011e1c4 = account.ChatThemes;\naccount.chatThemes#be098173 flags:# hash:long themes:Vector<ChatTheme> chats:Vector<Chat> users:Vector<User> next_offset:flags.0?string = account.ChatThemes;\nsponsoredMessage#7dbf8673 flags:# recommended:flags.5?true can_report:flags.12?true random_id:bytes url:string title:string message:string entities:flags.1?Vector<MessageEntity> photo:flags.6?Photo media:flags.14?MessageMedia color:flags.13?PeerColor button_text:string sponsor_info:flags.7?string additional_info:flags.8?string min_display_duration:flags.15?int max_display_duration:flags.15?int = SponsoredMessage;\nmessages.sponsoredMessages#ffda656d flags:# posts_between:flags.0?int start_delay:flags.1?int between_delay:flags.2?int messages:Vector<SponsoredMessage> chats:Vector<Chat> users:Vector<User> = messages.SponsoredMessages;\nmessages.sponsoredMessagesEmpty#1839490f = messages.SponsoredMessages;\nsearchResultsCalendarPeriod#c9b0539f date:int min_msg_id:int max_msg_id:int count:int = SearchResultsCalendarPeriod;\nmessages.searchResultsCalendar#147ee23c flags:# inexact:flags.0?true count:int min_date:int min_msg_id:int offset_id_offset:flags.1?int periods:Vector<SearchResultsCalendarPeriod> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.SearchResultsCalendar;\nsearchResultPosition#7f648b67 msg_id:int date:int offset:int = SearchResultsPosition;\nmessages.searchResultsPositions#53b22baf count:int positions:Vector<SearchResultsPosition> = messages.SearchResultsPositions;\nchannels.sendAsPeers#f496b0c6 peers:Vector<SendAsPeer> chats:Vector<Chat> users:Vector<User> = channels.SendAsPeers;\nusers.userFull#3b6d152e full_user:UserFull chats:Vector<Chat> users:Vector<User> = users.UserFull;\nmessages.peerSettings#6880b94d settings:PeerSettings chats:Vector<Chat> users:Vector<User> = messages.PeerSettings;\nauth.loggedOut#c3a2835f flags:# future_auth_token:flags.0?bytes = auth.LoggedOut;\nreactionCount#a3d1cb80 flags:# chosen_order:flags.0?int reaction:Reaction count:int = ReactionCount;\nmessageReactions#a339f0b flags:# min:flags.0?true can_see_list:flags.2?true reactions_as_tags:flags.3?true results:Vector<ReactionCount> recent_reactions:flags.1?Vector<MessagePeerReaction> top_reactors:flags.4?Vector<MessageReactor> = MessageReactions;\nmessages.messageReactionsList#31bd492d flags:# count:int reactions:Vector<MessagePeerReaction> chats:Vector<Chat> users:Vector<User> next_offset:flags.0?string = messages.MessageReactionsList;\navailableReaction#c077ec01 flags:# inactive:flags.0?true premium:flags.2?true reaction:string title:string static_icon:Document appear_animation:Document select_animation:Document activate_animation:Document effect_animation:Document around_animation:flags.1?Document center_icon:flags.1?Document = AvailableReaction;\nmessages.availableReactionsNotModified#9f071957 = messages.AvailableReactions;\nmessages.availableReactions#768e3aad hash:int reactions:Vector<AvailableReaction> = messages.AvailableReactions;\nmessagePeerReaction#8c79b63c flags:# big:flags.0?true unread:flags.1?true my:flags.2?true peer_id:Peer date:int reaction:Reaction = MessagePeerReaction;\ngroupCallStreamChannel#80eb48af channel:int scale:int last_timestamp_ms:long = GroupCallStreamChannel;\nphone.groupCallStreamChannels#d0e482b2 channels:Vector<GroupCallStreamChannel> = phone.GroupCallStreamChannels;\nphone.groupCallStreamRtmpUrl#2dbf3432 url:string key:string = phone.GroupCallStreamRtmpUrl;\nattachMenuBotIconColor#4576f3f0 name:string color:int = AttachMenuBotIconColor;\nattachMenuBotIcon#b2a7386b flags:# name:string icon:Document colors:flags.0?Vector<AttachMenuBotIconColor> = AttachMenuBotIcon;\nattachMenuBot#d90d8dfe flags:# inactive:flags.0?true has_settings:flags.1?true request_write_access:flags.2?true show_in_attach_menu:flags.3?true show_in_side_menu:flags.4?true side_menu_disclaimer_needed:flags.5?true bot_id:long short_name:string peer_types:flags.3?Vector<AttachMenuPeerType> icons:Vector<AttachMenuBotIcon> = AttachMenuBot;\nattachMenuBotsNotModified#f1d88a5c = AttachMenuBots;\nattachMenuBots#3c4301c0 hash:long bots:Vector<AttachMenuBot> users:Vector<User> = AttachMenuBots;\nattachMenuBotsBot#93bf667f bot:AttachMenuBot users:Vector<User> = AttachMenuBotsBot;\nwebViewResultUrl#4d22ff98 flags:# fullsize:flags.1?true fullscreen:flags.2?true query_id:flags.0?long url:string = WebViewResult;\nwebViewMessageSent#c94511c flags:# msg_id:flags.0?InputBotInlineMessageID = WebViewMessageSent;\nbotMenuButtonDefault#7533a588 = BotMenuButton;\nbotMenuButtonCommands#4258c205 = BotMenuButton;\nbotMenuButton#c7b57ce6 text:string url:string = BotMenuButton;\naccount.savedRingtonesNotModified#fbf6e8b1 = account.SavedRingtones;\naccount.savedRingtones#c1e92cc5 hash:long ringtones:Vector<Document> = account.SavedRingtones;\nnotificationSoundDefault#97e8bebe = NotificationSound;\nnotificationSoundNone#6f0c34df = NotificationSound;\nnotificationSoundLocal#830b9ae4 title:string data:string = NotificationSound;\nnotificationSoundRingtone#ff6c8049 id:long = NotificationSound;\naccount.savedRingtone#b7263f6d = account.SavedRingtone;\naccount.savedRingtoneConverted#1f307eb7 document:Document = account.SavedRingtone;\nattachMenuPeerTypeSameBotPM#7d6be90e = AttachMenuPeerType;\nattachMenuPeerTypeBotPM#c32bfa1a = AttachMenuPeerType;\nattachMenuPeerTypePM#f146d31f = AttachMenuPeerType;\nattachMenuPeerTypeChat#509113f = AttachMenuPeerType;\nattachMenuPeerTypeBroadcast#7bfbdefc = AttachMenuPeerType;\ninputInvoiceMessage#c5b56859 peer:InputPeer msg_id:int = InputInvoice;\ninputInvoiceSlug#c326caef slug:string = InputInvoice;\ninputInvoicePremiumGiftCode#98986c0d purpose:InputStorePaymentPurpose option:PremiumGiftCodeOption = InputInvoice;\ninputInvoiceStars#65f00ce3 purpose:InputStorePaymentPurpose = InputInvoice;\ninputInvoiceChatInviteSubscription#34e793f1 hash:string = InputInvoice;\ninputInvoiceStarGift#e8625e92 flags:# hide_name:flags.0?true include_upgrade:flags.2?true peer:InputPeer gift_id:long message:flags.1?TextWithEntities = InputInvoice;\ninputInvoiceStarGiftUpgrade#4d818d5d flags:# keep_original_details:flags.0?true stargift:InputSavedStarGift = InputInvoice;\ninputInvoiceStarGiftTransfer#4a5f5bd9 stargift:InputSavedStarGift to_id:InputPeer = InputInvoice;\ninputInvoicePremiumGiftStars#dabab2ef flags:# user_id:InputUser months:int message:flags.0?TextWithEntities = InputInvoice;\ninputInvoiceBusinessBotTransferStars#f4997e42 bot:InputUser stars:long = InputInvoice;\ninputInvoiceStarGiftResale#c39f5324 flags:# ton:flags.0?true slug:string to_id:InputPeer = InputInvoice;\ninputInvoiceStarGiftPrepaidUpgrade#9a0b48b8 peer:InputPeer hash:string = InputInvoice;\ninputInvoicePremiumAuthCode#3e77f614 purpose:InputStorePaymentPurpose = InputInvoice;\ninputInvoiceStarGiftDropOriginalDetails#923d8d1 stargift:InputSavedStarGift = InputInvoice;\ninputInvoiceStarGiftAuctionBid#1ecafa10 flags:# hide_name:flags.0?true update_bid:flags.2?true peer:flags.3?InputPeer gift_id:long bid_amount:long message:flags.1?TextWithEntities = InputInvoice;\npayments.exportedInvoice#aed0cbd9 url:string = payments.ExportedInvoice;\nmessages.transcribedAudio#cfb9d957 flags:# pending:flags.0?true transcription_id:long text:string trial_remains_num:flags.1?int trial_remains_until_date:flags.1?int = messages.TranscribedAudio;\nhelp.premiumPromo#5334759c status_text:string status_entities:Vector<MessageEntity> video_sections:Vector<string> videos:Vector<Document> period_options:Vector<PremiumSubscriptionOption> users:Vector<User> = help.PremiumPromo;\ninputStorePaymentPremiumSubscription#a6751e66 flags:# restore:flags.0?true upgrade:flags.1?true = InputStorePaymentPurpose;\ninputStorePaymentGiftPremium#616f7fe8 user_id:InputUser currency:string amount:long = InputStorePaymentPurpose;\ninputStorePaymentPremiumGiftCode#fb790393 flags:# users:Vector<InputUser> boost_peer:flags.0?InputPeer currency:string amount:long message:flags.1?TextWithEntities = InputStorePaymentPurpose;\ninputStorePaymentPremiumGiveaway#160544ca flags:# only_new_subscribers:flags.0?true winners_are_visible:flags.3?true boost_peer:InputPeer additional_peers:flags.1?Vector<InputPeer> countries_iso2:flags.2?Vector<string> prize_description:flags.4?string random_id:long until_date:int currency:string amount:long = InputStorePaymentPurpose;\ninputStorePaymentStarsTopup#f9a2a6cb flags:# stars:long currency:string amount:long spend_purpose_peer:flags.0?InputPeer = InputStorePaymentPurpose;\ninputStorePaymentStarsGift#1d741ef7 user_id:InputUser stars:long currency:string amount:long = InputStorePaymentPurpose;\ninputStorePaymentStarsGiveaway#751f08fa flags:# only_new_subscribers:flags.0?true winners_are_visible:flags.3?true stars:long boost_peer:InputPeer additional_peers:flags.1?Vector<InputPeer> countries_iso2:flags.2?Vector<string> prize_description:flags.4?string random_id:long until_date:int currency:string amount:long users:int = InputStorePaymentPurpose;\ninputStorePaymentAuthCode#9bb2636d flags:# restore:flags.0?true phone_number:string phone_code_hash:string currency:string amount:long = InputStorePaymentPurpose;\npaymentFormMethod#88f8f21b url:string title:string = PaymentFormMethod;\nemojiStatusEmpty#2de11aae = EmojiStatus;\nemojiStatus#e7ff068a flags:# document_id:long until:flags.0?int = EmojiStatus;\nemojiStatusCollectible#7184603b flags:# collectible_id:long document_id:long title:string slug:string pattern_document_id:long center_color:int edge_color:int pattern_color:int text_color:int until:flags.0?int = EmojiStatus;\ninputEmojiStatusCollectible#7141dbf flags:# collectible_id:long until:flags.0?int = EmojiStatus;\naccount.emojiStatusesNotModified#d08ce645 = account.EmojiStatuses;\naccount.emojiStatuses#90c467d1 hash:long statuses:Vector<EmojiStatus> = account.EmojiStatuses;\nreactionEmpty#79f5d419 = Reaction;\nreactionEmoji#1b2286b8 emoticon:string = Reaction;\nreactionCustomEmoji#8935fc73 document_id:long = Reaction;\nreactionPaid#523da4eb = Reaction;\nchatReactionsNone#eafc32bc = ChatReactions;\nchatReactionsAll#52928bca flags:# allow_custom:flags.0?true = ChatReactions;\nchatReactionsSome#661d4037 reactions:Vector<Reaction> = ChatReactions;\nmessages.reactionsNotModified#b06fdbdf = messages.Reactions;\nmessages.reactions#eafdf716 hash:long reactions:Vector<Reaction> = messages.Reactions;\nemailVerifyPurposeLoginSetup#4345be73 phone_number:string phone_code_hash:string = EmailVerifyPurpose;\nemailVerifyPurposeLoginChange#527d22eb = EmailVerifyPurpose;\nemailVerifyPurposePassport#bbf51685 = EmailVerifyPurpose;\nemailVerificationCode#922e55a9 code:string = EmailVerification;\nemailVerificationGoogle#db909ec2 token:string = EmailVerification;\nemailVerificationApple#96d074fd token:string = EmailVerification;\naccount.emailVerified#2b96cd1b email:string = account.EmailVerified;\naccount.emailVerifiedLogin#e1bb0d61 email:string sent_code:auth.SentCode = account.EmailVerified;\npremiumSubscriptionOption#5f2d1df2 flags:# current:flags.1?true can_purchase_upgrade:flags.2?true transaction:flags.3?string months:int currency:string amount:long bot_url:string store_product:flags.0?string = PremiumSubscriptionOption;\nsendAsPeer#b81c7034 flags:# premium_required:flags.0?true peer:Peer = SendAsPeer;\nmessageExtendedMediaPreview#ad628cc8 flags:# w:flags.0?int h:flags.0?int thumb:flags.1?PhotoSize video_duration:flags.2?int = MessageExtendedMedia;\nmessageExtendedMedia#ee479c64 media:MessageMedia = MessageExtendedMedia;\nstickerKeyword#fcfeb29c document_id:long keyword:Vector<string> = StickerKeyword;\nusername#b4073647 flags:# editable:flags.0?true active:flags.1?true username:string = Username;\nforumTopicDeleted#23f109b id:int = ForumTopic;\nforumTopic#cdff0eca flags:# my:flags.1?true closed:flags.2?true pinned:flags.3?true short:flags.5?true hidden:flags.6?true title_missing:flags.7?true id:int date:int peer:Peer title:string icon_color:int icon_emoji_id:flags.0?long top_message:int read_inbox_max_id:int read_outbox_max_id:int unread_count:int unread_mentions_count:int unread_reactions_count:int from_id:Peer notify_settings:PeerNotifySettings draft:flags.4?DraftMessage = ForumTopic;\nmessages.forumTopics#367617d3 flags:# order_by_create_date:flags.0?true count:int topics:Vector<ForumTopic> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> pts:int = messages.ForumTopics;\ndefaultHistoryTTL#43b46b20 period:int = DefaultHistoryTTL;\nexportedContactToken#41bf109b url:string expires:int = ExportedContactToken;\nrequestPeerTypeUser#5f3b8a00 flags:# bot:flags.0?Bool premium:flags.1?Bool = RequestPeerType;\nrequestPeerTypeChat#c9f06e1b flags:# creator:flags.0?true bot_participant:flags.5?true has_username:flags.3?Bool forum:flags.4?Bool user_admin_rights:flags.1?ChatAdminRights bot_admin_rights:flags.2?ChatAdminRights = RequestPeerType;\nrequestPeerTypeBroadcast#339bef6c flags:# creator:flags.0?true has_username:flags.3?Bool user_admin_rights:flags.1?ChatAdminRights bot_admin_rights:flags.2?ChatAdminRights = RequestPeerType;\nemojiListNotModified#481eadfa = EmojiList;\nemojiList#7a1e11d1 hash:long document_id:Vector<long> = EmojiList;\nemojiGroup#7a9abda9 title:string icon_emoji_id:long emoticons:Vector<string> = EmojiGroup;\nemojiGroupGreeting#80d26cc7 title:string icon_emoji_id:long emoticons:Vector<string> = EmojiGroup;\nemojiGroupPremium#93bcf34 title:string icon_emoji_id:long = EmojiGroup;\nmessages.emojiGroupsNotModified#6fb4ad87 = messages.EmojiGroups;\nmessages.emojiGroups#881fb94b hash:int groups:Vector<EmojiGroup> = messages.EmojiGroups;\ntextWithEntities#751f3146 text:string entities:Vector<MessageEntity> = TextWithEntities;\nmessages.translateResult#33db32f8 result:Vector<TextWithEntities> = messages.TranslatedText;\nautoSaveSettings#c84834ce flags:# photos:flags.0?true videos:flags.1?true video_max_size:flags.2?long = AutoSaveSettings;\nautoSaveException#81602d47 peer:Peer settings:AutoSaveSettings = AutoSaveException;\naccount.autoSaveSettings#4c3e069d users_settings:AutoSaveSettings chats_settings:AutoSaveSettings broadcasts_settings:AutoSaveSettings exceptions:Vector<AutoSaveException> chats:Vector<Chat> users:Vector<User> = account.AutoSaveSettings;\nhelp.appConfigNotModified#7cde641d = help.AppConfig;\nhelp.appConfig#dd18782e hash:int config:JSONValue = help.AppConfig;\ninputBotAppID#a920bd7a id:long access_hash:long = InputBotApp;\ninputBotAppShortName#908c0407 bot_id:InputUser short_name:string = InputBotApp;\nbotAppNotModified#5da674b7 = BotApp;\nbotApp#95fcd1d6 flags:# id:long access_hash:long short_name:string title:string description:string photo:Photo document:flags.0?Document hash:long = BotApp;\nmessages.botApp#eb50adf5 flags:# inactive:flags.0?true request_write_access:flags.1?true has_settings:flags.2?true app:BotApp = messages.BotApp;\ninlineBotWebView#b57295d5 text:string url:string = InlineBotWebView;\nreadParticipantDate#4a4ff172 user_id:long date:int = ReadParticipantDate;\ninputChatlistDialogFilter#f3e0da33 filter_id:int = InputChatlist;\nexportedChatlistInvite#c5181ac flags:# title:string url:string peers:Vector<Peer> = ExportedChatlistInvite;\nchatlists.exportedChatlistInvite#10e6e3a6 filter:DialogFilter invite:ExportedChatlistInvite = chatlists.ExportedChatlistInvite;\nchatlists.exportedInvites#10ab6dc7 invites:Vector<ExportedChatlistInvite> chats:Vector<Chat> users:Vector<User> = chatlists.ExportedInvites;\nchatlists.chatlistInviteAlready#fa87f659 filter_id:int missing_peers:Vector<Peer> already_peers:Vector<Peer> chats:Vector<Chat> users:Vector<User> = chatlists.ChatlistInvite;\nchatlists.chatlistInvite#f10ece2f flags:# title_noanimate:flags.1?true title:TextWithEntities emoticon:flags.0?string peers:Vector<Peer> chats:Vector<Chat> users:Vector<User> = chatlists.ChatlistInvite;\nchatlists.chatlistUpdates#93bd878d missing_peers:Vector<Peer> chats:Vector<Chat> users:Vector<User> = chatlists.ChatlistUpdates;\nbots.botInfo#e8a775b0 name:string about:string description:string = bots.BotInfo;\nmessagePeerVote#b6cc2d5c peer:Peer option:bytes date:int = MessagePeerVote;\nmessagePeerVoteInputOption#74cda504 peer:Peer date:int = MessagePeerVote;\nmessagePeerVoteMultiple#4628f6e6 peer:Peer options:Vector<bytes> date:int = MessagePeerVote;\nstoryViews#8d595cd6 flags:# has_viewers:flags.1?true views_count:int forwards_count:flags.2?int reactions:flags.3?Vector<ReactionCount> reactions_count:flags.4?int recent_viewers:flags.0?Vector<long> = StoryViews;\nstoryItemDeleted#51e6ee4f id:int = StoryItem;\nstoryItemSkipped#ffadc913 flags:# close_friends:flags.8?true live:flags.9?true id:int date:int expire_date:int = StoryItem;\nstoryItem#edf164f1 flags:# pinned:flags.5?true public:flags.7?true close_friends:flags.8?true min:flags.9?true noforwards:flags.10?true edited:flags.11?true contacts:flags.12?true selected_contacts:flags.13?true out:flags.16?true id:int date:int from_id:flags.18?Peer fwd_from:flags.17?StoryFwdHeader expire_date:int caption:flags.0?string entities:flags.1?Vector<MessageEntity> media:MessageMedia media_areas:flags.14?Vector<MediaArea> privacy:flags.2?Vector<PrivacyRule> views:flags.3?StoryViews sent_reaction:flags.15?Reaction albums:flags.19?Vector<int> = StoryItem;\nstories.allStoriesNotModified#1158fe3e flags:# state:string stealth_mode:StoriesStealthMode = stories.AllStories;\nstories.allStories#6efc5e81 flags:# has_more:flags.0?true count:int state:string peer_stories:Vector<PeerStories> chats:Vector<Chat> users:Vector<User> stealth_mode:StoriesStealthMode = stories.AllStories;\nstories.stories#63c3dd0a flags:# count:int stories:Vector<StoryItem> pinned_to_top:flags.0?Vector<int> chats:Vector<Chat> users:Vector<User> = stories.Stories;\nstoryView#b0bdeac5 flags:# blocked:flags.0?true blocked_my_stories_from:flags.1?true user_id:long date:int reaction:flags.2?Reaction = StoryView;\nstoryViewPublicForward#9083670b flags:# blocked:flags.0?true blocked_my_stories_from:flags.1?true message:Message = StoryView;\nstoryViewPublicRepost#bd74cf49 flags:# blocked:flags.0?true blocked_my_stories_from:flags.1?true peer_id:Peer story:StoryItem = StoryView;\nstories.storyViewsList#59d78fc5 flags:# count:int views_count:int forwards_count:int reactions_count:int views:Vector<StoryView> chats:Vector<Chat> users:Vector<User> next_offset:flags.0?string = stories.StoryViewsList;\nstories.storyViews#de9eed1d views:Vector<StoryViews> users:Vector<User> = stories.StoryViews;\ninputReplyToMessage#869fbe10 flags:# reply_to_msg_id:int top_msg_id:flags.0?int reply_to_peer_id:flags.1?InputPeer quote_text:flags.2?string quote_entities:flags.3?Vector<MessageEntity> quote_offset:flags.4?int monoforum_peer_id:flags.5?InputPeer todo_item_id:flags.6?int = InputReplyTo;\ninputReplyToStory#5881323a peer:InputPeer story_id:int = InputReplyTo;\ninputReplyToMonoForum#69d66c45 monoforum_peer_id:InputPeer = InputReplyTo;\nexportedStoryLink#3fc9053b link:string = ExportedStoryLink;\nstoriesStealthMode#712e27fd flags:# active_until_date:flags.0?int cooldown_until_date:flags.1?int = StoriesStealthMode;\nmediaAreaCoordinates#cfc9e002 flags:# x:double y:double w:double h:double rotation:double radius:flags.0?double = MediaAreaCoordinates;\nmediaAreaVenue#be82db9c coordinates:MediaAreaCoordinates geo:GeoPoint title:string address:string provider:string venue_id:string venue_type:string = MediaArea;\ninputMediaAreaVenue#b282217f coordinates:MediaAreaCoordinates query_id:long result_id:string = MediaArea;\nmediaAreaGeoPoint#cad5452d flags:# coordinates:MediaAreaCoordinates geo:GeoPoint address:flags.0?GeoPointAddress = MediaArea;\nmediaAreaSuggestedReaction#14455871 flags:# dark:flags.0?true flipped:flags.1?true coordinates:MediaAreaCoordinates reaction:Reaction = MediaArea;\nmediaAreaChannelPost#770416af coordinates:MediaAreaCoordinates channel_id:long msg_id:int = MediaArea;\ninputMediaAreaChannelPost#2271f2bf coordinates:MediaAreaCoordinates channel:InputChannel msg_id:int = MediaArea;\nmediaAreaUrl#37381085 coordinates:MediaAreaCoordinates url:string = MediaArea;\nmediaAreaWeather#49a6549c coordinates:MediaAreaCoordinates emoji:string temperature_c:double color:int = MediaArea;\nmediaAreaStarGift#5787686d coordinates:MediaAreaCoordinates slug:string = MediaArea;\npeerStories#9a35e999 flags:# peer:Peer max_read_id:flags.0?int stories:Vector<StoryItem> = PeerStories;\nstories.peerStories#cae68768 stories:PeerStories chats:Vector<Chat> users:Vector<User> = stories.PeerStories;\nmessages.webPage#fd5e12bd webpage:WebPage chats:Vector<Chat> users:Vector<User> = messages.WebPage;\npremiumGiftCodeOption#257e962b flags:# users:int months:int store_product:flags.0?string store_quantity:flags.1?int currency:string amount:long = PremiumGiftCodeOption;\npayments.checkedGiftCode#eb983f8f flags:# via_giveaway:flags.2?true from_id:flags.4?Peer giveaway_msg_id:flags.3?int to_id:flags.0?long date:int days:int used_date:flags.1?int chats:Vector<Chat> users:Vector<User> = payments.CheckedGiftCode;\npayments.giveawayInfo#4367daa0 flags:# participating:flags.0?true preparing_results:flags.3?true start_date:int joined_too_early_date:flags.1?int admin_disallowed_chat_id:flags.2?long disallowed_country:flags.4?string = payments.GiveawayInfo;\npayments.giveawayInfoResults#e175e66f flags:# winner:flags.0?true refunded:flags.1?true start_date:int gift_code_slug:flags.3?string stars_prize:flags.4?long finish_date:int winners_count:int activated_count:flags.2?int = payments.GiveawayInfo;\nprepaidGiveaway#b2539d54 id:long months:int quantity:int date:int = PrepaidGiveaway;\nprepaidStarsGiveaway#9a9d77e0 id:long stars:long quantity:int boosts:int date:int = PrepaidGiveaway;\nboost#4b3e14d6 flags:# gift:flags.1?true giveaway:flags.2?true unclaimed:flags.3?true id:string user_id:flags.0?long giveaway_msg_id:flags.2?int date:int expires:int used_gift_slug:flags.4?string multiplier:flags.5?int stars:flags.6?long = Boost;\npremium.boostsList#86f8613c flags:# count:int boosts:Vector<Boost> next_offset:flags.0?string users:Vector<User> = premium.BoostsList;\nmyBoost#c448415c flags:# slot:int peer:flags.0?Peer date:int expires:int cooldown_until_date:flags.1?int = MyBoost;\npremium.myBoosts#9ae228e2 my_boosts:Vector<MyBoost> chats:Vector<Chat> users:Vector<User> = premium.MyBoosts;\npremium.boostsStatus#4959427a flags:# my_boost:flags.2?true level:int current_level_boosts:int boosts:int gift_boosts:flags.4?int next_level_boosts:flags.0?int premium_audience:flags.1?StatsPercentValue boost_url:string prepaid_giveaways:flags.3?Vector<PrepaidGiveaway> my_boost_slots:flags.2?Vector<int> = premium.BoostsStatus;\nstoryFwdHeader#b826e150 flags:# modified:flags.3?true from:flags.0?Peer from_name:flags.1?string story_id:flags.2?int = StoryFwdHeader;\npostInteractionCountersMessage#e7058e7f msg_id:int views:int forwards:int reactions:int = PostInteractionCounters;\npostInteractionCountersStory#8a480e27 story_id:int views:int forwards:int reactions:int = PostInteractionCounters;\nstats.storyStats#50cd067c views_graph:StatsGraph reactions_by_emotion_graph:StatsGraph = stats.StoryStats;\npublicForwardMessage#1f2bf4a message:Message = PublicForward;\npublicForwardStory#edf3add0 peer:Peer story:StoryItem = PublicForward;\nstats.publicForwards#93037e20 flags:# count:int forwards:Vector<PublicForward> next_offset:flags.0?string chats:Vector<Chat> users:Vector<User> = stats.PublicForwards;\npeerColor#b54b5acf flags:# color:flags.0?int background_emoji_id:flags.1?long = PeerColor;\npeerColorCollectible#b9c0639a flags:# collectible_id:long gift_emoji_id:long background_emoji_id:long accent_color:int colors:Vector<int> dark_accent_color:flags.0?int dark_colors:flags.1?Vector<int> = PeerColor;\ninputPeerColorCollectible#b8ea86a9 collectible_id:long = PeerColor;\nhelp.peerColorSet#26219a58 colors:Vector<int> = help.PeerColorSet;\nhelp.peerColorProfileSet#767d61eb palette_colors:Vector<int> bg_colors:Vector<int> story_colors:Vector<int> = help.PeerColorSet;\nhelp.peerColorOption#adec6ebe flags:# hidden:flags.0?true color_id:int colors:flags.1?help.PeerColorSet dark_colors:flags.2?help.PeerColorSet channel_min_level:flags.3?int group_min_level:flags.4?int = help.PeerColorOption;\nhelp.peerColorsNotModified#2ba1f5ce = help.PeerColors;\nhelp.peerColors#f8ed08 hash:int colors:Vector<help.PeerColorOption> = help.PeerColors;\nstoryReaction#6090d6d5 peer_id:Peer date:int reaction:Reaction = StoryReaction;\nstoryReactionPublicForward#bbab2643 message:Message = StoryReaction;\nstoryReactionPublicRepost#cfcd0f13 peer_id:Peer story:StoryItem = StoryReaction;\nstories.storyReactionsList#aa5f789c flags:# count:int reactions:Vector<StoryReaction> chats:Vector<Chat> users:Vector<User> next_offset:flags.0?string = stories.StoryReactionsList;\nsavedDialog#bd87cb6c flags:# pinned:flags.2?true peer:Peer top_message:int = SavedDialog;\nmonoForumDialog#64407ea7 flags:# unread_mark:flags.3?true nopaid_messages_exception:flags.4?true peer:Peer top_message:int read_inbox_max_id:int read_outbox_max_id:int unread_count:int unread_reactions_count:int draft:flags.1?DraftMessage = SavedDialog;\nmessages.savedDialogs#f83ae221 dialogs:Vector<SavedDialog> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.SavedDialogs;\nmessages.savedDialogsSlice#44ba9dd9 count:int dialogs:Vector<SavedDialog> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.SavedDialogs;\nmessages.savedDialogsNotModified#c01f6fe8 count:int = messages.SavedDialogs;\nsavedReactionTag#cb6ff828 flags:# reaction:Reaction title:flags.0?string count:int = SavedReactionTag;\nmessages.savedReactionTagsNotModified#889b59ef = messages.SavedReactionTags;\nmessages.savedReactionTags#3259950a tags:Vector<SavedReactionTag> hash:long = messages.SavedReactionTags;\noutboxReadDate#3bb842ac date:int = OutboxReadDate;\nsmsjobs.eligibleToJoin#dc8b44cf terms_url:string monthly_sent_sms:int = smsjobs.EligibilityToJoin;\nsmsjobs.status#2aee9191 flags:# allow_international:flags.0?true recent_sent:int recent_since:int recent_remains:int total_sent:int total_since:int last_gift_slug:flags.1?string terms_url:string = smsjobs.Status;\nsmsJob#e6a1eeb8 job_id:string phone_number:string text:string = SmsJob;\nbusinessWeeklyOpen#120b1ab9 start_minute:int end_minute:int = BusinessWeeklyOpen;\nbusinessWorkHours#8c92b098 flags:# open_now:flags.0?true timezone_id:string weekly_open:Vector<BusinessWeeklyOpen> = BusinessWorkHours;\nbusinessLocation#ac5c1af7 flags:# geo_point:flags.0?GeoPoint address:string = BusinessLocation;\ninputBusinessRecipients#6f8b32aa flags:# existing_chats:flags.0?true new_chats:flags.1?true contacts:flags.2?true non_contacts:flags.3?true exclude_selected:flags.5?true users:flags.4?Vector<InputUser> = InputBusinessRecipients;\nbusinessRecipients#21108ff7 flags:# existing_chats:flags.0?true new_chats:flags.1?true contacts:flags.2?true non_contacts:flags.3?true exclude_selected:flags.5?true users:flags.4?Vector<long> = BusinessRecipients;\nbusinessAwayMessageScheduleAlways#c9b9e2b9 = BusinessAwayMessageSchedule;\nbusinessAwayMessageScheduleOutsideWorkHours#c3f2f501 = BusinessAwayMessageSchedule;\nbusinessAwayMessageScheduleCustom#cc4d9ecc start_date:int end_date:int = BusinessAwayMessageSchedule;\ninputBusinessGreetingMessage#194cb3b shortcut_id:int recipients:InputBusinessRecipients no_activity_days:int = InputBusinessGreetingMessage;\nbusinessGreetingMessage#e519abab shortcut_id:int recipients:BusinessRecipients no_activity_days:int = BusinessGreetingMessage;\ninputBusinessAwayMessage#832175e0 flags:# offline_only:flags.0?true shortcut_id:int schedule:BusinessAwayMessageSchedule recipients:InputBusinessRecipients = InputBusinessAwayMessage;\nbusinessAwayMessage#ef156a5c flags:# offline_only:flags.0?true shortcut_id:int schedule:BusinessAwayMessageSchedule recipients:BusinessRecipients = BusinessAwayMessage;\ntimezone#ff9289f5 id:string name:string utc_offset:int = Timezone;\nhelp.timezonesListNotModified#970708cc = help.TimezonesList;\nhelp.timezonesList#7b74ed71 timezones:Vector<Timezone> hash:int = help.TimezonesList;\nquickReply#697102b shortcut_id:int shortcut:string top_message:int count:int = QuickReply;\ninputQuickReplyShortcut#24596d41 shortcut:string = InputQuickReplyShortcut;\ninputQuickReplyShortcutId#1190cf1 shortcut_id:int = InputQuickReplyShortcut;\nmessages.quickReplies#c68d6695 quick_replies:Vector<QuickReply> messages:Vector<Message> chats:Vector<Chat> users:Vector<User> = messages.QuickReplies;\nmessages.quickRepliesNotModified#5f91eb5b = messages.QuickReplies;\nconnectedBot#cd64636c flags:# bot_id:long recipients:BusinessBotRecipients rights:BusinessBotRights = ConnectedBot;\naccount.connectedBots#17d7f87b connected_bots:Vector<ConnectedBot> users:Vector<User> = account.ConnectedBots;\nmessages.dialogFilters#2ad93719 flags:# tags_enabled:flags.0?true filters:Vector<DialogFilter> = messages.DialogFilters;\nbirthday#6c8e1e06 flags:# day:int month:int year:flags.0?int = Birthday;\nbotBusinessConnection#8f34b2f5 flags:# disabled:flags.1?true connection_id:string user_id:long dc_id:int date:int rights:flags.2?BusinessBotRights = BotBusinessConnection;\ninputBusinessIntro#9c469cd flags:# title:string description:string sticker:flags.0?InputDocument = InputBusinessIntro;\nbusinessIntro#5a0a066d flags:# title:string description:string sticker:flags.0?Document = BusinessIntro;\nmessages.myStickers#faff629d count:int sets:Vector<StickerSetCovered> = messages.MyStickers;\ninputCollectibleUsername#e39460a9 username:string = InputCollectible;\ninputCollectiblePhone#a2e214a4 phone:string = InputCollectible;\nfragment.collectibleInfo#6ebdff91 purchase_date:int currency:string amount:long crypto_currency:string crypto_amount:long url:string = fragment.CollectibleInfo;\ninputBusinessBotRecipients#c4e5921e flags:# existing_chats:flags.0?true new_chats:flags.1?true contacts:flags.2?true non_contacts:flags.3?true exclude_selected:flags.5?true users:flags.4?Vector<InputUser> exclude_users:flags.6?Vector<InputUser> = InputBusinessBotRecipients;\nbusinessBotRecipients#b88cf373 flags:# existing_chats:flags.0?true new_chats:flags.1?true contacts:flags.2?true non_contacts:flags.3?true exclude_selected:flags.5?true users:flags.4?Vector<long> exclude_users:flags.6?Vector<long> = BusinessBotRecipients;\ncontactBirthday#1d998733 contact_id:long birthday:Birthday = ContactBirthday;\ncontacts.contactBirthdays#114ff30d contacts:Vector<ContactBirthday> users:Vector<User> = contacts.ContactBirthdays;\nmissingInvitee#628c9224 flags:# premium_would_allow_invite:flags.0?true premium_required_for_pm:flags.1?true user_id:long = MissingInvitee;\nmessages.invitedUsers#7f5defa6 updates:Updates missing_invitees:Vector<MissingInvitee> = messages.InvitedUsers;\ninputBusinessChatLink#11679fa7 flags:# message:string entities:flags.0?Vector<MessageEntity> title:flags.1?string = InputBusinessChatLink;\nbusinessChatLink#b4ae666f flags:# link:string message:string entities:flags.0?Vector<MessageEntity> title:flags.1?string views:int = BusinessChatLink;\naccount.businessChatLinks#ec43a2d1 links:Vector<BusinessChatLink> chats:Vector<Chat> users:Vector<User> = account.BusinessChatLinks;\naccount.resolvedBusinessChatLinks#9a23af21 flags:# peer:Peer message:string entities:flags.0?Vector<MessageEntity> chats:Vector<Chat> users:Vector<User> = account.ResolvedBusinessChatLinks;\nrequestedPeerUser#d62ff46a flags:# user_id:long first_name:flags.0?string last_name:flags.0?string username:flags.1?string photo:flags.2?Photo = RequestedPeer;\nrequestedPeerChat#7307544f flags:# chat_id:long title:flags.0?string photo:flags.2?Photo = RequestedPeer;\nrequestedPeerChannel#8ba403e4 flags:# channel_id:long title:flags.0?string username:flags.1?string photo:flags.2?Photo = RequestedPeer;\nsponsoredMessageReportOption#430d3150 text:string option:bytes = SponsoredMessageReportOption;\nchannels.sponsoredMessageReportResultChooseOption#846f9e42 title:string options:Vector<SponsoredMessageReportOption> = channels.SponsoredMessageReportResult;\nchannels.sponsoredMessageReportResultAdsHidden#3e3bcf2f = channels.SponsoredMessageReportResult;\nchannels.sponsoredMessageReportResultReported#ad798849 = channels.SponsoredMessageReportResult;\nreactionNotificationsFromContacts#bac3a61a = ReactionNotificationsFrom;\nreactionNotificationsFromAll#4b9e22a0 = ReactionNotificationsFrom;\nreactionsNotifySettings#56e34970 flags:# messages_notify_from:flags.0?ReactionNotificationsFrom stories_notify_from:flags.1?ReactionNotificationsFrom sound:NotificationSound show_previews:Bool = ReactionsNotifySettings;\navailableEffect#93c3e27e flags:# premium_required:flags.2?true id:long emoticon:string static_icon_id:flags.0?long effect_sticker_id:long effect_animation_id:flags.1?long = AvailableEffect;\nmessages.availableEffectsNotModified#d1ed9a5b = messages.AvailableEffects;\nmessages.availableEffects#bddb616e hash:int effects:Vector<AvailableEffect> documents:Vector<Document> = messages.AvailableEffects;\nfactCheck#b89bfccf flags:# need_check:flags.0?true country:flags.1?string text:flags.1?TextWithEntities hash:long = FactCheck;\nstarsTransactionPeerUnsupported#95f2bfe4 = StarsTransactionPeer;\nstarsTransactionPeerAppStore#b457b375 = StarsTransactionPeer;\nstarsTransactionPeerPlayMarket#7b560a0b = StarsTransactionPeer;\nstarsTransactionPeerPremiumBot#250dbaf8 = StarsTransactionPeer;\nstarsTransactionPeerFragment#e92fd902 = StarsTransactionPeer;\nstarsTransactionPeer#d80da15d peer:Peer = StarsTransactionPeer;\nstarsTransactionPeerAds#60682812 = StarsTransactionPeer;\nstarsTransactionPeerAPI#f9677aad = StarsTransactionPeer;\nstarsTopupOption#bd915c0 flags:# extended:flags.1?true stars:long store_product:flags.0?string currency:string amount:long = StarsTopupOption;\nstarsTransaction#13659eb0 flags:# refund:flags.3?true pending:flags.4?true failed:flags.6?true gift:flags.10?true reaction:flags.11?true stargift_upgrade:flags.18?true business_transfer:flags.21?true stargift_resale:flags.22?true posts_search:flags.24?true stargift_prepaid_upgrade:flags.25?true stargift_drop_original_details:flags.26?true phonegroup_message:flags.27?true stargift_auction_bid:flags.28?true offer:flags.29?true id:string amount:StarsAmount date:int peer:StarsTransactionPeer title:flags.0?string description:flags.1?string photo:flags.2?WebDocument transaction_date:flags.5?int transaction_url:flags.5?string bot_payload:flags.7?bytes msg_id:flags.8?int extended_media:flags.9?Vector<MessageMedia> subscription_period:flags.12?int giveaway_post_id:flags.13?int stargift:flags.14?StarGift floodskip_number:flags.15?int starref_commission_permille:flags.16?int starref_peer:flags.17?Peer starref_amount:flags.17?StarsAmount paid_messages:flags.19?int premium_gift_months:flags.20?int ads_proceeds_from_date:flags.23?int ads_proceeds_to_date:flags.23?int = StarsTransaction;\npayments.starsStatus#6c9ce8ed flags:# balance:StarsAmount subscriptions:flags.1?Vector<StarsSubscription> subscriptions_next_offset:flags.2?string subscriptions_missing_balance:flags.4?long history:flags.3?Vector<StarsTransaction> next_offset:flags.0?string chats:Vector<Chat> users:Vector<User> = payments.StarsStatus;\nfoundStory#e87acbc0 peer:Peer story:StoryItem = FoundStory;\nstories.foundStories#e2de7737 flags:# count:int stories:Vector<FoundStory> next_offset:flags.0?string chats:Vector<Chat> users:Vector<User> = stories.FoundStories;\ngeoPointAddress#de4c5d93 flags:# country_iso2:string state:flags.0?string city:flags.1?string street:flags.2?string = GeoPointAddress;\nstarsRevenueStatus#febe5491 flags:# withdrawal_enabled:flags.0?true current_balance:StarsAmount available_balance:StarsAmount overall_revenue:StarsAmount next_withdrawal_at:flags.1?int = StarsRevenueStatus;\npayments.starsRevenueStats#6c207376 flags:# top_hours_graph:flags.0?StatsGraph revenue_graph:StatsGraph status:StarsRevenueStatus usd_rate:double = payments.StarsRevenueStats;\npayments.starsRevenueWithdrawalUrl#1dab80b7 url:string = payments.StarsRevenueWithdrawalUrl;\npayments.starsRevenueAdsAccountUrl#394e7f21 url:string = payments.StarsRevenueAdsAccountUrl;\ninputStarsTransaction#206ae6d1 flags:# refund:flags.0?true id:string = InputStarsTransaction;\nstarsGiftOption#5e0589f1 flags:# extended:flags.1?true stars:long store_product:flags.0?string currency:string amount:long = StarsGiftOption;\nbots.popularAppBots#1991b13b flags:# next_offset:flags.0?string users:Vector<User> = bots.PopularAppBots;\nbotPreviewMedia#23e91ba3 date:int media:MessageMedia = BotPreviewMedia;\nbots.previewInfo#ca71d64 media:Vector<BotPreviewMedia> lang_codes:Vector<string> = bots.PreviewInfo;\nstarsSubscriptionPricing#5416d58 period:int amount:long = StarsSubscriptionPricing;\nstarsSubscription#2e6eab1a flags:# canceled:flags.0?true can_refulfill:flags.1?true missing_balance:flags.2?true bot_canceled:flags.7?true id:string peer:Peer until_date:int pricing:StarsSubscriptionPricing chat_invite_hash:flags.3?string title:flags.4?string photo:flags.5?WebDocument invoice_slug:flags.6?string = StarsSubscription;\nmessageReactor#4ba3a95a flags:# top:flags.0?true my:flags.1?true anonymous:flags.2?true peer_id:flags.3?Peer count:int = MessageReactor;\nstarsGiveawayOption#94ce852a flags:# extended:flags.0?true default:flags.1?true stars:long yearly_boosts:int store_product:flags.2?string currency:string amount:long winners:Vector<StarsGiveawayWinnersOption> = StarsGiveawayOption;\nstarsGiveawayWinnersOption#54236209 flags:# default:flags.0?true users:int per_user_stars:long = StarsGiveawayWinnersOption;\nstarGift#313a9547 flags:# limited:flags.0?true sold_out:flags.1?true birthday:flags.2?true require_premium:flags.7?true limited_per_user:flags.8?true peer_color_available:flags.10?true auction:flags.11?true id:long sticker:Document stars:long availability_remains:flags.0?int availability_total:flags.0?int availability_resale:flags.4?long convert_stars:long first_sale_date:flags.1?int last_sale_date:flags.1?int upgrade_stars:flags.3?long resell_min_stars:flags.4?long title:flags.5?string released_by:flags.6?Peer per_user_total:flags.8?int per_user_remains:flags.8?int locked_until_date:flags.9?int auction_slug:flags.11?string gifts_per_round:flags.11?int auction_start_date:flags.11?int upgrade_variants:flags.12?int background:flags.13?StarGiftBackground = StarGift;\nstarGiftUnique#569d64c9 flags:# require_premium:flags.6?true resale_ton_only:flags.7?true theme_available:flags.9?true id:long gift_id:long title:string slug:string num:int owner_id:flags.0?Peer owner_name:flags.1?string owner_address:flags.2?string attributes:Vector<StarGiftAttribute> availability_issued:int availability_total:int gift_address:flags.3?string resell_amount:flags.4?Vector<StarsAmount> released_by:flags.5?Peer value_amount:flags.8?long value_currency:flags.8?string value_usd_amount:flags.8?long theme_peer:flags.10?Peer peer_color:flags.11?PeerColor host_id:flags.12?Peer offer_min_stars:flags.13?int = StarGift;\npayments.starGiftsNotModified#a388a368 = payments.StarGifts;\npayments.starGifts#2ed82995 hash:int gifts:Vector<StarGift> chats:Vector<Chat> users:Vector<User> = payments.StarGifts;\nmessageReportOption#7903e3d9 text:string option:bytes = MessageReportOption;\nreportResultChooseOption#f0e4e0b6 title:string options:Vector<MessageReportOption> = ReportResult;\nreportResultAddComment#6f09ac31 flags:# optional:flags.0?true option:bytes = ReportResult;\nreportResultReported#8db33c4b = ReportResult;\nmessages.botPreparedInlineMessage#8ecf0511 id:string expire_date:int = messages.BotPreparedInlineMessage;\nmessages.preparedInlineMessage#ff57708d query_id:long result:BotInlineResult peer_types:Vector<InlineQueryPeerType> cache_time:int users:Vector<User> = messages.PreparedInlineMessage;\nbotAppSettings#c99b1950 flags:# placeholder_path:flags.0?bytes background_color:flags.1?int background_dark_color:flags.2?int header_color:flags.3?int header_dark_color:flags.4?int = BotAppSettings;\nstarRefProgram#dd0c66f2 flags:# bot_id:long commission_permille:int duration_months:flags.0?int end_date:flags.1?int daily_revenue_per_user:flags.2?StarsAmount = StarRefProgram;\nconnectedBotStarRef#19a13f71 flags:# revoked:flags.1?true url:string date:int bot_id:long commission_permille:int duration_months:flags.0?int participants:long revenue:long = ConnectedBotStarRef;\npayments.connectedStarRefBots#98d5ea1d count:int connected_bots:Vector<ConnectedBotStarRef> users:Vector<User> = payments.ConnectedStarRefBots;\npayments.suggestedStarRefBots#b4d5d859 flags:# count:int suggested_bots:Vector<StarRefProgram> users:Vector<User> next_offset:flags.0?string = payments.SuggestedStarRefBots;\nstarsAmount#bbb6b4a3 amount:long nanos:int = StarsAmount;\nstarsTonAmount#74aee3e0 amount:long = StarsAmount;\nmessages.foundStickersNotModified#6010c534 flags:# next_offset:flags.0?int = messages.FoundStickers;\nmessages.foundStickers#82c9e290 flags:# next_offset:flags.0?int hash:long stickers:Vector<Document> = messages.FoundStickers;\nbotVerifierSettings#b0cd6617 flags:# can_modify_custom_description:flags.1?true icon:long company:string custom_description:flags.0?string = BotVerifierSettings;\nbotVerification#f93cd45c bot_id:long icon:long description:string = BotVerification;\nstarGiftAttributeModel#39d99013 name:string document:Document rarity_permille:int = StarGiftAttribute;\nstarGiftAttributePattern#13acff19 name:string document:Document rarity_permille:int = StarGiftAttribute;\nstarGiftAttributeBackdrop#d93d859c name:string backdrop_id:int center_color:int edge_color:int pattern_color:int text_color:int rarity_permille:int = StarGiftAttribute;\nstarGiftAttributeOriginalDetails#e0bff26c flags:# sender_id:flags.0?Peer recipient_id:Peer date:int message:flags.1?TextWithEntities = StarGiftAttribute;\npayments.starGiftUpgradePreview#3de1dfed sample_attributes:Vector<StarGiftAttribute> prices:Vector<StarGiftUpgradePrice> next_prices:Vector<StarGiftUpgradePrice> = payments.StarGiftUpgradePreview;\nusers.users#62d706b8 users:Vector<User> = users.Users;\nusers.usersSlice#315a4974 count:int users:Vector<User> = users.Users;\npayments.uniqueStarGift#416c56e8 gift:StarGift chats:Vector<Chat> users:Vector<User> = payments.UniqueStarGift;\nmessages.webPagePreview#8c9a88ac media:MessageMedia chats:Vector<Chat> users:Vector<User> = messages.WebPagePreview;\nsavedStarGift#ead6805e flags:# name_hidden:flags.0?true unsaved:flags.5?true refunded:flags.9?true can_upgrade:flags.10?true pinned_to_top:flags.12?true upgrade_separate:flags.17?true from_id:flags.1?Peer date:int gift:StarGift message:flags.2?TextWithEntities msg_id:flags.3?int saved_id:flags.11?long convert_stars:flags.4?long upgrade_stars:flags.6?long can_export_at:flags.7?int transfer_stars:flags.8?long can_transfer_at:flags.13?int can_resell_at:flags.14?int collection_id:flags.15?Vector<int> prepaid_upgrade_hash:flags.16?string drop_original_details_stars:flags.18?long gift_num:flags.19?int = SavedStarGift;\npayments.savedStarGifts#95f389b1 flags:# count:int chat_notifications_enabled:flags.1?Bool gifts:Vector<SavedStarGift> next_offset:flags.0?string chats:Vector<Chat> users:Vector<User> = payments.SavedStarGifts;\ninputSavedStarGiftUser#69279795 msg_id:int = InputSavedStarGift;\ninputSavedStarGiftChat#f101aa7f peer:InputPeer saved_id:long = InputSavedStarGift;\ninputSavedStarGiftSlug#2085c238 slug:string = InputSavedStarGift;\npayments.starGiftWithdrawalUrl#84aa3a9c url:string = payments.StarGiftWithdrawalUrl;\npaidReactionPrivacyDefault#206ad49e = PaidReactionPrivacy;\npaidReactionPrivacyAnonymous#1f0c1ad9 = PaidReactionPrivacy;\npaidReactionPrivacyPeer#dc6cfcf0 peer:InputPeer = PaidReactionPrivacy;\naccount.paidMessagesRevenue#1e109708 stars_amount:long = account.PaidMessagesRevenue;\nrequirementToContactEmpty#50a9839 = RequirementToContact;\nrequirementToContactPremium#e581e4e9 = RequirementToContact;\nrequirementToContactPaidMessages#b4f67e93 stars_amount:long = RequirementToContact;\nbusinessBotRights#a0624cf7 flags:# reply:flags.0?true read_messages:flags.1?true delete_sent_messages:flags.2?true delete_received_messages:flags.3?true edit_name:flags.4?true edit_bio:flags.5?true edit_profile_photo:flags.6?true edit_username:flags.7?true view_gifts:flags.8?true sell_gifts:flags.9?true change_gift_settings:flags.10?true transfer_and_upgrade_gifts:flags.11?true transfer_stars:flags.12?true manage_stories:flags.13?true = BusinessBotRights;\ndisallowedGiftsSettings#71f276c4 flags:# disallow_unlimited_stargifts:flags.0?true disallow_limited_stargifts:flags.1?true disallow_unique_stargifts:flags.2?true disallow_premium_gifts:flags.3?true disallow_stargifts_from_channels:flags.4?true = DisallowedGiftsSettings;\nsponsoredPeer#c69708d3 flags:# random_id:bytes peer:Peer sponsor_info:flags.0?string additional_info:flags.1?string = SponsoredPeer;\ncontacts.sponsoredPeersEmpty#ea32b4b1 = contacts.SponsoredPeers;\ncontacts.sponsoredPeers#eb032884 peers:Vector<SponsoredPeer> chats:Vector<Chat> users:Vector<User> = contacts.SponsoredPeers;\nstarGiftAttributeIdModel#48aaae3c document_id:long = StarGiftAttributeId;\nstarGiftAttributeIdPattern#4a162433 document_id:long = StarGiftAttributeId;\nstarGiftAttributeIdBackdrop#1f01c757 backdrop_id:int = StarGiftAttributeId;\nstarGiftAttributeCounter#2eb1b658 attribute:StarGiftAttributeId count:int = StarGiftAttributeCounter;\npayments.resaleStarGifts#947a12df flags:# count:int gifts:Vector<StarGift> next_offset:flags.0?string attributes:flags.1?Vector<StarGiftAttribute> attributes_hash:flags.1?long chats:Vector<Chat> counters:flags.2?Vector<StarGiftAttributeCounter> users:Vector<User> = payments.ResaleStarGifts;\nstories.canSendStoryCount#c387c04e count_remains:int = stories.CanSendStoryCount;\npendingSuggestion#e7e82e12 suggestion:string title:TextWithEntities description:TextWithEntities url:string = PendingSuggestion;\ntodoItem#cba9a52f id:int title:TextWithEntities = TodoItem;\ntodoList#49b92a26 flags:# others_can_append:flags.0?true others_can_complete:flags.1?true title:TextWithEntities list:Vector<TodoItem> = TodoList;\ntodoCompletion#221bb5e4 id:int completed_by:Peer date:int = TodoCompletion;\nsuggestedPost#e8e37e5 flags:# accepted:flags.1?true rejected:flags.2?true price:flags.3?StarsAmount schedule_date:flags.0?int = SuggestedPost;\nstarsRating#1b0e4f07 flags:# level:int current_level_stars:long stars:long next_level_stars:flags.0?long = StarsRating;\nstarGiftCollection#9d6b13b0 flags:# collection_id:int title:string icon:flags.0?Document gifts_count:int hash:long = StarGiftCollection;\npayments.starGiftCollectionsNotModified#a0ba4f17 = payments.StarGiftCollections;\npayments.starGiftCollections#8a2932f3 collections:Vector<StarGiftCollection> = payments.StarGiftCollections;\nstoryAlbum#9325705a flags:# album_id:int title:string icon_photo:flags.0?Photo icon_video:flags.1?Document = StoryAlbum;\nstories.albumsNotModified#564edaeb = stories.Albums;\nstories.albums#c3987a3a hash:long albums:Vector<StoryAlbum> = stories.Albums;\nsearchPostsFlood#3e0b5b6a flags:# query_is_free:flags.0?true total_daily:int remains:int wait_till:flags.1?int stars_amount:long = SearchPostsFlood;\npayments.uniqueStarGiftValueInfo#512fe446 flags:# last_sale_on_fragment:flags.1?true value_is_average:flags.6?true currency:string value:long initial_sale_date:int initial_sale_stars:long initial_sale_price:long last_sale_date:flags.0?int last_sale_price:flags.0?long floor_price:flags.2?long average_price:flags.3?long listed_count:flags.4?int fragment_listed_count:flags.5?int fragment_listed_url:flags.5?string = payments.UniqueStarGiftValueInfo;\nprofileTabPosts#b98cd696 = ProfileTab;\nprofileTabGifts#4d4bd46a = ProfileTab;\nprofileTabMedia#72c64955 = ProfileTab;\nprofileTabFiles#ab339c00 = ProfileTab;\nprofileTabMusic#9f27d26e = ProfileTab;\nprofileTabVoice#e477092e = ProfileTab;\nprofileTabLinks#d3656499 = ProfileTab;\nprofileTabGifs#a2c0f695 = ProfileTab;\nusers.savedMusicNotModified#e3878aa4 count:int = users.SavedMusic;\nusers.savedMusic#34a2f297 count:int documents:Vector<Document> = users.SavedMusic;\naccount.savedMusicIdsNotModified#4fc81d6e = account.SavedMusicIds;\naccount.savedMusicIds#998d6636 ids:Vector<long> = account.SavedMusicIds;\npayments.checkCanSendGiftResultOk#374fa7ad = payments.CheckCanSendGiftResult;\npayments.checkCanSendGiftResultFail#d5e58274 reason:TextWithEntities = payments.CheckCanSendGiftResult;\ninputChatThemeEmpty#83268483 = InputChatTheme;\ninputChatTheme#c93de95c emoticon:string = InputChatTheme;\ninputChatThemeUniqueGift#87e5dfe4 slug:string = InputChatTheme;\nstarGiftUpgradePrice#99ea331d date:int upgrade_stars:long = StarGiftUpgradePrice;\ngroupCallMessage#1a8afc7e flags:# from_admin:flags.1?true id:int from_id:Peer date:int message:TextWithEntities paid_message_stars:flags.0?long = GroupCallMessage;\ngroupCallDonor#ee430c85 flags:# top:flags.0?true my:flags.1?true peer_id:flags.3?Peer stars:long = GroupCallDonor;\nphone.groupCallStars#9d1dbd26 total_stars:long top_donors:Vector<GroupCallDonor> chats:Vector<Chat> users:Vector<User> = phone.GroupCallStars;\nrecentStory#711d692d flags:# live:flags.0?true max_id:flags.1?int = RecentStory;\nauctionBidLevel#310240cc pos:int amount:long date:int = AuctionBidLevel;\nstarGiftAuctionStateNotModified#fe333952 = StarGiftAuctionState;\nstarGiftAuctionState#771a4e66 version:int start_date:int end_date:int min_bid_amount:long bid_levels:Vector<AuctionBidLevel> top_bidders:Vector<long> next_round_at:int last_gift_num:int gifts_left:int current_round:int total_rounds:int rounds:Vector<StarGiftAuctionRound> = StarGiftAuctionState;\nstarGiftAuctionStateFinished#972dabbf flags:# start_date:int end_date:int average_price:long listed_count:flags.0?int fragment_listed_count:flags.1?int fragment_listed_url:flags.1?string = StarGiftAuctionState;\nstarGiftAuctionUserState#2eeed1c4 flags:# returned:flags.1?true bid_amount:flags.0?long bid_date:flags.0?int min_bid_amount:flags.0?long bid_peer:flags.0?Peer acquired_count:int = StarGiftAuctionUserState;\npayments.starGiftAuctionState#6b39f4ec gift:StarGift state:StarGiftAuctionState user_state:StarGiftAuctionUserState timeout:int users:Vector<User> chats:Vector<Chat> = payments.StarGiftAuctionState;\nstarGiftAuctionAcquiredGift#42b00348 flags:# name_hidden:flags.0?true peer:Peer date:int bid_amount:long round:int pos:int message:flags.1?TextWithEntities gift_num:flags.2?int = StarGiftAuctionAcquiredGift;\npayments.starGiftAuctionAcquiredGifts#7d5bd1f0 gifts:Vector<StarGiftAuctionAcquiredGift> users:Vector<User> chats:Vector<Chat> = payments.StarGiftAuctionAcquiredGifts;\nstarGiftActiveAuctionState#d31bc45d gift:StarGift state:StarGiftAuctionState user_state:StarGiftAuctionUserState = StarGiftActiveAuctionState;\npayments.starGiftActiveAuctionsNotModified#db33dad0 = payments.StarGiftActiveAuctions;\npayments.starGiftActiveAuctions#aef6abbc auctions:Vector<StarGiftActiveAuctionState> users:Vector<User> chats:Vector<Chat> = payments.StarGiftActiveAuctions;\ninputStarGiftAuction#2e16c98 gift_id:long = InputStarGiftAuction;\ninputStarGiftAuctionSlug#7ab58308 slug:string = InputStarGiftAuction;\npasskey#98613ebf flags:# id:string name:string date:int software_emoji_id:flags.0?long last_usage_date:flags.1?int = Passkey;\naccount.passkeys#f8e0aa1c passkeys:Vector<Passkey> = account.Passkeys;\naccount.passkeyRegistrationOptions#e16b5ce1 options:DataJSON = account.PasskeyRegistrationOptions;\nauth.passkeyLoginOptions#e2037789 options:DataJSON = auth.PasskeyLoginOptions;\ninputPasskeyResponseRegister#3e63935c client_data:DataJSON attestation_data:bytes = InputPasskeyResponse;\ninputPasskeyResponseLogin#c31fc14a client_data:DataJSON authenticator_data:bytes signature:bytes user_handle:string = InputPasskeyResponse;\ninputPasskeyCredentialPublicKey#3c27b78f id:string raw_id:string response:InputPasskeyResponse = InputPasskeyCredential;\nstarGiftBackground#aff56398 center_color:int edge_color:int text_color:int = StarGiftBackground;\nstarGiftAuctionRound#3aae0528 num:int duration:int = StarGiftAuctionRound;\nstarGiftAuctionRoundExtendable#aa021e5 num:int duration:int extend_top:int extend_window:int = StarGiftAuctionRound;\npayments.starGiftUpgradeAttributes#46c6e36f attributes:Vector<StarGiftAttribute> = payments.StarGiftUpgradeAttributes;\n---functions---\ninvokeAfterMsg#cb9f372d {X:Type} msg_id:long query:!X = X;\ninitConnection#c1cd5ea9 {X:Type} flags:# api_id:int device_model:string system_version:string app_version:string system_lang_code:string lang_pack:string lang_code:string proxy:flags.0?InputClientProxy params:flags.1?JSONValue query:!X = X;\ninvokeWithLayer#da9b0d0d {X:Type} layer:int query:!X = X;\nauth.sendCode#a677244f phone_number:string api_id:int api_hash:string settings:CodeSettings = auth.SentCode;\nauth.signUp#aac7b717 flags:# no_joined_notifications:flags.0?true phone_number:string phone_code_hash:string first_name:string last_name:string = auth.Authorization;\nauth.signIn#8d52a951 flags:# phone_number:string phone_code_hash:string phone_code:flags.0?string email_verification:flags.1?EmailVerification = auth.Authorization;\nauth.logOut#3e72ba19 = auth.LoggedOut;\nauth.resetAuthorizations#9fab0d1a = Bool;\nauth.exportAuthorization#e5bfffcd dc_id:int = auth.ExportedAuthorization;\nauth.importAuthorization#a57a7dad id:long bytes:bytes = auth.Authorization;\nauth.bindTempAuthKey#cdd42a05 perm_auth_key_id:long nonce:long expires_at:int encrypted_message:bytes = Bool;\nauth.checkPassword#d18b4d16 password:InputCheckPasswordSRP = auth.Authorization;\nauth.requestPasswordRecovery#d897bc66 = auth.PasswordRecovery;\nauth.resendCode#cae47523 flags:# phone_number:string phone_code_hash:string reason:flags.0?string = auth.SentCode;\nauth.cancelCode#1f040578 phone_number:string phone_code_hash:string = Bool;\nauth.dropTempAuthKeys#8e48a188 except_auth_keys:Vector<long> = Bool;\nauth.exportLoginToken#b7e085fe api_id:int api_hash:string except_ids:Vector<long> = auth.LoginToken;\nauth.importLoginToken#95ac5ce4 token:bytes = auth.LoginToken;\nauth.importWebTokenAuthorization#2db873a9 api_id:int api_hash:string web_auth_token:string = auth.Authorization;\nauth.initPasskeyLogin#518ad0b7 api_id:int api_hash:string = auth.PasskeyLoginOptions;\nauth.finishPasskeyLogin#9857ad07 flags:# credential:InputPasskeyCredential from_dc_id:flags.0?int from_auth_key_id:flags.0?long = auth.Authorization;\naccount.registerDevice#ec86017a flags:# no_muted:flags.0?true token_type:int token:string app_sandbox:Bool secret:bytes other_uids:Vector<long> = Bool;\naccount.unregisterDevice#6a0d3206 token_type:int token:string other_uids:Vector<long> = Bool;\naccount.updateNotifySettings#84be5b93 peer:InputNotifyPeer settings:InputPeerNotifySettings = Bool;\naccount.getNotifySettings#12b3ad31 peer:InputNotifyPeer = PeerNotifySettings;\naccount.updateProfile#78515775 flags:# first_name:flags.0?string last_name:flags.1?string about:flags.2?string = User;\naccount.updateStatus#6628562c offline:Bool = Bool;\naccount.getWallPapers#7967d36 hash:long = account.WallPapers;\naccount.reportPeer#c5ba3d86 peer:InputPeer reason:ReportReason message:string = Bool;\naccount.checkUsername#2714d86c username:string = Bool;\naccount.updateUsername#3e0bdd7c username:string = User;\naccount.getPrivacy#dadbc950 key:InputPrivacyKey = account.PrivacyRules;\naccount.setPrivacy#c9f81ce8 key:InputPrivacyKey rules:Vector<InputPrivacyRule> = account.PrivacyRules;\naccount.getAccountTTL#8fc711d = AccountDaysTTL;\naccount.setAccountTTL#2442485e ttl:AccountDaysTTL = Bool;\naccount.getAuthorizations#e320c158 = account.Authorizations;\naccount.resetAuthorization#df77f3bc hash:long = Bool;\naccount.getPassword#548a30f5 = account.Password;\naccount.getPasswordSettings#9cd4eaf9 password:InputCheckPasswordSRP = account.PasswordSettings;\naccount.updatePasswordSettings#a59b102f password:InputCheckPasswordSRP new_settings:account.PasswordInputSettings = Bool;\naccount.sendConfirmPhoneCode#1b3faa88 hash:string settings:CodeSettings = auth.SentCode;\naccount.confirmPhone#5f2178c3 phone_code_hash:string phone_code:string = Bool;\naccount.getTmpPassword#449e0b51 password:InputCheckPasswordSRP period:int = account.TmpPassword;\naccount.getWebAuthorizations#182e6d6f = account.WebAuthorizations;\naccount.resetWebAuthorization#2d01b9ef hash:long = Bool;\naccount.resetWebAuthorizations#682d2594 = Bool;\naccount.sendVerifyPhoneCode#a5a356f9 phone_number:string settings:CodeSettings = auth.SentCode;\naccount.confirmPasswordEmail#8fdf1920 code:string = Bool;\naccount.getContactSignUpNotification#9f07c728 = Bool;\naccount.setContactSignUpNotification#cff43f61 silent:Bool = Bool;\naccount.getNotifyExceptions#53577479 flags:# compare_sound:flags.1?true compare_stories:flags.2?true peer:flags.0?InputNotifyPeer = Updates;\naccount.uploadWallPaper#e39a8f03 flags:# for_chat:flags.0?true file:InputFile mime_type:string settings:WallPaperSettings = WallPaper;\naccount.setContentSettings#b574b16b flags:# sensitive_enabled:flags.0?true = Bool;\naccount.getContentSettings#8b9b4dae = account.ContentSettings;\naccount.getGlobalPrivacySettings#eb2b4cf6 = GlobalPrivacySettings;\naccount.setGlobalPrivacySettings#1edaaac2 settings:GlobalPrivacySettings = GlobalPrivacySettings;\naccount.reportProfilePhoto#fa8cc6f5 peer:InputPeer photo_id:InputPhoto reason:ReportReason message:string = Bool;\naccount.setAuthorizationTTL#bf899aa0 authorization_ttl_days:int = Bool;\naccount.changeAuthorizationSettings#40f48462 flags:# confirmed:flags.3?true hash:long encrypted_requests_disabled:flags.0?Bool call_requests_disabled:flags.1?Bool = Bool;\naccount.updateEmojiStatus#fbd3de6b emoji_status:EmojiStatus = Bool;\naccount.getRecentEmojiStatuses#f578105 hash:long = account.EmojiStatuses;\naccount.reorderUsernames#ef500eab order:Vector<string> = Bool;\naccount.toggleUsername#58d6b376 username:string active:Bool = Bool;\naccount.updateBirthday#cc6e0c11 flags:# birthday:flags.0?Birthday = Bool;\naccount.resolveBusinessChatLink#5492e5ee slug:string = account.ResolvedBusinessChatLinks;\naccount.toggleSponsoredMessages#b9d9a38d enabled:Bool = Bool;\naccount.getCollectibleEmojiStatuses#2e7b4543 hash:long = account.EmojiStatuses;\naccount.getPaidMessagesRevenue#19ba4a67 flags:# parent_peer:flags.0?InputPeer user_id:InputUser = account.PaidMessagesRevenue;\naccount.toggleNoPaidMessagesException#fe2eda76 flags:# refund_charged:flags.0?true require_payment:flags.2?true parent_peer:flags.1?InputPeer user_id:InputUser = Bool;\naccount.setMainProfileTab#5dee78b0 tab:ProfileTab = Bool;\naccount.initPasskeyRegistration#429547e8 = account.PasskeyRegistrationOptions;\naccount.registerPasskey#55b41fd6 credential:InputPasskeyCredential = Passkey;\naccount.getPasskeys#ea1f0c52 = account.Passkeys;\naccount.deletePasskey#f5b5563f id:string = Bool;\nusers.getUsers#d91a548 id:Vector<InputUser> = Vector<User>;\nusers.getFullUser#b60f5918 id:InputUser = users.UserFull;\ncontacts.getContacts#5dd69e12 hash:long = contacts.Contacts;\ncontacts.importContacts#2c800be5 contacts:Vector<InputContact> = contacts.ImportedContacts;\ncontacts.deleteContacts#96a0e00 id:Vector<InputUser> = Updates;\ncontacts.block#2e2e8734 flags:# my_stories_from:flags.0?true id:InputPeer = Bool;\ncontacts.unblock#b550d328 flags:# my_stories_from:flags.0?true id:InputPeer = Bool;\ncontacts.getBlocked#9a868f80 flags:# my_stories_from:flags.0?true offset:int limit:int = contacts.Blocked;\ncontacts.search#11f812d8 q:string limit:int = contacts.Found;\ncontacts.resolveUsername#725afbbc flags:# username:string referer:flags.0?string = contacts.ResolvedPeer;\ncontacts.getTopPeers#973478b6 flags:# correspondents:flags.0?true bots_pm:flags.1?true bots_inline:flags.2?true phone_calls:flags.3?true forward_users:flags.4?true forward_chats:flags.5?true groups:flags.10?true channels:flags.15?true bots_app:flags.16?true offset:int limit:int hash:long = contacts.TopPeers;\ncontacts.addContact#d9ba2e54 flags:# add_phone_privacy_exception:flags.0?true id:InputUser first_name:string last_name:string phone:string note:flags.1?TextWithEntities = Updates;\ncontacts.resolvePhone#8af94344 phone:string = contacts.ResolvedPeer;\ncontacts.editCloseFriends#ba6705f0 id:Vector<long> = Bool;\ncontacts.getSponsoredPeers#b6c8c393 q:string = contacts.SponsoredPeers;\ncontacts.updateContactNote#139f63fb id:InputUser note:TextWithEntities = Bool;\nmessages.getMessages#63c66506 id:Vector<InputMessage> = messages.Messages;\nmessages.getDialogs#a0f4cb4f flags:# exclude_pinned:flags.0?true folder_id:flags.1?int offset_date:int offset_id:int offset_peer:InputPeer limit:int hash:long = messages.Dialogs;\nmessages.getHistory#4423e6c5 peer:InputPeer offset_id:int offset_date:int add_offset:int limit:int max_id:int min_id:int hash:long = messages.Messages;\nmessages.search#29ee847a flags:# peer:InputPeer q:string from_id:flags.0?InputPeer saved_peer_id:flags.2?InputPeer saved_reaction:flags.3?Vector<Reaction> top_msg_id:flags.1?int filter:MessagesFilter min_date:int max_date:int offset_id:int add_offset:int limit:int max_id:int min_id:int hash:long = messages.Messages;\nmessages.readHistory#e306d3a peer:InputPeer max_id:int = messages.AffectedMessages;\nmessages.deleteHistory#b08f922a flags:# just_clear:flags.0?true revoke:flags.1?true peer:InputPeer max_id:int min_date:flags.2?int max_date:flags.3?int = messages.AffectedHistory;\nmessages.deleteMessages#e58e95d2 flags:# revoke:flags.0?true id:Vector<int> = messages.AffectedMessages;\nmessages.receivedMessages#5a954c0 max_id:int = Vector<ReceivedNotifyMessage>;\nmessages.setTyping#58943ee2 flags:# peer:InputPeer top_msg_id:flags.0?int action:SendMessageAction = Bool;\nmessages.sendMessage#545cd15a flags:# no_webpage:flags.1?true silent:flags.5?true background:flags.6?true clear_draft:flags.7?true noforwards:flags.14?true update_stickersets_order:flags.15?true invert_media:flags.16?true allow_paid_floodskip:flags.19?true peer:InputPeer reply_to:flags.0?InputReplyTo message:string random_id:long reply_markup:flags.2?ReplyMarkup entities:flags.3?Vector<MessageEntity> schedule_date:flags.10?int schedule_repeat_period:flags.24?int send_as:flags.13?InputPeer quick_reply_shortcut:flags.17?InputQuickReplyShortcut effect:flags.18?long allow_paid_stars:flags.21?long suggested_post:flags.22?SuggestedPost = Updates;\nmessages.sendMedia#330e77f flags:# silent:flags.5?true background:flags.6?true clear_draft:flags.7?true noforwards:flags.14?true update_stickersets_order:flags.15?true invert_media:flags.16?true allow_paid_floodskip:flags.19?true peer:InputPeer reply_to:flags.0?InputReplyTo media:InputMedia message:string random_id:long reply_markup:flags.2?ReplyMarkup entities:flags.3?Vector<MessageEntity> schedule_date:flags.10?int schedule_repeat_period:flags.24?int send_as:flags.13?InputPeer quick_reply_shortcut:flags.17?InputQuickReplyShortcut effect:flags.18?long allow_paid_stars:flags.21?long suggested_post:flags.22?SuggestedPost = Updates;\nmessages.forwardMessages#13704a7c flags:# silent:flags.5?true background:flags.6?true with_my_score:flags.8?true drop_author:flags.11?true drop_media_captions:flags.12?true noforwards:flags.14?true allow_paid_floodskip:flags.19?true from_peer:InputPeer id:Vector<int> random_id:Vector<long> to_peer:InputPeer top_msg_id:flags.9?int reply_to:flags.22?InputReplyTo schedule_date:flags.10?int schedule_repeat_period:flags.24?int send_as:flags.13?InputPeer quick_reply_shortcut:flags.17?InputQuickReplyShortcut effect:flags.18?long video_timestamp:flags.20?int allow_paid_stars:flags.21?long suggested_post:flags.23?SuggestedPost = Updates;\nmessages.reportSpam#cf1592db peer:InputPeer = Bool;\nmessages.getPeerSettings#efd9a6a2 peer:InputPeer = messages.PeerSettings;\nmessages.report#fc78af9b peer:InputPeer id:Vector<int> option:bytes message:string = ReportResult;\nmessages.getChats#49e9528f id:Vector<long> = messages.Chats;\nmessages.getFullChat#aeb00b34 chat_id:long = messages.ChatFull;\nmessages.editChatTitle#73783ffd chat_id:long title:string = Updates;\nmessages.editChatPhoto#35ddd674 chat_id:long photo:InputChatPhoto = Updates;\nmessages.addChatUser#cbc6d107 chat_id:long user_id:InputUser fwd_limit:int = messages.InvitedUsers;\nmessages.deleteChatUser#a2185cab flags:# revoke_history:flags.0?true chat_id:long user_id:InputUser = Updates;\nmessages.createChat#92ceddd4 flags:# users:Vector<InputUser> title:string ttl_period:flags.0?int = messages.InvitedUsers;\nmessages.getDhConfig#26cf8950 version:int random_length:int = messages.DhConfig;\nmessages.readMessageContents#36a73f77 id:Vector<int> = messages.AffectedMessages;\nmessages.getStickers#d5a5d3a1 emoticon:string hash:long = messages.Stickers;\nmessages.getAllStickers#b8a0a1a8 hash:long = messages.AllStickers;\nmessages.getWebPagePreview#570d6f6f flags:# message:string entities:flags.3?Vector<MessageEntity> = messages.WebPagePreview;\nmessages.exportChatInvite#a455de90 flags:# legacy_revoke_permanent:flags.2?true request_needed:flags.3?true peer:InputPeer expire_date:flags.0?int usage_limit:flags.1?int title:flags.4?string subscription_pricing:flags.5?StarsSubscriptionPricing = ExportedChatInvite;\nmessages.checkChatInvite#3eadb1bb hash:string = ChatInvite;\nmessages.importChatInvite#6c50051c hash:string = Updates;\nmessages.getStickerSet#c8a0ec74 stickerset:InputStickerSet hash:int = messages.StickerSet;\nmessages.installStickerSet#c78fe460 stickerset:InputStickerSet archived:Bool = messages.StickerSetInstallResult;\nmessages.uninstallStickerSet#f96e55de stickerset:InputStickerSet = Bool;\nmessages.startBot#e6df7378 bot:InputUser peer:InputPeer random_id:long start_param:string = Updates;\nmessages.getMessagesViews#5784d3e1 peer:InputPeer id:Vector<int> increment:Bool = messages.MessageViews;\nmessages.migrateChat#a2875319 chat_id:long = Updates;\nmessages.searchGlobal#4bc6589a flags:# broadcasts_only:flags.1?true groups_only:flags.2?true users_only:flags.3?true folder_id:flags.0?int q:string filter:MessagesFilter min_date:int max_date:int offset_rate:int offset_peer:InputPeer offset_id:int limit:int = messages.Messages;\nmessages.getDocumentByHash#b1f2061f sha256:bytes size:long mime_type:string = Document;\nmessages.getSavedGifs#5cf09635 hash:long = messages.SavedGifs;\nmessages.saveGif#327a30cb id:InputDocument unsave:Bool = Bool;\nmessages.getInlineBotResults#514e999d flags:# bot:InputUser peer:InputPeer geo_point:flags.0?InputGeoPoint query:string offset:string = messages.BotResults;\nmessages.sendInlineBotResult#c0cf7646 flags:# silent:flags.5?true background:flags.6?true clear_draft:flags.7?true hide_via:flags.11?true peer:InputPeer reply_to:flags.0?InputReplyTo random_id:long query_id:long id:string schedule_date:flags.10?int send_as:flags.13?InputPeer quick_reply_shortcut:flags.17?InputQuickReplyShortcut allow_paid_stars:flags.21?long = Updates;\nmessages.editMessage#51e842e1 flags:# no_webpage:flags.1?true invert_media:flags.16?true peer:InputPeer id:int message:flags.11?string media:flags.14?InputMedia reply_markup:flags.2?ReplyMarkup entities:flags.3?Vector<MessageEntity> schedule_date:flags.15?int schedule_repeat_period:flags.18?int quick_reply_shortcut_id:flags.17?int = Updates;\nmessages.getBotCallbackAnswer#9342ca07 flags:# game:flags.1?true peer:InputPeer msg_id:int data:flags.0?bytes password:flags.2?InputCheckPasswordSRP = messages.BotCallbackAnswer;\nmessages.getPeerDialogs#e470bcfd peers:Vector<InputDialogPeer> = messages.PeerDialogs;\nmessages.saveDraft#54ae308e flags:# no_webpage:flags.1?true invert_media:flags.6?true reply_to:flags.4?InputReplyTo peer:InputPeer message:string entities:flags.3?Vector<MessageEntity> media:flags.5?InputMedia effect:flags.7?long suggested_post:flags.8?SuggestedPost = Bool;\nmessages.getFeaturedStickers#64780b14 hash:long = messages.FeaturedStickers;\nmessages.readFeaturedStickers#5b118126 id:Vector<long> = Bool;\nmessages.getRecentStickers#9da9403b flags:# attached:flags.0?true hash:long = messages.RecentStickers;\nmessages.saveRecentSticker#392718f8 flags:# attached:flags.0?true id:InputDocument unsave:Bool = Bool;\nmessages.clearRecentStickers#8999602d flags:# attached:flags.0?true = Bool;\nmessages.getCommonChats#e40ca104 user_id:InputUser max_id:long limit:int = messages.Chats;\nmessages.getWebPage#8d9692a3 url:string hash:int = messages.WebPage;\nmessages.toggleDialogPin#a731e257 flags:# pinned:flags.0?true peer:InputDialogPeer = Bool;\nmessages.getPinnedDialogs#d6b94df2 folder_id:int = messages.PeerDialogs;\nmessages.uploadMedia#14967978 flags:# business_connection_id:flags.0?string peer:InputPeer media:InputMedia = MessageMedia;\nmessages.getFavedStickers#4f1aaa9 hash:long = messages.FavedStickers;\nmessages.faveSticker#b9ffc55b id:InputDocument unfave:Bool = Bool;\nmessages.getUnreadMentions#f107e790 flags:# peer:InputPeer top_msg_id:flags.0?int offset_id:int add_offset:int limit:int max_id:int min_id:int = messages.Messages;\nmessages.readMentions#36e5bf4d flags:# peer:InputPeer top_msg_id:flags.0?int = messages.AffectedHistory;\nmessages.sendMultiMedia#1bf89d74 flags:# silent:flags.5?true background:flags.6?true clear_draft:flags.7?true noforwards:flags.14?true update_stickersets_order:flags.15?true invert_media:flags.16?true allow_paid_floodskip:flags.19?true peer:InputPeer reply_to:flags.0?InputReplyTo multi_media:Vector<InputSingleMedia> schedule_date:flags.10?int send_as:flags.13?InputPeer quick_reply_shortcut:flags.17?InputQuickReplyShortcut effect:flags.18?long allow_paid_stars:flags.21?long = Updates;\nmessages.searchStickerSets#35705b8a flags:# exclude_featured:flags.0?true q:string hash:long = messages.FoundStickerSets;\nmessages.markDialogUnread#8c5006f8 flags:# unread:flags.0?true parent_peer:flags.1?InputPeer peer:InputDialogPeer = Bool;\nmessages.updatePinnedMessage#d2aaf7ec flags:# silent:flags.0?true unpin:flags.1?true pm_oneside:flags.2?true peer:InputPeer id:int = Updates;\nmessages.sendVote#10ea6184 peer:InputPeer msg_id:int options:Vector<bytes> = Updates;\nmessages.getOnlines#6e2be050 peer:InputPeer = ChatOnlines;\nmessages.editChatAbout#def60797 peer:InputPeer about:string = Bool;\nmessages.editChatDefaultBannedRights#a5866b41 peer:InputPeer banned_rights:ChatBannedRights = Updates;\nmessages.getEmojiKeywordsDifference#1508b6af lang_code:string from_version:int = EmojiKeywordsDifference;\nmessages.requestUrlAuth#198fb446 flags:# peer:flags.1?InputPeer msg_id:flags.1?int button_id:flags.1?int url:flags.2?string = UrlAuthResult;\nmessages.acceptUrlAuth#b12c7125 flags:# write_allowed:flags.0?true peer:flags.1?InputPeer msg_id:flags.1?int button_id:flags.1?int url:flags.2?string = UrlAuthResult;\nmessages.hidePeerSettingsBar#4facb138 peer:InputPeer = Bool;\nmessages.getScheduledHistory#f516760b peer:InputPeer hash:long = messages.Messages;\nmessages.sendScheduledMessages#bd38850a peer:InputPeer id:Vector<int> = Updates;\nmessages.deleteScheduledMessages#59ae2b16 peer:InputPeer id:Vector<int> = Updates;\nmessages.getPollVotes#b86e380e flags:# peer:InputPeer id:int option:flags.0?bytes offset:flags.1?string limit:int = messages.VotesList;\nmessages.getDialogFilters#efd48c89 = messages.DialogFilters;\nmessages.getSuggestedDialogFilters#a29cd42c = Vector<DialogFilterSuggested>;\nmessages.updateDialogFilter#1ad4a04a flags:# id:int filter:flags.0?DialogFilter = Bool;\nmessages.updateDialogFiltersOrder#c563c1e4 order:Vector<int> = Bool;\nmessages.getReplies#22ddd30c peer:InputPeer msg_id:int offset_id:int offset_date:int add_offset:int limit:int max_id:int min_id:int hash:long = messages.Messages;\nmessages.getDiscussionMessage#446972fd peer:InputPeer msg_id:int = messages.DiscussionMessage;\nmessages.readDiscussion#f731a9f4 peer:InputPeer msg_id:int read_max_id:int = Bool;\nmessages.unpinAllMessages#62dd747 flags:# peer:InputPeer top_msg_id:flags.0?int saved_peer_id:flags.1?InputPeer = messages.AffectedHistory;\nmessages.deleteChat#5bd0ee50 chat_id:long = Bool;\nmessages.getExportedChatInvites#a2b5a3f6 flags:# revoked:flags.3?true peer:InputPeer admin_id:InputUser offset_date:flags.2?int offset_link:flags.2?string limit:int = messages.ExportedChatInvites;\nmessages.editExportedChatInvite#bdca2f75 flags:# revoked:flags.2?true peer:InputPeer link:string expire_date:flags.0?int usage_limit:flags.1?int request_needed:flags.3?Bool title:flags.4?string = messages.ExportedChatInvite;\nmessages.deleteRevokedExportedChatInvites#56987bd5 peer:InputPeer admin_id:InputUser = Bool;\nmessages.deleteExportedChatInvite#d464a42b peer:InputPeer link:string = Bool;\nmessages.getChatInviteImporters#df04dd4e flags:# requested:flags.0?true subscription_expired:flags.3?true peer:InputPeer link:flags.1?string q:flags.2?string offset_date:int offset_user:InputUser limit:int = messages.ChatInviteImporters;\nmessages.getMessageReadParticipants#31c1c44f peer:InputPeer msg_id:int = Vector<ReadParticipantDate>;\nmessages.hideChatJoinRequest#7fe7e815 flags:# approved:flags.0?true peer:InputPeer user_id:InputUser = Updates;\nmessages.hideAllChatJoinRequests#e085f4ea flags:# approved:flags.0?true peer:InputPeer link:flags.1?string = Updates;\nmessages.toggleNoForwards#b11eafa2 peer:InputPeer enabled:Bool = Updates;\nmessages.saveDefaultSendAs#ccfddf96 peer:InputPeer send_as:InputPeer = Bool;\nmessages.sendReaction#d30d78d4 flags:# big:flags.1?true add_to_recent:flags.2?true peer:InputPeer msg_id:int reaction:flags.0?Vector<Reaction> = Updates;\nmessages.getMessagesReactions#8bba90e6 peer:InputPeer id:Vector<int> = Updates;\nmessages.getMessageReactionsList#461b3f48 flags:# peer:InputPeer id:int reaction:flags.0?Reaction offset:flags.1?string limit:int = messages.MessageReactionsList;\nmessages.setChatAvailableReactions#864b2581 flags:# peer:InputPeer available_reactions:ChatReactions reactions_limit:flags.0?int paid_enabled:flags.1?Bool = Updates;\nmessages.getAvailableReactions#18dea0ac hash:int = messages.AvailableReactions;\nmessages.setDefaultReaction#4f47a016 reaction:Reaction = Bool;\nmessages.translateText#63183030 flags:# peer:flags.0?InputPeer id:flags.0?Vector<int> text:flags.1?Vector<TextWithEntities> to_lang:string = messages.TranslatedText;\nmessages.getUnreadReactions#bd7f90ac flags:# peer:InputPeer top_msg_id:flags.0?int saved_peer_id:flags.1?InputPeer offset_id:int add_offset:int limit:int max_id:int min_id:int = messages.Messages;\nmessages.readReactions#9ec44f93 flags:# peer:InputPeer top_msg_id:flags.0?int saved_peer_id:flags.1?InputPeer = messages.AffectedHistory;\nmessages.getAttachMenuBots#16fcc2cb hash:long = AttachMenuBots;\nmessages.getAttachMenuBot#77216192 bot:InputUser = AttachMenuBotsBot;\nmessages.toggleBotInAttachMenu#69f59d69 flags:# write_allowed:flags.0?true bot:InputUser enabled:Bool = Bool;\nmessages.requestWebView#269dc2c1 flags:# from_bot_menu:flags.4?true silent:flags.5?true compact:flags.7?true fullscreen:flags.8?true peer:InputPeer bot:InputUser url:flags.1?string start_param:flags.3?string theme_params:flags.2?DataJSON platform:string reply_to:flags.0?InputReplyTo send_as:flags.13?InputPeer = WebViewResult;\nmessages.prolongWebView#b0d81a83 flags:# silent:flags.5?true peer:InputPeer bot:InputUser query_id:long reply_to:flags.0?InputReplyTo send_as:flags.13?InputPeer = Bool;\nmessages.requestSimpleWebView#413a3e73 flags:# from_switch_webview:flags.1?true from_side_menu:flags.2?true compact:flags.7?true fullscreen:flags.8?true bot:InputUser url:flags.3?string start_param:flags.4?string theme_params:flags.0?DataJSON platform:string = WebViewResult;\nmessages.sendWebViewResultMessage#a4314f5 bot_query_id:string result:InputBotInlineResult = WebViewMessageSent;\nmessages.sendWebViewData#dc0242c8 bot:InputUser random_id:long button_text:string data:string = Updates;\nmessages.transcribeAudio#269e9a49 peer:InputPeer msg_id:int = messages.TranscribedAudio;\nmessages.getCustomEmojiDocuments#d9ab0f54 document_id:Vector<long> = Vector<Document>;\nmessages.getEmojiStickers#fbfca18f hash:long = messages.AllStickers;\nmessages.getFeaturedEmojiStickers#ecf6736 hash:long = messages.FeaturedStickers;\nmessages.getTopReactions#bb8125ba limit:int hash:long = messages.Reactions;\nmessages.getRecentReactions#39461db2 limit:int hash:long = messages.Reactions;\nmessages.clearRecentReactions#9dfeefb4 = Bool;\nmessages.getExtendedMedia#84f80814 peer:InputPeer id:Vector<int> = Updates;\nmessages.togglePeerTranslations#e47cb579 flags:# disabled:flags.0?true peer:InputPeer = Bool;\nmessages.getBotApp#34fdc5c3 app:InputBotApp hash:long = messages.BotApp;\nmessages.requestAppWebView#53618bce flags:# write_allowed:flags.0?true compact:flags.7?true fullscreen:flags.8?true peer:InputPeer app:InputBotApp start_param:flags.1?string theme_params:flags.2?DataJSON platform:string = WebViewResult;\nmessages.getSavedDialogs#1e91fc99 flags:# exclude_pinned:flags.0?true parent_peer:flags.1?InputPeer offset_date:int offset_id:int offset_peer:InputPeer limit:int hash:long = messages.SavedDialogs;\nmessages.getSavedHistory#998ab009 flags:# parent_peer:flags.0?InputPeer peer:InputPeer offset_id:int offset_date:int add_offset:int limit:int max_id:int min_id:int hash:long = messages.Messages;\nmessages.deleteSavedHistory#4dc5085f flags:# parent_peer:flags.0?InputPeer peer:InputPeer max_id:int min_date:flags.2?int max_date:flags.3?int = messages.AffectedHistory;\nmessages.getPinnedSavedDialogs#d63d94e0 = messages.SavedDialogs;\nmessages.toggleSavedDialogPin#ac81bbde flags:# pinned:flags.0?true peer:InputDialogPeer = Bool;\nmessages.getSavedReactionTags#3637e05b flags:# peer:flags.0?InputPeer hash:long = messages.SavedReactionTags;\nmessages.updateSavedReactionTag#60297dec flags:# reaction:Reaction title:flags.0?string = Bool;\nmessages.getDefaultTagReactions#bdf93428 hash:long = messages.Reactions;\nmessages.getOutboxReadDate#8c4bfe5d peer:InputPeer msg_id:int = OutboxReadDate;\nmessages.getQuickReplies#d483f2a8 hash:long = messages.QuickReplies;\nmessages.getQuickReplyMessages#94a495c3 flags:# shortcut_id:int id:flags.0?Vector<int> hash:long = messages.Messages;\nmessages.sendQuickReplyMessages#6c750de1 peer:InputPeer shortcut_id:int id:Vector<int> random_id:Vector<long> = Updates;\nmessages.toggleDialogFilterTags#fd2dda49 enabled:Bool = Bool;\nmessages.getAvailableEffects#dea20a39 hash:int = messages.AvailableEffects;\nmessages.getFactCheck#b9cdc5ee peer:InputPeer msg_id:Vector<int> = Vector<FactCheck>;\nmessages.requestMainWebView#c9e01e7b flags:# compact:flags.7?true fullscreen:flags.8?true peer:InputPeer bot:InputUser start_param:flags.1?string theme_params:flags.0?DataJSON platform:string = WebViewResult;\nmessages.sendPaidReaction#58bbcb50 flags:# peer:InputPeer msg_id:int count:int random_id:long private:flags.0?PaidReactionPrivacy = Updates;\nmessages.getPaidReactionPrivacy#472455aa = Updates;\nmessages.viewSponsoredMessage#269e3643 random_id:bytes = Bool;\nmessages.clickSponsoredMessage#8235057e flags:# media:flags.0?true fullscreen:flags.1?true random_id:bytes = Bool;\nmessages.reportSponsoredMessage#12cbf0c4 random_id:bytes option:bytes = channels.SponsoredMessageReportResult;\nmessages.getSponsoredMessages#3d6ce850 flags:# peer:InputPeer msg_id:flags.0?int = messages.SponsoredMessages;\nmessages.getPreparedInlineMessage#857ebdb8 bot:InputUser id:string = messages.PreparedInlineMessage;\nmessages.reportMessagesDelivery#5a6d7395 flags:# push:flags.0?true peer:InputPeer id:Vector<int> = Bool;\nmessages.toggleTodoCompleted#d3e03124 peer:InputPeer msg_id:int completed:Vector<int> incompleted:Vector<int> = Updates;\nmessages.appendTodoList#21a61057 peer:InputPeer msg_id:int list:Vector<TodoItem> = Updates;\nmessages.toggleSuggestedPostApproval#8107455c flags:# reject:flags.1?true peer:InputPeer msg_id:int schedule_date:flags.0?int reject_comment:flags.2?string = Updates;\nmessages.getForumTopics#3ba47bff flags:# peer:InputPeer q:flags.0?string offset_date:int offset_id:int offset_topic:int limit:int = messages.ForumTopics;\nmessages.getForumTopicsByID#af0a4a08 peer:InputPeer topics:Vector<int> = messages.ForumTopics;\nmessages.editForumTopic#cecc1134 flags:# peer:InputPeer topic_id:int title:flags.0?string icon_emoji_id:flags.1?long closed:flags.2?Bool hidden:flags.3?Bool = Updates;\nmessages.updatePinnedForumTopic#175df251 peer:InputPeer topic_id:int pinned:Bool = Updates;\nmessages.createForumTopic#2f98c3d5 flags:# title_missing:flags.4?true peer:InputPeer title:string icon_color:flags.0?int icon_emoji_id:flags.3?long random_id:long send_as:flags.2?InputPeer = Updates;\nmessages.deleteTopicHistory#d2816f10 peer:InputPeer top_msg_id:int = messages.AffectedHistory;\nupdates.getState#edd4882a = updates.State;\nupdates.getDifference#19c2f763 flags:# pts:int pts_limit:flags.1?int pts_total_limit:flags.0?int date:int qts:int qts_limit:flags.2?int = updates.Difference;\nupdates.getChannelDifference#3173d78 flags:# force:flags.0?true channel:InputChannel filter:ChannelMessagesFilter pts:int limit:int = updates.ChannelDifference;\nphotos.updateProfilePhoto#9e82039 flags:# fallback:flags.0?true bot:flags.1?InputUser id:InputPhoto = photos.Photo;\nphotos.uploadProfilePhoto#388a3b5 flags:# fallback:flags.3?true bot:flags.5?InputUser file:flags.0?InputFile video:flags.1?InputFile video_start_ts:flags.2?double video_emoji_markup:flags.4?VideoSize = photos.Photo;\nphotos.deletePhotos#87cf7f2f id:Vector<InputPhoto> = Vector<long>;\nphotos.getUserPhotos#91cd32a8 user_id:InputUser offset:int max_id:long limit:int = photos.Photos;\nphotos.uploadContactProfilePhoto#e14c4a71 flags:# suggest:flags.3?true save:flags.4?true user_id:InputUser file:flags.0?InputFile video:flags.1?InputFile video_start_ts:flags.2?double video_emoji_markup:flags.5?VideoSize = photos.Photo;\nupload.saveFilePart#b304a621 file_id:long file_part:int bytes:bytes = Bool;\nupload.getFile#be5335be flags:# precise:flags.0?true cdn_supported:flags.1?true location:InputFileLocation offset:long limit:int = upload.File;\nupload.saveBigFilePart#de7b673d file_id:long file_part:int file_total_parts:int bytes:bytes = Bool;\nupload.getWebFile#24e6818d location:InputWebFileLocation offset:int limit:int = upload.WebFile;\nhelp.getConfig#c4f9186b = Config;\nhelp.getNearestDc#1fb33026 = NearestDc;\nhelp.getSupport#9cdf08cd = help.Support;\nhelp.acceptTermsOfService#ee72f79a id:DataJSON = Bool;\nhelp.getAppConfig#61e3f854 hash:int = help.AppConfig;\nhelp.getPromoData#c0977421 = help.PromoData;\nhelp.dismissSuggestion#f50dbaa1 peer:InputPeer suggestion:string = Bool;\nhelp.getCountriesList#735787a8 lang_code:string hash:int = help.CountriesList;\nhelp.getPremiumPromo#b81b93d4 = help.PremiumPromo;\nhelp.getPeerColors#da80f42f hash:int = help.PeerColors;\nhelp.getPeerProfileColors#abcfa9fd hash:int = help.PeerColors;\nhelp.getTimezonesList#49b30240 hash:int = help.TimezonesList;\nchannels.readHistory#cc104937 channel:InputChannel max_id:int = Bool;\nchannels.deleteMessages#84c1fd4e channel:InputChannel id:Vector<int> = messages.AffectedMessages;\nchannels.reportSpam#f44a8315 channel:InputChannel participant:InputPeer id:Vector<int> = Bool;\nchannels.getMessages#ad8c9a23 channel:InputChannel id:Vector<InputMessage> = messages.Messages;\nchannels.getParticipants#77ced9d0 channel:InputChannel filter:ChannelParticipantsFilter offset:int limit:int hash:long = channels.ChannelParticipants;\nchannels.getParticipant#a0ab6cc6 channel:InputChannel participant:InputPeer = channels.ChannelParticipant;\nchannels.getChannels#a7f6bbb id:Vector<InputChannel> = messages.Chats;\nchannels.getFullChannel#8736a09 channel:InputChannel = messages.ChatFull;\nchannels.createChannel#91006707 flags:# broadcast:flags.0?true megagroup:flags.1?true for_import:flags.3?true forum:flags.5?true title:string about:string geo_point:flags.2?InputGeoPoint address:flags.2?string ttl_period:flags.4?int = Updates;\nchannels.editAdmin#d33c8902 channel:InputChannel user_id:InputUser admin_rights:ChatAdminRights rank:string = Updates;\nchannels.editTitle#566decd0 channel:InputChannel title:string = Updates;\nchannels.editPhoto#f12e57c9 channel:InputChannel photo:InputChatPhoto = Updates;\nchannels.checkUsername#10e6bd2c channel:InputChannel username:string = Bool;\nchannels.updateUsername#3514b3de channel:InputChannel username:string = Bool;\nchannels.joinChannel#24b524c5 channel:InputChannel = Updates;\nchannels.leaveChannel#f836aa95 channel:InputChannel = Updates;\nchannels.inviteToChannel#c9e33d54 channel:InputChannel users:Vector<InputUser> = messages.InvitedUsers;\nchannels.deleteChannel#c0111fe3 channel:InputChannel = Updates;\nchannels.exportMessageLink#e63fadeb flags:# grouped:flags.0?true thread:flags.1?true channel:InputChannel id:int = ExportedMessageLink;\nchannels.toggleSignatures#418d549c flags:# signatures_enabled:flags.0?true profiles_enabled:flags.1?true channel:InputChannel = Updates;\nchannels.editBanned#96e6cd81 channel:InputChannel participant:InputPeer banned_rights:ChatBannedRights = Updates;\nchannels.readMessageContents#eab5dc38 channel:InputChannel id:Vector<int> = Bool;\nchannels.togglePreHistoryHidden#eabbb94c channel:InputChannel enabled:Bool = Updates;\nchannels.getGroupsForDiscussion#f5dad378 = messages.Chats;\nchannels.setDiscussionGroup#40582bb2 broadcast:InputChannel group:InputChannel = Bool;\nchannels.getSendAs#e785a43f flags:# for_paid_reactions:flags.0?true for_live_stories:flags.1?true peer:InputPeer = channels.SendAsPeers;\nchannels.deleteParticipantHistory#367544db channel:InputChannel participant:InputPeer = messages.AffectedHistory;\nchannels.toggleJoinToSend#e4cb9580 channel:InputChannel enabled:Bool = Updates;\nchannels.toggleJoinRequest#4c2985b6 channel:InputChannel enabled:Bool = Updates;\nchannels.reorderUsernames#b45ced1d channel:InputChannel order:Vector<string> = Bool;\nchannels.toggleUsername#50f24105 channel:InputChannel username:string active:Bool = Bool;\nchannels.deactivateAllUsernames#a245dd3 channel:InputChannel = Bool;\nchannels.toggleForum#3ff75734 channel:InputChannel enabled:Bool tabs:Bool = Updates;\nchannels.toggleParticipantsHidden#6a6e7854 channel:InputChannel enabled:Bool = Updates;\nchannels.toggleViewForumAsMessages#9738bb15 channel:InputChannel enabled:Bool = Updates;\nchannels.getChannelRecommendations#25a71742 flags:# channel:flags.0?InputChannel = messages.Chats;\nchannels.searchPosts#f2c4f24d flags:# hashtag:flags.0?string query:flags.1?string offset_rate:int offset_peer:InputPeer offset_id:int limit:int allow_paid_stars:flags.2?long = messages.Messages;\nchannels.updatePaidMessagesPrice#4b12327b flags:# broadcast_messages_allowed:flags.0?true channel:InputChannel send_paid_messages_stars:long = Updates;\nchannels.toggleAutotranslation#167fc0a1 channel:InputChannel enabled:Bool = Updates;\nchannels.checkSearchPostsFlood#22567115 flags:# query:flags.0?string = SearchPostsFlood;\nchannels.setMainProfileTab#3583fcb1 channel:InputChannel tab:ProfileTab = Bool;\nbots.setBotInfo#10cf3123 flags:# bot:flags.2?InputUser lang_code:string name:flags.3?string about:flags.0?string description:flags.1?string = Bool;\nbots.canSendMessage#1359f4e6 bot:InputUser = Bool;\nbots.allowSendMessage#f132e3ef bot:InputUser = Updates;\nbots.invokeWebViewCustomMethod#87fc5e7 bot:InputUser custom_method:string params:DataJSON = DataJSON;\nbots.getPopularAppBots#c2510192 offset:string limit:int = bots.PopularAppBots;\nbots.getPreviewMedias#a2a5594d bot:InputUser = Vector<BotPreviewMedia>;\nbots.toggleUserEmojiStatusPermission#6de6392 bot:InputUser enabled:Bool = Bool;\nbots.checkDownloadFileParams#50077589 bot:InputUser file_name:string url:string = Bool;\nbots.getBotRecommendations#a1b70815 bot:InputUser = users.Users;\npayments.getPaymentForm#37148dbb flags:# invoice:InputInvoice theme_params:flags.0?DataJSON = payments.PaymentForm;\npayments.getPaymentReceipt#2478d1cc peer:InputPeer msg_id:int = payments.PaymentReceipt;\npayments.validateRequestedInfo#b6c8f12b flags:# save:flags.0?true invoice:InputInvoice info:PaymentRequestedInfo = payments.ValidatedRequestedInfo;\npayments.sendPaymentForm#2d03522f flags:# form_id:long invoice:InputInvoice requested_info_id:flags.0?string shipping_option_id:flags.1?string credentials:InputPaymentCredentials tip_amount:flags.2?long = payments.PaymentResult;\npayments.getSavedInfo#227d824b = payments.SavedInfo;\npayments.getPremiumGiftCodeOptions#2757ba54 flags:# boost_peer:flags.0?InputPeer = Vector<PremiumGiftCodeOption>;\npayments.checkGiftCode#8e51b4c1 slug:string = payments.CheckedGiftCode;\npayments.applyGiftCode#f6e26854 slug:string = Updates;\npayments.getGiveawayInfo#f4239425 peer:InputPeer msg_id:int = payments.GiveawayInfo;\npayments.launchPrepaidGiveaway#5ff58f20 peer:InputPeer giveaway_id:long purpose:InputStorePaymentPurpose = Updates;\npayments.getStarsTopupOptions#c00ec7d3 = Vector<StarsTopupOption>;\npayments.getStarsStatus#4ea9b3bf flags:# ton:flags.0?true peer:InputPeer = payments.StarsStatus;\npayments.getStarsTransactions#69da4557 flags:# inbound:flags.0?true outbound:flags.1?true ascending:flags.2?true ton:flags.4?true subscription_id:flags.3?string peer:InputPeer offset:string limit:int = payments.StarsStatus;\npayments.sendStarsForm#7998c914 form_id:long invoice:InputInvoice = payments.PaymentResult;\npayments.refundStarsCharge#25ae8f4a user_id:InputUser charge_id:string = Updates;\npayments.getStarsTransactionsByID#2dca16b8 flags:# ton:flags.0?true peer:InputPeer id:Vector<InputStarsTransaction> = payments.StarsStatus;\npayments.getStarsGiftOptions#d3c96bc8 flags:# user_id:flags.0?InputUser = Vector<StarsGiftOption>;\npayments.getStarsSubscriptions#32512c5 flags:# missing_balance:flags.0?true peer:InputPeer offset:string = payments.StarsStatus;\npayments.changeStarsSubscription#c7770878 flags:# peer:InputPeer subscription_id:string canceled:flags.0?Bool = Bool;\npayments.fulfillStarsSubscription#cc5bebb3 peer:InputPeer subscription_id:string = Bool;\npayments.getStarsGiveawayOptions#bd1efd3e = Vector<StarsGiveawayOption>;\npayments.getStarGifts#c4563590 hash:int = payments.StarGifts;\npayments.saveStarGift#2a2a697c flags:# unsave:flags.0?true stargift:InputSavedStarGift = Bool;\npayments.convertStarGift#74bf076b stargift:InputSavedStarGift = Bool;\npayments.getStarGiftUpgradePreview#9c9abcb1 gift_id:long = payments.StarGiftUpgradePreview;\npayments.upgradeStarGift#aed6e4f5 flags:# keep_original_details:flags.0?true stargift:InputSavedStarGift = Updates;\npayments.transferStarGift#7f18176a stargift:InputSavedStarGift to_id:InputPeer = Updates;\npayments.getUniqueStarGift#a1974d72 slug:string = payments.UniqueStarGift;\npayments.getSavedStarGifts#a319e569 flags:# exclude_unsaved:flags.0?true exclude_saved:flags.1?true exclude_unlimited:flags.2?true exclude_unique:flags.4?true sort_by_value:flags.5?true exclude_upgradable:flags.7?true exclude_unupgradable:flags.8?true peer_color_available:flags.9?true exclude_hosted:flags.10?true peer:InputPeer collection_id:flags.6?int offset:string limit:int = payments.SavedStarGifts;\npayments.getStarGiftWithdrawalUrl#d06e93a8 stargift:InputSavedStarGift password:InputCheckPasswordSRP = payments.StarGiftWithdrawalUrl;\npayments.toggleStarGiftsPinnedToTop#1513e7b0 peer:InputPeer stargift:Vector<InputSavedStarGift> = Bool;\npayments.getResaleStarGifts#7a5fa236 flags:# sort_by_price:flags.1?true sort_by_num:flags.2?true attributes_hash:flags.0?long gift_id:long attributes:flags.3?Vector<StarGiftAttributeId> offset:string limit:int = payments.ResaleStarGifts;\npayments.updateStarGiftPrice#edbe6ccb stargift:InputSavedStarGift resell_amount:StarsAmount = Updates;\npayments.getStarGiftCollections#981b91dd peer:InputPeer hash:long = payments.StarGiftCollections;\npayments.getUniqueStarGiftValueInfo#4365af6b slug:string = payments.UniqueStarGiftValueInfo;\npayments.checkCanSendGift#c0c4edc9 gift_id:long = payments.CheckCanSendGiftResult;\npayments.getStarGiftAuctionState#5c9ff4d6 auction:InputStarGiftAuction version:int = payments.StarGiftAuctionState;\npayments.getStarGiftAuctionAcquiredGifts#6ba2cbec gift_id:long = payments.StarGiftAuctionAcquiredGifts;\nphone.requestCall#42ff96ed flags:# video:flags.0?true user_id:InputUser random_id:int g_a_hash:bytes protocol:PhoneCallProtocol = phone.PhoneCall;\nphone.acceptCall#3bd2b4a0 peer:InputPhoneCall g_b:bytes protocol:PhoneCallProtocol = phone.PhoneCall;\nphone.confirmCall#2efe1722 peer:InputPhoneCall g_a:bytes key_fingerprint:long protocol:PhoneCallProtocol = phone.PhoneCall;\nphone.receivedCall#17d54f61 peer:InputPhoneCall = Bool;\nphone.discardCall#b2cbc1c0 flags:# video:flags.0?true peer:InputPhoneCall duration:int reason:PhoneCallDiscardReason connection_id:long = Updates;\nphone.setCallRating#59ead627 flags:# user_initiative:flags.0?true peer:InputPhoneCall rating:int comment:string = Updates;\nphone.saveCallDebug#277add7e peer:InputPhoneCall debug:DataJSON = Bool;\nphone.sendSignalingData#ff7a9383 peer:InputPhoneCall data:bytes = Bool;\nphone.createGroupCall#48cdc6d8 flags:# rtmp_stream:flags.2?true peer:InputPeer random_id:int title:flags.0?string schedule_date:flags.1?int = Updates;\nphone.joinGroupCall#8fb53057 flags:# muted:flags.0?true video_stopped:flags.2?true call:InputGroupCall join_as:InputPeer invite_hash:flags.1?string public_key:flags.3?int256 block:flags.3?bytes params:DataJSON = Updates;\nphone.leaveGroupCall#500377f9 call:InputGroupCall source:int = Updates;\nphone.discardGroupCall#7a777135 call:InputGroupCall = Updates;\nphone.getGroupCall#41845db call:InputGroupCall limit:int = phone.GroupCall;\nphone.getGroupParticipants#c558d8ab call:InputGroupCall ids:Vector<InputPeer> sources:Vector<int> offset:string limit:int = phone.GroupParticipants;\nphone.editGroupCallParticipant#a5273abf flags:# call:InputGroupCall participant:InputPeer muted:flags.0?Bool volume:flags.1?int raise_hand:flags.2?Bool video_stopped:flags.3?Bool video_paused:flags.4?Bool presentation_paused:flags.5?Bool = Updates;\nphone.exportGroupCallInvite#e6aa647f flags:# can_self_unmute:flags.0?true call:InputGroupCall = phone.ExportedGroupCallInvite;\nphone.toggleGroupCallStartSubscription#219c34e6 call:InputGroupCall subscribed:Bool = Updates;\nphone.joinGroupCallPresentation#cbea6bc4 call:InputGroupCall params:DataJSON = Updates;\nphone.leaveGroupCallPresentation#1c50d144 call:InputGroupCall = Updates;\nlangpack.getLangPack#f2f2330a lang_pack:string lang_code:string = LangPackDifference;\nlangpack.getStrings#efea3803 lang_pack:string lang_code:string keys:Vector<string> = Vector<LangPackString>;\nlangpack.getDifference#cd984aa5 lang_pack:string lang_code:string from_version:int = LangPackDifference;\nlangpack.getLanguages#42c6978f lang_pack:string = Vector<LangPackLanguage>;\nlangpack.getLanguage#6a596502 lang_pack:string lang_code:string = LangPackLanguage;\nfolders.editPeerFolders#6847d0ab folder_peers:Vector<InputFolderPeer> = Updates;\nstats.getBroadcastStats#ab42441a flags:# dark:flags.0?true channel:InputChannel = stats.BroadcastStats;\nstats.loadAsyncGraph#621d5fa0 flags:# token:string x:flags.0?long = StatsGraph;\nstats.getMegagroupStats#dcdf8607 flags:# dark:flags.0?true channel:InputChannel = stats.MegagroupStats;\nstats.getMessagePublicForwards#5f150144 channel:InputChannel msg_id:int offset:string limit:int = stats.PublicForwards;\nstats.getMessageStats#b6e0a3f5 flags:# dark:flags.0?true channel:InputChannel msg_id:int = stats.MessageStats;\nstats.getStoryStats#374fef40 flags:# dark:flags.0?true peer:InputPeer id:int = stats.StoryStats;\nstats.getStoryPublicForwards#a6437ef6 peer:InputPeer id:int offset:string limit:int = stats.PublicForwards;\nchatlists.exportChatlistInvite#8472478e chatlist:InputChatlist title:string peers:Vector<InputPeer> = chatlists.ExportedChatlistInvite;\nchatlists.deleteExportedInvite#719c5c5e chatlist:InputChatlist slug:string = Bool;\nchatlists.editExportedInvite#653db63d flags:# chatlist:InputChatlist slug:string title:flags.1?string peers:flags.2?Vector<InputPeer> = ExportedChatlistInvite;\nchatlists.getExportedInvites#ce03da83 chatlist:InputChatlist = chatlists.ExportedInvites;\nchatlists.checkChatlistInvite#41c10fff slug:string = chatlists.ChatlistInvite;\nchatlists.joinChatlistInvite#a6b1e39a slug:string peers:Vector<InputPeer> = Updates;\nchatlists.getLeaveChatlistSuggestions#fdbcd714 chatlist:InputChatlist = Vector<Peer>;\nchatlists.leaveChatlist#74fae13a chatlist:InputChatlist peers:Vector<InputPeer> = Updates;\nstories.editStory#b583ba46 flags:# peer:InputPeer id:int media:flags.0?InputMedia media_areas:flags.3?Vector<MediaArea> caption:flags.1?string entities:flags.1?Vector<MessageEntity> privacy_rules:flags.2?Vector<InputPrivacyRule> = Updates;\nstories.deleteStories#ae59db5f peer:InputPeer id:Vector<int> = Vector<int>;\nstories.togglePinned#9a75a1ef peer:InputPeer id:Vector<int> pinned:Bool = Vector<int>;\nstories.getAllStories#eeb0d625 flags:# next:flags.1?true hidden:flags.2?true state:flags.0?string = stories.AllStories;\nstories.getPinnedStories#5821a5dc peer:InputPeer offset_id:int limit:int = stories.Stories;\nstories.getStoriesArchive#b4352016 peer:InputPeer offset_id:int limit:int = stories.Stories;\nstories.getStoriesByID#5774ca74 peer:InputPeer id:Vector<int> = stories.Stories;\nstories.readStories#a556dac8 peer:InputPeer max_id:int = Vector<int>;\nstories.incrementStoryViews#b2028afb peer:InputPeer id:Vector<int> = Bool;\nstories.getStoryViewsList#7ed23c57 flags:# just_contacts:flags.0?true reactions_first:flags.2?true forwards_first:flags.3?true peer:InputPeer q:flags.1?string id:int offset:string limit:int = stories.StoryViewsList;\nstories.getStoriesViews#28e16cc8 peer:InputPeer id:Vector<int> = stories.StoryViews;\nstories.exportStoryLink#7b8def20 peer:InputPeer id:int = ExportedStoryLink;\nstories.report#19d8eb45 peer:InputPeer id:Vector<int> option:bytes message:string = ReportResult;\nstories.activateStealthMode#57bbd166 flags:# past:flags.0?true future:flags.1?true = Updates;\nstories.sendReaction#7fd736b2 flags:# add_to_recent:flags.0?true peer:InputPeer story_id:int reaction:Reaction = Updates;\nstories.getPeerStories#2c4ada50 peer:InputPeer = stories.PeerStories;\nstories.getPeerMaxIDs#78499170 id:Vector<InputPeer> = Vector<RecentStory>;\nstories.togglePeerStoriesHidden#bd0415c4 peer:InputPeer hidden:Bool = Bool;\nstories.togglePinnedToTop#b297e9b peer:InputPeer id:Vector<int> = Bool;\nstories.getAlbums#25b3eac7 peer:InputPeer hash:long = stories.Albums;\nstories.getAlbumStories#ac806d61 peer:InputPeer album_id:int offset:int limit:int = stories.Stories;\npremium.getBoostsList#60f67660 flags:# gifts:flags.0?true peer:InputPeer offset:string limit:int = premium.BoostsList;\npremium.getMyBoosts#be77b4a = premium.MyBoosts;\npremium.applyBoost#6b7da746 flags:# slots:flags.0?Vector<int> peer:InputPeer = premium.MyBoosts;\npremium.getBoostsStatus#42f1f61 peer:InputPeer = premium.BoostsStatus;\nfragment.getCollectibleInfo#be1e85ba collectible:InputCollectible = fragment.CollectibleInfo;`;","export default `resPQ#05162463 nonce:int128 server_nonce:int128 pq:string server_public_key_fingerprints:Vector<long> = ResPQ;\np_q_inner_data#83c95aec pq:string p:string q:string nonce:int128 server_nonce:int128 new_nonce:int256 = P_Q_inner_data;\np_q_inner_data_dc#a9f55f95 pq:string p:string q:string nonce:int128 server_nonce:int128 new_nonce:int256 dc:int = P_Q_inner_data;\np_q_inner_data_temp#3c6a84d4 pq:string p:string q:string nonce:int128 server_nonce:int128 new_nonce:int256 expires_in:int = P_Q_inner_data;\np_q_inner_data_temp_dc#56fddf88 pq:string p:string q:string nonce:int128 server_nonce:int128 new_nonce:int256 dc:int expires_in:int = P_Q_inner_data;\nserver_DH_params_fail#79cb045d nonce:int128 server_nonce:int128 new_nonce_hash:int128 = Server_DH_Params;\nserver_DH_params_ok#d0e8075c nonce:int128 server_nonce:int128 encrypted_answer:string = Server_DH_Params;\nserver_DH_inner_data#b5890dba nonce:int128 server_nonce:int128 g:int dh_prime:string g_a:string server_time:int = Server_DH_inner_data;\nclient_DH_inner_data#6643b654 nonce:int128 server_nonce:int128 retry_id:long g_b:string = Client_DH_Inner_Data;\ndh_gen_ok#3bcbf734 nonce:int128 server_nonce:int128 new_nonce_hash1:int128 = Set_client_DH_params_answer;\ndh_gen_retry#46dc1fb9 nonce:int128 server_nonce:int128 new_nonce_hash2:int128 = Set_client_DH_params_answer;\ndh_gen_fail#a69dae02 nonce:int128 server_nonce:int128 new_nonce_hash3:int128 = Set_client_DH_params_answer;\ndestroy_auth_key_ok#f660e1d4 = DestroyAuthKeyRes;\ndestroy_auth_key_none#0a9f2259 = DestroyAuthKeyRes;\ndestroy_auth_key_fail#ea109b13 = DestroyAuthKeyRes;\n---functions---\nreq_pq#60469778 nonce:int128 = ResPQ;\nreq_pq_multi#be7e8ef1 nonce:int128 = ResPQ;\nreq_pq_multi_new#51b410fd nonce:int128 = ResPQ;\nreq_DH_params#d712e4be nonce:int128 server_nonce:int128 p:string q:string public_key_fingerprint:long encrypted_data:string = Server_DH_Params;\nset_client_DH_params#f5045f1f nonce:int128 server_nonce:int128 encrypted_data:string = Set_client_DH_params_answer;\ndestroy_auth_key#d1435160 = DestroyAuthKeyRes;\n---types---\nmsgs_ack#62d6b459 msg_ids:Vector<long> = MsgsAck;\nbad_msg_notification#a7eff811 bad_msg_id:long bad_msg_seqno:int error_code:int = BadMsgNotification;\nbad_server_salt#edab447b bad_msg_id:long bad_msg_seqno:int error_code:int new_server_salt:long = BadMsgNotification;\nmsgs_state_req#da69fb52 msg_ids:Vector<long> = MsgsStateReq;\nmsgs_state_info#04deb57d req_msg_id:long info:string = MsgsStateInfo;\nmsgs_all_info#8cc0d131 msg_ids:Vector<long> info:string = MsgsAllInfo;\nmsg_detailed_info#276d3ec6 msg_id:long answer_msg_id:long bytes:int status:int = MsgDetailedInfo;\nmsg_new_detailed_info#809db6df answer_msg_id:long bytes:int status:int = MsgDetailedInfo;\nmsg_resend_req#7d861a08 msg_ids:Vector<long> = MsgResendReq;\nrpc_error#2144ca19 error_code:int error_message:string = RpcError;\nrpc_answer_unknown#5e2ad36e = RpcDropAnswer;\nrpc_answer_dropped_running#cd78e586 = RpcDropAnswer;\nrpc_answer_dropped#a43ad8b7 msg_id:long seq_no:int bytes:int = RpcDropAnswer;\nfuture_salt#0949d9dc valid_since:int valid_until:int salt:long = FutureSalt;\nfuture_salts#ae500895 req_msg_id:long now:int salts:vector<FutureSalt> = FutureSalts;\npong#347773c5 msg_id:long ping_id:long = Pong;\ndestroy_session_ok#e22045fc session_id:long = DestroySessionRes;\ndestroy_session_none#62d350c9 session_id:long = DestroySessionRes;\nnew_session_created#9ec20908 first_msg_id:long unique_id:long server_salt:long = NewSession;\nhttp_wait#9299359f max_delay:int wait_after:int max_wait:int = HttpWait;\nipPort#d433ad73 ipv4:int port:int = IpPort;\nipPortSecret#37982646 ipv4:int port:int secret:bytes = IpPort;\naccessPointRule#4679b65f phone_prefix_rules:string dc_id:int ips:vector<IpPort> = AccessPointRule;\nhelp.configSimple#5a592a6c date:int expires:int rules:vector<AccessPointRule> = help.ConfigSimple;\ntlsClientHello blocks:vector<TlsBlock> = TlsClientHello;\ntlsBlockString data:string = TlsBlock;\ntlsBlockRandom length:int = TlsBlock;\ntlsBlockZero length:int = TlsBlock;\ntlsBlockDomain = TlsBlock;\ntlsBlockGrease seed:int = TlsBlock;\ntlsBlockScope entries:Vector<TlsBlock> = TlsBlock;\n---functions---\nping#7abe77ec ping_id:long = Pong;\nping_delay_disconnect#f3427b8c ping_id:long disconnect_delay:int = Pong;`;","import type { Api } from '../tl';\n\n/**\n * Base class for all Remote Procedure Call errors.\n */\nexport class RPCError extends Error {\n  public code: number | undefined;\n\n  public errorMessage: string;\n\n  constructor(message: string, request: Api.AnyRequest, code?: number) {\n    super(\n      'RPCError {0}: {1}{2}'\n        .replace('{0}', code?.toString() || '')\n        .replace('{1}', message)\n        .replace('{2}', RPCError._fmtRequest(request)),\n    );\n    this.code = code;\n    this.errorMessage = message;\n  }\n\n  static _fmtRequest(request: Api.AnyRequest) {\n    // TODO fix this\n    if (request) {\n      return ` (caused by ${request.className})`;\n    } else {\n      return '';\n    }\n  }\n}\n\n/**\n * The request must be repeated, but directed to a different data center.\n */\nexport class InvalidDCError extends RPCError {\n  constructor(message: string, request: Api.AnyRequest, code?: number) {\n    super(message, request, code);\n    this.code = code || 303;\n    this.errorMessage = message || 'ERROR_SEE_OTHER';\n  }\n}\n\n/**\n * The query contains errors. In the event that a request was created\n * using a form and contains user generated data, the user should be\n * notified that the data must be corrected before the query is repeated.\n */\nexport class BadRequestError extends RPCError {\n  code = 400;\n\n  errorMessage = 'BAD_REQUEST';\n}\n\n/**\n * There was an unauthorized attempt to use functionality available only\n * to authorized users.\n */\nexport class UnauthorizedError extends RPCError {\n  code = 401;\n\n  errorMessage = 'UNAUTHORIZED';\n}\n\n/**\n * Privacy violation. For example, an attempt to write a message to\n * someone who has blacklisted the current user.\n */\nexport class ForbiddenError extends RPCError {\n  code = 403;\n\n  errorMessage = 'FORBIDDEN';\n}\n\n/**\n * An attempt to invoke a non-existent object, such as a method.\n */\nexport class NotFoundError extends RPCError {\n  code = 404;\n\n  errorMessage = 'NOT_FOUND';\n}\n\n/**\n * Errors related to invalid authorization key, like\n * AUTH_KEY_DUPLICATED which can cause the connection to fail.\n */\nexport class AuthKeyError extends RPCError {\n  code = 406;\n\n  errorMessage = 'AUTH_KEY';\n}\n\n/**\n * The maximum allowed number of attempts to invoke the given method\n * with the given input parameters has been exceeded. For example, in an\n * attempt to request a large number of text messages (SMS) for the same\n * phone number.\n */\nexport class FloodError extends RPCError {\n  code = 420;\n\n  errorMessage = 'FLOOD';\n}\n\n/**\n * An internal server error occurred while a request was being processed\n * for example, there was a disruption while accessing a database or file\n * storage\n */\nexport class ServerError extends RPCError {\n  code = 500; // Also witnessed as -500\n\n  errorMessage = 'INTERNAL';\n}\n\n/**\n * Clicking the inline buttons of bots that never (or take to long to)\n * call ``answerCallbackQuery`` will result in this \"special\" RPCError.\n */\nexport class TimedOutError extends RPCError {\n  code = 503; // Only witnessed as -503\n\n  errorMessage = 'Timeout';\n}\n","/* eslint-disable @stylistic/max-len */\nimport {\n  BadRequestError, FloodError, InvalidDCError, RPCError, TimedOutError,\n} from './RPCBaseErrors';\n\nexport class UserMigrateError extends InvalidDCError {\n  public newDc: number;\n\n  constructor(args: any) {\n    const newDc = Number(args.capture || 0);\n    super(`The user whose identity is being used to execute queries is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`, args.request);\n    this.message = `The user whose identity is being used to execute queries is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`;\n    this.newDc = newDc;\n  }\n}\n\nexport class PhoneMigrateError extends InvalidDCError {\n  public newDc: number;\n\n  constructor(args: any) {\n    const newDc = Number(args.capture || 0);\n    super(`The phone number a user is trying to use for authorization is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`, args.request);\n    this.message = `The phone number a user is trying to use for authorization is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`;\n    this.newDc = newDc;\n  }\n}\n\nexport class SlowModeWaitError extends FloodError {\n  public seconds: number;\n\n  constructor(args: any) {\n    const seconds = Number(args.capture || 0);\n    super(\n      `A wait of ${seconds} seconds is required before sending another message in this chat ${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `A wait of ${seconds} seconds is required before sending another message in this chat${RPCError._fmtRequest(args.request)}`;\n    this.seconds = seconds;\n  }\n}\n\nexport class FloodWaitError extends FloodError {\n  public seconds: number;\n\n  constructor(args: any) {\n    const seconds = Number(args.capture || 0);\n    super(\n      `A wait of ${seconds} seconds is required${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `A wait of ${seconds} seconds is required${RPCError._fmtRequest(args.request)}`;\n    this.seconds = seconds;\n  }\n}\n\nexport class FloodPremiumWaitError extends FloodWaitError {\n  constructor(args: any) {\n    const seconds = Number(args.capture || 0);\n    super(`A wait of ${seconds} seconds is required${RPCError._fmtRequest(args.request)}`);\n    this.message = `A wait of ${seconds} seconds is required${RPCError._fmtRequest(args.request)}`;\n    this.seconds = seconds;\n  }\n}\n\nexport class MsgWaitError extends FloodError {\n  constructor(args: any) {\n    super(\n      `Message failed to be sent.${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `Message failed to be sent.${RPCError._fmtRequest(\n      args.request,\n    )}`;\n  }\n}\n\nexport class FloodTestPhoneWaitError extends FloodError {\n  public seconds: number;\n\n  constructor(args: any) {\n    const seconds = Number(args.capture || 0);\n    super(\n      `A wait of ${seconds} seconds is required in the test servers${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `A wait of ${seconds} seconds is required in the test servers${RPCError._fmtRequest(args.request)}`;\n    this.seconds = seconds;\n  }\n}\n\nexport class FileMigrateError extends InvalidDCError {\n  public newDc: number;\n\n  constructor(args: any) {\n    const newDc = Number(args.capture || 0);\n    super(\n      `The file to be accessed is currently stored in DC ${newDc}${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `The file to be accessed is currently stored in DC ${newDc}${RPCError._fmtRequest(args.request)}`;\n    this.newDc = newDc;\n  }\n}\n\nexport class NetworkMigrateError extends InvalidDCError {\n  public newDc: number;\n\n  constructor(args: any) {\n    const newDc = Number(args.capture || 0);\n    super(\n      `The source IP address is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`,\n      args.request,\n    );\n    this.message = `The source IP address is associated with DC ${newDc}${RPCError._fmtRequest(args.request)}`;\n    this.newDc = newDc;\n  }\n}\n\nexport class EmailUnconfirmedError extends BadRequestError {\n  codeLength: number;\n\n  constructor(args: any) {\n    const codeLength = Number(args.capture || 0);\n    super(\n      `Email unconfirmed, the length of the code must be ${codeLength}${RPCError._fmtRequest(\n        args.request,\n      )}`,\n      args.request,\n      400,\n    );\n\n    this.message = `Email unconfirmed, the length of the code must be ${codeLength}${RPCError._fmtRequest(\n      args.request,\n    )}`;\n    this.codeLength = codeLength;\n  }\n}\n\nexport class PasswordFreshError extends BadRequestError {\n  public seconds: number;\n\n  constructor(args: any) {\n    const seconds = Number(args.capture || 0);\n    super(`The password was modified less than 24 hours ago, try again in ${seconds} seconds.`, args.request);\n\n    this.message = `The password was modified less than 24 hours ago, try again in ${seconds} seconds.`;\n    this.seconds = seconds;\n  }\n}\n\nexport class PasskeyLoginRequestedError extends Error {\n  public credentialJson: PublicKeyCredentialJSON;\n\n  constructor(credentialJson: PublicKeyCredentialJSON) {\n    super('Passkey login requested');\n    this.message = 'RESTART_AUTH_WITH_PASSKEY';\n    this.credentialJson = credentialJson;\n  }\n}\n\nexport class UserAlreadyAuthorizedError extends Error {\n  public userId: string;\n  constructor(userId: string) {\n    super('User already authorized');\n    this.message = 'USER_ALREADY_AUTHORIZED';\n    this.userId = userId;\n  }\n}\n\nexport class PasskeyCredentialNotFoundError extends RPCError {\n  constructor(args: any) {\n    super('PASSKEY_CREDENTIAL_NOT_FOUND', args.request);\n  }\n}\n\nexport const rpcErrorRe = new Map<RegExp, any>([\n  [/FILE_MIGRATE_(\\d+)/, FileMigrateError],\n  [/FLOOD_TEST_PHONE_WAIT_(\\d+)/, FloodTestPhoneWaitError],\n  [/FLOOD_WAIT_(\\d+)/, FloodWaitError],\n  [/FLOOD_PREMIUM_WAIT_(\\d+)/, FloodPremiumWaitError],\n  [/MSG_WAIT_(.*)/, MsgWaitError],\n  [/PHONE_MIGRATE_(\\d+)/, PhoneMigrateError],\n  [/SLOWMODE_WAIT_(\\d+)/, SlowModeWaitError],\n  [/USER_MIGRATE_(\\d+)/, UserMigrateError],\n  [/NETWORK_MIGRATE_(\\d+)/, NetworkMigrateError],\n  [/EMAIL_UNCONFIRMED_(\\d+)/, EmailUnconfirmedError],\n  [/PASSWORD_TOO_FRESH_(\\d+)/, PasswordFreshError],\n  [/^Timeout$/, TimedOutError],\n  [/PASSKEY_CREDENTIAL_NOT_FOUND/, PasskeyCredentialNotFoundError],\n]);\n","/**\n * Errors not related to the Telegram API itself\n */\n\nimport type { Api } from '../tl';\n\n/**\n * Occurs when a read operation was cancelled.\n */\nexport class ReadCancelledError extends Error {\n  constructor() {\n    super('The read operation was cancelled.');\n  }\n}\n\n/**\n * Occurs when a type is not found, for example,\n * when trying to read a TLObject with an invalid constructor code.\n */\nexport class TypeNotFoundError extends Error {\n  invalidConstructorId: number;\n\n  remaining: Buffer;\n\n  constructor(invalidConstructorId: number, remaining: Buffer) {\n    super(`Could not find a matching Constructor ID for the TLObject that was supposed to be\n        read with ID ${invalidConstructorId}. Most likely, a TLObject was trying to be read when\n         it should not be read. Remaining bytes: ${remaining.length}`);\n    if (typeof alert !== 'undefined') {\n      alert(`Missing MTProto Entity: Please, make sure to add TL definition for ID ${invalidConstructorId}`);\n    }\n    this.invalidConstructorId = invalidConstructorId;\n    this.remaining = remaining;\n  }\n}\n\n/**\n * Occurs when using the TCP full mode and the checksum of a received\n * packet doesn't match the expected checksum.\n */\nexport class InvalidChecksumError extends Error {\n  checksum: number;\n\n  validChecksum: number;\n\n  constructor(checksum: number, validChecksum: number) {\n    super(`Invalid checksum (${checksum} when ${validChecksum} was expected). This packet should be skipped.`);\n    this.checksum = checksum;\n    this.validChecksum = validChecksum;\n  }\n}\n\n/**\n * Occurs when the buffer is invalid, and may contain an HTTP error code.\n * For instance, 404 means \"forgotten/broken authorization key\", while\n */\nexport class InvalidBufferError extends Error {\n  code?: number;\n\n  payload: Buffer;\n\n  constructor(payload: Buffer) {\n    let code;\n    if (payload.length === 4) {\n      code = -payload.readInt32LE(0);\n      super(`Invalid response buffer (HTTP code ${code})`);\n    } else {\n      super(`Invalid response buffer (too short ${payload.toString()})`);\n    }\n    this.code = code;\n    this.payload = payload;\n  }\n}\n\n/**\n * Generic security error, mostly used when generating a new AuthKey.\n */\nexport class SecurityError extends Error {\n  constructor(...args: any[]) {\n    if (!args.length) {\n      args = ['A security check failed.'];\n    }\n    super(...args);\n  }\n}\n\n/**\n * Occurs when there's a hash mismatch between the decrypted CDN file\n * and its expected hash.\n */\nexport class CdnFileTamperedError extends SecurityError {\n  constructor() {\n    super('The CDN file has been altered and its download cancelled.');\n  }\n}\n\n/**\n * Occurs when handling a badMessageNotification\n */\nexport class BadMessageError extends Error {\n  static ErrorMessages: Record<number, string> = {\n    16:\n            'msg_id too low (most likely, client time is wrong it would be worthwhile to '\n            + 'synchronize it using msg_id notifications and re-send the original message '\n            + 'with the correct msg_id or wrap it in a container with a new msg_id if the '\n            + 'original message had waited too long on the client to be transmitted).',\n\n    17:\n            'msg_id too high (similar to the previous case, the client time has to be '\n            + 'synchronized, and the message re-sent with the correct msg_id).',\n\n    18:\n            'Incorrect two lower order msg_id bits (the server expects client message msg_id '\n            + 'to be divisible by 4).',\n\n    19: 'Container msg_id is the same as msg_id of a previously received message (this must never happen).',\n\n    20:\n            'Message too old, and it cannot be verified whether the server has received a '\n            + 'message with this msg_id or not.',\n\n    32:\n            'msg_seqno too low (the server has already received a message with a lower '\n            + 'msg_id but with either a higher or an equal and odd seqno).',\n\n    33:\n            'msg_seqno too high (similarly, there is a message with a higher msg_id but with '\n            + 'either a lower or an equal and odd seqno).',\n\n    34: 'An even msg_seqno expected (irrelevant message), but odd received.',\n\n    35: 'Odd msg_seqno expected (relevant message), but even received.',\n\n    48:\n            'Incorrect server salt (in this case, the bad_server_salt response is received with '\n            + 'the correct salt, and the message is to be re-sent with it).',\n\n    64: 'Invalid container.',\n  };\n\n  code: number;\n\n  errorMessage: string;\n\n  constructor(request: Api.AnyRequest, code: number) {\n    let errorMessage = BadMessageError.ErrorMessages[code]\n      || `Unknown error code (this should not happen): ${code}.`;\n    errorMessage += `  Caused by ${request.className}`;\n    super(errorMessage);\n    this.errorMessage = errorMessage;\n    this.code = code;\n  }\n}\n\n// TODO : Support multi errors.\n","import { inflate } from 'pako/dist/pako_inflate';\n\nimport type { BinaryReader } from '../../extensions';\n\nimport { serializeBytes } from '..';\n\nexport default class GZIPPacked {\n    static CONSTRUCTOR_ID = 0x3072cfa1;\n\n    static classType = 'constructor';\n\n    data: Buffer<ArrayBuffer>;\n\n    private CONSTRUCTOR_ID: number;\n\n    private classType: string;\n\n    constructor(data: Buffer<ArrayBuffer>) {\n        this.data = data;\n        this.CONSTRUCTOR_ID = 0x3072cfa1;\n        this.classType = 'constructor';\n    }\n\n    static async gzipIfSmaller(contentRelated: boolean, data: Buffer<ArrayBuffer>) {\n        if (contentRelated && data.length > 512) {\n            const gzipped = await new GZIPPacked(data).toBytes();\n            if (gzipped.length < data.length) {\n                return gzipped;\n            }\n        }\n        return data;\n    }\n\n    static gzip(input: Buffer<ArrayBuffer>) {\n        return Buffer.from(input);\n        // TODO this usually makes it faster for large requests\n        // return Buffer.from(deflate(input, { level: 9, gzip: true }))\n    }\n\n    static ungzip(input: Buffer) {\n        return Buffer.from(inflate(input));\n    }\n\n    async toBytes() {\n        const g = Buffer.alloc(4);\n        g.writeUInt32LE(GZIPPacked.CONSTRUCTOR_ID, 0);\n        return Buffer.concat([\n            g,\n            serializeBytes(await GZIPPacked.gzip(this.data)),\n        ]);\n    }\n\n    static read(reader: BinaryReader) {\n        const constructor = reader.readInt(false);\n        if (constructor !== GZIPPacked.CONSTRUCTOR_ID) {\n            throw new Error('not equal');\n        }\n        return GZIPPacked.gzip(reader.tgReadBytes());\n    }\n\n    static async fromReader(reader: BinaryReader) {\n        const data = reader.tgReadBytes();\n        return new GZIPPacked(await GZIPPacked.ungzip(data));\n    }\n}\n","export default class TLMessage {\n    static SIZE_OVERHEAD = 12;\n\n    static classType = 'constructor';\n\n    msgId: bigint;\n\n    private seqNo: number;\n\n    obj: any;\n\n    constructor(msgId: bigint, seqNo: number, obj: any) {\n        this.msgId = msgId;\n        this.seqNo = seqNo;\n        this.obj = obj;\n    }\n}\n","import type { BinaryReader } from '../../extensions';\n\nimport TLMessage from './TLMessage';\n\nexport default class MessageContainer {\n    static CONSTRUCTOR_ID = 0x73f1f8dc;\n\n    static classType = 'constructor';\n\n    // Maximum size in bytes for the inner payload of the container.\n    // Telegram will close the connection if the payload is bigger.\n    // The overhead of the container itself is subtracted.\n    static MAXIMUM_SIZE = 1044456 - 8;\n\n    // Maximum amount of messages that can't be sent inside a single\n    // container, inclusive. Beyond this limit Telegram will respond\n    // with BAD_MESSAGE 64 (invalid container).\n    //\n    // This limit is not 100% accurate and may in some cases be higher.\n    // However, sending up to 100 requests at once in a single container\n    // is a reasonable conservative value, since it could also depend on\n    // other factors like size per request, but we cannot know this.\n    static MAXIMUM_LENGTH = 100;\n\n    private CONSTRUCTOR_ID: number;\n\n    private messages: any[];\n\n    private classType: string;\n\n    constructor(messages: any[]) {\n        this.CONSTRUCTOR_ID = 0x73f1f8dc;\n        this.messages = messages;\n        this.classType = 'constructor';\n    }\n\n    static fromReader(reader: BinaryReader) {\n        const messages = [];\n        const totalLength = reader.readInt();\n        for (let x = 0; x < totalLength; x++) {\n            const msgId = reader.readLong();\n            const seqNo = reader.readInt();\n            const length = reader.readInt();\n            const before = reader.tellPosition();\n            const obj = reader.tgReadObject();\n            reader.setPosition(before + length);\n            const tlMessage = new TLMessage(msgId, seqNo, obj);\n            messages.push(tlMessage);\n        }\n        return new MessageContainer(messages);\n    }\n}\n","\nimport type { BinaryReader } from '../../extensions';\n\nimport Api from '../api';\n\nimport GZIPPacked from './GZIPPacked';\n\nexport default class RPCResult {\n    static CONSTRUCTOR_ID = 0xf35c6d01;\n\n    static classType = 'constructor';\n\n    private CONSTRUCTOR_ID: number;\n\n    private reqMsgId: bigint;\n\n    private body?: Buffer;\n\n    private error?: Api.RpcError;\n\n    private classType: string;\n\n    constructor(\n        reqMsgId: bigint,\n        body?: Buffer,\n        error?: Api.RpcError,\n    ) {\n        this.CONSTRUCTOR_ID = 0xf35c6d01;\n        this.reqMsgId = reqMsgId;\n        this.body = body;\n        this.error = error;\n        this.classType = 'constructor';\n    }\n\n    static async fromReader(reader: BinaryReader) {\n        const msgId = reader.readLong();\n        const innerCode = reader.readInt(false);\n        if (innerCode === Api.RpcError.CONSTRUCTOR_ID) {\n            return new RPCResult(\n                msgId,\n                undefined,\n                Api.RpcError.fromReader(reader),\n            );\n        }\n        if (innerCode === GZIPPacked.CONSTRUCTOR_ID) {\n            return new RPCResult(\n                msgId,\n                (await GZIPPacked.fromReader(reader)).data,\n            );\n        }\n        reader.seek(-4);\n        // This reader.read() will read more than necessary, but it's okay.\n        // We could make use of MessageContainer's length here, but since\n        // it's not necessary we don't need to care about it.\n        return new RPCResult(msgId, reader.read(), undefined);\n    }\n}\n","import GZIPPacked from './GZIPPacked';\nimport MessageContainer from './MessageContainer';\nimport RPCResult from './RPCResult';\nimport TLMessage from './TLMessage';\n\nexport const coreObjects = new Map<number, Function>([\n    [RPCResult.CONSTRUCTOR_ID, RPCResult],\n    [GZIPPacked.CONSTRUCTOR_ID, GZIPPacked],\n    [MessageContainer.CONSTRUCTOR_ID, MessageContainer],\n]);\nexport {\n    RPCResult,\n    TLMessage,\n    MessageContainer,\n    GZIPPacked,\n};\n","import { Api } from '.';\n\nconst tlobjects: Record<number, any> = {};\n\nfor (const tl of Object.values(Api)) {\n    if ('CONSTRUCTOR_ID' in tl) {\n        tlobjects[tl.CONSTRUCTOR_ID] = tl;\n    } else {\n        for (const sub of Object.values(tl)) {\n            tlobjects[sub.CONSTRUCTOR_ID] = sub;\n        }\n    }\n}\n\nexport const LAYER = 220;\n\nexport { tlobjects };\n","const closeError = new Error('HttpStream was closed');\nconst REQUEST_TIMEOUT = 10000;\n\nAbortSignal.timeout ??= function timeout(ms) {\n  const ctrl = new AbortController();\n  setTimeout(() => ctrl.abort(), ms);\n  return ctrl.signal;\n};\n\nexport default class HttpStream {\n  private url: string | undefined;\n\n  private isClosed: boolean;\n\n  private stream: Buffer<ArrayBuffer>[] = [];\n\n  private canRead: Promise<void> = Promise.resolve();\n\n  private resolveRead: VoidFunction | undefined;\n\n  private rejectRead: VoidFunction | undefined;\n\n  private disconnectedCallback: VoidFunction | undefined;\n\n  constructor(disconnectedCallback: VoidFunction) {\n    this.isClosed = true;\n    this.disconnectedCallback = disconnectedCallback;\n  }\n\n  async readExactly(number: number) {\n    let readData = Buffer.alloc(0);\n\n    while (true) {\n      const thisTime = await this.read();\n      readData = Buffer.concat([readData, thisTime]);\n      number -= thisTime.length;\n      if (number <= 0) {\n        return readData;\n      }\n    }\n  }\n\n  async read() {\n    await this.canRead;\n\n    const data = this.stream.shift()!;\n    if (this.stream.length === 0) {\n      this.canRead = new Promise((resolve, reject) => {\n        this.resolveRead = resolve;\n        this.rejectRead = reject;\n      });\n    }\n\n    return data;\n  }\n\n  static getURL(ip: string, port: number, isTestServer?: boolean, isPremium?: boolean) {\n    if (port === 443) {\n      return `https://${ip}:${port}/apiw1${isTestServer ? '_test' : ''}${isPremium ? '_premium' : ''}`;\n    } else {\n      return `http://${ip}:${port}/apiw1${isTestServer ? '_test' : ''}${isPremium ? '_premium' : ''}`;\n    }\n  }\n\n  async connect(port: number, ip: string, isTestServer = false, isPremium = false) {\n    this.stream = [];\n    this.canRead = new Promise((resolve, reject) => {\n      this.resolveRead = resolve;\n      this.rejectRead = reject;\n    });\n    this.url = HttpStream.getURL(ip, port, isTestServer, isPremium);\n\n    await fetch(this.url, {\n      method: 'POST',\n      body: Buffer.from([]),\n      mode: 'cors',\n      signal: AbortSignal.timeout(REQUEST_TIMEOUT),\n    });\n\n    this.isClosed = false;\n  }\n\n  write(data: Buffer<ArrayBuffer>) {\n    if (this.isClosed || !this.url) {\n      this.handleDisconnect();\n      throw closeError;\n    }\n\n    return fetch(this.url, {\n      method: 'POST',\n      body: data,\n      mode: 'cors',\n      signal: AbortSignal.timeout(REQUEST_TIMEOUT),\n    }).then(async (response) => {\n      if (this.isClosed) {\n        this.handleDisconnect();\n        return;\n      }\n      if (response.status !== 200) {\n        throw closeError;\n      }\n\n      const arrayBuffer = await response.arrayBuffer();\n\n      this.stream = this.stream.concat(Buffer.from(arrayBuffer));\n      if (this.resolveRead && !this.isClosed) this.resolveRead();\n    }).catch((err) => {\n      this.handleDisconnect();\n      throw err;\n    });\n  }\n\n  handleDisconnect() {\n    this.disconnectedCallback?.();\n    if (this.rejectRead) this.rejectRead();\n  }\n\n  close() {\n    this.isClosed = true;\n    this.handleDisconnect();\n    this.disconnectedCallback = undefined;\n  }\n}\n","export type LoggerLevel = 'error' | 'warn' | 'info' | 'debug';\n\nlet _level: LoggerLevel;\n\ntype ColorKey = LoggerLevel | 'start' | 'end';\n\nexport default class Logger {\n  static LEVEL_MAP = new Map<LoggerLevel, Set<LoggerLevel>>([\n    ['error', new Set(['error'])],\n    ['warn', new Set(['error', 'warn'])],\n    ['info', new Set(['error', 'warn', 'info'])],\n    ['debug', new Set(['error', 'warn', 'info', 'debug'])],\n  ]);\n\n  colors: Record<ColorKey, string>;\n\n  messageFormat: string;\n\n  constructor(level?: LoggerLevel) {\n    if (!_level) {\n      _level = level || 'debug';\n    }\n\n    this.colors = {\n      start: '%c',\n      warn: 'color : #ff00ff',\n      info: 'color : #ffff00',\n      debug: 'color : #00ffff',\n      error: 'color : #ff0000',\n      end: '',\n    };\n    this.messageFormat = '[%t] [%l] - [%m]';\n  }\n\n  static setLevel(level: LoggerLevel) {\n    _level = level;\n  }\n\n  canSend(level: LoggerLevel) {\n    if (!_level) return false;\n    return Logger.LEVEL_MAP.get(_level)!.has(level);\n  }\n\n  warn(message: string) {\n    this._log('warn', message, this.colors.warn);\n  }\n\n  info(message: string) {\n    this._log('info', message, this.colors.info);\n  }\n\n  debug(message: string) {\n    this._log('debug', message, this.colors.debug);\n  }\n\n  error(message: string) {\n    this._log('error', message, this.colors.error);\n  }\n\n  format(message: string, level: LoggerLevel) {\n    return this.messageFormat.replace('%t', new Date().toISOString())\n      .replace('%l', level.toUpperCase())\n      .replace('%m', message);\n  }\n\n  _log(level: LoggerLevel, message: string, color: string) {\n    if (!_level) {\n      return;\n    }\n    if (this.canSend(level)) {\n      // eslint-disable-next-line no-console\n      console.log(this.colors.start + this.format(message, level), color);\n    }\n  }\n}\n","import type MTProtoState from '../network/MTProtoState';\nimport type RequestState from '../network/RequestState';\nimport type Logger from './Logger';\n\nimport TLMessage from '../tl/core/TLMessage';\n\nimport MessageContainer from '../tl/core/MessageContainer';\nimport BinaryWriter from './BinaryWriter';\n\nconst USE_INVOKE_AFTER_WITH = new Set([\n  'messages.SendMessage', 'messages.SendMedia', 'messages.SendMultiMedia',\n  'messages.ForwardMessages', 'messages.SendInlineBotResult',\n]);\n\nexport default class MessagePacker {\n  private _state: MTProtoState;\n\n  public _pendingStates: RequestState[];\n\n  private _queue: (RequestState | undefined)[];\n\n  private _ready: Promise<unknown>;\n\n  setReady: ((value?: any) => void) | undefined;\n\n  private _log: Logger;\n\n  constructor(state: MTProtoState, logger: Logger) {\n    this._state = state;\n    this._queue = [];\n    this._pendingStates = [];\n    this._ready = new Promise((resolve) => {\n      this.setReady = resolve;\n    });\n    this._log = logger;\n  }\n\n  values() {\n    return this._queue;\n  }\n\n  clear() {\n    this._queue = [];\n    this.append(undefined);\n  }\n\n  append(state?: RequestState, setReady = true, atStart = false) {\n    // We need to check if there is already a `USE_INVOKE_AFTER_WITH` request\n    if (state && USE_INVOKE_AFTER_WITH.has(state.request.className)) {\n      if (atStart) {\n        // Assign `after` for the previously first `USE_INVOKE_AFTER_WITH` request\n        for (let i = 0; i < this._queue.length; i++) {\n          if (USE_INVOKE_AFTER_WITH.has(this._queue[i]?.request.className)) {\n            this._queue[i]!.after = state;\n            break;\n          }\n        }\n      } else {\n        // Assign after for the previous `USE_INVOKE_AFTER_WITH` request\n        for (let i = this._queue.length - 1; i >= 0; i--) {\n          if (USE_INVOKE_AFTER_WITH.has(this._queue[i]?.request.className)) {\n            state.after = this._queue[i];\n            break;\n          }\n        }\n      }\n    }\n\n    if (atStart) {\n      this._queue.unshift(state);\n    } else {\n      this._queue.push(state);\n    }\n\n    if (setReady) {\n      this.setReady?.(true);\n    }\n\n    // 1658238041=MsgsAck, we don't care about MsgsAck here because they never resolve anyway.\n    if (state && state.request.CONSTRUCTOR_ID !== 1658238041) {\n      this._pendingStates.push(state);\n      state.promise\n      // Using finally causes triggering `unhandledrejection` event\n        ?.catch(() => {\n        })\n        .finally(() => {\n          this._pendingStates = this._pendingStates.filter((s) => s !== state);\n        });\n    }\n  }\n\n  prepend(states: RequestState[]) {\n    states.reverse().forEach((state) => {\n      this.append(state, false, true);\n    });\n\n    this.setReady?.(true);\n  }\n\n  extend(states: RequestState[]) {\n    states.forEach((state) => {\n      this.append(state, false);\n    });\n    this.setReady?.(true);\n  }\n\n  async getBeacon(state: RequestState) {\n    const buffer = new BinaryWriter(Buffer.alloc(0));\n    const size = state.data.length + TLMessage.SIZE_OVERHEAD;\n    if (size <= MessageContainer.MAXIMUM_SIZE) {\n      let afterId;\n      if (state.after) {\n        afterId = state.after.msgId;\n      }\n      state.msgId = await this._state.writeDataAsMessage(\n        buffer, state.data, state.request.classType === 'request', afterId,\n      );\n      this._log.debug(`Assigned msgId = ${state.msgId.toString()} to ${state.request.className\n      || state.request.constructor.name}`);\n\n      return buffer.getValue();\n    }\n    this._log.warn(`Message payload for ${state.request.className\n    || state.request.constructor.name} is too long ${state.data.length} and cannot be sent`);\n    state.reject?.(new Error('Request Payload is too big'));\n\n    return undefined;\n  }\n\n  async wait() {\n    if (!this._queue.length) {\n      this._ready = new Promise((resolve) => {\n        this.setReady = resolve;\n      });\n      await this._ready;\n    }\n  }\n\n  async get() {\n    if (!this._queue[this._queue.length - 1]) {\n      this._queue = this._queue.filter(Boolean);\n      return undefined;\n    }\n    let data;\n    let buffer = new BinaryWriter(Buffer.alloc(0));\n\n    const batch = [];\n    let size = 0;\n\n    while (this._queue.length && batch.length <= MessageContainer.MAXIMUM_LENGTH) {\n      const state = this._queue.shift();\n      if (!state) {\n        continue;\n      }\n\n      if (state.abortSignal?.aborted) {\n        state.reject?.(new Error('Request aborted'));\n        continue;\n      }\n\n      size += state.data.length + TLMessage.SIZE_OVERHEAD;\n      if (size <= MessageContainer.MAXIMUM_SIZE) {\n        let afterId;\n        if (state.after) {\n          afterId = state.after.msgId;\n        }\n        state.msgId = await this._state.writeDataAsMessage(\n          buffer, state.data, state.request.classType === 'request', afterId,\n        );\n        this._log.debug(`Assigned msgId = ${state.msgId.toString()} to ${state.request.className\n        || state.request.constructor.name}`);\n        batch.push(state);\n        continue;\n      }\n\n      if (batch.length) {\n        this._queue.unshift(state);\n        break;\n      }\n\n      this._log.warn(`Message payload for ${state.request.className\n      || state.request.constructor.name} is too long ${state.data.length} and cannot be sent`);\n      state.reject?.(new Error('Request Payload is too big'));\n      size = 0;\n    }\n    if (!batch.length) {\n      return undefined;\n    }\n    if (batch.length > 1) {\n      const b = Buffer.alloc(8);\n      b.writeUInt32LE(MessageContainer.CONSTRUCTOR_ID, 0);\n      b.writeInt32LE(batch.length, 4);\n      data = Buffer.concat([b, buffer.getValue()]);\n      buffer = new BinaryWriter(Buffer.alloc(0));\n      const containerId = await this._state.writeDataAsMessage(\n        buffer, data, false,\n      );\n      for (const s of batch) {\n        s.containerId = containerId;\n      }\n    }\n\n    data = buffer.getValue();\n    return {\n      batch,\n      data,\n    };\n  }\n}\n","const E_TIMEOUT = new Error('timeout while waiting for mutex to become available');\nconst E_ALREADY_LOCKED = new Error('mutex already locked');\nconst E_CANCELED = new Error('request for lock canceled');\n\nvar __awaiter$2 = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass Semaphore {\n    constructor(_value, _cancelError = E_CANCELED) {\n        this._value = _value;\n        this._cancelError = _cancelError;\n        this._queue = [];\n        this._weightedWaiters = [];\n    }\n    acquire(weight = 1, priority = 0) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        return new Promise((resolve, reject) => {\n            const task = { resolve, reject, weight, priority };\n            const i = findIndexFromEnd(this._queue, (other) => priority <= other.priority);\n            if (i === -1 && weight <= this._value) {\n                // Needs immediate dispatch, skip the queue\n                this._dispatchItem(task);\n            }\n            else {\n                this._queue.splice(i + 1, 0, task);\n            }\n        });\n    }\n    runExclusive(callback_1) {\n        return __awaiter$2(this, arguments, void 0, function* (callback, weight = 1, priority = 0) {\n            const [value, release] = yield this.acquire(weight, priority);\n            try {\n                return yield callback(value);\n            }\n            finally {\n                release();\n            }\n        });\n    }\n    waitForUnlock(weight = 1, priority = 0) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        if (this._couldLockImmediately(weight, priority)) {\n            return Promise.resolve();\n        }\n        else {\n            return new Promise((resolve) => {\n                if (!this._weightedWaiters[weight - 1])\n                    this._weightedWaiters[weight - 1] = [];\n                insertSorted(this._weightedWaiters[weight - 1], { resolve, priority });\n            });\n        }\n    }\n    isLocked() {\n        return this._value <= 0;\n    }\n    getValue() {\n        return this._value;\n    }\n    setValue(value) {\n        this._value = value;\n        this._dispatchQueue();\n    }\n    release(weight = 1) {\n        if (weight <= 0)\n            throw new Error(`invalid weight ${weight}: must be positive`);\n        this._value += weight;\n        this._dispatchQueue();\n    }\n    cancel() {\n        this._queue.forEach((entry) => entry.reject(this._cancelError));\n        this._queue = [];\n    }\n    _dispatchQueue() {\n        this._drainUnlockWaiters();\n        while (this._queue.length > 0 && this._queue[0].weight <= this._value) {\n            this._dispatchItem(this._queue.shift());\n            this._drainUnlockWaiters();\n        }\n    }\n    _dispatchItem(item) {\n        const previousValue = this._value;\n        this._value -= item.weight;\n        item.resolve([previousValue, this._newReleaser(item.weight)]);\n    }\n    _newReleaser(weight) {\n        let called = false;\n        return () => {\n            if (called)\n                return;\n            called = true;\n            this.release(weight);\n        };\n    }\n    _drainUnlockWaiters() {\n        if (this._queue.length === 0) {\n            for (let weight = this._value; weight > 0; weight--) {\n                const waiters = this._weightedWaiters[weight - 1];\n                if (!waiters)\n                    continue;\n                waiters.forEach((waiter) => waiter.resolve());\n                this._weightedWaiters[weight - 1] = [];\n            }\n        }\n        else {\n            const queuedPriority = this._queue[0].priority;\n            for (let weight = this._value; weight > 0; weight--) {\n                const waiters = this._weightedWaiters[weight - 1];\n                if (!waiters)\n                    continue;\n                const i = waiters.findIndex((waiter) => waiter.priority <= queuedPriority);\n                (i === -1 ? waiters : waiters.splice(0, i))\n                    .forEach((waiter => waiter.resolve()));\n            }\n        }\n    }\n    _couldLockImmediately(weight, priority) {\n        return (this._queue.length === 0 || this._queue[0].priority < priority) &&\n            weight <= this._value;\n    }\n}\nfunction insertSorted(a, v) {\n    const i = findIndexFromEnd(a, (other) => v.priority <= other.priority);\n    a.splice(i + 1, 0, v);\n}\nfunction findIndexFromEnd(a, predicate) {\n    for (let i = a.length - 1; i >= 0; i--) {\n        if (predicate(a[i])) {\n            return i;\n        }\n    }\n    return -1;\n}\n\nvar __awaiter$1 = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nclass Mutex {\n    constructor(cancelError) {\n        this._semaphore = new Semaphore(1, cancelError);\n    }\n    acquire() {\n        return __awaiter$1(this, arguments, void 0, function* (priority = 0) {\n            const [, releaser] = yield this._semaphore.acquire(1, priority);\n            return releaser;\n        });\n    }\n    runExclusive(callback, priority = 0) {\n        return this._semaphore.runExclusive(() => callback(), 1, priority);\n    }\n    isLocked() {\n        return this._semaphore.isLocked();\n    }\n    waitForUnlock(priority = 0) {\n        return this._semaphore.waitForUnlock(1, priority);\n    }\n    release() {\n        if (this._semaphore.isLocked())\n            this._semaphore.release();\n    }\n    cancel() {\n        return this._semaphore.cancel();\n    }\n}\n\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nfunction withTimeout(sync, timeout, timeoutError = E_TIMEOUT) {\n    return {\n        acquire: (weightOrPriority, priority) => {\n            let weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(`invalid weight ${weight}: must be positive`);\n            }\n            return new Promise((resolve, reject) => __awaiter(this, void 0, void 0, function* () {\n                let isTimeout = false;\n                const handle = setTimeout(() => {\n                    isTimeout = true;\n                    reject(timeoutError);\n                }, timeout);\n                try {\n                    const ticket = yield (isSemaphore(sync)\n                        ? sync.acquire(weight, priority)\n                        : sync.acquire(priority));\n                    if (isTimeout) {\n                        const release = Array.isArray(ticket) ? ticket[1] : ticket;\n                        release();\n                    }\n                    else {\n                        clearTimeout(handle);\n                        resolve(ticket);\n                    }\n                }\n                catch (e) {\n                    if (!isTimeout) {\n                        clearTimeout(handle);\n                        reject(e);\n                    }\n                }\n            }));\n        },\n        runExclusive(callback, weight, priority) {\n            return __awaiter(this, void 0, void 0, function* () {\n                let release = () => undefined;\n                try {\n                    const ticket = yield this.acquire(weight, priority);\n                    if (Array.isArray(ticket)) {\n                        release = ticket[1];\n                        return yield callback(ticket[0]);\n                    }\n                    else {\n                        release = ticket;\n                        return yield callback();\n                    }\n                }\n                finally {\n                    release();\n                }\n            });\n        },\n        release(weight) {\n            sync.release(weight);\n        },\n        cancel() {\n            return sync.cancel();\n        },\n        waitForUnlock: (weightOrPriority, priority) => {\n            let weight;\n            if (isSemaphore(sync)) {\n                weight = weightOrPriority;\n            }\n            else {\n                weight = undefined;\n                priority = weightOrPriority;\n            }\n            if (weight !== undefined && weight <= 0) {\n                throw new Error(`invalid weight ${weight}: must be positive`);\n            }\n            return new Promise((resolve, reject) => {\n                const handle = setTimeout(() => reject(timeoutError), timeout);\n                (isSemaphore(sync)\n                    ? sync.waitForUnlock(weight, priority)\n                    : sync.waitForUnlock(priority)).then(() => {\n                    clearTimeout(handle);\n                    resolve();\n                });\n            });\n        },\n        isLocked: () => sync.isLocked(),\n        getValue: () => sync.getValue(),\n        setValue: (value) => sync.setValue(value),\n    };\n}\nfunction isSemaphore(sync) {\n    return sync.getValue !== undefined;\n}\n\n// eslint-disable-next-lisne @typescript-eslint/explicit-module-boundary-types\nfunction tryAcquire(sync, alreadyAcquiredError = E_ALREADY_LOCKED) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return withTimeout(sync, 0, alreadyAcquiredError);\n}\n\nexport { E_ALREADY_LOCKED, E_CANCELED, E_TIMEOUT, Mutex, Semaphore, tryAcquire, withTimeout };\n","import { Mutex } from 'async-mutex';\n\nconst mutex = new Mutex();\n\nconst closeError = new Error('WebSocket was closed');\nconst CONNECTION_TIMEOUT = 3000;\nconst MAX_TIMEOUT = 30000;\n\nexport default class PromisedWebSockets {\n  private closed: boolean;\n\n  private timeout: number;\n\n  private stream: Buffer;\n\n  private canRead?: boolean | Promise<boolean>;\n\n  private resolveRead: ((value?: any) => void) | undefined;\n\n  private client: WebSocket | undefined;\n\n  private website?: string;\n\n  private disconnectedCallback: () => void;\n\n  constructor(disconnectedCallback: () => void) {\n    this.client = undefined;\n    this.closed = true;\n    this.stream = Buffer.alloc(0);\n    this.disconnectedCallback = disconnectedCallback;\n    this.timeout = CONNECTION_TIMEOUT;\n  }\n\n  async readExactly(number: number) {\n    let readData = Buffer.alloc(0);\n\n    while (true) {\n      const thisTime = await this.read(number);\n      readData = Buffer.concat([readData, thisTime]);\n      number -= thisTime.length;\n      if (!number) {\n        return readData;\n      }\n    }\n  }\n\n  async read(number: number) {\n    if (this.closed) {\n      throw closeError;\n    }\n    await this.canRead;\n    if (this.closed) {\n      throw closeError;\n    }\n    const toReturn = this.stream.slice(0, number);\n    this.stream = this.stream.slice(number);\n    if (this.stream.length === 0) {\n      this.canRead = new Promise((resolve) => {\n        this.resolveRead = resolve;\n      });\n    }\n\n    return toReturn;\n  }\n\n  async readAll() {\n    if (this.closed || !await this.canRead) {\n      throw closeError;\n    }\n    const toReturn = this.stream;\n    this.stream = Buffer.alloc(0);\n    this.canRead = new Promise((resolve) => {\n      this.resolveRead = resolve;\n    });\n\n    return toReturn;\n  }\n\n  getWebSocketLink(ip: string, port: number, isTestServer?: boolean, isPremium?: boolean) {\n    if (port === 443) {\n      return `wss://${ip}:${port}/apiws${isTestServer ? '_test' : ''}${isPremium ? '_premium' : ''}`;\n    } else {\n      return `ws://${ip}:${port}/apiws${isTestServer ? '_test' : ''}${isPremium ? '_premium' : ''}`;\n    }\n  }\n\n  connect(port: number, ip: string, isTestServer = false, isPremium = false) {\n    this.stream = Buffer.alloc(0);\n    this.canRead = new Promise((resolve) => {\n      this.resolveRead = resolve;\n    });\n    this.closed = false;\n    this.website = this.getWebSocketLink(ip, port, isTestServer, isPremium);\n    this.client = new WebSocket(this.website, 'binary');\n    return new Promise((resolve, reject) => {\n      if (!this.client) return;\n      let hasResolved = false;\n      let timeout: ReturnType<typeof globalThis.setTimeout> | undefined;\n      this.client.onopen = () => {\n        this.receive();\n        resolve(this);\n        hasResolved = true;\n        if (timeout) clearTimeout(timeout);\n      };\n      this.client.onerror = (error) => {\n        // eslint-disable-next-line no-console\n        console.error('WebSocket error', error);\n        reject(error);\n        hasResolved = true;\n        if (timeout) clearTimeout(timeout);\n      };\n      this.client.onclose = (event) => {\n        const { code, reason, wasClean } = event;\n        if (code !== 1000) {\n          // eslint-disable-next-line no-console\n          console.error(`Socket ${ip} closed. Code: ${code}, reason: ${reason}, was clean: ${wasClean}`);\n        }\n\n        this.resolveRead?.(false);\n        this.closed = true;\n        if (this.disconnectedCallback) {\n          this.disconnectedCallback();\n        }\n        hasResolved = true;\n        if (timeout) clearTimeout(timeout);\n      };\n\n      timeout = setTimeout(() => {\n        if (hasResolved) return;\n\n        reject(new Error('WebSocket connection timeout'));\n        this.resolveRead?.(false);\n        this.closed = true;\n        if (this.disconnectedCallback) {\n          this.disconnectedCallback();\n        }\n        this.client?.close();\n        this.timeout *= 2;\n        this.timeout = Math.min(this.timeout, MAX_TIMEOUT);\n        timeout = undefined;\n      }, this.timeout);\n\n      // CONTEST\n      // Seems to not be working, at least in a web worker\n\n      self.addEventListener('offline', () => {\n        this.close();\n        this.resolveRead?.(false);\n      });\n    });\n  }\n\n  write(data: Buffer<ArrayBuffer>) {\n    if (this.closed) {\n      throw closeError;\n    }\n    this.client?.send(data);\n  }\n\n  close() {\n    this.client?.close();\n    this.closed = true;\n  }\n\n  receive() {\n    if (!this.client) return;\n    this.client.onmessage = async (message) => {\n      await mutex.runExclusive(async () => {\n        const data = message.data instanceof ArrayBuffer\n          ? Buffer.from(message.data)\n          : Buffer.from(await new Response(message.data).arrayBuffer());\n        this.stream = Buffer.concat([this.stream, data]);\n        this.resolveRead?.(true);\n      });\n    };\n  }\n}\n","import type { PromisedWebSockets } from '../../extensions';\n\nimport { readBufferFromBigInt } from '../../Helpers';\nimport { Connection, PacketCodec } from './Connection';\n\nexport class AbridgedPacketCodec extends PacketCodec {\n  static tag = Buffer.from('ef', 'hex');\n\n  static obfuscateTag = Buffer.from('efefefef', 'hex');\n\n  private tag: Buffer;\n\n  obfuscateTag: Buffer;\n\n  constructor(props: any) {\n    super(props);\n    this.tag = AbridgedPacketCodec.tag;\n    this.obfuscateTag = AbridgedPacketCodec.obfuscateTag;\n  }\n\n  encodePacket(data: Buffer) {\n    const length = data.length >> 2;\n    let temp;\n    if (length < 127) {\n      const b = Buffer.alloc(1);\n      b.writeUInt8(length, 0);\n      temp = b;\n    } else {\n      temp = Buffer.concat([Buffer.from('7f', 'hex'), readBufferFromBigInt(BigInt(length), 3)]);\n    }\n    return Buffer.concat([temp, data]);\n  }\n\n  async readPacket(reader: PromisedWebSockets) {\n    const readData = await reader.read(1);\n    let length = readData[0];\n    if (length >= 127) {\n      length = Buffer.concat([await reader.read(3), Buffer.alloc(1)])\n        .readInt32LE(0);\n    }\n\n    return reader.read(length << 2);\n  }\n}\n\n/**\n * This is the mode with the lowest overhead, as it will\n * only require 1 byte if the packet length is less than\n * 508 bytes (127 << 2, which is very common).\n */\nexport class ConnectionTCPAbridged extends Connection {\n  PacketCodecClass = AbridgedPacketCodec;\n}\n","import {\n  generateRandomBytes,\n  modExp,\n  readBigIntFromBuffer,\n  readBufferFromBigInt,\n  sha1,\n} from '../Helpers';\n\nexport const SERVER_KEYS = [\n  {\n    fingerprint: BigInt('-3414540481677951611'),\n    n: BigInt(\n      '2937959817066933702298617714945612856538843112005886376816255642404751219133084745514657634448776440866'\n      + '1701890505066208632169112269581063774293102577308490531282748465986139880977280302242772832972539403531'\n      + '3160108704012876427630091361567343395380424193887227773571344877461690935390938502512438971889287359033'\n      + '8945177273024525306296338410881284207988753897636046529094613963869149149606209957083647645485599631919'\n      + '2747663615955633778034897140982517446405334423701359108810182097749467210509584293428076654573384828809'\n      + '574217079944388301239431309115013843331317877374435868468779972014486325557807783825502498215169806323',\n    ),\n    e: 65537,\n  },\n  {\n    fingerprint: BigInt('-5595554452916591101'),\n    n: BigInt(\n      '2534288944884041556497168959071347320689884775908477905258202659454602246385394058588521595116849196570'\n      + '8222649399180603818074200620463776135424884632162512403163793083921641631564740959529419359595852941166'\n      + '8489405859523376133330223960965841179548922160312292373029437018775884567383353986024616752250817918203'\n      + '9315375750495263623495132323782003654358104782690612092797248736680529211579223142368426126233039432475'\n      + '0785450942589751755390156647751460719351439969059949569615302809050721500330239005077889855323917509948'\n      + '255722081644689442127297605422579707142646660768825302832201908302295573257427896031830742328565032949',\n    ),\n    e: 65537,\n  },\n].reduce((acc, { fingerprint, ...keyInfo }) => {\n  acc.set(fingerprint, keyInfo);\n  return acc;\n}, new Map<bigint, { n: bigint; e: number }>());\n\n/**\n * Encrypts the given data known the fingerprint to be used\n * in the way Telegram requires us to do so (sha1(data) + data + padding)\n\n * @param fingerprint the fingerprint of the RSA key.\n * @param data the data to be encrypted.\n * @returns {Buffer|*|undefined} the cipher text, or undefined if no key matching this fingerprint is found.\n */\nexport async function encrypt(fingerprint: bigint, data: Buffer) {\n  const key = SERVER_KEYS.get(fingerprint);\n  if (!key) {\n    return undefined;\n  }\n\n  // len(sha1.digest) is always 20, so we're left with 255 - 20 - x padding\n  const rand = generateRandomBytes(235 - data.length);\n\n  const toEncrypt = Buffer.concat([await sha1(data), data, rand]);\n\n  // rsa module rsa.encrypt adds 11 bits for padding which we don't want\n  // rsa module uses rsa.transform.bytes2int(to_encrypt), easier way:\n  const payload = readBigIntFromBuffer(toEncrypt, false);\n  const encrypted = modExp(payload, BigInt(key.e), key.n);\n  // rsa module uses transform.int2bytes(encrypted, keylength), easier:\n  return readBufferFromBigInt(encrypted, 256, false);\n}\n","import type { Entity } from './types';\n\nimport { Api } from './tl';\n\n// eslint-disable-next-line @stylistic/max-len\nconst JPEG_HEADER = Buffer.from('ffd8ffe000104a46494600010100000100010000ffdb004300281c1e231e19282321232d2b28303c64413c37373c7b585d4964918099968f808c8aa0b4e6c3a0aadaad8a8cc8ffcbdaeef5ffffff9bc1fffffffaffe6fdfff8ffdb0043012b2d2d3c353c76414176f8a58ca5f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8ffc00011080000000003012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00', 'hex');\nconst JPEG_FOOTER = Buffer.from('ffd9', 'hex');\n\nfunction _raiseCastFail(entity: any, target: string) {\n  throw new Error(`Cannot cast ${entity.className} to any kind of ${target}`);\n}\n\n/**\n Gets the input peer for the given \"entity\" (user, chat or channel).\n\n A ``TypeError`` is raised if the given entity isn't a supported type\n or if ``check_hash is True`` but the entity's ``accessHash is None``\n *or* the entity contains ``min`` information. In this case, the hash\n cannot be used for general purposes, and thus is not returned to avoid\n any issues which can derive from invalid access hashes.\n\n Note that ``check_hash`` **is ignored** if an input peer is already\n passed since in that case we assume the user knows what they're doing.\n This is key to getting entities by explicitly passing ``hash = 0``.\n\n * @param entity\n * @param allowSelf\n * @param checkHash\n */\nexport function getInputPeer(\n  entity: Entity, allowSelf = true, checkHash = true,\n): Api.TypeInputPeer {\n  if (entity instanceof Api.User) {\n    if (entity.self && allowSelf) {\n      return new Api.InputPeerSelf();\n    } else if (entity.accessHash !== undefined || !checkHash) {\n      return new Api.InputPeerUser({\n        userId: entity.id,\n        accessHash: entity.accessHash!,\n      });\n    } else {\n      throw new Error('User without accessHash or min info cannot be input');\n    }\n  }\n  if (entity instanceof Api.Chat || entity instanceof Api.ChatEmpty\n    || entity instanceof Api.ChatForbidden) {\n    return new Api.InputPeerChat({ chatId: entity.id });\n  }\n  if (entity instanceof Api.Channel) {\n    if (entity.accessHash !== undefined || !checkHash) {\n      return new Api.InputPeerChannel({\n        channelId: entity.id,\n        accessHash: entity.accessHash!,\n      });\n    } else {\n      throw new TypeError('Channel without accessHash or min info cannot be input');\n    }\n  }\n  if (entity instanceof Api.ChannelForbidden) {\n    // \"channelForbidden are never min\", and since their hash is\n    // also not optional, we assume that this truly is the case.\n    return new Api.InputPeerChannel({\n      channelId: entity.id,\n      accessHash: entity.accessHash,\n    });\n  }\n\n  if (entity instanceof Api.UserEmpty) {\n    return new Api.InputPeerEmpty();\n  }\n\n  _raiseCastFail(entity, 'InputPeer');\n  return new Api.InputPeerEmpty();\n}\n\n/**\n * Adds the JPG header and footer to a stripped image.\n * Ported from https://github.com/telegramdesktop/\n * tdesktop/blob/bec39d89e19670eb436dc794a8f20b657cb87c71/Telegram/SourceFiles/ui/image/image.cpp#L225\n\n * @param stripped{Buffer}\n * @returns {Buffer}\n */\nexport function strippedPhotoToJpg(stripped: Buffer<ArrayBuffer>): Buffer<ArrayBuffer> {\n  // Note: Changes here should update _stripped_real_length\n  if (stripped.length < 3 || stripped[0] !== 1) {\n    return stripped;\n  }\n  const header = Buffer.from(JPEG_HEADER);\n  header[164] = stripped[1];\n  header[166] = stripped[2];\n  return Buffer.concat([header, stripped.slice(3), JPEG_FOOTER]);\n}\n\n/**\n * Gets the appropriated part size when downloading files,\n * given an initial file size.\n * @param fileSize\n * @returns {Number}\n */\nexport function getDownloadPartSize(fileSize: number) {\n  if (fileSize <= 65536) { // 64KB\n    return 64;\n  }\n  if (fileSize <= 104857600) { // 100MB\n    return 128;\n  }\n  if (fileSize <= 786432000) { // 750MB\n    return 256;\n  }\n  if (fileSize <= 2097152000) { // 2000MB\n    return 512;\n  }\n  if (fileSize <= 4194304000) { // 4000MB\n    return 1024;\n  }\n\n  throw new Error('File size too large');\n}\n\n/**\n * Gets the appropriated part size when uploading files,\n * given an initial file size.\n * @param fileSize\n * @returns {Number}\n */\nexport function getUploadPartSize(fileSize: number) {\n  if (fileSize <= 104857600) { // 100MB\n    return 128;\n  }\n  if (fileSize <= 786432000) { // 750MB\n    return 256;\n  }\n  if (fileSize <= 2097152000) { // 2000MB\n    return 512;\n  }\n  if (fileSize <= 4194304000) { // 4000MB\n    return 512;\n  }\n\n  throw new Error('File size too large');\n}\n\nexport function getMessageId(message: number | Api.TypeMessage) {\n  if (message === undefined) {\n    return undefined;\n  }\n  if (typeof message === 'number') {\n    return message;\n  }\n  if (message.SUBCLASS_OF_ID === 0x790009e3) { // crc32(b'Message')\n    return message.id;\n  }\n  throw new Error(`Invalid message type: ${message.constructor.name}`);\n}\n\n/**\n * Gets the display name for the given :tl:`User`,\n :tl:`Chat` or :tl:`Channel`. Returns an empty string otherwise\n * @param entity\n */\nexport function getDisplayName(entity: Entity) {\n  if (entity instanceof Api.User) {\n    if (entity.lastName && entity.firstName) {\n      return `${entity.firstName} ${entity.lastName}`;\n    } else if (entity.firstName) {\n      return entity.firstName;\n    } else if (entity.lastName) {\n      return entity.lastName;\n    } else {\n      return '';\n    }\n  } else if (entity instanceof Api.Chat || entity instanceof Api.Channel) {\n    return entity.title;\n  }\n  return '';\n}\n\n/**\n * Returns the appropriate DC based on the id\n * @param dcId the id of the DC.\n * @param downloadDC whether to use -1 DCs or not\n * (These only support downloading/uploading and not creating a new AUTH key)\n * @return {{port: number, ipAddress: string, id: number}}\n */\nexport function getDC(dcId: number, downloadDC = false) {\n  // TODO Move to external config\n  switch (dcId) {\n    case 1:\n      return {\n        id: 1,\n        ipAddress: `zws1${downloadDC ? '-1' : ''}.web.telegram.org`,\n        port: 443,\n      };\n    case 2:\n      return {\n        id: 2,\n        ipAddress: `zws2${downloadDC ? '-1' : ''}.web.telegram.org`,\n        port: 443,\n      };\n    case 3:\n      return {\n        id: 3,\n        ipAddress: `zws3${downloadDC ? '-1' : ''}.web.telegram.org`,\n        port: 443,\n      };\n    case 4:\n      return {\n        id: 4,\n        ipAddress: `zws4${downloadDC ? '-1' : ''}.web.telegram.org`,\n        port: 443,\n      };\n    case 5:\n      return {\n        id: 5,\n        ipAddress: `zws5${downloadDC ? '-1' : ''}.web.telegram.org`,\n        port: 443,\n      };\n    default:\n      throw new Error(`Cannot find the DC with the ID of ${dcId}`);\n  }\n  // TODO chose based on current connection method\n  /*\n    if (!this._config) {\n        this._config = await this.invoke(new requests.help.GetConfig())\n    }\n    if (cdn && !this._cdnConfig) {\n        this._cdnConfig = await this.invoke(new requests.help.GetCdnConfig())\n        for (const pk of this._cdnConfig.publicKeys) {\n            addKey(pk.publicKey)\n        }\n    }\n    for (const DC of this._config.dcOptions) {\n        if (DC.id === dcId && Boolean(DC.ipv6) === this._useIPV6 && Boolean(DC.cdn) === cdn) {\n            return DC\n        }\n    } */\n}\n","import { Api as GramJs } from '../../lib/gramjs';\n\nimport { DEBUG } from '../../config';\nimport { DATA_BROADCAST_CHANNEL_NAME } from '../../util/multiaccount';\nimport { throttle } from '../../util/schedulers';\nimport { omitVirtualClassFields } from './apiBuilders/helpers';\n\nexport type StoryRepairInfo = {\n  type: 'story';\n  peerId: string;\n  id: number;\n};\n\nexport type MessageRepairInfo = {\n  type: 'message';\n  peerId: string;\n  id: number;\n};\n\nexport type WebPageRepairInfo = {\n  type: 'webPage';\n  url: string;\n};\n\nexport type RepairInfo = {\n  localRepairInfo?: StoryRepairInfo | MessageRepairInfo | WebPageRepairInfo;\n};\n\nexport interface LocalDb {\n  // Used for loading avatars and media through in-memory Gram JS instances.\n  chats: Record<string, GramJs.Chat | GramJs.Channel>;\n  users: Record<string, GramJs.User>;\n  documents: Record<string, GramJs.Document & RepairInfo>;\n  stickerSets: Record<string, GramJs.StickerSet>;\n  photos: Record<string, GramJs.Photo & RepairInfo>;\n  webDocuments: Record<string, GramJs.TypeWebDocument>;\n  commonBoxState: Record<string, number>;\n  channelPtsById: Record<string, number>;\n}\n\nconst channel = new BroadcastChannel(DATA_BROADCAST_CHANNEL_NAME);\n\nlet batchedUpdates: {\n  name: string;\n  prop: string;\n  value: any;\n}[] = [];\nconst throttledLocalDbUpdate = throttle(() => {\n  channel.postMessage({\n    type: 'localDbUpdate',\n    batchedUpdates,\n  });\n  batchedUpdates = [];\n}, 100);\n\nfunction createProxy(name: string, object: any) {\n  return new Proxy(object, {\n    get(target, prop: string, value: any) {\n      return Reflect.get(target, prop, value);\n    },\n    set(target, prop: string, value: any) {\n      batchedUpdates.push({ name, prop, value });\n      throttledLocalDbUpdate();\n      return Reflect.set(target, prop, value);\n    },\n  });\n}\n\nfunction convertToVirtualClass(value: any): any {\n  if (value instanceof Uint8Array) return Buffer.from(value);\n  if (typeof value === 'object' && Object.keys(value).length === 1 && Object.keys(value)[0] === 'value') {\n    return BigInt(value.value);\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(convertToVirtualClass);\n  }\n\n  if (typeof value !== 'object' || !('CONSTRUCTOR_ID' in value)) {\n    return value;\n  }\n  const path = value.className.split('.');\n  const VirtualClass = path.reduce((acc: any, field: string) => {\n    return acc[field];\n  }, GramJs);\n\n  const valueOmited = omitVirtualClassFields(value);\n  const valueConverted = Object.keys(valueOmited).reduce((acc, key) => {\n    acc[key] = convertToVirtualClass(valueOmited[key]);\n    return acc;\n  }, {} as Record<string, any>);\n\n  return new VirtualClass(valueConverted);\n}\n\nfunction createLocalDbInitial(initial?: LocalDb): LocalDb {\n  return [\n    'localMessages', 'chats', 'users', 'messages', 'documents', 'stickerSets', 'photos', 'webDocuments', 'stories',\n    'commonBoxState', 'channelPtsById',\n  ]\n    .reduce((acc: Record<string, any>, key) => {\n      const value = initial?.[key as keyof LocalDb] ?? {};\n      const convertedValue = Object.keys(value).reduce((acc2, key2) => {\n        if (key === 'commonBoxState' || key === 'channelPtsById') {\n          const typedValue = value as Record<string, number>;\n          acc2[key2] = typedValue[key2];\n          return acc2;\n        }\n\n        acc2[key2] = convertToVirtualClass(value[key2]);\n        return acc2;\n      }, {} as Record<string, any>);\n\n      acc[key] = createProxy(key, convertedValue);\n      return acc;\n    }, {} as LocalDb) as LocalDb;\n}\n\nconst localDb: LocalDb = createLocalDbInitial();\n\nexport default localDb;\n\nexport function broadcastLocalDbUpdateFull() {\n  if (!channel) return;\n\n  channel.postMessage({\n    type: 'localDbUpdateFull',\n    localDb: Object.keys(localDb).reduce((acc: Record<string, any>, key) => {\n      acc[key] = { ...localDb[key as keyof LocalDb] };\n      return acc;\n    }, {} as Record<string, any>),\n  });\n}\n\nexport function updateFullLocalDb(initial: LocalDb) {\n  Object.assign(localDb, createLocalDbInitial(initial));\n}\n\nexport function clearLocalDb() {\n  Object.assign(localDb, createLocalDbInitial());\n}\n\nif (DEBUG) {\n  (globalThis as any).getLocalDb = () => localDb;\n}\n","import type { Api as GramJs } from '../../../lib/gramjs';\n\ntype VirtualFields =\n  'flags'\n  | 'CONSTRUCTOR_ID'\n  | 'SUBCLASS_OF_ID'\n  | 'className'\n  | 'classType'\n  | 'getBytes';\n\nexport type OmitVirtualFields<T> = Omit<T, VirtualFields>;\n\nexport function bytesToDataUri(bytes: Buffer, shouldOmitPrefix = false, mimeType: string = 'image/jpeg') {\n  const prefix = shouldOmitPrefix ? '' : `data:${mimeType};base64,`;\n\n  return `${prefix}${btoa(String.fromCharCode(...bytes))}`;\n}\n\nexport function omitVirtualClassFields<T extends GramJs.VirtualClass<T> & { flags?: unknown }>(\n  instance: T,\n): OmitVirtualFields<T> {\n  const {\n    flags,\n    CONSTRUCTOR_ID,\n    SUBCLASS_OF_ID,\n    className,\n    classType,\n    getBytes,\n    ...rest\n  } = instance;\n\n  return rest;\n}\n","import { Api as GramJs } from '../../../lib/gramjs';\nimport { generateRandomBigInt, generateRandomBytes, readBigIntFromBuffer } from '../../../lib/gramjs/Helpers';\n\nimport type {\n  ApiBotApp,\n  ApiChatAdminRights,\n  ApiChatBannedRights,\n  ApiChatFolder,\n  ApiChatReactions,\n  ApiDisallowedGiftsSettings,\n  ApiEmojiStatusType,\n  ApiFormattedText,\n  ApiGroupCall,\n  ApiInputPrivacyRules,\n  ApiInputReplyInfo,\n  ApiInputStorePaymentPurpose,\n  ApiInputSuggestedPostInfo,\n  ApiMessageEntity,\n  ApiNewMediaTodo,\n  ApiNewPoll,\n  ApiPhoneCall,\n  ApiPhoto,\n  ApiPoll,\n  ApiPremiumGiftCodeOption,\n  ApiPrivacyKey,\n  ApiProfileTab,\n  ApiReactionWithPaid,\n  ApiReportReason,\n  ApiRequestInputInvoice,\n  ApiRequestInputSavedStarGift,\n  ApiSendMessageAction,\n  ApiSticker,\n  ApiStory,\n  ApiStorySkipped,\n  ApiThemeParameters,\n  ApiTypeCurrencyAmount,\n  ApiVideo,\n} from '../../types';\nimport {\n  ApiMessageEntityTypes,\n} from '../../types';\n\nimport { CHANNEL_ID_BASE, DEFAULT_STATUS_ICON_ID, STARS_CURRENCY_CODE } from '../../../config';\nimport { pick } from '../../../util/iteratees';\nimport { deserializeBytes } from '../helpers/misc';\nimport localDb from '../localDb';\n\nexport const DEFAULT_PRIMITIVES = {\n  INT: 0,\n  BIGINT: 0n,\n  STRING: '',\n} as const;\n\nexport function getEntityTypeById(peerId: string) {\n  const n = BigInt(peerId);\n  if (n > 0n) {\n    return 'user';\n  }\n\n  if (n < -CHANNEL_ID_BASE) {\n    return 'channel';\n  }\n\n  return 'chat';\n}\n\nexport function buildPeer(chatOrUserId: string): GramJs.TypePeer {\n  const type = getEntityTypeById(chatOrUserId);\n\n  if (type === 'user') {\n    return new GramJs.PeerUser({\n      userId: buildMtpPeerId(chatOrUserId, 'user'),\n    });\n  } else if (type === 'channel') {\n    return new GramJs.PeerChannel({\n      channelId: buildMtpPeerId(chatOrUserId, 'channel'),\n    });\n  } else {\n    return new GramJs.PeerChat({\n      chatId: buildMtpPeerId(chatOrUserId, 'chat'),\n    });\n  }\n}\n\nexport function buildInputPeer(chatOrUserId: string, accessHash?: string): GramJs.TypeInputPeer {\n  const type = getEntityTypeById(chatOrUserId);\n\n  if (type === 'user') {\n    return new GramJs.InputPeerUser({\n      userId: buildMtpPeerId(chatOrUserId, 'user'),\n      accessHash: BigInt(accessHash!),\n    });\n  } else if (type === 'channel') {\n    return new GramJs.InputPeerChannel({\n      channelId: buildMtpPeerId(chatOrUserId, 'channel'),\n      accessHash: BigInt(accessHash!),\n    });\n  } else {\n    return new GramJs.InputPeerChat({\n      chatId: buildMtpPeerId(chatOrUserId, 'chat'),\n    });\n  }\n}\n\nexport function buildInputUser(userId: string, accessHash?: string): GramJs.TypeInputUser {\n  if (!accessHash) {\n    return new GramJs.InputUserEmpty();\n  }\n\n  return new GramJs.InputUser({\n    userId: buildMtpPeerId(userId, 'user'),\n    accessHash: BigInt(accessHash),\n  });\n}\n\nexport function buildInputChannel(channelId: string, accessHash?: string): GramJs.TypeInputChannel {\n  if (!accessHash) {\n    return new GramJs.InputChannelEmpty();\n  }\n\n  return new GramJs.InputChannel({\n    channelId: buildMtpPeerId(channelId, 'channel'),\n    accessHash: BigInt(accessHash),\n  });\n}\n\nexport function buildInputChat(chatId: string) {\n  return BigInt(chatId.slice(1));\n}\n\nexport function buildInputPaidReactionPrivacy(isPrivate?: boolean, peerId?: string): GramJs.TypePaidReactionPrivacy {\n  if (isPrivate) return new GramJs.PaidReactionPrivacyAnonymous();\n  if (peerId) {\n    const peer = buildInputPeerFromLocalDb(peerId);\n    if (peer) {\n      return new GramJs.PaidReactionPrivacyPeer({\n        peer,\n      });\n    }\n  }\n  return new GramJs.PaidReactionPrivacyDefault();\n}\n\nexport function buildInputPeerFromLocalDb(chatOrUserId: string): GramJs.TypeInputPeer | undefined {\n  const type = getEntityTypeById(chatOrUserId);\n  let accessHash: bigint | undefined;\n\n  if (type === 'user') {\n    accessHash = localDb.users[chatOrUserId]?.accessHash;\n    if (!accessHash) {\n      return undefined;\n    }\n  } else if (type === 'channel') {\n    accessHash = (localDb.chats[chatOrUserId] as GramJs.Channel)?.accessHash;\n    if (!accessHash) {\n      return undefined;\n    }\n  }\n\n  return buildInputPeer(chatOrUserId, String(accessHash));\n}\n\nexport function buildInputChannelFromLocalDb(channelId: string): GramJs.TypeInputChannel | undefined {\n  const channel = localDb.chats[channelId];\n\n  if (!channel || !(channel instanceof GramJs.Channel)) {\n    return undefined;\n  }\n\n  return buildInputChannel(channelId, String(channel.accessHash));\n}\n\nexport function buildInputStickerSet(id: string, accessHash: string) {\n  return new GramJs.InputStickerSetID({\n    id: BigInt(id),\n    accessHash: BigInt(accessHash),\n  });\n}\n\nexport function buildInputStickerSetShortName(shortName: string) {\n  return new GramJs.InputStickerSetShortName({\n    shortName,\n  });\n}\n\nexport function buildInputDocument(media: ApiSticker | ApiVideo) {\n  const document = localDb.documents[media.id];\n\n  if (!document) {\n    return undefined;\n  }\n\n  return new GramJs.InputDocument(pick(document, [\n    'id',\n    'accessHash',\n    'fileReference',\n  ]));\n}\n\nexport function buildInputMediaDocument(media: ApiSticker | ApiVideo) {\n  const inputDocument = buildInputDocument(media);\n\n  if (!inputDocument) {\n    return undefined;\n  }\n\n  return new GramJs.InputMediaDocument({ id: inputDocument });\n}\n\nexport function buildInputPoll(pollParams: ApiNewPoll, randomId: bigint) {\n  const { summary, quiz } = pollParams;\n\n  const poll = new GramJs.Poll({\n    id: randomId,\n    publicVoters: summary.isPublic,\n    question: buildInputTextWithEntities(summary.question),\n    answers: summary.answers.map(({ text, option }) => {\n      return new GramJs.PollAnswer({\n        text: buildInputTextWithEntities(text),\n        option: deserializeBytes(option),\n      });\n    }),\n    quiz: summary.quiz,\n    multipleChoice: summary.multipleChoice,\n  });\n\n  if (!quiz) {\n    return new GramJs.InputMediaPoll({ poll });\n  }\n\n  const correctAnswers = quiz.correctAnswers.map(deserializeBytes);\n  const { solution } = quiz;\n  const solutionEntities = quiz.solutionEntities ? quiz.solutionEntities.map(buildMtpMessageEntity) : [];\n\n  return new GramJs.InputMediaPoll({\n    poll,\n    correctAnswers,\n    ...(solution && {\n      solution,\n      solutionEntities,\n    }),\n  });\n}\n\nexport function buildInputPollFromExisting(poll: ApiPoll, shouldClose = false) {\n  return new GramJs.InputMediaPoll({\n    poll: new GramJs.Poll({\n      id: BigInt(poll.id),\n      publicVoters: poll.summary.isPublic,\n      question: buildInputTextWithEntities(poll.summary.question),\n      answers: poll.summary.answers.map(({ text, option }) => {\n        return new GramJs.PollAnswer({\n          text: buildInputTextWithEntities(text),\n          option: deserializeBytes(option),\n        });\n      }),\n      quiz: poll.summary.quiz,\n      multipleChoice: poll.summary.multipleChoice,\n      closeDate: poll.summary.closeDate,\n      closePeriod: poll.summary.closePeriod,\n      closed: shouldClose ? true : poll.summary.closed,\n    }),\n    correctAnswers: poll.results.results?.filter((o) => o.isCorrect).map((o) => deserializeBytes(o.option)),\n    solution: poll.results.solution,\n    solutionEntities: poll.results.solutionEntities?.map(buildMtpMessageEntity),\n  });\n}\n\nexport function buildInputTodo(todo: ApiNewMediaTodo) {\n  const { title, items } = todo.todo;\n\n  const todoItems = items.map((item) => {\n    return new GramJs.TodoItem({\n      id: item.id,\n      title: buildInputTextWithEntities(item.title),\n    });\n  });\n\n  const todoList = new GramJs.TodoList({\n    title: buildInputTextWithEntities(title),\n    list: todoItems,\n    othersCanAppend: todo.todo.othersCanAppend || undefined,\n    othersCanComplete: todo.todo.othersCanComplete || undefined,\n  });\n\n  return new GramJs.InputMediaTodo({\n    todo: todoList,\n  });\n}\n\nexport function buildFilterFromApiFolder(folder: ApiChatFolder): GramJs.DialogFilter | GramJs.DialogFilterChatlist {\n  const {\n    emoticon,\n    contacts,\n    nonContacts,\n    groups,\n    channels,\n    bots,\n    color,\n    excludeArchived,\n    excludeMuted,\n    excludeRead,\n    pinnedChatIds,\n    includedChatIds,\n    excludedChatIds,\n    noTitleAnimations,\n  } = folder;\n\n  const pinnedPeers = pinnedChatIds\n    ? pinnedChatIds.map(buildInputPeerFromLocalDb).filter(Boolean)\n    : [];\n\n  const includePeers = includedChatIds\n    ? includedChatIds.map(buildInputPeerFromLocalDb).filter(Boolean)\n    : [];\n\n  const excludePeers = excludedChatIds\n    ? excludedChatIds.map(buildInputPeerFromLocalDb).filter(Boolean)\n    : [];\n\n  if (folder.isChatList) {\n    return new GramJs.DialogFilterChatlist({\n      id: folder.id,\n      title: buildInputTextWithEntities(folder.title),\n      color,\n      emoticon: emoticon || undefined,\n      pinnedPeers,\n      includePeers,\n      hasMyInvites: folder.hasMyInvites,\n      titleNoanimate: noTitleAnimations,\n    });\n  }\n\n  return new GramJs.DialogFilter({\n    id: folder.id,\n    title: buildInputTextWithEntities(folder.title),\n    emoticon: emoticon || undefined,\n    contacts: contacts || undefined,\n    nonContacts: nonContacts || undefined,\n    groups: groups || undefined,\n    bots: bots || undefined,\n    color,\n    excludeArchived: excludeArchived || undefined,\n    excludeMuted: excludeMuted || undefined,\n    excludeRead: excludeRead || undefined,\n    broadcasts: channels || undefined,\n    pinnedPeers,\n    includePeers,\n    excludePeers,\n    titleNoanimate: noTitleAnimations,\n  });\n}\n\nexport function buildInputStory(story: ApiStory | ApiStorySkipped) {\n  const peer = buildInputPeerFromLocalDb(story.peerId)!;\n  return new GramJs.InputMediaStory({\n    peer,\n    id: story.id,\n  });\n}\n\nexport function generateRandomTimestampedBigInt() {\n  // 32 bits for timestamp, 32 bits are random\n  const buffer = generateRandomBytes(8);\n  const timestampBuffer = Buffer.allocUnsafe(4);\n  timestampBuffer.writeUInt32LE(Math.floor(Date.now() / 1000), 0);\n  buffer.set(timestampBuffer, 4);\n  return readBigIntFromBuffer(buffer, true, true);\n}\n\nexport function buildMessageFromUpdate(\n  id: number,\n  chatId: string,\n  update: GramJs.UpdateShortSentMessage | GramJs.UpdateServiceNotification,\n) {\n  // This is not a proper message, but we only need these fields for downloading media through `localDb`.\n  return new GramJs.Message({\n    id,\n    peerId: buildPeer(chatId),\n    fromId: buildPeer(chatId),\n    media: update.media,\n  } as GramJs.Message);\n}\n\nexport function buildMtpMessageEntity(entity: ApiMessageEntity): GramJs.TypeMessageEntity {\n  const {\n    type, offset, length,\n  } = entity;\n\n  const user = 'userId' in entity ? localDb.users[entity.userId] : undefined;\n\n  switch (type) {\n    case ApiMessageEntityTypes.Bold:\n      return new GramJs.MessageEntityBold({ offset, length });\n    case ApiMessageEntityTypes.Italic:\n      return new GramJs.MessageEntityItalic({ offset, length });\n    case ApiMessageEntityTypes.Underline:\n      return new GramJs.MessageEntityUnderline({ offset, length });\n    case ApiMessageEntityTypes.Strike:\n      return new GramJs.MessageEntityStrike({ offset, length });\n    case ApiMessageEntityTypes.Code:\n      return new GramJs.MessageEntityCode({ offset, length });\n    case ApiMessageEntityTypes.Pre:\n      return new GramJs.MessageEntityPre({ offset, length, language: entity.language || '' });\n    case ApiMessageEntityTypes.Blockquote:\n      return new GramJs.MessageEntityBlockquote({ offset, length });\n    case ApiMessageEntityTypes.TextUrl:\n      return new GramJs.MessageEntityTextUrl({ offset, length, url: entity.url });\n    case ApiMessageEntityTypes.Url:\n      return new GramJs.MessageEntityUrl({ offset, length });\n    case ApiMessageEntityTypes.Hashtag:\n      return new GramJs.MessageEntityHashtag({ offset, length });\n    case ApiMessageEntityTypes.MentionName:\n      return new GramJs.InputMessageEntityMentionName({\n        offset,\n        length,\n        userId: new GramJs.InputUser({ userId: BigInt(user!.id), accessHash: user!.accessHash! }),\n      });\n    case ApiMessageEntityTypes.Spoiler:\n      return new GramJs.MessageEntitySpoiler({ offset, length });\n    case ApiMessageEntityTypes.CustomEmoji:\n      return new GramJs.MessageEntityCustomEmoji({ offset, length, documentId: BigInt(entity.documentId) });\n    default:\n      return new GramJs.MessageEntityUnknown({ offset, length });\n  }\n}\n\nexport function buildChatPhotoForLocalDb(photo: GramJs.TypePhoto) {\n  if (photo instanceof GramJs.PhotoEmpty) {\n    return new GramJs.ChatPhotoEmpty();\n  }\n\n  const { dcId, id: photoId } = photo;\n\n  return new GramJs.ChatPhoto({\n    dcId,\n    photoId,\n  });\n}\n\nexport function buildInputPhoto(photo: ApiPhoto) {\n  const localPhoto = localDb.photos[photo?.id];\n\n  if (!localPhoto) {\n    return undefined;\n  }\n\n  return new GramJs.InputPhoto(pick(localPhoto, [\n    'id',\n    'accessHash',\n    'fileReference',\n  ]));\n}\n\nexport function buildInputContact({\n  phone,\n  firstName,\n  lastName,\n}: {\n  phone: string;\n  firstName: string;\n  lastName: string;\n}) {\n  return new GramJs.InputPhoneContact({\n    clientId: 1n,\n    phone,\n    firstName,\n    lastName,\n  });\n}\n\nexport function buildChatBannedRights(\n  bannedRights: ApiChatBannedRights,\n  untilDate = 0,\n) {\n  return new GramJs.ChatBannedRights({\n    ...bannedRights,\n    untilDate,\n  });\n}\n\nexport function buildChatAdminRights(\n  adminRights: ApiChatAdminRights,\n) {\n  return new GramJs.ChatAdminRights(adminRights);\n}\n\nexport function buildShippingInfo(info: GramJs.PaymentRequestedInfo) {\n  const { shippingAddress } = info;\n  return new GramJs.PaymentRequestedInfo({\n    ...info,\n    shippingAddress: shippingAddress\n      ? new GramJs.PostAddress(shippingAddress)\n      : undefined,\n  });\n}\n\nexport function buildInputPrivacyKey(privacyKey: ApiPrivacyKey) {\n  switch (privacyKey) {\n    case 'phoneNumber':\n      return new GramJs.InputPrivacyKeyPhoneNumber();\n\n    case 'addByPhone':\n      return new GramJs.InputPrivacyKeyAddedByPhone();\n\n    case 'lastSeen':\n      return new GramJs.InputPrivacyKeyStatusTimestamp();\n\n    case 'profilePhoto':\n      return new GramJs.InputPrivacyKeyProfilePhoto();\n\n    case 'forwards':\n      return new GramJs.InputPrivacyKeyForwards();\n\n    case 'chatInvite':\n      return new GramJs.InputPrivacyKeyChatInvite();\n\n    case 'phoneCall':\n      return new GramJs.InputPrivacyKeyPhoneCall();\n\n    case 'phoneP2P':\n      return new GramJs.InputPrivacyKeyPhoneP2P();\n\n    case 'voiceMessages':\n      return new GramJs.InputPrivacyKeyVoiceMessages();\n\n    case 'bio':\n      return new GramJs.InputPrivacyKeyAbout();\n\n    case 'birthday':\n      return new GramJs.InputPrivacyKeyBirthday();\n\n    case 'gifts':\n      return new GramJs.InputPrivacyKeyStarGiftsAutoSave();\n\n    case 'noPaidMessages':\n      return new GramJs.InputPrivacyKeyNoPaidMessages();\n  }\n\n  return undefined;\n}\n\nexport function buildInputReportReason(reason: ApiReportReason): GramJs.TypeReportReason {\n  switch (reason) {\n    case 'spam':\n      return new GramJs.InputReportReasonSpam();\n    case 'violence':\n      return new GramJs.InputReportReasonViolence();\n    case 'childAbuse':\n      return new GramJs.InputReportReasonChildAbuse();\n    case 'pornography':\n      return new GramJs.InputReportReasonPornography();\n    case 'copyright':\n      return new GramJs.InputReportReasonCopyright();\n    case 'fake':\n      return new GramJs.InputReportReasonFake();\n    case 'geoIrrelevant':\n      return new GramJs.InputReportReasonGeoIrrelevant();\n    case 'illegalDrugs':\n      return new GramJs.InputReportReasonIllegalDrugs();\n    case 'personalDetails':\n      return new GramJs.InputReportReasonPersonalDetails();\n    case 'other':\n    default:\n      return new GramJs.InputReportReasonOther();\n  }\n}\n\nexport function buildSendMessageAction(action: ApiSendMessageAction) {\n  switch (action.type) {\n    case 'cancel':\n      return new GramJs.SendMessageCancelAction();\n    case 'typing':\n      return new GramJs.SendMessageTypingAction();\n    case 'recordAudio':\n      return new GramJs.SendMessageRecordAudioAction();\n    case 'chooseSticker':\n      return new GramJs.SendMessageChooseStickerAction();\n    case 'playingGame':\n      return new GramJs.SendMessageGamePlayAction();\n  }\n  return undefined;\n}\n\nexport function buildInputThemeParams(params: ApiThemeParameters) {\n  return new GramJs.DataJSON({\n    data: JSON.stringify(params),\n  });\n}\n\nexport function buildMtpPeerId(id: string, type: 'user' | 'chat' | 'channel') {\n  const n = BigInt(id);\n  if (type === 'user') {\n    return n;\n  }\n\n  if (type === 'channel') {\n    return -n - CHANNEL_ID_BASE;\n  }\n\n  return n * -1n;\n}\n\nexport function buildInputGroupCall(groupCall: Partial<ApiGroupCall>) {\n  return new GramJs.InputGroupCall({\n    id: BigInt(groupCall.id!),\n    accessHash: BigInt(groupCall.accessHash!),\n  });\n}\n\nexport function buildInputPhoneCall({ id, accessHash }: ApiPhoneCall) {\n  return new GramJs.InputPhoneCall({\n    id: BigInt(id),\n    accessHash: BigInt(accessHash!),\n  });\n}\n\nexport function buildInputStorePaymentPurpose(\n  purpose: ApiInputStorePaymentPurpose,\n): GramJs.TypeInputStorePaymentPurpose {\n  if (purpose.type === 'stars') {\n    return new GramJs.InputStorePaymentStarsTopup({\n      stars: BigInt(purpose.stars),\n      currency: purpose.currency,\n      amount: BigInt(purpose.amount),\n      spendPurposePeer: purpose.spendPurposePeer\n        ? buildInputPeer(purpose.spendPurposePeer.id, purpose.spendPurposePeer.accessHash)\n        : undefined,\n    });\n  }\n\n  if (purpose.type === 'starsgift') {\n    return new GramJs.InputStorePaymentStarsGift({\n      userId: buildInputUser(purpose.user.id, purpose.user.accessHash),\n      stars: BigInt(purpose.stars),\n      currency: purpose.currency,\n      amount: BigInt(purpose.amount),\n    });\n  }\n\n  if (purpose.type === 'giftcode') {\n    return new GramJs.InputStorePaymentPremiumGiftCode({\n      users: purpose.users.map((user) => buildInputUser(user.id, user.accessHash)),\n      boostPeer: purpose.boostChannel\n        ? buildInputPeer(purpose.boostChannel.id, purpose.boostChannel.accessHash)\n        : undefined,\n      currency: purpose.currency,\n      amount: BigInt(purpose.amount),\n      message: purpose.message && buildInputTextWithEntities(purpose.message),\n    });\n  }\n\n  const randomId = generateRandomBigInt();\n\n  if (purpose.type === 'starsgiveaway') {\n    return new GramJs.InputStorePaymentStarsGiveaway({\n      boostPeer: buildInputPeer(purpose.chat.id, purpose.chat.accessHash),\n      additionalPeers: purpose.additionalChannels?.map((chat) => buildInputPeer(chat.id, chat.accessHash)),\n      stars: BigInt(purpose.stars!),\n      countriesIso2: purpose.countries,\n      prizeDescription: purpose.prizeDescription,\n      onlyNewSubscribers: purpose.isOnlyForNewSubscribers || undefined,\n      winnersAreVisible: purpose.areWinnersVisible || undefined,\n      untilDate: purpose.untilDate,\n      currency: purpose.currency,\n      amount: BigInt(purpose.amount),\n      users: purpose.users,\n      randomId,\n    });\n  }\n\n  return new GramJs.InputStorePaymentPremiumGiveaway({\n    boostPeer: buildInputPeer(purpose.chat.id, purpose.chat.accessHash),\n    additionalPeers: purpose.additionalChannels?.map((chat) => buildInputPeer(chat.id, chat.accessHash)),\n    countriesIso2: purpose.countries,\n    prizeDescription: purpose.prizeDescription,\n    onlyNewSubscribers: purpose.isOnlyForNewSubscribers || undefined,\n    winnersAreVisible: purpose.areWinnersVisible || undefined,\n    untilDate: purpose.untilDate,\n    currency: purpose.currency,\n    amount: BigInt(purpose.amount),\n    randomId,\n  });\n}\n\nfunction buildPremiumGiftCodeOption(optionData: ApiPremiumGiftCodeOption) {\n  return new GramJs.PremiumGiftCodeOption({\n    users: optionData.users,\n    months: optionData.months,\n    currency: optionData.currency,\n    amount: BigInt(optionData.amount),\n  });\n}\n\nexport function buildDisallowedGiftsSettings(disallowedGifts: ApiDisallowedGiftsSettings) {\n  return new GramJs.DisallowedGiftsSettings({\n    disallowUnlimitedStargifts: disallowedGifts.shouldDisallowLimitedStarGifts,\n    disallowLimitedStargifts: disallowedGifts.shouldDisallowUnlimitedStarGifts,\n    disallowUniqueStargifts: disallowedGifts.shouldDisallowUniqueStarGifts,\n    disallowPremiumGifts: disallowedGifts.shouldDisallowPremiumGifts,\n  });\n}\n\nexport function buildInputInvoice(invoice: ApiRequestInputInvoice) {\n  switch (invoice.type) {\n    case 'message': {\n      return new GramJs.InputInvoiceMessage({\n        peer: buildInputPeer(invoice.chat.id, invoice.chat.accessHash),\n        msgId: invoice.messageId,\n      });\n    }\n\n    case 'slug': {\n      return new GramJs.InputInvoiceSlug({\n        slug: invoice.slug,\n      });\n    }\n\n    case 'stargiftResale': {\n      const {\n        peer, slug,\n      } = invoice;\n      return new GramJs.InputInvoiceStarGiftResale({\n        toId: buildInputPeer(peer.id, peer.accessHash),\n        slug,\n        ton: invoice.currency === 'TON' || undefined,\n      });\n    }\n\n    case 'stargift': {\n      const {\n        peer, shouldHideName, giftId, message, shouldUpgrade,\n      } = invoice;\n      return new GramJs.InputInvoiceStarGift({\n        peer: buildInputPeer(peer.id, peer.accessHash),\n        hideName: shouldHideName || undefined,\n        giftId: BigInt(giftId),\n        message: message && buildInputTextWithEntities(message),\n        includeUpgrade: shouldUpgrade,\n      });\n    }\n\n    case 'stars': {\n      const purpose = buildInputStorePaymentPurpose(invoice.purpose);\n      return new GramJs.InputInvoiceStars({\n        purpose,\n      });\n    }\n\n    case 'premiumGiftStars': {\n      const {\n        user, message, months,\n      } = invoice;\n      return new GramJs.InputInvoicePremiumGiftStars({\n        months,\n        userId: buildInputUser(user.id, user.accessHash),\n        message: message && buildInputTextWithEntities(message),\n      });\n    }\n\n    case 'starsgiveaway': {\n      const purpose = buildInputStorePaymentPurpose(invoice.purpose);\n      return new GramJs.InputInvoiceStars({\n        purpose,\n      });\n    }\n\n    case 'chatInviteSubscription': {\n      return new GramJs.InputInvoiceChatInviteSubscription({\n        hash: invoice.hash,\n      });\n    }\n\n    case 'stargiftUpgrade': {\n      return new GramJs.InputInvoiceStarGiftUpgrade({\n        stargift: buildInputSavedStarGift(invoice.inputSavedGift),\n        keepOriginalDetails: invoice.shouldKeepOriginalDetails,\n      });\n    }\n\n    case 'stargiftTransfer': {\n      return new GramJs.InputInvoiceStarGiftTransfer({\n        stargift: buildInputSavedStarGift(invoice.inputSavedGift),\n        toId: buildInputPeer(invoice.recipient.id, invoice.recipient.accessHash),\n      });\n    }\n\n    case 'stargiftDropOriginalDetails': {\n      return new GramJs.InputInvoiceStarGiftDropOriginalDetails({\n        stargift: buildInputSavedStarGift(invoice.inputSavedGift),\n      });\n    }\n\n    case 'stargiftPrepaidUpgrade': {\n      return new GramJs.InputInvoiceStarGiftPrepaidUpgrade({\n        peer: buildInputPeer(invoice.peer.id, invoice.peer.accessHash),\n        hash: invoice.hash,\n      });\n    }\n\n    case 'stargiftAuctionBid': {\n      const {\n        giftId, bidAmount, peer, message, shouldHideName, isUpdateBid,\n      } = invoice;\n      return new GramJs.InputInvoiceStarGiftAuctionBid({\n        giftId: BigInt(giftId),\n        bidAmount: BigInt(bidAmount),\n        peer: peer && buildInputPeer(peer.id, peer.accessHash || ''),\n        message: message && buildInputTextWithEntities(message),\n        hideName: shouldHideName || undefined,\n        updateBid: isUpdateBid || undefined,\n      });\n    }\n\n    case 'giveaway':\n    default: {\n      const purpose = buildInputStorePaymentPurpose(invoice.purpose);\n      const option = buildPremiumGiftCodeOption(invoice.option);\n\n      return new GramJs.InputInvoicePremiumGiftCode({\n        purpose,\n        option,\n      });\n    }\n  }\n}\n\nexport function buildInputReaction(reaction?: ApiReactionWithPaid) {\n  switch (reaction?.type) {\n    case 'emoji':\n      return new GramJs.ReactionEmoji({\n        emoticon: reaction.emoticon,\n      });\n    case 'custom':\n      return new GramJs.ReactionCustomEmoji({\n        documentId: BigInt(reaction.documentId),\n      });\n    case 'paid':\n      return new GramJs.ReactionPaid();\n    default:\n      return new GramJs.ReactionEmpty();\n  }\n}\n\nexport function buildInputChatReactions(chatReactions?: ApiChatReactions) {\n  if (chatReactions?.type === 'all') {\n    return new GramJs.ChatReactionsAll({\n      allowCustom: chatReactions.areCustomAllowed,\n    });\n  }\n\n  if (chatReactions?.type === 'some') {\n    return new GramJs.ChatReactionsSome({\n      reactions: chatReactions.allowed.map(buildInputReaction),\n    });\n  }\n\n  return new GramJs.ChatReactionsNone();\n}\n\nexport function buildInputEmojiStatus(emojiStatus: ApiEmojiStatusType) {\n  if (emojiStatus.type === 'collectible') {\n    return new GramJs.InputEmojiStatusCollectible({\n      collectibleId: BigInt(emojiStatus.collectibleId),\n      until: emojiStatus.until,\n    });\n  }\n\n  if (emojiStatus.documentId === DEFAULT_STATUS_ICON_ID) {\n    return new GramJs.EmojiStatusEmpty();\n  }\n\n  return new GramJs.EmojiStatus({\n    documentId: BigInt(emojiStatus.documentId),\n    until: emojiStatus.until,\n  });\n}\n\nexport function buildInputTextWithEntities(formatted: ApiFormattedText) {\n  return new GramJs.TextWithEntities({\n    text: formatted.text,\n    entities: formatted.entities?.map(buildMtpMessageEntity) || [],\n  });\n}\n\nexport function buildInputBotApp(app: ApiBotApp) {\n  return new GramJs.InputBotAppID({\n    id: BigInt(app.id),\n    accessHash: BigInt(app.accessHash),\n  });\n}\n\nexport function buildInputReplyTo(replyInfo: ApiInputReplyInfo) {\n  if (replyInfo.type === 'story') {\n    return new GramJs.InputReplyToStory({\n      peer: buildInputPeerFromLocalDb(replyInfo.peerId)!,\n      storyId: replyInfo.storyId,\n    });\n  }\n\n  if (replyInfo.type === 'message') {\n    const {\n      replyToMsgId, replyToTopId, replyToPeerId, quoteText, quoteOffset, monoforumPeerId,\n    } = replyInfo;\n    return new GramJs.InputReplyToMessage({\n      replyToMsgId,\n      topMsgId: replyToTopId,\n      replyToPeerId: replyToPeerId ? buildInputPeerFromLocalDb(replyToPeerId)! : undefined,\n      monoforumPeerId: monoforumPeerId ? buildInputPeerFromLocalDb(monoforumPeerId)! : undefined,\n      quoteText: quoteText?.text,\n      quoteEntities: quoteText?.entities?.map(buildMtpMessageEntity),\n      quoteOffset,\n    });\n  }\n\n  return undefined;\n}\n\nexport function buildInputStarsAmount(amount: ApiTypeCurrencyAmount): GramJs.TypeStarsAmount {\n  if (amount.currency === STARS_CURRENCY_CODE) {\n    return new GramJs.StarsAmount({\n      amount: BigInt(amount.amount),\n      nanos: amount.nanos,\n    });\n  }\n\n  return new GramJs.StarsTonAmount({\n    amount: BigInt(amount.amount),\n  });\n}\n\nexport function buildInputSuggestedPost(suggestedPostInfo: ApiInputSuggestedPostInfo): GramJs.SuggestedPost {\n  return new GramJs.SuggestedPost({\n    price: suggestedPostInfo.price && buildInputStarsAmount(suggestedPostInfo.price),\n    scheduleDate: suggestedPostInfo.scheduleDate,\n  });\n}\n\nexport function buildInputPrivacyRules(\n  rules: ApiInputPrivacyRules,\n) {\n  const privacyRules: GramJs.TypeInputPrivacyRule[] = [];\n\n  if (rules.allowedUsers?.length) {\n    privacyRules.push(new GramJs.InputPrivacyValueAllowUsers({\n      users: rules.allowedUsers.map(({ id, accessHash }) => buildInputUser(id, accessHash)),\n    }));\n  }\n  if (rules.allowedChats?.length) {\n    privacyRules.push(new GramJs.InputPrivacyValueAllowChatParticipants({\n      chats: rules.allowedChats.map(({ id, type }) => (\n        buildMtpPeerId(id, type === 'chatTypeBasicGroup' ? 'chat' : 'channel')\n      )),\n    }));\n  }\n  if (rules.blockedUsers?.length) {\n    privacyRules.push(new GramJs.InputPrivacyValueDisallowUsers({\n      users: rules.blockedUsers.map(({ id, accessHash }) => buildInputUser(id, accessHash)),\n    }));\n  }\n  if (rules.blockedChats?.length) {\n    privacyRules.push(new GramJs.InputPrivacyValueDisallowChatParticipants({\n      chats: rules.blockedChats.map(({ id, type }) => (\n        buildMtpPeerId(id, type === 'chatTypeBasicGroup' ? 'chat' : 'channel')\n      )),\n    }));\n  }\n  if (rules.shouldAllowPremium) {\n    privacyRules.push(new GramJs.InputPrivacyValueAllowPremium());\n  }\n\n  if (rules.botsPrivacy === 'allow') {\n    privacyRules.push(new GramJs.InputPrivacyValueAllowBots());\n  }\n\n  if (rules.botsPrivacy === 'disallow') {\n    privacyRules.push(new GramJs.InputPrivacyValueDisallowBots());\n  }\n\n  if (!rules.isUnspecified) {\n    switch (rules.visibility) {\n      case 'everybody':\n        privacyRules.push(new GramJs.InputPrivacyValueAllowAll());\n        break;\n\n      case 'contacts':\n        privacyRules.push(new GramJs.InputPrivacyValueAllowContacts());\n        break;\n\n      case 'nonContacts':\n        privacyRules.push(new GramJs.InputPrivacyValueDisallowContacts());\n        break;\n\n      case 'nobody':\n        privacyRules.push(new GramJs.InputPrivacyValueDisallowAll());\n        break;\n    }\n  }\n\n  return privacyRules;\n}\n\nexport function buildInputSavedStarGift(inputGift: ApiRequestInputSavedStarGift) {\n  if (inputGift.type === 'user') {\n    return new GramJs.InputSavedStarGiftUser({\n      msgId: inputGift.messageId,\n    });\n  }\n\n  return new GramJs.InputSavedStarGiftChat({\n    peer: buildInputPeer(inputGift.chat.id, inputGift.chat.accessHash),\n    savedId: BigInt(inputGift.savedId),\n  });\n}\n\nexport function buildInputProfileTab(profileTab: ApiProfileTab) {\n  switch (profileTab) {\n    case 'stories':\n      return new GramJs.ProfileTabPosts();\n    case 'gifts':\n      return new GramJs.ProfileTabGifts();\n    case 'media':\n      return new GramJs.ProfileTabMedia();\n    case 'documents':\n      return new GramJs.ProfileTabFiles();\n    case 'audio':\n      return new GramJs.ProfileTabMusic();\n    case 'voice':\n      return new GramJs.ProfileTabVoice();\n    case 'links':\n      return new GramJs.ProfileTabLinks();\n    case 'gif':\n      return new GramJs.ProfileTabGifs();\n    default: {\n      const _exhaustiveCheck: never = profileTab;\n      return _exhaustiveCheck;\n    }\n  }\n}\n","import { DEBUG } from '../config';\n\nimport Deferred from './Deferred';\n\nconst MAX_CONCURRENT_CONNECTIONS = 3;\nconst MAX_CONCURRENT_CONNECTIONS_PREMIUM = 6;\n\nconst MAX_ACTIVE_REQUEST_SIZE = 9 * 1024 * 1024;\nconst MAX_ACTIVE_REQUEST_SIZE_PREMIUM = 20 * 1024 * 1024;\n\nconst FOREMAN_MAX_HEAP_SIZE = MAX_ACTIVE_REQUEST_SIZE_PREMIUM / MAX_CONCURRENT_CONNECTIONS_PREMIUM;\n\ninterface QueuedRequest {\n  deferred: Deferred;\n  requestSize: number;\n}\n\nconst dcManagers: Record<number, DcBandwidthManager> = {};\n\nexport function getDcBandwidthManager(dcId: number, isPremium: boolean): DcBandwidthManager {\n  if (!dcManagers[dcId]) {\n    dcManagers[dcId] = new DcBandwidthManager();\n  }\n  const dcManager = dcManagers[dcId];\n  dcManager.updateIsPremium(isPremium);\n  return dcManager;\n}\n\nif (DEBUG) {\n  (globalThis as any).getDcManagers = () => dcManagers;\n}\n\nclass Foreman {\n  private queuedRequests: QueuedRequest[] = [];\n  private priorityQueuedRequests: QueuedRequest[] = [];\n\n  activeRequestHeapSize = 0;\n  queuedRequestHeapSize = 0;\n\n  constructor(private maxRequestHeapSize: number) { }\n\n  requestWorker(requestSize: number, isPriority?: boolean) {\n    if (this.activeRequestHeapSize + requestSize > this.maxRequestHeapSize) {\n      const deferred = new Deferred();\n      const queuedRequest = { deferred, requestSize };\n      if (isPriority) {\n        this.priorityQueuedRequests.push(queuedRequest);\n      } else {\n        this.queuedRequests.push(queuedRequest);\n      }\n      this.queuedRequestHeapSize += requestSize;\n      return deferred.promise;\n    }\n\n    this.activeRequestHeapSize += requestSize;\n    return Promise.resolve();\n  }\n\n  releaseWorker(requestSize: number) {\n    this.activeRequestHeapSize -= requestSize;\n\n    // Try to process queued requests\n    while (this.queueLength > 0) {\n      const queuedRequest = this.priorityQueuedRequests[0] || this.queuedRequests[0];\n      if (!queuedRequest) break;\n\n      // Check if we can process the next queued request\n      if (this.activeRequestHeapSize + queuedRequest.requestSize <= this.maxRequestHeapSize) {\n        const request = (this.priorityQueuedRequests.shift() || this.queuedRequests.shift())!;\n        this.queuedRequestHeapSize -= request.requestSize;\n        this.activeRequestHeapSize += request.requestSize;\n        request.deferred.resolve();\n      } else {\n        break;\n      }\n    }\n  }\n\n  canAccept(requestSize: number) {\n    return this.activeRequestHeapSize + requestSize <= this.maxRequestHeapSize;\n  }\n\n  get queueLength() {\n    return this.queuedRequests.length + this.priorityQueuedRequests.length;\n  }\n}\n\nclass DcBandwidthManager {\n  private foremans: Foreman[] = [];\n\n  private maxConnections: number = MAX_CONCURRENT_CONNECTIONS;\n  private maxActiveSize: number = MAX_ACTIVE_REQUEST_SIZE;\n\n  private queuedRequests: QueuedRequest[] = [];\n\n  private priorityQueuedRequests: QueuedRequest[] = [];\n\n  activeRequestSize = 0;\n\n  constructor() {\n    const maxForemans = Math.max(MAX_CONCURRENT_CONNECTIONS, MAX_CONCURRENT_CONNECTIONS_PREMIUM);\n\n    this.foremans = Array(maxForemans)\n      .fill(undefined)\n      .map(() => new Foreman(FOREMAN_MAX_HEAP_SIZE));\n  }\n\n  updateIsPremium(isPremium: boolean) {\n    this.maxConnections = isPremium ? MAX_CONCURRENT_CONNECTIONS_PREMIUM : MAX_CONCURRENT_CONNECTIONS;\n    this.maxActiveSize = isPremium ? MAX_ACTIVE_REQUEST_SIZE_PREMIUM : MAX_ACTIVE_REQUEST_SIZE;\n  }\n\n  async requestWorker(isPriority: boolean, requestSize: number): Promise<number> {\n    // Check if adding this request would exceed the dcId size limit\n    if (this.activeRequestSize + requestSize > this.maxActiveSize) {\n      const deferred = new Deferred();\n      const queuedRequest = { deferred, requestSize };\n      if (isPriority) {\n        this.priorityQueuedRequests.push(queuedRequest);\n      } else {\n        this.queuedRequests.push(queuedRequest);\n      }\n      await deferred.promise;\n      // After being dequeued, select and request a foreman\n      const foremanIndex = this.getFreeForemanIndex(requestSize);\n      const foreman = this.foremans[foremanIndex];\n      await foreman.requestWorker(requestSize, isPriority);\n      return foremanIndex;\n    }\n\n    const foremanIndex = this.getFreeForemanIndex(requestSize);\n    const foreman = this.foremans[foremanIndex];\n    await foreman.requestWorker(requestSize, isPriority);\n    this.activeRequestSize += requestSize;\n    return foremanIndex;\n  }\n\n  releaseWorker(foremanIndex: number, requestSize: number) {\n    this.activeRequestSize -= requestSize;\n    this.foremans[foremanIndex].releaseWorker(requestSize);\n\n    // Try to process queued requests\n    this.processQueue();\n  }\n\n  private processQueue() {\n    while (true) {\n      const queuedRequest = this.priorityQueuedRequests[0] || this.queuedRequests[0];\n      if (!queuedRequest) {\n        return;\n      }\n\n      if (this.activeRequestSize + queuedRequest.requestSize > this.maxActiveSize) {\n        return;\n      }\n\n      const request = (this.priorityQueuedRequests.shift() || this.queuedRequests.shift())!;\n      this.activeRequestSize += request.requestSize;\n      request.deferred.resolve();\n    }\n  }\n\n  private getFreeForemanIndex(requestSize: number): number {\n    let minTotalHeapSize = Infinity;\n    let minHeapForemanIndex = 0;\n\n    for (let i = 0; i < this.maxConnections; i++) {\n      const foreman = this.foremans[i];\n      if (foreman.canAccept(requestSize)) {\n        return i; // Prefer filling up free foremans to avoid unnecessary connections\n      }\n\n      const totalHeapSize = foreman.activeRequestHeapSize + foreman.queuedRequestHeapSize;\n      if (totalHeapSize < minTotalHeapSize) {\n        minTotalHeapSize = totalHeapSize;\n        minHeapForemanIndex = i;\n      }\n    }\n\n    // If every foreman is busy, use the one with the smallest total heap size\n    return minHeapForemanIndex;\n  }\n\n  getForeman(index: number): Foreman {\n    return this.foremans[index];\n  }\n\n  get queueLength() {\n    return this.queuedRequests.length + this.priorityQueuedRequests.length;\n  }\n}\n","import os from 'os';\n\nimport type LocalUpdatePremiumFloodWait from '../../../api/gramjs/updates/UpdatePremiumFloodWait';\nimport type { UpdatePts } from '../../../api/gramjs/updates/UpdatePts';\nimport type { AuthKey } from '../crypto/AuthKey';\nimport type {\n  Connection,\n  UpdateServerTimeOffset } from '../network';\nimport type {\n  PasswordResult,\n  TmpPasswordResult,\n  TwoFaParams } from './2fa';\nimport type { UserAuthParams } from './auth';\nimport type { DownloadFileParams, DownloadFileWithDcParams, DownloadMediaParams } from './downloadFile';\nimport type { UploadFileParams } from './uploadFile';\n\nimport Deferred from '../../../util/Deferred';\nimport { toJSNumber } from '../../../util/numbers';\nimport {\n  FloodTestPhoneWaitError,\n  FloodWaitError,\n  MsgWaitError,\n  NetworkMigrateError,\n  PhoneMigrateError,\n  RPCError,\n  ServerError,\n  TimedOutError,\n  UserMigrateError,\n} from '../errors';\nimport { Logger } from '../extensions';\nimport {\n  ConnectionTCPObfuscated,\n  HttpConnection,\n  MTProtoSender,\n  UpdateConnectionState,\n} from '../network';\nimport { Api } from '../tl';\nimport {\n  getCurrentPassword,\n  getTmpPassword,\n  updateTwoFaSettings,\n} from './2fa';\nimport { authFlow, checkAuthorization } from './auth';\nimport { downloadFile } from './downloadFile';\nimport { uploadFile } from './uploadFile';\n\nimport { generateRandomBigInt, sleep } from '../Helpers';\nimport RequestState from '../network/RequestState';\nimport Session from '../sessions/Abstract';\nimport MemorySession from '../sessions/Memory';\nimport { LAYER } from '../tl/AllTLObjects';\nimport { getDC, getInputPeer, strippedPhotoToJpg } from '../Utils';\n\ntype TelegramClientParams = {\n  connection: typeof Connection;\n  fallbackConnection: typeof Connection;\n  useIPV6: boolean;\n  timeout: number;\n  requestRetries: number;\n  connectionRetries: number;\n  connectionRetriesToFallback: number;\n  retryDelay: number;\n  retryMainConnectionDelay: number;\n  autoReconnect: boolean;\n  sequentialUpdates: boolean;\n  floodSleepLimit: number;\n  deviceModel: string;\n  systemVersion: string;\n  appVersion: string;\n  langCode: string;\n  langPack: string;\n  systemLangCode: string;\n  baseLogger: string | Logger;\n  useWSS: boolean;\n  additionalDcsDisabled: boolean;\n  dcId: number;\n  isTestServerRequested: boolean;\n  shouldAllowHttpTransport: boolean;\n  shouldForceHttpTransport: boolean;\n  shouldDebugExportedSenders: boolean;\n};\n\ntype TimeoutId = ReturnType<typeof setTimeout>;\n\nexport type Update = (\n    Api.TypeUpdate | Api.TypeUpdates\n    | UpdateServerTimeOffset | UpdateConnectionState | UpdatePts | LocalUpdatePremiumFloodWait\n) & { _entities?: (Api.TypeUser | Api.TypeChat)[] };\ntype EventBuilder = {\n  build: (update: Update) => Update;\n};\n\nconst DEFAULT_DC_ID = 2;\nconst DEFAULT_WEBDOCUMENT_DC_ID = 4;\nconst EXPORTED_SENDER_RECONNECT_TIMEOUT = 1000; // 1 sec\nconst EXPORTED_SENDER_RELEASE_TIMEOUT = 30000; // 30 sec\nconst WEBDOCUMENT_REQUEST_PART_SIZE = 131072; // 128kb\n\nconst PING_INTERVAL = 3000; // 3 sec\nconst PING_TIMEOUT = 5000; // 5 sec\nconst PING_FAIL_ATTEMPTS = 3;\nconst PING_FAIL_INTERVAL = 100; // ms\n\n// An unusually long interval is a sign of returning from background mode...\nconst PING_INTERVAL_TO_WAKE_UP = 5000; // 5 sec\n// ... so we send a quick \"wake-up\" ping to confirm than connection was dropped ASAP\nconst PING_WAKE_UP_TIMEOUT = 3000; // 3 sec\n// We also send a warning to the user even a bit more quickly\nconst PING_WAKE_UP_WARNING_TIMEOUT = 1000; // 1 sec\n\nconst PING_DISCONNECT_DELAY = 60000; // 1 min\n\n// All types, sorted by size\nconst sizeTypes = ['u', 'v', 'w', 'y', 'd', 'x', 'c', 'm', 'b', 'a', 's', 'f', 'i', 'j'] as const;\nexport type SizeType = typeof sizeTypes[number];\n\nclass TelegramClient {\n  static DEFAULT_OPTIONS: Partial<TelegramClientParams> = {\n    connection: ConnectionTCPObfuscated,\n    fallbackConnection: HttpConnection,\n    useIPV6: false,\n    timeout: 10,\n    requestRetries: 5,\n    connectionRetries: Infinity,\n    connectionRetriesToFallback: 1,\n    retryDelay: 1000,\n    retryMainConnectionDelay: 10000,\n    autoReconnect: true,\n    sequentialUpdates: false,\n    floodSleepLimit: 60,\n    deviceModel: undefined,\n    systemVersion: undefined,\n    appVersion: undefined,\n    langCode: 'en',\n    langPack: 'weba',\n    systemLangCode: 'en',\n    baseLogger: 'gramjs',\n    useWSS: false,\n    additionalDcsDisabled: false,\n    dcId: DEFAULT_DC_ID,\n    isTestServerRequested: false,\n    shouldAllowHttpTransport: false,\n    shouldForceHttpTransport: false,\n    shouldDebugExportedSenders: false,\n  };\n\n  private _args: TelegramClientParams;\n\n  public session: Session;\n\n  public apiHash: string;\n\n  public apiId: number;\n\n  public defaultDcId: number;\n\n  private _useIPV6: boolean;\n\n  private _shouldForceHttpTransport: boolean;\n\n  private _shouldAllowHttpTransport: boolean;\n\n  private _shouldDebugExportedSenders: boolean;\n\n  _log: Logger;\n\n  private floodSleepLimit: number;\n\n  private _connection: typeof Connection;\n\n  private _fallbackConnection: typeof Connection;\n\n  private _sender?: MTProtoSender;\n\n  private _eventBuilders: [EventBuilder, CallableFunction][];\n\n  private _requestRetries: number;\n\n  private _connectionRetries: number;\n\n  private _connectionRetriesToFallback: number;\n\n  private _retryDelay: number;\n\n  private _retryMainConnectionDelay: number;\n\n  private _timeout: number;\n\n  private _autoReconnect: boolean;\n\n  private _config?: Api.Config;\n\n  private _exportedSenderPromises: Record<number, Record<number, Promise<MTProtoSender> | undefined>> = {};\n  private _exportedSenderRefCounter: Record<number, Record<number, number>> = {};\n  private _waitingForAuthKey: Record<number, Promise<void> | undefined> = {};\n  private _exportedSenderReleaseTimeouts: Record<number, Record<number, TimeoutId | undefined>> = {};\n  private _loopStarted = false;\n  private _isSwitchingDc = false;\n  private _destroyed = false;\n  private _connectedDeferred = new Deferred();\n  private pingCallback?: () => Promise<void>;\n\n  private _initWith: (x: unknown) => Api.InvokeWithLayer;\n\n  isPremium = false;\n  private _lastRequest = Date.now();\n\n  constructor(\n    session: Session,\n    apiId?: number,\n    apiHash?: string,\n    opts: Partial<TelegramClientParams> = TelegramClient.DEFAULT_OPTIONS,\n  ) {\n    if (!apiId || !apiHash || !Number.isFinite(apiId)) {\n      throw Error('Your API ID or Hash are invalid. Please read \"Requirements\" on README.md');\n    }\n    const args = { ...TelegramClient.DEFAULT_OPTIONS, ...opts } as TelegramClientParams;\n    this.apiId = apiId;\n    this.apiHash = apiHash;\n    this.defaultDcId = args.dcId || DEFAULT_DC_ID;\n    this._useIPV6 = args.useIPV6;\n    this._shouldForceHttpTransport = args.shouldForceHttpTransport;\n    this._shouldAllowHttpTransport = args.shouldAllowHttpTransport;\n    this._shouldDebugExportedSenders = args.shouldDebugExportedSenders;\n    // this._entityCache = new Set()\n    if (typeof args.baseLogger === 'string') {\n      this._log = new Logger();\n    } else {\n      this._log = args.baseLogger;\n    }\n    // Determine what session we will use\n    if (typeof session === 'string' || !session) {\n      try {\n        throw new Error('not implemented');\n      } catch (e: unknown) {\n        session = new MemorySession();\n      }\n    } else if (!(session instanceof Session)) {\n      throw new Error('The given session must be str or a session instance');\n    }\n    this.session = session;\n\n    this.floodSleepLimit = args.floodSleepLimit;\n    this._eventBuilders = [];\n\n    this._requestRetries = args.requestRetries;\n    this._connectionRetries = args.connectionRetries;\n    this._connectionRetriesToFallback = args.connectionRetriesToFallback;\n    this._retryDelay = args.retryDelay || 0;\n    this._retryMainConnectionDelay = args.retryMainConnectionDelay || 0;\n\n    this._timeout = args.timeout;\n    this._autoReconnect = args.autoReconnect;\n\n    this._connection = args.connection;\n    this._fallbackConnection = args.fallbackConnection;\n    // TODO add proxy support\n\n    this._initWith = (x: unknown) => {\n      return new Api.InvokeWithLayer({\n        layer: LAYER,\n        query: new Api.InitConnection({\n          apiId: this.apiId,\n          deviceModel: args.deviceModel || os.type()\n            .toString() || 'Unknown',\n          systemVersion: args.systemVersion || os.release()\n            .toString() || '1.0',\n          appVersion: args.appVersion || '1.0',\n          langCode: args.langCode,\n          langPack: args.langPack,\n          systemLangCode: args.systemLangCode,\n          query: x,\n          proxy: undefined, // no proxies yet.\n        }),\n      });\n    };\n\n    this._args = args;\n  }\n\n  // region Connecting\n\n  /**\n     * Connects to the Telegram servers, executing authentication if required.\n     * Note that authenticating to the Telegram servers is not the same as authenticating\n     * the app, which requires to send a code first.\n     * @returns {Promise<void>}\n     */\n  async connect() {\n    await this._initSession();\n\n    if (this._sender === undefined) {\n      // only init sender once to avoid multiple loops.\n      this._sender = new MTProtoSender(this.session.getAuthKey(), {\n        logger: this._log,\n        dcId: this.session.dcId,\n        retries: this._connectionRetries,\n        retriesToFallback: this._connectionRetriesToFallback,\n        shouldForceHttpTransport: this._shouldForceHttpTransport,\n        shouldAllowHttpTransport: this._shouldAllowHttpTransport,\n        delay: this._retryDelay,\n        retryMainConnectionDelay: this._retryMainConnectionDelay,\n        autoReconnect: this._autoReconnect,\n        connectTimeout: this._timeout,\n        authKeyCallback: this._authKeyCallback.bind(this),\n        updateCallback: this._handleUpdate.bind(this),\n        getShouldDebugExportedSenders: this.getShouldDebugExportedSenders.bind(this),\n        isMainSender: true,\n      });\n    }\n\n    const connection = new this._connection({\n      ip: this.session.serverAddress,\n      port: this.session.port,\n      dcId: this.session.dcId,\n      loggers: this._log,\n      isTestServer: this.session.isTestServer,\n    });\n    const fallbackConnection = new this._fallbackConnection({\n      ip: this.session.serverAddress,\n      port: this.session.port,\n      dcId: this.session.dcId,\n      loggers: this._log,\n      isTestServer: this.session.isTestServer,\n    });\n\n    const newConnection = await this._sender.connect(connection, false, fallbackConnection);\n    if (!newConnection) {\n      // we're already connected so no need to reset auth key.\n      if (!this._loopStarted) {\n        this._updateLoop();\n        this._loopStarted = true;\n      }\n      return;\n    }\n\n    this.session.setAuthKey(this._sender.authKey);\n    // `_initWith` is used to announce our API layer to the server\n    await this._sender.send(this._initWith(\n      new Api.help.GetConfig(),\n    ));\n\n    if (!this._loopStarted) {\n      this._updateLoop();\n      this._loopStarted = true;\n    }\n    this._connectedDeferred.resolve();\n    this._isSwitchingDc = false;\n\n    // Prepare file connection on current DC to speed up initial media loading\n    const mediaSender = await this._borrowExportedSender(this.session.dcId, false, undefined, 0, this.isPremium);\n    if (mediaSender) this.releaseExportedSender(mediaSender);\n  }\n\n  async _initSession() {\n    await this.session.load();\n\n    if (!this.session.serverAddress || (this.session.serverAddress.includes(':') !== this._useIPV6)) {\n      const DC = getDC(this.defaultDcId);\n      // TODO Fill IP addresses for when `this._useIPV6` is used\n      this.session.setDC(\n        this.defaultDcId, DC.ipAddress, this._args.useWSS ? 443 : 80, this._args.isTestServerRequested,\n      );\n    }\n  }\n\n  setPingCallback(callback: () => Promise<void>) {\n    this.pingCallback = callback;\n  }\n\n  async setForceHttpTransport(forceHttpTransport: boolean) {\n    this._shouldForceHttpTransport = forceHttpTransport;\n    this.disconnect();\n    this._sender = undefined;\n    await this.connect();\n  }\n\n  async setAllowHttpTransport(allowHttpTransport: boolean) {\n    this._shouldAllowHttpTransport = allowHttpTransport;\n    this.disconnect();\n    this._sender = undefined;\n    await this.connect();\n  }\n\n  setShouldDebugExportedSenders(shouldDebugExportedSenders: boolean) {\n    this._shouldDebugExportedSenders = shouldDebugExportedSenders;\n  }\n\n  getShouldDebugExportedSenders() {\n    return this._shouldDebugExportedSenders;\n  }\n\n  async _updateLoop() {\n    let lastPongAt;\n\n    const sender = this._sender;\n    if (!sender) {\n      throw new Error('Sender is not initialized');\n    }\n\n    while (!this._destroyed) {\n      await sleep(PING_INTERVAL);\n      if (sender.isReconnecting || this._isSwitchingDc) {\n        lastPongAt = undefined;\n        continue;\n      }\n\n      try {\n        const ping = () => {\n          if (this._destroyed) {\n            return undefined;\n          }\n          return sender.send(new Api.PingDelayDisconnect({\n            pingId: generateRandomBigInt(),\n            disconnectDelay: PING_DISCONNECT_DELAY,\n          }));\n        };\n\n        const pingAt = Date.now();\n        const lastInterval = lastPongAt ? pingAt - lastPongAt : undefined;\n\n        if (!lastInterval || lastInterval < PING_INTERVAL_TO_WAKE_UP) {\n          await attempts(() => timeout(ping, PING_TIMEOUT), PING_FAIL_ATTEMPTS, PING_FAIL_INTERVAL);\n        } else {\n          let wakeUpWarningTimeout: TimeoutId | undefined = setTimeout(() => {\n            this._handleUpdate(new UpdateConnectionState(UpdateConnectionState.disconnected));\n            wakeUpWarningTimeout = undefined;\n          }, PING_WAKE_UP_WARNING_TIMEOUT);\n\n          await timeout(ping, PING_WAKE_UP_TIMEOUT);\n\n          if (wakeUpWarningTimeout) {\n            clearTimeout(wakeUpWarningTimeout);\n            wakeUpWarningTimeout = undefined;\n          }\n\n          this._handleUpdate(new UpdateConnectionState(UpdateConnectionState.connected));\n        }\n\n        lastPongAt = Date.now();\n      } catch (err) {\n        // eslint-disable-next-line no-console\n        console.warn(err);\n\n        lastPongAt = undefined;\n\n        if (sender.isReconnecting || this._isSwitchingDc) {\n          continue;\n        }\n        if (this._destroyed) {\n          break;\n        }\n        sender.reconnect();\n      }\n\n      // We need to send some content-related request at least hourly\n      // for Telegram to keep delivering updates, otherwise they will\n      // just stop even if we're connected. Do so every 30 minutes.\n\n      if (Date.now() - this._lastRequest > 30 * 60 * 1000) {\n        try {\n          await this.pingCallback?.();\n        } catch (e: unknown) {\n          // we don't care about errors here\n        }\n\n        lastPongAt = undefined;\n      }\n    }\n    this.disconnect();\n  }\n\n  /**\n     * Disconnects from the Telegram server\n     * @returns {Promise<void>}\n     */\n  disconnect() {\n    this._sender?.disconnect();\n\n    Object.values(this._exportedSenderPromises)\n      .forEach((promises) => {\n        Object.values(promises).forEach((promise) => {\n          promise?.then((sender) => sender?.disconnect());\n        });\n      });\n\n    Object.values(this._exportedSenderReleaseTimeouts).forEach((timeouts) => {\n      Object.values(timeouts).forEach((releaseTimeout) => {\n        clearTimeout(releaseTimeout);\n      });\n    });\n\n    this._exportedSenderRefCounter = {};\n    this._exportedSenderPromises = {};\n    this._waitingForAuthKey = {};\n  }\n\n  /**\n     * Disconnects all senders and removes all handlers\n     * @returns {Promise<void>}\n     */\n  destroy() {\n    this._destroyed = true;\n\n    try {\n      this.disconnect();\n      this._sender?.destroy();\n    } catch (err) {\n      // Do nothing\n    }\n\n    this.session.delete();\n    this._eventBuilders = [];\n  }\n\n  async _switchDC(newDc: number) {\n    if (!this._sender) {\n      throw new Error('Sender is not initialized');\n    }\n\n    this._log.info(`Reconnecting to new data center ${newDc}`);\n    const DC = getDC(newDc);\n    const isTestServer = this.session.isTestServer || this._args.isTestServerRequested;\n    this.session.setDC(newDc, DC.ipAddress, DC.port, isTestServer);\n    // authKey's are associated with a server, which has now changed\n    // so it's not valid anymore. Set to None to force recreating it.\n    await this._sender.authKey.setKey(undefined);\n    this.session.setAuthKey(undefined);\n    this._isSwitchingDc = true;\n    this.disconnect();\n    this._sender = undefined;\n    return this.connect();\n  }\n\n  _authKeyCallback(authKey: AuthKey, dcId: number) {\n    this.session.setAuthKey(authKey, dcId);\n  }\n\n  // endregion\n  // export region\n\n  async _cleanupExportedSender(dcId: number, index: number) {\n    if (this.session.dcId !== dcId) {\n      this.session.setAuthKey(undefined, dcId);\n    }\n    // eslint-disable-next-line no-console\n    if (this._shouldDebugExportedSenders) console.log(` Cleanup idx=${index} dcId=${dcId}`);\n    const sender = await this._exportedSenderPromises[dcId][index];\n    delete this._exportedSenderPromises[dcId][index];\n    delete this._exportedSenderRefCounter[dcId][index];\n    sender?.disconnect();\n  }\n\n  async _cleanupExportedSenders(dcId: number) {\n    const promises = Object.values(this._exportedSenderPromises[dcId]);\n    if (!promises.length) {\n      return;\n    }\n\n    if (this.session.dcId !== dcId) {\n      this.session.setAuthKey(undefined, dcId);\n    }\n\n    this._exportedSenderPromises[dcId] = {};\n    this._exportedSenderRefCounter[dcId] = {};\n\n    await Promise.all(promises.map(async (promise) => {\n      const sender = await promise;\n      sender?.disconnect();\n    }));\n  }\n\n  async _connectSender(sender: MTProtoSender, dcId: number, index?: number, isPremium = false) {\n    // if we don't already have an auth key we want to use normal DCs not -1\n    let hasAuthKey = Boolean(sender.authKey.getKey());\n    let firstConnectResolver: (() => void) | undefined;\n\n    if (!hasAuthKey) {\n      if (this._waitingForAuthKey[dcId]) {\n        await this._waitingForAuthKey[dcId];\n\n        const authKey = this.session.getAuthKey(dcId);\n\n        hasAuthKey = Boolean(sender.authKey?.getKey());\n        if (hasAuthKey) {\n          await sender.authKey.setKey(authKey.getKey());\n        }\n      } else {\n        this._waitingForAuthKey[dcId] = new Promise((resolve) => {\n          firstConnectResolver = resolve;\n        });\n      }\n    }\n\n    const dc = getDC(dcId, hasAuthKey);\n\n    while (true) {\n      try {\n        await sender.connect(new this._connection({\n          ip: dc.ipAddress,\n          port: dc.port,\n          dcId,\n          loggers: this._log,\n          isTestServer: this.session.isTestServer,\n          // Premium DCs are not stable for obtaining auth keys, so need to we first connect to regular ones\n          isPremium: hasAuthKey ? isPremium : false,\n        }), false, new this._fallbackConnection({\n          ip: dc.ipAddress,\n          port: dc.port,\n          dcId,\n          loggers: this._log,\n          isTestServer: this.session.isTestServer,\n          isPremium: hasAuthKey ? isPremium : false,\n        }));\n\n        if (this.session.dcId !== dcId && !sender._authenticated) {\n          // Prevent another connection from trying to export the auth key while we're doing it\n          await navigator.locks.request('GRAMJS_AUTH_EXPORT', async () => {\n            this._log.info(`Exporting authorization for data center ${dc.ipAddress}`);\n            const auth = await this.invoke(new Api.auth.ExportAuthorization({ dcId }));\n\n            const req = this._initWith(new Api.auth.ImportAuthorization({\n              id: auth.id,\n              bytes: auth.bytes,\n            }));\n            await sender.send(req);\n            sender._authenticated = true;\n          });\n        }\n\n        sender._dcId = dcId;\n        sender.userDisconnected = false;\n\n        if (firstConnectResolver) {\n          firstConnectResolver();\n          delete this._waitingForAuthKey[dcId];\n        }\n\n        if (this._shouldDebugExportedSenders) {\n          // eslint-disable-next-line no-console\n          console.warn(` Connected to exported sender idx=${index} dc=${dcId}`);\n        }\n\n        return sender;\n      } catch (err: any) {\n        if (this._shouldDebugExportedSenders) {\n          // eslint-disable-next-line no-console\n          console.error(` ERROR! idx=${index} dcId=${dcId} ${err.message}`);\n        }\n        // eslint-disable-next-line no-console\n        console.error(err);\n\n        await sleep(1000);\n        sender.disconnect();\n      }\n    }\n  }\n\n  releaseExportedSender(sender: MTProtoSender) {\n    const dcId = sender._dcId;\n    const index = sender._senderIndex;\n\n    if (!this._exportedSenderRefCounter[dcId]) return;\n    if (!this._exportedSenderRefCounter[dcId][index]) return;\n\n    this._exportedSenderRefCounter[dcId][index] -= 1;\n\n    if (this._exportedSenderRefCounter[dcId][index] <= 0) {\n      if (!this._exportedSenderReleaseTimeouts[dcId]) this._exportedSenderReleaseTimeouts[dcId] = {};\n\n      this._exportedSenderReleaseTimeouts[dcId][index] = setTimeout(() => {\n        // eslint-disable-next-line no-console\n        if (this._shouldDebugExportedSenders) console.log(`[CC] [idx=${index} dcId=${dcId}]  Release`);\n        sender.disconnect();\n        this._exportedSenderReleaseTimeouts[dcId][index] = undefined;\n        this._exportedSenderPromises[dcId][index] = undefined;\n      }, EXPORTED_SENDER_RELEASE_TIMEOUT);\n    }\n  }\n\n  async _borrowExportedSender(\n    dcId: number, shouldReconnect?: boolean, existingSender?: MTProtoSender, index?: number, isPremium?: boolean,\n  ): Promise<MTProtoSender> {\n    const i = index || 0;\n\n    let shouldAnnounceLayer = false;\n    if (!this._exportedSenderPromises[dcId]) {\n      this._exportedSenderPromises[dcId] = {};\n      shouldAnnounceLayer = true;\n    }\n    if (!this._exportedSenderRefCounter[dcId]) this._exportedSenderRefCounter[dcId] = {};\n\n    if (!this._exportedSenderPromises[dcId][i] || shouldReconnect) {\n      if (this._shouldDebugExportedSenders) {\n        // eslint-disable-next-line no-console\n        console.warn(` Connecting to exported sender idx=${i} dc=${dcId}`\n          + ` ${shouldReconnect ? '(reconnect)' : ''}`);\n      }\n      this._exportedSenderRefCounter[dcId][i] = 0;\n      this._exportedSenderPromises[dcId][i] = this._connectSender(\n        existingSender || this._createExportedSender(dcId, i),\n        dcId,\n        index,\n        isPremium,\n      );\n    }\n\n    let sender;\n    try {\n      sender = await this._exportedSenderPromises[dcId][i];\n\n      if (!sender?.isConnected()) {\n        if (sender?.isConnecting) {\n          await sleep(EXPORTED_SENDER_RECONNECT_TIMEOUT);\n          return this._borrowExportedSender(dcId, false, sender, i, isPremium);\n        } else {\n          return this._borrowExportedSender(dcId, true, sender, i, isPremium);\n        }\n      }\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(err);\n\n      return this._borrowExportedSender(dcId, true, undefined, i, isPremium);\n    }\n\n    this._exportedSenderRefCounter[dcId][i] += 1;\n    if (!this._exportedSenderReleaseTimeouts[dcId]) this._exportedSenderReleaseTimeouts[dcId] = {};\n    if (this._exportedSenderReleaseTimeouts[dcId][i]) {\n      clearTimeout(this._exportedSenderReleaseTimeouts[dcId][i]);\n      this._exportedSenderReleaseTimeouts[dcId][i] = undefined;\n    }\n\n    if (shouldAnnounceLayer) {\n      // Dummy request to let DC know about our API layer\n      sender.send(this._initWith(new Api.help.GetConfig()));\n    }\n\n    return sender;\n  }\n\n  _createExportedSender(dcId: number, index: number) {\n    return new MTProtoSender(this.session.getAuthKey(dcId), {\n      logger: this._log,\n      dcId,\n      senderIndex: index,\n      retries: this._connectionRetries,\n      retriesToFallback: this._connectionRetriesToFallback,\n      delay: this._retryDelay,\n      retryMainConnectionDelay: this._retryMainConnectionDelay,\n      shouldForceHttpTransport: this._shouldForceHttpTransport,\n      shouldAllowHttpTransport: this._shouldAllowHttpTransport,\n      autoReconnect: this._autoReconnect,\n      connectTimeout: this._timeout,\n      authKeyCallback: this._authKeyCallback.bind(this),\n      isMainSender: dcId === this.session.dcId,\n      isExported: true,\n      updateCallback: this._handleUpdate.bind(this),\n      getShouldDebugExportedSenders: this.getShouldDebugExportedSenders.bind(this),\n      onConnectionBreak: () => this._cleanupExportedSender(dcId, index),\n    });\n  }\n\n  getSender(dcId: number, index?: number, isPremium?: boolean) {\n    return dcId\n      ? this._borrowExportedSender(dcId, undefined, undefined, index, isPremium)\n      : Promise.resolve(this._sender!);\n  }\n\n  // end region\n\n  // download region\n\n  /**\n     * Complete flow to download a file.\n     * @param inputLocation {Api.InputFileLocation}\n     * @param [args[partSizeKb] {number}]\n     * @param [args[fileSize] {number}]\n     * @param [args[progressCallback] {Function}]\n     * @param [args[start] {number}]\n     * @param [args[end] {number}]\n     * @param [args[dcId] {number}]\n     * @param [args[workers] {number}]\n     * @param [args[isPriority] {boolean}]\n     * @returns {Promise<Buffer>}\n     */\n  downloadFile(inputLocation: Api.TypeInputFileLocation, args: DownloadFileWithDcParams) {\n    return downloadFile(this, inputLocation, args, this._shouldDebugExportedSenders);\n  }\n\n  downloadMedia(\n    entityOrMedia: Api.TypeMessage | Api.TypeMessageMedia | Api.TypePhoto | Api.TypeDocument | Api.TypeWebDocument,\n    args: DownloadMediaParams & Partial<DownloadFileParams>,\n  ) {\n    let media;\n    if (entityOrMedia instanceof Api.Message || entityOrMedia instanceof Api.StoryItem) {\n      media = entityOrMedia.media;\n    } else if (entityOrMedia instanceof Api.MessageService) {\n      const action = entityOrMedia.action;\n      if ('photo' in action) {\n        media = action.photo;\n      }\n    } else {\n      media = entityOrMedia;\n    }\n\n    if (media instanceof Api.MessageMediaWebPage) {\n      if (media.webpage instanceof Api.WebPage) {\n        media = media.webpage.document || media.webpage.photo;\n      }\n    }\n    if (media instanceof Api.MessageMediaPhoto || media instanceof Api.Photo) {\n      return this._downloadPhoto(media, args);\n    } else if (media instanceof Api.MessageMediaDocument || media instanceof Api.Document) {\n      return this._downloadDocument(media, args);\n    } else if (media instanceof Api.WebDocument || media instanceof Api.WebDocumentNoProxy) {\n      return this._downloadWebDocument(media);\n    }\n    return undefined;\n  }\n\n  downloadProfilePhoto(entity: Api.User | Api.Chat, isBig = false) {\n    const photo = entity.photo;\n\n    if (!(photo instanceof Api.UserProfilePhoto\n      || photo instanceof Api.ChatPhoto)) return undefined;\n\n    const dcId = photo.dcId;\n    const loc = new Api.InputPeerPhotoFileLocation({\n      peer: getInputPeer(entity),\n      photoId: photo.photoId,\n      big: isBig || undefined,\n    });\n\n    return this.downloadFile(loc, {\n      dcId,\n      isPriority: true,\n    }) as Promise<Buffer<ArrayBuffer> | undefined>; // Profile photo cannot be larger than 2GB, right?\n  }\n\n  downloadStickerSetThumb(stickerSet: Api.StickerSet) {\n    if (!stickerSet.thumbs?.length && !stickerSet.thumbDocumentId) {\n      return undefined;\n    }\n\n    const thumbVersion = stickerSet.thumbVersion!;\n\n    if (!stickerSet.thumbDocumentId) {\n      return this.downloadFile(\n        new Api.InputStickerSetThumb({\n          stickerset: new Api.InputStickerSetID({\n            id: stickerSet.id,\n            accessHash: stickerSet.accessHash,\n          }),\n          thumbVersion,\n        }),\n        { dcId: stickerSet.thumbDcId! },\n      ) as Promise<Buffer<ArrayBuffer> | undefined>; // Sticker thumb cannot be larger than 2GB, right?\n    }\n\n    return this.invoke(new Api.messages.GetCustomEmojiDocuments({\n      documentId: [stickerSet.thumbDocumentId],\n    })).then((docs) => {\n      const doc = docs[0];\n      if (!doc || doc instanceof Api.DocumentEmpty) {\n        return undefined;\n      }\n\n      return this.downloadFile(new Api.InputDocumentFileLocation({\n        id: doc.id,\n        accessHash: doc.accessHash,\n        fileReference: doc.fileReference,\n        thumbSize: '',\n      }),\n      {\n        fileSize: toJSNumber(doc.size),\n        dcId: doc.dcId,\n      }) as Promise<Buffer<ArrayBuffer> | undefined>; // Sticker thumb cannot be larger than 2GB, right?\n    });\n  }\n\n  pickFileSize(sizes: (Api.TypePhotoSize | Api.TypeVideoSize)[], sizeType?: SizeType) {\n    if (!sizes?.length) return undefined;\n    if (!sizeType) {\n      const maxSize = sizes.reduce((max, current) => {\n        if (!('w' in current)) return max;\n        if (!max || !('w' in max)) return current;\n        return max.w > current.w ? max : current;\n      }, undefined as Api.TypePhotoSize | Api.TypeVideoSize | undefined);\n      return maxSize;\n    }\n\n    const indexOfSize = sizeTypes.indexOf(sizeType);\n    let size;\n    for (let i = indexOfSize; i < sizeTypes.length; i++) {\n      size = sizes.find((s) => 'type' in s && s.type === sizeTypes[i]);\n      if (size) {\n        return size;\n      }\n    }\n    return undefined;\n  }\n\n  _downloadCachedPhotoSize(size: Api.PhotoCachedSize | Api.PhotoStrippedSize): Buffer<ArrayBuffer> {\n    // No need to download anything, simply write the bytes\n    let data;\n    if (size instanceof Api.PhotoStrippedSize) {\n      data = strippedPhotoToJpg(size.bytes);\n    } else {\n      data = size.bytes;\n    }\n    return data;\n  }\n\n  _downloadPhoto(media: Api.MessageMediaPhoto | Api.TypePhoto, args: DownloadMediaParams) {\n    let photo = media;\n    if (media instanceof Api.MessageMediaPhoto && media.photo instanceof Api.Photo) {\n      photo = media.photo;\n    }\n\n    if (!(photo instanceof Api.Photo)) {\n      return undefined;\n    }\n\n    const isVideoSize = args.sizeType === 'u' || args.sizeType === 'v';\n    const videoSizes = isVideoSize ? photo.videoSizes! : [];\n    const size = this.pickFileSize([...videoSizes, ...photo.sizes], args.sizeType);\n\n    if (!size\n      || size instanceof Api.PhotoSizeEmpty\n      || size instanceof Api.VideoSizeEmojiMarkup\n      || size instanceof Api.VideoSizeStickerMarkup) {\n      return undefined;\n    }\n\n    if (size instanceof Api.PhotoCachedSize || size instanceof Api.PhotoStrippedSize) {\n      return this._downloadCachedPhotoSize(size);\n    }\n\n    let fileSize: number;\n    if (size instanceof Api.PhotoSizeProgressive) {\n      fileSize = Math.max(...size.sizes);\n    } else {\n      fileSize = 'size' in size ? size.size : 512;\n    }\n\n    return this.downloadFile(\n      new Api.InputPhotoFileLocation({\n        id: photo.id,\n        accessHash: photo.accessHash,\n        fileReference: photo.fileReference,\n        thumbSize: size.type,\n      }),\n      {\n        dcId: photo.dcId,\n        fileSize,\n        progressCallback: args.progressCallback,\n      },\n    );\n  }\n\n  _downloadDocument(\n    media: Api.MessageMediaDocument | Api.TypeDocument, args: DownloadMediaParams & DownloadFileParams,\n  ) {\n    let doc = media;\n    if (doc instanceof Api.MessageMediaDocument && doc.document instanceof Api.Document) {\n      doc = doc.document;\n    }\n    if (!(doc instanceof Api.Document)) {\n      return undefined;\n    }\n\n    let size;\n    if (args.sizeType) {\n      size = this.pickFileSize([...(doc.thumbs || []), ...(doc.videoThumbs || [])], args.sizeType);\n      if (!size && doc.mimeType.startsWith('video/')) {\n        return undefined;\n      }\n\n      if (size && (size instanceof Api.PhotoCachedSize\n        || size instanceof Api.PhotoStrippedSize)) {\n        return this._downloadCachedPhotoSize(size);\n      }\n    }\n\n    return this.downloadFile(\n      new Api.InputDocumentFileLocation({\n        id: doc.id,\n        accessHash: doc.accessHash,\n        fileReference: doc.fileReference,\n        thumbSize: size && 'type' in size ? size.type : '',\n      }),\n      {\n        fileSize: size && 'size' in size ? size.size : toJSNumber(doc.size),\n        progressCallback: args.progressCallback,\n        start: args.start,\n        end: args.end,\n        dcId: doc.dcId,\n        workers: args.workers,\n      },\n    );\n  }\n\n  async _downloadWebDocument(media: Api.TypeWebDocument) {\n    if (media instanceof Api.WebDocumentNoProxy) {\n      const arrayBuff = await fetch(media.url).then((res) => res.arrayBuffer());\n      return Buffer.from(arrayBuff);\n    }\n\n    try {\n      const buff = [];\n      let offset = 0;\n\n      while (true) {\n        const downloaded = new Api.upload.GetWebFile({\n          location: new Api.InputWebFileLocation({\n            url: media.url,\n            accessHash: media.accessHash,\n          }),\n          offset,\n          limit: WEBDOCUMENT_REQUEST_PART_SIZE,\n        });\n\n        const sender = await this._borrowExportedSender(\n          this._config?.webfileDcId || DEFAULT_WEBDOCUMENT_DC_ID,\n        );\n        if (!sender) {\n          throw new Error('Failed to obtain sender');\n        }\n        const res = (await sender.send(downloaded))!;\n        this.releaseExportedSender(sender);\n        offset += WEBDOCUMENT_REQUEST_PART_SIZE;\n        if (res.bytes.length) {\n          buff.push(res.bytes);\n          if (res.bytes.length < WEBDOCUMENT_REQUEST_PART_SIZE) {\n            break;\n          }\n        } else {\n          break;\n        }\n      }\n      return Buffer.concat(buff);\n    } catch (err: unknown) {\n      // the file is no longer saved in telegram's cache.\n      if (err instanceof RPCError && err.errorMessage === 'WEBFILE_NOT_AVAILABLE') {\n        return Buffer.alloc(0);\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  async downloadStaticMap(\n    accessHash: bigint,\n    long: number,\n    lat: number,\n    w: number,\n    h: number,\n    zoom: number,\n    scale: number,\n    accuracyRadius?: number,\n  ) {\n    try {\n      const buff = [];\n      let offset = 0;\n\n      while (true) {\n        try {\n          const downloaded = new Api.upload.GetWebFile({\n            location: new Api.InputWebFileGeoPointLocation({\n              geoPoint: new Api.InputGeoPoint({\n                lat,\n                long,\n                accuracyRadius,\n              }),\n              accessHash,\n              w,\n              h,\n              zoom,\n              scale,\n            }),\n            offset,\n            limit: WEBDOCUMENT_REQUEST_PART_SIZE,\n          });\n          const sender = await this._borrowExportedSender(DEFAULT_WEBDOCUMENT_DC_ID);\n          if (!sender) {\n            throw new Error('Failed to obtain sender');\n          }\n          const res = (await sender.send(downloaded))!;\n          this.releaseExportedSender(sender);\n          offset += WEBDOCUMENT_REQUEST_PART_SIZE;\n          if (res.bytes.length) {\n            buff.push(res.bytes);\n            if (res.bytes.length < WEBDOCUMENT_REQUEST_PART_SIZE) {\n              break;\n            }\n          } else {\n            break;\n          }\n        } catch (err) {\n          if (err instanceof FloodWaitError) {\n            // eslint-disable-next-line no-console\n            console.warn(`getWebFile: sleeping for ${err.seconds}s on flood wait`);\n            await sleep(err.seconds * 1000);\n            continue;\n          }\n        }\n      }\n      return Buffer.concat(buff);\n    } catch (err: unknown) {\n      if (err instanceof RPCError && err.errorMessage === 'WEBFILE_NOT_AVAILABLE') {\n        return Buffer.alloc(0);\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  // region Invoking Telegram request\n  /**\n     * Invokes a MTProtoRequest (sends and receives it) and returns its result\n     * @param request\n     * @param dcId Optional dcId to use when sending the request\n     * @param abortSignal Optional AbortSignal to cancel the request\n     * @param shouldRetryOnTimeout Whether to retry the request if it times out\n     * @returns {Promise}\n     */\n\n  async invoke<R extends Api.AnyRequest>(\n    request: R, dcId?: number, abortSignal?: AbortSignal, shouldRetryOnTimeout?: boolean,\n  ): Promise<R['__response']> {\n    if (request.classType !== 'request') {\n      throw new Error('You can only invoke MTProtoRequests');\n    }\n\n    const isExported = dcId !== undefined;\n    let sender = (!isExported ? this._sender : await this.getSender(dcId))!;\n    this._lastRequest = Date.now();\n\n    await this._connectedDeferred.promise;\n\n    const state = new RequestState(request, abortSignal);\n\n    let attempt = 0;\n    for (attempt = 0; attempt < this._requestRetries; attempt++) {\n      sender.addStateToQueue(state);\n      try {\n        const result = await state.promise;\n        state.finished.resolve();\n        if (isExported) this.releaseExportedSender(sender);\n        return result;\n      } catch (e: unknown) {\n        if (e instanceof ServerError\n          || (e instanceof RPCError && (\n            e.errorMessage === 'RPC_CALL_FAIL'\n            || e.errorMessage === 'RPC_MCGET_FAIL'\n            || e.errorMessage.match(/INTERDC_\\d_CALL(_RICH)?_ERROR/)\n          ))\n        ) {\n          this._log.warn(`Telegram is having internal issues ${e.constructor.name}`);\n          await sleep(2000);\n        } else if (e instanceof FloodWaitError || e instanceof FloodTestPhoneWaitError) {\n          if (e.seconds <= this.floodSleepLimit) {\n            this._log.info(`Sleeping for ${e.seconds}s on flood wait`);\n            await sleep(e.seconds * 1000);\n          } else {\n            state.finished.resolve();\n            if (isExported) this.releaseExportedSender(sender);\n            throw e;\n          }\n        } else if (e instanceof PhoneMigrateError || e instanceof NetworkMigrateError\n          || e instanceof UserMigrateError) {\n          this._log.info(`Phone migrated to ${e.newDc}`);\n          const shouldRaise = e instanceof PhoneMigrateError\n            || e instanceof NetworkMigrateError;\n          if (shouldRaise && await checkAuthorization(this)) {\n            state.finished.resolve();\n            if (isExported) this.releaseExportedSender(sender);\n            throw e;\n          }\n          await this._switchDC(e.newDc);\n          if (isExported) this.releaseExportedSender(sender);\n          sender = (dcId === undefined ? this._sender : await this.getSender(dcId))!;\n        } else if (e instanceof MsgWaitError) {\n          // We need to resend this after the old one was confirmed.\n          await state.isReady();\n\n          state.after = undefined;\n        } else if (e instanceof RPCError && e.errorMessage === 'CONNECTION_NOT_INITED') {\n          this.disconnect();\n          await sleep(2000);\n          await this.connect();\n        } else if (e instanceof TimedOutError) {\n          if (!shouldRetryOnTimeout) {\n            state.finished.resolve();\n            if (isExported) this.releaseExportedSender(sender);\n            throw e;\n          }\n        } else {\n          state.finished.resolve();\n          if (isExported) this.releaseExportedSender(sender);\n          throw e;\n        }\n      }\n\n      state.resetPromise();\n    }\n    if (isExported) this.releaseExportedSender(sender);\n    throw new Error(`Request was unsuccessful ${attempt} time(s)`);\n  }\n\n  async invokeBeacon(request: Api.AnyRequest, dcId?: number) {\n    if (request.classType !== 'request') {\n      throw new Error('You can only invoke MTProtoRequests');\n    }\n\n    const isExported = dcId !== undefined;\n    const sender = (!isExported ? this._sender : await this.getSender(dcId))!;\n\n    sender.sendBeacon(request);\n\n    if (isExported) this.releaseExportedSender(sender);\n  }\n\n  setIsPremium(isPremium: boolean) {\n    this.isPremium = isPremium;\n  }\n\n  async getMe() {\n    try {\n      return (await this.invoke(\n        new Api.users.GetUsers({\n          id: [new Api.InputUserSelf()],\n        }),\n      ))[0];\n    } catch (e: any) {\n      this._log.warn('error while getting me');\n      this._log.warn(e);\n    }\n    return undefined;\n  }\n\n  async loadConfig() {\n    if (!this._config) {\n      this._config = await this.invoke(new Api.help.GetConfig());\n    }\n  }\n\n  async start(authParams: UserAuthParams, onConnected?: NoneToVoidFunction) {\n    if (!this.isConnected()) {\n      await this.connect();\n    }\n    onConnected?.();\n\n    this.loadConfig();\n\n    if (await checkAuthorization(this, authParams.shouldThrowIfUnauthorized)) {\n      return;\n    }\n\n    const apiCredentials = {\n      apiId: this.apiId,\n      apiHash: this.apiHash,\n    };\n\n    await authFlow(this, apiCredentials, authParams);\n  }\n\n  uploadFile(fileParams: UploadFileParams) {\n    return uploadFile(this, fileParams, this._shouldDebugExportedSenders);\n  }\n\n  updateTwoFaSettings(params: TwoFaParams) {\n    return updateTwoFaSettings(this, params);\n  }\n\n  getTmpPassword(currentPassword: string, ttl?: number): Promise<TmpPasswordResult> {\n    return getTmpPassword(this, currentPassword, ttl);\n  }\n\n  getCurrentPassword(currentPassword?: string): Promise<PasswordResult | undefined> {\n    return getCurrentPassword(this, currentPassword);\n  }\n\n  // event region\n  addEventHandler(callback: CallableFunction, event: EventBuilder) {\n    this._eventBuilders.push([event, callback]);\n  }\n\n  _handleUpdate(update: Update) {\n    // this.session.processEntities(update)\n    // this._entityCache.add(update)\n\n    if (update instanceof Api.Updates || update instanceof Api.UpdatesCombined) {\n      // TODO deal with entities\n      const entities = [];\n      for (const x of [...update.users, ...update.chats]) {\n        entities.push(x);\n      }\n      this._processUpdate(update, entities);\n    } else if (update instanceof Api.UpdateShort) {\n      this._processUpdate(update.update, undefined);\n    } else {\n      this._processUpdate(update, undefined);\n    }\n  }\n\n  _processUpdate(update: Update, entities: (Api.TypeUser | Api.TypeChat)[] | undefined) {\n    update._entities = entities || [];\n    const args = {\n      update,\n    };\n    this._dispatchUpdate(args);\n  }\n\n  // endregion\n\n  async _dispatchUpdate(args: {\n    update: Update;\n  }) {\n    for (const [builder, callback] of this._eventBuilders) {\n      const event = builder.build(args.update);\n      if (event) {\n        await callback(event);\n      }\n    }\n  }\n\n  isConnected() {\n    if (this._sender) {\n      if (this._sender.isConnected()) {\n        return true;\n      }\n    }\n    return false;\n  }\n}\n\nfunction timeout(cb: () => void | Promise<unknown>, ms: number) {\n  let isResolved = false;\n\n  return Promise.race([\n    cb(),\n    sleep(ms).then(() => (isResolved ? undefined : Promise.reject(new Error('TIMEOUT')))),\n  ]).finally(() => {\n    isResolved = true;\n  });\n}\n\nasync function attempts(cb: () => Promise<unknown> | void, times: number, pause: number) {\n  for (let i = 0; i < times; i++) {\n    try {\n      // We need to `return await` here so it can be caught locally\n\n      return await cb();\n    } catch (err) {\n      if (i === times - 1) {\n        throw err;\n      }\n\n      await sleep(pause);\n    }\n  }\n  return undefined;\n}\n\nexport default TelegramClient;\n","/**\n * Get Recent Actions tool - Get recent admin actions (admin log) in a group or channel\n */\n\nimport { Api as GramJs } from '../../../../lib/gramjs';\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { buildInputChannel } from '../../../../api/gramjs/gramjsBuilders';\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_recent_actions',\n  description: 'Get recent admin actions (admin log) in a group or channel',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n    },\n    required: ['chat_id'],\n  },\n};\n\nexport async function getRecentActions(\n  args: { chat_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    if (!chat.accessHash) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'This chat does not support admin log',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const channel = buildInputChannel(chat.id, chat.accessHash);\n    const result = await callApi('invokeRequest', new GramJs.channels.GetAdminLog({\n      channel,\n      q: '',\n      eventsFilter: undefined,\n      admins: [],\n      maxId: BigInt(0),\n      minId: BigInt(0),\n      limit: 20,\n    }));\n\n    if (!result || !('events' in result) || !result.events || result.events.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No recent admin actions found.',\n          },\n        ],\n      };\n    }\n\n    const events = result.events.map((event: any) => ({\n      id: String(event.id),\n      date: event.date,\n      userId: String(event.userId),\n      action: event.action.className,\n    }));\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify({ events, count: events.length }, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_recent_actions',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.ADMIN,\n    );\n  }\n}\n","/**\n * Create Poll tool - Create a poll in a chat using Telegram's native poll feature\n */\n\nimport type { ApiNewPoll } from '../../../../api/types';\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'create_poll',\n  description: 'Create a poll in a chat using Telegram\\'s native poll feature',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The ID of the chat to send the poll to',\n      },\n      question: {\n        type: 'string',\n        description: 'The poll question',\n      },\n      options: {\n        type: 'array',\n        items: { type: 'string' },\n        description: 'List of answer options (2-10 options)',\n      },\n      multiple_choice: {\n        type: 'boolean',\n        description: 'Whether users can select multiple answers',\n        default: false,\n      },\n      quiz_mode: {\n        type: 'boolean',\n        description: 'Whether this is a quiz (has correct answer)',\n        default: false,\n      },\n      public_votes: {\n        type: 'boolean',\n        description: 'Whether votes are public',\n        default: true,\n      },\n      close_date: {\n        type: 'string',\n        description: 'Optional close date in ISO format (YYYY-MM-DD HH:MM:SS)',\n      },\n    },\n    required: ['chat_id', 'question', 'options'],\n  },\n};\n\nexport async function createPoll(\n  args: {\n    chat_id: string | number;\n    question: string;\n    options: string[];\n    multiple_choice?: boolean;\n    quiz_mode?: boolean;\n    public_votes?: boolean;\n    close_date?: string;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const {\n      question, options, multiple_choice = false, quiz_mode = false, public_votes = true, close_date,\n    } = args;\n\n    // Validate options\n    if (options.length < 2) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Error: Poll must have at least 2 options.',\n          },\n        ],\n        isError: true,\n      };\n    }\n    if (options.length > 10) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Error: Poll can have at most 10 options.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Parse close date if provided\n    let closeDate: number | undefined;\n    if (close_date) {\n      try {\n        const date = new Date(close_date);\n        if (isNaN(date.getTime())) {\n          return {\n            content: [\n              {\n                type: 'text',\n                text: 'Invalid close_date format. Use YYYY-MM-DD HH:MM:SS format.',\n              },\n            ],\n            isError: true,\n          };\n        }\n        closeDate = Math.floor(date.getTime() / 1000);\n      } catch {\n        return {\n          content: [\n            {\n              type: 'text',\n              text: 'Invalid close_date format. Use YYYY-MM-DD HH:MM:SS format.',\n            },\n          ],\n          isError: true,\n        };\n      }\n    }\n\n    const poll: ApiNewPoll = {\n      summary: {\n        question: {\n          text: question,\n          entities: [],\n        },\n        answers: options.map((option, index) => ({\n          text: {\n            text: option,\n            entities: [],\n          },\n          option: String(index),\n        })),\n        ...(multiple_choice && { multipleChoice: true }),\n        ...(quiz_mode && { quiz: true }),\n        ...(public_votes && { isPublic: true }),\n        ...(closeDate && { closeDate }),\n      },\n    };\n\n    await callApi('sendMessage', {\n      chat,\n      poll,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Poll created successfully in chat ${chatId}.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'create_poll',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MSG,\n    );\n  }\n}\n","/**\n * Get Bot Info tool - Get information about a bot by username\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_bot_info',\n  description: 'Get information about a bot by username',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      bot_username: {\n        type: 'string',\n        description: 'The username of the bot (without @)',\n      },\n    },\n    required: ['bot_username'],\n  },\n};\n\nexport async function getBotInfo(\n  args: { bot_username: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { bot_username } = args;\n    const cleanUsername = bot_username.startsWith('@') ? bot_username.slice(1) : bot_username;\n\n    // First resolve the username to get the user\n    const resolvedPeer = await callApi('getChatByUsername', cleanUsername);\n\n    if (!resolvedPeer || !resolvedPeer.user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Bot with username ${bot_username} not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const user = resolvedPeer.user;\n    if (user.type !== 'userTypeBot') {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User ${bot_username} is not a bot.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Fetch full user info to get bot info\n    const fullUser = await callApi('fetchFullUser', {\n      id: user.id,\n      accessHash: user.accessHash,\n    });\n\n    const botInfo: Record<string, any> = {\n      id: user.id,\n      username: user.usernames?.[0]?.username,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      isBot: true,\n      isVerified: user.isVerified,\n    };\n\n    if (fullUser?.fullInfo) {\n      if (fullUser.fullInfo.botInfo) {\n        botInfo.description = fullUser.fullInfo.botInfo.description;\n        botInfo.commands = fullUser.fullInfo.botInfo.commands;\n      }\n      if (fullUser.fullInfo.bio) botInfo.bio = fullUser.fullInfo.bio;\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify({ bot_info: botInfo }, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_bot_info',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Set Bot Commands tool - Set bot commands for a bot you own\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getCurrentUser } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'set_bot_commands',\n  description: 'Set bot commands for a bot you own. Note: This function can only be used if the Telegram client is a bot account.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      bot_username: {\n        type: 'string',\n        description: 'The username of the bot to set commands for',\n      },\n      commands: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            command: { type: 'string' },\n            description: { type: 'string' },\n          },\n          required: ['command', 'description'],\n        },\n        description: 'List of command dictionaries with \\'command\\' and \\'description\\' keys',\n      },\n    },\n    required: ['bot_username', 'commands'],\n  },\n};\n\nexport async function setBotCommands(\n  args: { bot_username: string; commands: Array<{ command: string; description: string }> },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { bot_username, commands } = args;\n\n    // Check if current user is a bot\n    const currentUser = getCurrentUser();\n    if (!currentUser || !currentUser.isBot) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Error: This function can only be used by bot accounts. Your current Telegram account is a regular user account, not a bot.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Resolve bot username\n    const cleanUsername = bot_username.startsWith('@') ? bot_username.slice(1) : bot_username;\n    const resolvedPeer = await callApi('getChatByUsername', {\n      username: cleanUsername,\n    });\n\n    if (!resolvedPeer || !resolvedPeer.user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Bot with username ${bot_username} not found.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const bot = resolvedPeer.user;\n    if (!bot.isBot) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `User ${bot_username} is not a bot.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Set bot commands\n    await callApi('setBotInfo', {\n      bot,\n      langCode: 'en',\n      name: undefined,\n      about: undefined,\n      description: undefined,\n    });\n\n    // Note: The actual command setting might need a different API call\n    // This is a placeholder - the actual implementation may vary\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Bot commands set for ${bot_username}. Note: Command setting may require additional API support.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'set_bot_commands',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Get Privacy Settings tool - Get your privacy settings\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_privacy_settings',\n  description: 'Get your privacy settings for last seen status and other privacy options',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getPrivacySettings(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    // Get privacy settings for last seen (most common)\n    const result = await callApi('fetchPrivacySettings', {\n      privacyKey: 'lastSeen',\n    });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Could not fetch privacy settings.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify({\n            lastSeen: result.rules,\n          }, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_privacy_settings',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Set Privacy Settings tool - Set privacy settings (e.g., last seen, phone, etc.)\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById, getUserById } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'set_privacy_settings',\n  description: 'Set privacy settings (e.g., last seen, phone, etc.)',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      key: {\n        type: 'string',\n        description: 'The privacy setting to modify (\\'lastSeen\\' for last seen, \\'phoneNumber\\' for phone, \\'profilePhoto\\' for profile photo, etc.)',\n      },\n      allow_users: {\n        type: 'array',\n        items: { type: ['string', 'number'] },\n        description: 'List of user IDs or usernames to allow',\n      },\n      disallow_users: {\n        type: 'array',\n        items: { type: ['string', 'number'] },\n        description: 'List of user IDs or usernames to disallow',\n      },\n    },\n    required: ['key'],\n  },\n};\n\nexport async function setPrivacySettings(\n  args: {\n    key: string;\n    allow_users?: Array<string | number>;\n    disallow_users?: Array<string | number>;\n  },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { key, allow_users, disallow_users } = args;\n\n    // Map the simplified keys to their corresponding API keys\n    const keyMapping: Record<string, 'lastSeen' | 'phoneNumber' | 'profilePhoto'> = {\n      status: 'lastSeen',\n      phone: 'phoneNumber',\n      profile_photo: 'profilePhoto',\n    };\n\n    const apiKey = keyMapping[key] || key as 'lastSeen' | 'phoneNumber' | 'profilePhoto';\n    if (!['lastSeen', 'phoneNumber', 'profilePhoto', 'forwards', 'chatInvite'].includes(apiKey)) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Unsupported privacy key '${key}'. Supported keys: status, phone, profile_photo, forwards, chatInvite`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Build allow/disallow lists\n    const allowUserIds: string[] = [];\n    const allowChatIds: string[] = [];\n    const blockUserIds: string[] = [];\n    const blockChatIds: string[] = [];\n\n    if (allow_users && allow_users.length > 0) {\n      for (const userId of allow_users) {\n        const user = getUserById(userId);\n        if (user) {\n          allowUserIds.push(user.id);\n        } else {\n          const chat = getChatById(userId);\n          if (chat) {\n            allowChatIds.push(chat.id);\n          }\n        }\n      }\n    }\n\n    if (disallow_users && disallow_users.length > 0) {\n      for (const userId of disallow_users) {\n        const user = getUserById(userId);\n        if (user) {\n          blockUserIds.push(user.id);\n        } else {\n          const chat = getChatById(userId);\n          if (chat) {\n            blockChatIds.push(chat.id);\n          }\n        }\n      }\n    }\n\n    // Determine visibility based on allow/disallow lists\n    let visibility: 'everybody' | 'contacts' | 'nobody' = 'everybody';\n    if (allow_users && allow_users.length > 0) {\n      visibility = 'contacts';\n    } else if (disallow_users && disallow_users.length > 0) {\n      visibility = 'contacts';\n    }\n\n    const rules = {\n      visibility,\n      allowUserIds,\n      allowChatIds,\n      blockUserIds,\n      blockChatIds,\n    };\n\n    await callApi('setPrivacySettings', {\n      privacyKey: apiKey,\n      rules,\n    });\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Privacy settings for ${key} updated successfully.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'set_privacy_settings',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Set Profile Photo tool - Set a new profile photo\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'set_profile_photo',\n  description: 'Set a new profile photo. Note: This requires a File object which may not be available in MCP context.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      file_path: {\n        type: 'string',\n        description: 'Path to the photo file (Note: In browser context, this may need to be a blob URL or data URL)',\n      },\n    },\n    required: ['file_path'],\n  },\n};\n\nexport async function setProfilePhoto(\n  args: { file_path: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { file_path } = args;\n\n    // In browser context, file_path might be a blob URL or data URL\n    // We need to fetch it and convert to File\n    let file: File;\n    try {\n      const response = await fetch(file_path);\n      const blob = await response.blob();\n      const fileName = file_path.split('/').pop() || 'photo.jpg';\n      file = new File([blob], fileName, { type: blob.type || 'image/jpeg' });\n    } catch (fetchError) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Failed to load file from ${file_path}. Error: ${fetchError instanceof Error ? fetchError.message : String(fetchError)}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('uploadProfilePhoto', {\n      file,\n      isFallback: false,\n      isVideo: false,\n    });\n\n    if (!result || !result.photo) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to upload profile photo.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: 'Profile photo updated.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'set_profile_photo',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Delete Profile Photo tool - Delete your current profile photo\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getCurrentUser } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'delete_profile_photo',\n  description: 'Delete your current profile photo',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function deleteProfilePhoto(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const user = getCurrentUser();\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'User information not available',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get user photos to find the current profile photo\n    const photos = await callApi('fetchProfilePhotos', {\n      peer: user,\n      offset: 0,\n      limit: 1,\n    });\n\n    if (!photos || !photos.photos || photos.photos.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No profile photo to delete.',\n          },\n        ],\n      };\n    }\n\n    // Delete the first (current) profile photo\n    const result = await callApi('deleteProfilePhotos', [photos.photos[0]]);\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to delete profile photo.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: 'Profile photo deleted.',\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'delete_profile_photo',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.PROFILE,\n    );\n  }\n}\n","/**\n * Edit Chat Photo tool - Edit the photo of a chat, group, or channel\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getChatById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'edit_chat_photo',\n  description: 'Edit the photo of a chat, group, or channel. Requires a file path to an image.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      chat_id: {\n        type: ['string', 'number'],\n        description: 'The chat ID or username',\n      },\n      file_path: {\n        type: 'string',\n        description: 'Path to the photo file (Note: In browser context, this may need to be a blob URL or data URL)',\n      },\n    },\n    required: ['chat_id', 'file_path'],\n  },\n};\n\nexport async function editChatPhoto(\n  args: { chat_id: string | number; file_path: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const chatId = validateId(args.chat_id, 'chat_id');\n    const { file_path } = args;\n\n    const chat = getChatById(chatId);\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Chat ${chatId} not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // In browser context, file_path might be a blob URL or data URL\n    let file: File;\n    try {\n      const response = await fetch(file_path);\n      const blob = await response.blob();\n      const fileName = file_path.split('/').pop() || 'photo.jpg';\n      file = new File([blob], fileName, { type: blob.type || 'image/jpeg' });\n    } catch (fetchError) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Failed to load file from ${file_path}. Error: ${fetchError instanceof Error ? fetchError.message : String(fetchError)}`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const result = await callApi('editChatPhoto', {\n      chatId: chat.id,\n      accessHash: chat.accessHash,\n      photo: file,\n    });\n\n    if (!result) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'Failed to update chat photo.',\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chat ${chatId} photo updated.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'edit_chat_photo',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CHAT,\n    );\n  }\n}\n","/**\n * Get Sticker Sets tool - Get all sticker sets\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_sticker_sets',\n  description: 'Get all sticker sets',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getStickerSets(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const result = await callApi('fetchStickerSets', {});\n\n    if (!result || !result.sets) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: 'No sticker sets found.',\n          },\n        ],\n      };\n    }\n\n    const stickerSets = result.sets.map((set) => ({\n      id: set.id,\n      title: set.title,\n      shortName: set.shortName,\n      count: set.count,\n    }));\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(stickerSets, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_sticker_sets',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MEDIA,\n    );\n  }\n}\n","/**\n * Get GIF Search tool - Search for GIFs by query\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_gif_search',\n  description: 'Search for GIFs by query. Returns a list of Telegram document IDs (not file paths).',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      query: {\n        type: 'string',\n        description: 'Search term for GIFs',\n      },\n      limit: {\n        type: 'number',\n        description: 'Max number of GIFs to return',\n        default: 10,\n      },\n    },\n    required: ['query'],\n  },\n};\n\nexport async function getGifSearch(\n  args: { query: string; limit?: number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { query, limit = 10 } = args;\n\n    const result = await callApi('searchGifs', {\n      query,\n      offset: '',\n      username: 'gif',\n    });\n\n    if (!result || !result.gifs) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: '[]',\n          },\n        ],\n      };\n    }\n\n    const gifIds = result.gifs.slice(0, limit).map((gif) => gif.id);\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(gifIds, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_gif_search',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.MEDIA,\n    );\n  }\n}\n","/**\n * Get Contact IDs tool - List all contact IDs\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_contact_ids',\n  description: 'List all contact IDs',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function getContactIds(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const result = await callApi('fetchContactList');\n\n    if (!result || !result.users) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: '[]',\n          },\n        ],\n      };\n    }\n\n    const contactIds = result.users.map((user) => user.id);\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(contactIds, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_contact_ids',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Import Contacts tool - Import a list of contacts\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'import_contacts',\n  description: 'Import a list of contacts. Each contact should be a dict with phone, first_name, last_name.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      contacts: {\n        type: 'array',\n        items: {\n          type: 'object',\n          properties: {\n            phone: { type: 'string' },\n            first_name: { type: 'string' },\n            last_name: { type: 'string' },\n          },\n          required: ['phone', 'first_name'],\n        },\n        description: 'List of contacts to import',\n      },\n    },\n    required: ['contacts'],\n  },\n};\n\nexport async function importContacts(\n  args: { contacts: Array<{ phone: string; first_name: string; last_name?: string }> },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { contacts } = args;\n\n    let importedCount = 0;\n    for (const contact of contacts) {\n      const result = await callApi('importContact', {\n        phone: contact.phone,\n        firstName: contact.first_name,\n        lastName: contact.last_name || '',\n      });\n\n      if (result) {\n        importedCount++;\n      }\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Imported ${importedCount} contacts.`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'import_contacts',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Export Contacts tool - Export all contacts as a JSON string\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { formatEntity } from '../telegramApi';\n\nexport const tool: MCPTool = {\n  name: 'export_contacts',\n  description: 'Export all contacts as a JSON string',\n  inputSchema: {\n    type: 'object',\n    properties: {},\n  },\n};\n\nexport async function exportContacts(\n  args: Record<string, never>,\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const result = await callApi('fetchContactList');\n\n    if (!result || !result.users) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: '[]',\n          },\n        ],\n      };\n    }\n\n    const contacts = result.users.map(formatEntity);\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: JSON.stringify(contacts, undefined, 2),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'export_contacts',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Get Direct Chat By Contact tool - Find a direct chat with a specific contact\n */\n\nimport { getGlobal } from '../../../../global';\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { selectChat } from '../../../../global/selectors';\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\n\nexport const tool: MCPTool = {\n  name: 'get_direct_chat_by_contact',\n  description: 'Find a direct chat with a specific contact by name, username, or phone.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      contact_query: {\n        type: 'string',\n        description: 'Name, username, or phone number to search for',\n      },\n    },\n    required: ['contact_query'],\n  },\n};\n\nexport async function getDirectChatByContact(\n  args: { contact_query: string },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const { contact_query } = args;\n\n    // Fetch all contacts\n    const result = await callApi('fetchContactList');\n    if (!result || !result.users) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No contacts found matching '${contact_query}'.`,\n          },\n        ],\n      };\n    }\n\n    const global = getGlobal();\n    const queryLower = contact_query.toLowerCase();\n\n    // Find matching contacts\n    const foundContacts = result.users.filter((user) => {\n      const name = `${user.firstName || ''} ${user.lastName || ''}`.trim().toLowerCase();\n      const username = user.usernames?.[0]?.username?.toLowerCase() || '';\n      const phone = typeof user.phoneNumber === 'string' ? user.phoneNumber : '';\n\n      return (\n        name.includes(queryLower)\n        || (username && username.includes(queryLower))\n        || (phone && phone.includes(contact_query))\n      );\n    });\n\n    if (foundContacts.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No contacts found matching '${contact_query}'.`,\n          },\n        ],\n      };\n    }\n\n    // Find direct chats with these contacts\n    const results: string[] = [];\n    for (const contact of foundContacts) {\n      const contactName = `${contact.firstName || ''} ${contact.lastName || ''}`.trim();\n      const chat = selectChat(global, contact.id);\n      if (chat) {\n        let chatInfo = `Chat ID: ${contact.id}, Contact: ${contactName}`;\n        if (contact.usernames?.[0]?.username) {\n          chatInfo += `, Username: @${contact.usernames[0].username}`;\n        }\n        const unreadCount = global.chats.byId[contact.id]?.unreadCount;\n        if (unreadCount) {\n          chatInfo += `, Unread: ${unreadCount}`;\n        }\n        results.push(chatInfo);\n      }\n    }\n\n    if (results.length === 0) {\n      const foundNames = foundContacts.map((c) => `${c.firstName || ''} ${c.lastName || ''}`.trim()).join(', ');\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Found contacts: ${foundNames}, but no direct chats were found with them.`,\n          },\n        ],\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: results.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_direct_chat_by_contact',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Get Contact Chats tool - List all chats involving a specific contact\n */\n\nimport { getGlobal } from '../../../../global';\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { selectChat } from '../../../../global/selectors';\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_contact_chats',\n  description: 'List all chats involving a specific contact.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      contact_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the contact',\n      },\n    },\n    required: ['contact_id'],\n  },\n};\n\nexport async function getContactChats(\n  args: { contact_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const contactId = validateId(args.contact_id, 'contact_id');\n\n    const user = getUserById(contactId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `ID ${contactId} is not a user/contact.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const contactName = `${user.firstName || ''} ${user.lastName || ''}`.trim();\n    let global = getGlobal();\n    const results: string[] = [];\n\n    // Find direct chat\n    const directChat = selectChat(global, contactId.toString());\n    if (directChat) {\n      let chatInfo = `Direct Chat ID: ${contactId}, Type: Private`;\n      const unreadCount = global.chats.byId[contactId.toString()]?.unreadCount;\n      if (unreadCount) {\n        chatInfo += `, Unread: ${unreadCount}`;\n      }\n      results.push(chatInfo);\n    }\n\n    // Look for common groups/channels\n    try {\n      const common = await callApi('fetchCommonChats', {\n        user,\n        maxId: undefined,\n      });\n\n      // Update global state after await as it may have been updated\n      global = getGlobal();\n\n      if (common && common.chatIds) {\n        for (const chat of common.chatIds) {\n          const chatType = global.chats.byId[chat]?.type;\n          const chatInfo = `Chat ID: ${chat}, Title: ${global.chats.byId[chat]?.title || 'Unknown'}, Type: ${chatType}`;\n          results.push(chatInfo);\n        }\n      }\n    } catch {\n      results.push('Could not retrieve common groups.');\n    }\n\n    if (results.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No chats found with ${contactName} (ID: ${contactId}).`,\n          },\n        ],\n      };\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: `Chats with ${contactName} (ID: ${contactId}):\\n${results.join('\\n')}`,\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_contact_chats',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Get Last Interaction tool - Get the most recent message with a contact\n */\n\nimport type { GlobalState } from '../../../../global/types';\nimport type { SocketIOMCPTransportImpl } from '../transport';\nimport type { MCPTool, MCPToolResult } from '../types';\n\nimport { selectChat } from '../../../../global/selectors';\nimport { callApi } from '../../../../api/gramjs/worker/connector';\nimport { ErrorCategory, logAndFormatError } from '../errorHandler';\nimport { getUserById } from '../telegramApi';\nimport { validateId } from '../validation';\n\nexport const tool: MCPTool = {\n  name: 'get_last_interaction',\n  description: 'Get the most recent message with a contact.',\n  inputSchema: {\n    type: 'object',\n    properties: {\n      contact_id: {\n        type: ['string', 'number'],\n        description: 'The ID or username of the contact',\n      },\n    },\n    required: ['contact_id'],\n  },\n};\n\nexport async function getLastInteraction(\n  args: { contact_id: string | number },\n  context: { global: GlobalState; transport: SocketIOMCPTransportImpl },\n): Promise<MCPToolResult> {\n  try {\n    const contactId = validateId(args.contact_id, 'contact_id');\n\n    const user = getUserById(contactId);\n    if (!user) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `ID ${contactId} is not a user/contact.`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    const contactName = `${user.firstName || ''} ${user.lastName || ''}`.trim();\n\n    // Get or fetch the chat for this user\n    let chat = selectChat(context.global, user.id);\n    if (!chat) {\n      const chatResult = await callApi('fetchChat', {\n        type: 'user',\n        user,\n      });\n      if (chatResult?.chatId) {\n        chat = selectChat(context.global, chatResult.chatId);\n      }\n    }\n\n    if (!chat) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Could not find chat for ${contactName} (ID: ${contactId}).`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    // Get the last few messages\n    const result = await callApi('fetchMessages', {\n      chat,\n      threadId: 0,\n      offsetId: undefined,\n      isSavedDialog: false,\n      addOffset: undefined,\n      limit: 5,\n    });\n\n    if (!result || !result.messages || result.messages.length === 0) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `No messages found with ${contactName} (ID: ${contactId}).`,\n          },\n        ],\n      };\n    }\n\n    const results = [`Last interactions with ${contactName} (ID: ${contactId}):`];\n\n    for (const msg of result.messages) {\n      const sender = msg.isOutgoing ? 'You' : contactName;\n      const messageText = msg.content.text?.text || '[Media/No text]';\n      const date = new Date(msg.date * 1000).toISOString();\n      results.push(`Date: ${date}, From: ${sender}, Message: ${messageText}`);\n    }\n\n    return {\n      content: [\n        {\n          type: 'text',\n          text: results.join('\\n'),\n        },\n      ],\n    };\n  } catch (error) {\n    return logAndFormatError(\n      'get_last_interaction',\n      error instanceof Error ? error : new Error(String(error)),\n      ErrorCategory.CONTACT,\n    );\n  }\n}\n","/**\n * Socket.IO transport for MCP server\n * Handles communication between frontend MCP server and backend MCP client\n */\n\nimport type { Socket } from 'socket.io-client';\n\nimport type { MCPRequest, MCPResponse, SocketIOMCPTransport } from './types';\n\nimport { log } from '../logger';\n\nexport class SocketIOMCPTransportImpl implements SocketIOMCPTransport {\n  private socket: Socket | null | undefined;\n  private requestHandlers = new Map<string | number, (response: MCPResponse) => void>();\n  private eventPrefix = 'mcp:';\n\n  constructor(socket: Socket | null | undefined) {\n    this.socket = socket ?? undefined;\n    this.setupEventHandlers();\n  }\n\n  get connected(): boolean {\n    return this.socket?.connected ?? false;\n  }\n\n  private setupEventHandlers(): void {\n    if (!this.socket) return;\n\n    // Listen for MCP responses from backend\n    this.socket.on(`${this.eventPrefix}response`, (response: MCPResponse) => {\n      const handler = this.requestHandlers.get(response.id);\n      if (handler) {\n        handler(response);\n        this.requestHandlers.delete(response.id);\n      }\n    });\n  }\n\n  emit(event: string, data: any): void {\n    if (!this.socket?.connected) {\n      log('WARN', 'Cannot emit MCP event: socket not connected', { event });\n      return;\n    }\n\n    // eslint-disable-next-line no-console\n    console.log(`[MCP] Emitting ${event}`, data);\n    this.socket.emit(`${this.eventPrefix}${event}`, data);\n  }\n\n  on(event: string, handler: (data: any) => void): void {\n    if (!this.socket) return;\n\n    const fullEvent = `${this.eventPrefix}${event}`;\n    // eslint-disable-next-line no-console\n    console.log(`[MCP] Listening to ${fullEvent}`);\n    this.socket.on(fullEvent, handler);\n  }\n\n  off(event: string, handler: (data: any) => void): void {\n    if (!this.socket) return;\n\n    const fullEvent = `${this.eventPrefix}${event}`;\n    this.socket.off(fullEvent, handler);\n  }\n\n  /**\n   * Send an MCP request and wait for response\n   */\n  async request(request: MCPRequest, timeoutMs: number = 30000): Promise<MCPResponse> {\n    if (!this.socket?.connected) {\n      throw new Error('Socket not connected');\n    }\n\n    return new Promise<MCPResponse>((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        this.requestHandlers.delete(request.id);\n        reject(new Error(`MCP request timeout after ${timeoutMs}ms`));\n      }, timeoutMs);\n\n      this.requestHandlers.set(request.id, (response: MCPResponse) => {\n        clearTimeout(timeout);\n        if (response.error) {\n          reject(new Error(response.error.message));\n        } else {\n          resolve(response);\n        }\n      });\n\n      this.emit('request', request);\n    });\n  }\n\n  /**\n   * Update socket instance (e.g., on reconnection)\n   */\n  updateSocket(socket: Socket | null | undefined): void {\n    if (this.socket) {\n      // Remove old handlers\n      this.socket.off(`${this.eventPrefix}response`, this.handleResponse);\n    }\n\n    this.socket = socket ?? undefined;\n    this.setupEventHandlers();\n  }\n\n  private handleResponse = (response: MCPResponse): void => {\n    const handler = this.requestHandlers.get(response.id);\n    if (handler) {\n      handler(response);\n      this.requestHandlers.delete(response.id);\n    }\n  };\n}\n","/**\n * MCP Server implementation for Telegram\n * Provides tools for interacting with Telegram via MCP protocol\n */\n\nimport type { Socket } from 'socket.io-client';\n\nimport type { GlobalState } from '../../../global/types';\nimport type { MCPServerConfig, MCPTool, MCPToolCall, MCPToolResult } from './types';\n\nimport { ErrorCategory, logAndFormatError } from './errorHandler';\nimport * as tools from './tools';\nimport { SocketIOMCPTransportImpl } from './transport';\nimport { ValidationError } from './validation';\n\nexport interface MCPToolContext {\n  global: GlobalState;\n  transport: SocketIOMCPTransportImpl;\n}\n\nexport type MCPToolHandler = (args: Record<string, unknown>, context: MCPToolContext) => Promise<MCPToolResult>;\n\nexport class MCPServer {\n  private transport: SocketIOMCPTransportImpl;\n  private config: MCPServerConfig;\n  private global: GlobalState;\n\n  constructor(socket: Socket | null | undefined, global: GlobalState) {\n    this.transport = new SocketIOMCPTransportImpl(socket ?? undefined);\n    this.config = {\n      name: 'telegram-mcp',\n      version: '1.0.0',\n    };\n    this.global = global;\n\n    this.setupHandlers();\n  }\n\n  /**\n   * Update socket instance (e.g., on reconnection)\n   */\n  updateSocket(socket: Socket | null | undefined): void {\n    this.transport.updateSocket(socket ?? undefined);\n  }\n\n  /**\n   * Update global state\n   */\n  updateGlobal(global: GlobalState): void {\n    this.global = global;\n  }\n\n  /**\n   * Setup MCP protocol handlers\n   */\n  private setupHandlers(): void {\n    // Listen for tool calls from backend\n    this.transport.on('toolCall', (data: { requestId: string; toolCall: MCPToolCall }) => {\n      void this.handleToolCallRequest(data);\n    });\n\n    // Listen for list tools request\n    this.transport.on('listTools', (data: { requestId: string }) => {\n      const { requestId } = data;\n      try {\n        const toolsList = this.listTools();\n        this.transport.emit('listToolsResponse', {\n          requestId,\n          tools: toolsList,\n        });\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error('[MCP] Failed to list tools', error);\n        this.transport.emit('listToolsResponse', {\n          requestId,\n          tools: [],\n        });\n      }\n    });\n  }\n\n  private async handleToolCallRequest(data: { requestId: string; toolCall: MCPToolCall }): Promise<void> {\n    const { requestId, toolCall } = data;\n\n    try {\n      const result = await this.handleToolCall(toolCall);\n      this.transport.emit('toolResult', {\n        requestId,\n        result,\n      });\n    } catch (error) {\n      const errorResult = logAndFormatError(\n        'handleToolCall',\n        error instanceof Error ? error : new Error(String(error)),\n      );\n      this.transport.emit('toolResult', {\n        requestId,\n        result: errorResult,\n      });\n    }\n  }\n\n  /**\n   * List all available tools\n   */\n  private listTools(): MCPTool[] {\n    return Object.values(tools).filter((tool): tool is MCPTool => {\n      return (\n        tool !== undefined &&\n        typeof tool === 'object' &&\n        'name' in tool &&\n        'description' in tool &&\n        'inputSchema' in tool &&\n        typeof tool.name === 'string' &&\n        typeof tool.description === 'string'\n      );\n    });\n  }\n\n  /**\n   * Handle a tool call\n   */\n  private async handleToolCall(toolCall: MCPToolCall): Promise<MCPToolResult> {\n    const { name, arguments: args } = toolCall;\n\n    // eslint-disable-next-line no-console\n    console.log(`[MCP] Executing tool: ${name}`, args);\n\n    // Find the tool handler\n    const toolHandler = this.findToolHandler(name);\n    if (!toolHandler) {\n      return {\n        content: [\n          {\n            type: 'text',\n            text: `Tool '${name}' not found`,\n          },\n        ],\n        isError: true,\n      };\n    }\n\n    try {\n      // Execute the tool with context\n      const result = await toolHandler(args, {\n        global: this.global,\n        transport: this.transport,\n      });\n\n      return result;\n    } catch (error) {\n      if (error instanceof ValidationError) {\n        return logAndFormatError(name, error, ErrorCategory.VALIDATION);\n      }\n\n      return logAndFormatError(\n        name,\n        error instanceof Error ? error : new Error(String(error)),\n      );\n    }\n  }\n\n  /**\n   * Find tool handler by name\n   */\n  private findToolHandler(name: string): MCPToolHandler | undefined {\n    // Map tool names to handlers\n    // Type assertion needed since tool handlers have specific arg types,\n    // but MCPToolHandler uses Record<string, unknown> for dynamic MCP calls\n    const toolMap = {\n      // Chat & Group Management\n      get_chats: tools.getChats,\n      list_chats: tools.listChats,\n      get_chat: tools.getChat,\n      create_group: tools.createGroup,\n      invite_to_group: tools.inviteToGroup,\n      create_channel: tools.createChannel,\n      edit_chat_title: tools.editChatTitle,\n      delete_chat_photo: tools.deleteChatPhoto,\n      leave_chat: tools.leaveChat,\n      get_participants: tools.getParticipants,\n      get_admins: tools.getAdmins,\n      get_banned_users: tools.getBannedUsers,\n      promote_admin: tools.promoteAdmin,\n      demote_admin: tools.demoteAdmin,\n      ban_user: tools.banUser,\n      unban_user: tools.unbanUser,\n      get_invite_link: tools.getInviteLink,\n      export_chat_invite: tools.exportChatInvite,\n      import_chat_invite: tools.importChatInvite,\n      join_chat_by_link: tools.joinChatByLink,\n      subscribe_public_channel: tools.subscribePublicChannel,\n\n      // Messaging\n      get_messages: tools.getMessages,\n      list_messages: tools.listMessages,\n      list_topics: tools.listTopics,\n      send_message: tools.sendMessage,\n      reply_to_message: tools.replyToMessage,\n      edit_message: tools.editMessage,\n      delete_message: tools.deleteMessage,\n      forward_message: tools.forwardMessage,\n      pin_message: tools.pinMessage,\n      unpin_message: tools.unpinMessage,\n      mark_as_read: tools.markAsRead,\n      get_message_context: tools.getMessageContext,\n      get_history: tools.getHistory,\n      get_pinned_messages: tools.getPinnedMessages,\n      send_reaction: tools.sendReaction,\n      remove_reaction: tools.removeReaction,\n      get_message_reactions: tools.getMessageReactions,\n\n      // Contact Management\n      list_contacts: tools.listContacts,\n      search_contacts: tools.searchContacts,\n      add_contact: tools.addContact,\n      delete_contact: tools.deleteContact,\n      block_user: tools.blockUser,\n      unblock_user: tools.unblockUser,\n      get_blocked_users: tools.getBlockedUsers,\n\n      // User & Profile\n      get_me: tools.getMe,\n      update_profile: tools.updateProfile,\n      get_user_photos: tools.getUserPhotos,\n      get_user_status: tools.getUserStatus,\n\n      // Privacy & Settings\n      mute_chat: tools.muteChat,\n      unmute_chat: tools.unmuteChat,\n      archive_chat: tools.archiveChat,\n      unarchive_chat: tools.unarchiveChat,\n      get_privacy_settings: tools.getPrivacySettings,\n      set_privacy_settings: tools.setPrivacySettings,\n\n      // Inline Buttons & Drafts\n      list_inline_buttons: tools.listInlineButtons,\n      press_inline_button: tools.pressInlineButton,\n      save_draft: tools.saveDraft,\n      get_drafts: tools.getDrafts,\n      clear_draft: tools.clearDraft,\n\n      // Search & Discovery\n      search_public_chats: tools.searchPublicChats,\n      search_messages: tools.searchMessages,\n      resolve_username: tools.resolveUsername,\n\n      // Media\n      get_media_info: tools.getMediaInfo,\n\n      // Admin & Actions\n      get_recent_actions: tools.getRecentActions,\n\n      // Polls\n      create_poll: tools.createPoll,\n\n      // Bots\n      get_bot_info: tools.getBotInfo,\n      set_bot_commands: tools.setBotCommands,\n\n      // Profile\n      set_profile_photo: tools.setProfilePhoto,\n      delete_profile_photo: tools.deleteProfilePhoto,\n\n      // Chat Photo\n      edit_chat_photo: tools.editChatPhoto,\n\n      // Stickers & GIFs\n      get_sticker_sets: tools.getStickerSets,\n      get_gif_search: tools.getGifSearch,\n\n      // Contacts (Extended)\n      get_contact_ids: tools.getContactIds,\n      import_contacts: tools.importContacts,\n      export_contacts: tools.exportContacts,\n      get_direct_chat_by_contact: tools.getDirectChatByContact,\n      get_contact_chats: tools.getContactChats,\n      get_last_interaction: tools.getLastInteraction,\n    } as unknown as Record<string, MCPToolHandler>;\n\n    return toolMap[name] || undefined;\n  }\n}\n","/**\n * MCP Server for Telegram\n * Main entry point for MCP server integration\n */\n\nimport type { Socket } from 'socket.io-client';\nimport { getGlobal } from '../../../global';\n\nimport { MCPServer } from './server';\n\nlet mcpServerInstance: MCPServer | undefined;\n\n/**\n * Initialize MCP server\n */\nexport function initMCPServer(socket: Socket | null | undefined): MCPServer {\n  const global = getGlobal();\n  mcpServerInstance = new MCPServer(socket, global);\n  // eslint-disable-next-line no-console\n  console.log('[MCP] MCP server initialized');\n  return mcpServerInstance;\n}\n\n/**\n * Get MCP server instance\n */\nexport function getMCPServer(): MCPServer | undefined {\n  return mcpServerInstance;\n}\n\n/**\n * Update MCP server socket (e.g., on reconnection)\n */\nexport function updateMCPServerSocket(socket: Socket | null | undefined): void {\n  if (mcpServerInstance) {\n    mcpServerInstance.updateSocket(socket);\n    // eslint-disable-next-line no-console\n    console.log('[MCP] MCP server socket updated');\n  }\n}\n\n/**\n * Update MCP server global state\n */\nexport function updateMCPServerGlobal(): void {\n  if (mcpServerInstance) {\n    const global = getGlobal();\n    mcpServerInstance.updateGlobal(global);\n  }\n}\n","/*\n * AI Socket Manager\n * Manages WebSocket connection to backend for AI features\n */\n\nimport { io, type Socket } from 'socket.io-client';\nimport { getActions, getGlobal, setGlobal } from '../../global';\n\nimport type { AgentUpdate, AlphaHumanManagerState, StreamMessageRequest } from './types';\n\nimport { BACKEND_API_URL } from '../../config';\nimport { updateAlphahuman } from '../../global/reducers/alphahuman';\nimport { log } from './logger';\nimport { initMCPServer, updateMCPServerSocket } from './mcp';\n\n// Get backend URL from environment or default\nconst getBackendUrl = (): string => BACKEND_API_URL || '';\n\nclass AlphaHumanManager {\n  private socket: Socket | undefined = undefined;\n  private backendUrl: string = getBackendUrl();\n  private reconnectAttempts: number = 0;\n  private maxReconnectAttempts: number = 5;\n  private reconnectDelay: number = 3000;\n\n  public state: AlphaHumanManagerState = 'disconnected';\n\n  public getState(): AlphaHumanManagerState {\n    return this.state;\n  }\n\n  /**\n   * Update state and emit state change event\n   * @param newState - The new state to set\n   */\n  private setState(newState: typeof this.state): void {\n    if (this.state === newState) return; // No change, skip event\n\n    const oldState = this.state;\n    this.state = newState;\n    log('STATE', `State changed: ${oldState} -> ${newState}`);\n\n    // Emit state change via action\n    getActions().updateAlphaHumanSocketState({ state: newState });\n  }\n\n  /**\n   * Login to backend and get JWT token\n   * Only connects if JWT token is present\n   * @returns Promise that resolves when login is complete\n   */\n  public login(): void {\n    log('CONNECTING', 'Login to backend');\n    try {\n      // Get JWT token from storage\n      const jwtToken = this.getJwtToken();\n\n      if (!jwtToken) {\n        log('AUTH ERROR', 'No JWT token found');\n        this.setState('jwt_missing');\n        return;\n      }\n\n      // JWT token is present, connect to WebSocket\n      this.connect(jwtToken);\n    } catch (error) {\n      log('AUTH ERROR', 'Login failed:', error);\n      this.setState('jwt_invalid');\n      throw error;\n    }\n  }\n\n  public updateJwtAndLogin(jwtToken: string): void {\n    log('REQUEST', 'Updating JWT token and logging in');\n    this.saveJwtTokenToSession(jwtToken);\n    this.login();\n  }\n\n  private connect(jwtToken: string): void {\n    if (this.socket?.connected) {\n      log('CONNECTED', 'Socket already connected');\n      return;\n    }\n\n    if (!jwtToken) {\n      log('AUTH ERROR', 'Cannot connect: JWT token is missing');\n      this.setState('jwt_missing');\n      return;\n    }\n\n    // Validate JWT token structure and expiration\n    if (!this.validateJwtToken(jwtToken)) {\n      return;\n    }\n\n    // Log token info for debugging (first 20 chars only for security)\n    const tokenPreview = jwtToken.substring(0, 20) + '...';\n    log('CONNECTING', `Connecting to backend at ${this.backendUrl} with token: ${tokenPreview}`);\n\n    const url = this.backendUrl.replace('http://', 'ws://').replace('https://', 'wss://');\n    this.socket = io(url, {\n      auth: { token: jwtToken },\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionAttempts: this.maxReconnectAttempts,\n      reconnectionDelay: this.reconnectDelay,\n      autoConnect: true,\n      forceNew: true, // Force new connection (close any existing)\n      path: '/socket.io/', // Explicit path for socket.io\n    });\n\n    this.setupEventHandlers();\n    this.socket.connect();\n  }\n\n  /**\n   * Validate JWT token structure and expiration\n   * @returns true if token is valid, false otherwise\n   */\n  private validateJwtToken(jwtToken: string): boolean {\n    try {\n      const parts = jwtToken.split('.');\n      if (parts.length !== 3) {\n        log('AUTH ERROR', 'Invalid JWT token format: expected 3 parts, got', parts.length);\n        this.setState('jwt_invalid');\n        return false;\n      }\n\n      const payload = JSON.parse(atob(parts[1]));\n      log('REQUEST', 'JWT token decoded:', {\n        tgUserId: payload.tgUserId,\n        exp: payload.exp ? new Date(payload.exp * 1000).toISOString() : 'missing',\n        iat: payload.iat ? new Date(payload.iat * 1000).toISOString() : 'missing',\n      });\n\n      if (!payload.tgUserId) {\n        log('AUTH ERROR', 'JWT token missing tgUserId in payload:', payload);\n        this.setState('jwt_invalid');\n        return false;\n      }\n\n      // Check if token is expired\n      if (payload.exp && Date.now() >= payload.exp * 1000) {\n        log('AUTH ERROR', 'JWT token is expired');\n        this.setState('jwt_invalid');\n        return false;\n      }\n\n      return true;\n    } catch (error) {\n      log('AUTH ERROR', 'Failed to decode JWT token:', error);\n      this.setState('jwt_invalid');\n      return false;\n    }\n  }\n\n  private setupEventHandlers(): void {\n    if (!this.socket) return;\n\n    this.socket.on('connect', () => {\n      this.reconnectAttempts = 0;\n      log('CONNECTED', 'Connected to backend');\n      // Update MCP server socket on reconnection\n      updateMCPServerSocket(this.socket);\n      // State will be updated to 'connected' after magic word verification in verifyMagicWord\n      // The connect event itself doesn't need a separate state update as verifyMagicWord handles it\n    });\n\n    this.socket.on('disconnect', (reason: string) => {\n      log('DISCONNECTED', 'Disconnected from backend:', reason);\n\n      // If disconnected before connection established, likely JWT validation failed\n      if (reason === 'io server disconnect' || reason === 'transport close') {\n        log('AUTH ERROR', 'Socket was disconnected by server - likely JWT validation failed');\n        this.setState('jwt_invalid');\n      } else {\n        // Dispatch action for disconnect event (setState already does this via updateAiSocketState)\n        this.setState('disconnected');\n      }\n    });\n\n    this.socket.on('connect_error', (error: Error) => {\n      this.reconnectAttempts++;\n      log('CONNECTION ERROR', 'Connection error:', error.message);\n      log('CONNECTION ERROR', 'Backend URL:', this.backendUrl);\n\n      // Check if error indicates server not reachable or authentication failure\n      const isConnectionError = error.message.includes('xhr poll error')\n        || error.message.includes('websocket error')\n        || error.message.includes('timeout')\n        || error.message.includes('ECONNREFUSED');\n      if (isConnectionError) {\n        log('CONNECTION ERROR', `Cannot reach backend at ${this.backendUrl}. Is the server running?`);\n      }\n\n      if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n        log('CONNECTION ERROR', 'Max reconnection attempts reached');\n        // Dispatch action for max reconnection attempts (setState already does this)\n        this.setState('jwt_invalid');\n      }\n    });\n\n    // Backend emits error events with { requestId: string, message: string, status: number }\n    this.socket.on('error', (error: { requestId?: string; message: string; status: number }) => {\n      const requestIdText = error.requestId ? `RequestId: ${error.requestId}` : '';\n      log('BACKEND ERROR', error.message, `Status: ${error.status}`, requestIdText);\n\n      // Dispatch action for backend error\n      getActions().onAlphaHumanBackendError({ error });\n\n      // Check if error is authentication-related\n      if (error.status === 401 || error.status === 403) {\n        // Dispatch action for auth error (setState already does this)\n        this.setState('jwt_invalid');\n      }\n    });\n\n    // Setup agent updates listener\n    this.socket.on('agentUpdates', (data: AgentUpdate) => {\n      log('UPDATE', 'Received agent updates:', data);\n\n      // Dispatch action for agent streaming update\n      getActions().onAlphaHumanAgentStreamingUpdate({ update: data });\n    });\n\n    // Initialize MCP server\n    initMCPServer(this.socket);\n  }\n\n  /**\n   * Stream a message from user to agent with real-time updates\n   * Sends a user message to the agent and receives streaming responses\n   * @param request - Stream message request with threadId and content\n   * @returns Promise that resolves with messageId when stream completes\n   */\n  public async streamMessageForUser(request: StreamMessageRequest): Promise<string> {\n    if (!this.socket?.connected) {\n      throw new Error('Socket not connected');\n    }\n\n    const requestId = crypto.randomUUID();\n    log('REQUEST', 'Streaming message:', { requestId, threadId: request.threadId });\n\n    return new Promise((resolve, reject) => {\n      const STREAM_TIMEOUT_MS = 60000; // 60 seconds\n      let messageId: string | undefined;\n      let isResolved = false;\n\n      // Listen for stream completion\n      const onComplete = (update: AgentUpdate) => {\n        if (update.eventType === 'complete') {\n          if (!isResolved) {\n            isResolved = true;\n            clearTimeout(timeoutId);\n            this.socket?.off('agentUpdates', onComplete);\n            resolve(messageId ?? '');\n          }\n        } else if (update.eventType === 'error') {\n          if (!isResolved) {\n            isResolved = true;\n            clearTimeout(timeoutId);\n            this.socket?.off('agentUpdates', onComplete);\n            reject(new Error(update.message?.content ?? 'Stream error'));\n          }\n        }\n      };\n\n      // Set timeout for stream completion\n      const timeoutId = setTimeout(() => {\n        if (!isResolved) {\n          isResolved = true;\n          this.socket?.off('agentUpdates', onComplete);\n          reject(new Error('Stream timeout'));\n        }\n      }, STREAM_TIMEOUT_MS);\n\n      // Listen for agent updates\n      if (this.socket) {\n        this.socket.on('agentUpdates', onComplete);\n\n        // Start streaming\n        this.socket.emit('streamMessageForUser', {\n          requestId,\n          data: {\n            threadId: request.threadId,\n            content: request.content,\n          },\n        });\n      }\n    });\n  }\n\n  public disconnect(): void {\n    if (this.socket) {\n      log('DISCONNECTED', 'Disconnecting socket');\n      this.socket.disconnect();\n      this.socket = undefined;\n    }\n  }\n\n  public clear(): void {\n    this.disconnect();\n    this.saveJwtTokenToSession(undefined);\n  }\n\n  /**\n   * Get the current JWT token (public method)\n   */\n  public getJwtToken(): string | undefined {\n    return this.loadJwtTokenLocally();\n  }\n\n  /**\n   * Check if user is authenticated (has JWT token)\n   */\n  public isAuthenticated(): boolean {\n    const jwtToken = this.getJwtToken();\n    return Boolean(jwtToken);\n  }\n\n  /**\n   * Load JWT token from global state (preferred) or storage (fallback for backward compatibility)\n   */\n  private loadJwtTokenLocally(): string | undefined {\n    try {\n      // Try global state first\n      const globalToken = getGlobal().alphahuman?.jwtToken;\n      if (globalToken && typeof globalToken === 'string') {\n        return globalToken;\n      }\n\n      return undefined;\n    } catch (error) {\n      log('AUTH ERROR', 'Error loading JWT token:', error);\n      return undefined;\n    }\n  }\n\n  /**\n   * Save JWT token to global state (public method for message listener)\n   */\n  public saveJwtTokenToSession(jwtToken: string | undefined): void {\n    try {\n      let global = getGlobal();\n      global = updateAlphahuman(global, { jwtToken });\n      setGlobal(global);\n      log('REQUEST', 'JWT token saved to global state');\n    } catch (error) {\n      log('AUTH ERROR', 'Error saving JWT token to global state:', error);\n      throw error;\n    }\n  }\n}\n\n// Singleton instance\nlet socketManagerInstance: AlphaHumanManager | undefined = undefined;\n\nexport function getAiSocketManager(): AlphaHumanManager {\n  if (!socketManagerInstance) socketManagerInstance = new AlphaHumanManager();\n  return socketManagerInstance;\n}\n\nexport default getAiSocketManager;\n","import { getIsHeavyAnimating, onFullyIdle } from '../lib/teact/teact';\nimport { addCallback, removeCallback } from '../lib/teact/teactn';\n\nimport type {\n  ApiAvailableReaction,\n  ApiMessage,\n} from '../api/types';\nimport type { MessageList, ThreadId } from '../types';\nimport type { ActionReturnType, GlobalState, SharedState } from './types';\nimport { ApiMessageEntityTypes, MAIN_THREAD_ID } from '../api/types';\n\nimport {\n  ALL_FOLDER_ID, ANIMATION_LEVEL_DEFAULT,\n  ARCHIVED_FOLDER_ID,\n  DEBUG,\n  FOLDERS_POSITION_DEFAULT,\n  GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT,\n  GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT,\n  GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT,\n  GLOBAL_STATE_CACHE_DISABLED,\n  GLOBAL_STATE_CACHE_USER_LIST_LIMIT,\n  IS_SCREEN_LOCKED_CACHE_KEY,\n  SAVED_FOLDER_ID,\n  SHARED_STATE_CACHE_KEY,\n} from '../config';\nimport { MAIN_IDB_STORE } from '../util/browser/idb';\nimport { isUserId } from '../util/entities/ids';\nimport { getOrderedIds } from '../util/folderManager';\nimport {\n  compact, pick, pickTruthy, unique,\n} from '../util/iteratees';\nimport { GLOBAL_STATE_CACHE_KEY } from '../util/multiaccount';\nimport { encryptSession } from '../util/passcode';\nimport { onBeforeUnload, throttle } from '../util/schedulers';\nimport { hasStoredSession } from '../util/sessions';\nimport { addActionHandler, getGlobal } from './index';\nimport { INITIAL_GLOBAL_STATE, INITIAL_PERFORMANCE_STATE_MED } from './initialState';\nimport { clearGlobalForLockScreen, clearSharedStateForLockScreen } from './reducers';\nimport {\n  selectChatLastMessageId,\n  selectChatMessages,\n  selectCurrentMessageList,\n  selectFullWebPageFromMessage,\n  selectTopics,\n  selectViewportIds,\n  selectVisibleUsers,\n} from './selectors';\n\nimport { getIsMobile } from '../hooks/useAppLayout';\n\nconst UPDATE_THROTTLE = 5000;\n\nconst updateCacheThrottled = throttle(() => onFullyIdle(() => updateCache()), UPDATE_THROTTLE, false);\nconst updateCacheForced = () => updateCache(true);\n\nlet isCaching = false;\nlet isRemovingCache = false;\nlet cacheUpdateSuspensionTimestamp = 0;\nlet unsubscribeFromBeforeUnload: NoneToVoidFunction | undefined;\n\nexport function cacheGlobal(global: GlobalState) {\n  return MAIN_IDB_STORE.set(GLOBAL_STATE_CACHE_KEY, global);\n}\n\nexport function cacheSharedState(state: SharedState) {\n  return MAIN_IDB_STORE.set(SHARED_STATE_CACHE_KEY, state);\n}\n\nexport function loadCachedGlobal() {\n  return MAIN_IDB_STORE.get<GlobalState>(GLOBAL_STATE_CACHE_KEY);\n}\n\nexport function loadCachedSharedState() {\n  return MAIN_IDB_STORE.get<SharedState>(SHARED_STATE_CACHE_KEY);\n}\n\nexport function removeGlobalFromCache() {\n  return MAIN_IDB_STORE.del(GLOBAL_STATE_CACHE_KEY);\n}\n\nexport function removeSharedStateFromCache() {\n  return MAIN_IDB_STORE.del(SHARED_STATE_CACHE_KEY);\n}\n\nfunction cacheIsScreenLocked(global: GlobalState) {\n  if (global?.passcode?.isScreenLocked) localStorage.setItem(IS_SCREEN_LOCKED_CACHE_KEY, 'true');\n}\n\nexport function initCache() {\n  if (GLOBAL_STATE_CACHE_DISABLED) {\n    return;\n  }\n\n  const resetCache = () => {\n    isRemovingCache = true;\n    removeGlobalFromCache().finally(() => {\n      localStorage.removeItem(IS_SCREEN_LOCKED_CACHE_KEY);\n      isRemovingCache = false;\n      if (!isCaching) {\n        return;\n      }\n\n      clearCaching();\n    });\n  };\n\n  addActionHandler('saveSession', (): ActionReturnType => {\n    if (isCaching) {\n      return;\n    }\n\n    setupCaching();\n    updateCacheForced();\n  });\n\n  addActionHandler('reset', resetCache);\n}\n\nexport async function loadCache(initialState: GlobalState): Promise<GlobalState | undefined> {\n  if (GLOBAL_STATE_CACHE_DISABLED) {\n    return undefined;\n  }\n\n  const cache = await readCache(initialState);\n\n  if (cache.passcode.hasPasscode || hasStoredSession()) {\n    setupCaching();\n\n    return cache;\n  } else {\n    clearCaching();\n\n    return undefined;\n  }\n}\n\nexport function setupCaching() {\n  isCaching = true;\n  unsubscribeFromBeforeUnload = onBeforeUnload(updateCacheForced, true);\n  window.addEventListener('blur', updateCacheForced);\n  addCallback(updateCacheThrottled);\n}\n\nexport function clearCaching() {\n  isCaching = false;\n  removeCallback(updateCacheThrottled);\n  window.removeEventListener('blur', updateCacheForced);\n  if (unsubscribeFromBeforeUnload) {\n    unsubscribeFromBeforeUnload();\n  }\n}\n\nasync function readCache(initialState: GlobalState): Promise<GlobalState> {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.time('global-state-cache-read');\n  }\n\n  const json = localStorage.getItem(GLOBAL_STATE_CACHE_KEY);\n  const cachedFromLocalStorage = json ? JSON.parse(json) as GlobalState : undefined;\n  if (cachedFromLocalStorage) localStorage.removeItem(GLOBAL_STATE_CACHE_KEY);\n\n  let cached = cachedFromLocalStorage || await loadCachedGlobal();\n  const cachedSharedState = await loadCachedSharedState();\n  const sharedState = cachedSharedState || initialState.sharedState;\n\n  if (cached) {\n    cached = {\n      ...cached,\n      sharedState,\n    };\n  }\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.timeEnd('global-state-cache-read');\n  }\n\n  if (cached) {\n    migrateCache(cached, initialState);\n  }\n\n  const newState: GlobalState = {\n    ...initialState,\n    ...cached,\n    sharedState: {\n      ...sharedState,\n      ...cached?.sharedState, // Allow migration to override shared state\n    },\n  };\n\n  return newState;\n}\n\nexport function migrateCache(cached: GlobalState, initialState: GlobalState) {\n  try {\n    unsafeMigrateCache(cached, initialState);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n  }\n}\n\nfunction unsafeMigrateCache(cached: GlobalState, initialState: GlobalState) {\n  const untypedCached = cached as any;\n  // Pre-fill settings with defaults\n  cached.settings.byKey = {\n    ...initialState.settings.byKey,\n    ...cached.settings.byKey,\n  };\n\n  cached.chatFolders = {\n    ...initialState.chatFolders,\n    ...cached.chatFolders,\n  };\n\n  if (!cached.chats.similarChannelsById) {\n    cached.chats.similarChannelsById = initialState.chats.similarChannelsById;\n  }\n\n  if (!cached.chats.similarBotsById) {\n    cached.chats.similarBotsById = initialState.chats.similarBotsById;\n  }\n\n  if (!cached.chats.lastMessageIds) {\n    cached.chats.lastMessageIds = initialState.chats.lastMessageIds;\n  }\n\n  // Clear old color storage to optimize cache size\n  if (untypedCached?.appConfig.peerColors) {\n    untypedCached.appConfig.peerColors = undefined;\n    untypedCached.appConfig.darkPeerColors = undefined;\n  }\n\n  if (!cached.fileUploads.byMessageKey) {\n    cached.fileUploads.byMessageKey = {};\n  }\n\n  if (!cached.reactions) {\n    cached.reactions = initialState.reactions;\n  }\n\n  if (!cached.quickReplies) {\n    cached.quickReplies = initialState.quickReplies;\n  }\n\n  if (!cached.users.previewMediaByBotId) {\n    cached.users.previewMediaByBotId = initialState.users.previewMediaByBotId;\n  }\n  if (!cached.chats.loadingParameters) {\n    cached.chats.loadingParameters = initialState.chats.loadingParameters;\n  }\n  if (!cached.topBotApps) {\n    cached.topBotApps = initialState.topBotApps;\n  }\n\n  if (!cached.reactions.defaultTags?.[0]?.type) {\n    cached.reactions = initialState.reactions;\n  }\n\n  if (!cached.users.commonChatsById) {\n    cached.users.commonChatsById = initialState.users.commonChatsById;\n  }\n  if (!cached.users.botAppPermissionsById) {\n    cached.users.botAppPermissionsById = initialState.users.botAppPermissionsById;\n  }\n  if (!cached.chats.topicsInfoById) {\n    cached.chats.topicsInfoById = initialState.chats.topicsInfoById;\n  }\n\n  if (!cached.messages.pollById) {\n    cached.messages.pollById = initialState.messages.pollById;\n  }\n  if (!cached.settings.botVerificationShownPeerIds) {\n    cached.settings.botVerificationShownPeerIds = initialState.settings.botVerificationShownPeerIds;\n  }\n\n  if (!cached.peers) {\n    cached.peers = initialState.peers;\n  }\n\n  if (!cached.settings.accountDaysTtl) {\n    cached.settings.accountDaysTtl = initialState.settings.accountDaysTtl;\n  }\n\n  if (!cached.cacheVersion) {\n    cached.cacheVersion = initialState.cacheVersion;\n    // Reset because of the new action message structure\n    cached.messages = initialState.messages;\n    cached.chats.listIds = initialState.chats.listIds;\n  }\n\n  if (!cached.messages.playbackByChatId) {\n    cached.messages.playbackByChatId = initialState.messages.playbackByChatId;\n  }\n\n  if (cached.cacheVersion < 2) {\n    if (untypedCached.settings.themes.dark) {\n      untypedCached.settings.themes.dark.patternColor = (initialState as any).settings.themes.dark!.patternColor;\n    }\n\n    if (untypedCached.settings.themes.light) {\n      untypedCached.settings.themes.light.patternColor = (initialState as any).settings.themes.light!.patternColor;\n    }\n\n    cached.cacheVersion = 2;\n  }\n\n  if (!cached.chats.notifyExceptionById) {\n    cached.chats.notifyExceptionById = initialState.chats.notifyExceptionById;\n  }\n\n  if (!cached.sharedState) {\n    cached.sharedState = initialState.sharedState;\n    cached.sharedState.settings = {\n      canDisplayChatInTitle: untypedCached.settings.byKey.canDisplayChatInTitle,\n      animationLevel: untypedCached.settings.byKey.animationLevel,\n      foldersPosition: FOLDERS_POSITION_DEFAULT,\n      messageSendKeyCombo: untypedCached.settings.byKey.messageSendKeyCombo,\n      messageTextSize: untypedCached.settings.byKey.messageTextSize,\n      performance: untypedCached.settings.performance,\n      theme: untypedCached.settings.byKey.theme,\n      timeFormat: untypedCached.settings.byKey.timeFormat,\n      wasTimeFormatSetManually: untypedCached.settings.byKey.wasTimeFormatSetManually,\n      shouldUseSystemTheme: untypedCached.settings.byKey.shouldUseSystemTheme,\n      isConnectionStatusMinimized: untypedCached.settings.byKey.isConnectionStatusMinimized,\n      shouldForceHttpTransport: untypedCached.settings.byKey.shouldForceHttpTransport,\n      language: untypedCached.settings.byKey.language,\n      languages: untypedCached.settings.languages,\n      shouldSkipWebAppCloseConfirmation: untypedCached.settings.byKey.shouldSkipWebAppCloseConfirmation,\n      miniAppsCachedPosition: untypedCached.settings.miniAppsCachedPosition,\n      miniAppsCachedSize: untypedCached.settings.miniAppsCachedSize,\n      shouldAllowHttpTransport: untypedCached.settings.byKey.shouldAllowHttpTransport,\n      shouldCollectDebugLogs: untypedCached.settings.byKey.shouldCollectDebugLogs,\n      shouldDebugExportedSenders: untypedCached.settings.byKey.shouldDebugExportedSenders,\n      shouldWarnAboutFiles: untypedCached.settings.byKey.shouldWarnAboutFiles,\n    };\n  }\n\n  if (!cached.settings.themes) {\n    cached.settings.themes = initialState.settings.themes;\n  }\n\n  if (!cached.messages.webPageById) {\n    cached.messages.webPageById = initialState.messages.webPageById;\n  }\n\n  const cachedSharedSettings = cached.sharedState.settings;\n  if (!cachedSharedSettings.wasAnimationLevelSetManually) {\n    cachedSharedSettings.animationLevel = ANIMATION_LEVEL_DEFAULT;\n    cachedSharedSettings.performance = INITIAL_PERFORMANCE_STATE_MED;\n  }\n\n  if (!cachedSharedSettings.foldersPosition) {\n    cachedSharedSettings.foldersPosition = FOLDERS_POSITION_DEFAULT;\n  }\n\n  if (!cached.appConfig) {\n    cached.appConfig = initialState.appConfig;\n  }\n\n  if (untypedCached.sharedState?.settings?.shouldWarnAboutSvg) {\n    cached.sharedState.settings.shouldWarnAboutFiles = true;\n    untypedCached.sharedState.settings.shouldWarnAboutSvg = undefined;\n  }\n\n  if (!cached.auth) {\n    cached.auth = initialState.auth;\n    cached.auth.rememberMe = untypedCached.rememberMe;\n  }\n\n  if (cached.audioPlayer.volume === undefined) {\n    cached.audioPlayer.volume = initialState.audioPlayer.volume;\n  }\n}\n\nfunction updateCache(force?: boolean) {\n  const global = getGlobal();\n  if (isRemovingCache || !isCaching || global.auth.isLoggingOut || (!force && getIsHeavyAnimating())) {\n    return;\n  }\n\n  forceUpdateCache();\n}\n\nexport function temporarilySuspendCacheUpdate() {\n  cacheUpdateSuspensionTimestamp = Date.now() + UPDATE_THROTTLE;\n}\n\nexport function forceUpdateCache(noEncrypt = false) {\n  if (Date.now() < cacheUpdateSuspensionTimestamp) {\n    return;\n  }\n\n  const global = getGlobal();\n  const { hasPasscode, isScreenLocked } = global.passcode;\n\n  if (hasPasscode) {\n    if (!isScreenLocked && !noEncrypt) {\n      const serializedGlobal = serializeGlobal(global);\n      void encryptSession(undefined, serializedGlobal);\n    }\n\n    cacheIsScreenLocked(global);\n    cacheGlobal(clearGlobalForLockScreen(global, false));\n    cacheSharedState(clearSharedStateForLockScreen(global.sharedState));\n    return;\n  }\n\n  cacheIsScreenLocked(global);\n  cacheGlobal(reduceGlobal(global));\n  cacheSharedState(reduceSharedState(global.sharedState));\n}\n\nfunction reduceGlobal<T extends GlobalState>(global: T) {\n  const reducedGlobal: GlobalState = {\n    ...INITIAL_GLOBAL_STATE,\n    ...pick(global, [\n      'appConfig',\n      'config',\n      'auth',\n      'attachMenu',\n      'currentUserId',\n      'contactList',\n      'topPeers',\n      'topInlineBots',\n      'topBotApps',\n      'recentEmojis',\n      'recentCustomEmojis',\n      'push',\n      'serviceNotifications',\n      'attachmentSettings',\n      'leftColumnWidth',\n      'archiveSettings',\n      'mediaViewer',\n      'audioPlayer',\n      'shouldShowContextMenuHint',\n      'trustedBotIds',\n      'recentlyFoundChatIds',\n      'peerColors',\n      'savedReactionTags',\n      'timezones',\n      'availableEffectById',\n    ]),\n    lastIsChatInfoShown: !getIsMobile() ? global.lastIsChatInfoShown : undefined,\n    customEmojis: reduceCustomEmojis(global),\n    users: reduceUsers(global),\n    chats: reduceChats(global),\n    messages: reduceMessages(global),\n    settings: reduceSettings(global),\n    chatFolders: reduceChatFolders(global),\n    groupCalls: reduceGroupCalls(global),\n    reactions: {\n      ...pick(global.reactions, [\n        'defaultTags',\n        'recentReactions',\n        'topReactions',\n        'effectReactions',\n        'hash',\n      ]),\n      availableReactions: reduceAvailableReactions(global.reactions.availableReactions),\n    },\n    passcode: pick(global.passcode, [\n      'isScreenLocked',\n      'hasPasscode',\n      'invalidAttemptsCount',\n      'timeoutUntil',\n    ]),\n    alphahuman: reduceAlphahuman(global),\n  };\n\n  return reducedGlobal;\n}\n\nfunction reduceSharedState(sharedState: SharedState): SharedState {\n  return {\n    ...sharedState,\n    settings: {\n      ...sharedState.settings,\n      languages: undefined,\n    },\n    isInitial: undefined,\n  };\n}\n\nexport function serializeGlobal<T extends GlobalState>(global: T) {\n  return JSON.stringify(reduceGlobal(global));\n}\n\nfunction reduceCustomEmojis<T extends GlobalState>(global: T): GlobalState['customEmojis'] {\n  const { lastRendered, byId } = global.customEmojis;\n  const folderEmojiIds = Object.values(global.chatFolders.byId)\n    .flatMap((folder) => (\n      folder.title.entities\n        ?.filter((entity) => entity.type === ApiMessageEntityTypes.CustomEmoji)\n        ?.map((entity) => entity.documentId) || []\n    ));\n  const idsToSave = unique([...folderEmojiIds, ...lastRendered]).slice(0, GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT);\n  const byIdToSave = pick(byId, idsToSave);\n\n  return {\n    byId: byIdToSave,\n    lastRendered: idsToSave,\n    forEmoji: {},\n    added: {},\n    statusRecent: {},\n  };\n}\n\nfunction reduceUsers<T extends GlobalState>(global: T): GlobalState['users'] {\n  const {\n    users: {\n      byId, statusesById, fullInfoById, botAppPermissionsById,\n    }, currentUserId,\n  } = global;\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }) => selectCurrentMessageList(global, tabId)),\n  ).map(({ chatId }) => chatId).filter((chatId): chatId is string => Boolean(chatId) && isUserId(chatId));\n\n  const visibleUserIds = unique(compact(Object.values(global.byTabId)\n    .flatMap(({ id: tabId }) => selectVisibleUsers(global, tabId)?.map((u) => u.id) || [])));\n\n  const chatStoriesUserIds = currentChatIds\n    .flatMap((chatId) => Object.values(selectChatMessages(global, chatId) || {}))\n    .map((message) => {\n      const webPage = selectFullWebPageFromMessage(global, message);\n      return message.content.storyData?.peerId || webPage?.story?.peerId;\n    })\n    .filter((id): id is string => Boolean(id) && isUserId(id));\n\n  const attachBotIds = Object.keys(global.attachMenu?.bots || {});\n\n  const idsToSave = unique([\n    ...currentUserId ? [currentUserId] : [],\n    ...currentChatIds,\n    ...chatStoriesUserIds,\n    ...visibleUserIds || [],\n    ...attachBotIds,\n    ...global.topPeers.userIds || [],\n    ...global.recentlyFoundChatIds?.filter(isUserId) || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT).filter(isUserId) || [],\n    ...getOrderedIds(ALL_FOLDER_ID)?.filter(isUserId) || [],\n    ...global.contactList?.userIds || [],\n    ...Object.keys(byId),\n  ]).slice(0, GLOBAL_STATE_CACHE_USER_LIST_LIMIT);\n\n  return {\n    ...INITIAL_GLOBAL_STATE.users,\n    byId: pickTruthy(byId, idsToSave),\n    statusesById: pickTruthy(statusesById, idsToSave),\n    fullInfoById: pickTruthy(fullInfoById, idsToSave),\n    botAppPermissionsById,\n  };\n}\n\nfunction reduceChats<T extends GlobalState>(global: T): GlobalState['chats'] {\n  const { chats: { byId }, currentUserId } = global;\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }): MessageList | undefined => {\n        return selectCurrentMessageList(global, tabId);\n      }),\n  ).map(({ chatId }) => chatId);\n\n  const messagesChatIds = compact(Object.values(global.byTabId).flatMap(({ id: tabId }) => {\n    const messageList = selectCurrentMessageList(global, tabId);\n    if (!messageList) return undefined;\n\n    const messages = selectChatMessages(global, messageList.chatId);\n    const viewportIds = selectViewportIds(global, messageList.chatId, messageList.threadId, tabId);\n    return viewportIds?.map((id) => {\n      const message = messages[id];\n      if (!message) return undefined;\n      const content = message.content;\n      const webPage = selectFullWebPageFromMessage(global, message);\n      const replyPeer = message.replyInfo?.type === 'message' && message.replyInfo.replyToPeerId;\n      return content.storyData?.peerId || webPage?.story?.peerId || replyPeer;\n    });\n  }));\n\n  const unlinkedIdsToSave = [\n    ...currentUserId ? [currentUserId] : [],\n    ...currentChatIds,\n    ...messagesChatIds,\n    ...global.recentlyFoundChatIds || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT) || [],\n    ...getOrderedIds(ALL_FOLDER_ID) || [],\n    ...getOrderedIds(SAVED_FOLDER_ID) || [],\n    ...Object.keys(byId),\n  ];\n\n  let idsToSave: string[] = [];\n\n  for (const id of unlinkedIdsToSave) {\n    const chat = byId[id];\n    if (!chat) continue;\n\n    idsToSave.push(id);\n\n    if (chat.linkedMonoforumId) {\n      idsToSave.push(chat.linkedMonoforumId);\n    }\n  }\n\n  idsToSave = unique(idsToSave).slice(0, GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT);\n\n  return {\n    ...global.chats,\n    similarChannelsById: {},\n    similarBotsById: {},\n    isFullyLoaded: {},\n    notifyExceptionById: pickTruthy(global.chats.notifyExceptionById, unlinkedIdsToSave),\n    loadingParameters: INITIAL_GLOBAL_STATE.chats.loadingParameters,\n    byId: pickTruthy(global.chats.byId, unlinkedIdsToSave),\n    fullInfoById: pickTruthy(global.chats.fullInfoById, unlinkedIdsToSave),\n    lastMessageIds: {\n      all: pickTruthy(global.chats.lastMessageIds.all || {}, unlinkedIdsToSave),\n      saved: global.chats.lastMessageIds.saved,\n    },\n    topicsInfoById: pickTruthy(global.chats.topicsInfoById, currentChatIds),\n  };\n}\n\nfunction reduceMessages<T extends GlobalState>(global: T): GlobalState['messages'] {\n  const { currentUserId } = global;\n  const byChatId: GlobalState['messages']['byChatId'] = {};\n  const currentChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ id: tabId }) => selectCurrentMessageList(global, tabId)),\n  ).map(({ chatId }) => chatId);\n  const forumPanelChatIds = compact(\n    Object.values(global.byTabId)\n      .map(({ forumPanelChatId }) => forumPanelChatId),\n  );\n  const chatIdsToSave = unique([\n    ...currentChatIds,\n    ...currentUserId ? [currentUserId] : [],\n    ...forumPanelChatIds,\n    ...getOrderedIds(ALL_FOLDER_ID) || [],\n    ...getOrderedIds(ARCHIVED_FOLDER_ID)?.slice(0, GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT) || [],\n  ]);\n\n  const openedChatThreadIds = Object.values(global.byTabId).reduce((acc, { id: tabId }) => {\n    const { chatId: tabChatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n    if (!tabChatId || !threadId || threadId === MAIN_THREAD_ID) {\n      return acc;\n    }\n    const current = acc[tabChatId] || new Set();\n    current.add(threadId);\n    acc[tabChatId] = current;\n\n    return acc;\n  }, {} as Record<string, Set<ThreadId>>);\n\n  const pollIdsToSave: string[] = [];\n  const webPageIdsToSave: string[] = [];\n\n  chatIdsToSave.forEach((chatId) => {\n    const current = global.messages.byChatId[chatId];\n    if (!current) {\n      return;\n    }\n\n    const chatLastMessageId = selectChatLastMessageId(global, chatId);\n\n    const openedThreadIds = Array.from(openedChatThreadIds[chatId] || []);\n    const commentThreadIds = Object.values(global.messages.byChatId[chatId].threadsById || {})\n      .map(({ threadInfo }) => (threadInfo?.isCommentsInfo ? threadInfo?.originMessageId : undefined))\n      .filter(Boolean);\n    const threadIds = unique(openedThreadIds.concat(commentThreadIds));\n\n    const threadsToSave = pickTruthy(current.threadsById, [MAIN_THREAD_ID, ...threadIds]);\n\n    const viewportIdsToSave = unique(Object.values(threadsToSave).flatMap((thread) => thread.lastViewportIds || []));\n    const topics = selectTopics(global, chatId);\n    const topicLastMessageIds = topics && forumPanelChatIds.includes(chatId)\n      ? Object.values(topics).map(({ lastMessageId }) => lastMessageId) : [];\n    const savedLastMessageIds = chatId === currentUserId && global.chats.lastMessageIds.saved\n      ? Object.values(global.chats.lastMessageIds.saved) : [];\n    const lastMessageIdsToSave = [chatLastMessageId].concat(topicLastMessageIds).concat(savedLastMessageIds)\n      .filter(Boolean);\n    const byId = pick(current.byId, viewportIdsToSave.concat(lastMessageIdsToSave));\n    const threadsById = Object.keys(threadsToSave).reduce((acc, key) => {\n      const thread = threadsToSave[Number(key)];\n      acc[Number(key)] = {\n        ...thread,\n        listedIds: thread.lastViewportIds,\n        pinnedIds: undefined,\n        typingStatus: undefined,\n      };\n      return acc;\n    }, {} as GlobalState['messages']['byChatId'][string]['threadsById']);\n\n    const cleanedById = Object.values(byId).reduce((acc, message) => {\n      if (!message || message.isTypingDraft) return acc;\n\n      let cleanedMessage = omitLocalMedia(message);\n      cleanedMessage = omitLocalPaidReactions(cleanedMessage);\n      acc[message.id] = cleanedMessage;\n\n      if (message.content.pollId) {\n        pollIdsToSave.push(message.content.pollId);\n      }\n\n      if (message.content.webPage) {\n        webPageIdsToSave.push(message.content.webPage.id);\n      }\n\n      return acc;\n    }, {} as Record<number, ApiMessage>);\n\n    byChatId[chatId] = {\n      byId: cleanedById,\n      threadsById,\n    };\n  });\n\n  return {\n    byChatId,\n    pollById: pickTruthy(global.messages.pollById, pollIdsToSave),\n    webPageById: pickTruthy(global.messages.webPageById, webPageIdsToSave),\n    sponsoredByChatId: {},\n    playbackByChatId: {},\n  };\n}\n\nfunction omitLocalPaidReactions(message: ApiMessage): ApiMessage {\n  if (!message.reactions?.results.length) return message;\n  return {\n    ...message,\n    reactions: {\n      ...message.reactions,\n      results: message.reactions.results.map((reaction) => {\n        if (reaction.localAmount) {\n          return {\n            ...reaction,\n            localAmount: undefined,\n          };\n        }\n        return reaction;\n      }),\n    },\n  };\n}\n\nfunction omitLocalMedia(message: ApiMessage): ApiMessage {\n  const {\n    photo, video, document, sticker,\n  } = message.content;\n\n  return {\n    ...message,\n    content: {\n      ...message.content,\n      photo: photo && {\n        ...photo,\n        blobUrl: undefined,\n      },\n      video: video && {\n        ...video,\n        blobUrl: undefined,\n        previewBlobUrl: undefined,\n      },\n      document: document && {\n        ...document,\n        previewBlobUrl: undefined,\n      },\n      sticker: sticker && {\n        ...sticker,\n        isPreloadedGlobally: undefined,\n      },\n    },\n    previousLocalId: undefined,\n  };\n}\n\nfunction reduceSettings<T extends GlobalState>(global: T): GlobalState['settings'] {\n  const {\n    byKey, botVerificationShownPeerIds, notifyDefaults, lastPremiumBandwithNotificationDate, themes, accountDaysTtl,\n  } = global.settings;\n\n  return {\n    byKey,\n    privacy: {},\n    botVerificationShownPeerIds,\n    lastPremiumBandwithNotificationDate,\n    notifyDefaults,\n    themes,\n    accountDaysTtl,\n  };\n}\n\nfunction reduceChatFolders<T extends GlobalState>(global: T): GlobalState['chatFolders'] {\n  return {\n    ...global.chatFolders,\n  };\n}\n\nfunction reduceGroupCalls<T extends GlobalState>(global: T): GlobalState['groupCalls'] {\n  return {\n    ...global.groupCalls,\n    byId: {},\n    activeGroupCallId: undefined,\n  };\n}\n\nfunction reduceAlphahuman<T extends GlobalState>(global: T): GlobalState['alphahuman'] {\n  const alphahuman = global.alphahuman;\n  if (!alphahuman) {\n    return INITIAL_GLOBAL_STATE.alphahuman;\n  }\n\n  return {\n    ...INITIAL_GLOBAL_STATE.alphahuman,\n    jwtToken: alphahuman.jwtToken,\n  };\n}\n\nfunction reduceAvailableReactions(availableReactions?: ApiAvailableReaction[]): ApiAvailableReaction[] | undefined {\n  return availableReactions\n    ?.map((r) => pick(r, ['reaction', 'staticIcon', 'title', 'isInactive']));\n}\n","import { memo, useMemo, useState } from '../../lib/teact/teact';\n\nimport { debounce } from '../../util/schedulers';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport './RippleEffect.scss';\n\ninterface Ripple {\n  x: number;\n  y: number;\n  size: number;\n}\n\nconst ANIMATION_DURATION_MS = 700;\n\nconst RippleEffect = () => {\n  const [ripples, setRipples] = useState<Ripple[]>([]);\n\n  const cleanUpDebounced = useMemo(() => {\n    return debounce(() => {\n      setRipples([]);\n    }, ANIMATION_DURATION_MS, false);\n  }, []);\n\n  const handleMouseDown = useLastCallback((e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    if (e.button !== 0) {\n      return;\n    }\n\n    const container = e.currentTarget;\n    const position = container.getBoundingClientRect();\n    const rippleSize = container.offsetWidth / 2;\n\n    setRipples([\n      ...ripples,\n      {\n        x: e.clientX - position.x - (rippleSize / 2),\n        y: e.clientY - position.y - (rippleSize / 2),\n        size: rippleSize,\n      },\n    ]);\n\n    cleanUpDebounced();\n  });\n\n  return (\n    <div className=\"ripple-container\" onMouseDown={handleMouseDown}>\n      {ripples.map(({ x, y, size }) => (\n        <div\n          className=\"ripple-wave\"\n          style={`left: ${x}px; top: ${y}px; width: ${size}px; height: ${size}px;`}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(RippleEffect);\n","import { DEBUG } from '../../config';\n\nexport default function readStrings(data: string): Record<string, string> {\n  const lines = data.split(/;\\r?\\n?/);\n  const result: Record<string, string> = {};\n  for (const line of lines) {\n    if (!line.startsWith('\"')) continue;\n    const [key, value] = parseLine(line) || [];\n    if (!key || !value) {\n      // eslint-disable-next-line no-console\n      console.warn('Bad formatting in line:', line);\n      continue;\n    }\n    if (result[key]) {\n      // eslint-disable-next-line no-console\n      console.warn('Duplicate key:', key);\n    }\n    result[key] = value;\n  }\n  return result;\n}\n\nfunction parseLine(line: string) {\n  let isEscaped = false;\n  let isInsideString = false;\n\n  let separatorIndex;\n  for (let i = 0; i < line.length; i++) {\n    const char = line[i];\n    if (char === '\\\\') {\n      isEscaped = !isEscaped;\n      continue;\n    }\n\n    if (char === '\"' && !isEscaped) {\n      isInsideString = !isInsideString;\n      continue;\n    }\n\n    if (char === '=' && !isInsideString) {\n      separatorIndex = i;\n      break;\n    }\n\n    isEscaped = false;\n  }\n\n  if (separatorIndex === undefined || separatorIndex === line.length - 1) return undefined;\n\n  try {\n    const key = JSON.parse(line.slice(0, separatorIndex));\n    const value = JSON.parse(line.slice(separatorIndex + 1));\n\n    return [key, value];\n  } catch (e) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error('Error parsing line:', line, e);\n    }\n  }\n\n  return undefined;\n}\n","import type {\n  ApiLanguage, CachedLangData, LangPack, LangPackStringValuePlural,\n} from '../../api/types';\n\nimport readStrings from './readStrings';\n\nconst FALLBACK_LANG_CODE = 'en';\nconst FALLBACK_VERSION = 0;\nconst FALLBACK_TRANSLATE_URL = 'https://translations.telegram.org/en/weba';\n\nexport default async function readFallbackStrings(forLocalScript?: boolean): Promise<CachedLangData> {\n  let fileData;\n  if (forLocalScript) {\n    fileData = (await import('fs')).readFileSync('./src/assets/localization/fallback.strings', 'utf8');\n  } else {\n    const file = await import('../../assets/localization/fallback.strings');\n    fileData = file.default;\n  }\n  const rawStrings = readStrings(fileData);\n\n  const strings: LangPack['strings'] = {};\n\n  Object.entries(rawStrings).forEach(([key, value]) => {\n    const [clearKey, pluralSuffix] = key.split('_');\n\n    if (!pluralSuffix) {\n      strings[clearKey] = value;\n      return;\n    }\n\n    const knownValue = (strings[clearKey] || {}) as LangPackStringValuePlural;\n    knownValue[pluralSuffix as keyof LangPackStringValuePlural] = value;\n    strings[clearKey] = knownValue;\n  });\n\n  const langPack: LangPack = {\n    langCode: FALLBACK_LANG_CODE,\n    version: FALLBACK_VERSION,\n    strings,\n  };\n\n  const stringsCount = Object.keys(strings).length;\n\n  const language: ApiLanguage = {\n    langCode: FALLBACK_LANG_CODE,\n    name: 'English',\n    nativeName: 'English',\n    pluralCode: FALLBACK_LANG_CODE,\n    stringsCount,\n    translatedCount: stringsCount,\n    translationsUrl: FALLBACK_TRANSLATE_URL,\n  };\n\n  return {\n    langPack,\n    language,\n  };\n}\n","/* eslint-disable */\n// This file is generated by dev/generateInitialLangFallback.ts. Do not edit it manually.\n\nimport type { LangPackStringValue } from '../../api/types';\nimport type { LangKey } from '../../types/language';\n\nexport default {\n  \"WrongNumber\": \"Wrong number?\",\n  \"SentAppCode\": \"We've sent the code to the **Telegram** app on your other device.\",\n  \"LoginJustSentSms\": \"We've sent you a code via SMS. Please enter it above.\",\n  \"LoginHeaderPassword\": \"Enter Password\",\n  \"LoginEnterPasswordDescription\": \"You have Two-Step Verification enabled, so your account is protected with an additional password.\",\n  \"StartText\": \"Please confirm your country code\\nand enter your phone number.\",\n  \"LoginPhonePlaceholder\": \"Your phone number\",\n  \"LoginNext\": \"Next\",\n  \"LoginQRLogin\": \"Log in by QR Code\",\n  \"LoginQRTitle\": \"Log in to Telegram by QR Code\",\n  \"LoginQRHelp1\": \"Open Telegram on your phone\",\n  \"LoginQRHelp2\": \"Go to **Settings** > **Devices** > **Link Desktop Device**\",\n  \"LoginQRHelp3\": \"Point your phone at this screen to confirm login\",\n  \"LoginQRCancel\": \"Log in by phone number\",\n  \"LoginPasskey\": \"Log in with Passkey\",\n  \"YourName\": \"Your Name\",\n  \"LoginRegisterDesc\": \"Enter your name and add a profile photo.\",\n  \"LoginRegisterFirstNamePlaceholder\": \"First Name\",\n  \"LoginRegisterLastNamePlaceholder\": \"Last Name\",\n  \"LoginSelectCountryTitle\": \"Country\",\n  \"CountryNone\": \"Country not found\",\n  \"PleaseEnterPassword\": \"Enter your new password\",\n  \"ErrorPhoneNumberInvalid\": \"Invalid phone number, please try again\",\n  \"ErrorCodeInvalid\": \"Invalid code, please try again\",\n  \"ErrorIncorrectPassword\": \"Invalid password, please try again\",\n  \"ErrorPasswordFlood\": \"Too many attempts, please try again later\",\n  \"ErrorPhoneBanned\": \"This phone number is banned\",\n  \"ErrorFloodTime\": \"Too many attempts, please try again in {time}\",\n  \"ErrorUnexpected\": \"Unexpected error\",\n  \"ErrorUnexpectedMessage\": \"Unexpected error: {error}\"\n} as Record<LangKey, LangPackStringValue>;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiLanguage,\n  CachedLangData,\n  LangPack,\n  LangPackStringValue,\n} from '../../api/types';\nimport type { LangKey, LangVariable } from '../../types/language';\nimport {\n  type AdvancedLangFnOptions,\n  type AdvancedLangFnOptionsWithPlural,\n  type AdvancedLangFnParameters,\n  areAdvancedLangFnOptions,\n  isDeletedLangString,\n  isPluralLangString,\n  type LangFn,\n  type LangFnOptions,\n  type LangFnOptionsWithPlural,\n  type LangFnParameters,\n  type LangFormatters,\n  type RegularLangFnParameters,\n} from './types';\n\nimport { DEBUG, FORCE_FALLBACK_LANG, LANG_PACK } from '../../config';\nimport { callApi } from '../../api/gramjs';\nimport renderText, { type TextFilter } from '../../components/common/helpers/renderText';\nimport { IS_INTL_LIST_FORMAT_SUPPORTED } from '../browser/globalEnvironment';\nimport { MAIN_IDB_STORE } from '../browser/idb';\nimport { getBasicListFormat } from '../browser/intlListFormat';\nimport { notifyLangpackUpdate } from '../browser/multitab';\nimport { createCallbackManager } from '../callbacks';\nimport readFallbackStrings from '../data/readFallbackStrings';\nimport { initialEstablishmentPromise, isCurrentTabMaster } from '../establishMultitabRole';\nimport { omit, unique } from '../iteratees';\nimport { replaceInStringsWithTeact } from '../replaceWithTeact';\nimport { fastRaf } from '../schedulers';\n\nimport Deferred from '../Deferred';\nimport LimitedMap from '../primitives/LimitedMap';\n\nimport initialStrings from '../../assets/localization/initialStrings';\n\nconst LANGPACK_STORE_PREFIX = 'langpack-';\nconst FORMATTERS_FALLBACK_LANG = 'en';\n\nconst STRING_CACHE_LIMIT = 400;\nconst TRANSLATION_CACHE = new LimitedMap<string, string>(STRING_CACHE_LIMIT);\n\nlet language: ApiLanguage | undefined;\nlet formatters: LangFormatters | undefined;\n\nlet langPack: LangPack | undefined;\nlet fallbackLangPack: LangPack | undefined;\n\nlet translationFn = createTranslationFn();\n\nconst {\n  addCallback,\n  removeCallback,\n  runCallbacks,\n} = createCallbackManager();\n\nlet areCallbacksScheduled = false;\nfunction scheduleCallbacks() {\n  if (areCallbacksScheduled) return;\n  areCallbacksScheduled = true;\n  fastRaf(() => {\n    runCallbacks();\n    areCallbacksScheduled = false;\n  });\n}\n\nconst localizationReady = new Deferred<void>();\n\nfunction loadCachedLangData(langCode: string) {\n  return MAIN_IDB_STORE.get<CachedLangData>(`${LANGPACK_STORE_PREFIX}${langCode}`);\n}\n\nfunction cacheLangData(data: CachedLangData) {\n  notifyLangpackUpdate(data.language.langCode);\n  return MAIN_IDB_STORE.set(`${LANGPACK_STORE_PREFIX}${data.language.langCode}`, data);\n}\n\nlet fallbackLoadPromise: Promise<CachedLangData> | undefined;\nasync function loadFallbackPack() {\n  if (fallbackLangPack || fallbackLoadPromise) return;\n  fallbackLoadPromise = readFallbackStrings();\n  const fallbackData = await fallbackLoadPromise;\n  fallbackLangPack = fallbackData.langPack;\n\n  TRANSLATION_CACHE.clear();\n\n  if (!language) {\n    updateLanguage(fallbackData.language);\n  } else {\n    translationFn = createTranslationFn();\n    scheduleCallbacks();\n  }\n}\n\nasync function fetchDifference() {\n  if (!langPack || !language) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('[Localization] Trying to fetch difference without loaded data');\n    }\n    return;\n  }\n\n  await initialEstablishmentPromise;\n  if (!isCurrentTabMaster()) return;\n\n  const result = await callApi('fetchLangDifference', {\n    langPack: LANG_PACK,\n    langCode: langPack.langCode,\n    fromVersion: langPack.version,\n  });\n  if (!result) return;\n\n  applyLangPackDifference(result.version, result.strings, result.keysToRemove);\n}\n\nexport function applyLangPackDifference(\n  version: number, strings: Record<string, LangPackStringValue>, keysToRemove: string[],\n) {\n  if (!langPack || !language || version === langPack.version) return;\n\n  const newLangPack = {\n    ...langPack,\n    version,\n    strings: {\n      ...omit(langPack.strings, keysToRemove),\n      ...strings,\n    },\n  };\n  updateLangPack(newLangPack);\n\n  cacheLangData({\n    langPack: newLangPack,\n    language,\n  });\n  scheduleCallbacks();\n}\n\nfunction updateLanguage(newLang: ApiLanguage) {\n  language = newLang;\n\n  createFormatters();\n\n  translationFn = createTranslationFn();\n\n  scheduleCallbacks();\n}\n\nfunction createFormatters() {\n  if (!language) return;\n  const langCode = language.pluralCode;\n  const listFormatFallback = getBasicListFormat();\n\n  function createListFormat(lang: string, type: 'conjunction' | 'disjunction') {\n    return IS_INTL_LIST_FORMAT_SUPPORTED ? new Intl.ListFormat(lang, { type }) : listFormatFallback;\n  }\n\n  try {\n    formatters = {\n      pluralRules: new Intl.PluralRules(langCode),\n      region: new Intl.DisplayNames(langCode, { type: 'region' }),\n      conjunction: createListFormat(langCode, 'conjunction'),\n      disjunction: createListFormat(langCode, 'disjunction'),\n      number: new Intl.NumberFormat(langCode),\n      preciseNumber: new Intl.NumberFormat(langCode, {\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 10,\n      }),\n    };\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn('Failed to create formatters:', e);\n    formatters = {\n      pluralRules: new Intl.PluralRules(FORMATTERS_FALLBACK_LANG),\n      region: new Intl.DisplayNames(FORMATTERS_FALLBACK_LANG, { type: 'region' }),\n      conjunction: createListFormat(FORMATTERS_FALLBACK_LANG, 'conjunction'),\n      disjunction: createListFormat(FORMATTERS_FALLBACK_LANG, 'disjunction'),\n      number: new Intl.NumberFormat(FORMATTERS_FALLBACK_LANG),\n      preciseNumber: new Intl.NumberFormat(FORMATTERS_FALLBACK_LANG, {\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 10,\n      }),\n    };\n  }\n}\n\nfunction updateLangPack(newLangPack: LangPack) {\n  langPack = newLangPack;\n\n  TRANSLATION_CACHE.clear();\n\n  scheduleCallbacks();\n}\n\nexport async function initLocalization(langCode: string, canLoadFromServer?: boolean) {\n  if (language) return;\n\n  const cachedData = await loadCachedLangData(langCode);\n  if (cachedData) {\n    langPack = cachedData.langPack;\n    language = cachedData.language;\n    createFormatters();\n\n    fetchDifference();\n  } else if (canLoadFromServer) {\n    await loadAndChangeLanguage(langCode);\n  }\n\n  // Always start loading fallback pack in the background. Some languages may not have every string translated.\n  loadFallbackPack();\n\n  translationFn = createTranslationFn();\n  scheduleCallbacks();\n  localizationReady.resolve();\n}\n\nexport async function refreshFromCache(langCode: string) {\n  if (isCurrentTabMaster()) return;\n\n  const cachedData = await loadCachedLangData(langCode);\n  if (cachedData) {\n    updateLangPack(cachedData.langPack);\n    updateLanguage(cachedData.language);\n  }\n}\n\nexport async function loadAndChangeLanguage(langCode: string, shouldCheckCache?: boolean) {\n  if (shouldCheckCache) { // Can be removed when old lang provider is phased out. Cache is checked in `initLocalization`.\n    const cachedData = await loadCachedLangData(langCode);\n    if (cachedData) {\n      return changeLanguage(cachedData.language);\n    }\n  }\n\n  await initialEstablishmentPromise;\n  if (!isCurrentTabMaster()) return undefined;\n\n  const remoteLanguage = await callApi('fetchLanguage', {\n    langPack: LANG_PACK,\n    langCode,\n  });\n\n  if (!remoteLanguage) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to fetch language', langCode);\n    }\n    return undefined;\n  }\n\n  return changeLanguage(remoteLanguage);\n}\n\nexport function requestLangPackDifference(langCode: string) {\n  if (language?.langCode !== langCode) return;\n  fetchDifference();\n}\n\nexport async function changeLanguage(newLanguage: ApiLanguage) {\n  if (langPack && language?.langCode === newLanguage.langCode) return;\n\n  const cachedData = await loadCachedLangData(newLanguage.langCode);\n  if (cachedData) {\n    updateLangPack(cachedData.langPack);\n    updateLanguage(cachedData.language);\n\n    fetchDifference();\n  } else {\n    await initialEstablishmentPromise;\n    if (!isCurrentTabMaster()) return;\n    const remoteLangPack = await callApi('fetchLangPack', {\n      langPack: LANG_PACK,\n      langCode: newLanguage.langCode,\n    });\n    if (!remoteLangPack) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to fetch lang pack');\n      return;\n    }\n\n    updateLangPack({\n      langCode: newLanguage.langCode,\n      version: remoteLangPack.version,\n      strings: remoteLangPack.strings,\n    });\n    updateLanguage(newLanguage);\n\n    cacheLangData({\n      langPack: langPack!,\n      language: newLanguage,\n    });\n  }\n\n  document.documentElement.lang = newLanguage.baseLangCode || newLanguage.langCode;\n\n  scheduleCallbacks();\n}\n\nfunction createTranslationFn(): LangFn {\n  const fn: LangFn = ((\n    key: LangKey,\n    variables: Record<string, unknown> | undefined,\n    options: LangFnOptions | AdvancedLangFnOptions | undefined,\n  ) => {\n    if (options && areAdvancedLangFnOptions(options)) {\n      return processTranslationAdvanced(key, variables as Record<string, TeactNode>, options);\n    }\n    return processTranslation(key, variables as Record<string, string | number>, options);\n  }) as LangFn;\n  fn.rawCode = language?.langCode || FORMATTERS_FALLBACK_LANG;\n  fn.isRtl = language?.isRtl;\n  fn.code = language?.pluralCode || FORMATTERS_FALLBACK_LANG;\n  fn.with = ({ key, variables, options }: LangFnParameters) => {\n    if (options && areAdvancedLangFnOptions(options)) {\n      return processTranslationAdvanced(key, variables as Record<string, TeactNode | undefined>, options);\n    }\n    return processTranslation(key, variables as Record<string, LangVariable>, options);\n  };\n  fn.withRegular = ({ key, variables, options }: RegularLangFnParameters) => {\n    return processTranslation(key, variables, options);\n  };\n  fn.withAdvanced = ({ key, variables, options }: AdvancedLangFnParameters) => {\n    return processTranslationAdvanced(key, variables, options);\n  };\n  fn.region = (code: string) => formatters?.region.of(code);\n  fn.conjunction = (list: string[]) => formatters?.conjunction.format(list) || list.join(', ');\n  fn.disjunction = (list: string[]) => formatters?.disjunction.format(list) || list.join(', ');\n  fn.number = (value: number) => formatters?.number.format(value) || String(value);\n  fn.preciseNumber = (value: number) => formatters?.preciseNumber.format(value) || String(value);\n  fn.internalFormatters = formatters!;\n  fn.languageInfo = language!;\n  return fn;\n}\n\nexport function getTranslationFn(): LangFn {\n  return translationFn;\n}\n\nfunction getString(langKey: LangKey, count: number) {\n  let langPackStringValue = !FORCE_FALLBACK_LANG ? langPack?.strings[langKey] : undefined;\n\n  if (!langPackStringValue && !fallbackLangPack) {\n    loadFallbackPack();\n  }\n\n  langPackStringValue ||= fallbackLangPack?.strings[langKey];\n  langPackStringValue ||= initialStrings[langKey];\n\n  if (!langPackStringValue || isDeletedLangString(langPackStringValue)) return undefined;\n\n  const pluralSuffix = formatters?.pluralRules.select(count) || 'other';\n\n  const string = isPluralLangString(langPackStringValue)\n    ? (langPackStringValue[pluralSuffix] || langPackStringValue.other)\n    : langPackStringValue;\n\n  return string;\n}\n\nfunction processTranslation(\n  langKey: LangKey,\n  variables?: Record<string, LangVariable | RegularLangFnParameters>,\n  options?: LangFnOptions | LangFnOptionsWithPlural,\n): string {\n  const isCacheable = !options?.withNodes;\n  const cacheKey = isCacheable ? `${langKey}-${JSON.stringify(variables)}-${JSON.stringify(options)}` : undefined;\n  if (cacheKey) {\n    if (TRANSLATION_CACHE.has(cacheKey)) {\n      return TRANSLATION_CACHE.get(cacheKey)!;\n    }\n  }\n\n  const pluralValue = options && 'pluralValue' in options ? Number(options.pluralValue) : 0;\n  const string = getString(langKey, pluralValue);\n\n  if (!string) return langKey;\n\n  const variableEntries = variables ? Object.entries(variables) : [];\n  const finalString = variableEntries.reduce((result, [key, value]) => {\n    if (value === undefined) return result;\n    if (typeof value === 'object') { // Allow recursive variables in basic `lang.with`\n      value = processTranslation(value.key, value.variables, value.options);\n    }\n\n    const valueAsString = Number.isFinite(value) ? formatters!.number.format(value as number) : String(value);\n    return result.replaceAll(`{${key}}`, valueAsString);\n  }, string);\n\n  if (cacheKey) {\n    TRANSLATION_CACHE.set(cacheKey, finalString);\n  }\n\n  return finalString;\n}\n\nfunction processTranslationAdvanced(\n  langKey: LangKey,\n  variables?: Record<string, TeactNode | undefined>,\n  options?: AdvancedLangFnOptions | AdvancedLangFnOptionsWithPlural,\n): TeactNode {\n  const pluralValue = options && 'pluralValue' in options ? Number(options.pluralValue) : 0;\n  const string = getString(langKey, pluralValue);\n  if (!string) return langKey;\n\n  const variableEntries = variables ? Object.entries(variables) : [];\n\n  let tempResult: TeactNode = string;\n  if (options?.specialReplacement) {\n    const specialReplacements = Object.entries(options.specialReplacement);\n    tempResult = specialReplacements.reduce((acc, [key, value]) => {\n      return replaceInStringsWithTeact(acc, key, value);\n    }, tempResult as TeactNode);\n  }\n\n  const withRenderText = options?.withNodes;\n\n  if (withRenderText) {\n    const initialFilters: TextFilter[] = options.withMarkdown ? ['simple_markdown', 'emoji'] : ['emoji'];\n\n    const filters = unique([...initialFilters, ...options.renderTextFilters || []]);\n\n    const tempResultArray = Array.isArray(tempResult) ? tempResult : [tempResult];\n    return tempResultArray.flatMap((curr: TeactNode) => {\n      if (typeof curr !== 'string') {\n        return curr;\n      }\n\n      return renderText(curr, filters, {\n        markdownPostProcessor: (part: string) => {\n          return variableEntries.reduce((result, [key, value]): TeactNode => {\n            if (value === undefined) return result;\n\n            const preparedValue = Number.isFinite(value) ? formatters!.number.format(value as number) : value;\n            return replaceInStringsWithTeact(result, `{${key}}`, renderText(preparedValue));\n          }, part as TeactNode);\n        },\n      });\n    });\n  }\n\n  return variableEntries.reduce((result, [key, value]): TeactNode => {\n    if (value === undefined) return result;\n\n    const preparedValue = Number.isFinite(value) ? formatters!.number.format(value as number) : value;\n    return replaceInStringsWithTeact(result, `{${key}}`, renderText(preparedValue));\n  }, tempResult);\n}\n\nexport const localizationReadyPromise = localizationReady.promise;\n\nexport {\n  addCallback as addLocalizationCallback,\n  removeCallback as removeLocalizationCallback,\n};\n\nexport type {\n  LangFn,\n  LangFnParameters,\n  RegularLangFnParameters,\n  AdvancedLangFnParameters,\n};\n","type Part = {\n  type: 'literal' | 'element';\n  value: string;\n};\n\nexport function getBasicListFormat() {\n  return {\n    format: (items: string[]) => items.join(', '),\n    formatToParts: (items: string[]): Part[] => {\n      const result: Part[] = [];\n\n      items.forEach((item, i) => {\n        if (i > 0) {\n          result.push({ type: 'literal', value: ', ' });\n        }\n        result.push({ type: 'element', value: item });\n      });\n\n      return result;\n    },\n  };\n}\n","export const clamp = (num: number, min: number, max: number) => (Math.min(max, Math.max(min, num)));\nexport const isBetween = (num: number, min: number, max: number) => (num >= min && num <= max);\nexport const round = (num: number, decimals: number = 0) => Math.round(num * 10 ** decimals) / 10 ** decimals;\nexport const ceil = (num: number, decimals: number = 0) => Math.ceil(num * 10 ** decimals) / 10 ** decimals;\nexport const floor = (num: number, decimals: number = 0) => Math.floor(num * 10 ** decimals) / 10 ** decimals;\nexport const lerp = (start: number, end: number, interpolationRatio: number) => {\n  return (1 - interpolationRatio) * start + interpolationRatio * end;\n};\n\n// Fractional values cause blurry text & canvas. Round to even to keep whole numbers while centering\nexport function roundToNearestEven(value: number) {\n  return Math.round(value / 2) * 2;\n}\n","import type { IDimensions } from '../types';\n\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from './browser/windowEnvironment';\nimport { throttle } from './schedulers';\n\nconst WINDOW_ORIENTATION_CHANGE_THROTTLE_MS = 100;\nconst WINDOW_RESIZE_THROTTLE_MS = 250;\n\nlet initialHeight = window.innerHeight;\nlet currentWindowSize = updateSizes();\n\nconst handleResize = throttle(() => {\n  currentWindowSize = updateSizes();\n}, WINDOW_RESIZE_THROTTLE_MS, true);\n\nconst handleOrientationChange = throttle(() => {\n  initialHeight = window.innerHeight;\n  handleResize();\n}, WINDOW_ORIENTATION_CHANGE_THROTTLE_MS, false);\n\nwindow.addEventListener('orientationchange', handleOrientationChange);\nif (IS_IOS) {\n  window.visualViewport!.addEventListener('resize', handleResize);\n} else {\n  window.addEventListener('resize', handleResize);\n}\n\nexport function updateSizes(): IDimensions {\n  let height: number;\n  if (IS_IOS) {\n    height = window.visualViewport!.height + window.visualViewport!.pageTop;\n  } else {\n    height = window.innerHeight;\n  }\n\n  requestMutation(() => {\n    const vh = height * 0.01;\n    document.documentElement.style.setProperty('--vh', `${vh}px`);\n  });\n\n  return {\n    width: window.innerWidth,\n    height: window.innerHeight,\n  };\n}\n\nconst windowSize = {\n  get: () => currentWindowSize,\n  getIsKeyboardVisible: () => initialHeight > currentWindowSize.height,\n};\n\nexport default windowSize;\n","import type { Api } from '../../../lib/gramjs';\nimport type { TypedBroadcastChannel } from '../../../util/browser/multitab';\nimport type { ApiInitialArgs, ApiOnProgress, OnApiUpdate } from '../../types';\nimport type { LocalDb } from '../localDb';\nimport type { MethodArgs, MethodResponse, Methods } from '../methods/types';\nimport type { OriginPayload, ThenArg, WorkerMessageEvent } from './types';\n\nimport { DEBUG, IGNORE_UNHANDLED_ERRORS } from '../../../config';\nimport { IS_TAURI } from '../../../util/browser/globalEnvironment';\nimport { logDebugMessage } from '../../../util/debugConsole';\nimport Deferred from '../../../util/Deferred';\nimport { getCurrentTabId, subscribeToMasterChange } from '../../../util/establishMultitabRole';\nimport generateUniqueId from '../../../util/generateUniqueId';\nimport { ACCOUNT_SLOT, DATA_BROADCAST_CHANNEL_NAME } from '../../../util/multiaccount';\nimport { pause, throttleWithTickEnd } from '../../../util/schedulers';\n\ntype RequestState = {\n  messageId: string;\n  resolve: AnyToVoidFunction;\n  reject: AnyToVoidFunction;\n  callback?: AnyToVoidFunction;\n  DEBUG_payload?: any;\n};\n\ntype EnsurePromise<T> = Promise<Awaited<T>>;\n\nconst HEALTH_CHECK_TIMEOUT = 150;\nconst HEALTH_CHECK_MIN_DELAY = 5 * 1000; // 5 sec\nconst NO_QUEUE_BEFORE_INIT = new Set(['destroy']);\n\nlet worker: Worker | undefined;\n\nconst requestStates = new Map<string, RequestState>();\nconst requestStatesByCallback = new Map<AnyToVoidFunction, RequestState>();\n\nlet pendingPayloads: OriginPayload[] = [];\n\nconst savedLocalDb: LocalDb = {\n  chats: {},\n  users: {},\n  documents: {},\n  stickerSets: {},\n  photos: {},\n  webDocuments: {},\n  commonBoxState: {},\n  channelPtsById: {},\n};\n\nlet isMasterTab = true;\nsubscribeToMasterChange((isMasterTabNew) => {\n  isMasterTab = isMasterTabNew;\n});\n\nconst channel = new BroadcastChannel(DATA_BROADCAST_CHANNEL_NAME) as TypedBroadcastChannel;\n\nconst postMessagesOnTickEnd = throttleWithTickEnd(() => {\n  const payloads = pendingPayloads;\n  pendingPayloads = [];\n  worker?.postMessage({ payloads });\n});\n\nfunction postMessageOnTickEnd(payload: OriginPayload) {\n  pendingPayloads.push(payload);\n  postMessagesOnTickEnd();\n}\n\nexport function initApiOnMasterTab(initialArgs: ApiInitialArgs) {\n  channel.postMessage({\n    type: 'initApi',\n    token: getCurrentTabId(),\n    initialArgs,\n  });\n}\n\nlet updateCallback: OnApiUpdate;\n\nlet localApiRequestsQueue: { fnName: any; args: any; deferred: Deferred<any> }[] = [];\nlet apiRequestsQueue: { fnName: any; args: any; deferred: Deferred<any> }[] = [];\nlet isInited = false;\n\nexport function initApi(onUpdate: OnApiUpdate, initialArgs: ApiInitialArgs) {\n  updateCallback = onUpdate;\n\n  if (!isMasterTab) {\n    initApiOnMasterTab(initialArgs);\n    return Promise.resolve();\n  }\n\n  if (!worker) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.log('>>> START LOAD WORKER');\n    }\n\n    const params = new URLSearchParams();\n    if (ACCOUNT_SLOT) {\n      params.set('account', String(ACCOUNT_SLOT));\n    }\n\n    worker = new Worker(new URL('./worker.ts', import.meta.url), {\n      name: params.toString(),\n    });\n    subscribeToWorker(onUpdate);\n\n    if (initialArgs.platform === 'iOS' || (initialArgs.platform === 'macOS' && IS_TAURI)) {\n      setupHealthCheck();\n    }\n  }\n\n  return makeRequest({\n    type: 'initApi',\n    args: [initialArgs, savedLocalDb],\n  }).then(() => {\n    isInited = true;\n\n    apiRequestsQueue.forEach((request) => {\n      callApi(request.fnName, ...request.args)\n        .then(request.deferred.resolve)\n        .catch(request.deferred.reject);\n    });\n    apiRequestsQueue = [];\n\n    localApiRequestsQueue.forEach((request) => {\n      callApiLocal(request.fnName, ...request.args)\n        .then(request.deferred.resolve)\n        .catch(request.deferred.reject);\n    });\n    localApiRequestsQueue = [];\n  });\n}\n\nexport function updateLocalDb(name: keyof LocalDb, prop: string, value: any) {\n  savedLocalDb[name][prop] = value;\n}\n\nexport function updateFullLocalDb(initial: LocalDb) {\n  Object.assign(savedLocalDb, initial);\n}\n\nexport function callApiOnMasterTab(payload: any) {\n  channel.postMessage({\n    type: 'callApi',\n    token: getCurrentTabId(),\n    ...payload,\n  });\n}\n\nexport function setShouldEnableDebugLog(value: boolean) {\n  return makeRequest({\n    type: 'toggleDebugMode',\n    isEnabled: value,\n  });\n}\n\n/*\n * Call a worker method on this tab's worker, without transferring to master tab\n * Mostly needed to disconnect worker when re-electing master\n */\nexport function callApiLocal<T extends keyof Methods>(\n  fnName: T, ...args: MethodArgs<T>\n): EnsurePromise<MethodResponse<T>> {\n  if (!isInited) {\n    if (NO_QUEUE_BEFORE_INIT.has(fnName)) {\n      return Promise.resolve(undefined) as EnsurePromise<MethodResponse<T>>;\n    }\n\n    const deferred = new Deferred();\n    localApiRequestsQueue.push({ fnName, args, deferred });\n\n    return deferred.promise as EnsurePromise<MethodResponse<T>>;\n  }\n\n  const promise = makeRequest({\n    type: 'callMethod',\n    name: fnName,\n    args,\n  });\n\n  // Some TypeScript magic to make sure `VirtualClass` is never returned from any method\n  if (DEBUG) {\n    (async () => {\n      try {\n        type ForbiddenTypes =\n          Api.VirtualClass<any>\n          | (Api.VirtualClass<any> | undefined)[];\n        type ForbiddenResponses =\n          ForbiddenTypes\n          | (AnyLiteral & Record<string, ForbiddenTypes>);\n\n        // Unwrap all chained promises\n        const response = await promise;\n        // Make sure responses do not include `VirtualClass` instances\n        const allowedResponse: Exclude<typeof response, ForbiddenResponses> = response;\n        // Suppress \"unused variable\" constraint\n        void allowedResponse;\n      } catch (err) {\n        // Do noting\n      }\n    })();\n  }\n\n  return promise as EnsurePromise<MethodResponse<T>>;\n}\n\nexport function callApi<T extends keyof Methods>(fnName: T, ...args: MethodArgs<T>): EnsurePromise<MethodResponse<T>> {\n  if (!isInited && isMasterTab) {\n    if (NO_QUEUE_BEFORE_INIT.has(fnName)) {\n      return Promise.resolve(undefined) as EnsurePromise<MethodResponse<T>>;\n    }\n\n    const deferred = new Deferred();\n    apiRequestsQueue.push({ fnName, args, deferred });\n\n    return deferred.promise as EnsurePromise<MethodResponse<T>>;\n  }\n\n  const promise = isMasterTab ? makeRequest({\n    type: 'callMethod',\n    name: fnName,\n    args,\n  }) : makeRequestToMaster({\n    name: fnName,\n    args,\n  });\n\n  // Some TypeScript magic to make sure `VirtualClass` is never returned from any method\n  if (DEBUG) {\n    (async () => {\n      try {\n        type ForbiddenTypes =\n          Api.VirtualClass<any>\n          | (Api.VirtualClass<any> | undefined)[];\n        type ForbiddenResponses =\n          ForbiddenTypes\n          | (AnyLiteral & Record<string, ForbiddenTypes>);\n\n        // Unwrap all chained promises\n        const response = await promise;\n        // Make sure responses do not include `VirtualClass` instances\n        const allowedResponse: Exclude<typeof response, ForbiddenResponses> = response;\n        // Suppress \"unused variable\" constraint\n        void allowedResponse;\n      } catch (err) {\n        // Do noting\n      }\n    })();\n  }\n\n  return promise as EnsurePromise<MethodResponse<T>>;\n}\n\nexport function cancelApiProgress(progressCallback: ApiOnProgress) {\n  progressCallback.isCanceled = true;\n\n  const { messageId } = requestStatesByCallback.get(progressCallback) || {};\n  if (!messageId) {\n    return;\n  }\n\n  if (isMasterTab) {\n    cancelApiProgressMaster(messageId);\n  } else {\n    channel.postMessage({\n      type: 'cancelApiProgress',\n      token: getCurrentTabId(),\n      messageId,\n    });\n  }\n}\n\nexport function cancelApiProgressMaster(messageId: string) {\n  postMessageOnTickEnd({\n    type: 'cancelProgress',\n    messageId,\n  });\n}\n\nfunction subscribeToWorker(onUpdate: OnApiUpdate) {\n  worker?.addEventListener('message', ({ data }: WorkerMessageEvent) => {\n    data?.payloads.forEach((payload) => {\n      if (payload.type === 'updates') {\n        let DEBUG_startAt: number | undefined;\n        if (DEBUG) {\n          DEBUG_startAt = performance.now();\n        }\n\n        payload.updates.forEach(onUpdate);\n\n        if (DEBUG) {\n          const duration = performance.now() - DEBUG_startAt!;\n          if (duration > 5) {\n            // eslint-disable-next-line no-console\n            console.warn(`[API] Slow updates processing: ${payload.updates.length} updates in ${duration} ms`);\n          }\n        }\n      } else if (payload.type === 'methodResponse') {\n        handleMethodResponse(payload);\n      } else if (payload.type === 'methodCallback') {\n        handleMethodCallback(payload);\n      } else if (payload.type === 'unhandledError') {\n        const message = payload.error?.message;\n        if (message && IGNORE_UNHANDLED_ERRORS.has(message)) return;\n        throw new Error(message);\n      } else if (payload.type === 'sendBeacon') {\n        navigator.sendBeacon(payload.url, payload.data);\n      } else if (payload.type === 'debugLog') {\n        logDebugMessage(payload.level, ...payload.args);\n      }\n    });\n  });\n}\n\nexport function handleMethodResponse(data: {\n  messageId: string;\n  response?: ThenArg<MethodResponse<keyof Methods>>;\n  error?: { message: string };\n}) {\n  const requestState = requestStates.get(data.messageId);\n  if (requestState) {\n    if (data.error) {\n      requestState.reject(data.error);\n    } else {\n      requestState.resolve(data.response);\n    }\n  }\n}\n\nexport function handleMethodCallback(data: {\n  messageId: string;\n  callbackArgs: any[];\n}) {\n  requestStates.get(data.messageId)?.callback?.(...data.callbackArgs);\n}\n\nfunction makeRequestToMaster(message: {\n  messageId?: string;\n  name: keyof Methods;\n  args: MethodArgs<keyof Methods>;\n  withCallback?: boolean;\n}) {\n  const messageId = generateUniqueId();\n  const payload = {\n    messageId,\n    ...message,\n  };\n\n  const requestState = { messageId } as RequestState;\n\n  // Re-wrap type because of `postMessage`\n  const promise = new Promise<MethodResponse<keyof Methods>>((resolve, reject) => {\n    Object.assign(requestState, { resolve, reject });\n  });\n\n  if ('args' in payload && 'name' in payload && typeof payload.args[1] === 'function') {\n    payload.withCallback = true;\n\n    const callback = payload.args.pop() as AnyToVoidFunction;\n    requestState.callback = callback;\n    requestStatesByCallback.set(callback, requestState);\n  }\n\n  requestStates.set(messageId, requestState);\n\n  promise\n    .catch(() => undefined)\n    .finally(() => {\n      requestStates.delete(messageId);\n\n      if (requestState.callback) {\n        requestStatesByCallback.delete(requestState.callback);\n      }\n    });\n\n  callApiOnMasterTab(payload);\n\n  return promise;\n}\n\nfunction makeRequest(message: OriginPayload) {\n  const messageId = generateUniqueId();\n  const payload: OriginPayload = {\n    messageId,\n    ...message,\n  };\n\n  const requestState = { messageId } as RequestState;\n\n  // Re-wrap type because of `postMessage`\n  const promise = new Promise<MethodResponse<keyof Methods>>((resolve, reject) => {\n    Object.assign(requestState, { resolve, reject });\n  });\n\n  if ('args' in payload && 'name' in payload && typeof payload.args[1] === 'function') {\n    payload.withCallback = true;\n\n    const callback = payload.args.pop() as AnyToVoidFunction;\n    requestState.callback = callback;\n    requestStatesByCallback.set(callback, requestState);\n  }\n\n  requestState.DEBUG_payload = payload;\n\n  requestStates.set(messageId, requestState);\n\n  promise\n    .catch(() => undefined)\n    .finally(() => {\n      requestStates.delete(messageId);\n\n      if (requestState.callback) {\n        requestStatesByCallback.delete(requestState.callback);\n      }\n    });\n\n  postMessageOnTickEnd(payload);\n\n  return promise;\n}\n\nconst startedAt = Date.now();\n\n// Workaround for iOS sometimes stops interacting with worker\nfunction setupHealthCheck() {\n  window.addEventListener('focus', () => {\n    void ensureWorkerPing();\n    // Sometimes a single check is not enough\n    setTimeout(() => ensureWorkerPing(), 1000);\n  });\n}\n\nasync function ensureWorkerPing() {\n  let isResolved = false;\n\n  try {\n    await Promise.race([\n      makeRequest({ type: 'ping' }),\n      pause(HEALTH_CHECK_TIMEOUT)\n        .then(() => (isResolved ? undefined : Promise.reject(new Error('HEALTH_CHECK_TIMEOUT')))),\n    ]);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n\n    if (Date.now() - startedAt >= HEALTH_CHECK_MIN_DELAY) {\n      worker?.terminate();\n      worker = undefined;\n      updateCallback({ '@type': 'requestReconnectApi' });\n    }\n  } finally {\n    isResolved = true;\n  }\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport {\n  MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN,\n  MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT,\n  MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH,\n  MOBILE_SCREEN_MAX_WIDTH,\n} from '../config';\nimport { IS_IOS } from '../util/browser/windowEnvironment';\nimport { createCallbackManager } from '../util/callbacks';\nimport { updateSizes } from '../util/windowSize';\nimport useForceUpdate from './useForceUpdate';\n\ntype MediaQueryCacheKey = 'mobile' | 'tablet' | 'landscape' | 'touch';\n\nconst mediaQueryCache = new Map<MediaQueryCacheKey, MediaQueryList>();\nconst callbacks = createCallbackManager();\n\nlet isMobile: boolean;\nlet isTablet: boolean;\nlet isLandscape: boolean;\nlet isTouchScreen: boolean;\n\nexport function getIsMobile() {\n  return isMobile;\n}\n\nexport function getIsTablet() {\n  return isTablet;\n}\n\nexport function getIsWebAppsFullscreenSupported() {\n  return !getIsMobile();\n}\n\nfunction handleMediaQueryChange() {\n  isMobile = mediaQueryCache.get('mobile')?.matches || false;\n  isTablet = !isMobile && (mediaQueryCache.get('tablet')?.matches || false);\n  isLandscape = mediaQueryCache.get('landscape')?.matches || false;\n  isTouchScreen = mediaQueryCache.get('touch')?.matches || false;\n  updateSizes();\n  callbacks.runCallbacks();\n}\n\nfunction initMediaQueryCache() {\n  const mobileQuery = window.matchMedia(`(max-width: ${MOBILE_SCREEN_MAX_WIDTH}px), \\\n  (max-width: ${MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH}px and max-height: ${MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT}px)`);\n  mediaQueryCache.set('mobile', mobileQuery);\n  mobileQuery.addEventListener('change', handleMediaQueryChange);\n\n  const tabletQuery = window.matchMedia(`(max-width: ${MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN}px)`);\n  mediaQueryCache.set('tablet', tabletQuery);\n  tabletQuery.addEventListener('change', handleMediaQueryChange);\n\n  const landscapeQuery = window.matchMedia(\n    IS_IOS\n      ? '(orientation: landscape)'\n      // Source: https://web.archive.org/web/20160509220835/http://blog.abouthalf.com/development/orientation-media-query-challenges-in-android-browsers/\n      // Feature is marked as deprecated now, but it is still supported\n      // https://developer.mozilla.org/en-US/docs/Web/CSS/@media/device-aspect-ratio#browser_compatibility\n      : 'screen and (min-device-aspect-ratio: 1/1) and (orientation: landscape)',\n  );\n  mediaQueryCache.set('landscape', landscapeQuery);\n  landscapeQuery.addEventListener('change', handleMediaQueryChange);\n\n  const isTouchScreenQuery = window.matchMedia('(pointer: coarse)');\n  mediaQueryCache.set('touch', isTouchScreenQuery);\n  isTouchScreenQuery.addEventListener('change', handleMediaQueryChange);\n}\n\ninitMediaQueryCache();\nhandleMediaQueryChange();\n\nexport default function useAppLayout() {\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => callbacks.addCallback(forceUpdate), [forceUpdate]);\n\n  return {\n    isMobile,\n    isTablet,\n    isLandscape,\n    isDesktop: !isMobile && !isTablet,\n    isTouchScreen,\n  };\n}\n","import { getActions, getGlobal } from '../../global';\n\nimport { selectCustomEmoji } from '../../global/selectors';\nimport { throttle } from '../schedulers';\nimport { addCustomEmojiInputRenderCallback } from './customEmojiManager';\n\nlet LOAD_QUEUE = new Set<string>();\nconst RENDER_HISTORY = new Set<string>();\nconst THROTTLE = 200;\nconst LIMIT_PER_REQUEST = 100;\n\nconst loadFromQueue = throttle(() => {\n  const queue = [...LOAD_QUEUE];\n\n  const queueToLoad = queue.slice(0, LIMIT_PER_REQUEST);\n  const otherQueue = queue.slice(LIMIT_PER_REQUEST);\n\n  getActions().loadCustomEmojis({\n    ids: queueToLoad,\n  });\n\n  LOAD_QUEUE = new Set(otherQueue);\n\n  // Schedule next load\n  if (LOAD_QUEUE.size) {\n    loadFromQueue();\n  }\n}, THROTTLE, false);\n\nconst updateLastRendered = throttle(() => {\n  getActions().updateLastRenderedCustomEmojis({\n    ids: [...RENDER_HISTORY].reverse(),\n  });\n\n  RENDER_HISTORY.clear();\n}, THROTTLE, false);\n\nfunction notifyCustomEmojiRender(emojiId: string) {\n  RENDER_HISTORY.add(emojiId);\n  updateLastRendered();\n}\n\naddCustomEmojiInputRenderCallback(notifyCustomEmojiRender);\n\nexport default function ensureCustomEmoji(id?: string) {\n  if (!id) return;\n  notifyCustomEmojiRender(id);\n\n  if (selectCustomEmoji(getGlobal(), id)) {\n    return;\n  }\n\n  LOAD_QUEUE.add(id);\n  loadFromQueue();\n}\n","import { useEffect, useState } from '../../../lib/teact/teact';\nimport { getGlobal } from '../../../global';\n\nimport type { ApiSticker } from '../../../api/types';\nimport type { GlobalState } from '../../../global/types';\n\nimport { selectCanPlayAnimatedEmojis, selectCustomEmoji } from '../../../global/selectors';\nimport { addCustomEmojiCallback, removeCustomEmojiCallback } from '../../../util/emoji/customEmojiManager';\nimport ensureCustomEmoji from '../../../util/emoji/ensureCustomEmoji';\n\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nexport default function useCustomEmoji(documentId?: string) {\n  const [customEmoji, setCustomEmoji] = useState<ApiSticker | undefined>(() => (\n    documentId ? selectCustomEmoji(getGlobal(), documentId) : undefined\n  ));\n  const [canPlay, setCanPlay] = useState(() => selectCanPlayAnimatedEmojis(getGlobal()));\n\n  const handleGlobalChange = useLastCallback((customEmojis?: GlobalState['customEmojis']) => {\n    if (!documentId) return;\n\n    const newGlobal = getGlobal();\n    setCustomEmoji((customEmojis ?? newGlobal.customEmojis).byId[documentId]);\n    setCanPlay(selectCanPlayAnimatedEmojis(newGlobal));\n  });\n\n  useEffect(() => {\n    ensureCustomEmoji(documentId);\n  }, [documentId]);\n\n  useEffect(() => handleGlobalChange(), [documentId]);\n\n  useEffect(() => {\n    if (!documentId) return undefined;\n\n    addCustomEmojiCallback(handleGlobalChange, documentId);\n\n    return () => {\n      removeCustomEmojiCallback(handleGlobalChange);\n    };\n  }, [documentId]);\n\n  return { customEmoji, canPlay };\n}\n","import type { ApiPeer, ApiSavedGifts, ApiStarGiftCollection } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { isUserId } from '../../util/entities/ids';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { getHasAdminRight, isChatAdmin, isChatChannel, isDeletedUser } from '../helpers';\nimport { selectChat, selectChatFullInfo } from './chats';\nimport { type ProfileCollectionKey } from './payments';\nimport { selectTabState } from './tabs';\nimport { selectBot, selectUser, selectUserFullInfo } from './users';\n\nexport function selectPeer<T extends GlobalState>(global: T, peerId: string): ApiPeer | undefined {\n  return selectUser(global, peerId) || selectChat(global, peerId);\n}\n\nexport function selectPeerPhotos<T extends GlobalState>(global: T, peerId: string) {\n  return global.peers.profilePhotosById[peerId];\n}\n\nexport function selectCanGift<T extends GlobalState>(global: T, peerId: string) {\n  const bot = selectBot(global, peerId);\n  const user = selectUser(global, peerId);\n\n  if (user) {\n    return !bot && peerId !== SERVICE_NOTIFICATIONS_USER_ID && !isDeletedUser(user);\n  }\n\n  return selectChatFullInfo(global, peerId)?.areStarGiftsAvailable;\n}\n\nexport function selectPeerCollectionSavedGifts<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  collectionId: ProfileCollectionKey,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ApiSavedGifts | undefined {\n  const tabState = selectTabState(global, tabId);\n  return tabState.savedGifts.collectionsByPeerId[peerId]?.[collectionId];\n}\n\nexport function selectPeerSavedGifts<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ApiSavedGifts | undefined {\n  return selectPeerCollectionSavedGifts(global, peerId, 'all', tabId);\n}\n\nexport function selectPeerStarGiftCollections<T extends GlobalState>(\n  global: T,\n  peerId: string,\n): ApiStarGiftCollection[] | undefined {\n  return global.starGiftCollections?.byPeerId[peerId];\n}\n\nexport function selectPeerPaidMessagesStars<T extends GlobalState>(\n  global: T,\n  peerId: string,\n) {\n  const isChatWithUser = isUserId(peerId);\n  if (isChatWithUser) {\n    const userFullInfo = isChatWithUser ? selectUserFullInfo(global, peerId) : undefined;\n    return userFullInfo?.paidMessagesStars;\n  }\n\n  const chat = selectChat(global, peerId);\n  if (!chat) return undefined;\n  if (isChatAdmin(chat)) return undefined;\n  return chat.paidMessagesStars;\n}\n\nexport function selectPeerHasProfileBackground<T extends GlobalState>(global: T, peerId: string) {\n  const peer = selectPeer(global, peerId);\n  const profileColor = peer?.profileColor;\n  if (profileColor?.type === 'collectible') return true;\n  if (profileColor?.type === 'regular') return profileColor.color !== undefined;\n  return peer?.emojiStatus?.type === 'collectible';\n}\n\nexport function selectCanUpdateMainTab<T extends GlobalState>(global: T, peerId: string) {\n  if (global.currentUserId === peerId) {\n    return true;\n  }\n\n  const chat = selectChat(global, peerId);\n  return Boolean(chat && isChatChannel(chat) && getHasAdminRight(chat, 'postMessages'));\n}\n","import type { ThreadId } from '../types';\n\nimport { RE_TG_LINK, RE_TME_LINK } from '../config';\nimport { IS_BAD_URL_PARSER } from './browser/globalEnvironment';\nimport { ensureProtocol } from './browser/url';\nimport { parseTimestampDuration } from './dates/timestamp';\nimport { toChannelId } from './entities/ids';\nimport { isUsernameValid } from './entities/username';\n\nexport type DeepLinkMethod = 'resolve' | 'login' | 'passport' | 'settings' | 'join' | 'addstickers' | 'addemoji' |\n  'setlanguage' | 'addtheme' | 'confirmphone' | 'socks' | 'proxy' | 'privatepost' | 'bg' | 'share' | 'msg' | 'msg_url' |\n  'invoice' | 'addlist' | 'boost' | 'giftcode' | 'message' | 'premium_offer' | 'premium_multigift' | 'stars_topup'\n  | 'nft' | 'stars' | 'ton' | 'stargift_auction';\n\ninterface PublicMessageLink {\n  type: 'publicMessageLink';\n  username: string;\n  messageId: number;\n  isSingle: boolean;\n  threadId?: ThreadId;\n  commentId?: number;\n  timestamp?: number;\n}\n\nexport interface PrivateMessageLink {\n  type: 'privateMessageLink';\n  channelId: string;\n  messageId: number;\n  isSingle: boolean;\n  threadId?: ThreadId;\n  commentId?: number;\n  timestamp?: number;\n}\n\ninterface ShareLink {\n  type: 'shareLink';\n  url: string;\n  text?: string;\n}\n\ninterface ChatFolderLink {\n  type: 'chatFolderLink';\n  slug: string;\n}\n\ninterface LoginCodeLink {\n  type: 'loginCodeLink';\n  code: string;\n}\n\ninterface TelegramPassportLink {\n  type: 'telegramPassportLink';\n  botId: number;\n  scope: string;\n  publicKey: string;\n  nonce: string;\n  callbackUrl?: string;\n  payload?: string;\n}\n\ninterface PublicUsernameOrBotLink {\n  type: 'publicUsernameOrBotLink';\n  username: string;\n  start?: string;\n  ref?: string;\n  startApp?: string;\n  mode?: string;\n  appName?: string;\n  startAttach?: string;\n  attach?: string;\n  text?: string;\n  choose?: string;\n  isDirect?: boolean;\n}\n\ninterface PrivateChannelLink {\n  type: 'privateChannelLink';\n  channelId: string;\n}\n\ninterface ChatBoostLink {\n  type: 'chatBoostLink';\n  username?: string;\n  id?: string;\n}\n\ninterface BusinessChatLink {\n  type: 'businessChatLink';\n  slug: string;\n}\n\ninterface PremiumReferrerLink {\n  type: 'premiumReferrerLink';\n  referrer: string;\n}\n\ninterface PremiumMultigiftLink {\n  type: 'premiumMultigiftLink';\n  referrer: string;\n}\n\ninterface GiftUniqueLink {\n  type: 'giftUniqueLink';\n  slug: string;\n}\n\ninterface GiftAuctionLink {\n  type: 'giftAuctionLink';\n  slug: string;\n}\n\ninterface StarsModalLink {\n  type: 'stars';\n}\n\ninterface TonModalLink {\n  type: 'ton';\n}\n\ninterface SettingsScreenLink {\n  type: 'settings';\n  screen?: 'devices' | 'folders' | 'language' | 'privacy' | 'editProfile' | 'theme';\n}\n\ntype DeepLink =\n  TelegramPassportLink |\n  LoginCodeLink |\n  PublicMessageLink |\n  PrivateMessageLink |\n  ShareLink |\n  ChatFolderLink |\n  PublicUsernameOrBotLink |\n  PrivateChannelLink |\n  BusinessChatLink |\n  PremiumReferrerLink |\n  PremiumMultigiftLink |\n  ChatBoostLink |\n  GiftUniqueLink |\n  GiftAuctionLink |\n  StarsModalLink |\n  TonModalLink |\n  SettingsScreenLink;\n\ntype BuilderParams<T extends DeepLink> = Record<keyof Omit<T, 'type'>, string | undefined>;\ntype BuilderReturnType<T extends DeepLink> = T | undefined;\ntype DeepLinkType = DeepLink['type'] | 'unknown';\n\ntype PrivateMessageLinkBuilderParams = Omit<BuilderParams<PrivateMessageLink>, 'isSingle'> & {\n  single?: string;\n};\n\ntype PublicMessageLinkBuilderParams = Omit<BuilderParams<PublicMessageLink>, 'isSingle'> & {\n  single?: string;\n};\n\ntype PublicUsernameOrBotLinkBuilderParams = Omit<BuilderParams<PublicUsernameOrBotLink>, 'isDirect'> & {\n  direct?: string;\n};\n\nconst ELIGIBLE_HOSTNAMES = new Set(['t.me', 'telegram.me', 'telegram.dog']);\n\nexport function isDeepLink(link: string): boolean {\n  return Boolean(link.match(RE_TME_LINK) || link.match(RE_TG_LINK));\n}\n\nexport function tryParseDeepLink(link: string): DeepLink | undefined {\n  if (!isDeepLink(link)) {\n    return undefined;\n  }\n  try {\n    return parseDeepLink(link);\n  } catch (err) {\n    return undefined;\n  }\n}\n\nexport function getUsernameFromDeepLink(url: string) {\n  const deepLink = tryParseDeepLink(url);\n  if (deepLink?.type === 'publicUsernameOrBotLink') {\n    return deepLink.username;\n  }\n  return undefined;\n}\n\nfunction parseDeepLink(url: string) {\n  const correctUrl = ensureProtocol(url);\n  if (!correctUrl) {\n    return undefined;\n  }\n  if (correctUrl.startsWith('https:') || correctUrl.startsWith('http:')) {\n    const urlParsed = new URL(correctUrl);\n    return parseHttpLink(urlParsed);\n  }\n  if (correctUrl.startsWith('tg:')) {\n    const urlToParse = IS_BAD_URL_PARSER ? correctUrl.replace(/^tg:\\/\\//, 'https://') : correctUrl;\n    const urlParsed = new URL(urlToParse);\n    return parseTgLink(urlParsed);\n  }\n  return undefined;\n}\n\nfunction parseTgLink(url: URL) {\n  const { hostname } = url;\n  const queryParams = getQueryParams(url);\n  const pathParams = getPathParams(url);\n  const method = hostname as DeepLinkMethod;\n\n  const deepLinkType = getTgDeepLinkType(queryParams, pathParams, method);\n  switch (deepLinkType) {\n    case 'publicMessageLink': {\n      const {\n        domain, post, single, thread, comment, t,\n      } = queryParams;\n      return buildPublicMessageLink({\n        username: domain,\n        messageId: post,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'privateMessageLink': {\n      const {\n        channel, post, single, thread, comment, t,\n      } = queryParams;\n      return buildPrivateMessageLink({\n        channelId: channel,\n        messageId: post,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'shareLink':\n      return buildShareLink({ text: queryParams.text, url: queryParams.url });\n    case 'chatFolderLink':\n      return buildChatFolderLink({ slug: queryParams.slug });\n    case 'loginCodeLink':\n      return buildLoginCodeLink({ code: queryParams.code });\n    case 'telegramPassportLink':\n      return buildTelegramPassportLink({\n        botId: queryParams.bot_id,\n        scope: queryParams.scope,\n        publicKey: queryParams.public_key,\n        nonce: queryParams.nonce,\n        callbackUrl: queryParams.callback_url,\n        payload: queryParams.payload,\n      });\n    case 'publicUsernameOrBotLink':\n      return buildPublicUsernameOrBotLink({\n        username: queryParams.domain,\n        start: queryParams.start,\n        text: queryParams.text,\n        appName: queryParams.appname,\n        startApp: queryParams.startapp,\n        mode: queryParams.mode,\n        startAttach: queryParams.startattach,\n        attach: queryParams.attach,\n        choose: queryParams.choose,\n        ref: queryParams.ref,\n        direct: queryParams.direct,\n      });\n    case 'privateChannelLink': {\n      return buildPrivateChannelLink({ channelId: queryParams.channel });\n    }\n    case 'businessChatLink':\n      return buildBusinessChatLink({ slug: queryParams.slug });\n    case 'premiumReferrerLink':\n      return buildPremiumReferrerLink({ referrer: queryParams.ref });\n    case 'premiumMultigiftLink':\n      return buildPremiumMultigiftLink({ referrer: queryParams.ref });\n    case 'chatBoostLink':\n      return buildChatBoostLink({ username: queryParams.domain, id: queryParams.channel });\n    case 'giftUniqueLink':\n      return buildGiftUniqueLink({ slug: queryParams.slug });\n    case 'giftAuctionLink':\n      return buildGiftAuctionLink({ slug: queryParams.slug });\n    case 'stars':\n      return { type: 'stars' } satisfies StarsModalLink;\n    case 'ton':\n      return { type: 'ton' } satisfies TonModalLink;\n    case 'settings':\n      return buildSettingsScreenLink({ screen: pathParams.length === 1 ? pathParams[0] : undefined });\n    default:\n      break;\n  }\n  return undefined;\n}\n\nfunction parseHttpLink(url: URL) {\n  if (!ELIGIBLE_HOSTNAMES.has(url.hostname)) {\n    return undefined;\n  }\n  const queryParams = getQueryParams(url);\n  const pathParams = getPathParams(url);\n\n  const deepLinkType = getHttpDeepLinkType(queryParams, pathParams);\n  switch (deepLinkType) {\n    case 'publicMessageLink': {\n      const {\n        single, comment, t,\n      } = queryParams;\n      const {\n        username,\n        thread,\n        messageId,\n      } = pathParams.length === 2 ? {\n        username: pathParams[0],\n        thread: queryParams.thread,\n        messageId: pathParams[1],\n      } : {\n        username: pathParams[0],\n        thread: pathParams[1],\n        messageId: pathParams[2],\n      };\n      return buildPublicMessageLink({\n        username,\n        messageId,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'privateMessageLink': {\n      const {\n        single, comment, t,\n      } = queryParams;\n      const {\n        channelId,\n        thread,\n        messageId,\n      } = pathParams.length === 3 ? {\n        channelId: pathParams[1],\n        thread: queryParams.thread,\n        messageId: pathParams[2],\n      } : {\n        channelId: pathParams[1],\n        thread: pathParams[2],\n        messageId: pathParams[3],\n      };\n      return buildPrivateMessageLink({\n        channelId,\n        messageId,\n        single,\n        threadId: thread,\n        commentId: comment,\n        timestamp: t,\n      });\n    }\n    case 'shareLink': {\n      return buildShareLink({ text: queryParams.text, url: queryParams.url });\n    }\n    case 'chatFolderLink':\n      return buildChatFolderLink({ slug: pathParams[1] });\n    case 'loginCodeLink':\n      return buildLoginCodeLink({ code: pathParams[1] });\n    case 'publicUsernameOrBotLink':\n      return buildPublicUsernameOrBotLink({\n        username: pathParams[0],\n        start: queryParams.start,\n        text: queryParams.text,\n        startApp: queryParams.startapp,\n        mode: queryParams.mode,\n        appName: undefined,\n        startAttach: queryParams.startattach,\n        attach: queryParams.attach,\n        choose: queryParams.choose,\n        ref: queryParams.ref,\n        direct: queryParams.direct,\n      });\n    case 'privateChannelLink': {\n      return buildPrivateChannelLink({ channelId: pathParams[1] });\n    }\n    case 'businessChatLink':\n      return buildBusinessChatLink({ slug: pathParams[1] });\n    case 'chatBoostLink': {\n      if (pathParams[0] === 'boost') {\n        return buildChatBoostLink({ username: pathParams[1], id: queryParams.c });\n      }\n      const isPrivateChannel = pathParams[0] === 'c';\n      return buildChatBoostLink({\n        username: !isPrivateChannel ? pathParams[0] : undefined,\n        id: isPrivateChannel ? pathParams[1] : undefined,\n      });\n    }\n    case 'giftUniqueLink': {\n      const slug = pathParams.slice(1).join('/');\n      return buildGiftUniqueLink({\n        slug,\n      });\n    }\n    case 'giftAuctionLink': {\n      return buildGiftAuctionLink({\n        slug: pathParams[1],\n      });\n    }\n    default:\n      break;\n  }\n  return undefined;\n}\n\nfunction getHttpDeepLinkType(\n  queryParams: Record<string, string>,\n  pathParams: string[],\n): DeepLinkType {\n  const len = pathParams.length;\n  const method = pathParams[0];\n  if (len === 1) {\n    if (method === 'share') return 'shareLink';\n    if (method === 'boost' || queryParams.boost !== undefined) return 'chatBoostLink';\n\n    if (isUsernameValid(method)) {\n      return 'publicUsernameOrBotLink';\n    }\n  } else if (len === 2) {\n    if (method === 'addlist') return 'chatFolderLink';\n    if (method === 'login') return 'loginCodeLink';\n    if (method === 'm') return 'businessChatLink';\n    if (method === 'boost') return 'chatBoostLink';\n    if (method === 'nft') return 'giftUniqueLink';\n    if (method === 'auction') return 'giftAuctionLink';\n    if (method === 'c') {\n      if (queryParams.boost !== undefined) return 'chatBoostLink';\n      return 'privateChannelLink';\n    }\n\n    if (isUsernameValid(pathParams[0]) && isNumber(pathParams[1])) {\n      return 'publicMessageLink';\n    }\n  } else if (len === 3) {\n    if (method === 'c' && pathParams.slice(1).every(isNumber)) {\n      return 'privateMessageLink';\n    }\n    if (isUsernameValid(pathParams[0]) && pathParams.slice(1).every(isNumber)) {\n      return 'publicMessageLink';\n    }\n    if (method === 'nft') return 'giftUniqueLink';\n  } else if (len === 4) {\n    if (method === 'c' && pathParams.slice(1).every(isNumber)) {\n      return 'privateMessageLink';\n    }\n  }\n  return 'unknown';\n}\n\nfunction getTgDeepLinkType(\n  queryParams: Record<string, string>,\n  pathParams: string[],\n  method: DeepLinkMethod,\n): DeepLinkType {\n  switch (method) {\n    case 'resolve': {\n      const {\n\n        domain, post, bot_id, scope, public_key, nonce,\n      } = queryParams;\n      if (domain === 'telegrampassport' && bot_id && scope && public_key && nonce) {\n        return 'telegramPassportLink';\n      }\n      if (domain && post) {\n        return 'publicMessageLink';\n      }\n      if (isUsernameValid(domain)) {\n        return 'publicUsernameOrBotLink';\n      }\n      break;\n    }\n    case 'privatepost': {\n      const { channel, post } = queryParams;\n      if (channel) {\n        if (post) return 'privateMessageLink';\n        return 'privateChannelLink';\n      }\n      break;\n    }\n    case 'msg_url':\n      return 'shareLink';\n    case 'addlist':\n      return 'chatFolderLink';\n    case 'login':\n      return 'loginCodeLink';\n    case 'passport':\n      return 'telegramPassportLink';\n    case 'message':\n      return 'businessChatLink';\n    case 'premium_offer':\n      return 'premiumReferrerLink';\n    case 'premium_multigift':\n      return 'premiumMultigiftLink';\n    case 'boost':\n      return 'chatBoostLink';\n    case 'nft':\n      return 'giftUniqueLink';\n    case 'stargift_auction':\n      return 'giftAuctionLink';\n    case 'stars':\n      return 'stars';\n    case 'ton':\n      return 'ton';\n    case 'settings': {\n      return 'settings';\n    }\n    default:\n      break;\n  }\n  return 'unknown';\n}\n\nfunction buildShareLink(params: BuilderParams<ShareLink>): BuilderReturnType<ShareLink> {\n  const { url, text } = params;\n  if (!url) {\n    return undefined;\n  }\n  return {\n    type: 'shareLink',\n    url,\n    text,\n  };\n}\n\nfunction buildPublicMessageLink(params: PublicMessageLinkBuilderParams): BuilderReturnType<PublicMessageLink> {\n  const {\n    messageId, threadId, commentId, username, single, timestamp,\n  } = params;\n  if (!username || !isUsernameValid(username)) {\n    return undefined;\n  }\n  if (!messageId || !isNumber(messageId)) {\n    return undefined;\n  }\n  if (threadId && !isNumber(threadId)) {\n    return undefined;\n  }\n  if (commentId && !isNumber(commentId)) {\n    return undefined;\n  }\n  return {\n    type: 'publicMessageLink',\n    username,\n    messageId: Number(messageId),\n    isSingle: single === '',\n    threadId: threadId ? Number(threadId) : undefined,\n    commentId: commentId ? Number(commentId) : undefined,\n    timestamp: timestamp ? parseTimestampDuration(timestamp) : undefined,\n  };\n}\n\nfunction buildPrivateMessageLink(params: PrivateMessageLinkBuilderParams): BuilderReturnType<PrivateMessageLink> {\n  const {\n    messageId, threadId, commentId, channelId, single, timestamp,\n  } = params;\n  if (!channelId || !isNumber(channelId)) {\n    return undefined;\n  }\n  if (!messageId || !isNumber(messageId)) {\n    return undefined;\n  }\n  if (threadId && !isNumber(threadId)) {\n    return undefined;\n  }\n  if (commentId && !isNumber(commentId)) {\n    return undefined;\n  }\n  return {\n    type: 'privateMessageLink',\n    channelId: toChannelId(channelId),\n    messageId: Number(messageId),\n    isSingle: single === '',\n    threadId: threadId ? Number(threadId) : undefined,\n    commentId: commentId ? Number(commentId) : undefined,\n    timestamp: timestamp ? parseTimestampDuration(timestamp) : undefined,\n  };\n}\n\nfunction buildChatFolderLink(params: BuilderParams<ChatFolderLink>): BuilderReturnType<ChatFolderLink> {\n  const {\n    slug,\n  } = params;\n  if (!slug) {\n    return undefined;\n  }\n  return {\n    type: 'chatFolderLink',\n    slug,\n  };\n}\n\nfunction buildLoginCodeLink(params: BuilderParams<LoginCodeLink>): BuilderReturnType<LoginCodeLink> {\n  const {\n    code,\n  } = params;\n  if (!code) {\n    return undefined;\n  }\n  return {\n    type: 'loginCodeLink',\n    code,\n  };\n}\n\nfunction buildTelegramPassportLink(\n  params: BuilderParams<TelegramPassportLink>,\n): BuilderReturnType<TelegramPassportLink> {\n  const {\n    botId,\n    scope,\n    publicKey,\n    nonce,\n    callbackUrl,\n    payload,\n  } = params;\n  if (!botId || !isNumber(botId) || !scope || !publicKey || !nonce) {\n    return undefined;\n  }\n  return {\n    type: 'telegramPassportLink',\n    botId: Number(botId),\n    scope,\n    publicKey,\n    nonce,\n    callbackUrl,\n    payload,\n  };\n}\n\nfunction buildPublicUsernameOrBotLink(\n  params: PublicUsernameOrBotLinkBuilderParams,\n): BuilderReturnType<PublicUsernameOrBotLink> {\n  const {\n    username,\n    start,\n    text,\n    startApp,\n    mode,\n    startAttach,\n    attach,\n    appName,\n    choose,\n    ref,\n    direct,\n  } = params;\n  if (!username) {\n    return undefined;\n  }\n  if (!isUsernameValid(username)) {\n    return undefined;\n  }\n  return {\n    type: 'publicUsernameOrBotLink',\n    username,\n    start,\n    startApp,\n    mode,\n    appName,\n    startAttach,\n    attach,\n    text,\n    choose,\n    ref,\n    isDirect: direct === '',\n  };\n}\n\nfunction buildPrivateChannelLink(params: BuilderParams<PrivateChannelLink>): BuilderReturnType<PrivateChannelLink> {\n  const {\n    channelId,\n  } = params;\n  if (!channelId) {\n    return undefined;\n  }\n\n  return {\n    type: 'privateChannelLink',\n    channelId: toChannelId(channelId),\n  };\n}\n\nfunction buildChatBoostLink(params: BuilderParams<ChatBoostLink>): BuilderReturnType<ChatBoostLink> {\n  const {\n    username,\n    id,\n  } = params;\n\n  if (!username && !id) {\n    return undefined;\n  }\n\n  return {\n    type: 'chatBoostLink',\n    username,\n    id: id ? toChannelId(id) : undefined,\n  };\n}\n\nfunction buildBusinessChatLink(params: BuilderParams<BusinessChatLink>): BuilderReturnType<BusinessChatLink> {\n  const {\n    slug,\n  } = params;\n\n  if (!slug) {\n    return undefined;\n  }\n\n  return {\n    type: 'businessChatLink',\n    slug,\n  };\n}\n\nfunction buildGiftUniqueLink(params: BuilderParams<GiftUniqueLink>): BuilderReturnType<GiftUniqueLink> {\n  const {\n    slug,\n  } = params;\n\n  if (!slug) {\n    return undefined;\n  }\n\n  return {\n    type: 'giftUniqueLink',\n    slug,\n  };\n}\n\nfunction buildGiftAuctionLink(params: BuilderParams<GiftAuctionLink>): BuilderReturnType<GiftAuctionLink> {\n  const {\n    slug,\n  } = params;\n\n  if (!slug) {\n    return undefined;\n  }\n\n  return {\n    type: 'giftAuctionLink',\n    slug,\n  };\n}\n\nfunction buildSettingsScreen(screenParam: string) {\n  switch (screenParam) {\n    case 'devices':\n      return 'devices';\n    case 'folders':\n      return 'folders';\n    case 'language':\n      return 'language';\n    case 'privacy':\n      return 'privacy';\n    case 'edit_profile':\n      return 'editProfile';\n    case 'theme':\n      return 'theme';\n    default:\n      break;\n  }\n  return undefined;\n}\n\nfunction buildSettingsScreenLink(params: BuilderParams<SettingsScreenLink>): BuilderReturnType<SettingsScreenLink> {\n  const {\n    screen,\n  } = params;\n\n  return {\n    type: 'settings',\n    screen: screen ? buildSettingsScreen(screen) : undefined,\n  };\n}\n\nfunction buildPremiumReferrerLink(params: BuilderParams<PremiumReferrerLink>): BuilderReturnType<PremiumReferrerLink> {\n  const {\n    referrer,\n  } = params;\n\n  if (!referrer) {\n    return undefined;\n  }\n\n  return {\n    type: 'premiumReferrerLink',\n    referrer,\n  };\n}\n\nfunction buildPremiumMultigiftLink(\n  params: BuilderParams<PremiumMultigiftLink>,\n): BuilderReturnType<PremiumMultigiftLink> {\n  const {\n    referrer,\n  } = params;\n\n  if (!referrer) {\n    return undefined;\n  }\n\n  return {\n    type: 'premiumMultigiftLink',\n    referrer,\n  };\n}\n\nfunction isNumber(s: string) {\n  return /^-?\\d+$/.test(s);\n}\n\nfunction getPathParams(url: URL) {\n  const parts = url.pathname.split('/').filter(Boolean);\n  if (parts[0] === 's') {\n    parts.shift();\n  }\n  return parts.map(decodeURI);\n}\n\nfunction getQueryParams(url: URL) {\n  return Object.fromEntries(url.searchParams);\n}\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\n\r\nfunction __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nfunction __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\nexport { __classPrivateFieldGet, __classPrivateFieldSet };\n","export function createCallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>() {\n  const callbacks = new Set<T>();\n\n  function addCallback(cb: T) {\n    callbacks.add(cb);\n\n    return () => {\n      removeCallback(cb);\n    };\n  }\n\n  function removeCallback(cb: T) {\n    callbacks.delete(cb);\n  }\n\n  function runCallbacks(...args: Parameters<T>) {\n    callbacks.forEach((callback) => {\n      callback(...args);\n    });\n  }\n\n  function hasCallbacks() {\n    return Boolean(callbacks.size);\n  }\n\n  return {\n    runCallbacks,\n    addCallback,\n    removeCallback,\n    hasCallbacks,\n  };\n}\n\nexport type CallbackManager<T extends AnyToVoidFunction = AnyToVoidFunction>\n  = ReturnType<typeof createCallbackManager<T>>;\n","import type { ElementRef } from '../lib/teact/teact';\nimport { getIsHeavyAnimating, useEffect } from '../lib/teact/teact';\n\nimport type { CallbackManager } from '../util/callbacks';\n\nimport { requestMeasure } from '../lib/fasterdom/fasterdom';\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nconst elementObserverMap = new Map<HTMLElement, [IntersectionObserver, CallbackManager]>();\n\nexport default function useSharedIntersectionObserver(\n  refOrElement: ElementRef<HTMLElement> | HTMLElement | undefined,\n  onIntersectionChange: (entry: IntersectionObserverEntry) => void,\n  isDisabled = false,\n) {\n  const onIntersectionChangeLast = useLastCallback(onIntersectionChange);\n\n  useEffect(() => {\n    const el = refOrElement && 'current' in refOrElement ? refOrElement.current : refOrElement;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    const entriesAccumulator = new Map<Element, IntersectionObserverEntry>();\n\n    function flush() {\n      for (const entry of entriesAccumulator.values()) {\n        // Ignore updates when element is not properly mounted (`display: none`)\n        if (!(entry.target as HTMLElement).offsetParent) {\n          continue;\n        }\n\n        onIntersectionChangeLast(entry);\n      }\n\n      entriesAccumulator.clear();\n    }\n\n    const callback: IntersectionObserverCallback = ([entry]) => {\n      entriesAccumulator.set(entry.target, entry);\n\n      if (!getIsHeavyAnimating()) {\n        flush();\n      } else {\n        getIsHeavyAnimating.once(() => {\n          requestMeasure(flush);\n        });\n      }\n    };\n\n    let [observer, callbackManager] = elementObserverMap.get(el) || [undefined, undefined];\n    if (!observer) {\n      callbackManager = createCallbackManager();\n      observer = new IntersectionObserver(callbackManager.runCallbacks);\n      elementObserverMap.set(el, [observer, callbackManager]);\n      observer.observe(el);\n    }\n    callbackManager!.addCallback(callback);\n\n    return () => {\n      callbackManager!.removeCallback(callback);\n      if (!callbackManager!.hasCallbacks()) {\n        observer.unobserve(el);\n        observer.disconnect();\n        elementObserverMap.delete(el);\n      }\n    };\n  }, [isDisabled, refOrElement]);\n}\n","import { addActionHandler, getActions, getGlobal, setGlobal } from '../../index';\nimport { connectGoogleRest } from '../../../lib/alphahuman/rest';\n\naddActionHandler('connectToGoogle', async (global) => {\n  // Set connecting state\n  setGlobal({\n    ...global,\n    alphahuman: {\n      ...global.alphahuman,\n      googleOAuth: {\n        ...global.alphahuman?.googleOAuth,\n        isConnecting: true,\n        error: undefined,\n      },\n    },\n  });\n\n  try {\n    // Call the backend API to get OAuth URL\n    const response = await connectGoogleRest();\n\n    const updatedGlobal = getGlobal();\n\n    // Store OAuth data and redirect\n    setGlobal({\n      ...updatedGlobal,\n      alphahuman: {\n        ...updatedGlobal.alphahuman,\n        googleOAuth: {\n          isConnecting: false,\n          isConnected: false,\n          oauthUrl: response.oauthUrl,\n          oauthState: response.state,\n          error: undefined,\n        },\n      },\n    });\n\n    // Redirect user to Google OAuth page\n    window.location.href = response.oauthUrl;\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : 'Failed to connect to Google';\n\n    const updatedGlobal = getGlobal();\n\n    // Reset connecting state and set error\n    setGlobal({\n      ...updatedGlobal,\n      alphahuman: {\n        ...updatedGlobal.alphahuman,\n        googleOAuth: {\n          ...updatedGlobal.alphahuman?.googleOAuth,\n          isConnecting: false,\n          error: errorMessage,\n        },\n      },\n    });\n\n    // Show error notification\n    getActions().showNotification({ message: `Failed to connect to Google: ${errorMessage}` });\n  }\n});\n\naddActionHandler('resetGoogleOAuthError', (global) => {\n  setGlobal({\n    ...global,\n    alphahuman: {\n      ...global.alphahuman,\n      googleOAuth: {\n        ...global.alphahuman?.googleOAuth,\n        error: undefined,\n      },\n    },\n  });\n});\n\naddActionHandler('completeGoogleOAuthSuccess', (global) => {\n  // Update global state to connected\n  setGlobal({\n    ...getGlobal(),\n    alphahuman: {\n      ...getGlobal().alphahuman,\n      googleOAuth: {\n        isConnecting: false,\n        isConnected: true,\n        oauthUrl: undefined,\n        oauthState: undefined,\n        error: undefined,\n      },\n    },\n  });\n\n  // Show success notification\n  getActions().showNotification({\n    message: 'Successfully connected to Google',\n  });\n});\n\naddActionHandler('completeGoogleOAuthError', (global, actions, payload) => {\n  const { error } = payload;\n\n  const updatedGlobal = getGlobal();\n\n  // Update global state with error\n  setGlobal({\n    ...updatedGlobal,\n    alphahuman: {\n      ...updatedGlobal.alphahuman,\n      googleOAuth: {\n        ...updatedGlobal.alphahuman?.googleOAuth,\n        isConnecting: false,\n        isConnected: false,\n        error,\n      },\n    },\n  });\n\n  // Show error notification\n  getActions().showNotification({\n    message: `Failed to connect to Google: ${error}`,\n  });\n});","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nconst base64 = require('base64-js')\nconst ieee754 = require('ieee754')\nconst customInspectSymbol =\n  (typeof Symbol === 'function' && typeof Symbol['for'] === 'function') // eslint-disable-line dot-notation\n    ? Symbol['for']('nodejs.util.inspect.custom') // eslint-disable-line dot-notation\n    : null\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\nconst K_MAX_LENGTH = 0x7fffffff\nexports.kMaxLength = K_MAX_LENGTH\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Print warning and recommend using `buffer` v4.x which has an Object\n *               implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * We report that the browser does not support typed arrays if the are not subclassable\n * using __proto__. Firefox 4-29 lacks support for adding new properties to `Uint8Array`\n * (See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438). IE 10 lacks support\n * for __proto__ and has a buggy typed array implementation.\n */\nBuffer.TYPED_ARRAY_SUPPORT = typedArraySupport()\n\nif (!Buffer.TYPED_ARRAY_SUPPORT && typeof console !== 'undefined' &&\n    typeof console.error === 'function') {\n  console.error(\n    'This browser lacks typed array (Uint8Array) support which is required by ' +\n    '`buffer` v5.x. Use `buffer` v4.x if you require old browser support.'\n  )\n}\n\nfunction typedArraySupport () {\n  // Can typed array instances can be augmented?\n  try {\n    const arr = new Uint8Array(1)\n    const proto = { foo: function () { return 42 } }\n    Object.setPrototypeOf(proto, Uint8Array.prototype)\n    Object.setPrototypeOf(arr, proto)\n    return arr.foo() === 42\n  } catch (e) {\n    return false\n  }\n}\n\nObject.defineProperty(Buffer.prototype, 'parent', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.buffer\n  }\n})\n\nObject.defineProperty(Buffer.prototype, 'offset', {\n  enumerable: true,\n  get: function () {\n    if (!Buffer.isBuffer(this)) return undefined\n    return this.byteOffset\n  }\n})\n\nfunction createBuffer (length) {\n  if (length > K_MAX_LENGTH) {\n    throw new RangeError('The value \"' + length + '\" is invalid for option \"size\"')\n  }\n  // Return an augmented `Uint8Array` instance\n  const buf = new Uint8Array(length)\n  Object.setPrototypeOf(buf, Buffer.prototype)\n  return buf\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new TypeError(\n        'The \"string\" argument must be of type string. Received type number'\n      )\n    }\n    return allocUnsafe(arg)\n  }\n  return from(arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\nfunction from (value, encodingOrOffset, length) {\n  if (typeof value === 'string') {\n    return fromString(value, encodingOrOffset)\n  }\n\n  if (ArrayBuffer.isView(value)) {\n    return fromArrayView(value)\n  }\n\n  if (value == null) {\n    throw new TypeError(\n      'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n      'or Array-like Object. Received type ' + (typeof value)\n    )\n  }\n\n  if (isInstance(value, ArrayBuffer) ||\n      (value && isInstance(value.buffer, ArrayBuffer))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof SharedArrayBuffer !== 'undefined' &&\n      (isInstance(value, SharedArrayBuffer) ||\n      (value && isInstance(value.buffer, SharedArrayBuffer)))) {\n    return fromArrayBuffer(value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'number') {\n    throw new TypeError(\n      'The \"value\" argument must not be of type number. Received type number'\n    )\n  }\n\n  const valueOf = value.valueOf && value.valueOf()\n  if (valueOf != null && valueOf !== value) {\n    return Buffer.from(valueOf, encodingOrOffset, length)\n  }\n\n  const b = fromObject(value)\n  if (b) return b\n\n  if (typeof Symbol !== 'undefined' && Symbol.toPrimitive != null &&\n      typeof value[Symbol.toPrimitive] === 'function') {\n    return Buffer.from(value[Symbol.toPrimitive]('string'), encodingOrOffset, length)\n  }\n\n  throw new TypeError(\n    'The first argument must be one of type string, Buffer, ArrayBuffer, Array, ' +\n    'or Array-like Object. Received type ' + (typeof value)\n  )\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(value, encodingOrOffset, length)\n}\n\n// Note: Change prototype *after* Buffer.from is defined to workaround Chrome bug:\n// https://github.com/feross/buffer/pull/148\nObject.setPrototypeOf(Buffer.prototype, Uint8Array.prototype)\nObject.setPrototypeOf(Buffer, Uint8Array)\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be of type number')\n  } else if (size < 0) {\n    throw new RangeError('The value \"' + size + '\" is invalid for option \"size\"')\n  }\n}\n\nfunction alloc (size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpreted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(size).fill(fill, encoding)\n      : createBuffer(size).fill(fill)\n  }\n  return createBuffer(size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(size, fill, encoding)\n}\n\nfunction allocUnsafe (size) {\n  assertSize(size)\n  return createBuffer(size < 0 ? 0 : checked(size) | 0)\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(size)\n}\n\nfunction fromString (string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('Unknown encoding: ' + encoding)\n  }\n\n  const length = byteLength(string, encoding) | 0\n  let buf = createBuffer(length)\n\n  const actual = buf.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    buf = buf.slice(0, actual)\n  }\n\n  return buf\n}\n\nfunction fromArrayLike (array) {\n  const length = array.length < 0 ? 0 : checked(array.length) | 0\n  const buf = createBuffer(length)\n  for (let i = 0; i < length; i += 1) {\n    buf[i] = array[i] & 255\n  }\n  return buf\n}\n\nfunction fromArrayView (arrayView) {\n  if (isInstance(arrayView, Uint8Array)) {\n    const copy = new Uint8Array(arrayView)\n    return fromArrayBuffer(copy.buffer, copy.byteOffset, copy.byteLength)\n  }\n  return fromArrayLike(arrayView)\n}\n\nfunction fromArrayBuffer (array, byteOffset, length) {\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\"offset\" is outside of buffer bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\"length\" is outside of buffer bounds')\n  }\n\n  let buf\n  if (byteOffset === undefined && length === undefined) {\n    buf = new Uint8Array(array)\n  } else if (length === undefined) {\n    buf = new Uint8Array(array, byteOffset)\n  } else {\n    buf = new Uint8Array(array, byteOffset, length)\n  }\n\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(buf, Buffer.prototype)\n\n  return buf\n}\n\nfunction fromObject (obj) {\n  if (Buffer.isBuffer(obj)) {\n    const len = checked(obj.length) | 0\n    const buf = createBuffer(len)\n\n    if (buf.length === 0) {\n      return buf\n    }\n\n    obj.copy(buf, 0, 0, len)\n    return buf\n  }\n\n  if (obj.length !== undefined) {\n    if (typeof obj.length !== 'number' || numberIsNaN(obj.length)) {\n      return createBuffer(0)\n    }\n    return fromArrayLike(obj)\n  }\n\n  if (obj.type === 'Buffer' && Array.isArray(obj.data)) {\n    return fromArrayLike(obj.data)\n  }\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < K_MAX_LENGTH` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= K_MAX_LENGTH) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + K_MAX_LENGTH.toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return b != null && b._isBuffer === true &&\n    b !== Buffer.prototype // so Buffer.isBuffer(Buffer.prototype) will be false\n}\n\nBuffer.compare = function compare (a, b) {\n  if (isInstance(a, Uint8Array)) a = Buffer.from(a, a.offset, a.byteLength)\n  if (isInstance(b, Uint8Array)) b = Buffer.from(b, b.offset, b.byteLength)\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError(\n      'The \"buf1\", \"buf2\" arguments must be one of type Buffer or Uint8Array'\n    )\n  }\n\n  if (a === b) return 0\n\n  let x = a.length\n  let y = b.length\n\n  for (let i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!Array.isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  let i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  const buffer = Buffer.allocUnsafe(length)\n  let pos = 0\n  for (i = 0; i < list.length; ++i) {\n    let buf = list[i]\n    if (isInstance(buf, Uint8Array)) {\n      if (pos + buf.length > buffer.length) {\n        if (!Buffer.isBuffer(buf)) buf = Buffer.from(buf)\n        buf.copy(buffer, pos)\n      } else {\n        Uint8Array.prototype.set.call(\n          buffer,\n          buf,\n          pos\n        )\n      }\n    } else if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    } else {\n      buf.copy(buffer, pos)\n    }\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (ArrayBuffer.isView(string) || isInstance(string, ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    throw new TypeError(\n      'The \"string\" argument must be one of type string, Buffer, or ArrayBuffer. ' +\n      'Received type ' + typeof string\n    )\n  }\n\n  const len = string.length\n  const mustMatch = (arguments.length > 2 && arguments[2] === true)\n  if (!mustMatch && len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) {\n          return mustMatch ? -1 : utf8ToBytes(string).length // assume utf8\n        }\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  let loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coercion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// This property is used by `Buffer.isBuffer` (and the `is-buffer` npm package)\n// to detect a Buffer instance. It's not possible to use `instanceof Buffer`\n// reliably in a browserify context because there could be multiple different\n// copies of the 'buffer' package in use. This method works even for Buffer\n// instances that were created from another copy of the `buffer` package.\n// See: https://github.com/feross/buffer/issues/154\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  const i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  const len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (let i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  const len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (let i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  const len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (let i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  const length = this.length\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.toLocaleString = Buffer.prototype.toString\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  let str = ''\n  const max = exports.INSPECT_MAX_BYTES\n  str = this.toString('hex', 0, max).replace(/(.{2})/g, '$1 ').trim()\n  if (this.length > max) str += ' ... '\n  return '<Buffer ' + str + '>'\n}\nif (customInspectSymbol) {\n  Buffer.prototype[customInspectSymbol] = Buffer.prototype.inspect\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (isInstance(target, Uint8Array)) {\n    target = Buffer.from(target, target.offset, target.byteLength)\n  }\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError(\n      'The \"target\" argument must be one of type Buffer or Uint8Array. ' +\n      'Received type ' + (typeof target)\n    )\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  let x = thisEnd - thisStart\n  let y = end - start\n  const len = Math.min(x, y)\n\n  const thisCopy = this.slice(thisStart, thisEnd)\n  const targetCopy = target.slice(start, end)\n\n  for (let i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset // Coerce to Number.\n  if (numberIsNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [val], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  let indexSize = 1\n  let arrLength = arr.length\n  let valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  let i\n  if (dir) {\n    let foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      let found = true\n      for (let j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  const remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  const strLen = string.length\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  let i\n  for (i = 0; i < length; ++i) {\n    const parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (numberIsNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset >>> 0\n    if (isFinite(length)) {\n      length = length >>> 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  const remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  let loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return asciiWrite(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  const res = []\n\n  let i = start\n  while (i < end) {\n    const firstByte = buf[i]\n    let codePoint = null\n    let bytesPerSequence = (firstByte > 0xEF)\n      ? 4\n      : (firstByte > 0xDF)\n          ? 3\n          : (firstByte > 0xBF)\n              ? 2\n              : 1\n\n    if (i + bytesPerSequence <= end) {\n      let secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nconst MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  const len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  let res = ''\n  let i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  let ret = ''\n  end = Math.min(buf.length, end)\n\n  for (let i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  const len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  let out = ''\n  for (let i = start; i < end; ++i) {\n    out += hexSliceLookupTable[buf[i]]\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  const bytes = buf.slice(start, end)\n  let res = ''\n  // If bytes.length is odd, the last 8 bits must be ignored (same as node.js)\n  for (let i = 0; i < bytes.length - 1; i += 2) {\n    res += String.fromCharCode(bytes[i] + (bytes[i + 1] * 256))\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  const len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  const newBuf = this.subarray(start, end)\n  // Return an augmented `Uint8Array` instance\n  Object.setPrototypeOf(newBuf, Buffer.prototype)\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUintLE =\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUintBE =\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  let val = this[offset + --byteLength]\n  let mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUint8 =\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUint16LE =\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUint16BE =\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUint32LE =\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUint32BE =\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readBigUInt64LE = defineBigIntMethod(function readBigUInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const lo = first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24\n\n  const hi = this[++offset] +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    last * 2 ** 24\n\n  return BigInt(lo) + (BigInt(hi) << BigInt(32))\n})\n\nBuffer.prototype.readBigUInt64BE = defineBigIntMethod(function readBigUInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const hi = first * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  const lo = this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last\n\n  return (BigInt(hi) << BigInt(32)) + BigInt(lo)\n})\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let val = this[offset]\n  let mul = 1\n  let i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  let i = byteLength\n  let mul = 1\n  let val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  const val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readBigInt64LE = defineBigIntMethod(function readBigInt64LE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = this[offset + 4] +\n    this[offset + 5] * 2 ** 8 +\n    this[offset + 6] * 2 ** 16 +\n    (last << 24) // Overflow\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(first +\n    this[++offset] * 2 ** 8 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 24)\n})\n\nBuffer.prototype.readBigInt64BE = defineBigIntMethod(function readBigInt64BE (offset) {\n  offset = offset >>> 0\n  validateNumber(offset, 'offset')\n  const first = this[offset]\n  const last = this[offset + 7]\n  if (first === undefined || last === undefined) {\n    boundsError(offset, this.length - 8)\n  }\n\n  const val = (first << 24) + // Overflow\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    this[++offset]\n\n  return (BigInt(val) << BigInt(32)) +\n    BigInt(this[++offset] * 2 ** 24 +\n    this[++offset] * 2 ** 16 +\n    this[++offset] * 2 ** 8 +\n    last)\n})\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  offset = offset >>> 0\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUintLE =\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let mul = 1\n  let i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUintBE =\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    const maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUint8 =\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeUint16LE =\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint16BE =\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeUint32LE =\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset + 3] = (value >>> 24)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 1] = (value >>> 8)\n  this[offset] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeUint32BE =\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nfunction wrtBigUInt64LE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  lo = lo >> 8\n  buf[offset++] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  hi = hi >> 8\n  buf[offset++] = hi\n  return offset\n}\n\nfunction wrtBigUInt64BE (buf, value, offset, min, max) {\n  checkIntBI(value, min, max, buf, offset, 7)\n\n  let lo = Number(value & BigInt(0xffffffff))\n  buf[offset + 7] = lo\n  lo = lo >> 8\n  buf[offset + 6] = lo\n  lo = lo >> 8\n  buf[offset + 5] = lo\n  lo = lo >> 8\n  buf[offset + 4] = lo\n  let hi = Number(value >> BigInt(32) & BigInt(0xffffffff))\n  buf[offset + 3] = hi\n  hi = hi >> 8\n  buf[offset + 2] = hi\n  hi = hi >> 8\n  buf[offset + 1] = hi\n  hi = hi >> 8\n  buf[offset] = hi\n  return offset + 8\n}\n\nBuffer.prototype.writeBigUInt64LE = defineBigIntMethod(function writeBigUInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeBigUInt64BE = defineBigIntMethod(function writeBigUInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, BigInt(0), BigInt('0xffffffffffffffff'))\n})\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = 0\n  let mul = 1\n  let sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    const limit = Math.pow(2, (8 * byteLength) - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  let i = byteLength - 1\n  let mul = 1\n  let sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  this[offset] = (value >>> 8)\n  this[offset + 1] = (value & 0xff)\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  this[offset] = (value & 0xff)\n  this[offset + 1] = (value >>> 8)\n  this[offset + 2] = (value >>> 16)\n  this[offset + 3] = (value >>> 24)\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  this[offset] = (value >>> 24)\n  this[offset + 1] = (value >>> 16)\n  this[offset + 2] = (value >>> 8)\n  this[offset + 3] = (value & 0xff)\n  return offset + 4\n}\n\nBuffer.prototype.writeBigInt64LE = defineBigIntMethod(function writeBigInt64LE (value, offset = 0) {\n  return wrtBigUInt64LE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nBuffer.prototype.writeBigInt64BE = defineBigIntMethod(function writeBigInt64BE (value, offset = 0) {\n  return wrtBigUInt64BE(this, value, offset, -BigInt('0x8000000000000000'), BigInt('0x7fffffffffffffff'))\n})\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!Buffer.isBuffer(target)) throw new TypeError('argument should be a Buffer')\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('Index out of range')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  const len = end - start\n\n  if (this === target && typeof Uint8Array.prototype.copyWithin === 'function') {\n    // Use built-in when available, missing from IE11\n    this.copyWithin(targetStart, start, end)\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, end),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n    if (val.length === 1) {\n      const code = val.charCodeAt(0)\n      if ((encoding === 'utf8' && code < 128) ||\n          encoding === 'latin1') {\n        // Fast path: If `val` fits into a single byte, use that numeric value.\n        val = code\n      }\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  } else if (typeof val === 'boolean') {\n    val = Number(val)\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  let i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    const bytes = Buffer.isBuffer(val)\n      ? val\n      : Buffer.from(val, encoding)\n    const len = bytes.length\n    if (len === 0) {\n      throw new TypeError('The value \"' + val +\n        '\" is invalid for argument \"value\"')\n    }\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// CUSTOM ERRORS\n// =============\n\n// Simplified versions from Node, changed for Buffer-only usage\nconst errors = {}\nfunction E (sym, getMessage, Base) {\n  errors[sym] = class NodeError extends Base {\n    constructor () {\n      super()\n\n      Object.defineProperty(this, 'message', {\n        value: getMessage.apply(this, arguments),\n        writable: true,\n        configurable: true\n      })\n\n      // Add the error code to the name to include it in the stack trace.\n      this.name = `${this.name} [${sym}]`\n      // Access the stack to generate the error message including the error code\n      // from the name.\n      this.stack // eslint-disable-line no-unused-expressions\n      // Reset the name to the actual name.\n      delete this.name\n    }\n\n    get code () {\n      return sym\n    }\n\n    set code (value) {\n      Object.defineProperty(this, 'code', {\n        configurable: true,\n        enumerable: true,\n        value,\n        writable: true\n      })\n    }\n\n    toString () {\n      return `${this.name} [${sym}]: ${this.message}`\n    }\n  }\n}\n\nE('ERR_BUFFER_OUT_OF_BOUNDS',\n  function (name) {\n    if (name) {\n      return `${name} is outside of buffer bounds`\n    }\n\n    return 'Attempt to access memory outside buffer bounds'\n  }, RangeError)\nE('ERR_INVALID_ARG_TYPE',\n  function (name, actual) {\n    return `The \"${name}\" argument must be of type number. Received type ${typeof actual}`\n  }, TypeError)\nE('ERR_OUT_OF_RANGE',\n  function (str, range, input) {\n    let msg = `The value of \"${str}\" is out of range.`\n    let received = input\n    if (Number.isInteger(input) && Math.abs(input) > 2 ** 32) {\n      received = addNumericalSeparator(String(input))\n    } else if (typeof input === 'bigint') {\n      received = String(input)\n      if (input > BigInt(2) ** BigInt(32) || input < -(BigInt(2) ** BigInt(32))) {\n        received = addNumericalSeparator(received)\n      }\n      received += 'n'\n    }\n    msg += ` It must be ${range}. Received ${received}`\n    return msg\n  }, RangeError)\n\nfunction addNumericalSeparator (val) {\n  let res = ''\n  let i = val.length\n  const start = val[0] === '-' ? 1 : 0\n  for (; i >= start + 4; i -= 3) {\n    res = `_${val.slice(i - 3, i)}${res}`\n  }\n  return `${val.slice(0, i)}${res}`\n}\n\n// CHECK FUNCTIONS\n// ===============\n\nfunction checkBounds (buf, offset, byteLength) {\n  validateNumber(offset, 'offset')\n  if (buf[offset] === undefined || buf[offset + byteLength] === undefined) {\n    boundsError(offset, buf.length - (byteLength + 1))\n  }\n}\n\nfunction checkIntBI (value, min, max, buf, offset, byteLength) {\n  if (value > max || value < min) {\n    const n = typeof min === 'bigint' ? 'n' : ''\n    let range\n    if (byteLength > 3) {\n      if (min === 0 || min === BigInt(0)) {\n        range = `>= 0${n} and < 2${n} ** ${(byteLength + 1) * 8}${n}`\n      } else {\n        range = `>= -(2${n} ** ${(byteLength + 1) * 8 - 1}${n}) and < 2 ** ` +\n                `${(byteLength + 1) * 8 - 1}${n}`\n      }\n    } else {\n      range = `>= ${min}${n} and <= ${max}${n}`\n    }\n    throw new errors.ERR_OUT_OF_RANGE('value', range, value)\n  }\n  checkBounds(buf, offset, byteLength)\n}\n\nfunction validateNumber (value, name) {\n  if (typeof value !== 'number') {\n    throw new errors.ERR_INVALID_ARG_TYPE(name, 'number', value)\n  }\n}\n\nfunction boundsError (value, length, type) {\n  if (Math.floor(value) !== value) {\n    validateNumber(value, type)\n    throw new errors.ERR_OUT_OF_RANGE(type || 'offset', 'an integer', value)\n  }\n\n  if (length < 0) {\n    throw new errors.ERR_BUFFER_OUT_OF_BOUNDS()\n  }\n\n  throw new errors.ERR_OUT_OF_RANGE(type || 'offset',\n                                    `>= ${type ? 1 : 0} and <= ${length}`,\n                                    value)\n}\n\n// HELPER FUNCTIONS\n// ================\n\nconst INVALID_BASE64_RE = /[^+/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node takes equal signs as end of the Base64 encoding\n  str = str.split('=')[0]\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = str.trim().replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  let codePoint\n  const length = string.length\n  let leadSurrogate = null\n  const bytes = []\n\n  for (let i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  let c, hi, lo\n  const byteArray = []\n  for (let i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  let i\n  for (i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\n// ArrayBuffer or Uint8Array objects from other contexts (i.e. iframes) do not pass\n// the `instanceof` check but they should be treated as of that type.\n// See: https://github.com/feross/buffer/issues/166\nfunction isInstance (obj, type) {\n  return obj instanceof type ||\n    (obj != null && obj.constructor != null && obj.constructor.name != null &&\n      obj.constructor.name === type.name)\n}\nfunction numberIsNaN (obj) {\n  // For IE11 support\n  return obj !== obj // eslint-disable-line no-self-compare\n}\n\n// Create lookup table for `toString('hex')`\n// See: https://github.com/feross/buffer/issues/219\nconst hexSliceLookupTable = (function () {\n  const alphabet = '0123456789abcdef'\n  const table = new Array(256)\n  for (let i = 0; i < 16; ++i) {\n    const i16 = i * 16\n    for (let j = 0; j < 16; ++j) {\n      table[i16 + j] = alphabet[i] + alphabet[j]\n    }\n  }\n  return table\n})()\n\n// Return not function with Error if BigInt not supported\nfunction defineBigIntMethod (fn) {\n  return typeof BigInt === 'undefined' ? BufferBigIntNotDefined : fn\n}\n\nfunction BufferBigIntNotDefined () {\n  throw new Error('BigInt not supported')\n}\n","import { addActionHandler, getActions, getGlobal, setGlobal } from '../../index';\nimport { connectNotionRest } from '../../../lib/alphahuman/rest';\n\naddActionHandler('connectToNotion', async (global) => {\n  // Set connecting state\n  setGlobal({\n    ...global,\n    alphahuman: {\n      ...global.alphahuman,\n      notionOAuth: {\n        ...global.alphahuman?.notionOAuth,\n        isConnecting: true,\n        error: undefined,\n      },\n    },\n  });\n\n  try {\n    // Call the backend API to get OAuth URL\n    const response = await connectNotionRest();\n\n    const updatedGlobal = getGlobal();\n\n    // Store OAuth data and redirect\n    setGlobal({\n      ...updatedGlobal,\n      alphahuman: {\n        ...updatedGlobal.alphahuman,\n        notionOAuth: {\n          isConnecting: false,\n          isConnected: false,\n          oauthUrl: response.oauthUrl,\n          oauthState: response.state,\n          error: undefined,\n        },\n      },\n    });\n\n    // Redirect user to Notion OAuth page\n    window.location.href = response.oauthUrl;\n  } catch (error) {\n    const errorMessage = error instanceof Error ? error.message : 'Failed to connect to Notion';\n\n    const updatedGlobal = getGlobal();\n\n    // Reset connecting state and set error\n    setGlobal({\n      ...updatedGlobal,\n      alphahuman: {\n        ...updatedGlobal.alphahuman,\n        notionOAuth: {\n          ...updatedGlobal.alphahuman?.notionOAuth,\n          isConnecting: false,\n          error: errorMessage,\n        },\n      },\n    });\n\n    // Show error notification\n    getActions().showNotification({ message: `Failed to connect to Notion: ${errorMessage}` });\n  }\n});\n\naddActionHandler('resetNotionOAuthError', (global) => {\n  setGlobal({\n    ...global,\n    alphahuman: {\n      ...global.alphahuman,\n      notionOAuth: {\n        ...global.alphahuman?.notionOAuth,\n        error: undefined,\n      },\n    },\n  });\n});\n\naddActionHandler('completeNotionOAuthSuccess', (global, actions, payload) => {\n  const { workspace } = payload;\n\n  // Update global state to connected\n  setGlobal({\n    ...getGlobal(),\n    alphahuman: {\n      ...getGlobal().alphahuman,\n      notionOAuth: {\n        isConnecting: false,\n        isConnected: true,\n        oauthUrl: undefined,\n        oauthState: undefined,\n        error: undefined,\n      },\n    },\n  });\n\n  // Show success notification\n  getActions().showNotification({\n    message: `Successfully connected to Notion workspace: ${workspace}`,\n  });\n});\n\naddActionHandler('completeNotionOAuthError', (global, actions, payload) => {\n  const { error } = payload;\n\n  const updatedGlobal = getGlobal();\n\n  // Update global state with error\n  setGlobal({\n    ...updatedGlobal,\n    alphahuman: {\n      ...updatedGlobal.alphahuman,\n      notionOAuth: {\n        ...updatedGlobal.alphahuman?.notionOAuth,\n        isConnecting: false,\n        isConnected: false,\n        error,\n      },\n    },\n  });\n\n  // Show error notification\n  getActions().showNotification({\n    message: `Failed to connect to Notion: ${error}`,\n  });\n});","import type { ActionReturnType } from '../../types';\nimport { ManagementProgress } from '../../../types';\n\nimport {\n  CUSTOM_BG_CACHE_NAME,\n  LANG_CACHE_NAME,\n  LOCK_SCREEN_ANIMATION_DURATION_MS,\n  MEDIA_CACHE_NAME,\n  MEDIA_CACHE_NAME_AVATARS,\n  MEDIA_PROGRESSIVE_CACHE_NAME,\n} from '../../../config';\nimport { updateAppBadge } from '../../../util/appBadge';\nimport { PASSCODE_IDB_STORE } from '../../../util/browser/idb';\nimport { toCredentialRequestOptions } from '../../../util/browser/passkeys';\nimport {\n  IS_WEBAUTHN_SUPPORTED,\n  IS_WEBM_SUPPORTED, MAX_BUFFER_SIZE, PLATFORM_ENV,\n} from '../../../util/browser/windowEnvironment';\nimport * as cacheApi from '../../../util/cacheApi';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { ACCOUNT_SLOT, getAccountsInfo } from '../../../util/multiaccount';\nimport { unsubscribe } from '../../../util/notifications';\nimport { clearEncryptedSession, encryptSession, forgetPasscode } from '../../../util/passcode';\nimport { parseInitialLocationHash, resetInitialLocationHash, resetLocationHash } from '../../../util/routing';\nimport { pause } from '../../../util/schedulers';\nimport {\n  clearStoredSession,\n  loadStoredSession,\n  storeSession,\n} from '../../../util/sessions';\nimport { forceWebsync } from '../../../util/websync';\nimport {\n  callApi, callApiLocal, initApi, setShouldEnableDebugLog,\n} from '../../../api/gramjs';\nimport { removeGlobalFromCache, removeSharedStateFromCache, serializeGlobal } from '../../cache';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from '../../index';\nimport {\n  clearGlobalForLockScreen, updateManagementProgress, updatePasscodeSettings,\n} from '../../reducers';\nimport { updateAuth } from '../../reducers/auth';\nimport { selectSharedSettings } from '../../selectors/sharedState';\nimport { destroySharedStatePort } from '../../shared/sharedStateConnector';\n\naddActionHandler('initApi', (global, actions): ActionReturnType => {\n  const initialLocationHash = parseInitialLocationHash();\n  const {\n    shouldAllowHttpTransport,\n    shouldForceHttpTransport,\n    shouldDebugExportedSenders,\n    shouldCollectDebugLogs,\n    language,\n  } = selectSharedSettings(global);\n\n  const hasTestParam = window.location.search.includes('test') || initialLocationHash?.tgWebAuthTest === '1';\n\n  const isTestServer = global.config?.isTestServer;\n  const accountsInfo = getAccountsInfo();\n  const accountIds = Object.values(accountsInfo)\n    .filter((info) => info.isTest === isTestServer)\n    .map(({ userId }) => userId)\n    .filter(Boolean);\n\n  void initApi(actions.apiUpdate, {\n    userAgent: navigator.userAgent,\n    platform: PLATFORM_ENV,\n    sessionData: loadStoredSession(),\n    isWebmSupported: IS_WEBM_SUPPORTED,\n    maxBufferSize: MAX_BUFFER_SIZE,\n    webAuthToken: initialLocationHash?.tgWebAuthToken,\n    dcId: initialLocationHash?.tgWebAuthDcId ? Number(initialLocationHash?.tgWebAuthDcId) : undefined,\n    mockScenario: initialLocationHash?.mockScenario,\n    shouldAllowHttpTransport,\n    shouldForceHttpTransport,\n    shouldDebugExportedSenders,\n    langCode: language,\n    isTestServerRequested: hasTestParam,\n    accountIds,\n    hasPasskeySupport: IS_WEBAUTHN_SUPPORTED,\n  });\n\n  void setShouldEnableDebugLog(Boolean(shouldCollectDebugLogs));\n});\n\naddActionHandler('setAuthPhoneNumber', (global, actions, payload): ActionReturnType => {\n  const { phoneNumber } = payload;\n\n  void callApi('provideAuthPhoneNumber', phoneNumber.replace(/[^\\d]/g, ''));\n\n  return updateAuth(global, {\n    isLoading: true,\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('setAuthCode', (global, actions, payload): ActionReturnType => {\n  const { code } = payload;\n\n  void callApi('provideAuthCode', code);\n\n  return updateAuth(global, {\n    isLoading: true,\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('setAuthPassword', (global, actions, payload): ActionReturnType => {\n  const { password } = payload;\n\n  void callApi('provideAuthPassword', password);\n\n  return updateAuth(global, {\n    isLoading: true,\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('loginWithPasskey', async (global, actions, payload): Promise<void> => {\n  const passkeyOption = global.auth.passkeyOption;\n  if (!passkeyOption) return;\n\n  const credential = await navigator.credentials.get(toCredentialRequestOptions(passkeyOption)).catch((e: unknown) => {\n    actions.showNotification({\n      message: {\n        key: 'PasskeyLoginError',\n      },\n      tabId: getCurrentTabId(),\n    });\n  });\n  if (!credential) return;\n\n  const publicKeyCredential = credential as PublicKeyCredential;\n  callApi('restartAuthWithPasskey', publicKeyCredential.toJSON());\n});\n\naddActionHandler('uploadProfilePhoto', async (global, actions, payload): Promise<void> => {\n  const {\n    file, isFallback, isVideo, videoTs, bot,\n    tabId = getCurrentTabId(),\n  } = payload;\n\n  global = updateManagementProgress(global, ManagementProgress.InProgress, tabId);\n  setGlobal(global);\n\n  const result = await callApi('uploadProfilePhoto', file, isFallback, isVideo, videoTs, bot);\n  if (!result) return;\n\n  global = getGlobal();\n  global = updateManagementProgress(global, ManagementProgress.Complete, tabId);\n  setGlobal(global);\n\n  actions.loadFullUser({ userId: global.currentUserId! });\n});\n\naddActionHandler('signUp', (global, actions, payload): ActionReturnType => {\n  const { firstName, lastName } = payload;\n\n  void callApi('provideAuthRegistration', { firstName, lastName });\n\n  return updateAuth(global, {\n    isLoading: true,\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('returnToAuthPhoneNumber', (global): ActionReturnType => {\n  void callApi('restartAuth');\n\n  return updateAuth(global, {\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('goToAuthQrCode', (global): ActionReturnType => {\n  void callApi('restartAuthWithQr');\n\n  return updateAuth(global, {\n    isLoadingQrCode: true,\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('saveSession', (global, actions, payload): ActionReturnType => {\n  if (global.passcode.isScreenLocked) {\n    return;\n  }\n\n  const { sessionData } = payload;\n  if (sessionData) {\n    storeSession(sessionData);\n  } else {\n    clearStoredSession();\n  }\n});\n\naddActionHandler('signOut', async (global, actions, payload): Promise<void> => {\n  if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n  if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId: getCurrentTabId() });\n  if ('disconnectAlphaHumanSocket' in actions) actions.disconnectAlphaHumanSocket();\n\n  try {\n    resetInitialLocationHash();\n    resetLocationHash();\n    await unsubscribe();\n    await Promise.race([callApi('destroy'), pause(3000)]);\n    await forceWebsync(false);\n  } catch (err) {\n    // Do nothing\n  }\n\n  actions.reset();\n\n  if (payload?.forceInitApi) {\n    actions.initApi();\n  }\n});\n\naddActionHandler('requestChannelDifference', (global, actions, payload): ActionReturnType => {\n  const { chatId } = payload;\n\n  void callApi('requestChannelDifference', chatId);\n});\n\naddActionHandler('reset', (global, actions): ActionReturnType => {\n  clearStoredSession(ACCOUNT_SLOT);\n  clearEncryptedSession();\n\n  void cacheApi.clear(MEDIA_CACHE_NAME);\n  void cacheApi.clear(MEDIA_CACHE_NAME_AVATARS);\n  void cacheApi.clear(MEDIA_PROGRESSIVE_CACHE_NAME);\n  void cacheApi.clear(CUSTOM_BG_CACHE_NAME);\n\n  removeGlobalFromCache();\n  destroySharedStatePort();\n\n  // Check if there are any accounts left\n  const accounts = getAccountsInfo();\n  if (!Object.values(accounts).length) {\n    PASSCODE_IDB_STORE.clear();\n    removeSharedStateFromCache();\n  }\n\n  const langCachePrefix = LANG_CACHE_NAME.replace(/\\d+$/, '');\n  const langCacheVersion = Number((LANG_CACHE_NAME.match(/\\d+$/) || ['0'])[0]);\n  for (let i = 0; i < langCacheVersion; i++) {\n    void cacheApi.clear(`${langCachePrefix}${i === 0 ? '' : i}`);\n  }\n\n  updateAppBadge(0);\n\n  actions.initShared({ force: true });\n  Object.values(global.byTabId).forEach(({ id: otherTabId, isMasterTab }) => {\n    actions.init({ tabId: otherTabId, isMasterTab });\n  });\n});\n\naddActionHandler('disconnect', (): ActionReturnType => {\n  void callApiLocal('disconnect');\n});\n\naddActionHandler('destroyConnection', (): ActionReturnType => {\n  void callApiLocal('destroy', true, true);\n});\n\naddActionHandler('loadNearestCountry', async (global): Promise<void> => {\n  if (global.connectionState !== 'connectionStateReady') {\n    return;\n  }\n\n  const authNearestCountry = await callApi('fetchNearestCountry');\n\n  global = getGlobal();\n  global = updateAuth(global, {\n    nearestCountry: authNearestCountry,\n  });\n  setGlobal(global);\n});\n\naddActionHandler('setDeviceToken', (global, actions, payload): ActionReturnType => {\n  const { token } = payload;\n  return {\n    ...global,\n    push: {\n      deviceToken: token,\n      subscribedAt: Date.now(),\n    },\n  };\n});\n\naddActionHandler('deleteDeviceToken', (global): ActionReturnType => {\n  return {\n    ...global,\n    push: undefined,\n  };\n});\n\naddActionHandler('lockScreen', async (global): Promise<void> => {\n  const sessionJson = JSON.stringify({ ...loadStoredSession(), userId: global.currentUserId });\n  const globalJson = serializeGlobal(global);\n\n  await encryptSession(sessionJson, globalJson);\n  forgetPasscode();\n  clearStoredSession();\n  updateAppBadge(0);\n\n  global = getGlobal();\n  global = updatePasscodeSettings(\n    global,\n    {\n      isScreenLocked: true,\n      invalidAttemptsCount: 0,\n      timeoutUntil: undefined,\n    },\n  );\n  setGlobal(global);\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = clearGlobalForLockScreen(global);\n    setGlobal(global);\n  }, LOCK_SCREEN_ANIMATION_DURATION_MS);\n\n  try {\n    await unsubscribe();\n    await callApi('destroy', true);\n  } catch (err) {\n    // Do nothing\n  }\n});\n","import type { LangFn } from './types';\n\nimport { STARS_ICON_PLACEHOLDER } from '../../config';\nimport { convertTonFromNanos } from '../../util/formatCurrency';\nimport buildClassName from '../buildClassName';\n\nimport Icon from '../../components/common/icons/Icon';\nimport StarIcon from '../../components/common/icons/StarIcon';\n\nexport function formatStarsAsText(lang: LangFn, amount: number) {\n  return lang('StarsAmountText', { amount }, { pluralValue: amount });\n}\n\nexport function formatTonAsText(lang: LangFn, amount: number, shouldConvertFromNanos?: boolean) {\n  const formattedAmount = shouldConvertFromNanos ? convertTonFromNanos(Number(amount)) : amount;\n  return lang('TonAmountText', { amount: lang.preciseNumber(formattedAmount) }, { pluralValue: formattedAmount });\n}\n\nexport function formatTonAsIcon(\n  lang: LangFn,\n  amount: number | string,\n  options?: {\n    className?: string; containerClassName?: string; shouldConvertFromNanos?: boolean;\n  }) {\n  const { className, containerClassName, shouldConvertFromNanos } = options || {};\n  const formattedAmount = shouldConvertFromNanos ? convertTonFromNanos(Number(amount)) : amount;\n  const icon = <Icon name=\"toncoin\" className={buildClassName('ton-amount-icon', className)} />;\n\n  if (containerClassName) {\n    return (\n      <span className={containerClassName}>\n        {lang('TonAmount', { amount: formattedAmount }, {\n          withNodes: true,\n          specialReplacement: {\n            '': icon,\n          },\n        })}\n      </span>\n    );\n  }\n\n  return lang('TonAmount', { amount: formattedAmount }, {\n    withNodes: true,\n    specialReplacement: {\n      '': icon,\n    },\n  });\n}\n\nexport function formatStarsAsIcon(lang: LangFn, amount: number | string, options?: {\n  asFont?: boolean; className?: string; containerClassName?: string; }) {\n  const { asFont, className, containerClassName } = options || {};\n  const icon = asFont\n    ? <Icon name=\"star\" className={buildClassName('star-amount-icon', className)} />\n    : <StarIcon type=\"gold\" className={buildClassName('star-amount-icon', className)} size=\"adaptive\" />;\n\n  if (containerClassName) {\n    return (\n      <span className={containerClassName}>\n        {lang('StarsAmount', { amount }, {\n          withNodes: true,\n          specialReplacement: {\n            [STARS_ICON_PLACEHOLDER]: icon,\n          },\n        })}\n      </span>\n    );\n  }\n\n  return lang('StarsAmount', { amount }, {\n    withNodes: true,\n    specialReplacement: {\n      [STARS_ICON_PLACEHOLDER]: icon,\n    },\n  });\n}\n","import { preloadImage } from './files';\nimport { clamp, lerp } from './math.ts';\n\nconst LUMA_THRESHOLD = 128;\n\ntype Number3 = [number, number, number];\ntype Number4 = [number, number, number, number];\ntype Rgba = {\n  r: number;\n  g: number;\n  b: number;\n  a?: number;\n};\n\nfunction clearHex(hex: string) {\n  return hex.length % 2 === 0 ? hex : hex.slice(1);\n}\n\n/**\n * HEX > RGB\n * input: 'xxxxxx' (ex. 'ed15fa') case-insensitive\n * output: [r, g, b] ([0-255, 0-255, 0-255])\n */\nexport function hex2rgb(hex: string): Number3 {\n  const cleanHex = clearHex(hex);\n\n  return [\n    parseInt(cleanHex.substring(0, 2), 16),\n    parseInt(cleanHex.substring(2, 4), 16),\n    parseInt(cleanHex.substring(4, 6), 16),\n  ];\n}\n\nexport function hex2rgba(hex: string): Number4 {\n  const cleanHex = clearHex(hex);\n\n  return [\n    ...hex2rgb(cleanHex),\n    cleanHex.length === 8 ? parseInt(cleanHex.substring(6, 8), 16) : 255,\n  ];\n}\n\nexport function hex2rgbaObj(hex: string): Rgba {\n  const [r, g, b, a] = hex2rgba(hex);\n\n  return { r, g, b, a };\n}\n\nexport function rgb2hex([r, g, b]: Number3) {\n  return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;\n}\n\nexport function rgba2hex([r, g, b, a]: Number4) {\n  return `${rgb2hex([r, g, b])}${a.toString(16)}`;\n}\n\n/**\n * Converts an RGB color value to HSV. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes r, g, and b are contained in the set [0, 255] and\n * returns h, s, and v in the set [0, 1].\n *\n * @param   Number  r       The red color value\n * @param   Number  g       The green color value\n * @param   Number  b       The blue color value\n * @return  Array           The HSV representation\n */\nexport function rgb2hsv([r, g, b]: Number3): Number3 {\n  r /= 255;\n  g /= 255;\n  b /= 255;\n\n  const max = Math.max(r, g, b), min = Math.min(r, g, b);\n  const d = max - min;\n  let h!: number;\n  const s: number = max === 0 ? 0 : d / max;\n  const v: number = max;\n\n  if (max === min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n\n    h /= 6;\n  }\n\n  return [h, s, v];\n}\n\nexport function rgba2hsva([r, g, b, a]: Number4): Number4 {\n  return [...rgb2hsv([r, g, b]), a];\n}\n\n/**\n * Converts an HSV color value to RGB. Conversion formula\n * adapted from http://en.wikipedia.org/wiki/HSV_color_space.\n * Assumes h, s, and v are contained in the set [0, 1] and\n * returns r, g, and b in the set [0, 255].\n *\n * @param   Number  h       The hue\n * @param   Number  s       The saturation\n * @param   Number  v       The value\n * @return  Array           The RGB representation\n */\nexport function hsv2rgb([h, s, v]: Number3): Number3 {\n  let r!: number, g!: number, b!: number;\n\n  const i = Math.floor(h * 6);\n  const f = h * 6 - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n\n  switch (i % 6) {\n    case 0:\n      r = v;\n      g = t;\n      b = p;\n      break;\n    case 1:\n      r = q;\n      g = v;\n      b = p;\n      break;\n    case 2:\n      r = p;\n      g = v;\n      b = t;\n      break;\n    case 3:\n      r = p;\n      g = q;\n      b = v;\n      break;\n    case 4:\n      r = t;\n      g = p;\n      b = v;\n      break;\n    case 5:\n      r = v;\n      g = p;\n      b = q;\n      break;\n  }\n\n  return [\n    Math.round(r * 255),\n    Math.round(g * 255),\n    Math.round(b * 255),\n  ];\n}\n\nexport function hsva2rgba([h, s, v, a]: Number4): Number4 {\n  return [...hsv2rgb([h, s, v]), a];\n}\n\nexport async function getAverageColor(url: string): Promise<Number3> {\n  // Only visit every 5 pixels\n  const blockSize = 5;\n  const black: Number3 = [0, 0, 0];\n  let data;\n  let i = -4;\n  const rgb: Number3 = [0, 0, 0];\n  let count = 0;\n\n  const canvas = document.createElement('canvas');\n  const context = canvas.getContext && canvas.getContext('2d');\n  if (!context) {\n    return black;\n  }\n\n  const image = await preloadImage(url);\n  const height = image.naturalHeight || image.offsetHeight || image.height;\n  const width = image.naturalWidth || image.offsetWidth || image.width;\n  canvas.height = height;\n  canvas.width = width;\n\n  context.drawImage(image, 0, 0);\n\n  try {\n    data = context.getImageData(0, 0, width, height);\n  } catch (e) {\n    return black;\n  }\n\n  const length = data.data.length;\n\n  while ((i += blockSize * 4) < length) {\n    if (data.data[i + 3] === 0) continue; // Ignore fully transparent pixels\n    ++count;\n    rgb[0] += data.data[i];\n    rgb[1] += data.data[i + 1];\n    rgb[2] += data.data[i + 2];\n  }\n\n  rgb[0] = Math.floor(rgb[0] / count);\n  rgb[1] = Math.floor(rgb[1] / count);\n  rgb[2] = Math.floor(rgb[2] / count);\n\n  return rgb;\n}\n\nexport function getColorLuma([r, g, b]: Number3) {\n  return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n}\n\n// https://stackoverflow.com/a/64090995\nexport function hsl2rgb([h, s, l]: Number3): Number3 {\n  const a = s * Math.min(l, 1 - l);\n  const f = (n: number, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n\n  return [f(0), f(8), f(4)];\n}\n\n// Function was adapted from https://github.com/telegramdesktop/tdesktop/blob/35ff621b5b52f7e3553fb0f990ea13ade7101b8e/Telegram/SourceFiles/data/data_wall_paper.cpp#L518\nexport function getPatternColor(rgb: Number3) {\n  const hsv = rgb2hsv(rgb);\n  const [h] = hsv;\n  let [, s, v] = hsv;\n\n  s = Math.min(1, s + 0.05 + 0.1 * (1 - s));\n  v = v > 0.5\n    ? Math.max(0, v * 0.65)\n    : Math.max(0, Math.min(1, 1 - v * 0.65));\n\n  const newRgb = hsv2rgb([h, s, v]);\n\n  return rgba2hex([...newRgb, 102]);\n}\n\nexport function int2cssRgba(color: number): string {\n  const alpha = (color >> 24) & 0xff;\n  const red = (color >> 16) & 0xff;\n  const green = (color >> 8) & 0xff;\n  const blue = color & 0xff;\n  const alphaFloat = alpha / 255;\n\n  return `rgba(${red}, ${green}, ${blue}, ${alphaFloat})`;\n}\n\nexport function int2hex(color: number): string {\n  return `#${color.toString(16).padStart(6, '0')}`;\n}\n\nexport function getTextColor(color: number): string {\n  const r = (color >> 16) & 0xff;\n  const g = (color >> 8) & 0xff;\n  const b = color & 0xff;\n  const luma = getColorLuma([r, g, b]);\n  return luma > LUMA_THRESHOLD ? 'black' : 'white';\n}\n\nexport function lerpRgbaObj(start: Rgba, end: Rgba, interpolationRatio: number): Rgba {\n  const r = Math.round(lerp(start.r, end.r, interpolationRatio));\n  const g = Math.round(lerp(start.g, end.g, interpolationRatio));\n  const b = Math.round(lerp(start.b, end.b, interpolationRatio));\n  const a = start.a !== undefined\n    ? Math.round(lerp(start.a, end.a!, interpolationRatio))\n    : undefined;\n\n  return { r, g, b, a };\n}\n\nexport function adjustHsv(hex: string, satDelta: number, valDelta: number) {\n  const hsva = rgba2hsva(hex2rgba(hex));\n  const [h, , , a] = hsva;\n  let [, s, v] = hsva;\n\n  if (s > 0.1 && s < 0.9) s = clamp(s + satDelta, 0, 1);\n  v = clamp(v + valDelta, 0, 1);\n\n  return rgba2hex(hsva2rgba([h, s, v, a]));\n}\n","import { onFullyIdle } from '../lib/teact/teact';\nimport { addCallback } from '../lib/teact/teactn';\nimport { addActionHandler, getGlobal } from '../global';\n\nimport type {\n  ApiChat, ApiChatFolder, ApiNotifyPeerType, ApiPeerNotifySettings, ApiUser,\n} from '../api/types';\nimport type { GlobalState } from '../global/types';\nimport type { CallbackManager } from './callbacks';\n\nimport {\n  ALL_FOLDER_ID, ARCHIVED_FOLDER_ID, DEBUG, SAVED_FOLDER_ID, SERVICE_NOTIFICATIONS_USER_ID,\n} from '../config';\nimport { getIsChatMuted } from '../global/helpers/notifications';\nimport {\n  selectChatLastMessage,\n  selectIsChatRestricted,\n  selectNotifyDefaults,\n  selectTabState,\n  selectTopics,\n} from '../global/selectors';\nimport arePropsShallowEqual from './arePropsShallowEqual';\nimport { createCallbackManager } from './callbacks';\nimport { areSortedArraysEqual, unique } from './iteratees';\nimport { throttle } from './schedulers';\n\ninterface FolderSummary {\n  id: number;\n  listIds?: Set<string>;\n  orderedPinnedIds?: string[];\n  contacts?: true;\n  nonContacts?: true;\n  groups?: true;\n  channels?: true;\n  bots?: true;\n  excludeMuted?: true;\n  excludeRead?: true;\n  excludeArchived?: true;\n  excludedChatIds?: Set<string>;\n  includedChatIds?: Set<string>;\n  pinnedChatIds?: Set<string>;\n}\n\ninterface ChatSummary {\n  id: string;\n  type: ApiChat['type'];\n  isListedInAll: boolean;\n  isListedInSaved: boolean;\n  isArchived: boolean;\n  isMuted: boolean;\n  isUnread: boolean;\n  unreadCount?: number;\n  unreadMentionsCount?: number;\n  orderInAll: number;\n  orderInSaved: number;\n  isUserBot?: boolean;\n  isUserContact?: boolean;\n}\n\nconst UPDATE_THROTTLE = 500;\nconst DEBUG_DURATION_LIMIT = 6;\n\nconst initials = buildInitials();\n\nlet prevGlobal: {\n  allFolderListIds?: GlobalState['chats']['listIds']['active'];\n  allFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['active'];\n  archivedFolderListIds?: GlobalState['chats']['listIds']['archived'];\n  archivedFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['archived'];\n  savedFolderListIds?: GlobalState['chats']['listIds']['saved'];\n  savedFolderPinnedIds?: GlobalState['chats']['orderedPinnedIds']['saved'];\n  isAllFolderFullyLoaded?: boolean;\n  isArchivedFolderFullyLoaded?: boolean;\n  isSavedFolderFullyLoaded?: boolean;\n  lastAllMessageIds?: GlobalState['chats']['lastMessageIds']['all'];\n  lastSavedMessageIds?: GlobalState['chats']['lastMessageIds']['saved'];\n  topicsInfoById: GlobalState['chats']['topicsInfoById'];\n  chatsById: Record<string, ApiChat>;\n  foldersById: Record<string, ApiChatFolder>;\n  usersById: Record<string, ApiUser>;\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>;\n  notifyExceptions?: Record<number, ApiPeerNotifySettings>;\n} = initials.prevGlobal;\n\nlet prepared: {\n  folderSummariesById: Record<string, FolderSummary>;\n  chatSummariesById: Map<string, ChatSummary>;\n  folderIdsByChatId: Record<string, number[]>;\n  chatIdsByFolderId: Record<number, Set<string> | undefined>;\n  isOrderedListJustPatched: Record<number, boolean | undefined>;\n} = initials.prepared;\n\nlet results: {\n  orderedIdsByFolderId: Record<string, string[] | undefined>;\n  pinnedCountByFolderId: Record<string, number | undefined>; // Also watched by `callbacks.orderedIdsByFolderId`\n  chatsCountByFolderId: Record<string, number | undefined>;\n  unreadCountersByFolderId: Record<string, {\n    chatsCount: number;\n    notificationsCount: number;\n  } | undefined>;\n  unreadChatIdsByFolderId: Record<string, string[] | undefined>;\n} = initials.results;\n\nlet callbacks: {\n  orderedIdsByFolderId: Record<number, CallbackManager>;\n  chatsCountByFolderId: CallbackManager;\n  unreadCountersByFolderId: CallbackManager;\n  unreadChatIdsByFolderId: CallbackManager;\n} = initials.callbacks;\n\nif (DEBUG) {\n  (window as any).DEBUG_getFolderManager = () => ({\n    prepared,\n    results,\n  });\n}\n\nconst updateFolderManagerThrottled = throttle(() => {\n  onFullyIdle(() => {\n    updateFolderManager(getGlobal());\n  });\n}, UPDATE_THROTTLE);\n\nlet inited = false;\n\n/* Getters */\n\nexport function init() {\n  inited = true;\n\n  addCallback(updateFolderManagerThrottled);\n  addActionHandler('reset', reset);\n\n  const global = getGlobal();\n  if (!selectTabState(global).isMasterTab) {\n    updateFolders(global, true, true, true, true);\n  }\n  updateFolderManager(global);\n}\n\nexport function getOrderedIds(folderId: number) {\n  if (!inited) init();\n\n  return results.orderedIdsByFolderId[folderId];\n}\n\nexport function getPinnedChatsCount(folderId: number) {\n  if (!inited) init();\n\n  return results.pinnedCountByFolderId[folderId] || 0;\n}\n\nexport function getChatsCount() {\n  if (!inited) init();\n\n  return results.chatsCountByFolderId;\n}\n\nexport function getUnreadCounters() {\n  if (!inited) init();\n\n  return results.unreadCountersByFolderId;\n}\n\nexport function getUnreadChatsByFolderId() {\n  if (!inited) init();\n\n  return results.unreadChatIdsByFolderId;\n}\n\nexport function getAllNotificationsCount() {\n  return getUnreadCounters()[ALL_FOLDER_ID]?.notificationsCount || 0;\n}\n\nexport function getOrderKey(chatId: string, isForSaved?: boolean) {\n  const summary = prepared.chatSummariesById.get(chatId)!;\n  return isForSaved ? summary.orderInSaved : summary.orderInAll;\n}\n\nexport function getChatFolderIds(chatId: string) {\n  return prepared.folderIdsByChatId[chatId];\n}\n\n/* Callback managers */\n\nexport function addOrderedIdsCallback(folderId: number, callback: (orderedIds: string[]) => void) {\n  if (!callbacks.orderedIdsByFolderId[folderId]) {\n    callbacks.orderedIdsByFolderId[folderId] = createCallbackManager();\n  }\n\n  return callbacks.orderedIdsByFolderId[folderId].addCallback(callback);\n}\n\nexport function addChatsCountCallback(callback: (chatsCount: typeof results.chatsCountByFolderId) => void) {\n  return callbacks.chatsCountByFolderId.addCallback(callback);\n}\n\nexport function addUnreadChatsByFolderIdCallback(\n  callback: (unreadChats: typeof results.unreadChatIdsByFolderId) => void,\n) {\n  return callbacks.unreadChatIdsByFolderId.addCallback(callback);\n}\n\nexport function addUnreadCountersCallback(callback: (unreadCounters: typeof results.unreadCountersByFolderId) => void) {\n  return callbacks.unreadCountersByFolderId.addCallback(callback);\n}\n\n/* Global update handlers */\n\nfunction updateFolderManager(global: GlobalState) {\n  let DEBUG_startedAt: number;\n  if (DEBUG) {\n    DEBUG_startedAt = performance.now();\n  }\n\n  const isAllFolderChanged = Boolean(\n    global.chats.listIds.active\n    && isMainFolderChanged(ALL_FOLDER_ID, global.chats.listIds.active, global.chats.orderedPinnedIds.active),\n  );\n  const isArchivedFolderChanged = Boolean(\n    global.chats.listIds.archived\n    && isMainFolderChanged(ARCHIVED_FOLDER_ID, global.chats.listIds.archived, global.chats.orderedPinnedIds.archived),\n  );\n  const isSavedFolderChanged = Boolean(\n    global.chats.listIds.saved\n    && isMainFolderChanged(SAVED_FOLDER_ID, global.chats.listIds.saved, global.chats.orderedPinnedIds.saved),\n  );\n  const isAllFullyLoadedChanged = global.chats.isFullyLoaded.active !== prevGlobal.isAllFolderFullyLoaded;\n  const isArchivedFullyLoadedChanged = global.chats.isFullyLoaded.archived !== prevGlobal.isArchivedFolderFullyLoaded;\n  const isSavedFolderFullyLoadedChanged = global.chats.isFullyLoaded.saved !== prevGlobal.isSavedFolderFullyLoaded;\n\n  const areFoldersChanged = global.chatFolders.byId !== prevGlobal.foldersById;\n  const areChatsChanged = global.chats.byId !== prevGlobal.chatsById;\n  const areSavedLastMessageIdsChanged = global.chats.lastMessageIds.saved !== prevGlobal.lastSavedMessageIds;\n  const areAllLastMessageIdsChanged = global.chats.lastMessageIds.all !== prevGlobal.lastAllMessageIds;\n  const areTopicsChanged = global.chats.topicsInfoById !== prevGlobal.topicsInfoById;\n  const areUsersChanged = global.users.byId !== prevGlobal.usersById;\n  const areNotifyDefaultsChanged = selectNotifyDefaults(global) !== prevGlobal.notifyDefaults;\n  const areNotifyExceptionsChanged = global.chats.notifyExceptionById !== prevGlobal.notifyExceptions;\n\n  let affectedFolderIds: number[] = [];\n\n  if (isAllFullyLoadedChanged || isArchivedFullyLoadedChanged || isSavedFolderFullyLoadedChanged) {\n    affectedFolderIds = affectedFolderIds.concat(\n      updateFullyLoaded(global, isArchivedFullyLoadedChanged, isSavedFolderFullyLoadedChanged),\n    );\n  }\n\n  if (!(\n    isAllFolderChanged || isArchivedFolderChanged || isSavedFolderChanged || areFoldersChanged\n    || areChatsChanged || areUsersChanged || areTopicsChanged || areNotifyDefaultsChanged || areNotifyExceptionsChanged\n    || areSavedLastMessageIdsChanged || areAllLastMessageIdsChanged\n  )\n  ) {\n    if (affectedFolderIds.length) {\n      updateResults(affectedFolderIds);\n    }\n\n    return;\n  }\n\n  const prevAllFolderListIds = prevGlobal.allFolderListIds;\n  const prevArchivedFolderListIds = prevGlobal.archivedFolderListIds;\n  const prevSavedFolderListIds = prevGlobal.savedFolderListIds;\n\n  updateFolders(global, isAllFolderChanged, isArchivedFolderChanged, isSavedFolderChanged, areFoldersChanged);\n\n  affectedFolderIds = affectedFolderIds.concat(updateChats(\n    global,\n    areFoldersChanged || isAllFolderChanged || isArchivedFolderChanged || isSavedFolderChanged,\n    areNotifyDefaultsChanged,\n    areNotifyExceptionsChanged,\n    prevAllFolderListIds,\n    prevArchivedFolderListIds,\n    prevSavedFolderListIds,\n  ));\n\n  updateResults(unique(affectedFolderIds));\n\n  if (DEBUG) {\n    const duration = performance.now() - DEBUG_startedAt!;\n    if (duration > DEBUG_DURATION_LIMIT) {\n      // eslint-disable-next-line no-console\n      console.warn(`Slow \\`updateFolderManager\\`: ${Math.round(duration)} ms`);\n    }\n  }\n}\n\nfunction isMainFolderChanged(folderId: number, newListIds?: string[], newPinnedIds?: string[]) {\n  const currentListIds = folderId === ALL_FOLDER_ID\n    ? prevGlobal.allFolderListIds\n    : folderId === SAVED_FOLDER_ID\n      ? prevGlobal.savedFolderListIds : prevGlobal.archivedFolderListIds;\n  const currentPinnedIds = folderId === ALL_FOLDER_ID\n    ? prevGlobal.allFolderPinnedIds\n    : folderId === SAVED_FOLDER_ID\n      ? prevGlobal.savedFolderPinnedIds : prevGlobal.archivedFolderPinnedIds;\n\n  return currentListIds !== newListIds || currentPinnedIds !== newPinnedIds;\n}\n\nfunction updateFullyLoaded(\n  global: GlobalState,\n  isArchivedFullyLoadedChanged = false,\n  isSavedFolderFullyLoadedChanged = false,\n) {\n  let affectedFolderIds = [];\n\n  if (isArchivedFullyLoadedChanged) {\n    affectedFolderIds.push(ARCHIVED_FOLDER_ID);\n  }\n\n  if (isSavedFolderFullyLoadedChanged) {\n    affectedFolderIds.push(SAVED_FOLDER_ID);\n  }\n\n  const isAllFolderFullyLoaded = global.chats.isFullyLoaded.active;\n  const isArchivedFolderFullyLoaded = global.chats.isFullyLoaded.archived;\n  const isSavedFolderFullyLoaded = global.chats.isFullyLoaded.saved;\n\n  if (isAllFolderFullyLoaded && isArchivedFolderFullyLoaded) {\n    const emptyFolderIds = Object.keys(prepared.folderSummariesById)\n      .filter((folderId) => !results.orderedIdsByFolderId[folderId])\n      .map(Number);\n\n    affectedFolderIds = affectedFolderIds.concat(emptyFolderIds);\n  }\n\n  prevGlobal.isAllFolderFullyLoaded = isAllFolderFullyLoaded;\n  prevGlobal.isArchivedFolderFullyLoaded = isArchivedFolderFullyLoaded;\n  prevGlobal.isSavedFolderFullyLoaded = isSavedFolderFullyLoaded;\n\n  return affectedFolderIds;\n}\n\nfunction updateFolders(\n  global: GlobalState,\n  isAllFolderChanged: boolean,\n  isArchivedFolderChanged: boolean,\n  isSavedFolderChanged: boolean,\n  areFoldersChanged: boolean,\n) {\n  const changedFolders = [];\n\n  if (isAllFolderChanged) {\n    const newListIds = global.chats.listIds.active!;\n    const newPinnedIds = global.chats.orderedPinnedIds.active;\n\n    prepared.folderSummariesById[ALL_FOLDER_ID] = buildFolderSummaryFromMainList(\n      ALL_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.allFolderListIds = newListIds;\n    prevGlobal.allFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(ALL_FOLDER_ID);\n  }\n\n  if (isArchivedFolderChanged) {\n    const newListIds = global.chats.listIds.archived!;\n    const newPinnedIds = global.chats.orderedPinnedIds.archived;\n\n    prepared.folderSummariesById[ARCHIVED_FOLDER_ID] = buildFolderSummaryFromMainList(\n      ARCHIVED_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.archivedFolderListIds = newListIds;\n    prevGlobal.archivedFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(ARCHIVED_FOLDER_ID);\n  }\n\n  if (isSavedFolderChanged) {\n    const newListIds = global.chats.listIds.saved!;\n    const newPinnedIds = global.chats.orderedPinnedIds.saved;\n\n    prepared.folderSummariesById[SAVED_FOLDER_ID] = buildFolderSummaryFromMainList(\n      SAVED_FOLDER_ID, newListIds, newPinnedIds,\n    );\n\n    prevGlobal.savedFolderListIds = newListIds;\n    prevGlobal.savedFolderPinnedIds = newPinnedIds;\n\n    changedFolders.push(SAVED_FOLDER_ID);\n  }\n\n  if (areFoldersChanged) {\n    const newFoldersById = global.chatFolders.byId;\n\n    Object.values(newFoldersById).forEach((folder) => {\n      if (folder === prevGlobal.foldersById[folder.id]) {\n        return;\n      }\n\n      prepared.folderSummariesById[folder.id] = buildFolderSummary(folder);\n\n      changedFolders.push(folder.id);\n    });\n\n    prevGlobal.foldersById = newFoldersById;\n  }\n\n  return changedFolders;\n}\n\nfunction buildFolderSummaryFromMainList(\n  folderId: number, listIds: string[], orderedPinnedIds?: string[],\n): FolderSummary {\n  return {\n    id: folderId,\n    listIds: new Set(listIds),\n    orderedPinnedIds,\n    pinnedChatIds: new Set(orderedPinnedIds),\n  };\n}\n\nfunction buildFolderSummary(folder: ApiChatFolder): FolderSummary {\n  return {\n    ...folder,\n    orderedPinnedIds: folder.pinnedChatIds,\n    excludedChatIds: folder.excludedChatIds ? new Set(folder.excludedChatIds) : undefined,\n    includedChatIds: folder.excludedChatIds ? new Set(folder.includedChatIds) : undefined,\n    pinnedChatIds: folder.excludedChatIds ? new Set(folder.pinnedChatIds) : undefined,\n  };\n}\n\nfunction updateChats(\n  global: GlobalState,\n  areFoldersChanged: boolean,\n  areNotifyDefaultsChanged: boolean,\n  areNotifyExceptionsChanged: boolean,\n  prevAllFolderListIds?: string[],\n  prevArchivedFolderListIds?: string[],\n  prevSavedFolderListIds?: string[],\n) {\n  const newChatsById = global.chats.byId;\n  const newUsersById = global.users.byId;\n  const newAllLastMessageIds = global.chats.lastMessageIds.all;\n  const newSavedLastMessageIds = global.chats.lastMessageIds.saved;\n  const newNotifyDefaults = selectNotifyDefaults(global);\n  const newNotifyExceptions = global.chats.notifyExceptionById;\n  const folderSummaries = Object.values(prepared.folderSummariesById);\n  const affectedFolderIds = new Set<number>();\n\n  const newAllFolderListIds = global.chats.listIds.active;\n  const newArchivedFolderListIds = global.chats.listIds.archived;\n  const newSavedFolderListIds = global.chats.listIds.saved;\n\n  const newGeneralIds = [...newAllFolderListIds || [], ...newArchivedFolderListIds || []];\n  const newAllIds = [...newGeneralIds, ...newSavedFolderListIds || []];\n  let allIds = newAllIds;\n  if (newAllFolderListIds !== prevAllFolderListIds || newArchivedFolderListIds !== prevArchivedFolderListIds\n    || newSavedFolderListIds !== prevSavedFolderListIds) {\n    allIds = unique(allIds.concat(\n      prevAllFolderListIds || [], prevArchivedFolderListIds || [], prevSavedFolderListIds || [],\n    ));\n  }\n\n  allIds.forEach((chatId) => {\n    const chat = newChatsById[chatId];\n\n    if (\n      !areFoldersChanged\n      && !areNotifyDefaultsChanged\n      && !areNotifyExceptionsChanged\n      && chat === prevGlobal.chatsById[chatId]\n      && newUsersById[chatId] === prevGlobal.usersById[chatId]\n      && newAllLastMessageIds?.[chatId] === prevGlobal.lastAllMessageIds?.[chatId]\n      && newSavedLastMessageIds?.[chatId] === prevGlobal.lastSavedMessageIds?.[chatId]\n    ) {\n      return;\n    }\n\n    let newFolderIds: number[];\n    if (chat) {\n      const currentSummary = prepared.chatSummariesById.get(chatId);\n      const isRemovedFromAll = !newGeneralIds.includes(chatId);\n      const isRemovedFromSaved = !newSavedFolderListIds?.includes(chatId);\n      const newSummary = buildChatSummary(\n        global,\n        chat,\n        newNotifyDefaults,\n        newNotifyExceptions,\n        newUsersById[chatId],\n        isRemovedFromAll,\n        isRemovedFromSaved,\n      );\n\n      if (!areFoldersChanged && currentSummary && arePropsShallowEqual(newSummary, currentSummary)) {\n        return;\n      }\n\n      prepared.chatSummariesById.set(chatId, newSummary);\n\n      newFolderIds = buildChatFolderIds(newSummary, folderSummaries);\n      newFolderIds.forEach((folderId) => {\n        affectedFolderIds.add(folderId);\n      });\n    } else {\n      prepared.chatSummariesById.delete(chatId);\n      newFolderIds = [];\n    }\n\n    const currentFolderIds = prepared.folderIdsByChatId[chatId] || [];\n    if (areSortedArraysEqual(newFolderIds, currentFolderIds)) {\n      return;\n    }\n\n    const deletedFolderIds = updateListsForChat(chatId, currentFolderIds, newFolderIds);\n    deletedFolderIds.forEach((folderId) => {\n      affectedFolderIds.add(folderId);\n    });\n  });\n\n  prevGlobal.chatsById = newChatsById;\n  prevGlobal.usersById = newUsersById;\n  prevGlobal.lastAllMessageIds = newAllLastMessageIds;\n  prevGlobal.lastSavedMessageIds = newSavedLastMessageIds;\n  prevGlobal.notifyDefaults = newNotifyDefaults;\n  prevGlobal.notifyExceptions = newNotifyExceptions;\n\n  return Array.from(affectedFolderIds);\n}\n\nfunction buildChatSummary<T extends GlobalState>(\n  global: T,\n  chat: ApiChat,\n  notifyDefaults?: Record<ApiNotifyPeerType, ApiPeerNotifySettings>,\n  notifyExceptions?: Record<string, ApiPeerNotifySettings>,\n  user?: ApiUser,\n  isRemovedFromAll?: boolean,\n  isRemovedFromSaved?: boolean,\n): ChatSummary {\n  const {\n    id, type, isNotJoined, migratedTo, folderId,\n    unreadCount: chatUnreadCount, unreadMentionsCount: chatUnreadMentionsCount, hasUnreadMark,\n    isForum,\n  } = chat;\n  const isRestricted = selectIsChatRestricted(global, id);\n  const topics = selectTopics(global, chat.id);\n\n  const { unreadCount, unreadMentionsCount } = isForum\n    ? Object.values(topics || {}).reduce((acc, topic) => {\n      acc.unreadCount += topic.unreadCount;\n      acc.unreadMentionsCount += topic.unreadMentionsCount;\n\n      return acc;\n    }, { unreadCount: 0, unreadMentionsCount: 0 })\n    : { unreadCount: chatUnreadCount, unreadMentionsCount: chatUnreadMentionsCount };\n\n  const userInfo = type === 'chatTypePrivate' && user;\n  const lastMessage = selectChatLastMessage(global, chat.id);\n  const shouldHideServiceChat = chat.id === SERVICE_NOTIFICATIONS_USER_ID && (\n    !lastMessage || lastMessage.content.action?.type === 'historyClear'\n  );\n\n  const orderInAll = Math.max(chat.creationDate || 0, chat.draftDate || 0, lastMessage?.date || 0);\n\n  const lastMessageInSaved = selectChatLastMessage(global, chat.id, 'saved');\n  const orderInSaved = lastMessageInSaved?.date || 0;\n\n  return {\n    id,\n    type,\n    isListedInAll: Boolean(!isRestricted && !isNotJoined && !migratedTo && !shouldHideServiceChat && !isRemovedFromAll),\n    isListedInSaved: !isRemovedFromSaved,\n    isArchived: folderId === ARCHIVED_FOLDER_ID,\n    isMuted: getIsChatMuted(chat, notifyDefaults, notifyExceptions?.[chat.id]),\n    isUnread: Boolean(unreadCount || unreadMentionsCount || hasUnreadMark),\n    unreadCount,\n    unreadMentionsCount,\n    isUserBot: userInfo ? userInfo.type === 'userTypeBot' : undefined,\n    isUserContact: userInfo ? userInfo.isContact : undefined,\n    orderInAll,\n    orderInSaved,\n  };\n}\n\nfunction buildChatFolderIds(chatSummary: ChatSummary, folderSummaries: FolderSummary[]) {\n  return folderSummaries.reduce<number[]>((acc, folderSummary) => {\n    if (isChatInFolder(chatSummary, folderSummary)) {\n      acc.push(folderSummary.id);\n    }\n\n    return acc;\n  }, []).sort();\n}\n\nfunction isChatInFolder(\n  chatSummary: ChatSummary,\n  folderSummary: FolderSummary,\n) {\n  const isListed = folderSummary.id === SAVED_FOLDER_ID ? chatSummary.isListedInSaved : chatSummary.isListedInAll;\n  if (!isListed) {\n    return false;\n  }\n\n  const { id: chatId, type } = chatSummary;\n\n  if (folderSummary.listIds) {\n    if (\n      (chatSummary.isArchived && folderSummary.id === ALL_FOLDER_ID)\n      || (!chatSummary.isArchived && folderSummary.id === ARCHIVED_FOLDER_ID)\n    ) {\n      return false;\n    }\n\n    return folderSummary.listIds.has(chatId);\n  }\n\n  if (folderSummary.excludedChatIds?.has(chatId)) {\n    return false;\n  }\n\n  if (folderSummary.includedChatIds?.has(chatId)) {\n    return true;\n  }\n\n  if (folderSummary.pinnedChatIds?.has(chatId)) {\n    return true;\n  }\n\n  if (folderSummary.excludeArchived && chatSummary.isArchived) {\n    return false;\n  }\n\n  if (folderSummary.excludeRead && !chatSummary.isUnread) {\n    return false;\n  }\n\n  if (folderSummary.excludeMuted && chatSummary.isMuted && !chatSummary.unreadMentionsCount) {\n    return false;\n  }\n\n  if (type === 'chatTypePrivate') {\n    if (chatSummary.isUserBot) {\n      if (folderSummary.bots) {\n        return true;\n      }\n    } else {\n      if (folderSummary.contacts && chatSummary.isUserContact) {\n        return true;\n      }\n\n      if (folderSummary.nonContacts && !chatSummary.isUserContact) {\n        return true;\n      }\n    }\n  } else if (type === 'chatTypeChannel') {\n    return Boolean(folderSummary.channels);\n  } else if (type === 'chatTypeBasicGroup' || type === 'chatTypeSuperGroup') {\n    return Boolean(folderSummary.groups);\n  }\n\n  return false;\n}\n\nfunction updateListsForChat(chatId: string, currentFolderIds: number[], newFolderIds: number[]) {\n  const currentFolderIdsSet = new Set(currentFolderIds);\n  const newFolderIdsSet = new Set(newFolderIds);\n  const deletedFolderIds: number[] = [];\n\n  unique([...currentFolderIds, ...newFolderIds]).forEach((folderId) => {\n    let currentFolderOrderedIds = results.orderedIdsByFolderId[folderId];\n\n    if (currentFolderIdsSet.has(folderId) && !newFolderIdsSet.has(folderId)) {\n      prepared.chatIdsByFolderId[folderId]!.delete(chatId);\n\n      deletedFolderIds.push(folderId);\n\n      if (currentFolderOrderedIds) {\n        currentFolderOrderedIds = currentFolderOrderedIds.filter((id) => id !== chatId);\n        prepared.isOrderedListJustPatched[folderId] = true;\n      }\n    } else if (!currentFolderIdsSet.has(folderId) && newFolderIdsSet.has(folderId)) {\n      if (!prepared.chatIdsByFolderId[folderId]) {\n        prepared.chatIdsByFolderId[folderId] = new Set();\n      }\n\n      prepared.chatIdsByFolderId[folderId].add(chatId);\n\n      if (currentFolderOrderedIds) {\n        currentFolderOrderedIds.push(chatId);\n        prepared.isOrderedListJustPatched[folderId] = true;\n      }\n    }\n\n    results.orderedIdsByFolderId[folderId] = currentFolderOrderedIds;\n  });\n\n  prepared.folderIdsByChatId[chatId] = newFolderIds;\n\n  return deletedFolderIds;\n}\n\nfunction updateResults(affectedFolderIds: number[]) {\n  let wasUnreadCountersChanged = false;\n  let wasChatsCountChanged = false;\n  let wasUnreadChatsChanged = false;\n\n  Array.from(affectedFolderIds).forEach((folderId) => {\n    const { pinnedCount: newPinnedCount, orderedIds: newOrderedIds } = buildFolderOrderedIds(folderId);\n    // When signed out\n    if (!newOrderedIds) {\n      return;\n    }\n\n    const currentOrderedIds = results.orderedIdsByFolderId[folderId];\n    const currentPinnedCount = results.pinnedCountByFolderId[folderId];\n    const areOrderedIdsChanged = (\n      !currentOrderedIds\n      || currentPinnedCount === undefined || currentPinnedCount !== newPinnedCount\n      || prepared.isOrderedListJustPatched[folderId]\n      || !areSortedArraysEqual(newOrderedIds, currentOrderedIds)\n    );\n    if (areOrderedIdsChanged) {\n      prepared.isOrderedListJustPatched[folderId] = false;\n      results.orderedIdsByFolderId[folderId] = newOrderedIds;\n      results.pinnedCountByFolderId[folderId] = newPinnedCount;\n      callbacks.orderedIdsByFolderId[folderId]?.runCallbacks(newOrderedIds);\n    }\n\n    const currentChatsCount = results.chatsCountByFolderId[folderId];\n    const newChatsCount = newOrderedIds.length;\n    if (!wasChatsCountChanged) {\n      wasChatsCountChanged = currentChatsCount !== newChatsCount;\n    }\n    results.chatsCountByFolderId[folderId] = newChatsCount;\n\n    const currentUnreadCounters = results.unreadCountersByFolderId[folderId];\n    const newUnreadCounters = buildFolderUnreadCounters(folderId);\n    if (!wasUnreadCountersChanged) {\n      wasUnreadCountersChanged = (\n        !currentUnreadCounters || !arePropsShallowEqual(newUnreadCounters, currentUnreadCounters)\n      );\n    }\n    results.unreadCountersByFolderId[folderId] = newUnreadCounters;\n\n    const currentUnreadChats = results.unreadChatIdsByFolderId[folderId];\n    const newUnreadChats = buildFolderByUnreadChats(folderId);\n    if (!wasUnreadChatsChanged) {\n      wasUnreadChatsChanged = (\n        !currentUnreadChats || !areSortedArraysEqual(newUnreadChats, currentUnreadChats)\n      );\n    }\n    results.unreadChatIdsByFolderId[folderId] = newUnreadChats;\n  });\n\n  if (wasChatsCountChanged) {\n    // We need to update the entire object as it will be returned from a hook\n    const newValue = { ...results.chatsCountByFolderId };\n    results.chatsCountByFolderId = newValue;\n    callbacks.chatsCountByFolderId.runCallbacks(newValue);\n  }\n\n  if (wasUnreadCountersChanged) {\n    // We need to update the entire object as it will be returned from a hook\n    const newValue = { ...results.unreadCountersByFolderId };\n    results.unreadCountersByFolderId = newValue;\n    callbacks.unreadCountersByFolderId.runCallbacks(newValue);\n  }\n\n  if (wasUnreadChatsChanged) {\n    callbacks.unreadChatIdsByFolderId.runCallbacks(results.unreadChatIdsByFolderId);\n  }\n}\n\nfunction buildFolderOrderedIds(folderId: number) {\n  const folderSummary = prepared.folderSummariesById[folderId];\n  if (!folderSummary) {\n    return {};\n  }\n\n  const { orderedPinnedIds, pinnedChatIds } = folderSummary;\n  const {\n    chatIdsByFolderId: { [folderId]: chatIds },\n  } = prepared;\n  const {\n    orderedIdsByFolderId: { [folderId]: prevOrderedIds },\n  } = results;\n\n  const isSavedFolder = folderId === SAVED_FOLDER_ID;\n\n  const sortedPinnedIds = chatIds ? orderedPinnedIds?.filter((id) => chatIds.has(id)) : orderedPinnedIds;\n  const allListIds = prevOrderedIds || (chatIds && Array.from(chatIds)) || [];\n  const notPinnedIds = pinnedChatIds ? allListIds.filter((id) => !pinnedChatIds.has(id)) : allListIds;\n  const sortedNotPinnedIds = notPinnedIds.sort((chatId1: string, chatId2: string) => {\n    return getOrderKey(chatId2, isSavedFolder) - getOrderKey(chatId1, isSavedFolder);\n  });\n\n  return {\n    pinnedCount: sortedPinnedIds?.length || 0,\n    orderedIds: [\n      ...(sortedPinnedIds || []),\n      ...sortedNotPinnedIds,\n    ],\n  };\n}\n\nfunction buildFolderUnreadCounters(folderId: number) {\n  const {\n    chatSummariesById,\n  } = prepared;\n  const {\n    orderedIdsByFolderId: { [folderId]: orderedIds },\n  } = results;\n\n  return orderedIds!.reduce((newUnreadCounters, chatId) => {\n    const chatSummary = chatSummariesById.get(chatId);\n    if (!chatSummary) {\n      return newUnreadCounters;\n    }\n\n    if (chatSummary.isUnread) {\n      newUnreadCounters.chatsCount++;\n\n      if (chatSummary.unreadMentionsCount) {\n        newUnreadCounters.notificationsCount += chatSummary.unreadMentionsCount;\n      }\n\n      if (!chatSummary.isMuted) {\n        if (chatSummary.unreadCount) {\n          newUnreadCounters.notificationsCount += chatSummary.unreadCount;\n        } else if (!chatSummary.unreadMentionsCount) {\n          newUnreadCounters.notificationsCount += 1; // Manually marked unread\n        }\n      }\n    }\n\n    return newUnreadCounters;\n  }, {\n    chatsCount: 0,\n    notificationsCount: 0,\n  });\n}\n\nfunction buildFolderByUnreadChats(folderId: number) {\n  const { chatSummariesById } = prepared;\n  const { orderedIdsByFolderId: { [folderId]: orderedIds } } = results;\n\n  return orderedIds!.filter((chatId) => {\n    const chatSummary = chatSummariesById.get(chatId);\n    return chatSummary?.isUnread;\n  });\n}\n\nfunction buildInitials() {\n  return {\n    prevGlobal: {\n      foldersById: {},\n      chatsById: {},\n      usersById: {},\n      topicsInfoById: {},\n    },\n\n    prepared: {\n      folderSummariesById: {},\n      chatSummariesById: new Map(),\n      folderIdsByChatId: {},\n      chatIdsByFolderId: {},\n      isOrderedListJustPatched: {},\n    },\n\n    results: {\n      orderedIdsByFolderId: {},\n      pinnedCountByFolderId: {},\n      chatsCountByFolderId: {},\n      unreadCountersByFolderId: {},\n      unreadChatIdsByFolderId: {},\n    },\n\n    callbacks: {\n      orderedIdsByFolderId: {},\n      chatsCountByFolderId: createCallbackManager(),\n      unreadCountersByFolderId: createCallbackManager(),\n      unreadChatIdsByFolderId: createCallbackManager(),\n    },\n  };\n}\n\nfunction reset() {\n  const newInitials = buildInitials();\n\n  prevGlobal = newInitials.prevGlobal;\n  prepared = newInitials.prepared;\n  results = newInitials.results;\n  callbacks = newInitials.callbacks;\n}\n","import { DEBUG_MORE } from '../config';\nimport { handleError } from './handleError';\n\nconst SAFE_EXEC_ENABLED = !DEBUG_MORE;\n\ntype SafeExecOptions = {\n  rescue?: (err: Error) => void;\n  always?: NoneToVoidFunction;\n  shouldIgnoreError?: boolean;\n};\n\nexport default function safeExec<T extends AnyFunction>(cb: T, options?: SafeExecOptions): ReturnType<T> | undefined {\n  if (!SAFE_EXEC_ENABLED) {\n    return cb();\n  }\n\n  const { rescue, always, shouldIgnoreError } = options ?? {};\n\n  try {\n    return cb();\n  } catch (err: any) {\n    rescue?.(err);\n    if (!shouldIgnoreError) {\n      handleError(err);\n    }\n    return undefined;\n  } finally {\n    always?.();\n  }\n}\n","import { IS_IOS, IS_WINDOWS } from './browser/windowEnvironment';\nimport { Lethargy } from './lethargy';\nimport { clamp, round } from './math';\nimport { debounce } from './schedulers';\nimport windowSize from './windowSize';\n\nexport enum SwipeDirection {\n  Up,\n  Down,\n  Left,\n  Right,\n}\n\nexport interface MoveOffsets {\n  dragOffsetX: number;\n  dragOffsetY: number;\n}\n\ninterface CaptureOptions {\n  onCapture?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onRelease?: (e: MouseEvent | TouchEvent | WheelEvent) => void;\n  onDrag?: (\n    e: MouseEvent | TouchEvent | WheelEvent,\n    captureEvent: MouseEvent | TouchEvent | WheelEvent,\n    offsets: MoveOffsets,\n    cancelDrag?: (x: boolean, y: boolean) => void,\n  ) => void;\n  onSwipe?: (e: Event, direction: SwipeDirection, offsets: MoveOffsets) => boolean;\n  onZoom?: (e: TouchEvent | WheelEvent, params: {\n    // Absolute zoom level\n    zoom?: number;\n    // Relative zoom factor\n    zoomFactor?: number;\n\n    // center coordinate of the initial pinch\n    initialCenterX: number;\n    initialCenterY: number;\n\n    // offset of the pinch center (current from initial)\n    dragOffsetX: number;\n    dragOffsetY: number;\n\n    // center coordinate of the current pinch\n    currentCenterX: number;\n    currentCenterY: number;\n  }) => void;\n  onClick?: (e: MouseEvent | TouchEvent) => void;\n  onDoubleClick?: (e: MouseEvent | RealTouchEvent | WheelEvent, params: { centerX: number; centerY: number }) => void;\n  excludedClosestSelector?: string;\n  includedClosestSelector?: string;\n  selectorToPreventScroll?: string;\n  withNativeDrag?: boolean;\n  maxZoom?: number;\n  minZoom?: number;\n  doubleTapZoom?: number;\n  initialZoom?: number;\n  isNotPassive?: boolean;\n  withCursor?: boolean;\n  swipeThreshold?: number;\n  withWheelDrag?: boolean;\n}\n\n// https://stackoverflow.com/questions/11287877/how-can-i-get-e-offsetx-on-mobile-ipad\n// Android does not have this value, and iOS has it but as read-only\nexport interface RealTouchEvent extends TouchEvent {\n  pageX?: number;\n  pageY?: number;\n}\n\ntype TSwipeAxis =\n  'x'\n  | 'y'\n  | undefined;\n\nexport const IOS_SCREEN_EDGE_THRESHOLD = 20;\nexport const SWIPE_DIRECTION_THRESHOLD = 10;\nexport const SWIPE_DIRECTION_TOLERANCE = 1.5;\n\nconst MOVE_THRESHOLD = 15;\nconst SWIPE_THRESHOLD_DEFAULT = 20;\nconst RELEASE_WHEEL_ZOOM_DELAY = 150;\nconst RELEASE_WHEEL_DRAG_DELAY = 150;\n\nfunction getDistance(a: Touch, b?: Touch) {\n  if (!b) return 0;\n  return Math.hypot((b.pageX - a.pageX), (b.pageY - a.pageY));\n}\n\nfunction getTouchCenter(a: Touch, b: Touch) {\n  return {\n    x: (a.pageX + b.pageX) / 2,\n    y: (a.pageY + b.pageY) / 2,\n  };\n}\n\nlet lastClickTime = 0;\nconst lethargy = new Lethargy({\n  stability: 5,\n  sensitivity: 25,\n  tolerance: IS_WINDOWS ? 1 : 0.6, // Windows `scrollDelta` does not die down to 0\n  delay: 150,\n});\n\nexport function captureEvents(element: HTMLElement, options: CaptureOptions) {\n  let captureEvent: MouseEvent | RealTouchEvent | WheelEvent | undefined;\n  let hasMoved = false;\n  let hasSwiped = false;\n  let isZooming = false;\n  let initialDistance = 0;\n  let wheelZoom = options.initialZoom ?? 1;\n  let initialDragOffset = {\n    x: 0,\n    y: 0,\n  };\n  let isDragCanceled = {\n    x: false,\n    y: false,\n  };\n  const currentWindowSize = windowSize.get();\n  let initialTouchCenter = {\n    x: currentWindowSize.width / 2,\n    y: currentWindowSize.height / 2,\n  };\n  let initialSwipeAxis: TSwipeAxis | undefined;\n  const minZoom = options.minZoom ?? 1;\n  const maxZoom = options.maxZoom ?? 4;\n\n  let isNearEdge = false;\n\n  function onCapture(e: MouseEvent | RealTouchEvent) {\n    const target = e.target as HTMLElement;\n    const {\n      excludedClosestSelector,\n      includedClosestSelector,\n      withNativeDrag,\n      withCursor,\n      onDrag,\n    } = options;\n\n    if (element !== target && !element.contains(target)) {\n      return;\n    }\n\n    if (target.tagName === 'INPUT' || target.tagName === 'TEXTAREA') {\n      return;\n    }\n\n    if (\n      (excludedClosestSelector && (target.matches(excludedClosestSelector) || target.closest(excludedClosestSelector)))\n      || (\n        includedClosestSelector && !(target.matches(includedClosestSelector) || target.closest(includedClosestSelector))\n      )\n    ) {\n      return;\n    }\n\n    captureEvent = e;\n\n    if (e.type === 'mousedown') {\n      if (!withNativeDrag && onDrag) {\n        e.preventDefault();\n      }\n\n      document.addEventListener('mousemove', onMove);\n      document.addEventListener('mouseup', onRelease);\n    } else if (e.type === 'touchstart') {\n      if (IS_IOS) {\n        const x = (e as RealTouchEvent).touches[0].pageX;\n        isNearEdge = x <= IOS_SCREEN_EDGE_THRESHOLD || x >= windowSize.get().width - IOS_SCREEN_EDGE_THRESHOLD;\n      }\n\n      // We need to always listen on `touchstart` target:\n      // https://stackoverflow.com/questions/33298828/touch-move-event-dont-fire-after-touch-start-target-is-removed\n      target.addEventListener('touchmove', onMove, { passive: true });\n      target.addEventListener('touchend', onRelease, { passive: true });\n      target.addEventListener('touchcancel', onRelease, { passive: true });\n\n      if ('touches' in e) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (e.touches.length === 2) {\n          initialDistance = getDistance(e.touches[0], e.touches[1]);\n          initialTouchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n        }\n      }\n    }\n\n    if (withCursor) {\n      document.body.classList.add('cursor-grabbing');\n    }\n\n    options.onCapture?.(e);\n  }\n\n  function onRelease(e?: MouseEvent | TouchEvent) {\n    if (captureEvent) {\n      if (options.withCursor) {\n        document.body.classList.remove('cursor-grabbing');\n      }\n\n      document.removeEventListener('mouseup', onRelease);\n      document.removeEventListener('mousemove', onMove);\n      (captureEvent.target as HTMLElement).removeEventListener('touchcancel', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchend', onRelease);\n      (captureEvent.target as HTMLElement).removeEventListener('touchmove', onMove);\n\n      if (IS_IOS && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = '';\n          });\n      }\n\n      if (e) {\n        if (hasMoved) {\n          if (options.onRelease) {\n            options.onRelease(e);\n          }\n        } else if (e.type === 'mouseup') {\n          if (options.onDoubleClick && Date.now() - lastClickTime < 300) {\n            options.onDoubleClick(e, {\n              centerX: captureEvent.pageX!,\n              centerY: captureEvent.pageY!,\n            });\n          } else if (options.onClick && (!('button' in e) || e.button === 0)) {\n            options.onClick(e);\n          }\n          lastClickTime = Date.now();\n        }\n      }\n    }\n\n    hasMoved = false;\n    hasSwiped = false;\n    isZooming = false;\n    initialDistance = 0;\n    wheelZoom = clamp(wheelZoom, minZoom, maxZoom);\n    initialSwipeAxis = undefined;\n    initialDragOffset = {\n      x: 0,\n      y: 0,\n    };\n    isDragCanceled = {\n      x: false,\n      y: false,\n    };\n    const newWindowSize = windowSize.get();\n    initialTouchCenter = {\n      x: newWindowSize.width / 2,\n      y: newWindowSize.height / 2,\n    };\n    captureEvent = undefined;\n    isNearEdge = false;\n  }\n\n  function onMove(e: MouseEvent | RealTouchEvent) {\n    if (captureEvent) {\n      if (e.type === 'touchmove' && ('touches' in e)) {\n        if (e.pageX === undefined) {\n          e.pageX = e.touches[0].pageX;\n        }\n\n        if (e.pageY === undefined) {\n          e.pageY = e.touches[0].pageY;\n        }\n\n        if (options.onZoom && initialDistance > 0 && e.touches.length === 2) {\n          const endDistance = getDistance(e.touches[0], e.touches[1]);\n          const touchCenter = getTouchCenter(e.touches[0], e.touches[1]);\n          const dragOffsetX = touchCenter.x - initialTouchCenter.x;\n          const dragOffsetY = touchCenter.y - initialTouchCenter.y;\n          const zoomFactor = endDistance / initialDistance;\n          options.onZoom(e, {\n            zoomFactor,\n            initialCenterX: initialTouchCenter.x,\n            initialCenterY: initialTouchCenter.y,\n            dragOffsetX,\n            dragOffsetY,\n            currentCenterX: touchCenter.x,\n            currentCenterY: touchCenter.y,\n          });\n          if (zoomFactor !== 1) hasMoved = true;\n        }\n      }\n\n      const dragOffsetX = e.pageX! - captureEvent.pageX!;\n      const dragOffsetY = e.pageY! - captureEvent.pageY!;\n\n      if (Math.abs(dragOffsetX) >= MOVE_THRESHOLD || Math.abs(dragOffsetY) >= MOVE_THRESHOLD) {\n        hasMoved = true;\n      }\n\n      let shouldPreventScroll = false;\n\n      if (options.onDrag) {\n        options.onDrag(e, captureEvent, {\n          dragOffsetX,\n          dragOffsetY,\n        });\n        shouldPreventScroll = true;\n      }\n\n      if (options.onSwipe && !hasSwiped) {\n        hasSwiped = onSwipe(e, dragOffsetX, dragOffsetY);\n        shouldPreventScroll = hasSwiped;\n      }\n\n      if (IS_IOS && shouldPreventScroll && options.selectorToPreventScroll) {\n        Array.from(document.querySelectorAll<HTMLElement>(options.selectorToPreventScroll))\n          .forEach((scrollable) => {\n            scrollable.style.overflow = 'hidden';\n          });\n      }\n    }\n  }\n\n  function onSwipe(e: MouseEvent | RealTouchEvent, dragOffsetX: number, dragOffsetY: number) {\n    if (IS_IOS && isNearEdge) {\n      return false;\n    }\n\n    const xAbs = Math.abs(dragOffsetX);\n    const yAbs = Math.abs(dragOffsetY);\n    const threshold = options.swipeThreshold ?? SWIPE_THRESHOLD_DEFAULT;\n\n    let axis: TSwipeAxis | undefined;\n    if (xAbs > yAbs && xAbs >= threshold) {\n      axis = 'x';\n    } else if (yAbs > xAbs && yAbs >= threshold) {\n      axis = 'y';\n    }\n\n    if (!axis) {\n      return false;\n    }\n\n    if (!initialSwipeAxis) {\n      initialSwipeAxis = axis;\n    } else if (initialSwipeAxis !== axis) {\n      // Prevent horizontal swipe after vertical to prioritize scroll\n      return false;\n    }\n\n    return processSwipe(e, axis, dragOffsetX, dragOffsetY, options.onSwipe!);\n  }\n\n  const releaseWheelDrag = debounce(onRelease, RELEASE_WHEEL_DRAG_DELAY, false);\n  const releaseWheelZoom = debounce(onRelease, RELEASE_WHEEL_ZOOM_DELAY, false);\n\n  function onWheelCapture(e: WheelEvent) {\n    if (hasMoved) return;\n    onCapture(e);\n    hasMoved = true;\n    initialTouchCenter = { x: e.x, y: e.y };\n  }\n\n  function onWheelZoom(e: WheelEvent) {\n    if (!options.onZoom) return;\n    onWheelCapture(e);\n    const dragOffsetX = e.x - initialTouchCenter.x;\n    const dragOffsetY = e.y - initialTouchCenter.y;\n    const delta = clamp(e.deltaY, -25, 25);\n    wheelZoom -= delta * 0.01;\n    wheelZoom = clamp(wheelZoom, minZoom * 0.5, maxZoom * 3);\n    isZooming = true;\n    options.onZoom(e, {\n      zoom: round(wheelZoom, 2),\n      initialCenterX: initialTouchCenter.x,\n      initialCenterY: initialTouchCenter.y,\n      dragOffsetX,\n      dragOffsetY,\n      currentCenterX: e.x,\n      currentCenterY: e.y,\n    });\n    releaseWheelZoom(e);\n  }\n\n  function onWheelDrag(e: WheelEvent) {\n    if (!options.onDrag) return;\n    onWheelCapture(e);\n    // Ignore wheel inertia if drag is canceled in this direction\n    if (!isDragCanceled.x || Math.sign(initialDragOffset.x) === Math.sign(e.deltaX)) {\n      initialDragOffset.x -= e.deltaX;\n    }\n    if (!isDragCanceled.y || Math.sign(initialDragOffset.y) === Math.sign(e.deltaY)) {\n      initialDragOffset.y -= e.deltaY;\n    }\n    const { x, y } = initialDragOffset;\n    options.onDrag(e, captureEvent!, {\n      dragOffsetX: x,\n      dragOffsetY: y,\n    }, (dx, dy) => {\n      isDragCanceled = { x: dx, y: dy };\n    });\n    releaseWheelDrag(e);\n  }\n\n  function onWheel(e: WheelEvent) {\n    if (!options.onZoom && !options.onDrag) return;\n    if (options.excludedClosestSelector && (\n      (e.target as HTMLElement).matches(options.excludedClosestSelector)\n      || (e.target as HTMLElement).closest(options.excludedClosestSelector)\n    )) {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    const { doubleTapZoom = 3 } = options;\n    if (options.onDoubleClick && Object.is(e.deltaX, -0) && Object.is(e.deltaY, -0) && e.ctrlKey) {\n      onWheelCapture(e);\n      wheelZoom = wheelZoom > 1 ? 1 : doubleTapZoom;\n      options.onDoubleClick(e, { centerX: e.pageX, centerY: e.pageY });\n      hasMoved = false;\n      return;\n    }\n    const metaKeyPressed = e.metaKey || e.ctrlKey || e.shiftKey;\n    if (metaKeyPressed) {\n      onWheelZoom(e);\n    }\n    if (!metaKeyPressed && !isZooming) {\n      // Check if this event produced by user scroll and not by inertia\n      const isUserEvent = lethargy.check(e);\n      if (wheelZoom !== 1 || isUserEvent) {\n        onWheelDrag(e);\n      }\n    }\n  }\n\n  if (options.withWheelDrag) {\n    element.addEventListener('wheel', onWheel);\n  }\n\n  element.addEventListener('mousedown', onCapture);\n  document.body.addEventListener('touchstart', onCapture, { passive: !options.isNotPassive });\n\n  return () => {\n    onRelease();\n    document.body.removeEventListener('touchstart', onCapture);\n    element.removeEventListener('mousedown', onCapture);\n    element.removeEventListener('wheel', onWheel);\n  };\n}\n\nfunction processSwipe(\n  e: Event,\n  currentSwipeAxis: TSwipeAxis,\n  dragOffsetX: number,\n  dragOffsetY: number,\n  onSwipe: (e: Event, direction: SwipeDirection, offsets: MoveOffsets) => boolean,\n) {\n  const offsets = { dragOffsetX, dragOffsetY };\n\n  if (currentSwipeAxis === 'x') {\n    if (dragOffsetX < 0) {\n      return onSwipe(e, SwipeDirection.Left, offsets);\n    } else {\n      return onSwipe(e, SwipeDirection.Right, offsets);\n    }\n  } else if (currentSwipeAxis === 'y') {\n    if (dragOffsetY < 0) {\n      return onSwipe(e, SwipeDirection.Up, offsets);\n    } else {\n      return onSwipe(e, SwipeDirection.Down, offsets);\n    }\n  }\n\n  return false;\n}\n","/**\n * Lethargy help distinguish between scroll events initiated by the user, and those by inertial scrolling.\n * Lethargy does not have external dependencies.\n *\n * @param stability - Specifies the length of the rolling average.\n * In effect, the larger the value, the smoother the curve will be.\n * This attempts to prevent anomalies from firing 'real' events. Valid values are all positive integers,\n * but in most cases, you would need to stay between 5 and around 30.\n *\n * @param sensitivity - Specifies the minimum value for wheelDelta for it to register as a valid scroll event.\n * Because the tail of the curve have low wheelDelta values,\n * this will stop them from registering as valid scroll events.\n * The unofficial standard wheelDelta is 120, so valid values are positive integers below 120.\n *\n * @param tolerance - Prevent small fluctuations from affecting results.\n * Valid values are decimals from 0, but should ideally be between 0.05 and 0.3.\n *\n * Based on https://github.com/d4nyll/lethargy\n */\n\nexport type LethargyConfig = {\n  stability?: number;\n  sensitivity?: number;\n  tolerance?: number;\n  delay?: number;\n};\n\nexport class Lethargy {\n  stability: number;\n\n  sensitivity: number;\n\n  tolerance: number;\n\n  delay: number;\n\n  lastUpDeltas: Array<number>;\n\n  lastDownDeltas: Array<number>;\n\n  deltasTimestamp: Array<number>;\n\n  constructor({\n    stability = 8,\n    sensitivity = 100,\n    tolerance = 1.1,\n    delay = 150,\n  }: LethargyConfig = {}) {\n    this.stability = stability;\n    this.sensitivity = sensitivity;\n    this.tolerance = tolerance;\n    this.delay = delay;\n    this.lastUpDeltas = new Array(this.stability * 2).fill(0);\n    this.lastDownDeltas = new Array(this.stability * 2).fill(0);\n    this.deltasTimestamp = new Array(this.stability * 2).fill(0);\n  }\n\n  check(e: any) {\n    let lastDelta;\n    e = e.originalEvent || e;\n    if (e.wheelDelta !== undefined) {\n      lastDelta = e.wheelDelta;\n    } else if (e.deltaY !== undefined) {\n      lastDelta = e.deltaY * -40;\n    } else if (e.detail !== undefined || e.detail === 0) {\n      lastDelta = e.detail * -40;\n    }\n    this.deltasTimestamp.push(Date.now());\n    this.deltasTimestamp.shift();\n    if (lastDelta > 0) {\n      this.lastUpDeltas.push(lastDelta);\n      this.lastUpDeltas.shift();\n      return this.isInertia(1);\n    } else {\n      this.lastDownDeltas.push(lastDelta);\n      this.lastDownDeltas.shift();\n      return this.isInertia(-1);\n    }\n  }\n\n  isInertia(direction: number) {\n    const lastDeltas = direction === -1 ? this.lastDownDeltas : this.lastUpDeltas;\n    if (lastDeltas[0] === undefined) return direction;\n    if (\n      this.deltasTimestamp[this.stability * 2 - 2] + this.delay > Date.now()\n      && lastDeltas[0] === lastDeltas[this.stability * 2 - 1]\n    ) {\n      return false;\n    }\n    const lastDeltasOld = lastDeltas.slice(0, this.stability);\n    const lastDeltasNew = lastDeltas.slice(this.stability, this.stability * 2);\n    const oldSum = lastDeltasOld.reduce((t, s) => t + s);\n    const newSum = lastDeltasNew.reduce((t, s) => t + s);\n    const oldAverage = oldSum / lastDeltasOld.length;\n    const newAverage = newSum / lastDeltasNew.length;\n    return Math.abs(oldAverage) <= Math.abs(newAverage * this.tolerance)\n      && this.sensitivity < Math.abs(newAverage);\n  }\n}\n","import { useRef, useState } from '../lib/teact/teact';\n\nimport buildClassName from '../util/buildClassName';\n\nconst CLOSE_DURATION = 350;\n\nconst useShowTransitionDeprecated = (\n  isOpen = false,\n  onCloseTransitionEnd?: () => void,\n  noFirstOpenTransition = false,\n  className: string | false = 'fast',\n  noCloseTransition = false,\n  closeDuration = CLOSE_DURATION,\n  noOpenTransition = false,\n) => {\n  const [isClosed, setIsClosed] = useState(!isOpen);\n  const closeTimeoutRef = useRef<number>();\n  // SS class should be added in a separate tick to turn on CSS transition.\n  const [hasOpenClassName, setHasOpenClassName] = useState(isOpen && noFirstOpenTransition);\n\n  if (isOpen) {\n    setIsClosed(false);\n    setHasOpenClassName(true);\n\n    if (closeTimeoutRef.current) {\n      window.clearTimeout(closeTimeoutRef.current);\n\n      closeTimeoutRef.current = undefined;\n    }\n  } else {\n    setHasOpenClassName(false);\n\n    if (!isClosed && !closeTimeoutRef.current) {\n      const exec = () => {\n        setIsClosed(true);\n\n        if (onCloseTransitionEnd) {\n          onCloseTransitionEnd();\n        }\n\n        closeTimeoutRef.current = undefined;\n      };\n\n      if (noCloseTransition) {\n        exec();\n      } else {\n        closeTimeoutRef.current = window.setTimeout(exec, closeDuration);\n      }\n    }\n  }\n\n  // `noCloseTransition`, when set to true, should remove the open class immediately\n  const shouldHaveOpenClassName = (hasOpenClassName && !(noCloseTransition && !isOpen)) || (noOpenTransition && isOpen);\n  const isClosing = Boolean(closeTimeoutRef.current);\n  const shouldRender = isOpen || isClosing;\n  const transitionClassNames = buildClassName(\n    className && 'opacity-transition',\n    className,\n    shouldHaveOpenClassName && 'open',\n    !shouldHaveOpenClassName && 'not-open',\n    shouldRender && 'shown',\n    !shouldRender && 'not-shown',\n    isClosing && 'closing',\n  );\n\n  return {\n    shouldRender,\n    transitionClassNames,\n    hasShownClass: shouldRender,\n    hasOpenClass: shouldHaveOpenClassName,\n    isClosing,\n  };\n};\n\nexport default useShowTransitionDeprecated;\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"W4ndaFuS\",\"contentBox\":\"qIESjPFU\",\"textContent\":\"cgQoy2xy\",\"hasFullContent\":\"x0D811xX\",\"inlineWrapper\":\"CrZTrncJ\",\"singleLine\":\"j1bGIpWD\",\"strong\":\"d5ep97lr\",\"messageLink\":\"Soqky8rY\",\"noEllipsis\":\"m6kJl7zG\",\"contextContainer\":\"Rz1leKMF\",\"fluidMultiline\":\"oL3NoM4Y\",\"fluidBackground\":\"faqkTF52\",\"info\":\"Jcta1qBG\",\"stickerWrapper\":\"F8w9vDlr\",\"channelPhoto\":\"wnjg6GZj\",\"suggestedAvatar\":\"ClHX4zX1\",\"suggestedText\":\"jT6o01vL\",\"actionButton\":\"LB5i9s3a\",\"title\":\"Cp_BJqe5\",\"subtitle\":\"VCJyqpS8\",\"starGift\":\"lcncBNHa\",\"uniqueGift\":\"jxcv_A2w\",\"uniqueBackgroundWrapper\":\"lsTgPDw1\",\"uniqueBackground\":\"uzTnIOE7\",\"uniqueValue\":\"pae10ItJ\",\"suggestedPostContainer\":\"eNm2vJJr\",\"suggestedPostTitle\":\"mp_JlS2o\",\"suggestedPostInfo\":\"S5yKhYOF\",\"suggestedPostBalanceTooLowBox\":\"lYK4izyG\",\"suggestedPostRejectedContentBox\":\"b_UHz9Pn\",\"suggestedPostContentBox\":\"HiG8V3U2\",\"hoverable\":\"Ohq5zfvI\",\"suggestedPostBalanceTooLowTitle\":\"v8H6hMhz\",\"suggestedPostApprovalTitle\":\"sx65zyR6\",\"suggestedPostApprovalSection\":\"jmVfnkV0\",\"suggestedPostRejectedComment\":\"hrUNI578\",\"suggestedPostRejectedTitle\":\"xm2OfRXs\",\"rejectedIcon\":\"PnwAfQgJ\",\"botForumTopicIcon\":\"ij_pghAu\",\"botForumTopicTitle\":\"erNpymQv\",\"botForumTopicDescription\":\"YCG0hIsn\",\"botForumTopicArrow\":\"vUUWoZOQ\"};","exports.endianness = function () { return 'LE' };\n\nexports.hostname = function () {\n    if (typeof location !== 'undefined') {\n        return location.hostname\n    }\n    else return '';\n};\n\nexports.loadavg = function () { return [] };\n\nexports.uptime = function () { return 0 };\n\nexports.freemem = function () {\n    return Number.MAX_VALUE;\n};\n\nexports.totalmem = function () {\n    return Number.MAX_VALUE;\n};\n\nexports.cpus = function () { return [] };\n\nexports.type = function () { return 'Browser' };\n\nexports.release = function () {\n    if (typeof navigator !== 'undefined') {\n        return navigator.appVersion;\n    }\n    return '';\n};\n\nexports.networkInterfaces\n= exports.getNetworkInterfaces\n= function () { return {} };\n\nexports.arch = function () { return 'javascript' };\n\nexports.platform = function () { return 'browser' };\n\nexports.tmpdir = exports.tmpDir = function () {\n    return '/tmp';\n};\n\nexports.EOL = '\\n';\n\nexports.homedir = function () {\n\treturn '/'\n};\n","import { addExtraClass } from '../../lib/teact/teact-dom';\n\nimport { requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { removeVS16s } from '../../lib/twemojiRegex';\nimport withCache from '../withCache';\n\n// Due to the fact that emoji from Apple do not contain some characters, it is necessary to remove them from emoji-data\n// https://github.com/iamcal/emoji-data/issues/136\nconst EXCLUDE_EMOJIS = ['female_sign', 'male_sign', 'medical_symbol'];\n\nconst ISO_FLAGS_OFFSET = 127397;\n\nexport type EmojiRawData = typeof import('emoji-data-ios/emoji-data.json');\nexport type EmojiModule = { default: EmojiRawData };\n\nexport type EmojiData = {\n  categories: Array<EmojiCategory>;\n  emojis: Record<string, Emoji>;\n};\n\nfunction unifiedToNative(unified: string) {\n  const unicodes = unified.split('-');\n  const codePoints = unicodes.map((i) => parseInt(i, 16));\n\n  return String.fromCodePoint(...codePoints);\n}\n\nexport const LOADED_EMOJIS = new Set<string>();\n\nexport function handleEmojiLoad(event: React.SyntheticEvent<HTMLImageElement>) {\n  const emoji = event.currentTarget;\n\n  LOADED_EMOJIS.add(event.currentTarget.dataset.path!);\n\n  requestMutation(() => {\n    addExtraClass(emoji, 'open');\n  });\n}\n\nexport function nativeToUnified(emoji: string) {\n  let code;\n\n  if (emoji.length === 1) {\n    code = emoji.charCodeAt(0).toString(16).padStart(4, '0');\n  } else {\n    const pairs = [];\n    for (let i = 0; i < emoji.length; i++) {\n      if (emoji.charCodeAt(i) >= 0xd800 && emoji.charCodeAt(i) <= 0xdbff) {\n        if (emoji.charCodeAt(i + 1) >= 0xdc00 && emoji.charCodeAt(i + 1) <= 0xdfff) {\n          pairs.push(\n            (emoji.charCodeAt(i) - 0xd800) * 0x400\n            + (emoji.charCodeAt(i + 1) - 0xdc00) + 0x10000,\n          );\n        }\n      } else if (emoji.charCodeAt(i) < 0xd800 || emoji.charCodeAt(i) > 0xdfff) {\n        pairs.push(emoji.charCodeAt(i));\n      }\n    }\n\n    code = pairs.map((x) => x.toString(16).padStart(4, '0')).join('-');\n  }\n\n  return code;\n}\n\nfunction nativeToUnifiedExtended(emoji: string) {\n  return nativeToUnified(removeVS16s(emoji));\n}\n\nexport const nativeToUnifiedExtendedWithCache = withCache(nativeToUnifiedExtended);\n\nexport function uncompressEmoji(data: EmojiRawData): EmojiData {\n  const emojiData: EmojiData = { categories: [], emojis: {} };\n\n  for (let i = 0; i < data.length; i += 2) {\n    const category = {\n      id: data[i][0],\n      name: data[i][1],\n      emojis: [],\n    } as EmojiCategory;\n\n    for (let j = 0; j < data[i + 1].length; j++) {\n      const emojiRaw = data[i + 1][j];\n      if (!EXCLUDE_EMOJIS.includes(emojiRaw[1][0])) {\n        category.emojis.push(emojiRaw[1][0]);\n        emojiData.emojis[emojiRaw[1][0]] = {\n          id: emojiRaw[1][0],\n          names: emojiRaw[1] as string[],\n          native: unifiedToNative(emojiRaw[0] as string),\n          image: (emojiRaw[0] as string).toLowerCase(),\n        };\n      }\n    }\n\n    emojiData.categories.push(category);\n  }\n\n  return emojiData;\n}\n\nexport function isoToEmoji(iso: string) {\n  // Special case for Fragment numbers\n  if (iso === 'FT') {\n    return '\\uD83C\\uDFF4\\u200D\\u2620\\uFE0F';\n  }\n\n  const code = iso.toUpperCase();\n\n  if (!/^[A-Z]{2}$/.test(code)) return iso;\n  const codePoints = [...code].map((c) => c.codePointAt(0)! + ISO_FLAGS_OFFSET);\n  return String.fromCodePoint(...codePoints);\n}\n","type HandlerName =\n  'onEnter'\n  | 'onBackspace'\n  | 'onDelete'\n  | 'onEsc'\n  | 'onUp'\n  | 'onDown'\n  | 'onLeft'\n  | 'onRight'\n  | 'onTab';\ntype Handler = (e: KeyboardEvent) => void | boolean;\ntype CaptureOptions = Partial<Record<HandlerName, Handler>>;\n\nconst keyToHandlerName: Record<string, HandlerName> = {\n  Enter: 'onEnter',\n  Backspace: 'onBackspace',\n  Delete: 'onDelete',\n  Esc: 'onEsc',\n  Escape: 'onEsc',\n  ArrowUp: 'onUp',\n  ArrowDown: 'onDown',\n  ArrowLeft: 'onLeft',\n  ArrowRight: 'onRight',\n  Tab: 'onTab',\n};\n\nconst handlers: Record<HandlerName, Handler[]> = {\n  onEnter: [],\n  onDelete: [],\n  onBackspace: [],\n  onEsc: [],\n  onUp: [],\n  onDown: [],\n  onLeft: [],\n  onRight: [],\n  onTab: [],\n};\n\nexport default function captureKeyboardListeners(options: CaptureOptions) {\n  if (!hasActiveHandlers()) {\n    document.addEventListener('keydown', handleKeyDown, true);\n  }\n\n  (Object.keys(options) as Array<HandlerName>).forEach((handlerName) => {\n    const handler = options[handlerName];\n    if (!handler) {\n      return;\n    }\n\n    const currentEventHandlers = handlers[handlerName];\n    if (currentEventHandlers) {\n      currentEventHandlers.push(handler);\n    }\n  });\n\n  return () => {\n    releaseKeyboardListener(options);\n  };\n}\n\nfunction hasActiveHandlers() {\n  return Object.values(handlers).some((keyHandlers) => Boolean(keyHandlers.length));\n}\n\nexport function hasActiveHandler(key: string) {\n  const handlerName = keyToHandlerName[key];\n  return handlerName ? Boolean(handlers[handlerName].length) : false;\n}\n\nfunction handleKeyDown(e: KeyboardEvent) {\n  const handlerName = keyToHandlerName[e.key];\n  if (!handlerName) {\n    return;\n  }\n\n  const { length } = handlers[handlerName];\n  if (!length) {\n    return;\n  }\n\n  for (let i = length - 1; i >= 0; i--) {\n    const handler = handlers[handlerName][i];\n    if (handler(e) !== false) {\n      e.stopPropagation();\n      break;\n    }\n  }\n}\n\nfunction releaseKeyboardListener(options: CaptureOptions) {\n  (Object.keys(options) as Array<HandlerName>).forEach((handlerName) => {\n    const handler = options[handlerName];\n    const currentEventHandlers = handlers[handlerName];\n    if (currentEventHandlers) {\n      const index = currentEventHandlers.findIndex((cb) => cb === handler);\n      if (index !== -1) {\n        currentEventHandlers.splice(index, 1);\n      }\n    }\n  });\n\n  if (!hasActiveHandlers()) {\n    document.removeEventListener('keydown', handleKeyDown, false);\n  }\n}\n","import { memo } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport Spinner from './Spinner';\n\nimport './Loading.scss';\n\ntype OwnProps = {\n  color?: 'blue' | 'white' | 'black' | 'yellow';\n  backgroundColor?: 'light' | 'dark';\n  className?: string;\n  onClick?: NoneToVoidFunction;\n};\n\nconst Loading = ({\n  color = 'blue', backgroundColor, className, onClick,\n}: OwnProps) => {\n  return (\n    <div className={buildClassName('Loading', onClick && 'interactive', className)} onClick={onClick}>\n      <Spinner color={color} backgroundColor={backgroundColor} />\n    </div>\n  );\n};\n\nexport default memo(Loading);\n","import type React from '../../../lib/teact/teact';\n\nimport { EDITABLE_INPUT_ID } from '../../../config';\nimport { IS_IOS } from '../../../util/browser/windowEnvironment';\n\nexport function preventMessageInputBlur(e: React.MouseEvent<HTMLElement>, withBubbling = false) {\n  if (\n    IS_IOS\n    || !document.activeElement\n    || document.activeElement.id !== EDITABLE_INPUT_ID\n    || (!withBubbling && e.target !== e.currentTarget)\n  ) {\n    return;\n  }\n\n  e.preventDefault();\n}\n\nexport function preventMessageInputBlurWithBubbling(e: React.MouseEvent<HTMLElement>) {\n  preventMessageInputBlur(e, true);\n}\n","import { getActions } from '../global';\n\nimport type { ApiChatType, ApiFormattedText, LinkContext } from '../api/types';\nimport type { DeepLinkMethod } from './deepLinkParser';\nimport { LeftColumnContent, SettingsScreens } from '../types';\n\nimport { API_CHAT_TYPES, RE_TG_LINK, TON_CURRENCY_CODE } from '../config';\nimport { IS_BAD_URL_PARSER } from './browser/globalEnvironment';\nimport { tryParseDeepLink } from './deepLinkParser';\n\nexport const processDeepLink = (url: string, linkContext?: LinkContext): boolean => {\n  const actions = getActions();\n\n  const parsedLink = tryParseDeepLink(url);\n  if (parsedLink) {\n    switch (parsedLink.type) {\n      case 'privateMessageLink':\n        actions.openPrivateChannel({\n          id: parsedLink.channelId,\n          threadId: parsedLink.threadId,\n          messageId: parsedLink.messageId,\n          commentId: parsedLink.commentId,\n          timestamp: parsedLink.timestamp,\n          linkContext,\n        });\n        return true;\n      case 'publicMessageLink': {\n        actions.openChatByUsername({\n          username: parsedLink.username,\n          threadId: parsedLink.threadId,\n          messageId: parsedLink.messageId,\n          commentId: parsedLink.commentId,\n          timestamp: parsedLink.timestamp,\n          linkContext,\n        });\n        return true;\n      }\n      case 'publicUsernameOrBotLink': {\n        const choose = parseChooseParameter(parsedLink.choose);\n\n        actions.openChatByUsername({\n          username: parsedLink.username,\n          startParam: parsedLink.start,\n          ref: parsedLink.ref,\n          text: parsedLink.text,\n          startApp: parsedLink.startApp,\n          mode: parsedLink.mode,\n          startAttach: parsedLink.startAttach,\n          attach: parsedLink.attach,\n          choose,\n          originalParts: [parsedLink.username, parsedLink.appName],\n          isDirect: parsedLink.isDirect,\n        });\n        return true;\n      }\n      case 'privateChannelLink': {\n        actions.openPrivateChannel({\n          id: parsedLink.channelId,\n        });\n        return true;\n      }\n      case 'businessChatLink':\n        actions.resolveBusinessChatLink({\n          slug: parsedLink.slug,\n        });\n        return true;\n      case 'premiumReferrerLink':\n        actions.openPremiumModal();\n        return true;\n      case 'premiumMultigiftLink':\n        actions.openGiftRecipientPicker();\n        return true;\n      case 'chatBoostLink':\n        actions.processBoostParameters({\n          usernameOrId: (parsedLink.username || parsedLink.id)!,\n          isPrivate: Boolean(parsedLink.id),\n        });\n        return true;\n      case 'giftUniqueLink':\n        actions.openUniqueGiftBySlug({ slug: parsedLink.slug });\n        return true;\n      case 'giftAuctionLink':\n        actions.openGiftAuctionBySlug({ slug: parsedLink.slug });\n        return true;\n      case 'settings':\n        if (!parsedLink.screen) {\n          actions.openLeftColumnContent({ contentKey: LeftColumnContent.Settings });\n          return true;\n        }\n        switch (parsedLink.screen) {\n          case 'editProfile':\n            actions.openSettingsScreen({ screen: SettingsScreens.EditProfile });\n            break;\n          case 'language':\n            actions.openSettingsScreen({ screen: SettingsScreens.Language });\n            break;\n          case 'devices':\n            actions.openSettingsScreen({ screen: SettingsScreens.ActiveSessions });\n            break;\n          case 'privacy':\n            actions.openSettingsScreen({ screen: SettingsScreens.Privacy });\n            break;\n          case 'folders':\n            actions.openSettingsScreen({ screen: SettingsScreens.Folders });\n            break;\n          case 'theme':\n            actions.openSettingsScreen({ screen: SettingsScreens.General });\n            break;\n        }\n        return true;\n      case 'stars':\n        actions.openStarsBalanceModal({});\n        break;\n      case 'ton':\n        actions.openStarsBalanceModal({ currency: TON_CURRENCY_CODE });\n        break;\n      default:\n        break;\n    }\n  }\n\n  if (!url.match(RE_TG_LINK)) {\n    return false;\n  }\n\n  const urlToParse = IS_BAD_URL_PARSER ? url.replace(/^tg:\\/\\//, 'https://') : url;\n\n  const {\n    protocol, searchParams, hostname,\n  } = new URL(urlToParse);\n\n  if (protocol !== 'tg:') return false;\n\n  const method = hostname as DeepLinkMethod;\n  const params = Object.fromEntries(searchParams);\n\n  const {\n    checkChatInvite,\n    openChatByUsername,\n    openChatByPhoneNumber,\n    openStickerSet,\n    joinVoiceChatByLink,\n    openInvoice,\n    openChatWithDraft,\n    checkChatlistInvite,\n    openStoryViewerByUsername,\n    checkGiftCode,\n    openStarsBalanceModal,\n  } = actions;\n\n  switch (method) {\n    case 'resolve': {\n      const {\n        domain, phone, post, comment, voicechat, livestream, start, startattach, attach, thread, topic,\n        appname, startapp, mode, story, text,\n      } = params;\n\n      const threadId = Number(thread) || Number(topic) || undefined;\n\n      if (domain !== 'telegrampassport') {\n        if (appname) {\n          openChatByUsername({\n            username: domain,\n            startApp: startapp,\n            mode,\n            originalParts: [domain, appname],\n            text,\n          });\n        } else if (params.hasOwnProperty('voicechat') || params.hasOwnProperty('livestream')) {\n          joinVoiceChatByLink({\n            username: domain,\n            inviteHash: voicechat || livestream,\n          });\n        } else if (phone) {\n          openChatByPhoneNumber({\n            phoneNumber: phone,\n            startAttach: startattach,\n            attach,\n            text,\n          });\n        } else if (story) {\n          openStoryViewerByUsername({ username: domain, storyId: Number(story) });\n        } else {\n          openChatByUsername({\n            username: domain,\n            messageId: post ? Number(post) : undefined,\n            commentId: comment ? Number(comment) : undefined,\n            startParam: start,\n            mode,\n            startAttach: startattach,\n            attach,\n            threadId,\n          });\n        }\n      }\n      break;\n    }\n    case 'bg': {\n      // const {\n      //   slug, color, rotation, mode, intensity, bg_color: bgColor, gradient,\n      // } = params;\n      break;\n    }\n    case 'join': {\n      const { invite } = params;\n\n      checkChatInvite({ hash: invite });\n      break;\n    }\n    case 'addemoji':\n    case 'addstickers': {\n      const { set } = params;\n\n      openStickerSet({\n        stickerSetInfo: {\n          shortName: set,\n        },\n      });\n      break;\n    }\n    case 'share':\n    case 'msg':\n    case 'msg_url': {\n      const { url: urlParam, text } = params;\n      openChatWithDraft({ text: formatShareText(urlParam, text) });\n      break;\n    }\n    case 'addlist': {\n      checkChatlistInvite({ slug: params.slug });\n      break;\n    }\n\n    case 'login': {\n      // const { code, token } = params;\n      break;\n    }\n\n    case 'invoice': {\n      const { slug } = params;\n      openInvoice({ type: 'slug', slug });\n      break;\n    }\n\n    case 'stars_topup': {\n      const { balance, purpose } = params;\n      const balanceNeeded = Number(balance);\n      if (!balanceNeeded || balanceNeeded < 0) return true;\n\n      openStarsBalanceModal({ topup: { balanceNeeded, purpose } });\n      break;\n    }\n\n    case 'giftcode': {\n      const { slug } = params;\n      checkGiftCode({ slug });\n      break;\n    }\n    default:\n      // Unsupported deeplink\n      return false;\n  }\n  return true;\n};\n\nexport function formatShareText(url?: string, text?: string, title?: string): ApiFormattedText {\n  return {\n    text: [url, title, text].filter(Boolean).join('\\n'),\n  };\n}\n\nfunction parseChooseParameter(choose?: string) {\n  if (!choose) return undefined;\n  const types = choose.toLowerCase().split(' ').flatMap((type) => {\n    if (type === 'groups') {\n      return ['chats', 'groups'];\n    }\n    return [type];\n  });\n  return types.filter((type): type is ApiChatType => API_CHAT_TYPES.includes(type as ApiChatType));\n}\n","import { addCallback, removeCallback } from '../../lib/teact/teactn';\n\nimport type { SharedState } from '../types';\nimport type { ClientBoundMessageEvent } from './sharedState.worker';\n\nimport { APP_NAME } from '../../config';\nimport { deepDiff, type DiffObject } from '../../util/deepDiff';\nimport { deepMerge } from '../../util/deepMerge';\nimport { throttleWithTickEnd } from '../../util/schedulers';\nimport { INITIAL_SHARED_STATE } from '../initialState';\nimport { getGlobal, setGlobal } from '..';\n\ninterface GetFullStateEvent {\n  type: 'reqGetFullState';\n  localState: SharedState;\n}\n\ninterface UpdateStateEvent {\n  type: 'reqUpdateState';\n  update: DiffObject<SharedState>;\n}\n\nexport type WorkerBoundMessageEvent = GetFullStateEvent | UpdateStateEvent;\n\nlet sharedWorker: SharedWorker | undefined;\n\n// Tracks if the client has been synced with the shared state.\nlet synced = false;\nlet lastSharedState: SharedState = INITIAL_SHARED_STATE;\n\nexport function initSharedState(localState: SharedState) {\n  sharedWorker = new SharedWorker(new URL('./sharedState.worker.ts', import.meta.url), { name: APP_NAME });\n\n  sharedWorker.port.addEventListener('message', onMessage);\n  sharedWorker.port.start();\n\n  sendToWorker({ type: 'reqGetFullState', localState });\n\n  addCallback(onGlobalChange);\n}\n\nfunction onGlobalChange() {\n  const global = getGlobal();\n  if (global.sharedState === lastSharedState) return;\n  if (global.sharedState.isInitial) return;\n\n  updateSharedState(global.sharedState);\n}\n\nfunction onMessage(event: MessageEvent<ClientBoundMessageEvent>) {\n  const data = event.data;\n  switch (data.type) {\n    case 'stateUpdate': {\n      const state = deepMerge(lastSharedState, data.update);\n      updateGlobal(state);\n      break;\n    }\n    case 'fullState':\n      synced = true;\n      updateGlobal(data.state);\n      break;\n  }\n}\n\nexport function destroySharedStatePort() {\n  if (!sharedWorker) return;\n  sharedWorker.port.removeEventListener('message', onMessage);\n  sharedWorker.port.close();\n  sharedWorker = undefined;\n  removeCallback(onGlobalChange);\n}\n\nfunction updateSharedState(update: SharedState) {\n  if (!synced) return;\n  const diff = deepDiff(lastSharedState, update);\n  lastSharedState = update;\n  if (typeof diff === 'symbol') return;\n\n  sendToWorker({ type: 'reqUpdateState', update: diff });\n}\n\nconst scheduledEvents = new Set<WorkerBoundMessageEvent>();\n\nconst sendOnTickEnd = throttleWithTickEnd(() => {\n  if (!sharedWorker) {\n    throw new Error('Shared worker not initialized');\n  }\n\n  for (const event of scheduledEvents) {\n    sharedWorker.port.postMessage(event);\n  }\n  scheduledEvents.clear();\n});\n\nfunction sendToWorker(event: WorkerBoundMessageEvent) {\n  if (!sharedWorker) {\n    throw new Error('Shared worker not initialized');\n  }\n\n  scheduledEvents.add(event);\n  sendOnTickEnd();\n}\n\nfunction updateGlobal(update: Partial<SharedState>) {\n  let global = getGlobal();\n  lastSharedState = {\n    ...global.sharedState,\n    ...update,\n  };\n\n  global = {\n    ...global,\n    sharedState: lastSharedState,\n  };\n  setGlobal(global);\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { DEFAULT_GIFT_PROFILE_FILTER_OPTIONS } from '../../config';\nimport arePropsShallowEqual from '../../util/arePropsShallowEqual';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  getHasAdminRight, isChatAdmin, isChatChannel,\n} from '../helpers';\nimport { selectChat } from './chats';\nimport { selectTabState } from './tabs';\nimport { selectUser } from './users';\n\nexport type ProfileCollectionKey = number | 'all';\n\nexport function selectPaymentInputInvoice<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.inputInvoice;\n}\n\nexport function selectPaymentForm<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form;\n}\n\nexport function selectStarsPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).starsPayment;\n}\n\nexport function selectPaymentRequestId<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.requestId;\n}\n\nexport function selectProviderPublishableKey<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form?.nativeParams.publishableKey;\n}\n\nexport function selectProviderPublicToken<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.form?.nativeParams.publicToken;\n}\n\nexport function selectStripeCredentials<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.stripeCredentials;\n}\n\nexport function selectSmartGlocalCredentials<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).payment.smartGlocalCredentials;\n}\n\nexport function selectCanUseGiftProfileAdminFilter<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const chat = selectChat(global, peerId);\n  const isCurrentUser = global.currentUserId === peerId;\n  return isCurrentUser || (chat && isChatChannel(chat) && isChatAdmin(chat) && getHasAdminRight(chat, 'postMessages'));\n}\n\nexport function selectCanUseGiftProfileFilter<T extends GlobalState>(\n  global: T, peerId: string,\n) {\n  const chat = selectChat(global, peerId);\n  const user = selectUser(global, peerId);\n  return Boolean(user) || (chat && isChatChannel(chat));\n}\n\nexport function selectGiftProfileFilter<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectCanUseGiftProfileFilter(global, peerId) ? selectTabState(global, tabId).savedGifts.filter : undefined;\n}\n\nexport function selectIsGiftProfileFilterDefault<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return arePropsShallowEqual(selectTabState(global, tabId).savedGifts.filter, DEFAULT_GIFT_PROFILE_FILTER_OPTIONS);\n}\n\nexport function selectActiveGiftsCollectionId<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ProfileCollectionKey {\n  return selectTabState(global, tabId).savedGifts.activeCollectionByPeerId?.[peerId] || 'all';\n}\n","import { __classPrivateFieldGet, __classPrivateFieldSet } from './external/tslib/tslib.es6.js';\n\n// Copyright 2019-2024 Tauri Programme within The Commons Conservancy\n// SPDX-License-Identifier: Apache-2.0\n// SPDX-License-Identifier: MIT\nvar _Channel_onmessage, _Channel_nextMessageIndex, _Channel_pendingMessages, _Channel_messageEndIndex, _Resource_rid;\n/**\n * Invoke your custom commands.\n *\n * This package is also accessible with `window.__TAURI__.core` when [`app.withGlobalTauri`](https://v2.tauri.app/reference/config/#withglobaltauri) in `tauri.conf.json` is set to `true`.\n * @module\n */\n/**\n * A key to be used to implement a special function\n * on your types that define how your type should be serialized\n * when passing across the IPC.\n * @example\n * Given a type in Rust that looks like this\n * ```rs\n * #[derive(serde::Serialize, serde::Deserialize)\n * enum UserId {\n *   String(String),\n *   Number(u32),\n * }\n * ```\n * `UserId::String(\"id\")` would be serialized into `{ String: \"id\" }`\n * and so we need to pass the same structure back to Rust\n * ```ts\n * import { SERIALIZE_TO_IPC_FN } from \"@tauri-apps/api/core\"\n *\n * class UserIdString {\n *   id\n *   constructor(id) {\n *     this.id = id\n *   }\n *\n *   [SERIALIZE_TO_IPC_FN]() {\n *     return { String: this.id }\n *   }\n * }\n *\n * class UserIdNumber {\n *   id\n *   constructor(id) {\n *     this.id = id\n *   }\n *\n *   [SERIALIZE_TO_IPC_FN]() {\n *     return { Number: this.id }\n *   }\n * }\n *\n * type UserId = UserIdString | UserIdNumber\n * ```\n *\n */\n// if this value changes, make sure to update it in:\n// 1. ipc.js\n// 2. process-ipc-message-fn.js\nconst SERIALIZE_TO_IPC_FN = '__TAURI_TO_IPC_KEY__';\n/**\n * Stores the callback in a known location, and returns an identifier that can be passed to the backend.\n * The backend uses the identifier to `eval()` the callback.\n *\n * @return An unique identifier associated with the callback function.\n *\n * @since 1.0.0\n */\nfunction transformCallback(\n// TODO: Make this not optional in v3\ncallback, once = false) {\n    return window.__TAURI_INTERNALS__.transformCallback(callback, once);\n}\nclass Channel {\n    constructor(onmessage) {\n        _Channel_onmessage.set(this, void 0);\n        // the index is used as a mechanism to preserve message order\n        _Channel_nextMessageIndex.set(this, 0);\n        _Channel_pendingMessages.set(this, []);\n        _Channel_messageEndIndex.set(this, void 0);\n        __classPrivateFieldSet(this, _Channel_onmessage, onmessage || (() => { }), \"f\");\n        this.id = transformCallback((rawMessage) => {\n            const index = rawMessage.index;\n            if ('end' in rawMessage) {\n                if (index == __classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\")) {\n                    this.cleanupCallback();\n                }\n                else {\n                    __classPrivateFieldSet(this, _Channel_messageEndIndex, index, \"f\");\n                }\n                return;\n            }\n            const message = rawMessage.message;\n            // Process the message if we're at the right order\n            if (index == __classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\")) {\n                __classPrivateFieldGet(this, _Channel_onmessage, \"f\").call(this, message);\n                __classPrivateFieldSet(this, _Channel_nextMessageIndex, __classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\") + 1, \"f\");\n                // process pending messages\n                while (__classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\") in __classPrivateFieldGet(this, _Channel_pendingMessages, \"f\")) {\n                    const message = __classPrivateFieldGet(this, _Channel_pendingMessages, \"f\")[__classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\")];\n                    __classPrivateFieldGet(this, _Channel_onmessage, \"f\").call(this, message);\n                    // eslint-disable-next-line @typescript-eslint/no-array-delete\n                    delete __classPrivateFieldGet(this, _Channel_pendingMessages, \"f\")[__classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\")];\n                    __classPrivateFieldSet(this, _Channel_nextMessageIndex, __classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\") + 1, \"f\");\n                }\n                if (__classPrivateFieldGet(this, _Channel_nextMessageIndex, \"f\") === __classPrivateFieldGet(this, _Channel_messageEndIndex, \"f\")) {\n                    this.cleanupCallback();\n                }\n            }\n            // Queue the message if we're not\n            else {\n                // eslint-disable-next-line security/detect-object-injection\n                __classPrivateFieldGet(this, _Channel_pendingMessages, \"f\")[index] = message;\n            }\n        });\n    }\n    cleanupCallback() {\n        window.__TAURI_INTERNALS__.unregisterCallback(this.id);\n    }\n    set onmessage(handler) {\n        __classPrivateFieldSet(this, _Channel_onmessage, handler, \"f\");\n    }\n    get onmessage() {\n        return __classPrivateFieldGet(this, _Channel_onmessage, \"f\");\n    }\n    [(_Channel_onmessage = new WeakMap(), _Channel_nextMessageIndex = new WeakMap(), _Channel_pendingMessages = new WeakMap(), _Channel_messageEndIndex = new WeakMap(), SERIALIZE_TO_IPC_FN)]() {\n        return `__CHANNEL__:${this.id}`;\n    }\n    toJSON() {\n        // eslint-disable-next-line security/detect-object-injection\n        return this[SERIALIZE_TO_IPC_FN]();\n    }\n}\nclass PluginListener {\n    constructor(plugin, event, channelId) {\n        this.plugin = plugin;\n        this.event = event;\n        this.channelId = channelId;\n    }\n    async unregister() {\n        return invoke(`plugin:${this.plugin}|remove_listener`, {\n            event: this.event,\n            channelId: this.channelId\n        });\n    }\n}\n/**\n * Adds a listener to a plugin event.\n *\n * @returns The listener object to stop listening to the events.\n *\n * @since 2.0.0\n */\nasync function addPluginListener(plugin, event, cb) {\n    const handler = new Channel(cb);\n    try {\n        await invoke(`plugin:${plugin}|register_listener`, {\n            event,\n            handler\n        });\n        return new PluginListener(plugin, event, handler.id);\n    }\n    catch {\n        // TODO(v3): remove this fallback\n        // note: we must try with camelCase here for backwards compatibility\n        await invoke(`plugin:${plugin}|registerListener`, { event, handler });\n        return new PluginListener(plugin, event, handler.id);\n    }\n}\n/**\n * Get permission state for a plugin.\n *\n * This should be used by plugin authors to wrap their actual implementation.\n */\nasync function checkPermissions(plugin) {\n    return invoke(`plugin:${plugin}|check_permissions`);\n}\n/**\n * Request permissions.\n *\n * This should be used by plugin authors to wrap their actual implementation.\n */\nasync function requestPermissions(plugin) {\n    return invoke(`plugin:${plugin}|request_permissions`);\n}\n/**\n * Sends a message to the backend.\n * @example\n * ```typescript\n * import { invoke } from '@tauri-apps/api/core';\n * await invoke('login', { user: 'tauri', password: 'poiwe3h4r5ip3yrhtew9ty' });\n * ```\n *\n * @param cmd The command name.\n * @param args The optional arguments to pass to the command.\n * @param options The request options.\n * @return A promise resolving or rejecting to the backend response.\n *\n * @since 1.0.0\n */\nasync function invoke(cmd, args = {}, options) {\n    return window.__TAURI_INTERNALS__.invoke(cmd, args, options);\n}\n/**\n * Convert a device file path to an URL that can be loaded by the webview.\n * Note that `asset:` and `http://asset.localhost` must be added to [`app.security.csp`](https://v2.tauri.app/reference/config/#csp-1) in `tauri.conf.json`.\n * Example CSP value: `\"csp\": \"default-src 'self' ipc: http://ipc.localhost; img-src 'self' asset: http://asset.localhost\"` to use the asset protocol on image sources.\n *\n * Additionally, `\"enable\" : \"true\"` must be added to [`app.security.assetProtocol`](https://v2.tauri.app/reference/config/#assetprotocolconfig)\n * in `tauri.conf.json` and its access scope must be defined on the `scope` array on the same `assetProtocol` object.\n *\n * @param  filePath The file path.\n * @param  protocol The protocol to use. Defaults to `asset`. You only need to set this when using a custom protocol.\n * @example\n * ```typescript\n * import { appDataDir, join } from '@tauri-apps/api/path';\n * import { convertFileSrc } from '@tauri-apps/api/core';\n * const appDataDirPath = await appDataDir();\n * const filePath = await join(appDataDirPath, 'assets/video.mp4');\n * const assetUrl = convertFileSrc(filePath);\n *\n * const video = document.getElementById('my-video');\n * const source = document.createElement('source');\n * source.type = 'video/mp4';\n * source.src = assetUrl;\n * video.appendChild(source);\n * video.load();\n * ```\n *\n * @return the URL that can be used as source on the webview.\n *\n * @since 1.0.0\n */\nfunction convertFileSrc(filePath, protocol = 'asset') {\n    return window.__TAURI_INTERNALS__.convertFileSrc(filePath, protocol);\n}\n/**\n * A rust-backed resource stored through `tauri::Manager::resources_table` API.\n *\n * The resource lives in the main process and does not exist\n * in the Javascript world, and thus will not be cleaned up automatically\n * except on application exit. If you want to clean it up early, call {@linkcode Resource.close}\n *\n * @example\n * ```typescript\n * import { Resource, invoke } from '@tauri-apps/api/core';\n * export class DatabaseHandle extends Resource {\n *   static async open(path: string): Promise<DatabaseHandle> {\n *     const rid: number = await invoke('open_db', { path });\n *     return new DatabaseHandle(rid);\n *   }\n *\n *   async execute(sql: string): Promise<void> {\n *     await invoke('execute_sql', { rid: this.rid, sql });\n *   }\n * }\n * ```\n */\nclass Resource {\n    get rid() {\n        return __classPrivateFieldGet(this, _Resource_rid, \"f\");\n    }\n    constructor(rid) {\n        _Resource_rid.set(this, void 0);\n        __classPrivateFieldSet(this, _Resource_rid, rid, \"f\");\n    }\n    /**\n     * Destroys and cleans up this resource from memory.\n     * **You should not call any method on this object anymore and should drop any reference to it.**\n     */\n    async close() {\n        return invoke('plugin:resources|close', {\n            rid: this.rid\n        });\n    }\n}\n_Resource_rid = new WeakMap();\nfunction isTauri() {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/no-unsafe-member-access\n    return !!(globalThis || window).isTauri;\n}\n\nexport { Channel, PluginListener, Resource, SERIALIZE_TO_IPC_FN, addPluginListener, checkPermissions, convertFileSrc, invoke, isTauri, requestPermissions, transformCallback };\n","import type { MoveOffsets } from './captureEvents';\n\nimport { requestMeasure, requestMutation } from '../lib/fasterdom/fasterdom';\nimport { IS_IOS } from './browser/windowEnvironment';\nimport { animateNumber, timingFunctions } from './animation';\nimport { captureEvents, SwipeDirection } from './captureEvents';\nimport { waitForAnimationEnd } from './cssAnimationEndListeners';\nimport { clamp } from './math';\n\nconst INERTIA_DURATION = 300;\nconst INERTIA_EASING = timingFunctions.easeOutCubic;\n\nlet isSwipeActive = false;\nlet swipeOffsets: MoveOffsets | undefined;\nlet onDrag: ((offsets: MoveOffsets) => void) | undefined;\nlet onRelease: ((onCancel: NoneToVoidFunction) => void) | undefined;\nlet cancelCurrentReleaseAnimation: NoneToVoidFunction | undefined;\n\nexport function captureControlledSwipe(\n  element: HTMLElement, options: {\n    excludedClosestSelector?: string;\n    selectorToPreventScroll?: string;\n    onSwipeLeftStart?: NoneToVoidFunction;\n    onSwipeRightStart?: NoneToVoidFunction;\n    onCancel: NoneToVoidFunction;\n  },\n) {\n  return captureEvents(element, {\n    excludedClosestSelector: options.excludedClosestSelector,\n    selectorToPreventScroll: options.selectorToPreventScroll,\n    swipeThreshold: 10,\n\n    onSwipe(e, direction, offsets) {\n      if (direction === SwipeDirection.Left) {\n        options.onSwipeLeftStart?.();\n      } else if (direction === SwipeDirection.Right) {\n        options.onSwipeRightStart?.();\n      } else {\n        return false;\n      }\n\n      if (IS_IOS) {\n        isSwipeActive = true;\n        swipeOffsets = offsets;\n      }\n\n      return true;\n    },\n\n    onDrag(e, captureEvent, offsets) {\n      if (!isSwipeActive) return;\n\n      onDrag?.(offsets);\n    },\n\n    onRelease() {\n      if (!isSwipeActive) return;\n\n      isSwipeActive = false;\n\n      onRelease?.(options.onCancel);\n\n      onDrag = undefined;\n      onRelease = undefined;\n    },\n  });\n}\n\nexport function allowSwipeControlForTransition(\n  currentSlide: HTMLElement,\n  nextSlide: HTMLElement,\n  onCancelForTransition: NoneToVoidFunction,\n) {\n  cancelCurrentReleaseAnimation?.();\n\n  if (!isSwipeActive) return;\n\n  const targetPosition = extractAnimationEndPosition(currentSlide);\n  if (!targetPosition) return;\n\n  currentSlide.getAnimations().forEach((a) => a.pause());\n  nextSlide.getAnimations().forEach((a) => a.pause());\n\n  currentSlide.style.animationTimingFunction = 'linear';\n  nextSlide.style.animationTimingFunction = 'linear';\n\n  let currentDirection: 1 | -1 | undefined;\n\n  requestMeasure(() => {\n    const computedStyle = getComputedStyle(currentSlide);\n    const initialPositionPx = extractPositionFromMatrix(computedStyle.transform, targetPosition.axis);\n    const targetPositionPx = targetPosition.units === 'px'\n      ? targetPosition.value\n      : ((targetPosition.value / 100) * (\n        targetPosition.axis === 'X' ? currentSlide.offsetWidth : currentSlide.offsetHeight\n      ));\n    const distance = targetPositionPx - initialPositionPx;\n\n    let progress = 0;\n\n    onDrag = ({ dragOffsetX, dragOffsetY }) => {\n      const dragOffset = targetPosition.axis === 'X'\n        ? dragOffsetX - swipeOffsets!.dragOffsetX\n        : dragOffsetY - swipeOffsets!.dragOffsetY;\n\n      const newProgress = clamp(dragOffset / distance, 0, 1);\n      currentDirection = newProgress > progress ? 1 : -1;\n      progress = newProgress;\n\n      updateAnimationProgress([currentSlide, nextSlide], progress);\n    };\n\n    onRelease = (onCancelForClient: NoneToVoidFunction) => {\n      const isRevertSwipe = currentDirection === -1;\n\n      function cleanup() {\n        currentSlide.getAnimations().forEach((a) => a.cancel());\n        nextSlide.getAnimations().forEach((a) => a.cancel());\n\n        requestMutation(() => {\n          currentSlide.style.animationTimingFunction = '';\n          nextSlide.style.animationTimingFunction = '';\n        });\n      }\n\n      if (!isRevertSwipe) {\n        // For some reason animations are not cleared when CSS class is removed\n        waitForAnimationEnd(currentSlide, cleanup);\n      }\n\n      cancelCurrentReleaseAnimation = animateNumber({\n        from: progress,\n        to: isRevertSwipe ? 0 : 1,\n        duration: INERTIA_DURATION,\n        timing: INERTIA_EASING,\n        onUpdate(releaseProgress) {\n          updateAnimationProgress([currentSlide, nextSlide], releaseProgress);\n        },\n        onEnd(isCanceled = false) {\n          cancelCurrentReleaseAnimation = undefined;\n\n          if (isCanceled || isRevertSwipe) {\n            cleanup();\n            onCancelForTransition();\n            onCancelForClient();\n          }\n        },\n      });\n    };\n  });\n}\n\nfunction updateAnimationProgress(elements: HTMLElement[], progress: number) {\n  elements.map((e) => e.getAnimations()).flat().forEach((animation) => {\n    animation.currentTime = (animation.effect!.getTiming().duration as number) * progress;\n  });\n}\n\nfunction extractAnimationEndPosition(element: HTMLElement) {\n  for (const animation of element.getAnimations()) {\n    if (!(animation.effect instanceof KeyframeEffect)) continue;\n\n    for (const keyframe of animation.effect.getKeyframes()) {\n      if (keyframe.offset !== 1 || !keyframe.transform) continue;\n\n      const position = extractPositionFromTransform(keyframe.transform as string);\n      if (position) {\n        return position;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nfunction extractPositionFromTransform(transformRule: string) {\n  const match = transformRule.match(/([XY])\\((-?\\d+)(%|px)\\)/);\n  if (!match) return undefined;\n\n  return {\n    axis: match[1] as 'X' | 'Y',\n    value: Number(match[2]),\n    units: match[3],\n  };\n}\n\nfunction extractPositionFromMatrix(transform: string, axis: 'X' | 'Y') {\n  const matrix = transform.slice(7, -1).split(',').map(Number);\n  return matrix[axis === 'X' ? 4 : 5];\n}\n","import type { TeactNode } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiPeer } from '../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../api/types';\n\nimport { selectUser } from '../../../global/selectors';\n\nimport useAppLayout from '../../../hooks/useAppLayout';\n\ntype OwnProps = {\n  userId?: string;\n  username?: string;\n  children: TeactNode;\n};\n\ntype StateProps = {\n  userOrChat?: ApiPeer;\n};\n\nconst MentionLink = ({\n  userId,\n  username,\n  userOrChat,\n  children,\n}: OwnProps & StateProps) => {\n  const {\n    openChat,\n    openChatByUsername,\n    closeStoryViewer,\n    setShouldCloseRightColumn,\n  } = getActions();\n\n  const { isMobile } = useAppLayout();\n\n  const handleClick = () => {\n    if (isMobile) {\n      setShouldCloseRightColumn({\n        value: true,\n      });\n    }\n\n    if (userOrChat) {\n      openChat({ id: userOrChat.id });\n    } else if (username) {\n      closeStoryViewer();\n      openChatByUsername({ username: username.substring(1) });\n    }\n  };\n\n  return (\n    <a\n      onClick={handleClick}\n      className=\"text-entity-link\"\n      dir=\"auto\"\n      data-entity-type={userId ? ApiMessageEntityTypes.MentionName : ApiMessageEntityTypes.Mention}\n    >\n      {children}\n    </a>\n  );\n};\n\nexport default withGlobal<OwnProps>(\n  (global, { userId }): Complete<StateProps> => {\n    return {\n      userOrChat: userId ? selectUser(global, userId) : undefined,\n    };\n  },\n)(MentionLink);\n","import type {\n  GlobalState,\n} from '../types';\nimport {\n  type ApiMessage,\n  type MediaContainer,\n  type SizeTarget,\n} from '../../api/types';\n\nimport { NSFW_RESTRICTION_REASON } from '../../config';\nimport {\n  getMessageAudio,\n  getMessageContent,\n  getMessageDocument,\n  getMessageInvoice,\n  getMessageMediaHash,\n  getMessagePhoto,\n  getMessageSingleCustomEmoji,\n  getMessageSingleRegularEmoji,\n  getMessageSticker,\n  getMessageVideo,\n  getMessageVoice,\n  getWebPageAudio,\n  getWebPagePhoto,\n  getWebPageVideo,\n} from '../helpers';\nimport { selectChat } from './chats';\nimport {\n  selectActiveRestrictionReasons,\n  selectReplyMessage,\n  selectWebPageFromMessage,\n} from './messages';\nimport { selectSettingsKeys } from './settings';\nimport { selectAnimatedEmoji, selectCustomEmoji } from './symbols';\n\nexport function selectIsMediaNsfw<T extends GlobalState>(global: T, message: ApiMessage) {\n  const { isSensitiveEnabled } = selectSettingsKeys(global);\n  const chat = selectChat(global, message.chatId);\n  if (isSensitiveEnabled) return false;\n\n  const chatActiveRestrictions = selectActiveRestrictionReasons(global, chat?.restrictionReasons);\n  const messageActiveRestrictions = selectActiveRestrictionReasons(global, message.restrictionReasons);\n\n  return chatActiveRestrictions.some((reason) => reason.reason === NSFW_RESTRICTION_REASON)\n    || messageActiveRestrictions.some((reason) => reason.reason === NSFW_RESTRICTION_REASON);\n}\n\nexport function selectMessageDownloadableMedia<T extends GlobalState>(global: T, message: MediaContainer) {\n  const singleEmoji = getMessageSingleRegularEmoji(message);\n  const animatedEmoji = singleEmoji && selectAnimatedEmoji(global, singleEmoji);\n  const animatedCustomEmojiId = getMessageSingleCustomEmoji(message);\n  const customEmoji = animatedCustomEmojiId && selectCustomEmoji(global, animatedCustomEmojiId);\n\n  const webPage = selectWebPageFromMessage(global, message);\n  return (\n    customEmoji || animatedEmoji\n    || getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getMessageAudio(message)\n    || getMessageVoice(message)\n    || getWebPagePhoto(webPage)\n    || getWebPageVideo(webPage)\n    || getWebPageAudio(webPage)\n  );\n}\n\nexport function selectMessageMediaThumbnail<T extends GlobalState>(global: T, message: MediaContainer) {\n  const webPage = selectWebPageFromMessage(global, message);\n  const media = getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getWebPagePhoto(webPage)\n    || getWebPageVideo(webPage)\n    || getMessageInvoice(message)?.extendedMedia;\n\n  if (!media) {\n    return undefined;\n  }\n\n  return media.thumbnail;\n}\n\nexport function selectMessageMediaThumbDataUri<T extends GlobalState>(global: T, message: MediaContainer) {\n  const thumbnail = selectMessageMediaThumbnail(global, message);\n  return thumbnail?.dataUri;\n}\n\nexport function selectMessageMediaHash<T extends GlobalState>(\n  global: T,\n  message: MediaContainer,\n  target: SizeTarget,\n) {\n  const webPage = selectWebPageFromMessage(global, message);\n\n  return getMessageMediaHash(message, { webPage }, target);\n}\n\nexport function selectMessageMediaDuration<T extends GlobalState>(global: T, message: MediaContainer) {\n  const { audio, voice, video } = getMessageContent(message);\n  const webPage = selectWebPageFromMessage(global, message);\n  const media = audio || voice || video || getWebPageVideo(webPage) || getWebPageAudio(webPage);\n  if (!media) {\n    return undefined;\n  }\n\n  return media.duration;\n}\n\nexport function selectTimestampableMedia<T extends GlobalState>(global: T, message: MediaContainer) {\n  const webPage = selectWebPageFromMessage(global, message);\n  const video = getMessageVideo(message) || getWebPageVideo(webPage);\n  return (video && !video.isRound && !video.isGif ? video : undefined)\n    || getMessageAudio(message)\n    || getMessageVoice(message);\n}\n\nexport function selectMessageTimestampableDuration<T extends GlobalState>(\n  global: T, message: ApiMessage, noReplies?: boolean,\n) {\n  const replyMessage = !noReplies ? selectReplyMessage(global, message) : undefined;\n\n  const timestampableMedia = selectTimestampableMedia(global, message);\n  const replyTimestampableMedia = replyMessage && selectTimestampableMedia(global, replyMessage);\n\n  return timestampableMedia?.duration || replyTimestampableMedia?.duration;\n}\n\nexport function selectMessageLastPlaybackTimestamp<T extends GlobalState>(\n  global: T, chatId: string, messageId: number,\n) {\n  return global.messages.playbackByChatId[chatId]?.byId[messageId];\n}\n","import { useEffect, useState } from '../lib/teact/teact';\n\nfunction useAsync<T>(fn: () => Promise<T>, deps: unknown[], defaultValue: T): {\n  isLoading: boolean;\n  error: Error | undefined;\n  result: T;\n};\nfunction useAsync<T>(fn: () => Promise<T>, deps: unknown[]): {\n  isLoading: boolean;\n  error: Error | undefined;\n  result: T | undefined;\n};\nfunction useAsync<T>(fn: () => Promise<T>, deps: unknown[], defaultValue?: T) {\n  const [isLoading, setIsLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | undefined>();\n  const [result, setResult] = useState<T | undefined>(defaultValue);\n  useEffect(() => {\n    setIsLoading(true);\n    let wasCancelled = false;\n    fn().then((res) => {\n      if (wasCancelled) return;\n      setIsLoading(false);\n      setResult(res);\n    }, (err) => {\n      if (wasCancelled) return;\n      setIsLoading(false);\n      setError(err);\n    });\n    return () => {\n      wasCancelled = true;\n    };\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, deps);\n  return { isLoading, error, result };\n};\n\nexport default useAsync;\n","import {\n  memo, useEffect, useRef, useSignal, useUnmountCleanup,\n} from '../../lib/teact/teact';\n\nimport {\n  type ApiFormattedText,\n} from '../../api/types';\n\nimport useDerivedState from '../../hooks/useDerivedState';\nimport useLastCallback from '../../hooks/useLastCallback';\n\ntype OwnProps = {\n  text: ApiFormattedText;\n  duration?: number;\n  children: (text: ApiFormattedText) => React.ReactNode;\n};\n\nconst DEFAULT_HEADWAY_DURATION = 1000;\nconst MIN_TIMEOUT_DURATION = 1000 / 60; // 60 FPS\nconst MAX_SYMBOLS_BATCH = 10;\n\nconst TypingWrapper = ({\n  text,\n  duration = DEFAULT_HEADWAY_DURATION,\n  children,\n}: OwnProps) => {\n  const [getCurrentTextLength, setCurrentTextLength] = useSignal(text.text.length);\n  const intervalRef = useRef<number>();\n\n  const animate = useLastCallback(() => {\n    const msPerSymbol = duration / text.text.length;\n    const timeoutDuration = Math.max(msPerSymbol, MIN_TIMEOUT_DURATION);\n    const nextSymbolBatchLength = Math.min(Math.ceil(timeoutDuration / msPerSymbol), MAX_SYMBOLS_BATCH);\n\n    intervalRef.current = window.setTimeout(() => {\n      if (getCurrentTextLength() >= text.text.length) {\n        clearTimeout(intervalRef.current);\n        return;\n      }\n\n      setCurrentTextLength(getCurrentTextLength() + nextSymbolBatchLength);\n    }, timeoutDuration);\n  });\n\n  useEffect(() => {\n    // Text got shorter, skip animation\n    if (text.text.length < getCurrentTextLength()) {\n      clearTimeout(intervalRef.current);\n      setCurrentTextLength(text.text.length);\n      return;\n    }\n\n    clearTimeout(intervalRef.current);\n    animate();\n  }, [getCurrentTextLength, setCurrentTextLength, text.text.length]);\n\n  useUnmountCleanup(() => {\n    clearTimeout(intervalRef.current);\n  });\n\n  const displayedText = useDerivedState(() => {\n    return {\n      ...text,\n      text: text.text.slice(0, getCurrentTextLength()),\n    };\n  }, [getCurrentTextLength, text]);\n\n  return children(displayedText);\n};\n\nexport default memo(TypingWrapper);\n","import {\n  memo, useMemo, useRef,\n} from '../../lib/teact/teact';\n\nimport type { ApiFormattedText, ApiMessage, ApiStory } from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport type { ThreadId } from '../../types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { extractMessageText, stripCustomEmoji } from '../../global/helpers';\nimport trimText from '../../util/trimText';\nimport { insertTextEntity, renderTextWithEntities } from './helpers/renderTextWithEntities';\n\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useUniqueId from '../../hooks/useUniqueId';\n\nimport TypingWrapper from './TypingWrapper';\n\ninterface OwnProps {\n  messageOrStory: ApiMessage | ApiStory;\n  threadId?: ThreadId;\n  translatedText?: ApiFormattedText;\n  isForAnimation?: boolean;\n  emojiSize?: number;\n  highlight?: string;\n  asPreview?: boolean;\n  truncateLength?: number;\n  isProtected?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  withTranslucentThumbs?: boolean;\n  shouldRenderAsHtml?: boolean;\n  inChatList?: boolean;\n  forcePlayback?: boolean;\n  focusedQuote?: string;\n  focusedQuoteOffset?: number;\n  isInSelectMode?: boolean;\n  canBeEmpty?: boolean;\n  maxTimestamp?: number;\n  shouldAnimateTyping?: boolean;\n}\n\nconst MIN_CUSTOM_EMOJIS_FOR_SHARED_CANVAS = 3;\n\nfunction MessageText({\n  messageOrStory,\n  translatedText,\n  isForAnimation,\n  emojiSize,\n  highlight,\n  asPreview,\n  truncateLength,\n  isProtected,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  withTranslucentThumbs,\n  shouldRenderAsHtml,\n  inChatList,\n  forcePlayback,\n  focusedQuote,\n  focusedQuoteOffset,\n  isInSelectMode,\n  canBeEmpty,\n  maxTimestamp,\n  threadId,\n  shouldAnimateTyping,\n}: OwnProps) {\n  const sharedCanvasRef = useRef<HTMLCanvasElement>();\n  const sharedCanvasHqRef = useRef<HTMLCanvasElement>();\n\n  const textCacheBusterRef = useRef(0);\n\n  const lang = useLang();\n\n  const formattedText = translatedText || extractMessageText(messageOrStory, inChatList);\n  const adaptedFormattedText = isForAnimation && formattedText ? stripCustomEmoji(formattedText) : formattedText;\n  const { text, entities } = adaptedFormattedText || {};\n\n  const entitiesWithFocusedQuote = useMemo(() => {\n    if (!text || !focusedQuote) return entities;\n\n    const offsetIndex = text.indexOf(focusedQuote, focusedQuoteOffset);\n    const index = offsetIndex >= 0 ? offsetIndex : text.indexOf(focusedQuote); // Fallback to first occurrence\n    const lendth = focusedQuote.length;\n    if (index >= 0) {\n      return insertTextEntity(entities || [], {\n        offset: index,\n        length: lendth,\n        type: ApiMessageEntityTypes.QuoteFocus,\n      });\n    }\n\n    return entities;\n  }, [text, entities, focusedQuote, focusedQuoteOffset]);\n\n  const containerId = useUniqueId();\n\n  useSyncEffect(() => {\n    textCacheBusterRef.current += 1;\n  }, [text, entitiesWithFocusedQuote]);\n\n  const withSharedCanvas = useMemo(() => {\n    const hasSpoilers = entitiesWithFocusedQuote?.some((e) => e.type === ApiMessageEntityTypes.Spoiler);\n    if (hasSpoilers) {\n      return false;\n    }\n\n    const customEmojisCount = entitiesWithFocusedQuote\n      ?.filter((e) => e.type === ApiMessageEntityTypes.CustomEmoji).length || 0;\n    return customEmojisCount >= MIN_CUSTOM_EMOJIS_FOR_SHARED_CANVAS;\n  }, [entitiesWithFocusedQuote]) || 0;\n\n  const renderText = useLastCallback((t: ApiFormattedText) => {\n    return renderTextWithEntities({\n      text: t.text,\n      entities: t.entities,\n      highlight,\n      emojiSize,\n      shouldRenderAsHtml,\n      containerId,\n      asPreview,\n      isProtected,\n      observeIntersectionForLoading,\n      observeIntersectionForPlaying,\n      withTranslucentThumbs,\n      sharedCanvasRef,\n      sharedCanvasHqRef,\n      cacheBuster: textCacheBusterRef.current.toString(),\n      forcePlayback,\n      isInSelectMode,\n      maxTimestamp,\n      chatId: 'chatId' in messageOrStory ? messageOrStory.chatId : undefined,\n      messageId: messageOrStory.id,\n      threadId,\n    });\n  });\n\n  if (!text && !canBeEmpty) {\n    return <span className=\"content-unsupported\">{lang('MessageUnsupported')}</span>;\n  }\n\n  const textToRender: ApiFormattedText = {\n    text: trimText(text || '', truncateLength),\n    entities: entitiesWithFocusedQuote,\n  };\n\n  return (\n    <>\n      {[\n        withSharedCanvas && <canvas key=\"shared-canvas\" ref={sharedCanvasRef} className=\"shared-canvas\" />,\n        withSharedCanvas && <canvas key=\"shared-canvas-hq\" ref={sharedCanvasHqRef} className=\"shared-canvas\" />,\n        shouldAnimateTyping ? (\n          <TypingWrapper key=\"typing-wrapper\" text={textToRender}>{renderText}</TypingWrapper>\n        ) : renderText(textToRender),\n      ].flat().filter(Boolean)}\n    </>\n  );\n}\n\nexport default memo(MessageText);\n","import type { ApiMessage } from '../../api/types';\n\nexport type SearchResultKey = `${string}_${number}`;\n\nexport function getSearchResultKey(message: ApiMessage): SearchResultKey {\n  const { chatId, id } = message;\n\n  return `${chatId}_${id}`;\n}\n\nexport function parseSearchResultKey(key: SearchResultKey) {\n  const [chatId, messageId] = key.split('_');\n\n  return [chatId, Number(messageId)] as const;\n}\n","import buildClassName from '../../util/buildClassName';\n\nimport './Spinner.scss';\n\ntype OwnProps = {\n  color?: 'blue' | 'white' | 'black' | 'green' | 'gray' | 'yellow';\n  backgroundColor?: 'light' | 'dark';\n  className?: string;\n};\n\nconst Spinner = ({\n  color = 'blue',\n  backgroundColor,\n  className,\n}: OwnProps) => {\n  return (\n    <div className={buildClassName(\n      'Spinner', className, color, backgroundColor && 'with-background', backgroundColor && `bg-${backgroundColor}`,\n    )}\n    >\n      <div className=\"Spinner__inner\" />\n    </div>\n  );\n};\n\nexport default Spinner;\n","import type {\n  ElementRef } from '../../lib/teact/teact';\nimport {\n  useEffect, useLayoutEffect, useRef, useState,\n} from '../../lib/teact/teact';\n\nimport { requestForcedReflow, requestMeasure, requestMutation } from '../../lib/fasterdom/fasterdom';\nimport calcTextLineHeightAndCount from '../../util/element/calcTextLineHeightAndCount';\nimport useDebouncedCallback from '../useDebouncedCallback';\nimport useLastCallback from '../useLastCallback';\nimport useWindowSize from '../window/useWindowSize';\n\nconst WINDOW_RESIZE_LINE_RECALC_DEBOUNCE = 200;\n\nexport default function useCollapsibleLines<T extends HTMLElement, C extends HTMLElement>(\n  ref: ElementRef<T>,\n  maxLinesBeforeCollapse: number,\n  cutoutRef?: ElementRef<C>,\n  isDisabled?: boolean,\n) {\n  const isFirstRenderRef = useRef(true);\n  const cutoutHeightRef = useRef<number | undefined>();\n  const fullHeightRef = useRef<number | undefined>();\n  const [isCollapsible, setIsCollapsible] = useState(!isDisabled);\n  const [isCollapsed, setIsCollapsed] = useState(isCollapsible);\n\n  useLayoutEffect(() => {\n    const element = (cutoutRef || ref).current;\n    const shouldUseStyleInExpand = !cutoutRef;\n\n    if (isDisabled || !element || isFirstRenderRef.current) return;\n\n    requestMutation(() => {\n      element.style.maxHeight = isCollapsed ? `${cutoutHeightRef.current}px` :\n        shouldUseStyleInExpand ? `${fullHeightRef.current}px` : ``;\n    });\n  }, [cutoutRef, isCollapsed, isDisabled, ref]);\n\n  const recalculateTextLines = useLastCallback(() => {\n    if (isDisabled || !ref.current) {\n      return;\n    }\n    const element = ref.current;\n\n    const { lineHeight, totalLines } = calcTextLineHeightAndCount(element);\n    fullHeightRef.current = element.scrollHeight;\n    if (totalLines > maxLinesBeforeCollapse) {\n      cutoutHeightRef.current = lineHeight * maxLinesBeforeCollapse;\n      setIsCollapsible(true);\n    } else {\n      setIsCollapsible(false);\n      setIsCollapsed(false);\n    }\n  });\n\n  const debouncedRecalcTextLines = useDebouncedCallback(\n    () => requestMeasure(recalculateTextLines),\n    [recalculateTextLines],\n    WINDOW_RESIZE_LINE_RECALC_DEBOUNCE,\n  );\n\n  useLayoutEffect(() => {\n    if (!isDisabled && isFirstRenderRef.current) {\n      requestForcedReflow(() => {\n        recalculateTextLines();\n\n        return () => {\n          isFirstRenderRef.current = false;\n          const element = (cutoutRef || ref).current;\n          if (!element) return;\n          element.style.maxHeight = cutoutHeightRef.current ?\n            `${cutoutHeightRef.current}px` :\n            `${fullHeightRef.current}px`;\n        };\n      });\n    }\n  }, [cutoutRef, isDisabled, recalculateTextLines, ref]);\n\n  // Parent resize is triggered on every collapse/expand, so we do recalculation only on window resize to save resources\n  const { width: windowWidth } = useWindowSize();\n  useEffect(() => {\n    if (!isDisabled) {\n      if (isFirstRenderRef.current) return;\n\n      debouncedRecalcTextLines();\n    } else {\n      setIsCollapsible(false);\n      setIsCollapsed(false);\n    }\n  }, [debouncedRecalcTextLines, isDisabled, windowWidth]);\n\n  return {\n    isCollapsed,\n    isCollapsible,\n    setIsCollapsed,\n  };\n}\n","import type { ApiSessionData } from '../api/types';\nimport type { DcId, SharedSessionData } from '../types';\n\nimport {\n  DC_IDS,\n  DEBUG, IS_SCREEN_LOCKED_CACHE_KEY,\n  SESSION_ACCOUNT_PREFIX,\n  SESSION_LEGACY_USER_KEY,\n} from '../config';\nimport { ACCOUNT_SLOT, storeAccountData, writeSlotSession } from './multiaccount';\n\nexport function hasStoredSession() {\n  if (checkSessionLocked()) {\n    return true;\n  }\n\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n  if (slotData) return Boolean(slotData.dcId);\n\n  if (!ACCOUNT_SLOT) {\n    const legacyAuthJson = localStorage.getItem(SESSION_LEGACY_USER_KEY);\n    if (legacyAuthJson) {\n      try {\n        const userAuth = JSON.parse(legacyAuthJson);\n        return Boolean(userAuth && userAuth.id && userAuth.dcID);\n      } catch (err) {\n        // Do nothing.\n        return false;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function storeSession(sessionData: ApiSessionData) {\n  const {\n    mainDcId, keys, isTest,\n  } = sessionData;\n\n  const currentSlotData = loadSlotSession(ACCOUNT_SLOT);\n  const newSlotData: SharedSessionData = {\n    ...currentSlotData,\n    dcId: mainDcId,\n    isTest,\n  };\n\n  Object.keys(keys).map(Number).forEach((dcId) => {\n    newSlotData[`dc${dcId as DcId}_auth_key`] = keys[dcId];\n  });\n\n  if (!ACCOUNT_SLOT) {\n    storeLegacySession(sessionData, currentSlotData?.userId);\n  }\n\n  writeSlotSession(ACCOUNT_SLOT, newSlotData);\n}\n\nfunction storeLegacySession(sessionData: ApiSessionData, currentUserId?: string) {\n  const {\n    mainDcId, keys, isTest,\n  } = sessionData;\n\n  localStorage.setItem(SESSION_LEGACY_USER_KEY, JSON.stringify({\n    dcID: mainDcId,\n    id: currentUserId,\n    test: isTest,\n  }));\n  localStorage.setItem('dc', String(mainDcId));\n  Object.keys(keys).map(Number).forEach((dcId) => {\n    localStorage.setItem(`dc${dcId}_auth_key`, JSON.stringify(keys[dcId]));\n  });\n}\n\nexport function clearStoredSession(slot?: number) {\n  if (!slot) {\n    clearStoredLegacySession();\n  }\n\n  localStorage.removeItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`);\n}\n\nfunction clearStoredLegacySession() {\n  [\n    SESSION_LEGACY_USER_KEY,\n    'dc',\n    ...DC_IDS.map((dcId) => `dc${dcId}_auth_key`),\n    ...DC_IDS.map((dcId) => `dc${dcId}_hash`),\n    ...DC_IDS.map((dcId) => `dc${dcId}_server_salt`),\n  ].forEach((key) => {\n    localStorage.removeItem(key);\n  });\n}\n\nexport function loadStoredSession(): ApiSessionData | undefined {\n  if (!hasStoredSession()) {\n    return undefined;\n  }\n\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n\n  if (!slotData) {\n    if (ACCOUNT_SLOT) return undefined;\n    return loadStoredLegacySession();\n  }\n\n  const sessionData: ApiSessionData = {\n    mainDcId: slotData.dcId,\n    keys: DC_IDS.reduce((acc, dcId) => {\n      const key = slotData[`dc${dcId}_auth_key` as const];\n      if (key) {\n        acc[dcId] = key;\n      }\n      return acc;\n    }, {} as Record<number, string>),\n    isTest: slotData.isTest || undefined,\n  };\n\n  return sessionData;\n}\n\nfunction loadStoredLegacySession(): ApiSessionData | undefined {\n  if (!hasStoredSession()) {\n    return undefined;\n  }\n\n  const userAuth = JSON.parse(localStorage.getItem(SESSION_LEGACY_USER_KEY) || 'null');\n  if (!userAuth) {\n    return undefined;\n  }\n  const mainDcId = Number(userAuth.dcID);\n  const isTest = userAuth.test;\n  const keys: Record<number, string> = {};\n\n  DC_IDS.forEach((dcId) => {\n    try {\n      const key = localStorage.getItem(`dc${dcId}_auth_key`);\n      if (key) {\n        keys[dcId] = JSON.parse(key);\n      }\n    } catch (err) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.warn('Failed to load stored session', err);\n      }\n      // Do nothing.\n    }\n  });\n\n  if (!Object.keys(keys).length) return undefined;\n\n  return {\n    mainDcId,\n    keys,\n    isTest,\n  };\n}\n\nexport function loadSlotSession(slot: number | undefined): SharedSessionData | undefined {\n  try {\n    const data = JSON.parse(localStorage.getItem(`${SESSION_ACCOUNT_PREFIX}${slot || 1}`) || '{}') as SharedSessionData;\n    if (!data.dcId) return undefined;\n    return data;\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function updateSessionUserId(currentUserId: string) {\n  const slotData = loadSlotSession(ACCOUNT_SLOT);\n  if (!slotData) return;\n  storeAccountData(ACCOUNT_SLOT, { userId: currentUserId });\n}\n\nexport function importTestSession() {\n  const sessionJson = process.env.TEST_SESSION!;\n  try {\n    const sessionData = JSON.parse(sessionJson) as ApiSessionData & { userId: string };\n    storeLegacySession(sessionData, sessionData.userId);\n  } catch (err) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.warn('Failed to load test session', err);\n    }\n  }\n}\n\nexport function checkSessionLocked() {\n  return localStorage.getItem(IS_SCREEN_LOCKED_CACHE_KEY) === 'true';\n}\n","const LOG_BACKGROUND = '#111111DD';\nconst LOG_PREFIX_COLOR = '#9B59B6';\nconst LOG_SUFFIX = {\n  CONNECTING: '#E4D00A',\n  CONNECTED: '#26D907',\n  DISCONNECTED: '#9C9C9C',\n  'CONNECTION ERROR': '#D1191C',\n  'AUTH ERROR': '#D1191C',\n  'BACKEND ERROR': '#D1191C',\n  'STREAM ERROR': '#D1191C',\n  STATE: '#49DBF5',\n  REQUEST: '#6887F7',\n  RESPONSE: '#0DD151',\n  UPDATE: '#F549DB',\n  WARN: '#FFA500',\n};\n\nexport function log(suffix: keyof typeof LOG_SUFFIX, ...data: any) {\n  /* eslint-disable @stylistic/max-len */\n  /* eslint-disable no-console */\n  const func = suffix === 'CONNECTION ERROR' || suffix === 'AUTH ERROR' || suffix === 'BACKEND ERROR' || suffix === 'STREAM ERROR'\n    ? console.error\n    : suffix === 'WARN' ? console.warn : console.log;\n  /* eslint-enable no-console */\n  func(\n    `%cAiSocket%c${suffix}`,\n    `color: ${LOG_PREFIX_COLOR}; background: ${LOG_BACKGROUND}; padding: 0.25rem; border-radius: 0.25rem;`,\n    `color: ${LOG_SUFFIX[suffix]}; background: ${LOG_BACKGROUND}; padding: 0.25rem; border-radius: 0.25rem; margin-left: 0.25rem;`,\n    ...data,\n  );\n  /* eslint-enable @stylistic/max-len */\n}\n","const SAMPLE_RATE = 48000;\nconst BIT_DEPTH = 16;\n\nexport async function oggToWav(opusData: Blob): Promise<Blob> {\n  const arrayBuffer = await new Response(opusData).arrayBuffer();\n\n  return new Promise((resolve) => {\n    const typedArray = new Uint8Array(arrayBuffer);\n\n    let decoderWorker: Worker | undefined = new Worker(\n      new URL('opus-recorder/dist/decoderWorker.min.js', import.meta.url),\n    );\n    let wavWorker: Worker | undefined = new Worker(new URL('opus-recorder/dist/waveWorker.min.js', import.meta.url));\n\n    decoderWorker.onmessage = (e) => {\n      // eslint-disable-next-line no-null/no-null\n      if (e.data === null) {\n        // `null` means decoder is finished\n        wavWorker!.postMessage({ command: 'done' });\n      } else {\n        // `e.data` contains decoded buffers as float32 values\n        wavWorker!.postMessage(\n          {\n            command: 'encode',\n            buffers: e.data,\n          },\n          e.data.map(({ buffer }: Float32Array) => buffer),\n        );\n      }\n    };\n\n    wavWorker.onmessage = (e) => {\n      if (e.data.message === 'page') {\n        resolve(new Blob([e.data.page], { type: 'audio/wav' }));\n\n        decoderWorker!.terminate();\n        decoderWorker = undefined;\n        wavWorker!.terminate();\n        wavWorker = undefined;\n      }\n    };\n\n    wavWorker.postMessage({\n      command: 'init',\n      wavBitDepth: BIT_DEPTH,\n      wavSampleRate: SAMPLE_RATE,\n    });\n\n    decoderWorker.postMessage({\n      command: 'init',\n      decoderSampleRate: SAMPLE_RATE,\n      outputBufferSampleRate: SAMPLE_RATE,\n    });\n\n    decoderWorker.postMessage({\n      command: 'decode',\n      pages: typedArray,\n    }, [typedArray.buffer]);\n  });\n}\n","import type {\n  ApiOnProgress,\n  ApiParsedMedia,\n  ApiPreparedMedia,\n} from '../api/types';\nimport {\n  ApiMediaFormat,\n} from '../api/types';\n\nimport {\n  DEBUG, MEDIA_CACHE_DISABLED, MEDIA_CACHE_NAME,\n  MEDIA_CACHE_NAME_AVATARS,\n} from '../config';\nimport { callApi, cancelApiProgress } from '../api/gramjs';\nimport {\n  IS_OPUS_SUPPORTED, IS_PROGRESSIVE_SUPPORTED,\n} from './browser/windowEnvironment';\nimport * as cacheApi from './cacheApi';\nimport { fetchBlob } from './files';\nimport { ACCOUNT_SLOT } from './multiaccount';\nimport { oggToWav } from './oggToWav';\n\nconst asCacheApiType = {\n  [ApiMediaFormat.BlobUrl]: cacheApi.Type.Blob,\n  [ApiMediaFormat.Text]: cacheApi.Type.Text,\n  [ApiMediaFormat.DownloadUrl]: undefined,\n  [ApiMediaFormat.Progressive]: undefined,\n};\n\nconst PROGRESSIVE_URL_PREFIX = './progressive/';\nconst DOWNLOAD_URL_PREFIX = './download/';\nconst MAX_MEDIA_RETRIES = 5;\n\nconst memoryCache = new Map<string, ApiPreparedMedia>();\nconst fetchPromises = new Map<string, Promise<ApiPreparedMedia | undefined>>();\nconst progressCallbacks = new Map<string, Map<string, ApiOnProgress>>();\nconst cancellableCallbacks = new Map<string, ApiOnProgress>();\n\nexport function fetch<T extends ApiMediaFormat>(\n  url: string,\n  mediaFormat: T,\n  isHtmlAllowed = false,\n  onProgress?: ApiOnProgress,\n  callbackUniqueId?: string,\n): Promise<ApiPreparedMedia> {\n  if (mediaFormat === ApiMediaFormat.Progressive) {\n    return (\n      IS_PROGRESSIVE_SUPPORTED\n        ? Promise.resolve(getProgressiveUrl(url))\n        : fetch(url, ApiMediaFormat.BlobUrl, isHtmlAllowed, onProgress, callbackUniqueId)\n    );\n  }\n\n  if (mediaFormat === ApiMediaFormat.DownloadUrl) {\n    return (\n      IS_PROGRESSIVE_SUPPORTED\n        ? Promise.resolve(getDownloadUrl(url))\n        : fetch(url, ApiMediaFormat.BlobUrl, isHtmlAllowed, onProgress, callbackUniqueId)\n    );\n  }\n\n  if (!fetchPromises.has(url)) {\n    const promise = fetchFromCacheOrRemote(url, mediaFormat, isHtmlAllowed)\n      .catch((err) => {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.warn(err);\n        }\n\n        return undefined;\n      })\n      .finally(() => {\n        fetchPromises.delete(url);\n        progressCallbacks.delete(url);\n        cancellableCallbacks.delete(url);\n      });\n\n    fetchPromises.set(url, promise);\n  }\n\n  if (onProgress && callbackUniqueId) {\n    let activeCallbacks = progressCallbacks.get(url);\n    if (!activeCallbacks) {\n      activeCallbacks = new Map<string, ApiOnProgress>();\n      progressCallbacks.set(url, activeCallbacks);\n    }\n    activeCallbacks.set(callbackUniqueId, onProgress);\n  }\n\n  return fetchPromises.get(url) as Promise<ApiPreparedMedia>;\n}\n\nexport function getFromMemory(url: string) {\n  return memoryCache.get(url) as ApiPreparedMedia;\n}\n\nexport function cancelProgress(progressCallback: ApiOnProgress) {\n  progressCallbacks.forEach((map, url) => {\n    map.forEach((callback) => {\n      if (callback === progressCallback) {\n        const parentCallback = cancellableCallbacks.get(url);\n        if (!parentCallback) return;\n\n        cancelApiProgress(parentCallback);\n        cancellableCallbacks.delete(url);\n        progressCallbacks.delete(url);\n        return;\n      }\n    });\n  });\n}\n\nexport function removeCallback(url: string, callbackUniqueId: string) {\n  const callbacks = progressCallbacks.get(url);\n  if (!callbacks) return;\n  callbacks.delete(callbackUniqueId);\n}\n\nexport function getProgressiveUrl(url: string) {\n  const base = new URL(`${PROGRESSIVE_URL_PREFIX}${url}`, window.location.href);\n  if (ACCOUNT_SLOT) base.searchParams.set('account', ACCOUNT_SLOT.toString());\n  return base.href;\n}\n\nfunction getDownloadUrl(url: string) {\n  const base = new URL(`${DOWNLOAD_URL_PREFIX}${url}`, window.location.href);\n  if (ACCOUNT_SLOT) base.searchParams.set('account', ACCOUNT_SLOT.toString());\n  return base.href;\n}\n\nasync function fetchFromCacheOrRemote(\n  url: string, mediaFormat: ApiMediaFormat, isHtmlAllowed: boolean, retryNumber = 0,\n): Promise<string> {\n  if (!MEDIA_CACHE_DISABLED) {\n    const cacheName = url.startsWith('avatar') ? MEDIA_CACHE_NAME_AVATARS : MEDIA_CACHE_NAME;\n    const cached = await cacheApi.fetch(cacheName, url, asCacheApiType[mediaFormat]!, isHtmlAllowed);\n\n    if (cached) {\n      let media = cached;\n\n      if (cached.type === 'audio/ogg' && !IS_OPUS_SUPPORTED) {\n        media = await oggToWav(media);\n      }\n\n      const prepared = prepareMedia(media);\n\n      memoryCache.set(url, prepared);\n\n      return prepared;\n    }\n  }\n\n  const onProgress = makeOnProgress(url);\n  cancellableCallbacks.set(url, onProgress);\n\n  const remote = await callApi('downloadMedia', { url, mediaFormat, isHtmlAllowed }, onProgress);\n  if (!remote) {\n    if (retryNumber >= MAX_MEDIA_RETRIES) {\n      throw new Error(`Failed to fetch media ${url}`);\n    }\n    await new Promise((resolve) => {\n      setTimeout(resolve, getRetryTimeout(retryNumber));\n    });\n    // eslint-disable-next-line no-console\n    if (DEBUG) console.debug(`Retrying to fetch media ${url}`);\n    return fetchFromCacheOrRemote(url, mediaFormat, isHtmlAllowed, retryNumber + 1);\n  }\n\n  let { mimeType } = remote;\n  let prepared = prepareMedia(remote.dataBlob);\n\n  if (mimeType === 'audio/ogg' && !IS_OPUS_SUPPORTED) {\n    const blob = await fetchBlob(prepared);\n    URL.revokeObjectURL(prepared);\n    const media = await oggToWav(blob);\n    prepared = prepareMedia(media);\n    mimeType = media.type;\n  }\n\n  memoryCache.set(url, prepared);\n\n  return prepared;\n}\n\nfunction makeOnProgress(url: string) {\n  const onProgress: ApiOnProgress = (progress: number) => {\n    progressCallbacks.get(url)?.forEach((callback) => {\n      callback(progress);\n      if (callback.isCanceled) {\n        onProgress.isCanceled = true;\n        memoryCache.delete(url);\n      }\n    });\n  };\n\n  return onProgress;\n}\n\nfunction prepareMedia(mediaData: Exclude<ApiParsedMedia, ArrayBuffer>): ApiPreparedMedia {\n  if (mediaData instanceof Blob) {\n    return URL.createObjectURL(mediaData);\n  }\n\n  return mediaData;\n}\n\nif (IS_PROGRESSIVE_SUPPORTED) {\n  navigator.serviceWorker.addEventListener('message', async (e) => {\n    const { type, messageId, params } = e.data as {\n      type: string;\n      messageId: string;\n      params: { url: string; start: number; end: number };\n    };\n\n    if (type !== 'requestPart') {\n      return;\n    }\n\n    async function downloadWithRetry(retryNumber = 0) {\n      const result = await callApi('downloadMedia', { mediaFormat: ApiMediaFormat.Progressive, ...params });\n      if (!result) {\n        if (retryNumber >= MAX_MEDIA_RETRIES) {\n          if (DEBUG) {\n            // eslint-disable-next-line no-console\n            console.warn(`Failed to download media part after ${MAX_MEDIA_RETRIES} retries:`, params.url);\n          }\n          return undefined;\n        }\n        await new Promise((resolve) => {\n          setTimeout(resolve, getRetryTimeout(retryNumber));\n        });\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.debug(`Retrying to download media part ${params.url}, attempt ${retryNumber + 1}`);\n        }\n        return downloadWithRetry(retryNumber + 1);\n      }\n      return result;\n    }\n\n    const result = await downloadWithRetry();\n    if (!result) {\n      return;\n    }\n\n    const { arrayBuffer, mimeType, fullSize } = result;\n\n    navigator.serviceWorker.controller!.postMessage({\n      type: 'partResponse',\n      messageId,\n      result: {\n        arrayBuffer,\n        mimeType,\n        fullSize,\n      },\n    }, [arrayBuffer!]);\n  });\n}\n\nfunction getRetryTimeout(retryNumber: number) {\n  // 250ms, 500ms, 1s, 2s, 4s\n  return 250 * 2 ** retryNumber;\n}\n","import { getGlobal } from '../../../../global';\n\nimport type { ApiMessageEntityCustomEmoji, ApiSticker } from '../../../../api/types';\nimport { ApiMessageEntityTypes } from '../../../../api/types';\n\nimport { EMOJI_SIZES } from '../../../../config';\nimport { selectCustomEmoji } from '../../../../global/selectors';\nimport buildClassName from '../../../../util/buildClassName';\nimport { getInputCustomEmojiParams } from '../../../../util/emoji/customEmojiManager';\nimport { REM } from '../../../common/helpers/mediaDimensions';\n\nexport const INPUT_CUSTOM_EMOJI_SELECTOR = 'img[data-document-id]';\n\nexport function buildCustomEmojiHtml(emoji: ApiSticker) {\n  const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(emoji);\n\n  const className = buildClassName(\n    'custom-emoji', 'emoji', 'emoji-small', isPlaceholder && 'placeholder', emoji.shouldUseTextColor && 'colorable',\n  );\n\n  return `<img\n    class=\"${className}\"\n    draggable=\"false\"\n    alt=\"${emoji.emoji}\"\n    data-document-id=\"${emoji.id}\"\n    ${uniqueId ? `data-unique-id=\"${uniqueId}\"` : ''}\n    data-entity-type=\"${ApiMessageEntityTypes.CustomEmoji}\"\n    src=\"${src}\"\n  />`;\n}\n\nexport function buildCustomEmojiHtmlFromEntity(rawText: string, entity: ApiMessageEntityCustomEmoji) {\n  const customEmoji = selectCustomEmoji(getGlobal(), entity.documentId);\n  const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(customEmoji);\n\n  const className = buildClassName(\n    'custom-emoji',\n    'emoji',\n    'emoji-small',\n    isPlaceholder && 'placeholder',\n    customEmoji?.shouldUseTextColor && 'colorable',\n  );\n\n  return `<img\n    class=\"${className}\"\n    draggable=\"false\"\n    alt=\"${rawText}\"\n    data-document-id=\"${entity.documentId}\"\n    ${uniqueId ? `data-unique-id=\"${uniqueId}\"` : ''}\n    data-entity-type=\"${ApiMessageEntityTypes.CustomEmoji}\"\n    src=\"${src}\"\n  />`;\n}\n\nexport function getCustomEmojiSize(maxEmojisInLine?: number): number | undefined {\n  if (!maxEmojisInLine) return undefined;\n\n  // Should be the same as in _message-content.scss\n  if (maxEmojisInLine > EMOJI_SIZES) return 2.25 * REM;\n  if (maxEmojisInLine === 1) return 7 * REM;\n  return Math.min(7.5 - (maxEmojisInLine * 0.75), 5.625) * REM;\n}\n","export default function trimText<T extends string | undefined>(text: T, length?: number) {\n  if (!text || !length || text.length <= length) {\n    return text;\n  }\n\n  return `${text.substring(0, length)}...`;\n}\n","import * as langProvider from '../util/oldLangProvider';\nimport useEffectOnce from './useEffectOnce';\nimport useForceUpdate from './useForceUpdate';\n\nexport type OldLangFn = langProvider.LangFn;\n/**\n * @deprecated\n */\nconst useOldLang = (): OldLangFn => {\n  const forceUpdate = useForceUpdate();\n\n  useEffectOnce(() => {\n    return langProvider.addCallback(forceUpdate);\n  });\n\n  return langProvider.getTranslationFn();\n};\n\nexport default useOldLang;\n","import { onFullyIdle } from '../../lib/teact/teact';\nimport { addCallback } from '../../lib/teact/teactn';\nimport { getActions, getGlobal, setGlobal } from '../../global';\n\nimport type { LocalDb } from '../../api/gramjs/localDb';\nimport type { MethodArgs, Methods } from '../../api/gramjs/methods/types';\nimport type { ApiInitialArgs } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\n\nimport { selectTabState } from '../../global/selectors';\nimport {\n  callApiLocal,\n  cancelApiProgressMaster,\n  handleMethodCallback,\n  handleMethodResponse,\n  initApi,\n  updateFullLocalDb,\n  updateLocalDb,\n} from '../../api/gramjs';\nimport { deepDiff } from '../deepDiff';\nimport { deepMerge } from '../deepMerge';\nimport { getCurrentTabId, signalPasscodeHash, subscribeToTokenDied } from '../establishMultitabRole';\nimport { omit } from '../iteratees';\nimport { DATA_BROADCAST_CHANNEL_NAME, MULTITAB_STORAGE_KEY } from '../multiaccount';\n\ntype BroadcastChannelRefreshLangpack = {\n  type: 'langpackRefresh';\n  langCode: string;\n};\n\ntype BroadcastChannelRequestGlobal = {\n  type: 'requestGlobal';\n  token?: number;\n  appVersion: string;\n};\n\ntype BroadcastChannelGlobalUpdate = {\n  type: 'globalUpdate';\n  global: GlobalState;\n};\n\ntype BroadcastChannelCancelApiProgress = {\n  type: 'cancelApiProgress';\n  token: number;\n  messageId: string;\n};\n\ntype BroadcastChannelCallApi = {\n  type: 'callApi';\n  token: number;\n  messageId: string;\n  name: keyof Methods;\n  args: MethodArgs<keyof Methods>;\n  withCallback?: boolean;\n};\n\ntype BroadcastChannelMessageResponse = {\n  type: 'messageResponse';\n  token: number;\n  messageId: string;\n  response: any;\n};\n\ntype BroadcastChannelLocalDbUpdate = {\n  type: 'localDbUpdate';\n  batchedUpdates: {\n    name: keyof LocalDb;\n    prop: string;\n    value: any;\n  }[];\n};\n\ntype BroadcastChannelLocalDbUpdateFull = {\n  type: 'localDbUpdateFull';\n  localDb: any;\n};\n\ntype BroadcastChannelMessageCallback = {\n  type: 'messageCallback';\n  token: number;\n  messageId: string;\n  callbackArgs: any;\n};\n\ntype BroadcastChannelGlobalDiff = {\n  type: 'globalDiffUpdate';\n  diff: any;\n};\n\ntype BroadcastChannelInitApi = {\n  type: 'initApi';\n  token: number;\n  initialArgs: ApiInitialArgs;\n};\n\nconst MULTITAB_ESTABLISH_TIMEOUT = 800;\n\nexport type TypedBroadcastChannel = {\n  postMessage: (message: BroadcastChannelMessage) => void;\n  addEventListener: (type: 'message', listener: (event: { data: BroadcastChannelMessage }) => void) => void;\n  removeEventListener: (type: 'message', listener: (event: { data: BroadcastChannelMessage }) => void) => void;\n};\n\ntype BroadcastChannelMessage = (\n  BroadcastChannelRequestGlobal | BroadcastChannelGlobalUpdate | BroadcastChannelCallApi |\n  BroadcastChannelMessageResponse | BroadcastChannelRefreshLangpack |\n  BroadcastChannelMessageCallback | BroadcastChannelCancelApiProgress | BroadcastChannelLocalDbUpdate |\n  BroadcastChannelLocalDbUpdateFull | BroadcastChannelGlobalDiff | BroadcastChannelInitApi\n);\n\nlet resolveGlobalPromise: VoidFunction | undefined;\nlet isFirstGlobalResolved = false;\nlet currentGlobal: GlobalState | undefined;\nlet isDisabled = false;\n\nconst channel = new BroadcastChannel(DATA_BROADCAST_CHANNEL_NAME) as TypedBroadcastChannel;\n\nlet isBroadcastDiffScheduled = false;\nlet lastBroadcastDiffGlobal: GlobalState | undefined;\n\nfunction broadcastDiffOnIdle() {\n  if (isBroadcastDiffScheduled) return;\n\n  isBroadcastDiffScheduled = true;\n  lastBroadcastDiffGlobal = currentGlobal;\n\n  onFullyIdle(() => {\n    const diff = deepDiff(lastBroadcastDiffGlobal, currentGlobal);\n\n    if (typeof diff !== 'symbol') {\n      channel.postMessage({\n        type: 'globalDiffUpdate',\n        diff,\n      });\n    }\n\n    isBroadcastDiffScheduled = false;\n  });\n}\n\nexport function unsubcribeFromMultitabBroadcastChannel() {\n  channel.removeEventListener('message', handleMessage);\n  isDisabled = true;\n}\n\nexport function subscribeToMultitabBroadcastChannel() {\n  subscribeToTokenDied((token) => {\n    if (token === getCurrentTabId()) {\n      unsubcribeFromMultitabBroadcastChannel();\n      const global = getGlobal();\n      const newGlobal = {\n        ...global,\n        byTabId: omit(global.byTabId, [token]),\n      };\n\n      const diff = deepDiff(global, newGlobal);\n\n      if (typeof diff !== 'symbol') {\n        channel.postMessage({\n          type: 'globalDiffUpdate',\n          diff,\n        });\n      }\n      return;\n    }\n    let global = getGlobal();\n    global = {\n      ...global,\n      byTabId: omit(global.byTabId, [token]),\n    };\n\n    setGlobal(global);\n  });\n\n  addCallback((global: GlobalState) => {\n    if (!isFirstGlobalResolved || isDisabled) {\n      currentGlobal = global;\n      return;\n    }\n\n    if (currentGlobal === global) {\n      return;\n    }\n\n    if (!currentGlobal) {\n      currentGlobal = global;\n      channel.postMessage({\n        type: 'globalUpdate',\n        global,\n      });\n      return;\n    }\n\n    broadcastDiffOnIdle();\n\n    currentGlobal = global;\n  });\n\n  channel.addEventListener('message', handleMessage);\n}\n\nexport function handleMessage({ data }: { data: BroadcastChannelMessage }) {\n  if (!data) return;\n\n  switch (data.type) {\n    case 'initApi': {\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const { initialArgs } = data;\n      initApi(getActions().apiUpdate, initialArgs);\n      break;\n    }\n\n    case 'globalDiffUpdate': {\n      if (!isFirstGlobalResolved) return;\n      const { diff } = data;\n      const oldGlobal = getGlobal();\n      const global = deepMerge(oldGlobal, diff);\n\n      // @ts-ignore\n      global.DEBUG_randomId = oldGlobal.DEBUG_randomId;\n\n      currentGlobal = global;\n      setGlobal(global);\n      break;\n    }\n\n    case 'globalUpdate': {\n      if (isFirstGlobalResolved) return;\n      const oldGlobal = getGlobal();\n      // @ts-ignore\n      data.global.DEBUG_randomId = oldGlobal.DEBUG_randomId;\n      currentGlobal = data.global;\n      // eslint-disable-next-line tt-multitab/set-global-only-variable\n      setGlobal(data.global);\n      if (resolveGlobalPromise) {\n        resolveGlobalPromise();\n        resolveGlobalPromise = undefined;\n        isFirstGlobalResolved = true;\n      }\n      break;\n    }\n\n    case 'requestGlobal': {\n      const { appVersion } = data;\n      if (appVersion !== APP_VERSION) {\n        // If app version on the other tab was updated, reload the current page immediately and don't respond\n        // to the other tab's request because our current global might be incompatible with the new version\n        window.location.reload();\n        return;\n      }\n\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n\n      if (!selectTabState(global).isMasterTab) return;\n\n      channel.postMessage({\n        type: 'globalUpdate',\n        global,\n      });\n\n      signalPasscodeHash();\n      break;\n    }\n\n    case 'messageCallback': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      handleMethodCallback(data);\n      break;\n    }\n\n    case 'localDbUpdate': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      const {\n        batchedUpdates,\n      } = data;\n\n      batchedUpdates.forEach(({\n        name,\n        prop,\n        value,\n      }) => {\n        updateLocalDb(name, prop, value);\n      });\n      break;\n    }\n\n    case 'localDbUpdateFull': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (selectTabState(global).isMasterTab) return;\n\n      const { localDb } = data;\n\n      updateFullLocalDb(localDb);\n      break;\n    }\n\n    case 'messageResponse': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n\n      if (selectTabState(global).isMasterTab) return;\n\n      handleMethodResponse(data);\n      break;\n    }\n\n    case 'cancelApiProgress': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const { messageId } = data;\n\n      cancelApiProgressMaster(messageId);\n      break;\n    }\n\n    case 'callApi': {\n      if (!isFirstGlobalResolved) return;\n      const global = getGlobal();\n      if (!selectTabState(global).isMasterTab) return;\n\n      const {\n        name, messageId, token, args, withCallback,\n      } = data;\n\n      const argsWithCallback = (withCallback ? [...args, (...callbackArgs: any[]) => {\n        channel.postMessage({\n          type: 'messageCallback',\n          token,\n          messageId,\n          callbackArgs,\n        });\n      }] : args) as MethodArgs<keyof Methods>;\n\n      (async () => {\n        const result = await (callApiLocal(name, ...argsWithCallback));\n\n        channel.postMessage({\n          type: 'messageResponse',\n          token,\n          messageId,\n          response: result,\n        });\n      })();\n\n      break;\n    }\n\n    case 'langpackRefresh': {\n      getActions().refreshLangPackFromCache({ langCode: data.langCode });\n      break;\n    }\n  }\n}\n\nexport function requestGlobal(appVersion: string): Promise<void> {\n  channel.postMessage({\n    type: 'requestGlobal',\n    appVersion,\n  });\n\n  const resolveWithoutGlobal = () => {\n    if (resolveGlobalPromise) {\n      resolveGlobalPromise();\n      resolveGlobalPromise = undefined;\n    }\n    isFirstGlobalResolved = true;\n  };\n\n  if (localStorage.getItem(MULTITAB_STORAGE_KEY)) {\n    setTimeout(resolveWithoutGlobal, MULTITAB_ESTABLISH_TIMEOUT);\n  } else {\n    resolveWithoutGlobal();\n    return Promise.resolve();\n  }\n\n  return new Promise((resolve) => {\n    resolveGlobalPromise = resolve;\n  });\n}\n\nexport function notifyLangpackUpdate(langCode: string) {\n  channel.postMessage({\n    type: 'langpackRefresh',\n    langCode,\n  });\n}\n","import type { ApiThemeParameters } from '../api/types';\n\nexport function extractCurrentThemeParams(): ApiThemeParameters {\n  const style = getComputedStyle(document.documentElement);\n\n  const backgroundColor = getPropertyHexColor(style, '--color-background')!;\n  const secondaryTextColor = getPropertyHexColor(style, '--color-text-secondary')!;\n\n  const bgColor = backgroundColor;\n  const textColor = getPropertyHexColor(style, '--color-text')!;\n  const buttonColor = getPropertyHexColor(style, '--color-primary')!;\n  const buttonTextColor = getPropertyHexColor(style, '--color-white')!;\n  const linkColor = getPropertyHexColor(style, '--color-links')!;\n  const hintColor = secondaryTextColor;\n  const secondaryBgColor = getPropertyHexColor(style, '--color-background-secondary')!;\n  const sectionSeparatorColor = getPropertyHexColor(style, '--color-divider')!;\n\n  const headerBgColor = backgroundColor;\n  const accentTextColor = getPropertyHexColor(style, '--color-primary')!;\n  const sectionBgColor = backgroundColor;\n  const sectionHeaderTextColor = secondaryTextColor;\n  const subtitleTextColor = hintColor;\n  const destructiveTextColor = getPropertyHexColor(style, '--color-error')!;\n\n  return {\n    bg_color: bgColor,\n    text_color: textColor,\n    hint_color: hintColor,\n    link_color: linkColor,\n    button_color: buttonColor,\n    button_text_color: buttonTextColor,\n    secondary_bg_color: secondaryBgColor,\n    header_bg_color: headerBgColor,\n    accent_text_color: accentTextColor,\n    section_bg_color: sectionBgColor,\n    section_header_text_color: sectionHeaderTextColor,\n    subtitle_text_color: subtitleTextColor,\n    destructive_text_color: destructiveTextColor,\n    section_separator_color: sectionSeparatorColor,\n  };\n}\n\nexport function validateHexColor(color: string) {\n  return /^#[0-9A-F]{6}$/i.test(color);\n}\n\nexport function getPropertyHexColor(style: CSSStyleDeclaration, property: string) {\n  const value = style.getPropertyValue(property);\n  if (!value) return undefined;\n  return prepareHexColor(value.trim()).slice(0, 7);\n}\n\nexport function prepareHexColor(color: string) {\n  if (validateHexColor(color)) return color;\n  return `#${color.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+\\.{0,1}\\d*))?\\)$/)!\n    .slice(1)\n    .map((n: string, i: number) => (i === 3 ? Math.round(parseFloat(n) * 255) : parseFloat(n))\n      .toString(16)\n      .padStart(2, '0')\n      .replace('NaN', ''))\n    .join('')}`;\n}\n","import { getGlobal } from '../global';\n\nimport type { ApiOldLangPack, ApiOldLangString } from '../api/types';\nimport type { LangCode, TimeFormat } from '../types';\n\nimport {\n  LANG_CACHE_NAME, LANG_PACKS,\n} from '../config';\nimport { selectSharedSettings } from '../global/selectors/sharedState';\nimport { callApi } from '../api/gramjs';\nimport * as cacheApi from './cacheApi';\nimport { createCallbackManager } from './callbacks';\nimport { loadAndChangeLanguage } from './localization';\nimport { formatInteger } from './textFormat';\n\nexport interface LangFn {\n  (key: string, value?: any, format?: 'i', pluralValue?: number): string;\n\n  isRtl?: boolean;\n  code?: LangCode;\n  langName?: string;\n  timeFormat?: TimeFormat;\n}\n\nconst SUBSTITUTION_REGEX = /%\\d?\\$?[sdf@]/g;\nconst PLURAL_OPTIONS = ['value', 'zeroValue', 'oneValue', 'twoValue', 'fewValue', 'manyValue', 'otherValue'] as const;\n// Some rules edited from https://github.com/eemeli/make-plural/blob/master/packages/plurals/cardinals.js\nconst PLURAL_RULES = {\n  /* eslint-disable @stylistic/max-len */\n  en: (n: number) => (n !== 1 ? 6 : 2),\n  ar: (n: number) => (n === 0 ? 1 : n === 1 ? 2 : n === 2 ? 3 : n % 100 >= 3 && n % 100 <= 10 ? 4 : n % 100 >= 11 ? 5 : 6),\n  be: (n: number) => {\n    const s = String(n).split('.');\n    const t0 = Number(s[0]) === n;\n    const n10 = t0 ? Number(s[0].slice(-1)) : 0;\n    const n100 = t0 ? Number(s[0].slice(-2)) : 0;\n    return n10 === 1 && n100 !== 11\n      ? 2\n      : (n10 >= 2 && n10 <= 4) && (n100 < 12 || n100 > 14)\n        ? 4\n        : (t0 && n10 === 0) || (n10 >= 5 && n10 <= 9) || (n100 >= 11 && n100 <= 14)\n          ? 5\n          : 6;\n  },\n  ca: (n: number) => (n !== 1 ? 6 : 2),\n  cs: (n: number) => {\n    const s = String(n).split('.');\n    const i = Number(s[0]);\n    const v0 = !s[1];\n    return n === 1 && v0 ? 2 : (i >= 2 && i <= 4) && v0 ? 4 : !v0 ? 5 : 6;\n  },\n  de: (n: number) => (n !== 1 ? 6 : 2),\n  es: (n: number) => (n !== 1 ? 6 : 2),\n  fa: (n: number) => (n > 1 ? 6 : 2),\n  fi: (n: number) => (n !== 1 ? 6 : 2),\n  fr: (n: number) => (n > 1 ? 6 : 2),\n  id: () => 0,\n  it: (n: number) => (n !== 1 ? 6 : 2),\n  hr: (n: number) => {\n    const s = String(n).split('.');\n    const i = s[0];\n    const f = s[1] || '';\n    const v0 = !s[1];\n    const i10 = Number(i.slice(-1));\n    const i100 = Number(i.slice(-2));\n    const f10 = Number(f.slice(-1));\n    const f100 = Number(f.slice(-2));\n    return (v0 && i10 === 1 && i100 !== 11) || (f10 === 1 && f100 !== 11) ? 2\n      : (v0 && (i10 >= 2 && i10 <= 4) && (i100 < 12 || i100 > 14)) || ((f10 >= 2 && f10 <= 4) && (f100 < 12 || f100 > 14)) ? 4\n        : 6;\n  },\n  hu: (n: number) => (n > 1 ? 6 : 2),\n  ko: () => 0,\n  ms: () => 0,\n  nb: (n: number) => (n > 1 ? 6 : 2),\n  nl: (n: number) => (n !== 1 ? 6 : 2),\n  pl: (n: number) => (n === 1 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  'pt-br': (n: number) => (n > 1 ? 6 : 2),\n  ru: (n: number) => (n % 10 === 1 && n % 100 !== 11 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  sk: (n: number) => {\n    const s = String(n).split('.');\n    const i = Number(s[0]);\n    const v0 = !s[1];\n    return n === 1 && v0 ? 2 : (i >= 2 && i <= 4) && v0 ? 4 : !v0 ? 5 : 6;\n  },\n  sr: (n: number) => {\n    const s = String(n).split('.');\n    const i = s[0];\n    const f = s[1] || '';\n    const v0 = !s[1];\n    const i10 = Number(i.slice(-1));\n    const i100 = Number(i.slice(-2));\n    const f10 = Number(f.slice(-1));\n    const f100 = Number(f.slice(-2));\n    return (v0 && i10 === 1 && i100 !== 11) || (f10 === 1 && f100 !== 11) ? 2\n      : (v0 && (i10 >= 2 && i10 <= 4) && (i100 < 12 || i100 > 14)) || ((f10 >= 2 && f10 <= 4) && (f100 < 12 || f100 > 14)) ? 4\n        : 6;\n  },\n  tr: (n: number) => (n > 1 ? 6 : 2),\n  uk: (n: number) => (n % 10 === 1 && n % 100 !== 11 ? 2 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 4 : 5),\n  uz: (n: number) => (n > 1 ? 6 : 2),\n  /* eslint-enable @stylistic/max-len */\n};\n\nconst cache = new Map<string, string>();\n\nlet langPack: ApiOldLangPack | undefined;\nlet fallbackLangPack: ApiOldLangPack | undefined;\n\nconst {\n  addCallback,\n  removeCallback,\n  runCallbacks,\n} = createCallbackManager();\n\nexport { addCallback, removeCallback };\n\nlet currentLangCode: string | undefined;\nlet currentTimeFormat: TimeFormat | undefined;\n\nfunction createLangFn() {\n  return (key: string, value?: any, format?: 'i', pluralValue?: number) => {\n    if (value !== undefined) {\n      const cacheValue = Array.isArray(value) ? JSON.stringify(value) : value;\n      const cached = cache.get(`${key}_${cacheValue}_${format}${pluralValue ? `_${pluralValue}` : ''}`);\n      if (cached) {\n        return cached;\n      }\n    }\n\n    if (!fallbackLangPack) {\n      void importFallbackLangPack();\n    }\n\n    const langString = langPack?.[key] || fallbackLangPack?.[key];\n    if (!langString) {\n      return key;\n    }\n\n    return processTranslation(langString, key, value, format, pluralValue);\n  };\n}\n\nlet translationFn: LangFn = createLangFn();\n\n/**\n * @deprecated Do not translate inside non-reactive contexts. Pass parameters to the component instead\n */\nexport function oldTranslate(...args: Parameters<LangFn>) {\n  return translationFn(...args);\n}\n\nexport function getTranslationFn(): LangFn {\n  return translationFn;\n}\n\n/**\n * @deprecated Migrate to `changeLanguage` in `util/localization.ts` instead\n */\nexport async function oldSetLanguage(langCode: LangCode, callback?: NoneToVoidFunction, withFallback = false) {\n  loadAndChangeLanguage(langCode, true);\n  if (langPack && langCode === currentLangCode) {\n    if (callback) {\n      callback();\n    }\n\n    return;\n  }\n\n  let newLangPack = await cacheApi.fetch(LANG_CACHE_NAME, langCode, cacheApi.Type.Json);\n  if (!newLangPack) {\n    if (withFallback) {\n      await importFallbackLangPack();\n    }\n\n    newLangPack = await fetchRemote(langCode);\n    if (!newLangPack) {\n      return;\n    }\n  }\n\n  cache.clear();\n\n  currentLangCode = langCode;\n  langPack = newLangPack;\n  document.documentElement.lang = langCode;\n\n  const global = getGlobal();\n  const { languages, timeFormat } = selectSharedSettings(global);\n  const langInfo = languages?.find((lang) => lang.langCode === langCode);\n  translationFn = createLangFn();\n  translationFn.isRtl = Boolean(langInfo?.isRtl);\n  translationFn.code = langCode.replace('-raw', '') as LangCode;\n  translationFn.langName = langInfo?.nativeName;\n  translationFn.timeFormat = timeFormat;\n\n  if (callback) {\n    callback();\n  }\n\n  runCallbacks();\n}\n\nexport function setTimeFormat(timeFormat: TimeFormat) {\n  if (timeFormat && timeFormat === currentTimeFormat) {\n    return;\n  }\n\n  currentTimeFormat = timeFormat;\n  translationFn.timeFormat = timeFormat;\n\n  runCallbacks();\n}\n\nasync function importFallbackLangPack() {\n  if (fallbackLangPack) {\n    return;\n  }\n\n  fallbackLangPack = (await import('./fallbackLangPack')).default;\n  runCallbacks();\n}\n\nasync function fetchRemote(langCode: string): Promise<ApiOldLangPack | undefined> {\n  const remote = await callApi('oldFetchLangPack', { sourceLangPacks: LANG_PACKS, langCode });\n  if (remote) {\n    await cacheApi.save(LANG_CACHE_NAME, langCode, remote.langPack);\n    return remote.langPack;\n  }\n\n  return undefined;\n}\n\nfunction getPluralOption(amount: number) {\n  const langCode = currentLangCode || 'en';\n  const optionIndex = PLURAL_RULES[langCode as keyof typeof PLURAL_RULES]\n    ? PLURAL_RULES[langCode as keyof typeof PLURAL_RULES](amount)\n    : 0;\n\n  return PLURAL_OPTIONS[optionIndex];\n}\n\nfunction processTemplate(template: string, value: any) {\n  value = Array.isArray(value) ? value : [value];\n  const translationSlices = template.split(SUBSTITUTION_REGEX);\n  const initialValue = translationSlices.shift();\n\n  return translationSlices.reduce((result, str, index) => {\n    return `${result}${String(value[index] ?? '')}${str}`;\n  }, initialValue || '');\n}\n\nfunction processTranslation(\n  langString: ApiOldLangString | undefined, key: string, value?: any, format?: 'i', pluralValue?: number,\n) {\n  const preferredPluralOption = typeof value === 'number' || pluralValue !== undefined\n    ? getPluralOption(pluralValue ?? value)\n    : 'value';\n  const template = typeof langString === 'string'\n    ? langString\n    : preferredPluralOption === 'value'\n      // Support cached older `langString` interface\n      ? (typeof langString === 'object' ? (langString as any).value : langString)\n      : typeof langString === 'object'\n        ? langString[preferredPluralOption] || langString.otherValue\n        : undefined;\n\n  if (!template?.trim()) {\n    const parts = key.split('.');\n\n    return parts[parts.length - 1];\n  }\n\n  if (value !== undefined) {\n    const formattedValue = format === 'i' ? formatInteger(value) : value;\n    const result = processTemplate(template, formattedValue);\n    const cacheValue = Array.isArray(value) ? JSON.stringify(value) : value;\n    cache.set(`${key}_${cacheValue}_${format}${pluralValue ? `_${pluralValue}` : ''}`, result);\n    return result;\n  }\n\n  return template;\n}\n","import { addCallback } from '../../lib/teact/teactn';\nimport { getGlobal } from '../../global';\n\nimport type { ApiSticker } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { requestMutation } from '../../lib/fasterdom/fasterdom';\nimport { getStickerHashById } from '../../global/helpers';\nimport { selectCanPlayAnimatedEmojis, selectCustomEmoji } from '../../global/selectors';\nimport { IS_WEBM_SUPPORTED } from '../browser/windowEnvironment';\nimport { createCallbackManager } from '../callbacks';\nimport generateUniqueId from '../generateUniqueId';\nimport * as mediaLoader from '../mediaLoader';\nimport { throttle } from '../schedulers';\n\nimport blankSrc from '../../assets/blank.png';\nimport placeholderSrc from '../../assets/square.svg';\n\ntype CustomEmojiLoadCallback = (customEmojis: GlobalState['customEmojis']) => void;\ntype CustomEmojiInputRenderCallback = (emojiId: string) => void;\n\nconst DOM_PROCESS_THROTTLE = 500;\n\nconst INPUT_WAITING_CUSTOM_EMOJI_IDS = new Set<string>();\n\nconst handlers = new Map<CustomEmojiLoadCallback, string>();\nconst renderCallbacks = createCallbackManager<CustomEmojiInputRenderCallback>();\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  if (\n    global.customEmojis.byId !== prevGlobal?.customEmojis.byId\n    || selectCanPlayAnimatedEmojis(global) !== selectCanPlayAnimatedEmojis(prevGlobal)\n  ) {\n    for (const entry of handlers) {\n      const [handler, id] = entry;\n      if (selectCustomEmoji(global, id)) {\n        handler(global.customEmojis);\n      }\n    }\n\n    checkInputCustomEmojiLoad(global.customEmojis);\n  }\n\n  prevGlobal = global;\n});\n\nexport function addCustomEmojiCallback(handler: CustomEmojiLoadCallback, emojiId: string) {\n  handlers.set(handler, emojiId);\n}\n\nexport function removeCustomEmojiCallback(handler: CustomEmojiLoadCallback) {\n  handlers.delete(handler);\n}\n\nexport const addCustomEmojiInputRenderCallback = renderCallbacks.addCallback;\nconst callInputRenderHandlers = throttle(renderCallbacks.runCallbacks, DOM_PROCESS_THROTTLE);\n\nfunction processDomForCustomEmoji() {\n  const emojis = document.querySelectorAll<HTMLImageElement>('.custom-emoji.placeholder');\n  emojis.forEach((emoji) => {\n    const customEmoji = selectCustomEmoji(getGlobal(), emoji.dataset.documentId!);\n    if (!customEmoji) {\n      INPUT_WAITING_CUSTOM_EMOJI_IDS.add(emoji.dataset.documentId!);\n      return;\n    }\n    const [isPlaceholder, src, uniqueId] = getInputCustomEmojiParams(customEmoji);\n\n    if (customEmoji.shouldUseTextColor && !emoji.classList.contains('colorable')) {\n      requestMutation(() => {\n        emoji.classList.add('colorable');\n      });\n    }\n\n    if (!isPlaceholder) {\n      requestMutation(() => {\n        emoji.src = src;\n        emoji.classList.remove('placeholder');\n        if (uniqueId) emoji.dataset.uniqueId = uniqueId;\n\n        callInputRenderHandlers(customEmoji.id);\n      });\n    }\n  });\n}\n\nexport const processMessageInputForCustomEmoji = throttle(processDomForCustomEmoji, DOM_PROCESS_THROTTLE);\n\nfunction checkInputCustomEmojiLoad(customEmojis: GlobalState['customEmojis']) {\n  const loaded = Array.from(INPUT_WAITING_CUSTOM_EMOJI_IDS).filter((id) => Boolean(customEmojis.byId[id]));\n  if (loaded.length) {\n    loaded.forEach((id) => INPUT_WAITING_CUSTOM_EMOJI_IDS.delete(id));\n    processMessageInputForCustomEmoji();\n  }\n}\n\nexport function getCustomEmojiMediaDataForInput(emojiId: string, isPreview?: boolean) {\n  const mediaHash = getStickerHashById(emojiId, isPreview);\n  const data = mediaLoader.getFromMemory(mediaHash);\n  if (data) {\n    return data;\n  }\n\n  void fetchAndProcess(mediaHash);\n  return undefined;\n}\n\nfunction fetchAndProcess(mediaHash: string) {\n  return mediaLoader.fetch(mediaHash, ApiMediaFormat.BlobUrl).then(() => {\n    processMessageInputForCustomEmoji();\n  });\n}\n\nexport function getInputCustomEmojiParams(customEmoji?: ApiSticker) {\n  if (!customEmoji) return [true, placeholderSrc, undefined] as const;\n  const shouldUseStaticFallback = !IS_WEBM_SUPPORTED && customEmoji.isVideo;\n  const isUsingSharedCanvas = customEmoji.isLottie || (customEmoji.isVideo && !shouldUseStaticFallback);\n  if (isUsingSharedCanvas) {\n    void fetchAndProcess(`sticker${customEmoji.id}`);\n    return [false, blankSrc, generateUniqueId()] as const;\n  }\n\n  const mediaData = getCustomEmojiMediaDataForInput(customEmoji.id, shouldUseStaticFallback);\n\n  return [!mediaData, mediaData || placeholderSrc, undefined] as const;\n}\n","import type { ApiMessage, ApiSponsoredMessage } from '../../api/types';\n\nexport type MessageKey = `msg${string}-${number}`;\n\nexport function getMessageKey(message: ApiMessage | ApiSponsoredMessage): MessageKey {\n  const {\n    chatId,\n  } = message;\n\n  if ('randomId' in message) {\n    return buildMessageKey(chatId, Number(message.randomId));\n  }\n  return buildMessageKey(chatId, message.previousLocalId || message.id);\n}\n\nexport function getMessageServerKey(message: ApiMessage): MessageKey | undefined {\n  if (isLocalMessageId(message.id)) {\n    return undefined;\n  }\n  const { chatId, id } = message;\n  return buildMessageKey(chatId, id);\n}\n\nexport function buildMessageKey(chatId: string, msgId: number): MessageKey {\n  return `msg${chatId}-${msgId}`;\n}\n\nexport function parseMessageKey(key: MessageKey) {\n  const match = key.match(/^msg(-?\\d+)-(\\d+)/)!;\n\n  return { chatId: match[1], messageId: Number(match[2]) };\n}\n\nexport function isLocalMessageId(id: number) {\n  return !Number.isInteger(id);\n}\n","import { useEffect } from '@teact';\n\nimport { createSignal } from '../../util/signals';\nimport useLastCallback from '../useLastCallback';\n\nconst [getIsInBackgroundLocal, setIsInBackground] = createSignal(!document.hasFocus());\nexport const getIsInBackground = getIsInBackgroundLocal;\n\nfunction handleBlur() {\n  setIsInBackground(true);\n}\n\nfunction handleFocus() {\n  setIsInBackground(false);\n}\n\nwindow.addEventListener('blur', handleBlur);\nwindow.addEventListener('focus', handleFocus);\n\nexport default function useBackgroundMode(\n  onBlur?: AnyToVoidFunction,\n  onFocus?: AnyToVoidFunction,\n  isDisabled = false,\n) {\n  const lastOnBlur = useLastCallback(onBlur);\n  const lastOnFocus = useLastCallback(onFocus);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (getIsInBackground()) {\n      lastOnBlur();\n    }\n\n    return getIsInBackground.subscribe(() => {\n      if (getIsInBackground()) {\n        lastOnBlur();\n      } else {\n        lastOnFocus();\n      }\n    });\n  }, [isDisabled, lastOnBlur, lastOnFocus]);\n}\n\nexport function isBackgroundModeActive() {\n  return getIsInBackground();\n}\n","/* eslint-disable no-console */\n\nexport const DEBUG_LEVELS = ['log', 'error', 'warn', 'info', 'debug'] as const;\nexport type DebugLevel = typeof DEBUG_LEVELS[number];\n// @ts-ignore\nconst ORIGINAL_FUNCTIONS: Record<DebugLevel, (...args: any[]) => void> = DEBUG_LEVELS.reduce((acc, level) => {\n  // @ts-ignore\n  acc[level] = console[level];\n  return acc;\n}, {});\n\ntype DebugEntry = {\n  level: DebugLevel;\n  args: any[];\n  date: Date;\n};\nlet DEBUG_LOGS: DebugEntry[] = [];\n\nexport function logDebugMessage(level: DebugLevel, ...args: any[]) {\n  DEBUG_LOGS.push({\n    level,\n    args,\n    date: new Date(),\n  });\n  ORIGINAL_FUNCTIONS[level](...args);\n}\n\nexport function initDebugConsole() {\n  DEBUG_LOGS = [];\n  DEBUG_LEVELS.forEach((level) => {\n    // @ts-ignore\n    console[level] = (...args: any[]) => {\n      logDebugMessage(level, ...args);\n    };\n  });\n}\n\nexport function disableDebugConsole() {\n  DEBUG_LEVELS.forEach((level) => {\n    // @ts-ignore\n    console[level] = ORIGINAL_FUNCTIONS[level];\n  });\n  DEBUG_LOGS = [];\n}\n\nexport function getDebugLogs() {\n  return JSON.stringify(DEBUG_LOGS, (key, value) => (typeof value === 'bigint'\n    ? value.toString()\n    : value));\n}\n","import type { ChangeEvent, FocusEvent } from 'react';\n\nimport type { Signal } from '../../util/signals';\nimport type {\n  VirtualElement,\n  VirtualElementChildren,\n  VirtualElementComponent,\n  VirtualElementFragment,\n  VirtualElementParent,\n  VirtualElementReal,\n  VirtualElementTag,\n} from './teact';\n\nimport { DEBUG } from '../../config';\nimport { addEventListener, removeAllDelegatedListeners, removeEventListener } from './dom-events';\nimport {\n  captureImmediateEffects,\n  hasElementChanged,\n  isParentElement,\n  mountComponent,\n  MountState,\n  renderComponent,\n  unmountComponent,\n  VirtualType,\n} from './teact';\n\ninterface VirtualDomHead {\n  children: [VirtualElement] | [];\n}\n\ninterface SelectionState {\n  selectionStart: number | null;\n  selectionEnd: number | null;\n  isCaretAtEnd: boolean;\n}\n\ntype CurrentContext = Record<string, Signal<unknown>>;\n\ntype DOMElement = HTMLElement | SVGElement;\n\nconst SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\nconst HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n\nconst FILTERED_ATTRIBUTES = new Set(['key', 'ref', 'teactFastList', 'teactOrderKey']);\nconst HTML_ATTRIBUTES = new Set(['dir', 'role', 'form']);\nconst CONTROLLABLE_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nconst MAPPED_ATTRIBUTES: Partial<Record<string, string>> = {\n  autoCapitalize: 'autocapitalize',\n  autoComplete: 'autocomplete',\n  autoCorrect: 'autocorrect',\n  autoPlay: 'autoplay',\n  spellCheck: 'spellcheck',\n};\nconst INDEX_KEY_PREFIX = '__indexKey#';\nconst SELECTION_STATE_ATTRIBUTE = '__teactSelectionState';\n\nconst headsByElement = new WeakMap<Element, VirtualDomHead>();\nconst extraClasses = new WeakMap<Element, Set<string>>();\nconst extraStyles = new WeakMap<Element, Record<string, string>>();\n\nconst uniqueChildKeysCache = new WeakMap<VirtualElementChildren, (keyof any)[]>();\n\nlet DEBUG_virtualTreeSize = 1;\n\nfunction render($element: VirtualElement | undefined, parentEl: HTMLElement) {\n  if (!headsByElement.has(parentEl)) {\n    headsByElement.set(parentEl, { children: [] });\n  }\n\n  const runImmediateEffects = captureImmediateEffects();\n  const $head = headsByElement.get(parentEl)!;\n  const $renderedChild = renderWithVirtual(parentEl, $head.children[0], $element, $head, {}, 0);\n  runImmediateEffects?.();\n\n  $head.children = $renderedChild ? [$renderedChild] : [];\n\n  if (process.env.APP_ENV === 'perf') {\n    DEBUG_virtualTreeSize = 0;\n    DEBUG_addToVirtualTreeSize($head);\n\n    return DEBUG_virtualTreeSize;\n  }\n\n  return undefined;\n}\n\nfunction renderWithVirtual<T extends VirtualElement | undefined>(\n  parentEl: DOMElement,\n  $current: VirtualElement | undefined,\n  $new: T,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n  options: {\n    skipComponentUpdate?: boolean;\n    nextSibling?: ChildNode;\n    forceMoveToEnd?: boolean;\n    fragment?: DocumentFragment;\n    namespace?: string;\n  } = {},\n): T {\n  const { skipComponentUpdate, fragment } = options;\n  let { nextSibling, namespace } = options;\n\n  const isCurrentComponent = $current?.type === VirtualType.Component;\n  const isNewComponent = $new?.type === VirtualType.Component;\n  const $newAsReal = $new as VirtualElementReal;\n\n  const isCurrentFragment = !isCurrentComponent && $current?.type === VirtualType.Fragment;\n  const isNewFragment = !isNewComponent && $new?.type === VirtualType.Fragment;\n\n  if ($new?.type === VirtualType.Tag) {\n    if ($new.tag === 'svg') namespace = SVG_NAMESPACE;\n    if ($new.props.xmlns) namespace = $new.props.xmlns;\n  }\n\n  if (\n    !skipComponentUpdate\n    && isCurrentComponent && isNewComponent\n    && !hasElementChanged($current, $new!)\n  ) {\n    $new = updateComponent($current, $new as VirtualElementComponent) as typeof $new;\n  }\n\n  // Parent element may have changed, so we need to update the listener closure.\n  if (\n    !skipComponentUpdate\n    && isNewComponent\n    && ($new as VirtualElementComponent).componentInstance.mountState === MountState.Mounted\n  ) {\n    setupComponentUpdateListener(parentEl, $new as VirtualElementComponent, $parent, currentContext, index);\n  }\n\n  if ($current === $new) {\n    return $new;\n  }\n\n  if (DEBUG && $new) {\n    const newTarget = 'target' in $new && $new.target;\n    if (newTarget && (!$current || ('target' in $current && newTarget !== $current.target))) {\n      throw new Error('[Teact] Cached virtual element was moved within tree');\n    }\n  }\n\n  if (!$current && $new) {\n    if (isNewComponent || isNewFragment) {\n      if (isNewComponent) {\n        $new = initComponent(\n          parentEl, $new as VirtualElementComponent, $parent, currentContext, index,\n        ) as unknown as typeof $new;\n        currentContext = ($new as VirtualElementComponent).componentInstance.context ?? currentContext;\n      }\n\n      mountChildren(parentEl, $new as VirtualElementComponent | VirtualElementFragment, currentContext, {\n        nextSibling, fragment, namespace,\n      });\n    } else {\n      const canSetTextContent = !fragment\n        && !nextSibling\n        && $newAsReal.type === VirtualType.Text\n        && $parent.children.length === 1\n        && !parentEl.firstChild;\n\n      if (canSetTextContent) {\n        parentEl.textContent = $newAsReal.value;\n        $newAsReal.target = parentEl.firstChild!;\n      } else {\n        const node = createNode($newAsReal, currentContext, namespace);\n        $newAsReal.target = node;\n        insertBefore(fragment || parentEl, node, nextSibling);\n\n        if ($newAsReal.type === VirtualType.Tag) {\n          setElementRef($newAsReal, node as DOMElement);\n        }\n      }\n    }\n  } else if ($current && !$new) {\n    remount(parentEl, $current, currentContext, undefined);\n  } else if ($current && $new) {\n    if (hasElementChanged($current, $new)) {\n      if (!nextSibling) {\n        nextSibling = getNextSibling($current);\n      }\n\n      if (isNewComponent || isNewFragment) {\n        if (isNewComponent) {\n          $new = initComponent(\n            parentEl, $new as VirtualElementComponent, $parent, currentContext, index,\n          ) as unknown as typeof $new;\n          currentContext = ($new as VirtualElementComponent).componentInstance.context ?? currentContext;\n        }\n\n        remount(parentEl, $current, currentContext, undefined);\n        mountChildren(parentEl, $new as VirtualElementComponent | VirtualElementFragment, currentContext, {\n          nextSibling, fragment, namespace,\n        });\n      } else {\n        const node = createNode($newAsReal, currentContext, namespace);\n        $newAsReal.target = node;\n        remount(parentEl, $current, currentContext, node, nextSibling);\n\n        if ($newAsReal.type === VirtualType.Tag) {\n          setElementRef($newAsReal, node as DOMElement);\n        }\n      }\n    } else {\n      const isComponent = isCurrentComponent && isNewComponent;\n      const isFragment = isCurrentFragment && isNewFragment;\n\n      if (isComponent || isFragment) {\n        renderChildren(\n          $current,\n          $new as VirtualElementComponent | VirtualElementFragment,\n          currentContext,\n          parentEl,\n          nextSibling,\n          options.forceMoveToEnd,\n        );\n      } else {\n        const $currentAsReal = $current as VirtualElementReal;\n        const currentTarget = $currentAsReal.target!;\n\n        $newAsReal.target = currentTarget;\n        $currentAsReal.target = undefined; // Help GC\n\n        const isTag = $current.type === VirtualType.Tag;\n        if (isTag) {\n          const $newAsTag = $new as VirtualElementTag;\n\n          setElementRef($current, undefined);\n          setElementRef($newAsTag, currentTarget as DOMElement);\n\n          if (nextSibling || options.forceMoveToEnd) {\n            insertBefore(parentEl, currentTarget, nextSibling);\n          }\n\n          updateAttributes($current, $newAsTag, currentTarget as DOMElement, namespace);\n          renderChildren(\n            $current, $newAsTag, currentContext, currentTarget as DOMElement, undefined, undefined, namespace,\n          );\n        }\n      }\n    }\n  }\n\n  return $new;\n}\n\nfunction initComponent(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n) {\n  const { componentInstance } = $element;\n\n  $element.componentInstance.context = currentContext;\n\n  if (componentInstance.mountState === MountState.Unmounted) {\n    $element = mountComponent(componentInstance);\n    setupComponentUpdateListener(parentEl, $element, $parent, currentContext, index);\n  }\n\n  return $element;\n}\n\nfunction updateComponent($current: VirtualElementComponent, $new: VirtualElementComponent) {\n  $current.componentInstance.props = $new.componentInstance.props;\n\n  return renderComponent($current.componentInstance);\n}\n\nfunction setupComponentUpdateListener(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent,\n  $parent: VirtualElementParent | VirtualDomHead,\n  currentContext: CurrentContext,\n  index: number,\n) {\n  const { componentInstance } = $element;\n\n  componentInstance.onUpdate = () => {\n    $parent.children[index] = renderWithVirtual(\n      parentEl,\n      $parent.children[index],\n      componentInstance.$element,\n      $parent,\n      currentContext,\n      index,\n      { skipComponentUpdate: true },\n    );\n  };\n}\n\nfunction mountChildren(\n  parentEl: DOMElement,\n  $element: VirtualElementComponent | VirtualElementFragment,\n  currentContext: CurrentContext,\n  options: {\n    nextSibling?: ChildNode;\n    fragment?: DocumentFragment;\n    namespace?: string;\n  },\n) {\n  const { children } = $element;\n\n  // Add a placeholder comment node for empty fragments to maintain position\n  if ($element.type === VirtualType.Fragment && children.length === 0) {\n    const fragmentEl = $element;\n    fragmentEl.placeholderTarget = document.createComment('empty-fragment');\n    insertBefore(options.fragment || parentEl, fragmentEl.placeholderTarget, options.nextSibling);\n    return;\n  }\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    const $child = children[i];\n    const $renderedChild = renderWithVirtual(parentEl, undefined, $child, $element, currentContext, i, options);\n    if ($renderedChild !== $child) {\n      children[i] = $renderedChild;\n    }\n  }\n}\n\nfunction unmountChildren(\n  parentEl: DOMElement, $element: VirtualElementComponent | VirtualElementFragment, currentContext: CurrentContext,\n) {\n  for (const $child of $element.children) {\n    renderWithVirtual(parentEl, $child, undefined, $element, currentContext, -1);\n  }\n}\n\nfunction createNode($element: VirtualElementReal, currentContext: CurrentContext, namespace = HTML_NAMESPACE): Node {\n  if ($element.type === VirtualType.Empty) {\n    return document.createTextNode('');\n  }\n\n  if ($element.type === VirtualType.Text) {\n    return document.createTextNode($element.value);\n  }\n\n  const { tag, props, children } = $element;\n  const element = document.createElementNS(namespace, tag) as DOMElement;\n\n  processControlled(tag, props);\n\n  for (const key in props) {\n    if (!props.hasOwnProperty(key)) continue;\n\n    if (props[key] !== undefined) {\n      setAttribute(element, key, props[key], namespace);\n    }\n  }\n\n  processUncontrolledOnMount(element, props);\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    const $child = children[i];\n    const $renderedChild = renderWithVirtual(element, undefined, $child, $element, currentContext, i, { namespace });\n    if ($renderedChild !== $child) {\n      children[i] = $renderedChild;\n    }\n  }\n\n  return element;\n}\n\nfunction remount(\n  parentEl: DOMElement,\n  $current: VirtualElement,\n  currentContext: CurrentContext,\n  node: Node | undefined,\n  componentNextSibling?: ChildNode,\n) {\n  const isComponent = $current.type === VirtualType.Component;\n  const isFragment = !isComponent && $current.type === VirtualType.Fragment;\n\n  if (isComponent || isFragment) {\n    if (isComponent) {\n      unmountComponent($current.componentInstance);\n    }\n\n    unmountChildren(parentEl, $current, currentContext);\n\n    if (node) {\n      insertBefore(parentEl, node, componentNextSibling);\n    }\n  } else {\n    if (node) {\n      parentEl.replaceChild(node, $current.target!);\n    } else {\n      parentEl.removeChild($current.target!);\n    }\n\n    unmountRealTree($current);\n  }\n}\n\nfunction unmountRealTree($element: VirtualElement) {\n  if ($element.type === VirtualType.Component) {\n    unmountComponent($element.componentInstance);\n  } else if ($element.type === VirtualType.Fragment) {\n    // Remove placeholder for empty fragments\n    const fragment = $element;\n    if (fragment.placeholderTarget && fragment.children.length === 0) {\n      fragment.placeholderTarget.parentNode?.removeChild(fragment.placeholderTarget);\n      fragment.placeholderTarget = undefined;\n    }\n  } else {\n    if ($element.type === VirtualType.Tag) {\n      extraClasses.delete($element.target!);\n      setElementRef($element, undefined);\n      removeAllDelegatedListeners($element.target!);\n    }\n\n    $element.target = undefined; // Help GC\n\n    if ($element.type !== VirtualType.Tag) {\n      return;\n    }\n  }\n\n  for (const $child of $element.children) {\n    unmountRealTree($child);\n  }\n}\n\nfunction insertBefore(parentEl: DOMElement | DocumentFragment, node: Node, nextSibling?: ChildNode) {\n  if (nextSibling) {\n    parentEl.insertBefore(node, nextSibling);\n  } else {\n    parentEl.appendChild(node);\n  }\n}\n\nfunction getNextSibling($current: VirtualElement): ChildNode | undefined {\n  if ($current.type === VirtualType.Component || $current.type === VirtualType.Fragment) {\n    if ($current.children.length === 0) {\n      // For empty fragments, use the placeholder node to track position\n      const fragment = $current as VirtualElementFragment;\n      if (fragment.placeholderTarget) {\n        return fragment.placeholderTarget.nextSibling || undefined;\n      }\n      return undefined;\n    }\n\n    const lastChild = $current.children[$current.children.length - 1];\n    return getNextSibling(lastChild);\n  }\n\n  return $current.target!.nextSibling || undefined;\n}\n\nfunction renderChildren(\n  $current: VirtualElementParent,\n  $new: VirtualElementParent,\n  currentContext: CurrentContext,\n  currentEl: DOMElement,\n  nextSibling?: ChildNode,\n  forceMoveToEnd = false,\n  namespace?: string,\n) {\n  if (('props' in $new) && $new.props.teactFastList) {\n    renderFastListChildren($current, $new, currentContext, currentEl);\n    return;\n  }\n\n  // Handle transitions between empty and non-empty fragments\n  if ($current.type === VirtualType.Fragment && $new.type === VirtualType.Fragment) {\n    const currentFragment = $current;\n    const newFragment = $new;\n\n    // If transitioning from empty to non-empty, use the placeholder's position\n    if (currentFragment.children.length === 0 && newFragment.children.length > 0 && currentFragment.placeholderTarget) {\n      nextSibling = currentFragment.placeholderTarget.nextSibling || undefined;\n      // Remove the placeholder as we're adding real content\n      currentFragment.placeholderTarget.parentNode?.removeChild(currentFragment.placeholderTarget);\n      currentFragment.placeholderTarget = undefined;\n    }\n\n    // If transitioning from non-empty to empty, add a placeholder\n    if (currentFragment.children.length > 0 && newFragment.children.length === 0) {\n      const lastCurrentChild = currentFragment.children[currentFragment.children.length - 1];\n      const siblingAfterFragment = getNextSibling(lastCurrentChild);\n      newFragment.placeholderTarget = document.createComment('empty-fragment');\n      insertBefore(currentEl, newFragment.placeholderTarget, siblingAfterFragment);\n    }\n  }\n\n  const currentChildren = $current.children;\n  const newChildren = $new.children;\n\n  const currentChildrenLength = currentChildren.length;\n  const newChildrenLength = newChildren.length;\n  const maxLength = Math.max(currentChildrenLength, newChildrenLength);\n\n  const fragment = newChildrenLength > currentChildrenLength ? document.createDocumentFragment() : undefined;\n  const lastCurrentChild = $current.children[currentChildrenLength - 1];\n  const fragmentNextSibling = fragment && (\n    nextSibling || (lastCurrentChild ? getNextSibling(lastCurrentChild) : undefined)\n  );\n\n  for (let i = 0; i < maxLength; i++) {\n    const $renderedChild = renderWithVirtual(\n      currentEl,\n      currentChildren[i],\n      newChildren[i],\n      $new,\n      currentContext,\n      i,\n      i >= currentChildrenLength ? { fragment, namespace } : { nextSibling, forceMoveToEnd, namespace },\n    );\n\n    if ($renderedChild && $renderedChild !== newChildren[i]) {\n      newChildren[i] = $renderedChild;\n    }\n  }\n\n  if (fragment) {\n    insertBefore(currentEl, fragment, fragmentNextSibling);\n  }\n}\n\n// This function allows to prepend/append a bunch of new DOM nodes to the top/bottom of preserved ones.\n// It also allows to selectively move particular preserved nodes within their DOM list.\nfunction renderFastListChildren(\n  $current: VirtualElementParent, $new: VirtualElementParent, currentContext: CurrentContext, currentEl: DOMElement,\n) {\n  const currentChildren = $current.children;\n  const newChildren = $new.children;\n\n  // Clear out duplicated keys to avoid incorrect elements matching\n  const currentKeysByIndex = getChildKeysByIndex(currentChildren);\n  const newKeysByIndex = getChildKeysByIndex(newChildren);\n  const newKeys = new Set(newKeysByIndex);\n\n  if (DEBUG) {\n    for (const $newChild of newChildren) {\n      if ($newChild.type === VirtualType.Fragment) {\n        throw new Error('[Teact] Fragment can not be child of container with `teactFastList`');\n      }\n    }\n  }\n\n  // Build a collection of old children that also remain in the new list\n  let currentRemainingIndex = 0;\n  const remainingByKey: Record<keyof any, { $element: VirtualElement; index: number; orderKey?: number }> = {};\n  for (let i = 0, l = currentChildren.length; i < l; i++) {\n    const $currentChild = currentChildren[i];\n    const key = currentKeysByIndex[i];\n\n    // First we process removed children\n    if (!newKeys.has(key)) {\n      renderWithVirtual(currentEl, $currentChild, undefined, $new, currentContext, -1);\n\n      continue;\n    }\n\n    // Then we build up info about remaining children\n    remainingByKey[key] = {\n      $element: $currentChild,\n      index: currentRemainingIndex++,\n      orderKey: 'props' in $currentChild ? $currentChild.props.teactOrderKey : undefined,\n    };\n  }\n\n  let fragmentIndex: number | undefined;\n  let fragmentSize: number | undefined;\n\n  let currentPreservedIndex = 0;\n\n  for (let i = 0, l = newChildren.length; i < l; i++) {\n    const $newChild = newChildren[i];\n    const key = newKeysByIndex[i];\n    const currentChildInfo = remainingByKey[key];\n\n    if (!currentChildInfo) {\n      if (fragmentSize === undefined) {\n        fragmentIndex = i;\n        fragmentSize = 0;\n      }\n\n      fragmentSize++;\n      continue;\n    }\n\n    // This prepends new children to the top\n    if (fragmentSize) {\n      renderFragment(fragmentIndex!, fragmentSize, currentEl, $new, currentContext);\n      fragmentSize = undefined;\n      fragmentIndex = undefined;\n    }\n\n    // Now we check if a preserved node was moved within preserved list\n    const newOrderKey = 'props' in $newChild ? $newChild.props.teactOrderKey : undefined;\n    // That is indicated by a changed `teactOrderKey` value\n    const shouldMoveNode = (\n      currentChildInfo.index !== currentPreservedIndex && (!newOrderKey || currentChildInfo.orderKey !== newOrderKey)\n    );\n    const isMovingDown = shouldMoveNode && currentPreservedIndex > currentChildInfo.index;\n\n    if (!shouldMoveNode || isMovingDown) {\n      currentPreservedIndex++;\n    }\n\n    const nextSibling = currentEl.childNodes[isMovingDown ? i + 1 : i];\n    const options = shouldMoveNode ? (nextSibling ? { nextSibling } : { forceMoveToEnd: true }) : undefined;\n\n    const $renderedChild = renderWithVirtual(\n      currentEl, currentChildInfo.$element, $newChild, $new, currentContext, i, options,\n    );\n    if ($renderedChild !== $newChild) {\n      newChildren[i] = $renderedChild;\n    }\n  }\n\n  // This appends new children to the bottom\n  if (fragmentSize) {\n    renderFragment(fragmentIndex!, fragmentSize, currentEl, $new, currentContext);\n  }\n}\n\nfunction renderFragment(\n  fragmentIndex: number,\n  fragmentSize: number,\n  parentEl: DOMElement,\n  $parent: VirtualElementParent,\n  currentContext: CurrentContext,\n) {\n  const nextSibling = parentEl.childNodes[fragmentIndex];\n\n  if (fragmentSize === 1) {\n    const $child = $parent.children[fragmentIndex];\n    const $renderedChild = renderWithVirtual(\n      parentEl, undefined, $child, $parent, currentContext, fragmentIndex, { nextSibling },\n    );\n    if ($renderedChild !== $child) {\n      $parent.children[fragmentIndex] = $renderedChild;\n    }\n\n    return;\n  }\n\n  const fragment = document.createDocumentFragment();\n\n  for (let i = fragmentIndex; i < fragmentIndex + fragmentSize; i++) {\n    const $child = $parent.children[i];\n    const $renderedChild = renderWithVirtual(parentEl, undefined, $child, $parent, currentContext, i, { fragment });\n    if ($renderedChild !== $child) {\n      $parent.children[i] = $renderedChild;\n    }\n  }\n\n  insertBefore(parentEl, fragment, nextSibling);\n}\n\nfunction setElementRef($element: VirtualElementTag, element: DOMElement | undefined) {\n  const { ref } = $element.props;\n\n  if (typeof ref === 'object') {\n    ref.current = element;\n    ref.onChange?.();\n  } else if (typeof ref === 'function') {\n    ref(element);\n  }\n}\n\nfunction processControlled(tag: string, props: AnyLiteral) {\n  // TODO Remove after tests\n  if (!props.teactExperimentControlled) {\n    return;\n  }\n\n  const isValueControlled = props.value !== undefined;\n  const isCheckedControlled = props.checked !== undefined;\n  const isControlled = (isValueControlled || isCheckedControlled) && CONTROLLABLE_TAGS.includes(tag.toUpperCase());\n  if (!isControlled) {\n    return;\n  }\n\n  const {\n    value, checked, onInput, onChange, onBlur,\n  } = props;\n\n  props.onChange = undefined;\n  props.onInput = (e: ChangeEvent<HTMLInputElement>) => {\n    onInput?.(e);\n    onChange?.(e);\n\n    if (value !== undefined && value !== e.currentTarget.value) {\n      const { selectionStart, selectionEnd } = e.currentTarget;\n      const isCaretAtEnd = selectionStart === selectionEnd && selectionEnd === e.currentTarget.value.length;\n\n      e.currentTarget.value = value;\n\n      if (typeof selectionStart === 'number' && typeof selectionEnd === 'number') {\n        e.currentTarget.setSelectionRange(selectionStart, selectionEnd);\n\n        const selectionState: SelectionState = { selectionStart, selectionEnd, isCaretAtEnd };\n\n        e.currentTarget.dataset[SELECTION_STATE_ATTRIBUTE] = JSON.stringify(selectionState);\n      }\n    }\n\n    if (checked !== undefined) {\n      e.currentTarget.checked = checked;\n    }\n  };\n  props.onBlur = (e: FocusEvent<HTMLInputElement>) => {\n    delete e.currentTarget.dataset[SELECTION_STATE_ATTRIBUTE];\n\n    onBlur?.(e);\n  };\n}\n\nfunction processUncontrolledOnMount(element: DOMElement, props: AnyLiteral) {\n  if (!CONTROLLABLE_TAGS.includes(element.tagName)) {\n    return;\n  }\n\n  if (props.defaultValue) {\n    setAttribute(element, 'value', props.defaultValue);\n  }\n\n  if (props.defaultChecked) {\n    setAttribute(element, 'checked', props.defaultChecked);\n  }\n}\n\nfunction updateAttributes(\n  $current: VirtualElementTag, $new: VirtualElementTag, element: DOMElement, namespace?: string,\n) {\n  processControlled(element.tagName, $new.props);\n\n  const currentEntries = Object.entries($current.props);\n  const newEntries = Object.entries($new.props);\n\n  for (const [key, currentValue] of currentEntries) {\n    const newValue = $new.props[key];\n\n    if (\n      currentValue !== undefined\n      && (\n        newValue === undefined\n        || (currentValue !== newValue && key.startsWith('on'))\n      )\n    ) {\n      removeAttribute(element, key, currentValue);\n    }\n  }\n\n  for (const [key, newValue] of newEntries) {\n    const currentValue = $current.props[key];\n\n    if (newValue !== undefined && newValue !== currentValue) {\n      setAttribute(element, key, newValue, namespace);\n    }\n  }\n}\n\nfunction setAttribute(element: DOMElement, key: string, value: any, namespace?: string) {\n  if (key === 'className') {\n    updateClassName(element, value, namespace);\n  } else if (key === 'value') {\n    const inputEl = element as HTMLInputElement;\n\n    if (inputEl.value !== value) {\n      inputEl.value = value;\n\n      const selectionStateJson = inputEl.dataset[SELECTION_STATE_ATTRIBUTE];\n      if (selectionStateJson) {\n        const { selectionStart, selectionEnd, isCaretAtEnd } = JSON.parse(selectionStateJson) as SelectionState;\n\n        if (isCaretAtEnd) {\n          const length = inputEl.value.length;\n          inputEl.setSelectionRange(length, length);\n        } else if (typeof selectionStart === 'number' && typeof selectionEnd === 'number') {\n          inputEl.setSelectionRange(selectionStart, selectionEnd);\n        }\n      }\n    }\n  } else if (key === 'style') {\n    updateStyle(element, value);\n  } else if (key === 'dangerouslySetInnerHTML') {\n    element.innerHTML = value.__html;\n  } else if (key.startsWith('on')) {\n    addEventListener(element, key, value, key.endsWith('Capture'));\n  } else if (\n    namespace === SVG_NAMESPACE || key.startsWith('data-') || key.startsWith('aria-') || HTML_ATTRIBUTES.has(key)\n  ) {\n    element.setAttribute(key, value);\n  } else if (!FILTERED_ATTRIBUTES.has(key)) {\n    (element as any)[MAPPED_ATTRIBUTES[key] || key] = value;\n  }\n}\n\nfunction removeAttribute(element: DOMElement, key: string, value: any) {\n  if (key === 'className') {\n    updateClassName(element, '');\n  } else if (key === 'value') {\n    (element as HTMLInputElement).value = '';\n  } else if (key === 'style') {\n    updateStyle(element, '');\n  } else if (key === 'dangerouslySetInnerHTML') {\n    element.innerHTML = '';\n  } else if (key.startsWith('on')) {\n    removeEventListener(element, key, value, key.endsWith('Capture'));\n  } else if (!FILTERED_ATTRIBUTES.has(key)) {\n    element.removeAttribute(key);\n  }\n}\n\nfunction updateClassName(element: DOMElement, value: string, namespace?: string) {\n  if (namespace === SVG_NAMESPACE) {\n    element.setAttribute('class', value);\n    return;\n  }\n\n  const htmlElement = element as HTMLElement;\n  const extra = extraClasses.get(element);\n  if (!extra) {\n    htmlElement.className = value;\n    return;\n  }\n\n  const extraArray = Array.from(extra);\n  if (value) {\n    extraArray.push(value);\n  }\n\n  htmlElement.className = extraArray.join(' ');\n}\n\nfunction updateStyle(element: DOMElement, value: string) {\n  element.style.cssText = value;\n\n  const extraObject = extraStyles.get(element);\n  if (extraObject) {\n    applyExtraStyles(element);\n  }\n}\n\nexport function addExtraClass(element: DOMElement, className: string) {\n  element.classList.add(className);\n\n  const classList = extraClasses.get(element);\n  if (classList) {\n    classList.add(className);\n  } else {\n    extraClasses.set(element, new Set([className]));\n  }\n}\n\nexport function removeExtraClass(element: DOMElement, className: string) {\n  element.classList.remove(className);\n\n  const classList = extraClasses.get(element);\n  if (classList) {\n    classList.delete(className);\n\n    if (!classList.size) {\n      extraClasses.delete(element);\n    }\n  }\n}\n\nexport function toggleExtraClass(element: DOMElement, className: string, force?: boolean) {\n  if (force === true) {\n    addExtraClass(element, className);\n  } else if (force === false) {\n    removeExtraClass(element, className);\n  } else if (extraClasses.get(element)?.has(className)) {\n    removeExtraClass(element, className);\n  } else {\n    addExtraClass(element, className);\n  }\n}\n\nexport function setExtraStyles(element: DOMElement, styles: Partial<CSSStyleDeclaration> & AnyLiteral) {\n  extraStyles.set(element, styles);\n  applyExtraStyles(element);\n}\n\nfunction applyExtraStyles(element: DOMElement) {\n  const standardStyles = Object.entries(extraStyles.get(element)!).reduce<Record<string, string>>(\n    (acc, [prop, value]) => {\n      if (prop.startsWith('--')) {\n        element.style.setProperty(prop, value);\n      } else {\n        acc[prop] = value;\n      }\n\n      return acc;\n    },\n    {},\n  );\n\n  Object.assign(element.style, standardStyles);\n}\n\nfunction DEBUG_addToVirtualTreeSize($current: VirtualElementParent | VirtualDomHead) {\n  DEBUG_virtualTreeSize += $current.children.length;\n\n  $current.children.forEach(($child) => {\n    if (isParentElement($child)) {\n      DEBUG_addToVirtualTreeSize($child);\n    }\n  });\n}\n\n/** Returns unique and not missing key for each child */\nfunction getChildKeysByIndex(children: VirtualElementChildren) {\n  // The caching makes sense, because each children list is handled at least twice (as the new and the current children)\n  let uniqueKeysByIndex = uniqueChildKeysCache.get(children);\n  if (uniqueKeysByIndex) return uniqueKeysByIndex;\n\n  const seenKeys = new Set<any>();\n  const DEBUG_duplicatedKeys = new Set<any>();\n\n  uniqueKeysByIndex = children.map(($child, index) => {\n    let key = getElementKey($child);\n\n    if (isNullable(key)) {\n      if (DEBUG && isParentElement($child)) {\n        // eslint-disable-next-line no-console\n        console.warn('Missing `key` in `teactFastList`');\n      }\n\n      key = `${INDEX_KEY_PREFIX}${index}`;\n    } else {\n      if (seenKeys.has(key)) {\n        if (DEBUG) {\n          DEBUG_duplicatedKeys.add(key);\n        }\n\n        key = `${INDEX_KEY_PREFIX}${index}`;\n      } else {\n        seenKeys.add(key);\n      }\n    }\n\n    return key;\n  });\n\n  if (DEBUG && DEBUG_duplicatedKeys.size) {\n    // eslint-disable-next-line no-console\n    console.warn('[Teact] Duplicated keys:', [...DEBUG_duplicatedKeys], children);\n    throw new Error('[Teact] Children keys are not unique');\n  }\n\n  uniqueChildKeysCache.set(children, uniqueKeysByIndex);\n  return uniqueKeysByIndex;\n}\n\nfunction getElementKey($element: VirtualElement) {\n  return 'props' in $element ? $element.props.key : undefined;\n}\n\nfunction isNullable(value: unknown): value is undefined | null {\n  // eslint-disable-next-line no-null/no-null\n  return value === undefined || value === null;\n}\n\nconst TeactDOM = { render };\nexport default TeactDOM;\n","/**\n * Tool Action Parser - Converts tool inputs to human-readable descriptions\n *\n * This module provides parsers for MCP tools to convert raw JSON inputs\n * into human-readable action descriptions.\n */\n\ntype ToolArguments = Record<string, any>;\n\n/**\n * Helper to format chat/user IDs with fallback\n */\nfunction formatId(id: string | number | undefined, prefix: string = ''): string {\n  if (!id) return '';\n  const str = String(id);\n  return prefix ? `${prefix} ${str}` : str;\n}\n\n/**\n * Helper to truncate long text\n */\nfunction truncateText(text: string, maxLength: number = 50): string {\n  if (text.length <= maxLength) return text;\n  return `${text.substring(0, maxLength)}...`;\n}\n\n/**\n * Get human-readable action description for a tool\n */\nexport function toHumanReadableAction(toolName: string, args: ToolArguments): string {\n  const parser = toolParsers[toolName];\n  if (parser) {\n    return parser(args);\n  }\n\n  // Fallback: return generic description\n  return `Executing ${toolName} with provided parameters`;\n}\n\n/**\n * Parser functions for each tool\n */\nconst toolParsers: Record<string, (args: ToolArguments) => string> = {\n  // === Messaging Tools ===\n\n  send_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const message = truncateText(args.message || '', 100);\n    return `Send message to ${chatId}: \"${message}\"`;\n  },\n\n  reply_to_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const text = truncateText(args.text || '', 100);\n    return `Reply to message ${messageId} in ${chatId}: \"${text}\"`;\n  },\n\n  edit_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const newText = truncateText(args.new_text || '', 100);\n    return `Edit message ${messageId} in ${chatId} to: \"${newText}\"`;\n  },\n\n  delete_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Delete message ${messageId} from ${chatId}`;\n  },\n\n  forward_message: (args) => {\n    const fromChat = formatId(args.from_chat_id, 'chat');\n    const toChat = formatId(args.to_chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Forward message ${messageId} from ${fromChat} to ${toChat}`;\n  },\n\n  pin_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Pin message ${messageId} in ${chatId}`;\n  },\n\n  unpin_message: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Unpin message ${messageId} in ${chatId}`;\n  },\n\n  mark_as_read: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Mark messages as read in ${chatId}`;\n  },\n\n  send_reaction: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const reaction = args.reaction || '';\n    return `Add reaction ${reaction} to message ${messageId} in ${chatId}`;\n  },\n\n  remove_reaction: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const reaction = args.reaction || '';\n    return `Remove reaction ${reaction} from message ${messageId} in ${chatId}`;\n  },\n\n  save_draft: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const text = truncateText(args.text || '', 50);\n    return `Save draft in ${chatId}: \"${text}\"`;\n  },\n\n  clear_draft: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Clear draft in ${chatId}`;\n  },\n\n  // === Chat Management Tools ===\n\n  list_chats: (args) => {\n    const chatType = args.chat_type || 'all';\n    const limit = args.limit || 20;\n    return `List ${limit} ${chatType} chats`;\n  },\n\n  get_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get information for ${chatId}`;\n  },\n\n  create_group: (args) => {\n    const title = args.title || 'Untitled Group';\n    const userCount = Array.isArray(args.user_ids) ? args.user_ids.length : 0;\n    return `Create group \"${title}\" with ${userCount} member${userCount !== 1 ? 's' : ''}`;\n  },\n\n  create_channel: (args) => {\n    const title = args.title || 'Untitled Channel';\n    const description = args.description ? `: ${truncateText(args.description, 50)}` : '';\n    return `Create channel \"${title}\"${description}`;\n  },\n\n  edit_chat_title: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const newTitle = args.new_title || '';\n    return `Change title of ${chatId} to \"${newTitle}\"`;\n  },\n\n  delete_chat_photo: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Remove photo from ${chatId}`;\n  },\n\n  edit_chat_photo: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Update photo for ${chatId}`;\n  },\n\n  leave_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Leave ${chatId}`;\n  },\n\n  mute_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const muteFor = args.mute_for ? ` for ${args.mute_for} seconds` : '';\n    return `Mute ${chatId}${muteFor}`;\n  },\n\n  unmute_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Unmute ${chatId}`;\n  },\n\n  archive_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Archive ${chatId}`;\n  },\n\n  unarchive_chat: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Unarchive ${chatId}`;\n  },\n\n  // === User & Admin Management Tools ===\n\n  invite_to_group: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const userCount = Array.isArray(args.user_ids) ? args.user_ids.length : 0;\n    return `Invite ${userCount} user${userCount !== 1 ? 's' : ''} to ${chatId}`;\n  },\n\n  ban_user: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const userId = formatId(args.user_id, 'user');\n    return `Ban ${userId} from ${chatId}`;\n  },\n\n  unban_user: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const userId = formatId(args.user_id, 'user');\n    return `Unban ${userId} from ${chatId}`;\n  },\n\n  promote_admin: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const userId = formatId(args.user_id, 'user');\n    return `Promote ${userId} to admin in ${chatId}`;\n  },\n\n  demote_admin: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const userId = formatId(args.user_id, 'user');\n    return `Demote ${userId} from admin in ${chatId}`;\n  },\n\n  block_user: (args) => {\n    const userId = formatId(args.user_id, 'user');\n    return `Block ${userId}`;\n  },\n\n  unblock_user: (args) => {\n    const userId = formatId(args.user_id, 'user');\n    return `Unblock ${userId}`;\n  },\n\n  // === Contact Management Tools ===\n\n  add_contact: (args) => {\n    const firstName = args.first_name || '';\n    const lastName = args.last_name || '';\n    const phone = args.phone_number || '';\n    const name = [firstName, lastName].filter(Boolean).join(' ') || phone;\n    return `Add contact: ${name}`;\n  },\n\n  delete_contact: (args) => {\n    const userId = formatId(args.user_id, 'user');\n    return `Delete contact ${userId}`;\n  },\n\n  list_contacts: (args) => {\n    const limit = args.limit || 20;\n    return `List ${limit} contacts`;\n  },\n\n  search_contacts: (args) => {\n    const query = truncateText(args.query || '', 30);\n    return `Search contacts for \"${query}\"`;\n  },\n\n  // === Search & Discovery Tools ===\n\n  search_messages: (args) => {\n    const chatId = args.chat_id ? formatId(args.chat_id, 'chat') : 'all chats';\n    const query = truncateText(args.query || '', 30);\n    const limit = args.limit || 20;\n    return `Search for \"${query}\" in ${chatId} (limit: ${limit})`;\n  },\n\n  search_public_chats: (args) => {\n    const query = truncateText(args.query || '', 30);\n    return `Search public chats for \"${query}\"`;\n  },\n\n  resolve_username: (args) => {\n    const username = args.username || '';\n    return `Resolve username @${username.replace('@', '')}`;\n  },\n\n  // === Message Retrieval Tools ===\n\n  get_messages: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const limit = args.limit || 20;\n    return `Get ${limit} messages from ${chatId}`;\n  },\n\n  list_messages: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const limit = args.limit || 20;\n    return `List ${limit} messages from ${chatId}`;\n  },\n\n  get_history: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const limit = args.limit || 20;\n    return `Get message history from ${chatId} (${limit} messages)`;\n  },\n\n  get_pinned_messages: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get pinned messages from ${chatId}`;\n  },\n\n  get_message_context: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const limit = args.limit || 5;\n    return `Get context around message ${messageId} in ${chatId} (${limit} messages)`;\n  },\n\n  list_topics: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `List topics in ${chatId}`;\n  },\n\n  // === List & Info Tools ===\n\n  get_participants: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const limit = args.limit || 100;\n    return `Get ${limit} participants from ${chatId}`;\n  },\n\n  get_admins: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get administrators of ${chatId}`;\n  },\n\n  get_banned_users: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get banned users from ${chatId}`;\n  },\n\n  get_blocked_users: () => {\n    return 'Get list of blocked users';\n  },\n\n  // === Invite Link Tools ===\n\n  get_invite_link: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get invite link for ${chatId}`;\n  },\n\n  export_chat_invite: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Create invite link for ${chatId}`;\n  },\n\n  import_chat_invite: (args) => {\n    const inviteHash = args.invite_hash ? truncateText(args.invite_hash, 20) : '';\n    return `Join chat via invite link: ${inviteHash}`;\n  },\n\n  join_chat_by_link: (args) => {\n    const inviteLink = args.invite_link ? truncateText(args.invite_link, 30) : '';\n    return `Join chat via link: ${inviteLink}`;\n  },\n\n  subscribe_public_channel: (args) => {\n    const username = args.username || '';\n    return `Subscribe to public channel @${username.replace('@', '')}`;\n  },\n\n  // === Profile Tools ===\n\n  update_profile: (args) => {\n    const updates: string[] = [];\n    if (args.first_name) updates.push(`first name: \"${args.first_name}\"`);\n    if (args.last_name) updates.push(`last name: \"${args.last_name}\"`);\n    if (args.bio) updates.push(`bio: \"${truncateText(args.bio, 30)}\"`);\n    return `Update profile (${updates.join(', ')})`;\n  },\n\n  set_profile_photo: () => {\n    return 'Set profile photo';\n  },\n\n  delete_profile_photo: () => {\n    return 'Delete profile photo';\n  },\n\n  get_user_photos: (args) => {\n    const userId = formatId(args.user_id, 'user');\n    const limit = args.limit || 20;\n    return `Get ${limit} photos from ${userId}`;\n  },\n\n  get_user_status: (args) => {\n    const userId = formatId(args.user_id, 'user');\n    return `Get status of ${userId}`;\n  },\n\n  // === Other Tools ===\n\n  get_me: () => {\n    return 'Get current user information';\n  },\n\n  list_inline_buttons: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Get inline buttons from message ${messageId} in ${chatId}`;\n  },\n\n  press_inline_button: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    const buttonText = args.button_text ? ` \"${truncateText(args.button_text, 30)}\"` : '';\n    return `Press inline button${buttonText} on message ${messageId} in ${chatId}`;\n  },\n\n  create_poll: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const question = truncateText(args.question || '', 50);\n    const optionCount = Array.isArray(args.options) ? args.options.length : 0;\n    return `Create poll in ${chatId}: \"${question}\" with ${optionCount} options`;\n  },\n\n  get_bot_info: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    return `Get bot information from ${chatId}`;\n  },\n\n  set_bot_commands: (args) => {\n    const chatId = args.chat_id ? formatId(args.chat_id, 'chat') : 'all chats';\n    const commandCount = Array.isArray(args.commands) ? args.commands.length : 0;\n    return `Set ${commandCount} bot commands for ${chatId}`;\n  },\n\n  get_privacy_settings: () => {\n    return 'Get privacy settings';\n  },\n\n  set_privacy_settings: (args) => {\n    const setting = args.setting || 'unknown';\n    const value = args.value || '';\n    return `Set privacy setting \"${setting}\" to ${value}`;\n  },\n\n  get_media_info: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const messageId = args.message_id;\n    return `Get media information from message ${messageId} in ${chatId}`;\n  },\n\n  get_recent_actions: (args) => {\n    const chatId = formatId(args.chat_id, 'chat');\n    const limit = args.limit || 20;\n    return `Get ${limit} recent admin actions from ${chatId}`;\n  },\n};\n","import type {\n  ApiChat,\n  ApiChatAdminRights,\n  ApiChatBannedRights,\n  ApiChatFolder,\n  ApiChatFullInfo,\n  ApiChatInviteInfo,\n  ApiMessage,\n  ApiPeer,\n  ApiPeerColorCollectible,\n  ApiPreparedInlineMessage,\n  ApiTopic,\n} from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\nimport type {\n  CustomPeer, ThreadId,\n} from '../../types';\nimport type { LangFn } from '../../util/localization';\nimport { MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  ANONYMOUS_USER_ID,\n  ARCHIVED_FOLDER_ID, GENERAL_TOPIC_ID, REPLIES_USER_ID, TME_LINK_PREFIX,\n  VERIFICATION_CODES_USER_ID,\n} from '../../config';\nimport { formatDateToString, formatTime } from '../../util/dates/dateFormat';\nimport { getPeerIdDividend, isUserId } from '../../util/entities/ids';\nimport { getServerTime } from '../../util/serverTime';\nimport { selectIsChatRestricted } from '../selectors';\nimport { getGlobal } from '..';\nimport { isSystemBot } from './bots';\nimport { getMainUsername } from './users';\n\nconst FOREVER_BANNED_DATE = Date.now() / 1000 + 31622400; // 366 days\n\nexport function isChatGroup(chat: ApiChat) {\n  return isChatBasicGroup(chat) || isChatSuperGroup(chat);\n}\n\nexport function isChatBasicGroup(chat: ApiChat) {\n  return chat.type === 'chatTypeBasicGroup';\n}\n\nexport function isChatSuperGroup(chat: ApiChat) {\n  return chat.type === 'chatTypeSuperGroup';\n}\n\nexport function isChatChannel(chat: ApiChat) {\n  return chat.type === 'chatTypeChannel';\n}\n\nexport function isChatMonoforum(chat: ApiChat) {\n  return chat.isMonoforum;\n}\n\nexport function isCommonBoxChat(chat: ApiChat) {\n  return chat.type === 'chatTypePrivate' || chat.type === 'chatTypeBasicGroup';\n}\n\nexport function isChatWithRepliesBot(chatId: string) {\n  return chatId === REPLIES_USER_ID;\n}\n\nexport function isChatWithVerificationCodesBot(chatId: string) {\n  return chatId === VERIFICATION_CODES_USER_ID;\n}\n\nexport function isAnonymousForwardsChat(chatId: string) {\n  return chatId === ANONYMOUS_USER_ID;\n}\n\nexport function getChatTypeString(chat: ApiChat) {\n  switch (chat.type) {\n    case 'chatTypePrivate':\n      return 'PrivateChat';\n    case 'chatTypeBasicGroup':\n    case 'chatTypeSuperGroup':\n      return 'AccDescrGroup';\n    case 'chatTypeChannel':\n      return 'AccDescrChannel';\n    default:\n      return 'Chat';\n  }\n}\n\nexport function getPrivateChatUserId(chat: ApiChat) {\n  if (chat.type !== 'chatTypePrivate' && chat.type !== 'chatTypeSecret') {\n    return undefined;\n  }\n  return chat.id;\n}\n\nexport function getChatTitle(lang: OldLangFn | LangFn, chat: ApiChat, isSelf = false) {\n  if (isSelf) {\n    return lang('SavedMessages');\n  }\n  return chat.title || lang('HiddenName');\n}\n\nexport function getChatLink(chat: ApiChat) {\n  const activeUsername = getMainUsername(chat);\n\n  return activeUsername ? `${TME_LINK_PREFIX}${activeUsername}` : undefined;\n}\n\nexport function getChatAvatarHash(\n  owner: ApiPeer,\n  size: 'normal' | 'big' = 'normal',\n  avatarPhotoId = owner.avatarPhotoId,\n) {\n  if (!avatarPhotoId) {\n    return undefined;\n  }\n\n  switch (size) {\n    case 'big':\n      return `profile${owner.id}?${avatarPhotoId}`;\n    default:\n      return `avatar${owner.id}?${avatarPhotoId}`;\n  }\n}\n\nexport function isChatAdmin(chat: ApiChat) {\n  return Boolean(chat.adminRights || chat.isCreator);\n}\n\nexport function getHasAdminRight(chat: ApiChat, key: keyof ApiChatAdminRights) {\n  return chat.adminRights?.[key] || false;\n}\n\nexport function getCanManageTopic(chat: ApiChat, topic: ApiTopic) {\n  if (topic.id === GENERAL_TOPIC_ID) return chat.isCreator;\n  return chat.isCreator || getHasAdminRight(chat, 'manageTopics') || topic.isOwner;\n}\n\nexport function isUserRightBanned(chat: ApiChat, key: keyof ApiChatBannedRights, chatFullInfo?: ApiChatFullInfo) {\n  const unrestrictedByBoosts = chatFullInfo?.boostsToUnrestrict\n    && (chatFullInfo.boostsApplied || 0) >= chatFullInfo.boostsToUnrestrict;\n  return Boolean(\n    (chat.currentUserBannedRights?.[key])\n    || (chat.defaultBannedRights?.[key] && !unrestrictedByBoosts),\n  );\n}\n\nexport function getCanPostInChat(\n  chat: ApiChat, topic?: ApiTopic, isMessageThread?: boolean, chatFullInfo?: ApiChatFullInfo,\n) {\n  if (topic) {\n    if (chat.isForum) {\n      if (chat.isNotJoined) {\n        return false;\n      }\n\n      if (topic?.isClosed && !topic.isOwner && !getHasAdminRight(chat, 'manageTopics')) {\n        return false;\n      }\n    }\n  }\n\n  const global = getGlobal();\n  const isRestricted = selectIsChatRestricted(global, chat.id);\n  if (isRestricted || chat.isForbidden || chat.migratedTo\n    || (chat.isNotJoined && !isChatMonoforum(chat) && !isMessageThread)\n    || isSystemBot(chat.id) || isAnonymousForwardsChat(chat.id)) {\n    return false;\n  }\n\n  if (chat.isCreator) {\n    return true;\n  }\n\n  if (isUserId(chat.id)) {\n    return true;\n  }\n\n  if (isChatChannel(chat)) {\n    return getHasAdminRight(chat, 'postMessages');\n  }\n\n  return isChatAdmin(chat) || !isUserRightBanned(chat, 'sendMessages', chatFullInfo);\n}\n\nexport interface IAllowedAttachmentOptions {\n  canAttachMedia: boolean;\n  canAttachPolls: boolean;\n  canSendStickers: boolean;\n  canSendGifs: boolean;\n  canAttachEmbedLinks: boolean;\n  canSendPhotos: boolean;\n  canSendVideos: boolean;\n  canSendRoundVideos: boolean;\n  canSendAudios: boolean;\n  canSendVoices: boolean;\n  canSendPlainText: boolean;\n  canSendDocuments: boolean;\n  canAttachToDoLists: boolean;\n}\n\nexport function getAllowedAttachmentOptions(\n  chat?: ApiChat,\n  chatFullInfo?: ApiChatFullInfo,\n  isChatWithBot = false,\n  isSavedMessages = false,\n  isStoryReply = false,\n  paidMessagesStars?: number,\n  isInScheduledList = false,\n): IAllowedAttachmentOptions {\n  if (!chat || (paidMessagesStars && isInScheduledList)) {\n    return {\n      canAttachMedia: false,\n      canAttachPolls: false,\n      canSendStickers: false,\n      canSendGifs: false,\n      canAttachEmbedLinks: false,\n      canSendPhotos: false,\n      canSendVideos: false,\n      canSendRoundVideos: false,\n      canSendAudios: false,\n      canSendVoices: false,\n      canSendPlainText: false,\n      canSendDocuments: false,\n      canAttachToDoLists: false,\n    };\n  }\n\n  const isAdmin = isChatAdmin(chat);\n\n  return {\n    canAttachMedia: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendMedia', chatFullInfo),\n    canAttachPolls: !isStoryReply && !chat.isMonoforum\n      && (isAdmin || !isUserRightBanned(chat, 'sendPolls', chatFullInfo))\n      && (!isUserId(chat.id) || isChatWithBot || isSavedMessages),\n    canAttachToDoLists: !isStoryReply && !chat.isMonoforum && !isChatChannel(chat),\n    canSendStickers: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendStickers', chatFullInfo),\n    canSendGifs: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendGifs', chatFullInfo),\n    canAttachEmbedLinks: !isStoryReply && (isAdmin || !isUserRightBanned(chat, 'embedLinks', chatFullInfo)),\n    canSendPhotos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendPhotos', chatFullInfo),\n    canSendVideos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendVideos', chatFullInfo),\n    canSendRoundVideos: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendRoundvideos', chatFullInfo),\n    canSendAudios: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendAudios', chatFullInfo),\n    canSendVoices: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendVoices', chatFullInfo),\n    canSendPlainText: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendPlain', chatFullInfo),\n    canSendDocuments: isAdmin || isStoryReply || !isUserRightBanned(chat, 'sendDocs', chatFullInfo),\n  };\n}\n\nexport function getMessageSendingRestrictionReason(\n  lang: OldLangFn,\n  currentUserBannedRights?: ApiChatBannedRights,\n  defaultBannedRights?: ApiChatBannedRights,\n) {\n  if (currentUserBannedRights?.sendMessages) {\n    const { untilDate } = currentUserBannedRights;\n    return untilDate && untilDate < FOREVER_BANNED_DATE\n      ? lang(\n        'Channel.Persmission.Denied.SendMessages.Until',\n        lang(\n          'formatDateAtTime',\n          [formatDateToString(new Date(untilDate * 1000), lang.code), formatTime(lang, untilDate * 1000)],\n        ),\n      )\n      : lang('Channel.Persmission.Denied.SendMessages.Forever');\n  }\n\n  if (defaultBannedRights?.sendMessages) {\n    return lang('Channel.Persmission.Denied.SendMessages.DefaultRestrictedText');\n  }\n\n  return undefined;\n}\n\nexport function getForumComposerPlaceholder(\n  lang: OldLangFn,\n  chat?: ApiChat,\n  threadId: ThreadId = MAIN_THREAD_ID,\n  topics?: Record<number, ApiTopic>,\n  isReplying?: boolean,\n) {\n  if (!chat?.isForum) {\n    return undefined;\n  }\n\n  if (threadId === MAIN_THREAD_ID) {\n    if (isReplying || (topics && !topics[GENERAL_TOPIC_ID]?.isClosed)) return undefined;\n    return lang('lng_forum_replies_only');\n  }\n\n  const topic = topics?.[Number(threadId)];\n  if (!topic) {\n    return undefined;\n  }\n\n  if (topic.isClosed && !topic.isOwner && !getHasAdminRight(chat, 'manageTopics')) {\n    return lang('TopicClosedByAdmin');\n  }\n\n  return undefined;\n}\n\nexport function isChatArchived(chat: ApiChat) {\n  return chat.folderId === ARCHIVED_FOLDER_ID;\n}\n\nexport function getCanDeleteChat(chat: ApiChat) {\n  return isChatBasicGroup(chat) || ((isChatSuperGroup(chat) || isChatChannel(chat)) && chat.isCreator);\n}\n\nexport function getFolderDescriptionText(lang: LangFn, folder: ApiChatFolder, chatsCount?: number) {\n  const {\n    excludedChatIds, includedChatIds,\n    bots, groups, contacts, nonContacts, channels,\n  } = folder;\n\n  const filters = [bots, groups, contacts, nonContacts, channels];\n\n  // If folder has multiple additive filters or uses include/exclude lists,\n  // we display folder chats count\n  if (\n    chatsCount !== undefined && (\n      Object.values(filters).filter(Boolean).length > 1\n      || (excludedChatIds?.length)\n      || (includedChatIds?.length)\n    )) {\n    return lang('ChatsPlural', { count: chatsCount }, { pluralValue: chatsCount });\n  }\n\n  // Otherwise, we return a short description of a single filter\n  if (bots) {\n    return lang('FilterBots');\n  } else if (groups) {\n    return lang('FilterGroups');\n  } else if (channels) {\n    return lang('FilterChannels');\n  } else if (contacts) {\n    return lang('FilterContacts');\n  } else if (nonContacts) {\n    return lang('FilterNonContacts');\n  } else {\n    return undefined;\n  }\n}\n\nexport function isChatPublic(chat: ApiChat) {\n  return chat.hasUsername;\n}\n\nexport function getOrderedTopics(\n  topics: ApiTopic[], pinnedOrder?: number[], shouldSortByLastMessage = false,\n): ApiTopic[] {\n  if (shouldSortByLastMessage) {\n    return topics.sort((a, b) => b.lastMessageId - a.lastMessageId);\n  } else {\n    const pinned = topics.filter((topic) => topic.isPinned);\n    const ordered = topics\n      .filter((topic) => !topic.isPinned && !topic.isHidden)\n      .sort((a, b) => b.lastMessageId - a.lastMessageId);\n    const hidden = topics.filter((topic) => !topic.isPinned && topic.isHidden)\n      .sort((a, b) => b.lastMessageId - a.lastMessageId);\n\n    const pinnedOrdered = pinnedOrder\n      ? pinnedOrder.map((id) => pinned.find((topic) => topic.id === id)).filter(Boolean) : pinned;\n\n    return [...pinnedOrdered, ...ordered, ...hidden];\n  }\n}\n\nexport function getPeerColorKey(peer: ApiPeer | CustomPeer | undefined, isForAvatar?: boolean) {\n  if (!peer) return 0;\n\n  if ('isCustomPeer' in peer) {\n    return peer.peerColorId;\n  }\n\n  if (peer.color) {\n    if (peer.color.type === 'regular' && peer.color.color !== undefined) return peer.color.color;\n    if (peer.color.type === 'collectible' && !isForAvatar) return undefined; // Custom colors\n  }\n\n  return getPeerIdDividend(peer.id) % 7;\n}\n\nexport function getPeerColorCount(peer: ApiPeer) {\n  const key = getPeerColorKey(peer);\n  if (peer.color?.type === 'collectible') return getPeerColorCollectibleColorCount(peer.color);\n  if (key === undefined) return 1;\n\n  const global = getGlobal();\n  return global.peerColors?.general[key].colors?.length || 1;\n}\n\nexport function getPeerColorCollectibleColorCount(color: ApiPeerColorCollectible): number {\n  return color.colors.length;\n}\n\nexport function getIsSavedDialog(chatId: string, threadId: ThreadId | undefined, currentUserId: string | undefined) {\n  return chatId === currentUserId && threadId !== MAIN_THREAD_ID;\n}\n\nexport function getGroupStatus(lang: OldLangFn, chat: ApiChat) {\n  const chatTypeString = lang(getChatTypeString(chat));\n  const { membersCount } = chat;\n\n  const global = getGlobal();\n  const isRestricted = selectIsChatRestricted(global, chat.id);\n  if (isRestricted) {\n    return chatTypeString === 'Channel' ? 'channel is inaccessible' : 'group is inaccessible';\n  }\n\n  if (!membersCount) {\n    return chatTypeString;\n  }\n\n  return chatTypeString === 'Channel'\n    ? lang('Subscribers', membersCount, 'i')\n    : lang('Members', membersCount, 'i');\n}\n\nexport function getCustomPeerFromInvite(invite: ApiChatInviteInfo): CustomPeer {\n  const {\n    title, color, isVerified, isFake, isScam,\n  } = invite;\n  return {\n    isCustomPeer: true,\n    title,\n    peerColorId: color,\n    isVerified,\n    fakeType: isFake ? 'fake' : isScam ? 'scam' : undefined,\n  };\n}\n\nexport function getMockPreparedMessageFromResult(botId: string, preparedMessage: ApiPreparedInlineMessage) {\n  const { result } = preparedMessage;\n\n  const inlineButtons = result?.sendMessage?.replyMarkup?.inlineButtons;\n\n  return {\n    chatId: botId,\n    content: result.sendMessage.content,\n    date: getServerTime(),\n    id: 0,\n    isOutgoing: true,\n    viaBotId: botId,\n    inlineButtons,\n  } satisfies ApiMessage;\n}\n","import type { ChatSummary, SummarizeChatInfo, SummarizeState } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from './tabs';\n\nexport function selectSummarizeState<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): SummarizeState {\n  return selectTabState(global, tabId).summarize;\n}\n\nexport function selectIsSummarizeSetupComplete<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  return selectSummarizeState(global, tabId).isSetupComplete;\n}\n\nexport function selectBusiestChats<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): SummarizeChatInfo[] | undefined {\n  return selectSummarizeState(global, tabId).busiestChats;\n}\n\nexport function selectIsLoadingBusiestChats<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  return selectSummarizeState(global, tabId).isLoadingBusiestChats ?? false;\n}\n\nexport function selectSelectedChatIds<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): string[] {\n  return selectSummarizeState(global, tabId).selectedChatIds;\n}\n\nexport function selectSummaries<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ChatSummary[] {\n  return selectSummarizeState(global, tabId).summaries;\n}\n\nexport function selectFilteredSummaries<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): ChatSummary[] {\n  const { summaries, searchQuery } = selectSummarizeState(global, tabId);\n\n  if (!searchQuery) {\n    return summaries;\n  }\n\n  const query = searchQuery.toLowerCase();\n  return summaries.filter((summary) => {\n    const chat = global.chats.byId[summary.chatId];\n    const chatTitle = chat?.title?.toLowerCase() || '';\n    const contentText = summary.content.paragraphs.join(' ').toLowerCase();\n    return chatTitle.includes(query) || contentText.includes(query);\n  });\n}\n\nexport function selectIsLoadingSummaries<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  return selectSummarizeState(global, tabId).isLoadingSummaries ?? false;\n}\n\nexport function selectSummarizeSearchQuery<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): string | undefined {\n  return selectSummarizeState(global, tabId).searchQuery;\n}\n\nexport function selectIncludeArchived<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  return selectSummarizeState(global, tabId).includeArchived ?? false;\n}\n\nexport function selectIsSummarizePageOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  // Use middleColumnView to determine if page is open (mutual exclusion)\n  const tabState = selectTabState(global, tabId);\n  return tabState.middleColumnView === 'summarize';\n}\n\nexport function selectSummarizeSelectedDate<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): number | undefined {\n  return selectSummarizeState(global, tabId).selectedDate;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport { ApiMediaFormat } from '../api/types';\n\nimport { selectIsSynced } from '../global/selectors';\nimport { IS_PROGRESSIVE_SUPPORTED } from '../util/browser/windowEnvironment';\nimport * as mediaLoader from '../util/mediaLoader';\nimport useSelector from './data/useSelector';\nimport useForceUpdate from './useForceUpdate';\n\nconst useMedia = (\n  mediaHash: string | false | undefined,\n  noLoad = false,\n  mediaFormat = ApiMediaFormat.BlobUrl,\n  delay?: number | false,\n) => {\n  const isStreaming = IS_PROGRESSIVE_SUPPORTED && mediaFormat === ApiMediaFormat.Progressive;\n  const mediaData = mediaHash\n    ? (isStreaming ? mediaLoader.getProgressiveUrl(mediaHash)\n      : mediaLoader.getFromMemory(mediaHash)) : undefined;\n\n  const forceUpdate = useForceUpdate();\n  const isSynced = useSelector(selectIsSynced);\n\n  useEffect(() => {\n    if (!noLoad && mediaHash && !mediaData) {\n      const startedAt = Date.now();\n\n      mediaLoader.fetch(mediaHash, mediaFormat).then(() => {\n        const spentTime = Date.now() - startedAt;\n        if (!delay || spentTime >= delay) {\n          forceUpdate();\n        } else {\n          setTimeout(forceUpdate, delay - spentTime);\n        }\n      });\n    }\n  }, [noLoad, mediaHash, mediaData, mediaFormat, delay, isSynced]);\n\n  return mediaData;\n};\n\nexport default useMedia;\n","import { isTauri } from '@tauri-apps/api/core';\n\ndeclare const globalThis: ServiceWorkerGlobalScope & WorkerGlobalScope & SharedWorkerGlobalScope & Window;\n\nexport const IS_MULTIACCOUNT_SUPPORTED = 'SharedWorker' in globalThis;\nexport const IS_INTL_LIST_FORMAT_SUPPORTED = 'ListFormat' in Intl;\nexport const IS_BAD_URL_PARSER = new URL('tg://host').host !== 'host';\nexport const ARE_WEBCODECS_SUPPORTED = 'VideoDecoder' in globalThis;\n\nexport const IS_TAURI = isTauri();\n// @ts-expect-error no types for electron\nexport const IS_ELECTRON = Boolean(globalThis.electron);\n","import type { GlobalState } from '../../global/types';\n\nimport useDerivedState from '../useDerivedState';\nimport useSelectorSignal from './useSelectorSignal';\n\ntype Selector<T> = (global: GlobalState) => T;\n\nexport default function useSelector<T>(selector: Selector<T>) {\n  const selectorSignal = useSelectorSignal(selector);\n  return useDerivedState(selectorSignal);\n}\n","import type { MouseEvent as ReactMouseEvent } from 'react';\nimport type { ElementRef, FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { useRef, useState } from '../../lib/teact/teact';\n\nimport type { IconName } from '../../types/icons';\n\nimport { IS_TOUCH_ENV, MouseButton } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\n\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport Icon from '../common/icons/Icon';\nimport Sparkles from '../common/Sparkles';\nimport RippleEffect from './RippleEffect';\nimport Spinner from './Spinner';\n\nimport './Button.scss';\n\nexport type OwnProps = {\n  ref?: ElementRef<HTMLButtonElement | HTMLAnchorElement>;\n  type?: 'button' | 'submit' | 'reset';\n  children?: React.ReactNode;\n  size?: 'default' | 'smaller' | 'tiny';\n  color?: (\n    'primary' | 'secondary' | 'gray' | 'danger' | 'translucent' | 'translucent-white' | 'translucent-black'\n    | 'translucent-bordered' | 'dark' | 'green' | 'adaptive' | 'stars' | 'bluredStarsBadge' | 'transparentBlured'\n  );\n  backgroundImage?: string;\n  id?: string;\n  className?: string;\n  round?: boolean;\n  pill?: boolean;\n  badge?: boolean;\n  fluid?: boolean;\n  inline?: boolean;\n  isText?: boolean;\n  isLoading?: boolean;\n  ariaLabel?: string;\n  ariaControls?: string;\n  hasPopup?: boolean;\n  href?: string;\n  download?: string;\n  disabled?: boolean;\n  nonInteractive?: boolean;\n  allowDisabledClick?: boolean;\n  noFastClick?: boolean;\n  ripple?: boolean;\n  faded?: boolean;\n  tabIndex?: number;\n  isRtl?: boolean;\n  isShiny?: boolean;\n  isRectangular?: boolean;\n  withPremiumGradient?: boolean;\n  withSparkleEffect?: boolean;\n  noSparkleAnimation?: boolean;\n  noPreventDefault?: boolean;\n  noForcedUpperCase?: boolean;\n  shouldStopPropagation?: boolean;\n  style?: string;\n  iconName?: IconName;\n  iconAlignment?: 'top' | 'bottom' | 'start' | 'end';\n  iconClassName?: string;\n  onClick?: (e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  onContextMenu?: (e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => void;\n  onMouseDown?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseUp?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseEnter?: (e: ReactMouseEvent<HTMLButtonElement>) => void;\n  onMouseLeave?: NoneToVoidFunction;\n  onFocus?: NoneToVoidFunction;\n  onTransitionEnd?: NoneToVoidFunction;\n};\n\n// Longest animation duration;\nconst CLICKED_TIMEOUT = 400;\n\nconst Button: FC<OwnProps> = ({\n  ref,\n  type = 'button',\n  id,\n  children,\n  size = 'default',\n  color = 'primary',\n  backgroundImage,\n  className,\n  round,\n  pill,\n  badge,\n  fluid,\n  inline,\n  isText,\n  isLoading,\n  isShiny,\n  withPremiumGradient,\n  withSparkleEffect,\n  noSparkleAnimation,\n  ariaLabel,\n  ariaControls,\n  hasPopup,\n  href,\n  download,\n  disabled,\n  nonInteractive,\n  allowDisabledClick,\n  noFastClick = color === 'danger',\n  ripple,\n  faded,\n  tabIndex,\n  isRtl,\n  isRectangular,\n  noPreventDefault,\n  shouldStopPropagation,\n  noForcedUpperCase,\n  style,\n  iconName,\n  iconAlignment = 'start',\n  iconClassName,\n  onClick,\n  onContextMenu,\n  onMouseDown,\n  onMouseUp,\n  onMouseEnter,\n  onMouseLeave,\n  onFocus,\n  onTransitionEnd,\n}) => {\n  let elementRef = useRef<HTMLButtonElement | HTMLAnchorElement>();\n  if (ref) {\n    elementRef = ref;\n  }\n\n  const lang = useOldLang();\n\n  const [isClicked, setIsClicked] = useState(false);\n\n  const isNotInteractive = disabled || nonInteractive;\n\n  const fullClassName = buildClassName(\n    'Button',\n    className,\n    size,\n    color,\n    round && 'round',\n    pill && 'pill',\n    fluid && 'fluid',\n    badge && 'badge',\n    isNotInteractive && 'disabled',\n    nonInteractive && 'non-interactive',\n    allowDisabledClick && 'click-allowed',\n    isText && 'text',\n    isLoading && 'loading',\n    ripple && 'has-ripple',\n    faded && 'faded',\n    isClicked && 'clicked',\n    backgroundImage && 'with-image',\n    isShiny && 'shiny',\n    withPremiumGradient && 'premium',\n    isRectangular && 'rectangular',\n    noForcedUpperCase && 'no-upper-case',\n    inline && 'inline',\n    Boolean(iconName && children) && `content-with-icon-${iconAlignment}`,\n  );\n\n  const handleClick = useLastCallback((e: ReactMouseEvent<HTMLButtonElement, MouseEvent>) => {\n    if ((allowDisabledClick || !isNotInteractive) && onClick) {\n      onClick(e);\n    }\n\n    if (shouldStopPropagation) e.stopPropagation();\n\n    setIsClicked(true);\n    setTimeout(() => {\n      setIsClicked(false);\n    }, CLICKED_TIMEOUT);\n  });\n\n  const handleMouseDown = useLastCallback((e: ReactMouseEvent<HTMLButtonElement>) => {\n    if (!noPreventDefault) e.preventDefault();\n\n    if ((allowDisabledClick || !isNotInteractive) && onMouseDown) {\n      onMouseDown(e);\n    }\n\n    if (!IS_TOUCH_ENV && e.button === MouseButton.Main && !noFastClick) {\n      handleClick(e);\n    }\n  });\n\n  const renderIcon = () => {\n    if (!iconName) return undefined;\n    return <Icon name={iconName} className={iconClassName} />;\n  };\n\n  const renderContent = () => {\n    if (isLoading) {\n      return (\n        <div>\n          <span dir={isRtl ? 'auto' : undefined}>{lang('Cache.ClearProgress')}</span>\n          <Spinner color={isText ? 'blue' : 'white'} />\n        </div>\n      );\n    }\n\n    const icon = renderIcon();\n\n    if (!icon) {\n      return children;\n    }\n\n    if (!children) {\n      return icon;\n    }\n\n    return (\n      <div className={`with-icon-${iconAlignment}`}>\n        {icon}\n        {children}\n      </div>\n    );\n  };\n\n  const content = (\n    <>\n      {withSparkleEffect && <Sparkles preset=\"button\" noAnimation={noSparkleAnimation} />}\n      {renderContent()}\n      {!isNotInteractive && ripple && (\n        <RippleEffect />\n      )}\n    </>\n  );\n\n  if (href) {\n    return (\n      <a\n        ref={elementRef as ElementRef<HTMLAnchorElement>}\n        id={id}\n        className={fullClassName}\n        href={href}\n        title={ariaLabel}\n        download={download}\n        tabIndex={tabIndex}\n        dir={isRtl ? 'rtl' : undefined}\n        aria-label={ariaLabel}\n        aria-controls={ariaControls}\n        style={style}\n        onTransitionEnd={onTransitionEnd}\n        target=\"_blank\"\n        rel=\"noreferrer\"\n      >\n        {content}\n      </a>\n    );\n  }\n\n  return (\n    <button\n      ref={elementRef as ElementRef<HTMLButtonElement>}\n      id={id}\n      type={type}\n      className={fullClassName}\n      onClick={IS_TOUCH_ENV || noFastClick ? handleClick : undefined}\n      onContextMenu={onContextMenu}\n      onMouseDown={handleMouseDown}\n      onMouseUp={onMouseUp}\n      onMouseEnter={onMouseEnter && !isNotInteractive ? onMouseEnter : undefined}\n      onMouseLeave={onMouseLeave && !isNotInteractive ? onMouseLeave : undefined}\n      onTransitionEnd={onTransitionEnd}\n      onFocus={onFocus && !isNotInteractive ? onFocus : undefined}\n      aria-label={ariaLabel}\n      aria-controls={ariaControls}\n      aria-haspopup={hasPopup}\n      title={ariaLabel}\n      tabIndex={tabIndex}\n      dir={isRtl ? 'rtl' : undefined}\n      style={buildStyle(style, backgroundImage && `background-image: url(${backgroundImage})`) || undefined}\n    >\n      {content}\n    </button>\n  );\n};\n\nexport default Button;\n","import type { ApiLimitType } from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { DEFAULT_LIMITS } from '../../limits';\nimport { selectIsCurrentUserPremium } from './users';\n\nexport function selectCurrentLimit<T extends GlobalState>(global: T, limit: ApiLimitType) {\n  const { appConfig } = global;\n  const { limits } = appConfig;\n\n  const isPremium = selectIsCurrentUserPremium(global);\n\n  // When there are new limits when updating a layer, until we get a new configuration, we must use the default values\n  const value = limits[limit]?.[isPremium ? 1 : 0] ?? DEFAULT_LIMITS[limit][isPremium ? 1 : 0];\n  if (limit === 'dialogFilters') return value + 1; // Server does not count \"All\" as folder, but we need to\n  return value;\n}\n\nexport function selectPremiumLimit<T extends GlobalState>(global: T, limit: ApiLimitType) {\n  const { appConfig } = global;\n  if (!appConfig) return DEFAULT_LIMITS[limit][1];\n\n  const { limits } = appConfig;\n\n  return limits[limit][1];\n}\n","/**\n * Types for AI Socket Manager\n * Types matching backend interfaces\n */\n\nimport type { ApiChatType } from '../../api/types/chats';\nimport type { ApiMessage } from '../../api/types/messages';\n\nexport enum TgMessageType {\n  TEXT = 'text',\n  PHOTO = 'photo',\n  VIDEO = 'video',\n  AUDIO = 'audio',\n  DOCUMENT = 'document',\n  STICKER = 'sticker',\n  VOICE = 'voice',\n}\n\n/**\n * Unified chat type for socket communication\n * Merged from ApiChatType ('chatTypePrivate' | 'chatTypeSecret' | 'chatTypeBasicGroup' | 'chatTypeSuperGroup' | 'chatTypeChannel')\n * and socket chatType ('private' | 'group' | 'supergroup' | 'channel')\n */\nexport type SocketChatType = 'private' | 'group' | 'supergroup' | 'channel';\n\n/**\n * Converts ApiChatType to SocketChatType\n * @param apiChatType - The API chat type\n * @returns The corresponding socket chat type\n */\nexport function convertApiChatTypeToSocketChatType(apiChatType: ApiChatType): SocketChatType {\n  switch (apiChatType) {\n    case 'chatTypePrivate':\n    case 'chatTypeSecret':\n      return 'private';\n    case 'chatTypeBasicGroup':\n      return 'group';\n    case 'chatTypeSuperGroup':\n      return 'supergroup';\n    case 'chatTypeChannel':\n      return 'channel';\n    default: {\n      // TypeScript exhaustiveness check - this should never happen\n      const _exhaustive: never = apiChatType;\n      return 'private';\n    }\n  }\n}\n\n/**\n * Determines the message type from ApiMessage content\n * Checks content properties in order of specificity\n * @param message - The API message\n * @returns The corresponding TgMessageType\n */\nexport function getMessageTypeFromApiMessage(message: ApiMessage): TgMessageType {\n  const { content } = message;\n\n  // Check in order of specificity\n  if (content.sticker) {\n    return TgMessageType.STICKER;\n  }\n  if (content.voice) {\n    return TgMessageType.VOICE;\n  }\n  if (content.photo) {\n    return TgMessageType.PHOTO;\n  }\n  if (content.video) {\n    return TgMessageType.VIDEO;\n  }\n  if (content.audio) {\n    return TgMessageType.AUDIO;\n  }\n  if (content.document) {\n    return TgMessageType.DOCUMENT;\n  }\n\n  // Default to text if no media content is found\n  return TgMessageType.TEXT;\n}\n\nexport interface ITgMessageReaction {\n  emoji: string;\n  count: number;\n}\n\nexport interface ITgMessage {\n  chatId: number;\n  chatType: SocketChatType;\n  content: string;\n  fromUserId: number;\n  fromUserType: 'user' | 'bot';\n  messageId: number;\n  messageType: TgMessageType;\n  messageTimestamp: number;\n  reactions?: ITgMessageReaction[];\n}\n\nexport interface SyncMessagesData {\n  messages: Partial<ITgMessage>[];\n}\n\n/**\n * Encrypted message data sent to backend\n * Includes encrypted hashes for chatHash and fromUserHash\n * messageId is sent as raw number (not encrypted)\n */\nexport interface IEncryptedTgMessage extends Partial<ITgMessage> {\n  contentHash?: string;\n  chatHash?: string;\n  fromUserIdHash?: string;\n  fromUsernameHash?: string;\n  fromFirstNameHash?: string;\n  fromLastNameHash?: string;\n  messageId?: number; // Raw messageId (not encrypted)\n}\n\n/**\n * Socket manager state type\n */\nexport type AlphaHumanManagerState =\n  | 'disconnected'\n  | 'jwt_missing'\n  | 'jwt_invalid'\n  | 'connected';\n\nexport type AgentMessageType = 'text' | 'start' | 'toolStart' | 'toolEnd' | 'reasoning' | 'complete';\nexport enum AgentMessageSender {\n  USER = 'user',\n  AGENT = 'agent',\n  ACTION = 'action',\n}\n\nexport type AgentType = 'text' | 'start' | 'toolStart' | 'toolEnd' | 'reasoning' | 'complete' | 'error';\n\nexport interface AlphahumanThreadMessage {\n  thread: string; // Reference to the agent thread\n  tgUser: string; // Reference to Telegram user\n  id: string;\n  content: string;\n  type: AgentType;\n  extraMetadata: Record<string, unknown>;\n  sender: AgentMessageSender;\n  isDeleted: boolean;\n  deletedAt?: Date;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\n/**\n * Agent update event from backend\n * Supports streaming updates with different event types\n */\nexport interface AgentUpdate {\n  eventType: 'chunk' | 'reasoning' | 'toolStart' | 'toolEnd' | 'complete' | 'error';\n  message: AlphahumanThreadMessage;\n}\n\n/**\n * Stream message request\n */\nexport interface StreamMessageRequest {\n  threadId?: string;\n  content: string;\n}\n","import type { ThreadId } from '../../types';\nimport type { GlobalState } from '../types';\nimport type { TabArgs } from '../types';\nimport { AgentMessageSender } from '../../lib/alphahuman/types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from './index';\n\nexport function selectAlphaHumanThreadId<T extends GlobalState>(\n  global: T,\n): ThreadId | undefined {\n  return global.alphahuman?.activeThreadId;\n}\n\nexport function selectIsAlphaHumanThreadOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): boolean {\n  // Use middleColumnView to determine if page is open (mutual exclusion)\n  const tabState = selectTabState(global, tabId);\n  return tabState.middleColumnView === 'alphaHumanThread';\n}\n\n/**\n * Build threadsCache from threads (REST API) and threadMessages\n * This combines thread metadata with actual messages\n * Also includes threads that exist in threadMessages but not yet in threads (newly created threads)\n */\nexport function selectAlphahumanThreadsCache<T extends GlobalState>(\n  global: T,\n): {\n  byId: Record<string, {\n    id: string;\n    title: string;\n    lastMessage: string;\n    timestamp: Date;\n    messageCount: number;\n    chatId?: string;\n    messages: Array<{\n      id: string;\n      content: string;\n      sender: 'user' | 'agent';\n      timestamp: Date;\n    }>;\n  }>;\n  activeThreadId?: string;\n  orderedIds: string[];\n} | undefined {\n  const alphahuman = global.alphahuman;\n  if (!alphahuman) return undefined;\n\n  const threads = alphahuman.threads || [];\n  const threadMessages = alphahuman.threadMessages || {};\n  const activeThreadId = alphahuman.activeThreadId;\n\n  // Build byId record\n  const byId: Record<string, {\n    id: string;\n    title: string;\n    lastMessage: string;\n    timestamp: Date;\n    messageCount: number;\n    chatId?: string;\n    messages: Array<{\n      id: string;\n      content: string;\n      sender: 'user' | 'agent';\n      timestamp: Date;\n    }>;\n  }> = {};\n\n  // Process threads from REST API\n  threads.forEach((thread) => {\n    const messages = threadMessages[thread.id]?.messages || [];\n\n    // Convert AlphahumanThreadMessage to the format expected by components\n    const formattedMessages = messages\n      .filter((msg) => !msg.isDeleted)\n      .map((msg) => ({\n        id: msg.id,\n        content: msg.content,\n        sender: msg.sender === AgentMessageSender.USER ? 'user' as const : 'agent' as const,\n        timestamp: msg.createdAt ? new Date(msg.createdAt) : new Date(),\n      }));\n\n    // Get last message content\n    const lastMessage = formattedMessages.length > 0\n      ? formattedMessages[formattedMessages.length - 1].content\n      : '';\n\n    // Get timestamp from last message or thread creation\n    const timestamp = formattedMessages.length > 0\n      ? formattedMessages[formattedMessages.length - 1].timestamp\n      : (thread.createdAt ? new Date(thread.createdAt) : new Date());\n\n    byId[thread.id] = {\n      id: thread.id,\n      title: thread.title || `Thread ${thread.id.slice(0, 8)}`,\n      lastMessage,\n      timestamp,\n      messageCount: formattedMessages.length,\n      chatId: thread.chatId,\n      messages: formattedMessages,\n    };\n  });\n\n  // Also include threads that exist in threadMessages but not yet in threads (newly created threads)\n  Object.keys(threadMessages).forEach((threadId) => {\n    // Skip if already processed from threads array\n    if (byId[threadId]) return;\n\n    const messages = threadMessages[threadId]?.messages || [];\n\n    // Convert AlphahumanThreadMessage to the format expected by components\n    const formattedMessages = messages\n      .filter((msg) => !msg.isDeleted)\n      .map((msg) => ({\n        id: msg.id,\n        content: msg.content,\n        sender: msg.sender === AgentMessageSender.USER ? 'user' as const : 'agent' as const,\n        timestamp: msg.createdAt ? new Date(msg.createdAt) : new Date(),\n      }));\n\n    // Get last message content\n    const lastMessage = formattedMessages.length > 0\n      ? formattedMessages[formattedMessages.length - 1].content\n      : '';\n\n    // Get timestamp from last message or current time\n    const timestamp = formattedMessages.length > 0\n      ? formattedMessages[formattedMessages.length - 1].timestamp\n      : new Date();\n\n    byId[threadId] = {\n      id: threadId,\n      title: `Thread ${threadId.slice(0, 8)}`,\n      lastMessage,\n      timestamp,\n      messageCount: formattedMessages.length,\n      chatId: undefined, // Newly created threads may not have chatId yet\n      messages: formattedMessages,\n    };\n  });\n\n  // Build orderedIds (sorted by last message timestamp, most recent first)\n  const orderedIds = Object.values(byId)\n    .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())\n    .map((thread) => thread.id);\n\n  return {\n    byId,\n    activeThreadId,\n    orderedIds,\n  };\n}\n","import type { ApiCountryCode } from '../api/types';\n\nconst PATTERN_PLACEHOLDER = 'X';\nconst DEFAULT_PATTERN = 'XXX XXX XXX XXX';\n\nexport function getCountryCodeByIso(phoneCodeList: ApiCountryCode[], iso: string) {\n  return phoneCodeList.find((country) => country.iso2 === iso);\n}\n\nexport function getCountryFromPhoneNumber(phoneCodeList: ApiCountryCode[], input = '') {\n  let phoneNumber = input.replace(/[^\\d+]+/g, '');\n  if (phoneNumber.startsWith('+')) {\n    phoneNumber = phoneNumber.substr(1);\n  }\n\n  const possibleCountries = phoneCodeList\n    .filter((country) => phoneNumber.startsWith(country.countryCode));\n  const codesWithPrefix: { code: string; country: ApiCountryCode }[] = possibleCountries\n    .map((country) => (country.prefixes || ['']).map((prefix) => {\n      return {\n        code: `${country.countryCode}${prefix}`,\n        country,\n      };\n    }))\n    .flat();\n\n  const bestMatches = codesWithPrefix\n    .filter(({ code }) => phoneNumber.startsWith(code))\n    .sort((a, b) => a.code.length - b.code.length);\n\n  return bestMatches[bestMatches.length - 1]?.country;\n}\n\nexport function formatPhoneNumber(input: string, country?: ApiCountryCode) {\n  if (!input) {\n    return '';\n  }\n\n  let phoneNumber = input.replace(/[^\\d]+/g, '');\n  if (country) {\n    phoneNumber = phoneNumber.substr(country.countryCode.length);\n  } else if (input.startsWith('+')) {\n    return input;\n  }\n  const pattern = getBestPattern(phoneNumber, country?.patterns);\n\n  const result: string[] = []; // Result character array\n  let j = 0; // Position inside pattern\n  for (let i = 0; i < phoneNumber.length; i++) {\n    while (pattern[j] !== PATTERN_PLACEHOLDER && j < pattern.length) {\n      result.push(pattern[j]);\n      if (pattern[j] === phoneNumber[i]) { // If pattern contains digits, move input position too\n        i++;\n        if (i === phoneNumber.length) break; // But don't overdo it, or it will insert full pattern unexpectedly\n      }\n      j++;\n    }\n\n    result.push(phoneNumber[i]); // For placeholder characters, setting current input digit\n    j++;\n  }\n\n  return result.join('');\n}\n\nfunction getBestPattern(numberWithoutCode: string, patterns?: string[]) {\n  if (!patterns || patterns.length === 0) return DEFAULT_PATTERN;\n  if (patterns.length === 1) return patterns[0];\n\n  const defaultPattern = patterns.find((pattern) => pattern.startsWith(PATTERN_PLACEHOLDER)) || DEFAULT_PATTERN;\n\n  const bestMatches = patterns.filter((pattern) => {\n    const stripped = pattern.replace(/[^\\dX]+/g, '');\n    if (stripped.startsWith(PATTERN_PLACEHOLDER)) return false; // Don't consider default number format here\n    for (let i = 0; i < numberWithoutCode.length; i++) {\n      if (i > stripped.length - 1 || (stripped[i] !== PATTERN_PLACEHOLDER && stripped[i] !== numberWithoutCode[i])) {\n        return false;\n      }\n    }\n    return true;\n  });\n\n  // Playing it safe: if not sure, use default for that region\n  return bestMatches.length === 1 ? bestMatches[0] : defaultPattern;\n}\n\nexport function formatPhoneNumberWithCode(phoneCodeList: ApiCountryCode[], phoneNumber: string) {\n  if (!phoneNumber) {\n    return '';\n  }\n\n  const numberWithPlus = phoneNumber.startsWith('+') ? phoneNumber : `+${phoneNumber}`;\n  const country = getCountryFromPhoneNumber(phoneCodeList, numberWithPlus);\n  if (!country) {\n    return numberWithPlus;\n  }\n  return `+${country.countryCode} ${formatPhoneNumber(numberWithPlus, country)}`;\n}\n","import type { ElementRef } from '../../../../lib/teact/teact';\nimport { getIsHeavyAnimating, useEffect, useRef } from '../../../../lib/teact/teact';\n\nimport { requestMeasure } from '../../../../lib/fasterdom/fasterdom';\n\nimport useHeavyAnimation from '../../../../hooks/useHeavyAnimation';\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport usePriorityPlaybackCheck, { isPriorityPlaybackActive } from '../../../../hooks/usePriorityPlaybackCheck';\nimport useBackgroundMode, { isBackgroundModeActive } from '../../../../hooks/window/useBackgroundMode';\n\nexport default function useVideoAutoPause(\n  playerRef: ElementRef<HTMLVideoElement>, canPlay: boolean, isPriority?: boolean,\n) {\n  const canPlayRef = useRef();\n  canPlayRef.current = canPlay;\n\n  const { play, pause } = usePlayPause(playerRef);\n\n  const unfreezePlaying = useLastCallback(() => {\n    if (canPlayRef.current && (isPriority || !isFrozen())) {\n      play();\n    }\n  });\n\n  const unfreezePlayingOnRaf = useLastCallback(() => {\n    requestMeasure(unfreezePlaying);\n  });\n\n  useBackgroundMode(pause, unfreezePlayingOnRaf, !canPlay || isPriority);\n  useHeavyAnimation(pause, unfreezePlaying, !canPlay || isPriority);\n  usePriorityPlaybackCheck(pause, unfreezePlaying, !canPlay || isPriority);\n\n  const handlePlaying = useLastCallback(() => {\n    if (!canPlayRef.current || (!isPriority && isFrozen())) {\n      pause();\n    }\n  });\n\n  useEffect(() => {\n    if (canPlay) {\n      if (isPriority || !isFrozen()) {\n        play();\n      }\n    } else {\n      pause();\n    }\n  }, [canPlay, play, pause, isPriority]);\n\n  return { handlePlaying };\n}\n\nfunction usePlayPause(mediaRef: ElementRef<HTMLMediaElement>) {\n  const shouldPauseRef = useRef(false);\n  const isLoadingPlayRef = useRef(false);\n\n  const play = useLastCallback(() => {\n    shouldPauseRef.current = false;\n    if (mediaRef.current && !isLoadingPlayRef.current && document.body.contains(mediaRef.current)) {\n      isLoadingPlayRef.current = true;\n      mediaRef.current.play().then(() => {\n        isLoadingPlayRef.current = false;\n        if (shouldPauseRef.current) {\n          mediaRef.current?.pause();\n          shouldPauseRef.current = false;\n        }\n      }).catch((e) => {\n        // eslint-disable-next-line no-console\n        console.warn(e);\n      });\n    }\n  });\n\n  const pause = useLastCallback(() => {\n    if (isLoadingPlayRef.current) {\n      shouldPauseRef.current = true;\n    } else {\n      mediaRef.current?.pause();\n    }\n  });\n\n  return { play, pause };\n}\n\nfunction isFrozen() {\n  return getIsHeavyAnimating() || isPriorityPlaybackActive() || isBackgroundModeActive();\n}\n","import type { ElementRef } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { memo, useMemo, useRef } from '../../lib/teact/teact';\n\nimport useBuffering from '../../hooks/useBuffering';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useSyncEffect from '../../hooks/useSyncEffect';\nimport useVideoCleanup from '../../hooks/useVideoCleanup';\nimport useVideoAutoPause from '../middle/message/hooks/useVideoAutoPause';\n\ntype VideoProps = React.DetailedHTMLProps<React.VideoHTMLAttributes<HTMLVideoElement>, HTMLVideoElement>;\n\ntype OwnProps =\n  {\n    ref?: ElementRef<HTMLVideoElement>;\n    isPriority?: boolean;\n    canPlay: boolean;\n    children?: React.ReactNode;\n    onReady?: NoneToVoidFunction;\n    onBroken?: NoneToVoidFunction;\n  }\n  & VideoProps;\n\nfunction OptimizedVideo({\n  ref,\n  isPriority,\n  canPlay,\n  children,\n  onReady,\n  onBroken,\n  onTimeUpdate,\n  ...restProps\n}: OwnProps) {\n  const localRef = useRef<HTMLVideoElement>();\n  if (!ref) {\n    ref = localRef;\n  }\n\n  const { handlePlaying: handlePlayingForAutoPause } = useVideoAutoPause(ref, canPlay, isPriority);\n\n  const isReadyRef = useRef(false);\n  const handleReady = useLastCallback(() => {\n    if (!isReadyRef.current) {\n      onReady?.();\n      isReadyRef.current = true;\n    }\n  });\n\n  // This is only needed for browsers not allowing autoplay\n  const { isBuffered, bufferingHandlers } = useBuffering(true, onTimeUpdate, onBroken);\n  const { onPlaying: handlePlayingForBuffering, ...otherBufferingHandlers } = bufferingHandlers;\n  useSyncEffect(([prevIsBuffered]) => {\n    if (prevIsBuffered === undefined) {\n      return;\n    }\n\n    handleReady();\n  }, [isBuffered, handleReady]);\n\n  const handlePlaying = useLastCallback((e) => {\n    handlePlayingForAutoPause();\n    handlePlayingForBuffering(e);\n    handleReady();\n    restProps.onPlaying?.(e);\n  });\n\n  const mergedOtherBufferingHandlers = useMemo(() => {\n    const mergedHandlers: Record<string, AnyFunction> = {};\n    Object.keys(otherBufferingHandlers).forEach((keyString) => {\n      const key = keyString as keyof typeof otherBufferingHandlers;\n      mergedHandlers[key] = (event: Event) => {\n        restProps[key as keyof typeof restProps]?.(event);\n        otherBufferingHandlers[key]?.(event);\n      };\n    });\n\n    return mergedHandlers;\n  }, [otherBufferingHandlers, restProps]);\n\n  useVideoCleanup(ref, mergedOtherBufferingHandlers);\n\n  return (\n\n    <video ref={ref} autoPlay {...restProps} {...mergedOtherBufferingHandlers} onPlaying={handlePlaying}>\n      {children}\n    </video>\n  );\n}\n\nexport default memo(OptimizedVideo);\n","import { useRef } from '../lib/teact/teact';\n\nimport useSyncEffect from './useSyncEffect';\n\nconst useLayoutEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useSyncEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies);\n};\n\nexport default useLayoutEffectWithPrevDeps;\n","import type { MessageListType, ThreadId } from '../types';\nimport { MAIN_THREAD_ID } from '../api/types';\n\nimport { IS_MOCKED_CLIENT } from '../config';\n\nlet parsedInitialLocationHash: Record<string, string> | undefined;\nlet messageHash: string | undefined;\nlet isAlreadyParsed = false;\nlet initialLocationHash = window.location.hash;\n\nexport function resetInitialLocationHash() {\n  isAlreadyParsed = false;\n  messageHash = undefined;\n  parsedInitialLocationHash = undefined;\n  initialLocationHash = '';\n}\n\nexport function resetLocationHash() {\n  window.location.hash = '';\n}\n\nexport const createLocationHash = (chatId: string, type: MessageListType, threadId: ThreadId): string => {\n  const displayType = type === 'thread' ? undefined : type;\n  const parts = threadId === MAIN_THREAD_ID ? [chatId, displayType] : [chatId, threadId, displayType];\n\n  return parts.filter(Boolean).join('_');\n};\n\nexport function parseLocationHash(currentUserId?: string) {\n  parseInitialLocationHash();\n\n  if (!messageHash) return undefined;\n\n  // Check if it's the summarize page\n  if (messageHash === 'summarize') {\n    return {\n      isSummarize: true,\n    };\n  }\n\n  // Check if it's an alphahuman thread\n  if (messageHash.startsWith('at-')) {\n    const threadId = messageHash.replace('at-', '');\n    return {\n      isAlphaHumanThread: true,\n      threadId,\n    };\n  }\n\n  const parts = messageHash.split('_');\n  let chatId: string | undefined;\n  let type: string | undefined;\n  let threadId: string | undefined;\n  if (parts.length === 1) {\n    chatId = parts[0];\n  } else if (parts.length === 2) {\n    const isType = ['thread', 'pinned', 'scheduled'].includes(parts[1]);\n    chatId = parts[0];\n    type = isType ? parts[1] : 'thread';\n    threadId = !isType ? parts[1] : undefined;\n  } else if (parts.length >= 3) {\n    [chatId, threadId, type] = parts;\n  }\n  if (!chatId?.match(/^-?\\d+$/)) return undefined;\n\n  const isType = ['thread', 'pinned', 'scheduled'].includes(type!);\n\n  const castedThreadId = (chatId === currentUserId ? threadId : Number(threadId)) || MAIN_THREAD_ID;\n\n  return {\n    chatId,\n    type: type && isType ? (type as MessageListType) : 'thread',\n    threadId: castedThreadId,\n  };\n}\n\nexport const createMessageHashUrl = (chatId: string, type: MessageListType, threadId: ThreadId): string => {\n  const url = new URL(window.location.href);\n  url.hash = createLocationHash(chatId, type, threadId);\n  return url.href;\n};\n\nexport const createAlphaHumanThreadHashUrl = (threadId: string): string => {\n  const url = new URL(window.location.href);\n  url.hash = `at-${threadId}`;\n  return url.href;\n};\n\nexport const updateLocationHash = (hash: string) => {\n  if (IS_MOCKED_CLIENT) return;\n  window.location.hash = hash;\n};\n\nexport function parseInitialLocationHash() {\n  if (parsedInitialLocationHash) return parsedInitialLocationHash;\n\n  if (isAlreadyParsed) return undefined;\n\n  const locationHash = getInitialLocationHash();\n  if (!locationHash) return undefined;\n\n  let parsedHash = locationHash.replace(/^#/, '');\n  if (parsedHash.includes('?')) {\n    [messageHash, parsedHash] = parsedHash.split('?');\n    if (!IS_MOCKED_CLIENT) {\n      window.location.hash = messageHash;\n    }\n  } else if (parsedHash.includes('=')) {\n    if (!IS_MOCKED_CLIENT) {\n      window.location.hash = '';\n    }\n  }\n\n  parsedInitialLocationHash = parsedHash.includes('=') ? parsedHash.split('&').reduce((acc, cur) => {\n    const [key, value] = cur.split('=');\n    acc[key] = value;\n    return acc;\n  }, {} as Record<string, string>) : undefined;\n  isAlreadyParsed = true;\n  if (!parsedInitialLocationHash) {\n    messageHash = parsedHash;\n  }\n\n  return parsedInitialLocationHash;\n}\n\nexport function clearWebTokenAuth() {\n  if (!parsedInitialLocationHash) return;\n\n  delete parsedInitialLocationHash.tgWebAuthToken;\n}\n\nexport function getInitialLocationHash() {\n  return initialLocationHash;\n}\n\nexport interface NotionOAuthCallback {\n  type: 'success' | 'error';\n  workspace?: string;\n  error?: string;\n}\n\nexport function isNotionOAuthCallback(): boolean {\n  // Use the already parsed messageHash instead of window.location.hash\n  // which might have been cleared by the routing system\n  return messageHash === 'auth/notion/success' || messageHash === 'auth/notion/error';\n}\n\nexport function parseNotionOAuthCallback(): NotionOAuthCallback | undefined {\n  if (!messageHash) {\n    return undefined;\n  }\n\n  if (messageHash === 'auth/notion/success') {\n    const workspace = parsedInitialLocationHash?.workspace;\n    return {\n      type: 'success',\n      workspace: workspace ? decodeURIComponent(workspace) : undefined,\n    };\n  }\n\n  if (messageHash === 'auth/notion/error') {\n    const error = parsedInitialLocationHash?.error;\n    return {\n      type: 'error',\n      error: error ? decodeURIComponent(error) : 'Unknown error occurred',\n    };\n  }\n\n  return undefined;\n}\n\nexport interface GoogleOAuthCallback {\n  type: 'success' | 'error';\n  error?: string;\n}\n\nexport function isGoogleOAuthCallback(): boolean {\n  // Use the already parsed messageHash instead of window.location.hash\n  // which might have been cleared by the routing system\n  return messageHash === 'auth/google/success' || messageHash === 'auth/google/error';\n}\n\nexport function parseGoogleOAuthCallback(): GoogleOAuthCallback | undefined {\n  if (!messageHash) {\n    return undefined;\n  }\n\n  if (messageHash === 'auth/google/success') {\n    return {\n      type: 'success',\n    };\n  }\n\n  if (messageHash === 'auth/google/error') {\n    const error = parsedInitialLocationHash?.error;\n    return {\n      type: 'error',\n      error: error ? decodeURIComponent(error) : 'Unknown error occurred',\n    };\n  }\n\n  return undefined;\n}\n","import safeExec from '../../util/safeExec';\nimport { fastRaf, throttleWith } from '../../util/schedulers';\nimport { setPhase } from './stricterdom';\n\nlet pendingMeasureTasks: NoneToVoidFunction[] = [];\nlet pendingMutationTasks: NoneToVoidFunction[] = [];\nlet pendingForceReflowTasks: (() => NoneToVoidFunction | void)[] = [];\n\nconst runUpdatePassOnRaf = throttleWithRafFallback(() => {\n  const currentMeasureTasks = pendingMeasureTasks;\n  pendingMeasureTasks = [];\n  currentMeasureTasks.forEach((task) => {\n    safeExec(task);\n  });\n\n  // We use promises to provide correct order for Mutation Observer callback microtasks\n  void Promise.resolve()\n    .then(() => {\n      setPhase('mutate');\n\n      const currentMutationTasks = pendingMutationTasks;\n      pendingMutationTasks = [];\n\n      currentMutationTasks.forEach((task) => {\n        safeExec(task);\n      });\n    })\n    .then(() => {\n      setPhase('measure');\n\n      const pendingForceReflowMutationTasks: NoneToVoidFunction[] = [];\n      // Will include tasks created during the loop\n      for (const task of pendingForceReflowTasks) {\n        safeExec(() => {\n          const mutationTask = task();\n          if (mutationTask) {\n            pendingForceReflowMutationTasks.push(mutationTask);\n          }\n        });\n      }\n      pendingForceReflowTasks = [];\n\n      return pendingForceReflowMutationTasks;\n    })\n    .then((pendingForceReflowMutationTasks) => {\n      setPhase('mutate');\n\n      // Will include tasks created during the loop\n      for (const task of pendingForceReflowMutationTasks) {\n        safeExec(task);\n      }\n    })\n    .then(() => {\n      setPhase('measure');\n    });\n});\n\nexport function requestMeasure(cb: NoneToVoidFunction) {\n  pendingMeasureTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nexport function requestMutation(cb: NoneToVoidFunction) {\n  pendingMutationTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nexport function requestNextMutation(cb: () => (NoneToVoidFunction | void)) {\n  requestMeasure(() => {\n    requestMutation(cb);\n  });\n}\n\nexport function requestForcedReflow(cb: () => (NoneToVoidFunction | void)) {\n  pendingForceReflowTasks.push(cb);\n  runUpdatePassOnRaf();\n}\n\nfunction throttleWithRafFallback<F extends AnyToVoidFunction>(fn: F) {\n  return throttleWith((throttledFn: NoneToVoidFunction) => {\n    fastRaf(throttledFn, true);\n  }, fn);\n}\n\nexport * from './stricterdom';\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","import type { ElementRef, FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { memo, useEffect, useMemo } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport { selectCanAnimateInterface } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { throttleWithTickEnd } from '../../util/schedulers';\n\nimport useForceUpdate from '../../hooks/useForceUpdate';\nimport useLang from '../../hooks/useLang';\nimport usePreviousDeprecated from '../../hooks/usePreviousDeprecated';\n\nimport styles from './AnimatedCounter.module.scss';\n\ntype OwnProps = {\n  text: string;\n  className?: string;\n  isDisabled?: boolean;\n  ref?: ElementRef<HTMLSpanElement>;\n};\n\nconst ANIMATION_TIME = 200;\nconst MAX_SIMULTANEOUS_ANIMATIONS = 10;\n\nlet scheduledAnimationsCounter = 0;\n\nconst resetCounterOnTickEnd = throttleWithTickEnd(() => {\n  scheduledAnimationsCounter = 0;\n});\n\nconst AnimatedCounter: FC<OwnProps> = ({\n  text,\n  className,\n  isDisabled,\n  ref,\n}) => {\n  const { isRtl } = useLang();\n\n  const prevText = usePreviousDeprecated(text);\n  const forceUpdate = useForceUpdate();\n\n  const shouldAnimate = scheduleAnimation(\n    !isDisabled && selectCanAnimateInterface(getGlobal()) && prevText !== undefined && prevText !== text,\n  );\n\n  const characters = useMemo(() => {\n    return shouldAnimate ? renderAnimatedCharacters(text, prevText) : text;\n  }, [shouldAnimate, prevText, text]);\n\n  useEffect(() => {\n    if (!shouldAnimate) return undefined;\n\n    const timeoutId = window.setTimeout(() => {\n      forceUpdate();\n    }, ANIMATION_TIME);\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [shouldAnimate, text]);\n\n  return (\n    <span ref={ref} className={buildClassName(className, !isDisabled && styles.root)} dir={isRtl ? 'rtl' : undefined}>\n      {characters}\n    </span>\n  );\n};\n\nexport default memo(AnimatedCounter);\n\nfunction scheduleAnimation(condition: boolean) {\n  if (!condition || scheduledAnimationsCounter >= MAX_SIMULTANEOUS_ANIMATIONS) return false;\n\n  if (scheduledAnimationsCounter === 0) {\n    resetCounterOnTickEnd();\n  }\n\n  scheduledAnimationsCounter++;\n\n  return true;\n}\n\nfunction renderAnimatedCharacters(text: string, prevText?: string) {\n  const elements: React.ReactNode[] = [];\n  const textLength = text.length;\n  const prevTextLength = prevText?.length ?? 0;\n\n  for (let i = 0; i <= textLength; i++) {\n    const charIndex = textLength - i;\n    const prevTextCharIndex = prevTextLength - i;\n\n    if (prevText && prevTextCharIndex >= 0 && text[charIndex] !== prevText[prevTextCharIndex]) {\n      elements.unshift(\n        <div className={styles.characterContainer}>\n          <div className={styles.character}>{text[charIndex] ?? ''}</div>\n          <div className={styles.characterOld}>{prevText[prevTextCharIndex]}</div>\n          <div className={styles.characterNew}>{text[charIndex] ?? ''}</div>\n        </div>,\n      );\n    } else {\n      elements.unshift(<span>{text[charIndex] ?? ''}</span>);\n    }\n  }\n\n  return elements;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"tgKbsVmz\",\"character-container\":\"IYTzbS8o\",\"characterContainer\":\"IYTzbS8o\",\"character\":\"Jw1oQFdk\",\"character-old\":\"TZfEz3sc\",\"characterOld\":\"TZfEz3sc\",\"character-disappear\":\"ORlhAlOv\",\"characterDisappear\":\"ORlhAlOv\",\"character-new\":\"Y9ied8_t\",\"characterNew\":\"Y9ied8_t\",\"character-appear\":\"s_g6bwRZ\",\"characterAppear\":\"s_g6bwRZ\"};","import {\n  beginHeavyAnimation,\n  useEffect,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { AnimationLevel } from '../../types';\nimport type { VTTypes } from '../../util/animations/viewTransitionTypes';\n\nimport { ANIMATION_LEVEL_MED, VT_CLASS_NAME, VT_TYPE_CLASS_PREFIX } from '../../config';\nimport { requestMutation, requestNextMutation } from '../../lib/fasterdom/fasterdom';\nimport { selectSharedSettings } from '../../global/selectors/sharedState';\nimport { IS_VIEW_TRANSITION_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport Deferred from '../../util/Deferred';\n\ntype TransitionFunction = () => Promise<void> | void;\n\ntype TransitionState = 'idle' | 'capturing-old' | 'capturing-new' | 'animating' | 'skipped';\ninterface ViewTransitionController {\n  transitionState: TransitionState;\n  startViewTransition: (\n    types: VTTypes, domUpdateCallback?: TransitionFunction, minimumAnimationLevel?: AnimationLevel,\n  ) => PromiseLike<void> | void;\n}\n\ntype ViewTransitionParameters = {\n  domUpdateCallback?: TransitionFunction;\n  types?: VTTypes;\n};\n\nconst SKIP_TIMEOUT = 1000;\n\nlet hasActiveTransition = false;\nexport function hasActiveViewTransition(): boolean {\n  return hasActiveTransition;\n}\n\nexport function useViewTransition(): ViewTransitionController {\n  const parameters = useRef<ViewTransitionParameters>();\n  const [transitionState, setTransitionState] = useState<TransitionState>('idle');\n\n  useEffect(() => {\n    if (transitionState !== 'capturing-old') return;\n    const { domUpdateCallback, types } = parameters.current || {};\n\n    const onHeavyAnimationEnd = beginHeavyAnimation();\n    const transition = document.startViewTransition(async () => {\n      setTransitionState('capturing-new');\n      if (domUpdateCallback) {\n        await domUpdateCallback();\n      }\n      const deferred = new Deferred<void>();\n      requestNextMutation(() => {\n        deferred.resolve();\n      });\n      return deferred.promise;\n    });\n\n    types?.getTypes().forEach((type) => {\n      transition.types?.add(type);\n    });\n\n    transition.finished.then(() => {\n      onHeavyAnimationEnd();\n      setTransitionState('idle');\n      requestMutation(() => {\n        cleanUp(types);\n      });\n\n      hasActiveTransition = false;\n    });\n\n    let isReady = false;\n\n    transition.ready.then(() => {\n      isReady = true;\n      setTransitionState('animating');\n    }).catch((e: unknown) => {\n      // eslint-disable-next-line no-console\n      console.error('View transition error', e, types?.getTypes());\n      setTransitionState('skipped');\n      requestMutation(() => {\n        cleanUp(types);\n      });\n\n      hasActiveTransition = false;\n    });\n\n    setTimeout(() => {\n      if (!isReady) { // Skip transition if it's not prepared in time\n        transition.skipTransition();\n      }\n    }, SKIP_TIMEOUT);\n  }, [transitionState]);\n\n  function startViewTransition(\n    types: VTTypes,\n    updateCallback?: TransitionFunction,\n    minimumAnimationLevel: AnimationLevel = ANIMATION_LEVEL_MED,\n  ): PromiseLike<void> | void {\n    const global = getGlobal();\n    const { animationLevel } = selectSharedSettings(global);\n    // Fallback: simply run the callback immediately if view transitions aren't supported.\n    if (!IS_VIEW_TRANSITION_SUPPORTED || animationLevel < minimumAnimationLevel) {\n      updateCallback?.();\n      return;\n    }\n\n    if (hasActiveTransition) {\n      // eslint-disable-next-line no-console\n      console.warn('VT skipped because another transition is already active', types.getTypes());\n      updateCallback?.();\n      return;\n    }\n\n    parameters.current = {\n      domUpdateCallback: updateCallback,\n      types,\n    };\n    setTransitionState('capturing-old');\n    requestMutation(() => {\n      document.documentElement.classList.add(VT_CLASS_NAME);\n      types.getTypes().forEach((type) => {\n        document.documentElement.classList.add(`${VT_TYPE_CLASS_PREFIX}${type}`);\n      });\n    });\n\n    hasActiveTransition = true;\n  }\n\n  return {\n    transitionState,\n    startViewTransition,\n  };\n}\n\nfunction cleanUp(types?: VTTypes) {\n  types?.getTypes().forEach((type) => {\n    document.documentElement.classList.remove(`${VT_TYPE_CLASS_PREFIX}${type}`);\n  });\n  document.documentElement.classList.remove(VT_CLASS_NAME);\n}\n","import type { ApiMessage, ApiMessageSearchType } from '../../api/types';\nimport type {\n  ChatMediaSearchParams,\n  ChatMediaSearchSegment,\n  LoadingState,\n  MiddleSearchParams,\n  MiddleSearchResults,\n  SharedMediaType,\n  ThreadId,\n} from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  areSortedArraysEqual, areSortedArraysIntersecting, omit, unique,\n} from '../../util/iteratees';\nimport { buildChatThreadKey, isMediaLoadableInViewer } from '../helpers';\nimport { selectTabState } from '../selectors';\nimport { selectChatMediaSearch } from '../selectors/middleSearch';\nimport { updateTabState } from './tabs';\n\ninterface SharedMediaSearchParams {\n  currentType?: SharedMediaType;\n  resultsByType?: Partial<Record<SharedMediaType, {\n    totalCount?: number;\n    nextOffsetId: number;\n    foundIds: number[];\n  }>>;\n}\n\nfunction replaceMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatThreadKey: string,\n  searchParams?: MiddleSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const current = selectTabState(global, tabId).middleSearch.byChatThreadKey;\n  if (!searchParams) {\n    return updateTabState(global, {\n      middleSearch: {\n        byChatThreadKey: omit(current, [chatThreadKey]),\n      },\n    }, tabId);\n  }\n\n  const { type = 'chat', ...rest } = searchParams;\n  return updateTabState(global, {\n    middleSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).middleSearch.byChatThreadKey,\n        [chatThreadKey]: {\n          type,\n          ...rest,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  update: Partial<MiddleSearchParams>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const currentSearch = selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey];\n\n  const updated = {\n    type: 'chat',\n    ...currentSearch,\n    ...update,\n  } satisfies MiddleSearchParams;\n\n  if (!updated.isHashtag) {\n    updated.type = 'chat';\n  }\n\n  if (currentSearch && (currentSearch.type !== updated.type || currentSearch.savedTag !== updated.savedTag)) {\n    updated.results = undefined;\n  }\n\n  return replaceMiddleSearch(global, chatThreadKey, updated, tabId);\n}\n\nexport function resetMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return replaceMiddleSearch(global, buildChatThreadKey(chatId, threadId), {\n    type: 'chat',\n  }, tabId);\n}\n\nfunction replaceMiddleSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  results: MiddleSearchResults,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateMiddleSearch(global, chatId, threadId, {\n    results,\n    fetchingQuery: undefined,\n  }, tabId);\n}\n\nexport function updateMiddleSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  update: MiddleSearchResults,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const { results } = selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey] || {};\n  const prevQuery = (results?.query) || '';\n  if (update.query !== prevQuery) {\n    return replaceMiddleSearchResults(global, chatId, threadId, update, tabId);\n  }\n\n  const prevFoundIds = (results?.foundIds) || [];\n  const {\n    query, foundIds: newFoundIds, totalCount, nextOffsetId, nextOffsetPeerId, nextOffsetRate,\n  } = update;\n  const foundIds = unique(Array.prototype.concat(prevFoundIds, newFoundIds));\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  return replaceMiddleSearchResults(\n    global, chatId, threadId, {\n      query,\n      foundIds: foundOrPrevFoundIds,\n      totalCount,\n      nextOffsetId,\n      nextOffsetRate,\n      nextOffsetPeerId,\n    }, tabId,\n  );\n}\n\nexport function closeMiddleSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceMiddleSearch(global, chatThreadKey, undefined, tabId);\n}\n\nfunction replaceSharedMediaSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  searchParams: SharedMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return updateTabState(global, {\n    sharedMediaSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey,\n        [chatThreadKey]: searchParams,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateSharedMediaSearchType<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentType: SharedMediaType | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceSharedMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey],\n    currentType,\n  }, tabId);\n}\n\nexport function replaceSharedMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  type: ApiMessageSearchType,\n  foundIds?: number[],\n  totalCount?: number,\n  nextOffsetId?: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceSharedMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey],\n    resultsByType: {\n      ...(selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey] || {}).resultsByType,\n      [type]: {\n        foundIds,\n        totalCount,\n        nextOffsetId,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateSharedMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  type: SharedMediaType,\n  newFoundIds: number[],\n  totalCount?: number,\n  nextOffsetId?: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  const { resultsByType } = selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey] || {};\n  const prevFoundIds = resultsByType?.[type] ? resultsByType[type].foundIds : [];\n  const foundIds = orderFoundIdsByDescending(unique(Array.prototype.concat(prevFoundIds, newFoundIds)));\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  return replaceSharedMediaSearchResults(\n    global,\n    chatId,\n    threadId,\n    type,\n    foundOrPrevFoundIds,\n    totalCount,\n    nextOffsetId,\n    tabId,\n  );\n}\n\nfunction orderFoundIdsByDescending(listedIds: number[]) {\n  return listedIds.sort((a, b) => b - a);\n}\n\nfunction orderFoundIdsByAscending(array: number[]) {\n  return array.sort((a, b) => a - b);\n}\n\nexport function mergeWithChatMediaSearchSegment(\n  foundIds: number[],\n  loadingState: LoadingState,\n  segment?: ChatMediaSearchSegment,\n): ChatMediaSearchSegment {\n  if (!segment) {\n    return {\n      foundIds,\n      loadingState,\n    };\n  }\n  const mergedFoundIds = orderFoundIdsByAscending(unique(Array.prototype.concat(segment.foundIds, foundIds)));\n  if (!areSortedArraysEqual(segment.foundIds, foundIds)) {\n    segment.foundIds = mergedFoundIds;\n  }\n  const mergedLoadingState: LoadingState = {\n    areAllItemsLoadedForwards: loadingState.areAllItemsLoadedForwards\n      || segment.loadingState.areAllItemsLoadedForwards,\n    areAllItemsLoadedBackwards: loadingState.areAllItemsLoadedBackwards\n      || segment.loadingState.areAllItemsLoadedBackwards,\n  };\n  segment.loadingState = mergedLoadingState;\n  return segment;\n}\n\nfunction mergeChatMediaSearchSegments(currentSegment: ChatMediaSearchSegment, segments: ChatMediaSearchSegment[]) {\n  return segments.reduce((acc, segment) => {\n    const hasIntersection = areSortedArraysIntersecting(segment.foundIds, currentSegment.foundIds);\n    if (hasIntersection) {\n      currentSegment = mergeWithChatMediaSearchSegment(\n        currentSegment.foundIds,\n        currentSegment.loadingState,\n        segment,\n      );\n    } else {\n      acc.push(segment);\n    }\n    return acc;\n  }, [] as ChatMediaSearchSegment[]);\n}\n\nexport function updateChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentSegment: ChatMediaSearchSegment,\n  searchParams: ChatMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const segments = mergeChatMediaSearchSegments(currentSegment, searchParams.segments);\n\n  return replaceChatMediaSearchResults(\n    global,\n    chatId,\n    threadId,\n    currentSegment,\n    segments,\n    tabId,\n  );\n}\n\nfunction removeIdFromSegment(id: number, segment: ChatMediaSearchSegment): ChatMediaSearchSegment {\n  const foundIds = segment.foundIds.filter((foundId) => foundId !== id);\n\n  return {\n    ...segment,\n    foundIds,\n  };\n}\n\nfunction removeIdsFromChatMediaSearchParams(\n  id: number,\n  searchParams: ChatMediaSearchParams,\n): ChatMediaSearchParams {\n  const currentSegment = removeIdFromSegment(id, searchParams.currentSegment);\n  const segments = searchParams.segments.map((segment) => removeIdFromSegment(id, segment));\n\n  return {\n    ...searchParams,\n    currentSegment,\n    segments,\n  };\n}\n\nexport function removeIdFromSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  id: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const searchParams = selectChatMediaSearch(global, chatId, threadId, tabId);\n  if (!searchParams) return global;\n\n  const updatedSearchParams = removeIdsFromChatMediaSearchParams(id, searchParams);\n\n  return replaceChatMediaSearch(\n    global,\n    chatId,\n    threadId,\n    updatedSearchParams,\n    tabId,\n  );\n}\n\nfunction resetForwardsLoadingStateInParams(\n  searchParams: ChatMediaSearchParams,\n) {\n  searchParams.currentSegment.loadingState.areAllItemsLoadedForwards = false;\n  searchParams.segments.forEach((segment) => {\n    segment.loadingState.areAllItemsLoadedForwards = false;\n  });\n}\n\nexport function updateChatMediaLoadingState<T extends GlobalState>(\n  global: T,\n  newMessage: ApiMessage,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!isMediaLoadableInViewer(newMessage)) {\n    return global;\n  }\n  const searchParams = selectChatMediaSearch(global, chatId, threadId, tabId);\n  if (!searchParams) return global;\n  resetForwardsLoadingStateInParams(searchParams);\n\n  return replaceChatMediaSearch(\n    global,\n    chatId,\n    threadId,\n    searchParams,\n    tabId,\n  );\n}\n\nexport function initializeChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const loadingState: LoadingState = {\n    areAllItemsLoadedForwards: false,\n    areAllItemsLoadedBackwards: false,\n  };\n  const currentSegment: ChatMediaSearchSegment = {\n    foundIds: [],\n    loadingState,\n  };\n  const segments: ChatMediaSearchSegment[] = [];\n\n  const isLoading = false;\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    currentSegment,\n    segments,\n    isLoading,\n  }, tabId);\n}\n\nexport function setChatMediaSearchLoading<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n  const searchParams = selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n\n  if (!searchParams) {\n    return global;\n  }\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    ...searchParams,\n    isLoading,\n  }, tabId);\n}\n\nexport function replaceChatMediaSearchResults<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  currentSegment: ChatMediaSearchSegment,\n  segments: ChatMediaSearchSegment[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return replaceChatMediaSearch(global, chatId, threadId, {\n    ...selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey],\n    currentSegment,\n    segments,\n  }, tabId);\n}\n\nfunction replaceChatMediaSearch<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  searchParams: ChatMediaSearchParams,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return updateTabState(global, {\n    chatMediaSearch: {\n      byChatThreadKey: {\n        ...selectTabState(global, tabId).chatMediaSearch.byChatThreadKey,\n        [chatThreadKey]: searchParams,\n      },\n    },\n  }, tabId);\n}\n","import type { ApiSticker, ApiStickerSet, ApiVideo } from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { buildCollectionByKey, unique } from '../../util/iteratees';\nimport { selectCustomEmojiForEmoji, selectStickersForEmoji, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateStickerSearch<T extends GlobalState>(\n  global: T,\n  hash: string,\n  resultIds?: string[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    stickerSearch: {\n      ...selectTabState(global, tabId).stickerSearch,\n      hash,\n      resultIds,\n    },\n  }, tabId);\n}\n\nexport function updateStickerSets<T extends GlobalState>(\n  global: T,\n  category: 'added' | 'featured' | 'search',\n  hash: string,\n  sets: ApiStickerSet[],\n): T {\n  const updatedSets = sets.map((stickerSet) => {\n    const existing = global.stickers.setsById[stickerSet.id];\n    if (!existing) {\n      return stickerSet;\n    }\n\n    return {\n      ...existing,\n      ...stickerSet,\n    };\n  });\n\n  const regularSetIds = sets.map((set) => set.id);\n\n  if (category === 'search') {\n    return {\n      ...global,\n      stickers: {\n        ...global.stickers,\n        setsById: {\n          ...global.stickers.setsById,\n          ...buildCollectionByKey(updatedSets, 'id'),\n        },\n      },\n    };\n  }\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      setsById: {\n        ...global.stickers.setsById,\n        ...buildCollectionByKey(updatedSets, 'id'),\n      },\n      [category]: {\n        ...global.stickers[category],\n        hash,\n        setIds: [\n          ...(global.stickers[category].setIds || []),\n          ...regularSetIds,\n        ],\n      },\n    },\n  };\n}\n\nexport function updateCustomEmojiSets<T extends GlobalState>(\n  global: T,\n  hash: string,\n  sets: ApiStickerSet[],\n): T {\n  const updatedSets = sets.map((stickerSet) => {\n    const existing = global.stickers.setsById[stickerSet.id];\n    if (!existing) {\n      return stickerSet;\n    }\n\n    return {\n      ...existing,\n      ...stickerSet,\n    };\n  });\n\n  const customEmojis = sets.map((set) => set.stickers).flat().filter(Boolean);\n  const addedSetIds = sets.map((set) => set.id);\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      setsById: {\n        ...global.stickers.setsById,\n        ...buildCollectionByKey(updatedSets, 'id'),\n      },\n    },\n    customEmojis: {\n      ...global.customEmojis,\n      added: {\n        ...global.customEmojis.added,\n        hash,\n        setIds: [\n          ...(global.customEmojis.added.setIds || []),\n          ...addedSetIds,\n        ],\n      },\n      byId: {\n        ...global.customEmojis.byId,\n        ...buildCollectionByKey(customEmojis, 'id'),\n      },\n    },\n  };\n}\n\nexport function updateStickerSet<T extends GlobalState>(\n  global: T, stickerSetId: string, update: Partial<ApiStickerSet>,\n): T {\n  const currentStickerSet = global.stickers.setsById[stickerSetId] || {};\n  const isCustomEmoji = update.isEmoji || currentStickerSet.isEmoji;\n  const addedSets = (isCustomEmoji ? global.customEmojis.added.setIds : global.stickers.added.setIds) || [];\n  let setIds: string[] = addedSets;\n  if (update.installedDate && !update.isArchived && addedSets && !addedSets.includes(stickerSetId)) {\n    setIds = [stickerSetId, ...setIds];\n  }\n\n  if (!update.installedDate && addedSets?.includes(stickerSetId)) {\n    setIds = setIds.filter((id) => id !== stickerSetId);\n  }\n\n  const customEmojiById = isCustomEmoji && update.stickers && buildCollectionByKey(update.stickers, 'id');\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      added: {\n        ...global.stickers.added,\n        ...(!isCustomEmoji && { setIds }),\n      },\n      setsById: {\n        ...global.stickers.setsById,\n        [stickerSetId]: {\n          ...currentStickerSet,\n          ...update,\n        },\n      },\n    },\n    customEmojis: {\n      ...global.customEmojis,\n      byId: {\n        ...global.customEmojis.byId,\n        ...customEmojiById,\n      },\n      added: {\n        ...global.customEmojis.added,\n        ...(isCustomEmoji && { setIds }),\n      },\n    },\n  };\n}\n\nexport function updateGifSearch<T extends GlobalState>(\n  global: T, isNew: boolean, results: ApiVideo[], nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { results: currentResults } = selectTabState(global, tabId).gifSearch;\n\n  let newResults!: ApiVideo[];\n  if (isNew || !currentResults) {\n    newResults = results;\n  } else {\n    const currentIds = new Set(currentResults.map((gif) => gif.id));\n    newResults = [\n      ...currentResults,\n      ...results.filter((gif) => !currentIds.has(gif.id)),\n    ];\n  }\n\n  return updateTabState(global, {\n    gifSearch: {\n      ...selectTabState(global, tabId).gifSearch,\n      offset: nextOffset,\n      results: newResults,\n    },\n  }, tabId);\n}\n\nexport function replaceAnimatedEmojis<T extends GlobalState>(global: T, stickerSet: ApiStickerSet): T {\n  return {\n    ...global,\n    animatedEmojis: stickerSet,\n  };\n}\n\nexport function updateStickersForEmoji<T extends GlobalState>(\n  global: T, emoji: string, remoteStickers?: ApiSticker[], hash?: string,\n): T {\n  const localStickers = selectStickersForEmoji(global, emoji);\n  const allStickers = [...localStickers, ...(remoteStickers || [])];\n  const uniqueIds = unique(allStickers.map(({ id }) => id));\n  const byId = buildCollectionByKey(allStickers, 'id');\n  const stickers = uniqueIds.map((id) => byId[id]);\n\n  return {\n    ...global,\n    stickers: {\n      ...global.stickers,\n      forEmoji: {\n        emoji,\n        stickers,\n        hash,\n      },\n    },\n  };\n}\n\nexport function updateCustomEmojiForEmoji<T extends GlobalState>(\n  global: T, emoji: string,\n): T {\n  const localStickers = selectCustomEmojiForEmoji(global, emoji);\n  const uniqueIds = unique(localStickers.map(({ id }) => id));\n  const byId = buildCollectionByKey(localStickers, 'id');\n  const stickers = uniqueIds.map((id) => byId[id]);\n\n  return {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      forEmoji: {\n        emoji,\n        stickers,\n      },\n    },\n  };\n}\n\nexport function updateRecentStatusCustomEmojis<T extends GlobalState>(\n  global: T, hash: string, emojis: ApiSticker[],\n): T {\n  return {\n    ...global,\n    customEmojis: {\n      ...global.customEmojis,\n      statusRecent: {\n        ...global.customEmojis.statusRecent,\n        hash,\n        emojis,\n      },\n    },\n  };\n}\n\nexport function rebuildStickersForEmoji<T extends GlobalState>(global: T): T {\n  if (global.stickers.forEmoji) {\n    const { emoji, stickers, hash } = global.stickers.forEmoji;\n    if (!emoji) {\n      return global;\n    }\n\n    return updateStickersForEmoji(global, emoji, stickers, hash);\n  }\n\n  if (global.customEmojis.forEmoji) {\n    const { emoji } = global.customEmojis.forEmoji;\n    if (!emoji) {\n      return global;\n    }\n\n    return updateCustomEmojiForEmoji(global, emoji);\n  }\n\n  return global;\n}\n","import type {\n  ApiMissingInvitedUser,\n  ApiSavedStarGift,\n  ApiStarGiftCollection,\n  ApiUser,\n  ApiUserCommonChats,\n  ApiUserFullInfo,\n  ApiUserStatus,\n} from '../../api/types';\nimport type { BotAppPermissions } from '../../types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { omit, omitUndefined, unique } from '../../util/iteratees';\nimport { MEMO_EMPTY_ARRAY } from '../../util/memo';\nimport { getSavedGiftKey } from '../helpers/stars';\nimport { selectActiveGiftsCollectionId } from '../selectors';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function replaceUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      byId: newById,\n    },\n  };\n}\n\nfunction updateContactList<T extends GlobalState>(global: T, updatedUsers: ApiUser[]): T {\n  const { userIds: contactUserIds } = global.contactList || {};\n\n  if (!contactUserIds) return global;\n\n  const contactUserIdsFromUpdate = updatedUsers\n    .filter((user) => user?.isContact)\n    .map((user) => user.id);\n\n  if (contactUserIdsFromUpdate.length === 0) return global;\n\n  return {\n    ...global,\n    contactList: {\n      userIds: unique([\n        ...contactUserIdsFromUpdate,\n        ...contactUserIds,\n      ]),\n    },\n  };\n}\n\nexport function updateUser<T extends GlobalState>(global: T, userId: string, userUpdate: Partial<ApiUser>): T {\n  const { byId } = global.users;\n\n  const updatedUser = getUpdatedUser(global, userId, userUpdate);\n  if (!updatedUser) {\n    return global;\n  }\n\n  global = updateContactList(global, [updatedUser]);\n\n  return replaceUsers(global, {\n    ...byId,\n    [userId]: updatedUser,\n  });\n}\n\nexport function updateUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  const updatedById = Object.keys(newById).reduce((acc: Record<string, ApiUser>, id) => {\n    const updatedUser = getUpdatedUser(global, id, newById[id]);\n    if (updatedUser) {\n      acc[id] = updatedUser;\n    }\n\n    return acc;\n  }, {});\n\n  global = replaceUsers(global, {\n    ...global.users.byId,\n    ...updatedById,\n  });\n\n  global = updateContactList(global, Object.values(updatedById));\n\n  return global;\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addUsers<T extends GlobalState>(global: T, newById: Record<string, ApiUser>): T {\n  const { byId } = global.users;\n  let isUpdated = false;\n\n  const addedById = Object.keys(newById).reduce<Record<string, ApiUser>>((acc, id) => {\n    const existingUser = byId[id];\n    const newUser = newById[id];\n\n    if (existingUser && !existingUser.isMin && (newUser.isMin || existingUser.accessHash === newUser.accessHash)) {\n      return acc;\n    }\n\n    const updatedUser = getUpdatedUser(global, id, newUser);\n    if (updatedUser) {\n      acc[id] = updatedUser;\n      if (!isUpdated) {\n        isUpdated = true;\n      }\n    }\n\n    return acc;\n  }, {});\n\n  if (!isUpdated) {\n    return global;\n  }\n\n  global = replaceUsers(global, {\n    ...byId,\n    ...addedById,\n  });\n\n  global = updateContactList(global, Object.values(addedById));\n\n  return global;\n}\n\n// @optimization Don't spread/unspread global for each element, do it in a batch\nfunction getUpdatedUser(global: GlobalState, userId: string, userUpdate: Partial<ApiUser>) {\n  const { byId } = global.users;\n  const user = byId[userId];\n  const omitProps: (keyof ApiUser)[] = [];\n\n  if (userUpdate.isMin && user && !user.isMin) {\n    return undefined; // Do not apply updates from min constructor\n  }\n\n  if (areDeepEqual(user?.usernames, userUpdate.usernames)) {\n    omitProps.push('usernames');\n  }\n\n  const updatedUser = {\n    ...user,\n    ...omit(userUpdate, omitProps),\n  } as ApiUser;\n\n  if (!updatedUser.id || !updatedUser.type) {\n    return undefined;\n  }\n\n  return omitUndefined(updatedUser);\n}\n\nexport function deleteContact<T extends GlobalState>(global: T, userId: string): T {\n  const { byId } = global.users;\n  const { userIds } = global.contactList || {};\n\n  global = {\n    ...global,\n    contactList: {\n      userIds: userIds ? userIds.filter((id) => id !== userId) : MEMO_EMPTY_ARRAY,\n    },\n  };\n\n  global = replaceUsers(global, {\n    ...byId,\n    [userId]: {\n      ...byId[userId],\n      isContact: undefined,\n    },\n  });\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      orderedPeerIds: {\n        active: global.stories.orderedPeerIds.active.filter((id) => id !== userId),\n        archived: global.stories.orderedPeerIds.archived.filter((id) => id !== userId),\n      },\n    },\n  };\n\n  return updateUserFullInfo(global, userId, {\n    settings: undefined,\n  });\n}\n\nexport function updateUserSearch<T extends GlobalState>(\n  global: T,\n  searchStatePartial: Partial<TabState['userSearch']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    userSearch: {\n      ...selectTabState(global, tabId).userSearch,\n      ...searchStatePartial,\n    },\n  }, tabId);\n}\n\nexport function updateUserSearchFetchingStatus<T extends GlobalState>(\n  global: T, newState: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateUserSearch(global, {\n    fetchingStatus: newState,\n  }, tabId);\n}\n\nexport function updateUserBlockedState<T extends GlobalState>(global: T, userId: string, isBlocked: boolean): T {\n  const { fullInfoById } = global.users;\n  const fullInfo = fullInfoById[userId];\n  if (!fullInfo) {\n    return global;\n  }\n\n  return updateUserFullInfo(global, userId, { isBlocked });\n}\n\nexport function replaceUserStatuses<T extends GlobalState>(global: T, newById: Record<string, ApiUserStatus>): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      statusesById: newById,\n    },\n  };\n}\n\nexport function updateUserFullInfo<T extends GlobalState>(\n  global: T, userId: string, fullInfo: Partial<ApiUserFullInfo>,\n): T {\n  const userFullInfo = global.users.fullInfoById[userId];\n\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      fullInfoById: {\n        ...global.users.fullInfoById,\n        [userId]: {\n          ...userFullInfo,\n          ...fullInfo,\n        },\n      },\n    },\n  };\n}\n\nexport function updateUserCommonChats<T extends GlobalState>(\n  global: T, userId: string, commonChats: ApiUserCommonChats,\n): T {\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      commonChatsById: {\n        ...global.users.commonChatsById,\n        [userId]: commonChats,\n      },\n    },\n  };\n}\n\n// @optimization Allows to avoid redundant updates which cause a lot of renders\nexport function addUserStatuses<T extends GlobalState>(global: T, newById: Record<string, ApiUserStatus>): T {\n  const { statusesById } = global.users;\n\n  global = replaceUserStatuses(global, {\n    ...statusesById,\n    ...newById,\n  });\n\n  return global;\n}\n\nexport function closeNewContactDialog<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    newContact: undefined,\n  }, tabId);\n}\n\nexport function updateMissingInvitedUsers<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  missingUsers: ApiMissingInvitedUser[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!missingUsers.length) {\n    return updateTabState(global, {\n      inviteViaLinkModal: undefined,\n    }, tabId);\n  }\n\n  return updateTabState(global, {\n    inviteViaLinkModal: {\n      missingUsers,\n      chatId,\n    },\n  }, tabId);\n}\n\nexport function updateBotAppPermissions<T extends GlobalState>(\n  global: T,\n  botId: string,\n  permissions: BotAppPermissions,\n): T {\n  const { botAppPermissionsById } = global.users;\n\n  return {\n    ...global,\n    users: {\n      ...global.users,\n      botAppPermissionsById: {\n        ...botAppPermissionsById,\n        [botId]: {\n          ...botAppPermissionsById[botId],\n          ...permissions,\n        },\n      },\n    },\n  };\n}\n\nexport function replacePeerSavedGifts<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  gifts: ApiSavedStarGift[],\n  nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n\n  // Some non-unique gifts can be entirely identical and break `key`\n  const keyCounts = new Map<string, number>();\n  gifts.forEach((gift) => {\n    const id = getSavedGiftKey(gift, true);\n    const count = keyCounts.get(id) || 0;\n    if (count > 0) {\n      gift.localTag = count;\n    }\n    keyCounts.set(id, count + 1);\n  });\n\n  const activeCollectionId = selectActiveGiftsCollectionId(global, peerId, tabId);\n\n  return updateTabState(global, {\n    savedGifts: {\n      ...tabState.savedGifts,\n      collectionsByPeerId: {\n        ...tabState.savedGifts.collectionsByPeerId,\n        [peerId]: {\n          ...tabState.savedGifts.collectionsByPeerId[peerId],\n          [activeCollectionId]: {\n            gifts,\n            nextOffset,\n          },\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updatePeerStarGiftCollections<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  collections: ApiStarGiftCollection[],\n): T {\n  return {\n    ...global,\n    starGiftCollections: {\n      ...global.starGiftCollections,\n      byPeerId: {\n        ...global.starGiftCollections?.byPeerId,\n        [peerId]: collections,\n      },\n    },\n  };\n}\n","import type { ApiGlobalMessageSearchType, ApiMessage, ApiSearchPostsFlood } from '../../api/types';\nimport type { GlobalSearchContent } from '../../types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { areSortedArraysEqual } from '../../util/iteratees';\nimport { getSearchResultKey } from '../../util/keys/searchResultKey';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateGlobalSearch<T extends GlobalState>(\n  global: T,\n  searchStatePartial: Partial<TabState['globalSearch']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    globalSearch: {\n      ...selectTabState(global, tabId).globalSearch,\n      ...searchStatePartial,\n    },\n  }, tabId);\n}\n\nexport function updateGlobalSearchContent<T extends GlobalState>(\n  global: T,\n  currentContent: GlobalSearchContent | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateGlobalSearch(global, { currentContent }, tabId);\n}\n\nexport function updateGlobalSearchResults<T extends GlobalState>(\n  global: T,\n  newFoundMessages: ApiMessage[],\n  totalCount: number,\n  type: ApiGlobalMessageSearchType,\n  nextOffsetRate?: number,\n  nextOffsetId?: number,\n  nextOffsetPeerId?: string,\n  searchFlood?: ApiSearchPostsFlood,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { resultsByType } = selectTabState(global, tabId).globalSearch || {};\n  const newFoundMessagesById = newFoundMessages.reduce((result, message) => {\n    result[getSearchResultKey(message)] = message;\n\n    return result;\n  }, {} as Record<string, ApiMessage>);\n  const foundIdsForType = resultsByType?.[type]?.foundIds;\n\n  if (foundIdsForType !== undefined\n    && Object.keys(newFoundMessagesById).every(\n      (newId) => foundIdsForType.includes(getSearchResultKey(newFoundMessagesById[newId])),\n    )\n  ) {\n    global = updateGlobalSearchFetchingStatus(global, {\n      messages: false,\n      publicPosts: false,\n    }, tabId);\n    return updateGlobalSearch(global, {\n      searchFlood,\n      resultsByType: {\n        ...(selectTabState(global, tabId).globalSearch || {}).resultsByType,\n        [type]: {\n          foundIds: foundIdsForType,\n          totalCount,\n          nextOffsetId,\n          nextOffsetRate,\n          nextOffsetPeerId,\n        },\n      },\n    }, tabId);\n  }\n\n  const prevFoundIds = foundIdsForType || [];\n  const newFoundIds = newFoundMessages\n    .map((message) => getSearchResultKey(message))\n    .filter((id) => !prevFoundIds.includes(id));\n  const foundIds = Array.prototype.concat(prevFoundIds, newFoundIds);\n  const foundOrPrevFoundIds = areSortedArraysEqual(prevFoundIds, foundIds) ? prevFoundIds : foundIds;\n\n  global = updateGlobalSearchFetchingStatus(global, {\n    messages: false,\n    publicPosts: false,\n  }, tabId);\n\n  return updateGlobalSearch(global, {\n    searchFlood,\n    resultsByType: {\n      ...(selectTabState(global, tabId).globalSearch || {}).resultsByType,\n      [type]: {\n        totalCount,\n        nextOffsetId,\n        nextOffsetRate,\n        nextOffsetPeerId,\n        foundIds: foundOrPrevFoundIds,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateGlobalSearchFetchingStatus<T extends GlobalState>(\n  global: T, newState: { chats?: boolean; messages?: boolean; botApps?: boolean; publicPosts?: boolean },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateGlobalSearch(global, {\n    fetchingStatus: {\n      ...selectTabState(global, tabId).globalSearch.fetchingStatus,\n      ...newState,\n    },\n  }, tabId);\n}\n","import type { ManagementProgress, ManagementState } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateManagementProgress<T extends GlobalState>(\n  global: T, progress: ManagementProgress,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    management: {\n      ...selectTabState(global, tabId).management,\n      progress,\n    },\n  }, tabId);\n}\n\nexport function updateManagement<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<ManagementState>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { management } = selectTabState(global, tabId);\n  return updateTabState(global, {\n    management: {\n      ...management,\n      byChatId: {\n        ...management.byChatId,\n        [chatId]: {\n          ...(management.byChatId[chatId] || {}),\n          ...update,\n        },\n      },\n    },\n  }, tabId);\n}\n","import type { ApiNotifyPeerType, ApiPeerNotifySettings } from '../../api/types';\nimport type {\n  AccountSettings, IThemeSettings,\n  ThemeKey,\n} from '../../types';\nimport type { GlobalState, SharedState } from '../types';\n\nimport { selectSharedSettings } from '../selectors/sharedState';\nimport { updateSharedState } from './sharedState';\nimport { updateUserBlockedState } from './users';\n\nexport function replaceSettings<T extends GlobalState>(global: T, newSettings?: Partial<AccountSettings>): T {\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      byKey: {\n        ...global.settings.byKey,\n        ...newSettings,\n      },\n    },\n  };\n}\n\nexport function updateSharedSettings<T extends GlobalState>(\n  global: T, newSettings?: Partial<SharedState['settings']>,\n): T {\n  const settings = selectSharedSettings(global);\n  return updateSharedState(global, {\n    settings: {\n      ...settings,\n      ...newSettings,\n    },\n  });\n}\n\nexport function updateThemeSettings<T extends GlobalState>(\n  global: T, theme: ThemeKey, newSettings?: Partial<IThemeSettings>,\n): T {\n  const settings = global.settings;\n  const current = settings.themes[theme];\n\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      themes: {\n        ...settings.themes,\n        [theme]: {\n          ...current,\n          ...newSettings,\n        },\n      },\n    },\n  };\n}\n\nexport function addNotifyExceptions<T extends GlobalState>(\n  global: T, notifyExceptionById: Record<string, ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById: {\n        ...global.chats.notifyExceptionById,\n        ...notifyExceptionById,\n      },\n    },\n  };\n}\n\nexport function replaceNotifyExceptions<T extends GlobalState>(\n  global: T, notifyExceptionById: Record<string, ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById,\n    },\n  };\n}\n\nexport function addNotifyException<T extends GlobalState>(\n  global: T, id: string, notifyException: ApiPeerNotifySettings,\n): T {\n  return {\n    ...global,\n    chats: {\n      ...global.chats,\n      notifyExceptionById: {\n        ...global.chats.notifyExceptionById,\n        [id]: notifyException,\n      },\n    },\n  };\n}\n\nexport function updateNotifyDefaults<T extends GlobalState>(\n  global: T, peerType: ApiNotifyPeerType, settings: Partial<ApiPeerNotifySettings>,\n): T {\n  return {\n    ...global,\n    settings: {\n      ...global.settings,\n      notifyDefaults: {\n        ...global.settings.notifyDefaults,\n        [peerType]: {\n          ...global.settings.notifyDefaults?.[peerType],\n          ...settings,\n        },\n      },\n    },\n  };\n}\n\nexport function addBlockedUser<T extends GlobalState>(global: T, contactId: string): T {\n  global = updateUserBlockedState(global, contactId, true);\n\n  return {\n    ...global,\n    blocked: {\n      ...global.blocked,\n      ids: [contactId, ...global.blocked.ids],\n      totalCount: global.blocked.totalCount + 1,\n    },\n  };\n}\n\nexport function removeBlockedUser<T extends GlobalState>(global: T, contactId: string): T {\n  global = updateUserBlockedState(global, contactId, false);\n\n  return {\n    ...global,\n    blocked: {\n      ...global.blocked,\n      ids: global.blocked.ids.filter((id) => id !== contactId),\n      totalCount: global.blocked.totalCount - 1,\n    },\n  };\n}\n","import type { GlobalState, SharedState } from '../types';\n\nexport function updateSharedState<T extends GlobalState>(\n  global: T, update: Partial<SharedState>,\n): T {\n  return {\n    ...global,\n    sharedState: {\n      ...global.sharedState,\n      ...update,\n    },\n  };\n}\n","import type { GlobalState } from '../types';\n\nexport function updateTwoFaSettings<T extends GlobalState>(\n  global: T,\n  update: GlobalState['twoFaSettings'],\n): T {\n  return {\n    ...global,\n    twoFaSettings: {\n      ...global.twoFaSettings,\n      ...update,\n    },\n  };\n}\n","import type { GlobalState, SharedState, TabState } from '../types';\n\nimport { INITIAL_GLOBAL_STATE, INITIAL_SHARED_STATE, INITIAL_TAB_STATE } from '../initialState';\n\nexport function updatePasscodeSettings<T extends GlobalState>(\n  global: T,\n  update: GlobalState['passcode'],\n): T {\n  return {\n    ...global,\n    passcode: {\n      ...global.passcode,\n      ...update,\n    },\n  };\n}\n\nexport function clearPasscodeSettings<T extends GlobalState>(global: T): T {\n  return {\n    ...global,\n    passcode: {},\n  };\n}\n\nexport function clearGlobalForLockScreen<T extends GlobalState>(global: T, withTabState = true): T {\n  const alphahuman = global.alphahuman ? {\n    jwtToken: undefined,\n    isThreadsSidebarOpen: false,\n    socketState: 'disconnected' as const,\n    lastAgentUpdate: undefined,\n    streamingContent: undefined,\n    isStreaming: false,\n  } : undefined;\n\n  return {\n    ...INITIAL_GLOBAL_STATE,\n    passcode: global.passcode,\n    settings: INITIAL_GLOBAL_STATE.settings,\n    sharedState: clearSharedStateForLockScreen(global.sharedState),\n    ...(alphahuman && { alphahuman }),\n    ...(withTabState && {\n      byTabId: Object.values(global.byTabId).reduce((acc, { id: tabId, isMasterTab }) => {\n        acc[tabId] = { ...INITIAL_TAB_STATE, isMasterTab, id: tabId };\n        return acc;\n      }, {} as Record<number, TabState>),\n    }),\n  } as T;\n}\n\nexport function clearSharedStateForLockScreen(sharedState: SharedState): SharedState {\n  const {\n    theme,\n    shouldUseSystemTheme,\n    animationLevel,\n    language,\n  } = sharedState.settings;\n\n  return {\n    ...INITIAL_SHARED_STATE,\n    settings: {\n      ...INITIAL_SHARED_STATE.settings,\n      theme,\n      shouldUseSystemTheme,\n      animationLevel,\n      language,\n    },\n  };\n}\n","import type {\n  ApiReceiptRegular,\n  ApiReceiptStars,\n  ApiStarsSubscription,\n  ApiStarsTransaction,\n  ApiTypeCurrencyAmount,\n} from '../../api/types';\nimport type {\n  PaymentStep,\n  ShippingOption,\n  StarsSubscriptions,\n  StarsTransactionType,\n} from '../../types';\nimport type {\n  GlobalState, TabArgs, TabState,\n} from '../types';\n\nimport { STARS_CURRENCY_CODE, TON_CURRENCY_CODE } from '../../config';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectStarsPayment, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updatePayment<T extends GlobalState>(\n  global: T, update: Partial<TabState['payment']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    payment: {\n      ...selectTabState(global, tabId).payment,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function updateStarsPayment<T extends GlobalState>(\n  global: T, update: Partial<TabState['starsPayment']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const starPayment = selectStarsPayment(global, tabId);\n  if (!starPayment) {\n    return global;\n  }\n\n  return updateTabState(global, {\n    starsPayment: {\n      ...starPayment,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function updateShippingOptions<T extends GlobalState>(\n  global: T,\n  shippingOptions: ShippingOption[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n\n): T {\n  return updatePayment(global, { shippingOptions }, tabId);\n}\n\nexport function setRequestInfoId<T extends GlobalState>(\n  global: T, id: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { requestId: id }, tabId);\n}\n\nexport function setPaymentStep<T extends GlobalState>(\n  global: T, step: PaymentStep,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { step }, tabId);\n}\n\nexport function setStripeCardInfo<T extends GlobalState>(\n  global: T, cardInfo: { type: string; id: string },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { stripeCredentials: { ...cardInfo } }, tabId);\n}\n\nexport function setSmartGlocalCardInfo<T extends GlobalState>(\n  global: T,\n  cardInfo: { type: string; token: string },\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { smartGlocalCredentials: { ...cardInfo } }, tabId);\n}\n\nexport function setConfirmPaymentUrl<T extends GlobalState>(\n  global: T, url?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updatePayment(global, { confirmPaymentUrl: url }, tabId);\n}\n\nexport function setReceipt<T extends GlobalState>(\n  global: T,\n  receipt?: ApiReceiptRegular,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!receipt) {\n    return updatePayment(global, { receipt: undefined }, tabId);\n  }\n\n  return updatePayment(global, {\n    receipt,\n  }, tabId);\n}\n\nexport function clearPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    payment: {},\n  }, tabId);\n}\n\nexport function clearStarPayment<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    starsPayment: {},\n  }, tabId);\n}\n\nexport function closeInvoice<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  global = updatePayment(global, {\n    isPaymentModalOpen: undefined,\n    isExtendedMedia: undefined,\n  }, tabId);\n  return global;\n}\n\nexport function updateStarsBalance<T extends GlobalState>(\n  global: T, balance: ApiTypeCurrencyAmount,\n): T {\n  if (balance.currency === STARS_CURRENCY_CODE) {\n    return {\n      ...global,\n      stars: {\n        ...global.stars,\n        balance,\n      },\n    };\n  }\n\n  if (balance.currency === TON_CURRENCY_CODE) {\n    return {\n      ...global,\n      ton: {\n        ...global.ton,\n        balance,\n      },\n    };\n  }\n\n  return global;\n}\n\nexport function appendStarsTransactions<T extends GlobalState>(\n  global: T,\n  type: StarsTransactionType,\n  transactions: ApiStarsTransaction[],\n  nextOffset?: string,\n  isTon?: boolean,\n): T {\n  if (isTon) {\n    const history = global.ton?.history;\n    if (!history) {\n      return global;\n    }\n\n    const newTypeObject = {\n      transactions: (history[type]?.transactions || []).concat(transactions),\n      nextOffset,\n    };\n\n    return {\n      ...global,\n      ton: {\n        ...global.ton,\n        history: {\n          ...history,\n          [type]: newTypeObject,\n        },\n      },\n    };\n  }\n\n  const history = global.stars?.history;\n  if (!history) {\n    return global;\n  }\n\n  const newTypeObject = {\n    transactions: (history[type]?.transactions || []).concat(transactions),\n    nextOffset,\n  };\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      history: {\n        ...history,\n        [type]: newTypeObject,\n      },\n    },\n  };\n}\n\nexport function appendStarsSubscriptions<T extends GlobalState>(\n  global: T,\n  subscriptions: ApiStarsSubscription[],\n  nextOffset?: string,\n): T {\n  if (!global.stars) {\n    return global;\n  }\n\n  const newObject = {\n    list: (global.stars.subscriptions?.list || []).concat(subscriptions),\n    nextOffset,\n  } satisfies StarsSubscriptions;\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      subscriptions: newObject,\n    },\n  };\n}\n\nexport function updateStarsSubscriptionLoading<T extends GlobalState>(\n  global: T, isLoading: boolean,\n): T {\n  const subscriptions = global.stars?.subscriptions;\n  if (!subscriptions) {\n    return global;\n  }\n\n  return {\n    ...global,\n    stars: {\n      ...global.stars,\n      subscriptions: {\n        ...subscriptions,\n        isLoading,\n      },\n    },\n  };\n}\n\nexport function openStarsTransactionModal<T extends GlobalState>(\n  global: T, transaction: ApiStarsTransaction, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    starsTransactionModal: {\n      transaction,\n    },\n  }, tabId);\n}\n\nexport function openStarsTransactionFromReceipt<T extends GlobalState>(\n  global: T, receipt: ApiReceiptStars, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const transaction: ApiStarsTransaction = {\n    id: receipt.transactionId,\n    peer: {\n      type: 'peer',\n      id: receipt.botId,\n    },\n    amount: {\n      currency: STARS_CURRENCY_CODE,\n      amount: receipt.totalAmount,\n      nanos: 0,\n    },\n    date: receipt.date,\n    title: receipt.title,\n    description: receipt.description,\n    photo: receipt.photo,\n  };\n\n  return openStarsTransactionModal(global, transaction, tabId);\n}\n","import type {\n  ApiChannelMonetizationStatistics,\n  ApiChannelStatistics, ApiGroupStatistics, ApiPostStatistics, StatisticsGraph,\n} from '../../api/types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateStatistics<T extends GlobalState>(\n  global: T, chatId: string, statistics: ApiChannelStatistics | ApiGroupStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      byChatId: {\n        ...selectTabState(global, tabId).statistics.byChatId,\n        [chatId]: statistics,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateMessageStatistics<T extends GlobalState>(\n  global: T, statistics: ApiPostStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      currentMessage: statistics,\n      currentStory: undefined,\n    },\n  }, tabId);\n}\n\nexport function updateStoryStatistics<T extends GlobalState>(\n  global: T, statistics: ApiPostStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      currentStory: statistics,\n      currentMessage: undefined,\n    },\n  }, tabId);\n}\n\nexport function updateStatisticsGraph<T extends GlobalState>(\n  global: T, chatId: string, name: string, update: StatisticsGraph,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { statistics } = selectTabState(global, tabId);\n  return updateTabState(global, {\n    statistics: {\n      ...statistics,\n      byChatId: {\n        ...statistics.byChatId,\n        [chatId]: {\n          ...(statistics.byChatId[chatId] || {}),\n          [name]: update,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateChannelMonetizationStatistics<T extends GlobalState>(\n  global: T, statistics: ApiChannelMonetizationStatistics,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    statistics: {\n      ...selectTabState(global, tabId).statistics,\n      monetization: statistics,\n    },\n  }, tabId);\n}\n\nexport function updateVerifyMonetizationModal<T extends GlobalState>(\n  global: T, update: Partial<TabState['monetizationVerificationModal']>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  if (!tabState.monetizationVerificationModal) {\n    return global;\n  }\n\n  return updateTabState(global, {\n    monetizationVerificationModal: {\n      ...tabState.monetizationVerificationModal,\n      ...update,\n    },\n  }, tabId);\n}\n","import type {\n  ApiChat, ApiChatFullInfo, ApiPeerPhotos, ApiPhoto, ApiUser, ApiUserFullInfo,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { isUserId } from '../../util/entities/ids';\nimport { omit, uniqueByField } from '../../util/iteratees';\nimport { isChatChannel } from '../helpers';\nimport {\n  selectChatFullInfo,\n  selectPeer,\n  selectPeerPhotos,\n  selectUserFullInfo,\n} from '../selectors';\nimport { updateChat, updateChatFullInfo } from './chats';\nimport { updateUser, updateUserFullInfo } from './users';\n\n// `type` has different types in ApiChat and ApiUser\ntype ApiPeerSharedFields = Omit<CommonProperties<ApiChat, ApiUser>, 'type'>;\ntype ApiPeerFullInfoSharedFields = CommonProperties<ApiChatFullInfo, ApiUserFullInfo>;\n\nexport function updatePeer<T extends GlobalState>(\n  global: T, peerId: string, peerUpdate: Partial<ApiPeerSharedFields>,\n) {\n  if (isUserId(peerId)) {\n    return updateUser(global, peerId, peerUpdate);\n  }\n\n  return updateChat(global, peerId, peerUpdate);\n}\n\nexport function updatePeerFullInfo<T extends GlobalState>(\n  global: T, peerId: string, peerFullInfoUpdate: Partial<ApiPeerFullInfoSharedFields>,\n) {\n  if (isUserId(peerId)) {\n    return updateUserFullInfo(global, peerId, peerFullInfoUpdate);\n  }\n\n  return updateChatFullInfo(global, peerId, peerFullInfoUpdate);\n}\n\nexport function updatePeerPhotosIsLoading<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isLoading: boolean,\n) {\n  const profilePhotos = selectPeerPhotos(global, peerId);\n  if (!profilePhotos) {\n    return global;\n  }\n\n  return replacePeerPhotos(global, peerId, {\n    ...profilePhotos,\n    isLoading,\n  });\n}\n\nexport function replacePeerPhotos<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  value?: ApiPeerPhotos,\n) {\n  if (!value) {\n    return {\n      ...global,\n      peers: {\n        ...global.peers,\n        profilePhotosById: omit(global.peers.profilePhotosById, [peerId]),\n      },\n    };\n  }\n\n  return {\n    ...global,\n    peers: {\n      ...global.peers,\n      profilePhotosById: {\n        ...global.peers.profilePhotosById,\n        [peerId]: value,\n      },\n    },\n  };\n}\n\nexport function updatePeerPhotos<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  update: {\n    newPhotos: ApiPhoto[];\n    count: number;\n    nextOffset?: number;\n    fullInfo: ApiChatFullInfo | ApiUserFullInfo;\n    shouldInvalidateCache?: boolean;\n  },\n) {\n  const profilePhotos = selectPeerPhotos(global, peerId);\n\n  const {\n    newPhotos, count, nextOffset, fullInfo, shouldInvalidateCache,\n  } = update;\n  const currentPhotos = profilePhotos;\n  const profilePhoto = fullInfo.profilePhoto;\n  const fallbackPhoto = 'fallbackPhoto' in fullInfo ? fullInfo.fallbackPhoto : undefined;\n  const personalPhoto = 'personalPhoto' in fullInfo ? fullInfo.personalPhoto : undefined;\n\n  if (!currentPhotos || shouldInvalidateCache) {\n    // In some channels, last service message with photo change is deleted, so we need to patch it in\n    if (profilePhoto && profilePhoto.id !== newPhotos[0]?.id) {\n      newPhotos.unshift(profilePhoto);\n    }\n\n    if (personalPhoto && personalPhoto.id !== newPhotos[0]?.id) {\n      newPhotos.unshift(personalPhoto);\n    }\n\n    if (fallbackPhoto) {\n      newPhotos.push(fallbackPhoto);\n    }\n\n    return replacePeerPhotos(global, peerId, {\n      fallbackPhoto,\n      personalPhoto,\n      photos: newPhotos,\n      count,\n      nextOffset,\n      isLoading: false,\n    });\n  }\n\n  const hasFallbackPhoto = fallbackPhoto && currentPhotos.photos.at(-1)?.id === fallbackPhoto.id;\n  const currentPhotoArray = hasFallbackPhoto ? currentPhotos.photos.slice(0, -1) : currentPhotos.photos;\n\n  const photos = uniqueByField([...currentPhotoArray, ...newPhotos, fallbackPhoto].filter(Boolean), 'id');\n  return replacePeerPhotos(global, peerId, {\n    fallbackPhoto,\n    personalPhoto,\n    photos,\n    count,\n    nextOffset,\n    isLoading: false,\n  });\n}\n\nexport function deletePeerPhoto<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  photoId: string,\n  isFromActionMessage?: boolean,\n) {\n  const peer = selectPeer(global, peerId);\n  const profilePhotos = selectPeerPhotos(global, peerId);\n  if (!peer || !profilePhotos) {\n    return global;\n  }\n  const isChannel = 'title' in peer && isChatChannel(peer);\n\n  const userFullInfo = selectUserFullInfo(global, peerId);\n  const chatFullInfo = selectChatFullInfo(global, peerId);\n\n  const isAvatar = peer.avatarPhotoId === photoId && (!isChannel || isFromActionMessage);\n  const nextAvatarPhoto = isAvatar ? profilePhotos.photos[1] : undefined;\n\n  if (userFullInfo) {\n    const newFallbackPhoto = userFullInfo.fallbackPhoto?.id === photoId ? undefined : userFullInfo.fallbackPhoto;\n    const newPersonalPhoto = userFullInfo.personalPhoto?.id === photoId ? undefined : userFullInfo.personalPhoto;\n    const newProfilePhoto = userFullInfo.profilePhoto?.id === photoId ? nextAvatarPhoto : userFullInfo.profilePhoto;\n    global = updateUserFullInfo(global, peerId, {\n      fallbackPhoto: newFallbackPhoto,\n      personalPhoto: newPersonalPhoto,\n      profilePhoto: newProfilePhoto,\n    });\n  }\n\n  if (chatFullInfo) {\n    const newProfilePhoto = chatFullInfo.profilePhoto?.id === photoId ? nextAvatarPhoto : chatFullInfo.profilePhoto;\n    global = updateChatFullInfo(global, peerId, {\n      profilePhoto: newProfilePhoto,\n    });\n  }\n\n  const avatarPhotoId = isAvatar ? nextAvatarPhoto?.id : peer.avatarPhotoId;\n  const shouldKeepInPhotos = isAvatar && 'title' in peer && isChatChannel(peer);\n  const photos = shouldKeepInPhotos\n    ? profilePhotos.photos.filter((photo) => photo.id !== photoId) : profilePhotos.photos.slice();\n\n  global = updatePeer(global, peerId, {\n    avatarPhotoId,\n  });\n\n  global = replacePeerPhotos(global, peerId, avatarPhotoId ? {\n    ...profilePhotos,\n    photos,\n    count: profilePhotos.count - 1,\n  } : undefined);\n\n  return global;\n}\n","import type {\n  ApiPeerStories,\n  ApiReaction,\n  ApiStealthMode,\n  ApiStory,\n  ApiStoryDeleted,\n  ApiStorySkipped,\n  ApiStoryViews,\n  ApiTypeStory,\n  ApiTypeStoryView,\n} from '../../api/types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { isUserId } from '../../util/entities/ids';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { compareFields, unique } from '../../util/iteratees';\nimport { getServerTime } from '../../util/serverTime';\nimport { updateReactionCount } from '../helpers';\nimport {\n  selectIsChatWithSelf,\n  selectPeer, selectPeerStories, selectPeerStory, selectTabState, selectUser,\n} from '../selectors';\nimport { updatePeer } from './peers';\nimport { updateTabState } from './tabs';\n\nexport function addStories<T extends GlobalState>(global: T, newStoriesByPeerId: Record<string, ApiPeerStories>): T {\n  const updatedByPeerId = Object.entries(newStoriesByPeerId).reduce((acc, [peerId, newPeerStories]) => {\n    if (!acc[peerId]) {\n      acc[peerId] = newPeerStories;\n    } else {\n      acc[peerId].byId = { ...acc[peerId].byId, ...newPeerStories.byId };\n      acc[peerId].orderedIds = unique(newPeerStories.orderedIds.concat(acc[peerId].orderedIds));\n      acc[peerId].profileIds = unique(newPeerStories.profileIds.concat(acc[peerId].profileIds)).sort((a, b) => b - a);\n      acc[peerId].lastUpdatedAt = newPeerStories.lastUpdatedAt;\n      acc[peerId].lastReadId = newPeerStories.lastReadId;\n    }\n\n    return acc;\n  }, global.stories.byPeerId);\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: updatedByPeerId,\n    },\n  };\n\n  return updateOrderedStoriesPeerIds(global, Object.keys(newStoriesByPeerId));\n}\n\nexport function addStoriesForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  newStories: Record<number, ApiTypeStory>,\n  newPinnedIds?: number[],\n  addToArchive?: boolean,\n  albumId?: number,\n): T {\n  const {\n    byId, orderedIds, profileIds, archiveIds, pinnedIds, idsByAlbumId,\n  } = global.stories.byPeerId[peerId] || {};\n  const deletedIds = Object.keys(newStories).filter((id) => 'isDeleted' in newStories[Number(id)]).map(Number);\n  const updatedById = { ...byId, ...newStories };\n  let updatedOrderedIds = [...(orderedIds || [])];\n  let updatedArchiveIds = [...(archiveIds || [])];\n  const updatedProfileIds = unique(\n    [...(profileIds || [])].concat(Object.values(newStories).reduce((ids, story) => {\n      if (('isInProfile' in story && story.isInProfile)) {\n        ids.push(story.id);\n      }\n\n      return ids;\n    }, [] as number[])),\n  ).sort((a, b) => b - a).filter((storyId) => !deletedIds.includes(storyId));\n\n  updatedOrderedIds = unique(Object.entries(newStories).reduce((acc, [storyId, story]) => {\n    if ('expireDate' in story && story.expireDate && story.expireDate > getServerTime()) {\n      acc.push(Number(storyId));\n    }\n\n    return acc;\n  }, updatedOrderedIds)).filter((storyId) => !deletedIds.includes(storyId));\n\n  if (addToArchive && selectIsChatWithSelf(global, peerId)) {\n    updatedArchiveIds = unique(updatedArchiveIds.concat(Object.keys(newStories).map(Number)))\n      .sort((a, b) => b - a)\n      .filter((storyId) => !deletedIds.includes(storyId));\n  }\n\n  const updatedIdsByAlbumId = { ...(idsByAlbumId || {}) };\n  if (albumId !== undefined) {\n    const newAlbumStoryIds = Object.keys(newStories).map(Number)\n      .filter((storyId) => !deletedIds.includes(storyId));\n\n    const existingAlbumData = updatedIdsByAlbumId[albumId];\n    const existingIds = existingAlbumData?.ids || [];\n\n    updatedIdsByAlbumId[albumId] = {\n      ...updatedIdsByAlbumId[albumId],\n      ids: unique([...existingIds, ...newAlbumStoryIds]).sort((a, b) => b - a),\n    };\n  }\n\n  global = {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          byId: updatedById,\n          orderedIds: updatedOrderedIds,\n          profileIds: updatedProfileIds,\n          pinnedIds: pinnedIds || newPinnedIds,\n          ...(addToArchive && { archiveIds: updatedArchiveIds }),\n          ...(albumId !== undefined && { idsByAlbumId: updatedIdsByAlbumId }),\n        },\n      },\n    },\n  };\n\n  if (selectIsChatWithSelf(global, peerId)\n    || selectUser(global, peerId)?.isContact\n    || peerId === global.appConfig.storyChangelogUserId) {\n    global = updatePeerLastUpdatedAt(global, peerId);\n    global = updateOrderedStoriesPeerIds(global, [peerId]);\n  }\n\n  return global;\n}\n\nexport function updateStoriesForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  peerStories: ApiPeerStories,\n): T {\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: peerStories,\n      },\n    },\n  };\n}\n\nexport function updatePeerStoriesFullyLoaded<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  isFullyLoaded: boolean,\n  isArchive?: boolean,\n  albumId?: number,\n): T {\n  const { byPeerId } = global.stories;\n  const peerStories = byPeerId[peerId];\n\n  if (albumId !== undefined && peerStories?.idsByAlbumId?.[albumId]) {\n    return {\n      ...global,\n      stories: {\n        ...global.stories,\n        byPeerId: {\n          ...byPeerId,\n          [peerId]: {\n            ...peerStories,\n            idsByAlbumId: {\n              ...peerStories.idsByAlbumId,\n              [albumId]: {\n                ...peerStories.idsByAlbumId[albumId],\n                isFullyLoaded,\n              },\n            },\n          },\n        },\n      },\n    };\n  }\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          [isArchive ? 'isArchiveFullyLoaded' : 'isFullyLoaded']: isFullyLoaded,\n        },\n      },\n    },\n  };\n}\n\nexport function updateLastReadStoryForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  lastReadId: number,\n): T {\n  const { orderedIds } = selectPeerStories(global, peerId) || {};\n  if (!orderedIds) {\n    return global;\n  }\n\n  if (lastReadId >= orderedIds[orderedIds.length - 1]) {\n    global = updatePeer(global, peerId, {\n      hasUnreadStories: false,\n    });\n  }\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...global.stories.byPeerId[peerId],\n          lastReadId,\n        },\n      },\n    },\n  };\n}\n\nexport function updateLastViewedStoryForPeer<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  lastViewedId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { orderedIds } = selectPeerStories(global, peerId) || {};\n  if (!orderedIds || !orderedIds.includes(lastViewedId)) {\n    return global;\n  }\n\n  const { storyViewer } = selectTabState(global, tabId);\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...storyViewer,\n      lastViewedByPeerId: {\n        ...storyViewer.lastViewedByPeerId,\n        [peerId]: lastViewedId,\n      },\n    },\n  }, tabId);\n}\n\nexport function updatePeersWithStories<T extends GlobalState>(\n  global: T,\n  storiesByPeerId: Record<string, ApiPeerStories>,\n): T {\n  Object.entries(storiesByPeerId).forEach(([peerId, { lastReadId, orderedIds }]) => {\n    const peer = selectPeer(global, peerId);\n    if (!peer) return;\n\n    global = updatePeer(global, peerId, {\n      hasStories: true,\n      hasUnreadStories: !lastReadId\n        || Boolean(lastReadId && lastReadId < (peer.maxStoryId || orderedIds[orderedIds.length - 1])),\n    });\n  });\n\n  return global;\n}\n\nexport function updateStoryViews<T extends GlobalState>(\n  global: T,\n  storyId: number,\n  views: ApiTypeStoryView[],\n  nextOffset?: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const { viewModal } = tabState.storyViewer;\n  const newViews = viewModal?.storyId === storyId && viewModal.views ? [\n    ...viewModal.views,\n    ...views,\n  ] : views;\n\n  global = updateStoryViewsLoading(global, false, tabId);\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...tabState.storyViewer,\n      viewModal: {\n        ...viewModal,\n        storyId,\n        views: newViews,\n        nextOffset,\n        isLoading: false,\n      },\n    },\n  }, tabId);\n}\n\nexport function updateStoryViewsLoading<T extends GlobalState>(\n  global: T,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const { viewModal } = tabState.storyViewer;\n  if (!viewModal) return global;\n\n  return updateTabState(global, {\n    storyViewer: {\n      ...tabState.storyViewer,\n      viewModal: {\n        ...viewModal,\n        isLoading,\n      },\n    },\n  }, tabId);\n}\n\nexport function removePeerStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n): T {\n  const {\n    orderedIds, profileIds, lastReadId, byId,\n  } = selectPeerStories(global, peerId) || { orderedIds: [] as number[], profileIds: [] as number[] };\n\n  const newOrderedIds = orderedIds.filter((id) => id !== storyId);\n  const newProfileIds = profileIds.filter((id) => id !== storyId);\n  const lastStoryId = newOrderedIds.length ? orderedIds[orderedIds.length - 1] : undefined;\n\n  const previousStoryId = orderedIds[orderedIds.indexOf(storyId) - 1];\n  const newLastReadId = lastReadId === storyId ? previousStoryId : lastReadId;\n\n  const newById = {\n    ...byId,\n    [storyId]: { id: storyId, peerId, isDeleted: true } as ApiStoryDeleted,\n  };\n  const lastUpdatedAt = lastStoryId ? (newById[lastStoryId] as ApiStory | undefined)?.date : undefined;\n  const hasStories = Boolean(newOrderedIds.length);\n\n  global = updatePeer(global, peerId, {\n    hasStories,\n    hasUnreadStories: Boolean(hasStories && lastReadId && lastStoryId && lastReadId < lastStoryId),\n  });\n\n  global = updateStoriesForPeer(global, peerId, {\n    byId: newById,\n    orderedIds: newOrderedIds,\n    profileIds: newProfileIds,\n    lastUpdatedAt,\n    lastReadId: newLastReadId,\n  });\n\n  Object.values(global.byTabId).forEach((tab) => {\n    if (tab.storyViewer.lastViewedByPeerId && tab.storyViewer.lastViewedByPeerId[peerId] === storyId) {\n      global = updateLastViewedStoryForPeer(global, peerId, previousStoryId, tab.id);\n    }\n  });\n\n  if (!hasStories) {\n    global = {\n      ...global,\n      stories: {\n        ...global.stories,\n        orderedPeerIds: {\n          active: global.stories.orderedPeerIds.active.filter((id) => id !== peerId),\n          archived: global.stories.orderedPeerIds.archived.filter((id) => id !== peerId),\n        },\n      },\n    };\n  }\n\n  return global;\n}\n\nexport function updateSentStoryReaction<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  reaction: ApiReaction | undefined,\n): T {\n  const story = selectPeerStory(global, peerId, storyId);\n  if (!story || !('content' in story)) return global;\n\n  const { views } = story;\n  const reactionsCount = views?.reactionsCount || 0;\n  const hasReaction = views?.reactions?.some((r) => r.chosenOrder !== undefined);\n  const reactions = updateReactionCount(views?.reactions || [], [reaction].filter(Boolean));\n\n  const countDiff = !reaction ? -1 : hasReaction ? 0 : 1;\n  const newReactionsCount = reactionsCount + countDiff;\n\n  global = updatePeerStory(global, peerId, storyId, {\n    sentReaction: reaction,\n    views: {\n      ...views,\n      reactionsCount: newReactionsCount,\n      reactions,\n    },\n  });\n\n  return global;\n}\n\nexport function updatePeerStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  storyUpdate: Partial<ApiStory>,\n): T {\n  const peerStories = selectPeerStories(global, peerId) || {\n    byId: {}, orderedIds: [], profileIds: [], archiveIds: [],\n  };\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          byId: {\n            ...peerStories.byId,\n            [storyId]: {\n              ...peerStories.byId[storyId],\n              ...storyUpdate,\n            },\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function updatePeerStoryViews<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  viewsUpdate: Partial<ApiStoryViews>,\n): T {\n  const story = selectPeerStory(global, peerId, storyId);\n  if (!story || !('content' in story)) return global;\n\n  const { views } = story;\n\n  return updatePeerStory(global, peerId, storyId, {\n    views: {\n      ...views,\n      ...viewsUpdate,\n    },\n  });\n}\n\nexport function updatePeerProfileStory<T extends GlobalState>(\n  global: T,\n  peerId: string,\n  storyId: number,\n  isInProfile?: boolean,\n): T {\n  const peerStories = selectPeerStories(global, peerId) || {\n    byId: {}, orderedIds: [], profileIds: [], archiveIds: [],\n  };\n\n  const newProfileIds = isInProfile\n    ? unique(peerStories.profileIds.concat(storyId)).sort((a, b) => b - a)\n    : peerStories.profileIds.filter((id) => storyId !== id);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          profileIds: newProfileIds,\n        },\n      },\n    },\n  };\n}\n\nexport function updatePeerStoriesHidden<T extends GlobalState>(global: T, peerId: string, areHidden: boolean) {\n  const peer = selectPeer(global, peerId);\n  if (!peer) return global;\n\n  const currentState = peer.areStoriesHidden;\n  if (currentState === areHidden) return global; // `updateOrderedStoriesPeerIds` is computationally expensive\n\n  global = updatePeer(global, peerId, {\n    areStoriesHidden: areHidden,\n  });\n\n  return updateOrderedStoriesPeerIds(global, [peerId]);\n}\n\nfunction updateOrderedStoriesPeerIds<T extends GlobalState>(global: T, updatePeerIds: string[]): T {\n  const { currentUserId, stories: { byPeerId, orderedPeerIds } } = global;\n\n  const allPeerIds = orderedPeerIds.active.concat(orderedPeerIds.archived).concat(updatePeerIds);\n  const newOrderedPeerIds = allPeerIds.reduce<{ active: string[]; archived: string[] }>((acc, peerId) => {\n    if (!byPeerId[peerId]?.orderedIds?.length) return acc;\n    const peer = selectPeer(global, peerId);\n\n    if (peer?.areStoriesHidden) {\n      acc.archived.push(peerId);\n    } else {\n      acc.active.push(peerId);\n    }\n\n    return acc;\n  }, { active: [], archived: [] });\n\n  function compare(peerIdA: string, peerIdB: string) {\n    const peerA = selectPeer(global, peerIdA)!;\n    const peerB = selectPeer(global, peerIdB)!;\n\n    const diffCurrentUser = compareFields(currentUserId === peerIdA, currentUserId === peerIdB);\n    if (diffCurrentUser) return diffCurrentUser;\n\n    const { lastUpdatedAt: luaA = 0, orderedIds: orderedA, lastReadId: lriA = 0 } = byPeerId[peerIdA] || {};\n    const hasUnreadA = lriA < orderedA?.[orderedA.length - 1];\n    const { lastUpdatedAt: luaB = 0, orderedIds: orderedB, lastReadId: lriB = 0 } = byPeerId[peerIdB] || {};\n    const hasUnreadB = lriB < orderedB?.[orderedB.length - 1];\n\n    const diffUnread = compareFields(hasUnreadA, hasUnreadB);\n    if (diffUnread) return diffUnread;\n\n    const diffPremium = compareFields('isPremium' in peerA, 'isPremium' in peerB);\n    if (diffPremium) return diffPremium;\n\n    const diffType = compareFields(isUserId(peerIdA), isUserId(peerIdB));\n    if (diffType) return diffType;\n\n    return compareFields(luaA, luaB);\n  }\n\n  newOrderedPeerIds.archived = unique(newOrderedPeerIds.archived)\n    .filter((peerId) => byPeerId[peerId]?.orderedIds?.length)\n    .sort(compare);\n  newOrderedPeerIds.active = unique(newOrderedPeerIds.active)\n    .filter((peerId) => byPeerId[peerId]?.orderedIds?.length)\n    .sort(compare);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      orderedPeerIds: newOrderedPeerIds,\n    },\n  };\n}\n\nfunction updatePeerLastUpdatedAt<T extends GlobalState>(global: T, peerId: string): T {\n  const peerStories = global.stories.byPeerId[peerId];\n  const lastUpdatedAt = peerStories.orderedIds.reduce<number | undefined>((acc, storyId) => {\n    const { date } = peerStories.byId[storyId] as ApiStorySkipped || {};\n    if (date && (!acc || acc < date)) {\n      acc = date;\n    }\n\n    return acc;\n  }, undefined);\n\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      byPeerId: {\n        ...global.stories.byPeerId,\n        [peerId]: {\n          ...peerStories,\n          lastUpdatedAt,\n        },\n      },\n    },\n  };\n}\n\nexport function updateStealthMode<T extends GlobalState>(\n  global: T,\n  stealthMode: ApiStealthMode,\n): T {\n  return {\n    ...global,\n    stories: {\n      ...global.stories,\n      stealthMode,\n    },\n  };\n}\n","import type { ApiTopic } from '../../api/types';\nimport type { TopicsInfo } from '../../types';\nimport type { GlobalState } from '../types';\n\nimport { buildCollectionByKey, omit, unique } from '../../util/iteratees';\nimport {\n  selectChat, selectTopic, selectTopics,\n  selectTopicsInfo,\n} from '../selectors';\nimport { updateThread, updateThreadInfo } from './messages';\n\nfunction updateTopicsStore<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<TopicsInfo>,\n) {\n  const info = global.chats.topicsInfoById[chatId] || {};\n\n  global = {\n    ...global,\n    chats: {\n      ...global.chats,\n      topicsInfoById: {\n        ...global.chats.topicsInfoById,\n        [chatId]: {\n          ...info,\n          ...update,\n        },\n      },\n    },\n  };\n\n  return global;\n}\n\nexport function updateListedTopicIds<T extends GlobalState>(\n  global: T, chatId: string, topicIds: number[],\n): T {\n  const listedIds = selectTopicsInfo(global, chatId)?.listedTopicIds || [];\n  return updateTopicsStore(global, chatId, {\n    listedTopicIds: unique([\n      ...listedIds,\n      ...topicIds,\n    ]),\n  });\n}\n\nexport function updateTopics<T extends GlobalState>(\n  global: T, chatId: string, topicsCount: number, topics: ApiTopic[],\n): T {\n  const oldTopics = selectTopics(global, chatId);\n  const newTopics = buildCollectionByKey(topics, 'id');\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: {\n      ...oldTopics,\n      ...newTopics,\n    },\n    totalCount: topicsCount,\n  });\n\n  topics.forEach((topic) => {\n    global = updateThread(global, chatId, topic.id, {\n      firstMessageId: topic.id,\n    });\n\n    global = updateThreadInfo(global, chatId, topic.id, {\n      lastMessageId: topic.lastMessageId,\n      threadId: topic.id,\n      chatId,\n    });\n  });\n\n  return global;\n}\n\nexport function updateTopic<T extends GlobalState>(\n  global: T, chatId: string, topicId: number, update: Partial<ApiTopic>,\n): T {\n  const chat = selectChat(global, chatId);\n\n  if (!chat) return global;\n\n  const topic = selectTopic(global, chatId, topicId);\n  const oldTopics = selectTopics(global, chatId);\n\n  const updatedTopic = {\n    ...topic,\n    ...update,\n  } as ApiTopic;\n\n  if (!updatedTopic.id) return global;\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: {\n      ...oldTopics,\n      [topicId]: updatedTopic,\n    },\n  });\n\n  global = updateThread(global, chatId, updatedTopic.id, {\n    firstMessageId: updatedTopic.id,\n  });\n\n  global = updateThreadInfo(global, chatId, updatedTopic.id, {\n    lastMessageId: updatedTopic.lastMessageId,\n    threadId: updatedTopic.id,\n    chatId,\n  });\n\n  return global;\n}\n\nexport function deleteTopic<T extends GlobalState>(\n  global: T, chatId: string, topicId: number,\n) {\n  const topics = selectTopics(global, chatId);\n  if (!topics) return global;\n\n  global = updateTopicsStore(global, chatId, {\n    topicsById: omit(topics, [topicId]),\n  });\n\n  return global;\n}\n\nexport function updateTopicLastMessageId<T extends GlobalState>(\n  global: T, chatId: string, threadId: number, lastMessageId: number,\n) {\n  return updateTopic(global, chatId, threadId, {\n    lastMessageId,\n  });\n}\n\nexport function replacePinnedTopicIds<T extends GlobalState>(\n  global: T, chatId: string, pinnedTopicIds: number[],\n) {\n  return updateTopicsStore(global, chatId, {\n    orderedPinnedTopicIds: pinnedTopicIds,\n  });\n}\n","import type {\n  ApiSavedStarGift,\n  ApiStarGiftAuctionState,\n  ApiStarGiftAuctionUserState,\n  ApiTypeStarGiftAuctionState,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function removeGiftInfoOriginalDetails<T extends GlobalState>(\n  global: T,\n  tabId: number = getCurrentTabId(),\n): T {\n  const tabState = global.byTabId[tabId];\n  const { giftInfoModal } = tabState;\n  if (!giftInfoModal) {\n    return global;\n  }\n\n  const typeGift = giftInfoModal.gift;\n  const isSavedGift = typeGift && 'gift' in typeGift;\n\n  if (!isSavedGift) {\n    return global;\n  }\n\n  const savedGift = typeGift;\n  const innerGift = savedGift.gift;\n\n  if (innerGift.type !== 'starGiftUnique') {\n    return global;\n  }\n\n  const updatedInnerGift = {\n    ...innerGift,\n    attributes: innerGift.attributes?.filter((attr) => attr.type !== 'originalDetails'),\n  };\n\n  const updatedGift: ApiSavedStarGift = {\n    ...savedGift,\n    dropOriginalDetailsStars: undefined,\n    gift: updatedInnerGift,\n  };\n\n  return updateTabState(global, {\n    giftInfoModal: {\n      ...giftInfoModal,\n      gift: updatedGift,\n    },\n  }, tabId);\n}\n\nfunction getAuctionStateVersion(state: ApiTypeStarGiftAuctionState): number {\n  return state.type === 'active' ? state.version : 0;\n}\n\nexport function updateActiveGiftAuction<T extends GlobalState>(\n  global: T,\n  auctionState: ApiStarGiftAuctionState,\n  tabId: number = getCurrentTabId(),\n): T {\n  const currentAuction = selectTabState(global, tabId).activeGiftAuction;\n\n  const serverVersion = getAuctionStateVersion(auctionState.state);\n  const clientVersion = currentAuction ? getAuctionStateVersion(currentAuction.state) : -1;\n\n  if (serverVersion >= clientVersion) {\n    return updateTabState(global, {\n      activeGiftAuction: auctionState,\n    }, tabId);\n  }\n\n  return global;\n}\n\nexport function updateActiveGiftAuctionState<T extends GlobalState>(\n  global: T,\n  giftId: string,\n  state: ApiTypeStarGiftAuctionState,\n  tabId: number,\n): T {\n  const activeAuction = selectTabState(global, tabId).activeGiftAuction;\n\n  if (!activeAuction || activeAuction.gift.id !== giftId) {\n    return global;\n  }\n\n  const serverVersion = getAuctionStateVersion(state);\n  const clientVersion = getAuctionStateVersion(activeAuction.state);\n\n  if (serverVersion > clientVersion) {\n    return updateTabState(global, {\n      activeGiftAuction: {\n        ...activeAuction,\n        state,\n      },\n    }, tabId);\n  }\n\n  return global;\n}\n\nexport function updateActiveGiftAuctionUserState<T extends GlobalState>(\n  global: T,\n  giftId: string,\n  userState: ApiStarGiftAuctionUserState,\n  tabId: number,\n): T {\n  const activeAuction = selectTabState(global, tabId).activeGiftAuction;\n\n  if (!activeAuction || activeAuction.gift.id !== giftId) {\n    return global;\n  }\n\n  return updateTabState(global, {\n    activeGiftAuction: {\n      ...activeAuction,\n      userState,\n    },\n  }, tabId);\n}\n","import type { GlobalState } from '../types';\n\nconst DEFAULT_LAYOUT = {\n  agentColumnState: 'collapsed' as const,\n  agentColumnWidth: 400,\n  contentMode: 'chat' as const,\n  isPinned: false,\n};\n\nexport function updateLayout<T extends GlobalState>(\n  global: T,\n  layoutUpdate: Partial<GlobalState['layout']>,\n): T {\n  const currentLayout = global.layout || DEFAULT_LAYOUT;\n\n  return {\n    ...global,\n    layout: {\n      ...currentLayout,\n      ...layoutUpdate,\n    },\n  };\n}\n\nexport function setAgentColumnState<T extends GlobalState>(\n  global: T,\n  state: 'expanded' | 'minimized' | 'collapsed',\n): T {\n  return updateLayout(global, { agentColumnState: state });\n}\n\nexport function setAgentColumnWidth<T extends GlobalState>(\n  global: T,\n  width: number,\n): T {\n  const clampedWidth = Math.max(300, Math.min(580, width));\n  return updateLayout(global, { agentColumnWidth: clampedWidth });\n}\n\nexport function setContentMode<T extends GlobalState>(\n  global: T,\n  mode: 'chat' | 'split' | 'info',\n): T {\n  return updateLayout(global, { contentMode: mode });\n}\n\nexport function setLayoutPinned<T extends GlobalState>(\n  global: T,\n  isPinned: boolean,\n): T {\n  return updateLayout(global, { isPinned });\n}\n\nexport function toggleAgentColumn<T extends GlobalState>(global: T): T {\n  const currentLayout = global.layout || DEFAULT_LAYOUT;\n  const currentState = currentLayout.agentColumnState;\n\n  let newState: 'expanded' | 'minimized' | 'collapsed';\n\n  switch (currentState) {\n    case 'collapsed':\n      newState = 'expanded';\n      break;\n    case 'expanded':\n      newState = 'minimized';\n      break;\n    case 'minimized':\n      newState = 'collapsed';\n      break;\n    default:\n      newState = 'expanded';\n  }\n\n  return setAgentColumnState(global, newState);\n}\n\nexport function loadLayoutPreferences<T extends GlobalState>(global: T): T {\n  const savedAgentState =\n    localStorage.getItem('alphaHuman.agentColumnState') as 'expanded' | 'minimized' | 'collapsed' | null;\n  const savedWidth = localStorage.getItem('alphaHuman.agentColumnWidth');\n  const savedContentMode = localStorage.getItem('alphaHuman.contentMode') as 'chat' | 'split' | 'info' | null;\n  const savedPinned = localStorage.getItem('alphaHuman.layoutPinned');\n\n  const currentLayout = global.layout || DEFAULT_LAYOUT;\n\n  const layoutUpdate: Partial<GlobalState['layout']> = {\n    agentColumnState: savedAgentState || currentLayout.agentColumnState,\n    agentColumnWidth: savedWidth ? Number(savedWidth) : currentLayout.agentColumnWidth,\n    contentMode: savedContentMode || currentLayout.contentMode,\n    isPinned: savedPinned ? savedPinned === 'true' : currentLayout.isPinned,\n  };\n\n  return updateLayout(global, layoutUpdate);\n}\n","import type { SummarizeChatInfo, SummarizeState, ChatSummary } from '../../types';\nimport type { GlobalState, TabArgs, TabState } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { updateTabState } from './tabs';\n\nexport function initializeSummarizeState<T extends GlobalState>(\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): Partial<TabState> {\n  return {\n    summarize: {\n      isOpen: false,\n      isSetupComplete: false,\n      selectedChatIds: [],\n      summaries: [],\n      isLoadingBusiestChats: false,\n      isLoadingSummaries: false,\n      includeArchived: false,\n    },\n  };\n}\n\nexport function updateSummarizeState<T extends GlobalState>(\n  global: T,\n  update: Partial<SummarizeState>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const currentSummarize = global.byTabId[tabId]?.summarize || {\n    isOpen: false,\n    isSetupComplete: false,\n    selectedChatIds: [],\n    summaries: [],\n    isLoadingBusiestChats: false,\n    isLoadingSummaries: false,\n    includeArchived: false,\n    selectedDate: undefined,\n  };\n\n  return updateTabState(global, {\n    summarize: {\n      ...currentSummarize,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function setBusiestChats<T extends GlobalState>(\n  global: T,\n  busiestChats: SummarizeChatInfo[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    busiestChats,\n    isLoadingBusiestChats: false,\n  }, tabId);\n}\n\nexport function setBusiestChatsLoading<T extends GlobalState>(\n  global: T,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    isLoadingBusiestChats: isLoading,\n  }, tabId);\n}\n\nexport function selectChatsForSummarize<T extends GlobalState>(\n  global: T,\n  chatIds: string[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    selectedChatIds: chatIds,\n  }, tabId);\n}\n\nexport function completeSummarizeSetup<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    isSetupComplete: true,\n  }, tabId);\n}\n\nexport function resetSummarizeSetup<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    isSetupComplete: false,\n    summaries: [],\n    selectedChatIds: [],\n    selectedDate: undefined,\n  }, tabId);\n}\n\nexport function setSummarizeSelectedDate<T extends GlobalState>(\n  global: T,\n  date: number | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    selectedDate: date,\n  }, tabId);\n}\n\nexport function setSummaries<T extends GlobalState>(\n  global: T,\n  summaries: ChatSummary[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    summaries,\n    isLoadingSummaries: false,\n  }, tabId);\n}\n\nexport function setSummariesLoading<T extends GlobalState>(\n  global: T,\n  isLoading: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    isLoadingSummaries: isLoading,\n  }, tabId);\n}\n\nexport function updateSummarizeSearchQuery<T extends GlobalState>(\n  global: T,\n  query: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    searchQuery: query,\n  }, tabId);\n}\n\nexport function markSummaryAsRead<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  date: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const summarize = global.byTabId[tabId]?.summarize;\n  if (!summarize) return global;\n\n  const summaries = summarize.summaries.map((summary) => {\n    if (summary.chatId === chatId && summary.date === date) {\n      return { ...summary, isRead: true };\n    }\n    return summary;\n  });\n\n  return updateSummarizeState(global, {\n    summaries,\n  }, tabId);\n}\n\nexport function setIncludeArchived<T extends GlobalState>(\n  global: T,\n  includeArchived: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateSummarizeState(global, {\n    includeArchived,\n  }, tabId);\n}\n","import type { ApiChat, ApiPeer, ApiUser } from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\nimport type { CustomPeer } from '../../types';\n\nimport { SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { isUserId } from '../../util/entities/ids';\nimport { getTranslationFn, type LangFn } from '../../util/localization';\nimport { prepareSearchWordsForNeedle } from '../../util/searchWords';\nimport { selectChat, selectPeer, selectUser } from '../selectors';\nimport { getGlobal } from '..';\nimport { getChatTitle } from './chats';\nimport { getUserFirstOrLastName, getUserFullName } from './users';\n\nexport function isApiPeerChat(peer: ApiPeer): peer is ApiChat {\n  return 'title' in peer;\n}\n\nexport function isApiPeerUser(peer: ApiPeer): peer is ApiUser {\n  return !isApiPeerChat(peer);\n}\n\nexport function filterPeersByQuery({\n  ids,\n  query,\n  type = 'peer',\n}: {\n  ids: string[];\n  query: string | undefined;\n  type?: 'chat' | 'user' | 'peer';\n}) {\n  if (!query) {\n    return ids;\n  }\n  const global = getGlobal();\n  const lang = getTranslationFn();\n\n  const searchWords = prepareSearchWordsForNeedle(query);\n\n  const selectorFn = type === 'chat' ? selectChat : type === 'user' ? selectUser : selectPeer;\n\n  return ids.filter((id) => {\n    const peer = selectorFn(global, id);\n    if (!peer) {\n      return false;\n    }\n\n    const localizedTitle = isApiPeerChat(peer)\n      ? getChatTitle(lang, peer)\n      : id === global.currentUserId ? lang('SavedMessages') : undefined;\n    const isFoundInLocalized = localizedTitle ? searchWords(localizedTitle) : undefined;\n\n    const name = getPeerFullTitle(lang, peer);\n\n    return isFoundInLocalized\n      || (name && searchWords(name))\n      || Boolean(peer.usernames?.find(({ username }) => searchWords(username)));\n  });\n}\n\nexport function getPeerTypeKey(peer: ApiPeer) {\n  if (isApiPeerChat(peer)) {\n    if (peer.type === 'chatTypeBasicGroup' || peer.type === 'chatTypeSuperGroup') {\n      return 'ChatList.PeerTypeGroup';\n    }\n\n    if (peer.type === 'chatTypeChannel') {\n      return 'ChatList.PeerTypeChannel';\n    }\n\n    if (peer.type === 'chatTypePrivate') {\n      return 'ChatList.PeerTypeNonContact';\n    }\n\n    return undefined;\n  }\n\n  if (peer.id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return 'ServiceNotifications';\n  }\n\n  if (peer.isSupport) {\n    return 'SupportStatus';\n  }\n\n  if (peer.type && peer.type === 'userTypeBot') {\n    return 'ChatList.PeerTypeBot';\n  }\n\n  if (peer.isContact) {\n    return 'ChatList.PeerTypeContact';\n  }\n\n  return 'ChatList.PeerTypeNonContactUser';\n}\n\nexport function getPeerTitle(lang: OldLangFn | LangFn, peer: ApiPeer | CustomPeer) {\n  if (!peer) return undefined;\n  if ('isCustomPeer' in peer) {\n    // TODO: Remove any after full migration to new lang\n    return peer.titleKey ? lang(peer.titleKey as any) : peer.title;\n  }\n  return isApiPeerUser(peer) ? getUserFirstOrLastName(peer) : getChatTitle(lang, peer);\n}\n\nexport function getPeerFullTitle(lang: OldLangFn | LangFn, peer: ApiPeer | CustomPeer) {\n  if (!peer) return undefined;\n  if ('isCustomPeer' in peer) {\n    // TODO: Remove any after full migration to new lang\n    return peer.titleKey ? lang(peer.titleKey as any) : peer.title;\n  }\n  return isApiPeerUser(peer) ? getUserFullName(peer) : getChatTitle(lang, peer);\n}\n\nexport function getMessageSenderName(lang: LangFn, chatId: string, sender: ApiPeer) {\n  // Hide sender name for private chats\n  if (isUserId(chatId)) return undefined;\n\n  if (isApiPeerChat(sender)) {\n    if (chatId === sender.id) return undefined;\n\n    return sender.title;\n  }\n\n  if (sender.isSelf) {\n    return lang('FromYou');\n  }\n\n  return getPeerTitle(lang, sender);\n}\n","function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    let dbp;\n    const getDB = () => {\n        if (dbp)\n            return dbp;\n        const request = indexedDB.open(dbName);\n        request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n        dbp = promisifyRequest(request);\n        dbp.then((db) => {\n            // It seems like Safari sometimes likes to just close the connection.\n            // It's supposed to fire this event when that happens. Let's hope it does!\n            db.onclose = () => (dbp = undefined);\n        }, () => { });\n        return dbp;\n    };\n    return (txMode, callback) => getDB().then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic  if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n","import {\n  clear,\n  createStore,\n  del,\n  delMany,\n  entries as getEntries,\n  get,\n  getMany,\n  keys as getKeys,\n  set,\n  setMany,\n  update,\n  values as getValues,\n} from 'idb-keyval';\n\nclass IdbStore {\n  public store: ReturnType<typeof createStore>;\n\n  constructor(name: string) {\n    this.store = createStore(name, 'store');\n  }\n\n  public set(key: string, value: any) {\n    return set(key, value, this.store);\n  }\n\n  public setMany(entries: [string, any][]) {\n    return setMany(entries, this.store);\n  }\n\n  public get<T = unknown>(key: string) {\n    return get<T>(key, this.store);\n  }\n\n  public getMany<T = unknown>(keys: string[]) {\n    return getMany<T>(keys, this.store);\n  }\n\n  public clear() {\n    return clear(this.store);\n  }\n\n  public del(key: string) {\n    return del(key, this.store);\n  }\n\n  public delMany(keys: string[]) {\n    return delMany(keys, this.store);\n  }\n\n  public entries() {\n    return getEntries(this.store);\n  }\n\n  public keys() {\n    return getKeys(this.store);\n  }\n\n  public values<T = unknown>() {\n    return getValues<T>(this.store);\n  }\n\n  public update<T = unknown>(key: string, updater: (oldValue: T | undefined) => T) {\n    return update(key, updater, this.store);\n  }\n}\n\nexport const MAIN_IDB_STORE = new IdbStore('tt-data');\nexport const PASSCODE_IDB_STORE = new IdbStore('tt-passcode');\n","import {\n  type ApiFormattedText,\n  type ApiMessageEntityTimestamp,\n  ApiMessageEntityTypes,\n} from '../../api/types';\n\nimport { getSeconds } from './units';\n\nconst TIMESTAMP_RE = /\\b(?:(\\d{1,2}):)?([0-5]?\\d):([0-5]\\d)\\b/g;\n\nexport function addTimestampEntities<T extends ApiFormattedText>(apiText: T): T {\n  const resultText: Required<ApiFormattedText> & T = {\n    ...apiText,\n    text: apiText.text,\n    entities: apiText.entities?.filter((e) => e.type !== ApiMessageEntityTypes.Timestamp) || [],\n  };\n\n  const text = resultText.text;\n\n  for (const match of text.matchAll(TIMESTAMP_RE)) {\n    const fullMatch = match[0];\n    const hourStr = match[1];\n    const minuteStr = match[2];\n    const secondStr = match[3];\n    const offset = match.index ?? 0;\n    const length = fullMatch.length;\n\n    const minutes = parseInt(minuteStr, 10);\n    const seconds = parseInt(secondStr, 10);\n\n    if (minutes > 59 || seconds > 59) {\n      continue;\n    }\n\n    let totalSeconds: number;\n    if (hourStr !== undefined) {\n      const hours = parseInt(hourStr, 10);\n      totalSeconds = getSeconds(hours, minutes, seconds);\n    } else {\n      totalSeconds = getSeconds(0, minutes, seconds);\n    }\n\n    let overlaps = false;\n    for (const entity of resultText.entities) {\n      if (offset < entity.offset + entity.length && offset + length > entity.offset) {\n        overlaps = true;\n        break;\n      }\n    }\n    if (overlaps) {\n      continue;\n    }\n\n    const newEntity: ApiMessageEntityTimestamp = {\n      type: ApiMessageEntityTypes.Timestamp,\n      offset,\n      length,\n      timestamp: totalSeconds,\n    };\n\n    let inserted = false;\n    for (let i = 0; i < resultText.entities.length; i++) {\n      if (offset < resultText.entities[i].offset) {\n        resultText.entities.splice(i, 0, newEntity);\n        inserted = true;\n        break;\n      }\n    }\n    if (!inserted) {\n      resultText.entities.push(newEntity);\n    }\n  }\n\n  return resultText;\n}\n\nexport function parseTimestampDuration(input: string): number | undefined {\n  input = input.trim();\n\n  if (!input.startsWith('-') && Number.isInteger(Number(input))) {\n    return parseInt(input, 10);\n  }\n\n  if (input.includes(':')) {\n    const parts = input.split(':');\n\n    if (parts.length === 2) {\n      const minutes = parseInt(parts[0], 10);\n      const seconds = parseInt(parts[1], 10);\n\n      if (\n        Number.isNaN(minutes) || Number.isNaN(seconds)\n        || minutes < 0 || seconds < 0 || seconds >= 60\n      ) {\n        return undefined;\n      }\n      return minutes * 60 + seconds;\n    }\n\n    if (parts.length === 3) {\n      const hours = parseInt(parts[0], 10);\n      const minutes = parseInt(parts[1], 10);\n      const seconds = parseInt(parts[2], 10);\n\n      if (\n        Number.isNaN(hours) || Number.isNaN(minutes) || Number.isNaN(seconds)\n        || hours < 0 || minutes < 0 || seconds < 0 || minutes >= 60 || seconds >= 60\n      ) {\n        return undefined;\n      }\n      return hours * 3600 + minutes * 60 + seconds;\n    }\n\n    return undefined;\n  }\n\n  const regex = /^(?:(\\d+)h)?(?:(\\d+)m)?(?:(\\d+)s)?$/i;\n  const match = input.match(regex);\n  if (!match) {\n    return undefined;\n  }\n\n  const hours = match[1] ? parseInt(match[1], 10) : 0;\n  const minutes = match[2] ? parseInt(match[2], 10) : 0;\n  const seconds = match[3] ? parseInt(match[3], 10) : 0;\n\n  if (\n    Number.isNaN(hours) || Number.isNaN(minutes) || Number.isNaN(seconds)\n    || minutes >= 60 || seconds >= 60\n  ) {\n    return undefined;\n  }\n  return hours * 3600 + minutes * 60 + seconds;\n}\n","import { LEGACY_PASSCODE_CACHE_NAME } from '../config';\nimport { PASSCODE_IDB_STORE } from './browser/idb';\nimport * as cacheApi from './cacheApi';\n\nconst IV_LENGTH = 12;\nconst SALT = 'harder better faster stronger';\n\nlet currentPasscodeHash: ArrayBuffer | undefined;\n\nexport class UnrecoverablePasscodeError extends Error {}\n\nexport function getPasscodeHash() {\n  return currentPasscodeHash;\n}\n\nexport function setPasscodeHash(passcodeHash: ArrayBuffer) {\n  currentPasscodeHash = passcodeHash;\n}\n\nexport async function setupPasscode(passcode: string) {\n  currentPasscodeHash = await sha256(passcode);\n}\n\nexport async function encryptSession(sessionJson?: string, globalJson?: string) {\n  if (!currentPasscodeHash) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing current passcode');\n    throw new Error('[api/passcode] Missing current passcode');\n  }\n\n  await Promise.all([\n    (async () => {\n      if (!sessionJson) return;\n\n      const sessionEncrypted = await aesEncrypt(sessionJson, currentPasscodeHash);\n      await store('sessionEncrypted', sessionEncrypted);\n    })(),\n    (async () => {\n      if (!globalJson) return;\n\n      const globalEncrypted = await aesEncrypt(globalJson, currentPasscodeHash);\n      await store('globalEncrypted', globalEncrypted);\n    })(),\n  ]);\n}\n\nexport async function decryptSessionByCurrentHash() {\n  if (!currentPasscodeHash) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing current passcode');\n    throw new Error('[api/passcode] Missing current passcode');\n  }\n\n  const [sessionEncrypted, globalEncrypted] = await Promise.all([\n    load('sessionEncrypted'),\n    load('globalEncrypted'),\n  ]);\n\n  if (!sessionEncrypted || !globalEncrypted) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing required stored fields');\n    throw new Error('[api/passcode] Missing required stored fields');\n  }\n\n  try {\n    const [sessionJson, globalJson] = await Promise.all([\n      aesDecrypt(sessionEncrypted, currentPasscodeHash),\n      aesDecrypt(globalEncrypted, currentPasscodeHash),\n    ]);\n\n    return { sessionJson, globalJson };\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Error decrypting session', err);\n    throw err;\n  }\n}\n\nexport async function decryptSession(passcode: string) {\n  const passcodeHash = await sha256(passcode);\n\n  const [sessionEncrypted, globalEncrypted] = await Promise.all([\n    load('sessionEncrypted'),\n    load('globalEncrypted'),\n  ]);\n\n  if (!sessionEncrypted || !globalEncrypted) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Missing required stored fields');\n    throw new UnrecoverablePasscodeError('[api/passcode] Missing required stored fields');\n  }\n\n  try {\n    const [sessionJson, globalJson] = await Promise.all([\n      aesDecrypt(sessionEncrypted, passcodeHash),\n      aesDecrypt(globalEncrypted, passcodeHash),\n    ]);\n\n    currentPasscodeHash = passcodeHash;\n\n    return { sessionJson, globalJson };\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error('[api/passcode] Error decrypting session', err);\n    throw err;\n  }\n}\n\nexport function forgetPasscode() {\n  currentPasscodeHash = undefined;\n}\n\nexport function clearEncryptedSession() {\n  forgetPasscode();\n  PASSCODE_IDB_STORE.clear();\n  return cacheApi.clear(LEGACY_PASSCODE_CACHE_NAME);\n}\n\nfunction sha256(plaintext: string) {\n  return crypto.subtle.digest('SHA-256', new TextEncoder().encode(`${plaintext}${SALT}`));\n}\n\nfunction store(key: string, value: ArrayBuffer) {\n  const asArray = Array.from(new Uint8Array(value));\n  return PASSCODE_IDB_STORE.set(key, asArray);\n}\n\nexport function hasEncryptedSession() {\n  return PASSCODE_IDB_STORE.get('sessionEncrypted');\n}\n\nasync function load(key: string) {\n  const cached = await PASSCODE_IDB_STORE.get<number[]>(key);\n  if (cached) {\n    const asArrayBuffer = new Uint8Array(cached).buffer;\n    return asArrayBuffer;\n  }\n  // Fallback for old data\n  return cacheApi.fetch(LEGACY_PASSCODE_CACHE_NAME, key, cacheApi.Type.ArrayBuffer);\n}\n\nasync function aesEncrypt(plaintext: string, pwHash: ArrayBuffer) {\n  const iv = crypto.getRandomValues(new Uint8Array(IV_LENGTH));\n  const alg = { name: 'AES-GCM', iv };\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['encrypt']);\n  const ptUint8 = new TextEncoder().encode(plaintext);\n  const ctBuffer = await crypto.subtle.encrypt(alg, key, ptUint8);\n  const ct = new Uint8Array(ctBuffer);\n  const result = new Uint8Array(IV_LENGTH + ct.length);\n  result.set(iv, 0);\n  result.set(ct, IV_LENGTH);\n  return result.buffer;\n}\n\nasync function aesDecrypt(data: ArrayBuffer, pwHash: ArrayBuffer) {\n  const dataArray = new Uint8Array(data);\n  const iv = dataArray.slice(0, IV_LENGTH);\n  const alg = { name: 'AES-GCM', iv };\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']);\n  const ct = dataArray.slice(IV_LENGTH);\n  const plainBuffer = await crypto.subtle.decrypt(alg, key, ct);\n\n  return new TextDecoder().decode(plainBuffer);\n}\n","import type { ThemeKey } from '../types';\n\nimport { requestMutation } from '../lib/fasterdom/fasterdom';\nimport themeColors from '../styles/themes.json';\nimport { animate } from './animation';\nimport { hex2rgbaObj, lerpRgbaObj } from './colors.ts';\n\nlet isInitialized = false;\n\nconst DECIMAL_PLACES = 3;\nconst DURATION_MS = 200;\nconst ENABLE_ANIMATION_DELAY_MS = 500;\nconst RGB_VARIABLES = new Set([\n  '--color-text',\n  '--color-primary-shade',\n  '--color-text-secondary',\n  '--color-accent-own',\n]);\n\nconst DISABLE_ANIMATION_CSS = `\n.no-animations #root *,\n.no-animations #root *::before,\n.no-animations #root *::after {\n  transition: none !important;\n}`;\n\nconst colors = (Object.keys(themeColors) as Array<keyof typeof themeColors>).map((property) => ({\n  property,\n  colors: [hex2rgbaObj(themeColors[property][0]), hex2rgbaObj(themeColors[property][1])],\n}));\n\nconst injectCss = (css: string) => {\n  const style = document.createElement('style');\n  style.textContent = css;\n  document.head.appendChild(style);\n  return () => {\n    document.head.removeChild(style);\n  };\n};\n\nconst switchTheme = (theme: ThemeKey, withAnimation: boolean) => {\n  const themeClassName = `theme-${theme}`;\n  if (document.documentElement.classList.contains(themeClassName)) {\n    return;\n  }\n  const isDarkTheme = theme === 'dark';\n  const shouldAnimate = isInitialized && withAnimation;\n  const startIndex = isDarkTheme ? 0 : 1;\n  const endIndex = isDarkTheme ? 1 : 0;\n  const startAt = Date.now();\n  const themeColorTag = document.querySelector('meta[name=\"theme-color\"]');\n\n  requestMutation(() => {\n    document.documentElement.classList.remove(`theme-${isDarkTheme ? 'light' : 'dark'}`);\n    let uninjectCss: (() => void) | undefined;\n    if (isInitialized) {\n      uninjectCss = injectCss(DISABLE_ANIMATION_CSS);\n      document.documentElement.classList.add('no-animations');\n    }\n    document.documentElement.classList.add(themeClassName);\n    if (themeColorTag) {\n      themeColorTag.setAttribute('content', isDarkTheme ? '#212121' : '#fff');\n    }\n\n    setTimeout(() => {\n      requestMutation(() => {\n        uninjectCss?.();\n        document.documentElement.classList.remove('no-animations');\n      });\n    }, ENABLE_ANIMATION_DELAY_MS);\n\n    isInitialized = true;\n\n    if (shouldAnimate) {\n      animate(() => {\n        const t = Math.min((Date.now() - startAt) / DURATION_MS, 1);\n\n        applyColorAnimationStep(startIndex, endIndex, transition(t));\n\n        return t < 1;\n      }, requestMutation);\n    } else {\n      applyColorAnimationStep(startIndex, endIndex);\n    }\n  });\n};\n\nfunction transition(t: number) {\n  return 1 - ((1 - t) ** 3.5);\n}\n\nfunction applyColorAnimationStep(startIndex: number, endIndex: number, interpolationRatio: number = 1) {\n  colors.forEach(({ property, colors: propertyColors }) => {\n    const {\n      r, g, b, a,\n    } = lerpRgbaObj(propertyColors[startIndex], propertyColors[endIndex], interpolationRatio);\n\n    const roundedA = a !== undefined ? Math.round((a / 255) * 10 ** DECIMAL_PLACES) / 10 ** DECIMAL_PLACES : undefined;\n\n    document.documentElement.style.setProperty(property, `rgb(${r},${g},${b}${roundedA ? `,${roundedA}` : ''})`);\n\n    if (RGB_VARIABLES.has(property)) {\n      document.documentElement.style.setProperty(`${property}-rgb`, `${r},${g},${b}`);\n    }\n  });\n}\n\nexport default switchTheme;\n","import type { ElementRef } from '../lib/teact/teact';\nimport { useLayoutEffect } from '../lib/teact/teact';\nimport { addExtraClass, removeExtraClass, setExtraStyles } from '../lib/teact/teact-dom';\n\nimport type { IAnchorPosition } from '../types';\n\nimport { requestForcedReflow } from '../lib/fasterdom/fasterdom';\nimport { useStateRef } from './useStateRef';\n\ninterface StaticPositionOptions {\n  anchor?: IAnchorPosition;\n  positionX?: 'left' | 'right';\n  positionY?: 'top' | 'bottom';\n  transformOriginX?: number;\n  transformOriginY?: number;\n  style?: string;\n  bubbleStyle?: string;\n}\n\ninterface DynamicPositionOptions {\n  anchor: IAnchorPosition;\n  getTriggerElement: () => HTMLElement | undefined | null;\n  getRootElement: () => HTMLElement | undefined | null;\n  getMenuElement: () => HTMLElement | undefined | null;\n  getLayout?: () => Layout;\n  withMaxHeight?: boolean;\n}\n\nexport type MenuPositionOptions =\n  StaticPositionOptions\n  | DynamicPositionOptions;\n\nexport interface Layout {\n  extraPaddingX?: number;\n  extraTopPadding?: number;\n  menuElMinWidth?: number;\n  deltaX?: number;\n  topShiftY?: number;\n  shouldAvoidNegativePosition?: boolean;\n  withPortal?: boolean;\n  isDense?: boolean; //  Allows you to place the menu as close to the edges of the area as possible\n}\n\nconst MENU_POSITION_VISUAL_COMFORT_SPACE_PX = 16;\nconst MENU_POSITION_BOTTOM_MARGIN = 12;\nconst EMPTY_RECT = {\n  width: 0, left: 0, height: 0, top: 0,\n};\n\nexport default function useMenuPosition(\n  isOpen: boolean,\n  containerRef: ElementRef<HTMLDivElement>,\n  bubbleRef: ElementRef<HTMLDivElement>,\n  options: MenuPositionOptions,\n) {\n  const optionsRef = useStateRef(options);\n\n  useLayoutEffect(() => {\n    if (!isOpen) return;\n\n    const options2 = optionsRef.current;\n\n    if (!('getTriggerElement' in options2)) {\n      applyStaticOptions(containerRef, bubbleRef, options2);\n    } else {\n      requestForcedReflow(() => {\n        const staticOptions = processDynamically(containerRef, bubbleRef, options2);\n\n        return () => {\n          applyStaticOptions(containerRef, bubbleRef, staticOptions);\n        };\n      });\n    }\n  }, [isOpen, containerRef, bubbleRef, optionsRef]);\n}\n\nfunction applyStaticOptions(\n  containerRef: ElementRef<HTMLDivElement>,\n  bubbleRef: ElementRef<HTMLDivElement>,\n  {\n    positionX = 'left',\n    positionY = 'top',\n    transformOriginX,\n    transformOriginY,\n    style,\n    bubbleStyle,\n  }: StaticPositionOptions,\n) {\n  const containerEl = containerRef.current!;\n  const bubbleEl = bubbleRef.current!;\n\n  if (style) {\n    containerEl.style.cssText = style;\n  }\n\n  if (bubbleStyle) {\n    bubbleEl.style.cssText = bubbleStyle;\n  }\n\n  if (positionX) {\n    removeExtraClass(bubbleEl, positionX === 'left' ? 'right' : 'left');\n    addExtraClass(bubbleEl, positionX);\n  }\n\n  if (positionY) {\n    removeExtraClass(bubbleEl, positionY === 'top' ? 'bottom' : 'top');\n    addExtraClass(bubbleEl, positionY);\n  }\n\n  setExtraStyles(bubbleEl, {\n    transformOrigin: [\n      transformOriginX ? `${transformOriginX}px` : positionX,\n      transformOriginY ? `${transformOriginY}px` : positionY,\n    ].join(' '),\n  });\n}\n\nfunction processDynamically(\n  containerRef: ElementRef<HTMLDivElement>,\n  bubbleRef: ElementRef<HTMLDivElement>,\n  {\n    anchor,\n    getRootElement,\n    getMenuElement,\n    getTriggerElement,\n    getLayout,\n    withMaxHeight,\n  }: DynamicPositionOptions,\n) {\n  const triggerEl = getTriggerElement()!;\n\n  let { x, y } = anchor;\n  const anchorX = x;\n  const anchorY = y;\n\n  const menuEl = getMenuElement();\n  const rootEl = getRootElement();\n\n  const {\n    extraPaddingX = 0,\n    extraTopPadding = 0,\n    topShiftY = 0,\n    menuElMinWidth = 0,\n    deltaX = 0,\n    shouldAvoidNegativePosition = false,\n    withPortal = false,\n    isDense = false,\n  } = getLayout?.() || {};\n\n  const marginTop = menuEl ? parseInt(getComputedStyle(menuEl).marginTop, 10) : undefined;\n  const { offsetWidth: menuElWidth, offsetHeight: menuElHeight } = menuEl || { offsetWidth: 0, offsetHeight: 0 };\n  const menuRect = menuEl ? {\n    width: Math.max(menuElWidth, menuElMinWidth),\n    height: menuElHeight + marginTop!,\n  } : EMPTY_RECT;\n\n  const rootRect = rootEl ? rootEl.getBoundingClientRect() : EMPTY_RECT;\n\n  let positionX: 'left' | 'right';\n  let positionY: 'top' | 'bottom';\n  if (isDense || (x + menuRect.width + extraPaddingX < rootRect.width + rootRect.left)) {\n    x += 3;\n    positionX = 'left';\n  } else if (x - menuRect.width - rootRect.left > 0) {\n    positionX = 'right';\n    x -= 3;\n  } else {\n    positionX = 'left';\n    x = 16;\n  }\n\n  x += deltaX;\n\n  const yWithTopShift = y + topShiftY;\n\n  if (isDense || (yWithTopShift + menuRect.height < rootRect.height + rootRect.top)) {\n    positionY = 'top';\n    y = yWithTopShift;\n  } else {\n    positionY = 'bottom';\n\n    if (y - menuRect.height < rootRect.top + extraTopPadding) {\n      y = rootRect.top + rootRect.height;\n    }\n  }\n\n  const triggerRect = triggerEl.getBoundingClientRect();\n\n  const addedYForPortalPositioning = (withPortal ? triggerRect.top : 0);\n  const addedXForPortalPositioning = (withPortal ? triggerRect.left : 0);\n\n  const leftWithPossibleNegative = Math.min(\n    x - triggerRect.left,\n    rootRect.width - menuRect.width - MENU_POSITION_VISUAL_COMFORT_SPACE_PX,\n  );\n  let left = (positionX === 'left'\n    ? (withPortal || shouldAvoidNegativePosition\n      ? Math.max(MENU_POSITION_VISUAL_COMFORT_SPACE_PX, leftWithPossibleNegative)\n      : leftWithPossibleNegative)\n    : (x - triggerRect.left)) + addedXForPortalPositioning;\n  let top = y - triggerRect.top + addedYForPortalPositioning;\n\n  if (isDense) {\n    left = Math.min(left, rootRect.width - menuRect.width - MENU_POSITION_VISUAL_COMFORT_SPACE_PX);\n    top = Math.min(top, rootRect.height - menuRect.height - MENU_POSITION_VISUAL_COMFORT_SPACE_PX);\n  }\n\n  // Avoid hiding external parts of menus on mobile devices behind the edges of the screen (ReactionSelector for example)\n  const addedXForMenuPositioning = menuElMinWidth ? Math.max(0, (menuElMinWidth - menuElWidth) / 2) : 0;\n  if (left - addedXForMenuPositioning < 0 && shouldAvoidNegativePosition) {\n    left = addedXForMenuPositioning + MENU_POSITION_VISUAL_COMFORT_SPACE_PX;\n  }\n\n  const offsetX = (anchorX + addedXForPortalPositioning - triggerRect.left) - left;\n  const offsetY = (anchorY + addedYForPortalPositioning - triggerRect.top) - top - (marginTop || 0);\n  const transformOriginX = positionX === 'left' ? offsetX : menuRect.width + offsetX;\n  const transformOriginY = positionY === 'bottom' ? menuRect.height + offsetY : offsetY;\n\n  const style = `left: ${left}px; top: ${top}px`;\n\n  let bubbleStyle;\n  if (withMaxHeight) {\n    const menuMaxHeight = rootRect.height - MENU_POSITION_BOTTOM_MARGIN - (marginTop || 0);\n    bubbleStyle = `max-height: ${menuMaxHeight}px;`;\n  }\n\n  return {\n    positionX,\n    positionY,\n    transformOriginX,\n    transformOriginY,\n    style,\n    bubbleStyle,\n  };\n}\n","import type {\n  ElementRef } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport {\n  beginHeavyAnimation,\n  type FC, memo, useEffect, useRef,\n} from '../../lib/teact/teact';\n\nimport type { MenuPositionOptions } from '../../hooks/useMenuPosition';\n\nimport { IS_BACKDROP_BLUR_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport captureEscKeyListener from '../../util/captureEscKeyListener';\nimport { preventMessageInputBlurWithBubbling } from '../middle/helpers/preventMessageInputBlur';\n\nimport useAppLayout from '../../hooks/useAppLayout';\nimport useEffectWithPrevDeps from '../../hooks/useEffectWithPrevDeps';\nimport useHistoryBack from '../../hooks/useHistoryBack';\nimport useKeyboardListNavigation from '../../hooks/useKeyboardListNavigation';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMenuPosition from '../../hooks/useMenuPosition';\nimport useShowTransition from '../../hooks/useShowTransition';\nimport useVirtualBackdrop from '../../hooks/useVirtualBackdrop';\n\nimport Portal from './Portal';\n\nimport './Menu.scss';\n\nexport type { MenuPositionOptions } from '../../hooks/useMenuPosition';\n\ntype OwnProps =\n  {\n    ref?: ElementRef<HTMLDivElement>;\n    isOpen: boolean;\n    shouldCloseFast?: boolean;\n    id?: string;\n    className?: string;\n    bubbleClassName?: string;\n    ariaLabelledBy?: string;\n    autoClose?: boolean;\n    footer?: string;\n    noCloseOnBackdrop?: boolean;\n    backdropExcludedSelector?: string;\n    noCompact?: boolean;\n    onKeyDown?: (e: React.KeyboardEvent<any>) => void;\n    onCloseAnimationEnd?: () => void;\n    onClose: () => void;\n    onMouseEnter?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    onMouseEnterBackdrop?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    onMouseLeave?: (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n    withPortal?: boolean;\n    children?: React.ReactNode;\n  }\n  & MenuPositionOptions;\n\nconst ANIMATION_DURATION = 200;\n\nconst Menu: FC<OwnProps> = ({\n  ref: externalRef,\n  shouldCloseFast,\n  isOpen,\n  id,\n  className,\n  bubbleClassName,\n  ariaLabelledBy,\n  children,\n  autoClose = false,\n  footer,\n  noCloseOnBackdrop = false,\n  backdropExcludedSelector,\n  noCompact,\n  onCloseAnimationEnd,\n  onClose,\n  onMouseEnter,\n  onMouseLeave,\n  withPortal,\n  onMouseEnterBackdrop,\n  ...positionOptions\n}) => {\n  const { isTouchScreen } = useAppLayout();\n\n  const containerRef = useRef<HTMLDivElement>();\n\n  const { ref: bubbleRef } = useShowTransition({\n    isOpen,\n    ref: externalRef,\n    onCloseAnimationEnd,\n  });\n\n  useMenuPosition(isOpen, containerRef, bubbleRef, positionOptions);\n\n  useEffect(\n    () => (isOpen ? captureEscKeyListener(onClose) : undefined),\n    [isOpen, onClose],\n  );\n\n  useHistoryBack({\n    isActive: isOpen,\n    onBack: onClose,\n    shouldBeReplaced: true,\n  });\n\n  useEffectWithPrevDeps(([prevIsOpen]) => {\n    if (isOpen || (!isOpen && prevIsOpen === true)) {\n      beginHeavyAnimation(ANIMATION_DURATION);\n    }\n  }, [isOpen]);\n\n  const handleKeyDown = useKeyboardListNavigation(bubbleRef, isOpen, autoClose ? onClose : undefined, undefined, true);\n\n  useVirtualBackdrop(\n    isOpen,\n    containerRef,\n    noCloseOnBackdrop ? undefined : onClose,\n    undefined,\n    backdropExcludedSelector,\n  );\n\n  const bubbleFullClassName = buildClassName(\n    'bubble menu-container custom-scroll',\n    footer && 'with-footer',\n    bubbleClassName,\n    shouldCloseFast && 'close-fast',\n  );\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLDivElement>) => {\n    e.stopPropagation();\n    if (autoClose) {\n      onClose();\n    }\n  });\n\n  const menu = (\n    <div\n      ref={containerRef}\n      id={id}\n      className={buildClassName(\n        'Menu',\n        !noCompact && !isTouchScreen && 'compact',\n        !IS_BACKDROP_BLUR_SUPPORTED && 'no-blur',\n        withPortal && 'in-portal',\n        className,\n      )}\n      aria-labelledby={ariaLabelledBy}\n      role={ariaLabelledBy ? 'menu' : undefined}\n      onKeyDown={isOpen ? handleKeyDown : undefined}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={isOpen ? onMouseLeave : undefined}\n    >\n      {isOpen && (\n        // This only prevents click events triggering on underlying elements\n        <div\n          className=\"backdrop\"\n          onMouseDown={preventMessageInputBlurWithBubbling}\n          onMouseEnter={onMouseEnterBackdrop}\n        />\n      )}\n      <div\n        role=\"presentation\"\n        ref={bubbleRef}\n        className={bubbleFullClassName}\n        onClick={handleClick}\n      >\n        {children}\n        {footer && <div className=\"footer\">{footer}</div>}\n      </div>\n    </div>\n  );\n\n  if (withPortal) {\n    return <Portal>{menu}</Portal>;\n  }\n\n  return menu;\n};\n\nexport default memo(Menu);\n","import type React from '../lib/teact/teact';\nimport { useMemo, useState } from '../lib/teact/teact';\n\nimport { areDeepEqual } from '../util/areDeepEqual';\nimport { isSafariPatchInProgress } from '../util/patchSafariProgressiveAudio';\nimport { debounce } from '../util/schedulers';\nimport useLastCallback from './useLastCallback';\n\ntype BufferingEvent = (e: Event | React.SyntheticEvent<HTMLMediaElement>) => void;\n\nconst MIN_READY_STATE = 3;\n// Avoid flickering when re-mounting previously buffered video\nconst DEBOUNCE = 200;\nconst MIN_ALLOWED_MEDIA_DURATION = 0.1; // Some video emojis have weird duration of 0.04 causing extreme amount of events\n\n/**\n * Time range relative to the duration [0, 1]\n */\nexport type BufferedRange = { start: number; end: number };\n\nconst useBuffering = (noInitiallyBuffered = false, onTimeUpdate?: AnyToVoidFunction, onBroken?: AnyToVoidFunction) => {\n  const [isBuffered, setIsBuffered] = useState(!noInitiallyBuffered);\n  const [isReady, setIsReady] = useState(false);\n  const [bufferedProgress, setBufferedProgress] = useState(0);\n  const [bufferedRanges, setBufferedRanges] = useState<BufferedRange[]>([]);\n\n  const setIsBufferedDebounced = useMemo(() => {\n    return debounce(setIsBuffered, DEBOUNCE, false, true);\n  }, []);\n\n  const handleBuffering = useLastCallback<BufferingEvent>((e) => {\n    const media = e.currentTarget as HTMLMediaElement;\n\n    if (media.duration < MIN_ALLOWED_MEDIA_DURATION) {\n      onBroken?.();\n      return;\n    }\n\n    if (e.type === 'timeupdate') {\n      onTimeUpdate?.(e);\n    }\n\n    if (!isSafariPatchInProgress(media)) {\n      if (media.buffered.length) {\n        const ranges = getTimeRanges(media.buffered, media.duration);\n        const bufferedLength = ranges.reduce((acc, { start, end }) => acc + end - start, 0);\n        setBufferedProgress(bufferedLength / media.duration);\n        setBufferedRanges((currentRanges) => {\n          return areDeepEqual(currentRanges, ranges) ? currentRanges : ranges;\n        });\n      }\n\n      setIsBufferedDebounced(media.readyState >= MIN_READY_STATE || media.currentTime > 0);\n      setIsReady((current) => current || media.readyState > MIN_READY_STATE);\n    }\n  });\n\n  const bufferingHandlers = {\n    onPLay: handleBuffering,\n    onLoadedData: handleBuffering,\n    onPlaying: handleBuffering,\n    onLoadStart: handleBuffering, // Needed for Safari to start\n    onPause: handleBuffering, // Needed for Chrome when seeking\n    onTimeUpdate: handleBuffering, // Needed for audio buffering progress\n    onProgress: handleBuffering, // Needed for video buffering progress\n  };\n\n  return {\n    isReady,\n    isBuffered,\n    bufferedProgress,\n    bufferedRanges,\n    bufferingHandlers,\n    checkBuffering(element: HTMLMediaElement) {\n      setIsBufferedDebounced(element.readyState >= MIN_READY_STATE);\n    },\n  };\n};\n\nfunction getTimeRanges(ranges: TimeRanges, duration: number) {\n  const result: BufferedRange[] = [];\n  for (let i = 0; i < ranges.length; i++) {\n    result.push({\n      start: ranges.start(i) / duration,\n      end: ranges.end(i) / duration,\n    });\n  }\n  return result;\n}\n\nexport default useBuffering;\n","import type { AlphahumanThreadMessage } from '../../lib/alphahuman/types';\nimport type { AlphaHumanManagerState } from '../../lib/alphahuman/types';\nimport type { GlobalState } from '../types';\n\nimport { updateAlphahuman } from './alphahuman';\n\nexport function setAlphaHumanSocketState<T extends GlobalState>(\n  global: T,\n  state: AlphaHumanManagerState,\n): T {\n  return updateAlphahuman(global, {\n    socketState: state,\n  });\n}\n\nexport function setAlphaHumanLastAgentUpdate<T extends GlobalState>(\n  global: T,\n  update: GlobalState['alphahuman']['lastAgentUpdate'],\n): T {\n  return updateAlphahuman(global, {\n    lastAgentUpdate: update,\n  });\n}\n\nexport function setAlphaHumanSocketDisconnected<T extends GlobalState>(global: T): T {\n  return updateAlphahuman(global, {\n    socketState: 'disconnected',\n  });\n}\n\nexport function toggleThreadsSidebar<T extends GlobalState>(global: T): T {\n  return updateAlphahuman(global, {\n    isThreadsSidebarOpen: !global.alphahuman?.isThreadsSidebarOpen,\n  });\n}\n\n/**\n * Select an alphahuman thread by ID\n * Simply sets the activeThreadId - messages are stored in threadMessages\n */\nexport function selectAlphahumanThreadById<T extends GlobalState>(\n  global: T,\n  threadId: string,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  // Just set activeThreadId - messages are managed in threadMessages\n  return updateAlphahuman(global, {\n    activeThreadId: threadId,\n  });\n}\n\n/**\n * Ensure threads data is initialized\n * No longer needed since we use REST data directly\n */\nexport function ensureThreadsInitialized<T extends GlobalState>(global: T): T {\n  // No-op - we use REST data (threads and threadMessages) directly\n  return global;\n}\n\nexport function initializeThreadsData<T extends GlobalState>(global: T): T {\n  // No longer initializes threadsCache - we use REST data directly\n  return updateAlphahuman(global, {\n    isThreadsSidebarOpen: false,\n  });\n}\n\n// export function createNewThread<T extends GlobalState>(global: T): T {\n//   const newGlobal = ensureThreadsInitialized(global);\n//   const currentThreads = newGlobal.aiSocket!.threads!;\n\n//   const newThreadId = `thread-${Date.now()}`;\n//   const newThread = {\n//     id: newThreadId,\n//     title: 'New Conversation',\n//     lastMessage: '',\n//     timestamp: new Date(),\n//     messageCount: 0,\n//     messages: [],\n//   };\n\n//   return updateAlphaHumanSocket(newGlobal, {\n//     threads: {\n//       byId: {\n//         ...currentThreads.byId,\n//         [newThreadId]: newThread,\n//       },\n//       activeThreadId: newThreadId,\n//       orderedIds: [newThreadId, ...currentThreads.orderedIds],\n//     },\n//     isThreadsSidebarOpen: false,\n//   });\n// }\n\n/**\n * Get target thread ID\n */\nfunction getTargetThreadId<T extends GlobalState>(\n  global: T,\n  threadId: string | undefined,\n): string | undefined {\n  return threadId || global.alphahuman?.activeThreadId;\n}\n\n/**\n * Add a message to a thread (user or agent)\n * Updates threadMessages directly instead of threadsCache\n */\nexport function addMessageToAlphahumanThread<T extends GlobalState>(\n  global: T,\n  threadId: string,\n  message: AlphahumanThreadMessage,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) return global;\n\n  const targetThreadId = getTargetThreadId(global, threadId);\n  if (!targetThreadId) return global;\n\n  // Get existing thread messages or create new entry\n  const currentThreadMessages = currentState.threadMessages || {};\n  const existingMessages = currentThreadMessages[targetThreadId]?.messages || [];\n  const existingCount = currentThreadMessages[targetThreadId]?.count || 0;\n\n  // Append new message to the messages array\n  const updatedMessages = [...existingMessages, message];\n  const updatedCount = existingCount + 1;\n\n  return updateAlphahuman(global, {\n    threadMessages: {\n      ...currentThreadMessages,\n      [targetThreadId]: {\n        messages: updatedMessages,\n        count: updatedCount,\n      },\n    },\n  });\n}\n\n/**\n * Add a user message to a thread\n */\nexport function addUserMessageToAlphahumanThread<T extends GlobalState>(\n  global: T,\n  threadId: string,\n  content: string,\n): T {\n  return addMessageToAlphahumanThread(global, threadId, {\n    id: Date.now().toString(),\n    content,\n    sender: 'user',\n    type: 'text',\n    extraMetadata: {},\n    createdAt: new Date().toISOString(),\n  });\n}\n\n/**\n * Update streaming content for agent response\n */\nexport function updateStreamingContent<T extends GlobalState>(\n  global: T,\n  content: string,\n): T {\n  return updateAlphahuman(global, {\n    streamingContent: content,\n  });\n}\n\n/**\n * Clear streaming content and state\n */\nexport function clearStreamingContent<T extends GlobalState>(global: T): T {\n  return updateAlphahuman(global, {\n    streamingContent: undefined,\n    isStreaming: false,\n  });\n}\n\n/**\n * Set streaming content and state\n */\nexport function setStreamingContent<T extends GlobalState>(\n  global: T,\n  content: string,\n): T {\n  return updateAlphahuman(global, {\n    streamingContent: content,\n    isStreaming: true,\n  });\n}\n\n/**\n * Set streaming state (without content)\n */\nexport function setStreamingState<T extends GlobalState>(\n  global: T,\n  isStreaming: boolean,\n): T {\n  return updateAlphahuman(global, {\n    isStreaming,\n  });\n}\n\n/**\n * Update tool status\n */\nexport function updateToolStatus<T extends GlobalState>(\n  global: T,\n  toolName: string,\n  status: 'starting' | 'active' | 'completed',\n): T {\n  const currentTools = global.alphahuman?.activeTools || {};\n  const tool = currentTools[toolName];\n\n  if (status === 'completed' && tool) {\n    // Remove completed tool after a short delay (handled in action)\n    const updatedTools = { ...currentTools };\n    delete updatedTools[toolName];\n    return updateAlphahuman(global, {\n      activeTools: updatedTools,\n    });\n  }\n\n  return updateAlphahuman(global, {\n    activeTools: {\n      ...currentTools,\n      [toolName]: {\n        name: toolName,\n        status,\n        startTime: tool?.startTime || Date.now(),\n      },\n    },\n  });\n}\n\n/**\n * Clear all active tools\n */\nexport function clearActiveTools<T extends GlobalState>(global: T): T {\n  return updateAlphahuman(global, {\n    activeTools: undefined,\n  });\n}\n","import { resolveEventType } from '../lib/teact/dom-events';\nimport type { ElementRef } from '../lib/teact/teact';\nimport { onFullyIdle, useLayoutEffect } from '../lib/teact/teact';\n\nimport unloadVideo from '../util/browser/unloadVideo';\nimport { useStateRef } from './useStateRef';\n\n// Fix memory leak when unmounting video element\nexport default function useVideoCleanup(\n  videoRef: ElementRef<HTMLVideoElement>, handlers?: Record<string, AnyFunction>,\n) {\n  const handlersRef = useStateRef(handlers);\n\n  useLayoutEffect(() => {\n    const videoEl = videoRef.current;\n    if (!videoEl) return undefined;\n\n    return () => {\n      // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n      const handlers2 = handlersRef.current;\n      if (handlers2) {\n        Object.entries(handlers2).forEach(([key, value]) => {\n          videoEl.removeEventListener(resolveEventType(key, videoEl), value, false);\n        });\n      }\n\n      // It may be slow (specifically on iOS), so we postpone it after unmounting\n      onFullyIdle(() => {\n        unloadVideo(videoEl);\n      });\n    };\n  }, [handlersRef, videoRef]);\n}\n","import { useRef } from '../lib/teact/teact';\n\n/**\n * @deprecated\n */\nfunction usePreviousDeprecated<T>(next: T): T | undefined;\nfunction usePreviousDeprecated<T>(next: T, shouldSkipUndefined: true): Exclude<T, undefined> | undefined;\n\nfunction usePreviousDeprecated<T>(next: T, shouldSkipUndefined?: boolean): Exclude<T, undefined> | undefined;\nfunction usePreviousDeprecated<T>(next: T, shouldSkipUndefined?: boolean) {\n  const ref = useRef<T>();\n  const { current } = ref;\n  if (!shouldSkipUndefined || next !== undefined) {\n    ref.current = next;\n  }\n\n  return current;\n}\n\nexport default usePreviousDeprecated;\n","import type { ApiPeerColors } from '../api/types';\n\nimport { PEER_COLOR_BG_ACTIVE_OPACITY, PEER_COLOR_BG_OPACITY, PEER_COLOR_GRADIENT_STEP } from '../config';\nimport { fastRaf } from './schedulers';\n\nconst GENERAL_VARIABLES = new Map<string, string>();\nconst LIGHT_VARIABLES = new Map<string, string>();\nconst DARK_VARIABLES = new Map<string, string>();\n\nconst style = document.createElement('style');\ndocument.head.appendChild(style);\n\nexport function setVariable(name: string, generalValue: string): void;\nexport function setVariable(name: string, lightValue: string, darkValue?: string): void;\nexport function setVariable(name: string, lightValueOrGeneral: string, darkValue?: string) {\n  if (!darkValue) {\n    GENERAL_VARIABLES.set(name, lightValueOrGeneral);\n    LIGHT_VARIABLES.delete(name);\n    DARK_VARIABLES.delete(name);\n  } else {\n    GENERAL_VARIABLES.delete(name);\n    LIGHT_VARIABLES.set(name, lightValueOrGeneral);\n    DARK_VARIABLES.set(name, darkValue);\n  }\n\n  scheduleVariableUpdate();\n}\n\nlet isUpdateScheduled = false;\nfunction scheduleVariableUpdate() {\n  if (isUpdateScheduled) return;\n  isUpdateScheduled = true;\n  fastRaf(updateVariables);\n}\n\nfunction updateVariables() {\n  const generalVariables = buildVariables(GENERAL_VARIABLES);\n  const lightVariables = buildVariables(LIGHT_VARIABLES);\n  const darkVariables = buildVariables(DARK_VARIABLES);\n\n  style.textContent = `\n    html {\n      ${generalVariables}\n    }\n\n    html.theme-light {\n      ${lightVariables}\n    }\n\n    html.theme-dark {\n      ${darkVariables}\n    }\n  `;\n}\n\nfunction buildVariables(map: Map<string, string>) {\n  return Array.from(map.entries()).map(([name, value]) => `--${name}: ${value};`).join(' ');\n}\n\nexport function updatePeerColors(\n  peerColors: ApiPeerColors['general'],\n) {\n  setPeerColor('0', ['#D45246']);\n  setPeerColor('1', ['#F68136']);\n  setPeerColor('2', ['#6C61DF']);\n  setPeerColor('3', ['#46BA43']);\n  setPeerColor('4', ['#5CAFFA']);\n  setPeerColor('5', ['#408ACF']);\n  setPeerColor('6', ['#D95574']);\n\n  Object.entries(peerColors).forEach(([key, value]) => {\n    if (!value.colors) return;\n    setPeerColor(key, value.colors, value.darkColors);\n  });\n}\n\nfunction setPeerColor(n: string, colors: string[], darkColors?: string[]) {\n  const mainLightColor = colors[0];\n  const mainDarkColor = darkColors?.[0];\n  if (!mainLightColor) return;\n\n  const { bg: lightBgColor, bgActive: lightBgActiveColor } = generateColorVariations(mainLightColor);\n  const { bg: darkBgColor, bgActive: darkBgActiveColor } = mainDarkColor\n    ? generateColorVariations(mainDarkColor) : { bg: undefined, bgActive: undefined };\n\n  setVariable(`color-peer-${n}`, mainLightColor, mainDarkColor);\n  setVariable(`color-peer-bg-${n}`, lightBgColor, darkBgColor);\n  setVariable(`color-peer-bg-active-${n}`, lightBgActiveColor, darkBgActiveColor);\n\n  if (colors.length > 1) {\n    const lightGradient = generatePeerColorGradient(colors);\n    const darkGradient = darkColors ? generatePeerColorGradient(darkColors) : undefined;\n    setVariable(`color-peer-gradient-${n}`, lightGradient, darkGradient);\n  }\n}\n\nexport function generateColorVariations(baseColor: string) {\n  return {\n    bg: `${baseColor}${PEER_COLOR_BG_OPACITY}`,\n    bgActive: `${baseColor}${PEER_COLOR_BG_ACTIVE_OPACITY}`,\n  };\n}\n\nexport function generatePeerColorGradient(colors: string[]) {\n  if (colors.length === 1) return colors[0];\n\n  const gradientColors = colors.map((color, i) => (\n    `${color} ${i * PEER_COLOR_GRADIENT_STEP}px, ${color} ${(i + 1) * PEER_COLOR_GRADIENT_STEP}px`\n  ));\n\n  return `repeating-linear-gradient(-45deg, ${gradientColors.join(', ')})`;\n}\n","import { ACCOUNT_SLOT } from './multiaccount';\n\nconst cacheApi = self.caches;\n\nconst SUFFIX = ACCOUNT_SLOT ? `_${ACCOUNT_SLOT}` : '';\n\nlet isSupported: boolean | undefined;\n\nexport async function isCacheApiSupported() {\n  if (!cacheApi) return false;\n\n  isSupported = isSupported ?? await cacheApi.has('test').then(() => true).catch(() => false);\n  return isSupported;\n}\n\nexport enum Type {\n  Text,\n  Blob,\n  Json,\n  ArrayBuffer,\n}\n\nexport async function fetch(\n  cacheName: string, key: string, type: Type, isHtmlAllowed = false,\n) {\n  if (!cacheApi) {\n    return undefined;\n  }\n\n  try {\n    // To avoid the error \"Request scheme 'webdocument' is unsupported\"\n    const request = new Request(key.replace(/:/g, '_'));\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    const response = await cache.match(request);\n    if (!response) {\n      return undefined;\n    }\n\n    const contentType = response.headers.get('Content-Type');\n\n    switch (type) {\n      case Type.Text:\n        return await response.text();\n      case Type.Blob: {\n        // Ignore deprecated data-uri avatars\n        if (key.startsWith('avatar') && contentType && contentType.startsWith('text')) {\n          return undefined;\n        }\n\n        const blob = await response.blob();\n        const shouldRecreate = !blob.type || (!isHtmlAllowed && blob.type.includes('html'));\n        // iOS Safari fails to preserve `type` in cache\n        let resolvedType = blob.type || contentType;\n\n        if (!(shouldRecreate && resolvedType)) {\n          return blob;\n        }\n\n        // Prevent HTML-in-video attacks (for files that were cached before fix)\n        if (!isHtmlAllowed) {\n          resolvedType = resolvedType.replace(/html/gi, '');\n        }\n\n        return new Blob([blob], { type: resolvedType });\n      }\n      case Type.Json:\n        return await response.json();\n      case Type.ArrayBuffer:\n        return await response.arrayBuffer();\n      default:\n        return undefined;\n    }\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n\nexport async function save(cacheName: string, key: string, data: AnyLiteral | Blob | ArrayBuffer | string) {\n  if (!cacheApi) {\n    return false;\n  }\n\n  try {\n    const cacheData = typeof data === 'string' || data instanceof Blob || data instanceof ArrayBuffer\n      ? data\n      : JSON.stringify(data);\n    // To avoid the error \"Request scheme 'webdocument' is unsupported\"\n    const request = new Request(key.replace(/:/g, '_'));\n    const response = new Response(cacheData);\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    await cache.put(request, response);\n\n    return true;\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return false;\n  }\n}\n\nexport async function remove(cacheName: string, key: string) {\n  try {\n    if (!cacheApi) {\n      return undefined;\n    }\n\n    const cache = await cacheApi.open(`${cacheName}${SUFFIX}`);\n    return await cache.delete(key);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n\nexport async function clear(cacheName: string) {\n  try {\n    if (!cacheApi) {\n      return undefined;\n    }\n\n    return await cacheApi.delete(`${cacheName}${SUFFIX}`);\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.warn(err);\n    return undefined;\n  }\n}\n","// https://gist.github.com/paulirish/5d52fb081b3570c81e3a\n\nexport default {\n  Element: {\n    props: [\n      'clientLeft', 'clientTop', 'clientWidth', 'clientHeight',\n      'scrollWidth', 'scrollHeight', 'scrollLeft', 'scrollTop',\n    ] as const,\n    methods: [\n      'getClientRects', 'getBoundingClientRect',\n      'scrollBy', 'scrollTo', 'scrollIntoView', 'scrollIntoViewIfNeeded',\n    ] as const,\n  },\n  HTMLElement: {\n    props: [\n      'offsetLeft', 'offsetTop', 'offsetWidth', 'offsetHeight', 'offsetParent',\n      'innerText',\n    ] as const,\n    methods: ['focus'] as const,\n  },\n  window: {\n    props: [\n      'scrollX', 'scrollY',\n      'innerHeight', 'innerWidth',\n    ] as const,\n    methods: ['getComputedStyle'] as const,\n  },\n  VisualViewport: {\n    props: [\n      'height', 'width', 'offsetTop', 'offsetLeft',\n    ] as const,\n  },\n  Document: {\n    props: ['scrollingElement'] as const,\n    methods: ['elementFromPoint'] as const,\n  },\n  HTMLInputElement: {\n    methods: ['select'] as const,\n  },\n  MouseEvent: {\n    props: ['layerX', 'layerY', 'offsetX', 'offsetY'] as const,\n  },\n  Range: {\n    methods: ['getClientRects', 'getBoundingClientRect'] as const,\n  },\n};\n","import LAYOUT_CAUSES from './layoutCauses';\n\ntype Entities = keyof typeof LAYOUT_CAUSES;\ntype Phase =\n  'measure'\n  | 'mutate';\ntype ErrorHandler = (error: Error) => any;\n\n// eslint-disable-next-line no-console\nconst DEFAULT_ERROR_HANDLER = console.error;\n\nlet onError: ErrorHandler = DEFAULT_ERROR_HANDLER;\n\nconst nativeMethods = new Map<string, AnyFunction>();\n\nlet phase: Phase = 'measure';\nlet isStrict = false;\nlet observer: MutationObserver | undefined;\n\nexport function setPhase(newPhase: Phase) {\n  phase = newPhase;\n}\n\nexport function getPhase() {\n  return phase;\n}\n\nexport function enableStrict() {\n  if (isStrict) return;\n\n  isStrict = true;\n  setupLayoutDetectors();\n  setupMutationObserver();\n}\n\nexport function disableStrict() {\n  if (!isStrict) return;\n\n  clearMutationObserver();\n  clearLayoutDetectors();\n  isStrict = false;\n}\n\nexport function forceMeasure(cb: () => any) {\n  if (phase !== 'mutate') {\n    throw new Error('The current phase is \\'measure\\'');\n  }\n\n  phase = 'measure';\n  const result = cb();\n  phase = 'mutate';\n\n  return result;\n}\n\nconst forcedMutationAllowedFor = new Set<Node>();\n\nexport function forceMutation(cb: () => any, nodes: Node | Node[]) {\n  if (phase !== 'measure') {\n    throw new Error('The current phase is \\'mutate\\'');\n  }\n\n  if (isStrict) {\n    if (Array.isArray(nodes)) {\n      nodes.forEach((node) => {\n        forcedMutationAllowedFor.add(node);\n      });\n    } else {\n      forcedMutationAllowedFor.add(nodes);\n    }\n  }\n\n  return cb();\n}\n\nexport function suppressStrict(cb: () => any) {\n  if (!isStrict) {\n    return cb();\n  }\n\n  disableStrict();\n  const result = cb();\n  enableStrict();\n  return result;\n}\n\nexport function setHandler(handler?: ErrorHandler) {\n  onError = handler || DEFAULT_ERROR_HANDLER;\n}\n\nfunction setupLayoutDetectors() {\n  Object.entries(LAYOUT_CAUSES).forEach(([name, causes]) => {\n    const entity = window[name as Entities];\n    if (!entity) return;\n    const prototype = typeof entity === 'object' ? entity : entity.prototype;\n\n    if ('props' in causes) {\n      causes.props.forEach((prop) => {\n        const nativeGetter = Object.getOwnPropertyDescriptor(prototype, prop)?.get;\n        if (!nativeGetter) {\n          return;\n        }\n\n        nativeMethods.set(`${name}#${prop}`, nativeGetter);\n\n        Object.defineProperty(prototype, prop, {\n          get() {\n            onMeasure(prop);\n\n            return nativeGetter.call(this);\n          },\n        });\n      });\n    }\n\n    if ('methods' in causes) {\n      causes.methods.forEach((method) => {\n        const nativeMethod = (prototype as any)[method]!;\n        nativeMethods.set(`${name}#${method}`, nativeMethod);\n\n        (prototype as any)[method] = function (...args: any[]) {\n          onMeasure(method);\n\n          return nativeMethod.apply(this, args);\n        };\n      });\n    }\n  });\n}\n\nfunction clearLayoutDetectors() {\n  Object.entries(LAYOUT_CAUSES).forEach(([name, causes]) => {\n    const entity = window[name as Entities];\n    if (!entity) return;\n    const prototype = typeof entity === 'object' ? entity : entity.prototype;\n\n    if ('props' in causes) {\n      causes.props.forEach((prop) => {\n        const nativeGetter = nativeMethods.get(`${name}#${prop}`);\n        if (!nativeGetter) {\n          return;\n        }\n\n        Object.defineProperty(prototype, prop, { get: nativeGetter });\n      });\n    }\n\n    if ('methods' in causes) {\n      causes.methods.forEach((method) => {\n        (prototype as any)[method] = nativeMethods.get(`${name}#${method}`)!;\n      });\n    }\n  });\n\n  nativeMethods.clear();\n}\n\nfunction setupMutationObserver() {\n  observer = new MutationObserver((mutations) => {\n    if (phase !== 'mutate') {\n      mutations.forEach(({ target, type, attributeName }) => {\n        if (!document.contains(target)) {\n          return;\n        }\n\n        if (forcedMutationAllowedFor.has(target)) {\n          return;\n        }\n\n        if (type === 'childList' && target instanceof HTMLElement && target.contentEditable) {\n          return;\n        }\n\n        if (attributeName?.startsWith('data-')) {\n          return;\n        }\n\n        onError(new Error(`Unexpected mutation detected: \\`${type === 'attributes' ? attributeName : type}\\``));\n      });\n    }\n\n    forcedMutationAllowedFor.clear();\n  });\n\n  observer.observe(document.body, {\n    childList: true,\n    attributes: true,\n    subtree: true,\n    characterData: false,\n  });\n}\n\nfunction clearMutationObserver() {\n  observer?.disconnect();\n  observer = undefined;\n}\n\nfunction onMeasure(propName: string) {\n  if (phase !== 'measure') {\n    onError(new Error(`Unexpected measurement detected: \\`${propName}\\``));\n  }\n}\n","import type {\n  ApiDimensions, ApiMediaExtendedPreview, ApiPhoto, ApiSticker, ApiVideo,\n} from '../../../api/types';\n\nimport { STICKER_SIZE_INLINE_DESKTOP_FACTOR, STICKER_SIZE_INLINE_MOBILE_FACTOR } from '../../../config';\nimport { getPhotoInlineDimensions, getVideoDimensions } from '../../../global/helpers';\nimport { IS_TOUCH_ENV } from '../../../util/browser/windowEnvironment';\nimport windowSize from '../../../util/windowSize';\n\nexport const MEDIA_VIEWER_MEDIA_QUERY = '(max-height: 640px)';\nexport const REM = parseInt(getComputedStyle(document.documentElement).fontSize, 10);\nexport const ROUND_VIDEO_DIMENSIONS_PX = 240;\nexport const GIF_MIN_WIDTH = 300;\nexport const AVATAR_FULL_DIMENSIONS = { width: 640, height: 640 };\nexport const VIDEO_AVATAR_FULL_DIMENSIONS = { width: 800, height: 800 };\nexport const LIKE_STICKER_ID = '4986041492570112461';\n\nconst DEFAULT_MEDIA_DIMENSIONS: ApiDimensions = { width: 100, height: 100 };\nconst MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM = 4.5;\nconst MOBILE_SCREEN_MESSAGE_EXTRA_WIDTH_REM = 7;\nconst MESSAGE_MAX_WIDTH_REM = 29;\nconst MESSAGE_OWN_MAX_WIDTH_REM = 30;\n\nlet cachedMaxWidthOwn: number | undefined;\nlet cachedMaxWidth: number | undefined;\nlet cachedMaxWidthNoAvatar: number | undefined;\n\nfunction getMaxMessageWidthRem(fromOwnMessage?: boolean, noAvatars?: boolean, isMobile?: boolean) {\n  const regularMaxWidth = fromOwnMessage ? MESSAGE_OWN_MAX_WIDTH_REM : MESSAGE_MAX_WIDTH_REM;\n  if (!isMobile) {\n    return regularMaxWidth;\n  }\n\n  const { width: windowWidth } = windowSize.get();\n\n  // @optimization Limitation: changing device screen width not supported\n  if (!cachedMaxWidthOwn) {\n    cachedMaxWidthOwn = Math.min(\n      MESSAGE_OWN_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n  if (!cachedMaxWidth) {\n    cachedMaxWidth = Math.min(\n      MESSAGE_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n  if (!cachedMaxWidthNoAvatar) {\n    cachedMaxWidthNoAvatar = Math.min(\n      MESSAGE_MAX_WIDTH_REM,\n      windowWidth / REM - MOBILE_SCREEN_NO_AVATARS_MESSAGE_EXTRA_WIDTH_REM,\n    );\n  }\n\n  return fromOwnMessage\n    ? cachedMaxWidthOwn\n    : (noAvatars ? cachedMaxWidthNoAvatar : cachedMaxWidth);\n}\n\nexport function getAvailableWidth(\n  fromOwnMessage?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const extraPaddingRem = isWebPageMedia ? 1.625 : 0;\n  const availableWidthRem = getMaxMessageWidthRem(fromOwnMessage, noAvatars, isMobile) - extraPaddingRem;\n\n  return availableWidthRem * REM;\n}\n\nfunction getAvailableHeight(isGif?: boolean, aspectRatio?: number) {\n  if (\n    isGif && aspectRatio\n    && aspectRatio >= 0.75 && aspectRatio <= 1.25\n  ) {\n    return 20 * REM;\n  }\n\n  return 27 * REM;\n}\n\nexport function calculateDimensionsForMessageMedia({\n  width,\n  height,\n  fromOwnMessage,\n  isWebPageMedia,\n  isGif,\n  noAvatars,\n  isMobile,\n}: {\n  width: number;\n  height: number;\n  fromOwnMessage?: boolean;\n  asForwarded?: boolean;\n  isWebPageMedia?: boolean;\n  isGif?: boolean;\n  noAvatars?: boolean;\n  isMobile?: boolean;\n}): ApiDimensions {\n  const aspectRatio = height / width;\n  const availableWidth = getAvailableWidth(fromOwnMessage, isWebPageMedia, noAvatars, isMobile);\n  const availableHeight = getAvailableHeight(isGif, aspectRatio);\n  const mediaWidth = isGif ? Math.max(GIF_MIN_WIDTH, width) : width;\n  const mediaHeight = isGif ? height * (mediaWidth / width) : height;\n\n  return calculateDimensions(availableWidth, availableHeight, mediaWidth, mediaHeight);\n}\n\nexport function getMediaViewerAvailableDimensions(withFooter: boolean, isVideo: boolean): ApiDimensions {\n  const mql = window.matchMedia(MEDIA_VIEWER_MEDIA_QUERY);\n  const { width: windowWidth, height: windowHeight } = windowSize.get();\n  let occupiedHeightRem = isVideo && mql.matches ? 10 : 8.25;\n  if (withFooter && !IS_TOUCH_ENV) {\n    occupiedHeightRem = mql.matches ? 10 : 12.5;\n  }\n  return {\n    width: windowWidth,\n    height: windowHeight - occupiedHeightRem * REM,\n  };\n}\n\nexport function calculateInlineImageDimensions(\n  photo: ApiPhoto,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width, height } = getPhotoInlineDimensions(photo) || DEFAULT_MEDIA_DIMENSIONS;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function calculateVideoDimensions(\n  video: ApiVideo,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width, height } = getVideoDimensions(video) || DEFAULT_MEDIA_DIMENSIONS;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    isGif: video.isGif,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function calculateExtendedPreviewDimensions(\n  preview: ApiMediaExtendedPreview,\n  fromOwnMessage?: boolean,\n  asForwarded?: boolean,\n  isWebPageMedia?: boolean,\n  noAvatars?: boolean,\n  isMobile?: boolean,\n) {\n  const { width = DEFAULT_MEDIA_DIMENSIONS.width, height = DEFAULT_MEDIA_DIMENSIONS.height } = preview;\n\n  return calculateDimensionsForMessageMedia({\n    width,\n    height,\n    fromOwnMessage,\n    asForwarded,\n    isWebPageMedia,\n    noAvatars,\n    isMobile,\n  });\n}\n\nexport function getPictogramDimensions(): ApiDimensions {\n  return {\n    width: 2 * REM,\n    height: 2 * REM,\n  };\n}\n\nexport function getDocumentThumbnailDimensions(smaller?: boolean): ApiDimensions {\n  if (smaller) {\n    return {\n      width: 3 * REM,\n      height: 3 * REM,\n    };\n  }\n\n  return {\n    width: 3.375 * REM,\n    height: 3.375 * REM,\n  };\n}\n\nexport function getStickerDimensions(sticker: ApiSticker, isMobile?: boolean): ApiDimensions {\n  const { width } = sticker;\n  let { height } = sticker;\n\n  // For some reason this sticker has some weird `height` value\n  if (sticker.id === LIKE_STICKER_ID) {\n    height = width;\n  }\n\n  const aspectRatio = (height && width) && height / width;\n  const baseWidth = REM * (\n    isMobile\n      ? STICKER_SIZE_INLINE_MOBILE_FACTOR\n      : STICKER_SIZE_INLINE_DESKTOP_FACTOR\n  );\n  const calculatedHeight = aspectRatio ? baseWidth * aspectRatio : baseWidth;\n\n  if (aspectRatio && calculatedHeight > baseWidth) {\n    return {\n      width: Math.round(baseWidth / aspectRatio),\n      height: baseWidth,\n    };\n  }\n\n  return {\n    width: baseWidth,\n    height: calculatedHeight,\n  };\n}\n\nexport function calculateMediaViewerDimensions(\n  { width, height }: ApiDimensions, withFooter: boolean, isVideo: boolean = false,\n): ApiDimensions {\n  const { width: availableWidth, height: availableHeight } = getMediaViewerAvailableDimensions(withFooter, isVideo);\n\n  return calculateDimensions(availableWidth, availableHeight, width, height);\n}\n\nexport function calculateDimensions(\n  availableWidth: number,\n  availableHeight: number,\n  mediaWidth: number,\n  mediaHeight: number,\n): ApiDimensions {\n  const aspectRatio = mediaHeight / mediaWidth;\n  const calculatedWidth = Math.min(mediaWidth, availableWidth);\n  const calculatedHeight = Math.round(calculatedWidth * aspectRatio);\n\n  if (calculatedHeight > availableHeight) {\n    return {\n      width: Math.round(availableHeight / aspectRatio),\n      height: availableHeight,\n    };\n  }\n\n  return {\n    width: calculatedWidth,\n    height: Math.round(calculatedWidth * aspectRatio),\n  };\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"A72KeAmh\",\"icon\":\"eLEPgwPj\",\"title\":\"ZQJO2BKn\"};","import type { FC } from '../../lib/teact/teact';\nimport { memo } from '../../lib/teact/teact';\n\nimport type { ThreadId } from '../../types';\n\nimport { GENERAL_TOPIC_ID } from '../../config';\nimport buildClassName from '../../util/buildClassName';\nimport { getTopicDefaultIcon } from '../../util/forumColors';\nimport { getFirstLetters } from '../../util/textFormat';\nimport renderText from './helpers/renderText';\n\nimport Icon from './icons/Icon';\n\nimport styles from './TopicDefaultIcon.module.scss';\n\ntype OwnProps = {\n  className?: string;\n  letterClassName?: string;\n  topicId: ThreadId;\n  iconColor?: number;\n  title: string;\n  onClick?: NoneToVoidFunction;\n};\n\nconst TopicDefaultIcon: FC<OwnProps> = ({\n  className,\n  letterClassName,\n  topicId,\n  iconColor,\n  title,\n  onClick,\n}) => {\n  const iconSrc = getTopicDefaultIcon(iconColor);\n\n  if (topicId === GENERAL_TOPIC_ID) {\n    return (\n      <Icon\n        name=\"hashtag\"\n        className={buildClassName(styles.root, className, 'general-forum-icon')}\n        onClick={onClick}\n      />\n    );\n  }\n  return (\n    <div className={buildClassName(styles.root, className)} onClick={onClick}>\n      <img className={styles.icon} src={iconSrc} alt=\"\" draggable={false} />\n      <div className={buildClassName(styles.title, letterClassName, 'topic-icon-letter')}>\n        {renderText(getFirstLetters(title, 1))}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(TopicDefaultIcon);\n","import type {\n  ApiAttachment,\n  ApiAudio,\n  ApiDimensions,\n  ApiDocument,\n  ApiGame,\n  ApiLocation,\n  ApiMediaExtendedPreview,\n  ApiMessage,\n  ApiMessageSearchType,\n  ApiPhoto,\n  ApiSticker,\n  ApiVideo,\n  ApiVoice,\n  ApiWebDocument,\n  ApiWebPage,\n  MediaContainer,\n  SizeTarget,\n  StatefulMediaContent,\n} from '../../api/types';\nimport type { ActiveDownloads } from '../../types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport {\n  IS_OPFS_SUPPORTED,\n  IS_OPUS_SUPPORTED,\n  IS_PROGRESSIVE_SUPPORTED,\n  IS_SAFARI,\n  MAX_BUFFER_SIZE,\n} from '../../util/browser/windowEnvironment';\nimport { getDocumentHasPreview } from '../../components/common/helpers/documentInfo';\nimport { getAttachmentMediaType, matchLinkInMessageText } from './messages';\n\nexport type MediaWithThumbs = ApiPhoto | ApiVideo | ApiDocument | ApiSticker | ApiMediaExtendedPreview;\nexport type DownloadableMedia = ApiPhoto | ApiVideo | ApiDocument | ApiSticker | ApiAudio | ApiVoice | ApiWebDocument;\n\nexport function getMessageContent(message: MediaContainer) {\n  return message.content;\n}\n\nexport function hasMessageMedia(message: MediaContainer) {\n  return Boolean((\n    getMessagePhoto(message)\n    || getMessageVideo(message)\n    || getMessageDocument(message)\n    || getMessageSticker(message)\n    || getMessageContact(message)\n    || getMessagePollId(message)\n    || getMessageTodo(message)\n    || getMessageAction(message)\n    || getMessageAudio(message)\n    || getMessageVoice(message)\n  ));\n}\n\nexport function canEditMedia(message: MediaContainer) {\n  const {\n    video, ...otherMedia\n  } = message.content;\n\n  return !video?.isRound && !Object.keys(otherMedia).length;\n}\n\nexport function getMessagePhoto(message: MediaContainer) {\n  return message.content.photo;\n}\n\nexport function getMessageActionPhoto(message: MediaContainer) {\n  return message.content.action?.type === 'suggestProfilePhoto' ? message.content.action.photo : undefined;\n}\n\nexport function getMessageVideo(message: MediaContainer) {\n  return message.content.video;\n}\n\nexport function getMessageRoundVideo(message: MediaContainer) {\n  const { video } = message.content;\n\n  return video?.isRound ? video : undefined;\n}\n\nexport function getMessageAction(message: MediaContainer) {\n  return message.content.action;\n}\n\nexport function getMessageAudio(message: MediaContainer) {\n  return message.content.audio;\n}\n\nexport function getMessageVoice(message: MediaContainer) {\n  return message.content.voice;\n}\n\nexport function getMessageSticker(message: MediaContainer) {\n  return message.content.sticker;\n}\n\nexport function getMessageDocument(message: MediaContainer) {\n  return message.content.document;\n}\n\nexport function isDocumentPhoto(document: ApiDocument) {\n  return document.innerMediaType === 'photo';\n}\n\nexport function isDocumentVideo(document: ApiDocument) {\n  return document.innerMediaType === 'video';\n}\n\nexport function isMessageDocumentSticker(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document ? document.mimeType === 'image/webp' : undefined;\n}\n\nexport function getMessageContact(message: MediaContainer) {\n  return message.content.contact;\n}\n\nexport function getMessagePollId(message: MediaContainer) {\n  return message.content.pollId;\n}\n\nexport function getMessageTodo(message: MediaContainer) {\n  return message.content.todo;\n}\n\nexport function getMessageInvoice(message: MediaContainer) {\n  return message.content.invoice;\n}\n\nexport function getMessageLocation(message: MediaContainer) {\n  return message.content.location;\n}\n\nexport function getMessageWebPage(message: MediaContainer) {\n  return message.content.webPage;\n}\n\nexport function getMessagePaidMedia(message: MediaContainer) {\n  return message.content.paidMedia;\n}\n\nexport function getMessageDocumentPhoto(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document && isDocumentPhoto(document) ? document : undefined;\n}\n\nexport function getWebPagePhoto(webPage?: ApiWebPage) {\n  return webPage?.webpageType === 'full' ? webPage.photo : undefined;\n}\n\nexport function getWebPageVideo(webPage?: ApiWebPage) {\n  return webPage?.webpageType === 'full' ? webPage.video : undefined;\n}\n\nexport function getWebPageAudio(webPage?: ApiWebPage) {\n  return webPage?.webpageType === 'full' ? webPage.audio : undefined;\n}\n\nexport function getWebPageDocument(webPage?: ApiWebPage) {\n  return webPage?.webpageType === 'full' ? webPage.document : undefined;\n}\n\nexport function getMessageDocumentVideo(message: MediaContainer) {\n  const document = getMessageDocument(message);\n  return document && isDocumentVideo(document) ? document : undefined;\n}\n\nexport function getMediaThumbUri(media: MediaWithThumbs) {\n  return media.thumbnail?.dataUri;\n}\n\nexport function getMessageIsSpoiler(message: MediaContainer) {\n  const media = getMessagePhoto(message)\n    || getMessageVideo(message);\n\n  const invoiceMedia = getMessageInvoice(message)?.extendedMedia;\n  return Boolean(invoiceMedia || media?.isSpoiler);\n}\n\nexport function buildStaticMapHash(\n  geo: ApiLocation['geo'],\n  width: number,\n  height: number,\n  zoom: number,\n  scale: number,\n) {\n  const {\n    long, lat, accessHash, accuracyRadius,\n  } = geo;\n\n  // eslint-disable-next-line @stylistic/max-len\n  return `staticMap:${accessHash}?lat=${lat}&long=${long}&w=${width}&h=${height}&zoom=${zoom}&scale=${scale}&accuracyRadius=${accuracyRadius}`;\n}\n\nexport function getPhotoMediaHash(photo: ApiPhoto | ApiDocument, target: SizeTarget, isAction?: boolean) {\n  const base = `photo${photo.id}`;\n  const isVideo = photo.mediaType === 'photo' && photo.isVideo;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return `${base}?size=${isAction ? 'a' : 'm'}`;\n    case 'inline':\n      return !hasMediaLocalBlobUrl(photo) ? `${base}?size=${isAction ? 'b' : 'x'}` : undefined;\n    case 'preview':\n      return `${base}?size=${isAction ? 'b' : 'x'}`;\n    case 'download':\n      return !isVideo ? base : getVideoProfilePhotoMediaHash(photo);\n    case 'full':\n    default:\n      return base;\n  }\n}\n\nexport function getProfilePhotoMediaHash(photo: ApiPhoto) {\n  return `photo${photo.id}?size=c`;\n}\n\nexport function getVideoProfilePhotoMediaHash(photo: ApiPhoto) {\n  if (!photo.isVideo) return undefined;\n  return `photo${photo.id}?size=u`;\n}\n\nexport function getVideoMediaHash(video: ApiVideo | ApiDocument, target: SizeTarget) {\n  const base = `document${video.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return `${base}?size=m`;\n    case 'inline':\n      return !hasMediaLocalBlobUrl(video) ? appendProgressiveQueryParameters(video, base) : undefined;\n    case 'preview':\n      return `${base}?size=x`;\n    case 'download':\n      return `${base}?download`;\n    case 'full':\n    default:\n      return appendProgressiveQueryParameters(video, base);\n  }\n}\n\nexport function getVideoPreviewMediaHash(video: ApiVideo) {\n  return video.hasVideoPreview ? `document${video.id}?size=v` : undefined;\n}\n\nexport function getDocumentMediaHash(document: ApiDocument, target: SizeTarget) {\n  const base = `document${document.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n    case 'inline':\n    case 'preview':\n      if (!getDocumentHasPreview(document) || hasMediaLocalBlobUrl(document)) {\n        return undefined;\n      }\n\n      return `${base}?size=m`;\n    case 'full':\n    case 'download':\n    default:\n      return base;\n  }\n}\n\nexport function getAudioMediaHash(audio: ApiAudio, target: SizeTarget) {\n  const base = `document${audio.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return getAudioHasCover(audio) ? `${base}?size=m` : undefined;\n    case 'inline':\n      return appendProgressiveQueryParameters(audio, base);\n    case 'download':\n      return `${base}?download`;\n    default:\n      return base;\n  }\n}\n\nexport function getVoiceMediaHash(voice: ApiVoice, target: SizeTarget) {\n  const base = `document${voice.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      return undefined;\n    case 'download':\n      return `${base}?download`;\n    case 'inline':\n    default:\n      return base;\n  }\n}\n\nexport function getWebDocumentHash(webDocument?: ApiWebDocument) {\n  if (!webDocument) return undefined;\n  return `webDocument:${webDocument.url}`;\n}\n\nexport function getStickerMediaHash(sticker: ApiSticker, target: SizeTarget) {\n  const base = `document${sticker.id}`;\n\n  switch (target) {\n    case 'micro':\n    case 'pictogram':\n      if (!sticker.previewPhotoSizes?.some((size) => size.type === 's')) {\n        return getStickerMediaHash(sticker, 'preview');\n      }\n      return `${base}?size=s`;\n    case 'preview':\n      return `${base}?size=m`;\n    case 'download':\n      return `${base}?download`;\n    case 'inline':\n    default:\n      return base;\n  }\n}\n\nexport function getMediaHash(media: DownloadableMedia, target: SizeTarget) {\n  switch (media.mediaType) {\n    case 'photo':\n      return getPhotoMediaHash(media, target);\n    case 'video':\n      return getVideoMediaHash(media, target);\n    case 'document':\n      return getDocumentMediaHash(media, target);\n    case 'audio':\n      return getAudioMediaHash(media, target);\n    case 'voice':\n      return getVoiceMediaHash(media, target);\n    case 'sticker':\n      return getStickerMediaHash(media, target);\n    case 'webDocument':\n      return getWebDocumentHash(media);\n    default:\n      return undefined;\n  }\n}\n\nexport function getGamePreviewPhotoHash(game: ApiGame) {\n  const { photo } = game;\n\n  if (photo) {\n    return `photo${photo.id}?size=x`;\n  }\n\n  return undefined;\n}\n\nexport function getGamePreviewVideoHash(game: ApiGame) {\n  const { document } = game;\n\n  if (document) {\n    return `document${document.id}`;\n  }\n\n  return undefined;\n}\n\nexport function appendProgressiveQueryParameters(media: ApiAudio | ApiVideo | ApiDocument, base: string) {\n  if (IS_PROGRESSIVE_SUPPORTED && IS_SAFARI) {\n    const url = new URL(base, window.location.href);\n    url.searchParams.append('fileSize', media.size.toString());\n    url.searchParams.append('mimeType', media.mimeType);\n    return url.toString();\n  }\n\n  return base;\n}\n\nexport function getAudioHasCover(media: ApiAudio) {\n  return media.thumbnailSizes && media.thumbnailSizes.length > 0;\n}\n\nexport function getMediaFormat(\n  media: DownloadableMedia, target: SizeTarget,\n): ApiMediaFormat {\n  const isDocument = media.mediaType === 'document';\n  const hasInnerVideo = isDocument && media.innerMediaType === 'video';\n  const isVideo = media.mediaType === 'video' || hasInnerVideo;\n  const isAudio = media.mediaType === 'audio';\n  const isVoice = media.mediaType === 'voice';\n\n  const size = getMediaFileSize(media) || 0; // Media types that do not have `size` are smaller than `MAX_BUFFER_SIZE`\n\n  if (target === 'download') {\n    if (IS_PROGRESSIVE_SUPPORTED && size > MAX_BUFFER_SIZE && !IS_OPFS_SUPPORTED) {\n      return ApiMediaFormat.DownloadUrl;\n    }\n    return ApiMediaFormat.BlobUrl;\n  }\n\n  if (isVideo && IS_PROGRESSIVE_SUPPORTED && (\n    target === 'full' || target === 'inline'\n  )) {\n    return ApiMediaFormat.Progressive;\n  }\n\n  if (isAudio || isVoice) {\n    // Safari\n    if (isVoice && !IS_OPUS_SUPPORTED) {\n      return ApiMediaFormat.BlobUrl;\n    }\n\n    return ApiMediaFormat.Progressive;\n  }\n\n  return ApiMediaFormat.BlobUrl;\n}\n\nexport function getMediaFileSize(media: DownloadableMedia) {\n  return 'size' in media ? media.size : undefined;\n}\n\nexport function hasMediaLocalBlobUrl(media: ApiPhoto | ApiVideo | ApiDocument) {\n  if ('blobUrl' in media) {\n    return Boolean(media.blobUrl);\n  }\n\n  if ('previewBlobUrl' in media) {\n    return Boolean(media.previewBlobUrl);\n  }\n\n  return false;\n}\n\nexport function getPhotoFullDimensions(photo: Pick<ApiPhoto, 'sizes' | 'thumbnail'>): ApiDimensions | undefined {\n  return (\n    photo.sizes.find((size) => size.type === 'w')\n    || photo.sizes.find((size) => size.type === 'y')\n    || getPhotoInlineDimensions(photo)\n  );\n}\n\nexport function getPhotoInlineDimensions(photo: Pick<ApiPhoto, 'sizes' | 'thumbnail'>): ApiDimensions | undefined {\n  return (\n    photo.sizes.find((size) => size.type === 'x')\n    || photo.sizes.find((size) => size.type === 'm')\n    || photo.sizes.find((size) => size.type === 's')\n    || photo.thumbnail\n  );\n}\n\nexport function getVideoDimensions(video: ApiVideo): ApiDimensions | undefined {\n  if (video.width && video.height) {\n    return video as ApiDimensions;\n  }\n\n  return undefined;\n}\n\nexport function getMediaTransferState(\n  progress?: number, isLoadNeeded = false, isUploading = false,\n) {\n  const isTransferring = isUploading || isLoadNeeded;\n  const transferProgress = progress || 0;\n\n  return {\n    isUploading, isTransferring, transferProgress,\n  };\n}\n\nexport function getMediaSearchType(media: DownloadableMedia):\n  Extract<ApiMessageSearchType, 'gif' | 'media' | 'documents' | 'audio' | 'voice'> | undefined {\n  if (media.mediaType === 'video') {\n    if (media.isRound) return 'voice';\n    return media.isGif ? 'gif' : 'media';\n  }\n\n  if (media.mediaType === 'audio') {\n    return 'audio';\n  }\n\n  if (media.mediaType === 'voice') {\n    return 'voice';\n  }\n\n  if (media.mediaType === 'document') {\n    return 'documents';\n  }\n\n  if (media.mediaType === 'photo') {\n    return 'media';\n  }\n\n  return undefined;\n}\n\nexport function getMessageContentIds(\n  messages: Record<number, ApiMessage>, messageIds: number[], contentType: ApiMessageSearchType,\n) {\n  let validator: (message: ApiMessage) => unknown;\n\n  switch (contentType) {\n    case 'media':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        return getMessagePhoto(message) || (video && !video.isRound && !video.isGif);\n      };\n      break;\n\n    case 'documents':\n      validator = getMessageDocument;\n      break;\n\n    case 'gif':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        return video?.isGif;\n      };\n      break;\n\n    case 'links':\n      validator = (message: ApiMessage) => getMessageWebPage(message) || matchLinkInMessageText(message);\n      break;\n\n    case 'audio':\n      validator = getMessageAudio;\n      break;\n\n    case 'voice':\n      validator = (message: ApiMessage) => {\n        const video = getMessageVideo(message);\n        return getMessageVoice(message) || (video && video.isRound);\n      };\n      break;\n\n    default:\n      return [] as Array<number>;\n  }\n\n  return messageIds.reduce((result, messageId) => {\n    if (messages[messageId] && validator(messages[messageId])) {\n      result.push(messageId);\n    }\n\n    return result;\n  }, [] as Array<number>);\n}\n\nexport function isMediaLoadableInViewer(newMessage: ApiMessage) {\n  if (!newMessage.content) return false;\n  if (newMessage.content.photo) return true;\n  if (newMessage.content.video && !newMessage.content.video.isRound && !newMessage.content.video.isGif) return true;\n  return false;\n}\n\nexport function getMediaFilename(media: DownloadableMedia) {\n  if ('fileName' in media && media.fileName) {\n    return media.fileName;\n  }\n\n  if (media.mediaType === 'sticker') {\n    const extension = media.isLottie ? 'tgs' : media.isVideo ? 'webm' : 'webp';\n    return `${media.id}.${extension}`;\n  }\n\n  if (media.mediaType === 'photo') {\n    return `${media.id}.${media.isVideo ? 'mp4' : 'jpg'}`;\n  }\n\n  if (media.mediaType === 'voice') {\n    return `${media.id}.${IS_OPUS_SUPPORTED ? 'ogg' : 'wav'}`;\n  }\n\n  if ('id' in media && media.id) {\n    return media.id;\n  }\n\n  return `${media.mediaType}-${Math.random().toString(36).slice(4)}`;\n}\n\nexport function getIsDownloading(activeDownloads: ActiveDownloads, media: DownloadableMedia) {\n  const hash = getMediaHash(media, 'download');\n  if (!hash) return false;\n  return Boolean(activeDownloads[hash]);\n}\n\nexport function getMessageMediaHash(\n  message: MediaContainer,\n  statefulMedia: StatefulMediaContent,\n  target: SizeTarget,\n) {\n  const {\n    video, sticker, audio, voice, document,\n  } = message.content;\n  const { webPage } = statefulMedia;\n\n  const messagePhoto = getMessagePhoto(message) || getWebPagePhoto(webPage);\n  const actionPhoto = getMessageActionPhoto(message);\n  const messageVideo = video || getWebPageVideo(webPage);\n  const messageDocument = document || getWebPageDocument(webPage);\n  const messageAudio = audio || getWebPageAudio(webPage);\n\n  if (messageVideo) {\n    return getVideoMediaHash(messageVideo, target);\n  }\n\n  if (messagePhoto || actionPhoto) {\n    return getPhotoMediaHash(messagePhoto || actionPhoto!, target, Boolean(actionPhoto));\n  }\n\n  if (messageDocument) {\n    return getDocumentMediaHash(messageDocument, target);\n  }\n\n  if (sticker) {\n    return getStickerMediaHash(sticker, target);\n  }\n\n  if (messageAudio) {\n    return getAudioMediaHash(messageAudio, target);\n  }\n\n  if (voice) {\n    return getVoiceMediaHash(voice, target);\n  }\n\n  return undefined;\n}\n\nexport function canReplaceMessageMedia(\n  message: MediaContainer, attachment: ApiAttachment,\n) {\n  const isPhotoOrVideo = Boolean(getMessagePhoto(message) || getMessageVideo(message));\n  const isFile = Boolean(getMessageAudio(message)\n    || getMessageVoice(message) || getMessageDocument(message));\n\n  const fileType = getAttachmentMediaType(attachment);\n\n  return (\n    (isPhotoOrVideo && (fileType === 'photo' || fileType === 'video'))\n    || (isFile && (fileType === 'audio' || fileType === 'file'))\n  );\n}\n","import type { ApiFormattedText } from '../../api/types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nexport function getStickerHashById(stickerId: string, isPreview?: boolean) {\n  const base = `sticker${stickerId}`;\n  return !isPreview ? base : `${base}?size=m`;\n}\n\nexport function containsCustomEmoji(formattedText: ApiFormattedText) {\n  return formattedText.entities?.some((e) => e.type === ApiMessageEntityTypes.CustomEmoji);\n}\n\nexport function stripCustomEmoji(text: ApiFormattedText): ApiFormattedText {\n  if (!text.entities) return text;\n\n  const entities = text.entities.filter((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji);\n  return { ...text, entities };\n}\n","import type { ApiPeer, ApiUser, ApiUserStatus } from '../../api/types';\nimport type { OldLangFn } from '../../hooks/useOldLang';\n\nimport { ANONYMOUS_USER_ID, SERVICE_NOTIFICATIONS_USER_ID } from '../../config';\nimport { formatFullDate, formatTime } from '../../util/dates/dateFormat';\nimport { DAY } from '../../util/dates/units';\nimport { orderBy } from '../../util/iteratees';\nimport { formatPhoneNumber } from '../../util/phoneNumber';\nimport { getServerTime, getServerTimeOffset } from '../../util/serverTime';\n\nexport function getUserFirstOrLastName(user?: ApiUser) {\n  if (!user) {\n    return undefined;\n  }\n\n  switch (user.type) {\n    case 'userTypeBot':\n      return user.firstName;\n    case 'userTypeRegular': {\n      return user.firstName || user.lastName;\n    }\n\n    case 'userTypeDeleted':\n    case 'userTypeUnknown': {\n      return 'Deleted';\n    }\n\n    default:\n      return undefined;\n  }\n}\n\nexport function getUserFullName(user?: ApiUser) {\n  if (!user) {\n    return undefined;\n  }\n\n  if (isDeletedUser(user)) {\n    return 'Deleted Account';\n  }\n\n  switch (user.type) {\n    case 'userTypeBot':\n    case 'userTypeRegular': {\n      if (user.firstName && user.lastName) {\n        return `${user.firstName} ${user.lastName}`;\n      }\n\n      if (user.firstName) {\n        return user.firstName;\n      }\n\n      if (user.lastName) {\n        return user.lastName;\n      }\n\n      if (user.phoneNumber) {\n        return `+${formatPhoneNumber(user.phoneNumber)}`;\n      }\n\n      break;\n    }\n  }\n\n  return undefined;\n}\n\nexport function getUserStatus(\n  lang: OldLangFn, user: ApiUser, userStatus: ApiUserStatus | undefined,\n) {\n  if (user.id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return lang('ServiceNotifications');\n  }\n\n  if (user.isSupport) {\n    return lang('SupportStatus');\n  }\n\n  if (user.type && user.type === 'userTypeBot') {\n    if (user.botActiveUsers) {\n      return lang('BotUsers', user.botActiveUsers, 'i');\n    }\n    return lang('Bot');\n  }\n\n  if (!userStatus) {\n    return '';\n  }\n\n  switch (userStatus.type) {\n    case 'userStatusEmpty': {\n      return lang('ALongTimeAgo');\n    }\n\n    case 'userStatusLastMonth': {\n      return lang('WithinAMonth');\n    }\n\n    case 'userStatusLastWeek': {\n      return lang('WithinAWeek');\n    }\n\n    case 'userStatusOffline': {\n      const { wasOnline } = userStatus;\n\n      if (!wasOnline) return lang('LastSeen.Offline');\n\n      const serverTimeOffset = getServerTimeOffset();\n      const now = new Date(Date.now() + serverTimeOffset * 1000);\n      const wasOnlineDate = new Date(wasOnline * 1000);\n\n      if (wasOnlineDate >= now) {\n        return lang('LastSeen.JustNow');\n      }\n\n      const diff = new Date(now.getTime() - wasOnlineDate.getTime());\n\n      // within a minute\n      if (diff.getTime() / 1000 < 60) {\n        return lang('LastSeen.JustNow');\n      }\n\n      // within an hour\n      if (diff.getTime() / 1000 < 60 * 60) {\n        const minutes = Math.floor(diff.getTime() / 1000 / 60);\n        return lang('LastSeen.MinutesAgo', minutes);\n      }\n\n      // today\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      const serverToday = new Date(today.getTime() + serverTimeOffset * 1000);\n      if (wasOnlineDate > serverToday) {\n        // up to 6 hours ago\n        if (diff.getTime() / 1000 < 6 * 60 * 60) {\n          const hours = Math.floor(diff.getTime() / 1000 / 60 / 60);\n          return lang('LastSeen.HoursAgo', hours);\n        }\n\n        // other\n        return lang('LastSeen.TodayAt', formatTime(lang, wasOnlineDate));\n      }\n\n      // yesterday\n      const yesterday = new Date();\n      yesterday.setDate(now.getDate() - 1);\n      yesterday.setHours(0, 0, 0, 0);\n      const serverYesterday = new Date(yesterday.getTime() + serverTimeOffset * 1000);\n      if (wasOnlineDate > serverYesterday) {\n        return lang('LastSeen.YesterdayAt', formatTime(lang, wasOnlineDate));\n      }\n\n      return lang('LastSeen.AtDate', formatFullDate(lang, wasOnlineDate));\n    }\n\n    case 'userStatusOnline': {\n      return lang('Online');\n    }\n\n    case 'userStatusRecently': {\n      return lang('Lately');\n    }\n\n    default:\n      return undefined;\n  }\n}\n\nexport function isUserOnline(user: ApiUser, userStatus?: ApiUserStatus, withSelfOnline = false) {\n  const { id, type } = user;\n\n  if (!userStatus) {\n    return false;\n  }\n\n  if (id === SERVICE_NOTIFICATIONS_USER_ID) {\n    return false;\n  }\n\n  if (user.isSelf && !withSelfOnline) {\n    return false;\n  }\n\n  return userStatus.type === 'userStatusOnline' && type !== 'userTypeBot';\n}\n\nexport function isDeletedUser(user: ApiUser) {\n  return (user.type === 'userTypeDeleted' || user.type === 'userTypeUnknown')\n    && user.id !== SERVICE_NOTIFICATIONS_USER_ID;\n}\n\nexport function isUserBot(user: ApiUser) {\n  return user.type === 'userTypeBot';\n}\n\nexport function getCanAddContact(user: ApiUser) {\n  return !user.isSelf && !user.isContact && !isUserBot(user) && user.id !== ANONYMOUS_USER_ID;\n}\n\nexport function sortUserIds(\n  userIds: string[],\n  usersById: Record<string, ApiUser>,\n  userStatusesById: Record<string, ApiUserStatus>,\n  priorityIds?: string[],\n) {\n  return orderBy(userIds, (id) => {\n    const now = getServerTime();\n\n    if (priorityIds && priorityIds.includes(id)) {\n      // Assuming that online status expiration date can't be as far as two days from now,\n      // this should place prioritized on top of the list.\n      // Then we subtract index of `id` in `priorityIds` to preserve selected order\n      return now + (48 * 60 * 60) - (priorityIds.length - priorityIds.indexOf(id));\n    }\n\n    const user = usersById[id];\n    const userStatus = userStatusesById[id];\n    if (!user || !userStatus) {\n      return 0;\n    }\n\n    if (userStatus.type === 'userStatusOnline') {\n      return userStatus.expires;\n    } else if (userStatus.type === 'userStatusOffline' && userStatus.wasOnline) {\n      return userStatus.wasOnline;\n    }\n\n    switch (userStatus.type) {\n      case 'userStatusRecently':\n        return now - DAY;\n      case 'userStatusLastWeek':\n        return now - DAY * 7;\n      case 'userStatusLastMonth':\n        return now - DAY * 7 * 30;\n      default:\n        return 0;\n    }\n  }, 'desc');\n}\n\nexport function getMainUsername(userOrChat: ApiPeer) {\n  return userOrChat.usernames?.find((u) => u.isActive)?.username;\n}\n\nexport function getPeerStoryHtmlId(userId: string) {\n  return `peer-story${userId}`;\n}\n","export const MEMO_EMPTY_ARRAY = [];\n","import { DEBUG } from '../config';\nimport { createCallbackManager } from './callbacks';\n\nexport enum Bundles {\n  Auth,\n  Main,\n  Extra,\n  Calls,\n  Stars,\n}\n\ninterface ImportedBundles {\n  [Bundles.Auth]: typeof import('../bundles/auth');\n  [Bundles.Main]: typeof import('../bundles/main');\n  [Bundles.Extra]: typeof import('../bundles/extra');\n  [Bundles.Calls]: typeof import('../bundles/calls');\n  [Bundles.Stars]: typeof import('../bundles/stars');\n}\n\ntype BundlePromises = {\n  [K in keyof ImportedBundles]: Promise<ImportedBundles[K]>\n};\n\nexport type BundleModules<B extends keyof ImportedBundles> = keyof ImportedBundles[B];\n\nconst LOAD_PROMISES: Partial<BundlePromises> = {};\nconst MEMORY_CACHE: Partial<ImportedBundles> = {};\n\nconst { addCallback, runCallbacks } = createCallbackManager();\n\nexport async function loadBundle<B extends Bundles>(bundleName: B) {\n  if (!LOAD_PROMISES[bundleName]) {\n    switch (bundleName) {\n      case Bundles.Auth:\n        LOAD_PROMISES[Bundles.Auth] = import(/* webpackChunkName: \"BundleAuth\" */ '../bundles/auth');\n        break;\n      case Bundles.Main:\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.log('>>> START LOAD MAIN BUNDLE');\n        }\n\n        LOAD_PROMISES[Bundles.Main] = import(/* webpackChunkName: \"BundleMain\" */ '../bundles/main');\n        break;\n      case Bundles.Extra:\n        LOAD_PROMISES[Bundles.Extra] = import(/* webpackChunkName: \"BundleExtra\" */ '../bundles/extra');\n        break;\n      case Bundles.Calls:\n        LOAD_PROMISES[Bundles.Calls] = import(/* webpackChunkName: \"BundleCalls\" */ '../bundles/calls');\n        break;\n      case Bundles.Stars:\n        LOAD_PROMISES[Bundles.Stars] = import(/* webpackChunkName: \"BundleStars\" */ '../bundles/stars');\n        break;\n    }\n\n    (LOAD_PROMISES[bundleName]!).then(runCallbacks);\n  }\n\n  const bundle = (await LOAD_PROMISES[bundleName]) as unknown as ImportedBundles[B];\n\n  if (!MEMORY_CACHE[bundleName]) {\n    MEMORY_CACHE[bundleName] = bundle;\n  }\n\n  return bundle;\n}\n\nexport async function loadModule<B extends Bundles>(bundleName: B) {\n  await loadBundle(bundleName);\n}\n\nexport function getModuleFromMemory<B extends Bundles, M extends BundleModules<B>>(\n  bundleName: B, moduleName: M,\n): ImportedBundles[B][M] | undefined {\n  const bundle = MEMORY_CACHE[bundleName] as ImportedBundles[B];\n\n  if (!bundle) {\n    return undefined;\n  }\n\n  return bundle[moduleName];\n}\n\nexport const addLoadListener = addCallback;\n","let serverTimeOffset = 0;\n\nexport function setServerTimeOffset(_serverTimeOffset: number) {\n  serverTimeOffset = _serverTimeOffset;\n}\n\nexport function getServerTimeOffset() {\n  return serverTimeOffset;\n}\n\nexport function getServerTime() {\n  return Math.floor(Date.now() / 1000) + serverTimeOffset;\n}\n","import { useEffect } from '../lib/teact/teact';\n\nimport type { BundleModules, Bundles } from '../util/moduleLoader';\n\nimport { DEBUG } from '../config';\nimport { addLoadListener, getModuleFromMemory, loadModule } from '../util/moduleLoader';\nimport useForceUpdate from './useForceUpdate';\n\nconst useModuleLoader = <B extends Bundles, M extends BundleModules<B>>(\n  bundleName: B, moduleName: M, noLoad = false, autoUpdate = false,\n) => {\n  const module = getModuleFromMemory(bundleName, moduleName);\n  const forceUpdate = useForceUpdate();\n\n  useEffect(() => {\n    if (!autoUpdate) {\n      return undefined;\n    }\n\n    return addLoadListener(forceUpdate);\n  }, [autoUpdate, forceUpdate]);\n\n  useEffect(() => {\n    if (!noLoad && !module) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('Module load triggered', bundleName, moduleName);\n      }\n      loadModule(bundleName).then(forceUpdate);\n    }\n  }, [bundleName, forceUpdate, module, moduleName, noLoad]);\n\n  return module;\n};\n\nexport default useModuleLoader;\n","/*\n * Thanks to Ace Monkey for this mind-blowing patch.\n */\n\nexport function patchSafariProgressiveAudio(audioEl: HTMLAudioElement) {\n  if (audioEl.dataset.patchedForSafari) {\n    return;\n  }\n\n  audioEl.addEventListener('play', () => {\n    const t = audioEl.currentTime;\n\n    audioEl.dataset.patchForSafariInProgress = 'true';\n    function onProgress() {\n      if (!audioEl.buffered.length) {\n        return;\n      }\n      audioEl.currentTime = audioEl.duration - 1;\n      audioEl.addEventListener('progress', () => {\n        delete audioEl.dataset.patchForSafariInProgress;\n        audioEl.currentTime = t;\n        if (audioEl.paused && !audioEl.dataset.preventPlayAfterPatch) {\n          audioEl.play();\n        }\n      }, { once: true });\n\n      audioEl.removeEventListener('progress', onProgress);\n    }\n\n    audioEl.addEventListener('progress', onProgress);\n  }, { once: true });\n\n  audioEl.dataset.patchedForSafari = 'true';\n}\n\nexport function isSafariPatchInProgress(audioEl: HTMLAudioElement) {\n  return Boolean(audioEl.dataset.patchForSafariInProgress);\n}\n","import { useEffect, useRef } from '../lib/teact/teact';\n\nconst useEffectWithPrevDeps = <const T extends readonly any[]>(\n  cb: (args: T | readonly []) => void, dependencies: T, debugKey?: string,\n) => {\n  const prevDepsRef = useRef<T>();\n\n  return useEffect(() => {\n    const prevDeps = prevDepsRef.current;\n    prevDepsRef.current = dependencies;\n\n    return cb(prevDeps || []);\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, dependencies, debugKey);\n};\n\nexport default useEffectWithPrevDeps;\n","import type { MediaContent } from '../../api/types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport parseEmojiOnlyString from '../../util/emoji/parseEmojiOnlyString';\n\nexport function getEmojiOnlyCountForMessage(content: MediaContent, groupedId?: string): number | undefined {\n  if (!content.text) return undefined;\n  return (\n    !groupedId\n    && Object.keys(content).length === 1 // Only text is present\n    && !content.text.entities?.some((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji)\n    && parseEmojiOnlyString(content.text.text)\n  ) || undefined;\n}\n","import type {\n  ApiFormattedText,\n  ApiMessage, ApiPoll, ApiPollResult, ApiQuickReply, ApiSponsoredMessage, ApiThreadInfo,\n  ApiWebPage,\n  ApiWebPageFull,\n} from '../../api/types';\nimport type {\n  MessageList,\n  MessageListType,\n  TabThread,\n  Thread,\n  ThreadId,\n} from '../../types';\nimport type {\n  GlobalState, TabArgs, TabState,\n} from '../types';\nimport { MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  IS_MOCKED_CLIENT, IS_TEST, MESSAGE_LIST_SLICE, MESSAGE_LIST_VIEWPORT_LIMIT, TMP_CHAT_ID,\n} from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { addTimestampEntities } from '../../util/dates/timestamp';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  areSortedArraysEqual, excludeSortedArray, omit, omitUndefined, pick, pickTruthy, unique,\n} from '../../util/iteratees';\nimport { isLocalMessageId, type MessageKey } from '../../util/keys/messageKey';\nimport {\n  hasMessageTtl, isMediaLoadableInViewer, mergeIdRanges, orderHistoryIds, orderPinnedIds,\n} from '../helpers';\nimport { getEmojiOnlyCountForMessage } from '../helpers/getEmojiOnlyCountForMessage';\nimport {\n  selectChatMessage,\n  selectChatMessages,\n  selectChatScheduledMessages,\n  selectCurrentMessageIds,\n  selectCurrentMessageList,\n  selectListedIds,\n  selectMessageIdsByGroupId,\n  selectOutlyingLists,\n  selectPinnedIds,\n  selectPoll,\n  selectQuickReplyMessage,\n  selectScheduledIds,\n  selectScheduledMessage,\n  selectTabState,\n  selectThreadIdFromMessage,\n  selectThreadInfo,\n  selectThreadParam,\n  selectViewportIds,\n  selectWebPage,\n} from '../selectors';\nimport { removeIdFromSearchResults } from './middleSearch';\nimport { updateTabState } from './tabs';\nimport { clearMessageTranslation } from './translations';\n\ntype MessageStoreSections = GlobalState['messages']['byChatId'][string];\n\nexport function updateCurrentMessageList<T extends GlobalState>(\n  global: T,\n  chatId: string | undefined,\n  threadId: ThreadId = MAIN_THREAD_ID,\n  type: MessageListType = 'thread',\n  shouldReplaceHistory?: boolean,\n  shouldReplaceLast?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { messageLists } = selectTabState(global, tabId);\n  let newMessageLists: MessageList[] = messageLists;\n  if (shouldReplaceHistory || (IS_TEST && !IS_MOCKED_CLIENT)) {\n    newMessageLists = chatId ? [{ chatId, threadId, type }] : [];\n  } else if (chatId) {\n    const current = messageLists[messageLists.length - 1];\n    if (current?.chatId === chatId && current.threadId === threadId && current.type === type) {\n      return global;\n    }\n\n    if (current && (current.chatId === TMP_CHAT_ID || shouldReplaceLast)) {\n      newMessageLists = [...messageLists.slice(0, -1), { chatId, threadId, type }];\n    } else {\n      const previous = messageLists[messageLists.length - 2];\n\n      if (previous?.chatId === chatId && previous.threadId === threadId && previous.type === type) {\n        newMessageLists = messageLists.slice(0, -1);\n      } else {\n        newMessageLists = [...messageLists, { chatId, threadId, type }];\n      }\n    }\n  } else {\n    newMessageLists = messageLists.slice(0, -1);\n  }\n\n  return updateTabState(global, {\n    messageLists: newMessageLists,\n  }, tabId);\n}\n\nfunction replaceChatMessages<T extends GlobalState>(global: T, chatId: string, newById: Record<number, ApiMessage>): T {\n  return updateMessageStore(global, chatId, {\n    byId: newById,\n  });\n}\n\nexport function updateTabThread<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, threadUpdate: Partial<TabThread>,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const tabState = selectTabState(global, tabId);\n  const current = tabState.tabThreads[chatId]?.[threadId] || {};\n\n  return updateTabState(global, {\n    tabThreads: {\n      ...tabState.tabThreads,\n      [chatId]: {\n        ...tabState.tabThreads[chatId],\n        [threadId]: {\n          ...current,\n          ...threadUpdate,\n        },\n      },\n    },\n  }, tabId);\n}\n\nexport function updateThread<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, threadUpdate: Partial<Thread> | undefined,\n): T {\n  if (!threadUpdate) {\n    return updateMessageStore(global, chatId, {\n      threadsById: omit(global.messages.byChatId[chatId]?.threadsById, [threadId]),\n    });\n  }\n\n  const current = global.messages.byChatId[chatId];\n\n  return updateMessageStore(global, chatId, {\n    threadsById: {\n      ...(current?.threadsById),\n      [threadId]: {\n        ...(current?.threadsById[threadId]),\n        ...threadUpdate,\n      },\n    },\n  });\n}\n\nexport function updateMessageStore<T extends GlobalState>(\n  global: T, chatId: string, update: Partial<MessageStoreSections>,\n): T {\n  const current = global.messages.byChatId[chatId] || { byId: {}, threadsById: {} };\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      byChatId: {\n        ...global.messages.byChatId,\n        [chatId]: {\n          ...current,\n          ...update,\n        },\n      },\n    },\n  };\n}\n\nexport function replaceTabThreadParam<T extends GlobalState, K extends keyof TabThread>(\n  global: T, chatId: string, threadId: ThreadId, paramName: K, newValue: TabThread[K] | undefined,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (paramName === 'viewportIds') {\n    global = replaceThreadParam(\n      global, chatId, threadId, 'lastViewportIds', newValue as number[] | undefined,\n    );\n  }\n  return updateTabThread(global, chatId, threadId, { [paramName]: newValue }, tabId);\n}\n\nexport function replaceThreadParam<T extends GlobalState, K extends keyof Thread>(\n  global: T, chatId: string, threadId: ThreadId, paramName: K, newValue: Thread[K] | undefined,\n) {\n  return updateThread(global, chatId, threadId, { [paramName]: newValue });\n}\n\nexport function addMessages<T extends GlobalState>(\n  global: T, messages: ApiMessage[],\n): T {\n  const addedByChatId = messages.reduce((messagesByChatId, message: ApiMessage) => {\n    if (!messagesByChatId[message.chatId]) {\n      messagesByChatId[message.chatId] = {};\n    }\n    messagesByChatId[message.chatId][message.id] = message;\n\n    return messagesByChatId;\n  }, {} as Record<string, Record<number, ApiMessage>>);\n\n  Object.keys(addedByChatId).forEach((chatId) => {\n    global = addChatMessagesById(global, chatId, addedByChatId[chatId]);\n  });\n\n  return global;\n}\n\nexport function replaceMessages<T extends GlobalState>(\n  global: T, messages: ApiMessage[],\n): T {\n  const updatedByChatId = messages.reduce((messagesByChatId, message: ApiMessage) => {\n    if (!messagesByChatId[message.chatId]) {\n      messagesByChatId[message.chatId] = {};\n    }\n    messagesByChatId[message.chatId][message.id] = message;\n\n    return messagesByChatId;\n  }, {} as Record<string, Record<number, ApiMessage>>);\n\n  Object.keys(updatedByChatId).forEach((chatId) => {\n    const currentById = selectChatMessages(global, chatId) || {};\n    const newById = {\n      ...currentById,\n      ...updatedByChatId[chatId],\n    };\n    global = replaceChatMessages(global, chatId, newById);\n  });\n\n  return global;\n}\n\nexport function addChatMessagesById<T extends GlobalState>(\n  global: T, chatId: string, newById: Record<number, ApiMessage>,\n): T {\n  const byId = selectChatMessages(global, chatId);\n\n  if (byId && Object.keys(newById).every((newId) => Boolean(byId[Number(newId)]))) {\n    return global;\n  }\n\n  return replaceChatMessages(global, chatId, {\n    ...newById,\n    ...byId,\n  });\n}\n\nexport function updateChatMessage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, messageUpdate: Partial<ApiMessage>, withDeepCheck = false,\n): T {\n  const byId = selectChatMessages(global, chatId) || {};\n  const message = byId[messageId];\n\n  if (withDeepCheck && message) {\n    const updateKeys = Object.keys(messageUpdate) as (keyof ApiMessage)[];\n    if (areDeepEqual(pick(message, updateKeys), messageUpdate)) {\n      return global;\n    }\n  }\n\n  if (message && messageUpdate.isMediaUnread === false && hasMessageTtl(message)) {\n    if (message.content.voice) {\n      messageUpdate.content = {\n        action: {\n          mediaType: 'action',\n          type: 'expired',\n          isVoice: true,\n        },\n      };\n    } else if (message.content.video?.isRound) {\n      messageUpdate.content = {\n        action: {\n          mediaType: 'action',\n          type: 'expired',\n          isRoundVideo: true,\n        },\n      };\n    }\n  }\n\n  let text = message?.content?.text;\n  if (messageUpdate.content) {\n    const emojiOnlyCount = getEmojiOnlyCountForMessage(\n      messageUpdate.content, message?.groupedId || messageUpdate.groupedId,\n    );\n    text = messageUpdate.content.text ? addTimestampEntities(messageUpdate.content.text) : text;\n    if (text) text.emojiOnlyCount = emojiOnlyCount;\n  }\n\n  const updatedMessage = omitUndefined({\n    ...message,\n    ...messageUpdate,\n    text,\n  });\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return replaceChatMessages(global, chatId, {\n    ...byId,\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function updateScheduledMessage<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, messageUpdate: Partial<ApiMessage>,\n): T {\n  const message = selectScheduledMessage(global, chatId, messageId)!;\n\n  let text = message?.content?.text;\n  if (messageUpdate.content) {\n    const emojiOnlyCount = getEmojiOnlyCountForMessage(\n      messageUpdate.content, message?.groupedId || messageUpdate.groupedId,\n    );\n    text = messageUpdate.content.text ? addTimestampEntities(messageUpdate.content.text) : text;\n    if (text) text.emojiOnlyCount = emojiOnlyCount;\n  }\n\n  const updatedMessage = {\n    ...message,\n    ...messageUpdate,\n    text,\n  };\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return updateScheduledMessages(global, chatId, {\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function updateQuickReplyMessage<T extends GlobalState>(\n  global: T, messageId: number, messageUpdate: Partial<ApiMessage>,\n): T {\n  const message = selectQuickReplyMessage(global, messageId);\n  const updatedMessage = {\n    ...message,\n    ...messageUpdate,\n  };\n\n  if (!updatedMessage.id) {\n    return global;\n  }\n\n  return updateQuickReplyMessages(global, {\n    [messageId]: updatedMessage,\n  });\n}\n\nexport function deleteQuickReplyMessages<T extends GlobalState>(\n  global: T, messageIds: number[],\n): T {\n  const byId = global.quickReplies.messagesById;\n  const newById = omit(byId, messageIds);\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      messagesById: newById,\n    },\n  };\n}\n\nexport function deleteChatMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n): T {\n  const byId = selectChatMessages(global, chatId);\n  if (!byId) {\n    return global;\n  }\n\n  orderHistoryIds(messageIds);\n  const updatedThreads = new Map<ThreadId, number[]>();\n  updatedThreads.set(MAIN_THREAD_ID, messageIds);\n\n  const mediaIdsToRemove: number[] = [];\n  messageIds.forEach((messageId) => {\n    const message = byId[messageId];\n    if (!message) return;\n    if (isMediaLoadableInViewer(message)) {\n      mediaIdsToRemove.push(messageId);\n    }\n    const threadId = selectThreadIdFromMessage(global, message);\n    if (!threadId || threadId === MAIN_THREAD_ID) {\n      return;\n    }\n    const threadMessages = updatedThreads.get(threadId) || [];\n    threadMessages.push(messageId);\n    updatedThreads.set(threadId, threadMessages);\n    global = clearMessageTranslation(global, chatId, messageId);\n  });\n\n  const deletedForwardedPosts = Object.values(pickTruthy(byId, messageIds)).filter(\n    ({ forwardInfo }) => forwardInfo?.isLinkedChannelPost,\n  );\n\n  updatedThreads.forEach((threadMessageIds, threadId) => {\n    const threadInfo = selectThreadInfo(global, chatId, threadId);\n\n    let listedIds = selectListedIds(global, chatId, threadId);\n    let pinnedIds = selectPinnedIds(global, chatId, threadId);\n    let outlyingLists = selectOutlyingLists(global, chatId, threadId);\n    let newMessageCount = threadInfo?.messagesCount;\n\n    if (listedIds) {\n      listedIds = excludeSortedArray(listedIds, threadMessageIds);\n    }\n\n    if (outlyingLists) {\n      outlyingLists = outlyingLists.map((list) => excludeSortedArray(list, threadMessageIds));\n    }\n\n    if (pinnedIds) {\n      pinnedIds = excludeSortedArray(pinnedIds, orderPinnedIds(threadMessageIds));\n    }\n\n    const nonLocalMessageCount = threadMessageIds.filter((id) => !isLocalMessageId(id)).length;\n    if (newMessageCount !== undefined) {\n      newMessageCount -= nonLocalMessageCount;\n    }\n\n    Object.values(global.byTabId).forEach(({ id: tabId }) => {\n      const tabState = selectTabState(global, tabId);\n      const activeDownloadsInChat = Object.entries(tabState.activeDownloads).filter(\n        ([, { originChatId, originMessageId }]) => originChatId === chatId && originMessageId,\n      );\n\n      activeDownloadsInChat.forEach(([mediaHash, context]) => {\n        if (messageIds.includes(context.originMessageId!)) {\n          global = cancelMessageMediaDownload(global, [mediaHash], tabId);\n        }\n      });\n\n      mediaIdsToRemove.forEach((mediaId) => {\n        global = removeIdFromSearchResults(global, chatId, threadId, mediaId, tabId);\n      });\n\n      const viewportIds = selectViewportIds(global, chatId, threadId, tabId);\n      if (!viewportIds) return;\n\n      const newViewportIds = excludeSortedArray(viewportIds, messageIds);\n      global = replaceTabThreadParam(\n        global,\n        chatId,\n        threadId,\n        'viewportIds',\n        newViewportIds.length === 0 ? undefined : newViewportIds,\n        tabId,\n      );\n    });\n\n    global = replaceThreadParam(global, chatId, threadId, 'listedIds', listedIds);\n    global = replaceThreadParam(global, chatId, threadId, 'outlyingLists', outlyingLists);\n    global = replaceThreadParam(global, chatId, threadId, 'pinnedIds', pinnedIds);\n\n    if (threadInfo && newMessageCount !== undefined) {\n      global = updateThreadInfo(global, chatId, threadId, {\n        messagesCount: newMessageCount,\n      });\n    }\n  });\n\n  if (deletedForwardedPosts.length) {\n    Object.values(global.byTabId).forEach(({ id: tabId }) => {\n      const currentMessageList = selectCurrentMessageList(global, tabId);\n      const canDeleteCurrentThread = currentMessageList && currentMessageList.chatId === chatId\n        && currentMessageList.type === 'thread';\n      const currentThreadId = currentMessageList?.threadId;\n\n      deletedForwardedPosts.forEach((message) => {\n        const { fromChatId, fromMessageId } = message.forwardInfo!;\n        const originalPost = selectChatMessage(global, fromChatId!, fromMessageId!);\n\n        if (canDeleteCurrentThread && currentThreadId === message.id) {\n          global = updateCurrentMessageList(global, chatId, undefined, undefined, undefined, undefined, tabId);\n        }\n        if (originalPost) {\n          global = updateThread(global, fromChatId!, fromMessageId!, undefined);\n        }\n      });\n    });\n  }\n\n  const newById = omit(byId, messageIds);\n  global = replaceChatMessages(global, chatId, newById);\n\n  return global;\n}\n\nexport function deleteChatScheduledMessages<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageIds: number[],\n): T {\n  const byId = selectChatScheduledMessages(global, chatId);\n  if (!byId) {\n    return global;\n  }\n  const newById = omit(byId, messageIds);\n\n  let scheduledIds = selectScheduledIds(global, chatId, MAIN_THREAD_ID);\n  if (scheduledIds) {\n    messageIds.forEach((messageId) => {\n      if (scheduledIds!.includes(messageId)) {\n        scheduledIds = scheduledIds!.filter((id) => id !== messageId);\n      }\n    });\n    global = replaceThreadParam(global, chatId, MAIN_THREAD_ID, 'scheduledIds', scheduledIds);\n\n    Object.entries(global.messages.byChatId[chatId].threadsById).forEach(([threadId, thread]) => {\n      if (thread.scheduledIds) {\n        const newScheduledIds = thread.scheduledIds.filter((id) => !messageIds.includes(id));\n        global = replaceThreadParam(global, chatId, Number(threadId), 'scheduledIds', newScheduledIds);\n      }\n    });\n  }\n\n  global = {\n    ...global,\n    scheduledMessages: {\n      byChatId: {\n        ...global.scheduledMessages.byChatId,\n        [chatId]: {\n          byId: newById,\n        },\n      },\n    },\n  };\n\n  return global;\n}\n\nexport function updateListedIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  idsUpdate: number[],\n): T {\n  const listedIds = selectListedIds(global, chatId, threadId);\n  const newIds = listedIds?.length\n    ? idsUpdate.filter((id) => !listedIds.includes(id))\n    : idsUpdate;\n\n  if (listedIds && !newIds.length) {\n    return global;\n  }\n\n  return replaceThreadParam(global, chatId, threadId, 'listedIds', orderHistoryIds([\n    ...(listedIds || []),\n    ...newIds,\n  ]));\n}\n\nexport function removeOutlyingList<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  list: number[],\n): T {\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n  if (!outlyingLists) {\n    return global;\n  }\n\n  const newOutlyingLists = outlyingLists.filter((l) => l !== list);\n\n  return replaceThreadParam(global, chatId, threadId, 'outlyingLists', newOutlyingLists);\n}\n\nexport function updateOutlyingLists<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  idsUpdate: number[],\n): T {\n  if (!idsUpdate.length) return global;\n\n  const outlyingLists = selectOutlyingLists(global, chatId, threadId);\n\n  const newOutlyingLists = mergeIdRanges(outlyingLists || [], idsUpdate);\n\n  return replaceThreadParam(global, chatId, threadId, 'outlyingLists', newOutlyingLists);\n}\n\nexport function addViewportId<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newId: number,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const viewportIds = selectViewportIds(global, chatId, threadId, tabId) || [];\n  if (viewportIds.includes(newId)) {\n    return global;\n  }\n\n  const newIds = orderHistoryIds([\n    ...(\n      viewportIds.length < MESSAGE_LIST_VIEWPORT_LIMIT\n        ? viewportIds\n        : viewportIds.slice(-(MESSAGE_LIST_SLICE / 2))\n    ),\n    newId,\n  ]);\n\n  return replaceTabThreadParam(global, chatId, threadId, 'viewportIds', newIds, tabId);\n}\n\nexport function safeReplaceViewportIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newViewportIds: number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const currentIds = selectViewportIds(global, chatId, threadId, tabId) || [];\n  const newIds = orderHistoryIds(newViewportIds);\n\n  return replaceTabThreadParam(\n    global,\n    chatId,\n    threadId,\n    'viewportIds',\n    areSortedArraysEqual(currentIds, newIds) ? currentIds : newIds,\n    tabId,\n  );\n}\n\nexport function safeReplacePinnedIds<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  newPinnedIds: number[],\n): T {\n  const currentIds = selectPinnedIds(global, chatId, threadId) || [];\n  const newIds = orderPinnedIds(newPinnedIds);\n\n  return replaceThreadParam(\n    global,\n    chatId,\n    threadId,\n    'pinnedIds',\n    areSortedArraysEqual(currentIds, newIds) ? currentIds : newIds,\n  );\n}\n\nexport function updateThreadInfo<T extends GlobalState>(\n  global: T, chatId: string, threadId: ThreadId, update: Partial<ApiThreadInfo> | undefined,\n  doNotUpdateLinked?: boolean,\n): T {\n  const newThreadInfo = {\n    ...(selectThreadInfo(global, chatId, threadId) as ApiThreadInfo),\n    ...update,\n  } as ApiThreadInfo;\n\n  if (!doNotUpdateLinked && !newThreadInfo.isCommentsInfo) {\n    const linkedUpdate = pick(newThreadInfo, ['messagesCount', 'lastMessageId', 'lastReadInboxMessageId']);\n    if (newThreadInfo.fromChannelId && newThreadInfo.fromMessageId) {\n      global = updateThreadInfo(\n        global, newThreadInfo.fromChannelId, newThreadInfo.fromMessageId, linkedUpdate, true,\n      );\n    }\n  }\n\n  return replaceThreadParam(global, chatId, threadId, 'threadInfo', newThreadInfo);\n}\n\nexport function updateThreadInfos<T extends GlobalState>(\n  global: T, updates: Partial<ApiThreadInfo>[],\n): T {\n  updates.forEach((update) => {\n    global = updateThreadInfo(\n      global,\n      update.isCommentsInfo ? update.originChannelId! : update.chatId!,\n      update.isCommentsInfo ? update.originMessageId! : update.threadId!,\n      update,\n    );\n  });\n\n  return global;\n}\n\nexport function updateScheduledMessages<T extends GlobalState>(\n  global: T, chatId: string, newById: Record<number, ApiMessage>,\n): T {\n  const current = global.scheduledMessages.byChatId[chatId] || { byId: {}, hash: 0 };\n\n  return {\n    ...global,\n    scheduledMessages: {\n      byChatId: {\n        ...global.scheduledMessages.byChatId,\n        [chatId]: {\n          ...current,\n          byId: {\n            ...current.byId,\n            ...newById,\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function updateQuickReplyMessages<T extends GlobalState>(\n  global: T, update: Record<number, ApiMessage>,\n): T {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      messagesById: {\n        ...global.quickReplies.messagesById,\n        ...update,\n      },\n    },\n  };\n}\n\nexport function updateFocusedMessage<T extends GlobalState>(\n  global: T, update: Partial<TabState['focusedMessage']> | undefined, ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  if (!update) {\n    return updateTabState(global, { focusedMessage: undefined }, tabId);\n  }\n\n  return updateTabState(global, {\n    focusedMessage: {\n      ...selectTabState(global, tabId).focusedMessage,\n      ...update,\n    },\n  }, tabId);\n}\n\nexport function updateSponsoredMessage<T extends GlobalState>(\n  global: T, chatId: string, message: ApiSponsoredMessage,\n): T {\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      sponsoredByChatId: {\n        ...global.messages.sponsoredByChatId,\n        [chatId]: message,\n      },\n    },\n  };\n}\n\nexport function deleteSponsoredMessage<T extends GlobalState>(\n  global: T, chatId: string,\n): T {\n  const byChatId = global.messages.sponsoredByChatId;\n  if (!byChatId[chatId]) {\n    return global;\n  }\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      sponsoredByChatId: omit(byChatId, [chatId]),\n    },\n  };\n}\n\nexport function enterMessageSelectMode<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  messageId?: number | number[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const messageIds = messageId ? Array.prototype.concat([], messageId) : [];\n\n  return updateTabState(global, {\n    selectedMessages: {\n      chatId,\n      messageIds,\n    },\n  }, tabId);\n}\n\nexport function toggleMessageSelection<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId,\n  messageListType: MessageListType,\n  messageId: number,\n  groupedId?: string,\n  childMessageIds?: number[],\n  withShift = false,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  const { selectedMessages: oldSelectedMessages } = selectTabState(global, tabId);\n  if (groupedId) {\n    childMessageIds = selectMessageIdsByGroupId(global, chatId, groupedId);\n  }\n  const selectedMessageIds = childMessageIds || [messageId];\n  if (!oldSelectedMessages) {\n    return enterMessageSelectMode(global, chatId, selectedMessageIds, tabId);\n  }\n\n  const { messageIds } = oldSelectedMessages;\n\n  let newMessageIds;\n  const newSelectedMessageIds = selectedMessageIds.filter((id) => !messageIds.includes(id));\n  if (newSelectedMessageIds && !newSelectedMessageIds.length) {\n    newMessageIds = messageIds.filter((id) => !selectedMessageIds.includes(id));\n  } else if (withShift && messageIds.length) {\n    const viewportIds = selectCurrentMessageIds(global, chatId, threadId, messageListType, tabId)!;\n    const prevIndex = viewportIds.indexOf(messageIds[messageIds.length - 1]);\n    const currentIndex = viewportIds.indexOf(messageId);\n    const from = Math.min(prevIndex, currentIndex);\n    const to = Math.max(prevIndex, currentIndex);\n    const slice = viewportIds.slice(from, to + 1);\n    newMessageIds = unique([...messageIds, ...slice]);\n  } else {\n    newMessageIds = [...messageIds, ...newSelectedMessageIds];\n  }\n\n  if (!newMessageIds.length) {\n    return exitMessageSelectMode(global, tabId);\n  }\n\n  return updateTabState(global, {\n    selectedMessages: {\n      ...oldSelectedMessages,\n      messageIds: newMessageIds,\n    },\n  }, tabId);\n}\n\nexport function exitMessageSelectMode<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n): T {\n  return updateTabState(global, {\n    selectedMessages: undefined,\n  }, tabId);\n}\n\nexport function updateThreadUnreadFromForwardedMessage<T extends GlobalState>(\n  global: T,\n  originMessage: ApiMessage,\n  chatId: string,\n  lastMessageId: number,\n  isDeleting?: boolean,\n): T {\n  const { channelPostId, fromChatId } = originMessage.forwardInfo || {};\n  if (channelPostId && fromChatId) {\n    const threadInfoOld = selectThreadInfo(global, chatId, channelPostId);\n    if (threadInfoOld) {\n      global = replaceThreadParam(global, chatId, channelPostId, 'threadInfo', {\n        ...threadInfoOld,\n        lastMessageId,\n        messagesCount: (threadInfoOld.messagesCount || 0) + (isDeleting ? -1 : 1),\n      });\n    }\n  }\n  return global;\n}\n\nexport function addActiveMediaDownload<T extends GlobalState>(\n  global: T,\n  mediaHash: string,\n  metadata: TabState['activeDownloads'][string],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  global = updateTabState(global, {\n    activeDownloads: {\n      ...tabState.activeDownloads,\n      [mediaHash]: metadata,\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function cancelMessageMediaDownload<T extends GlobalState>(\n  global: T,\n  mediaHashes: string[],\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  const newActiveDownloads = omit(tabState.activeDownloads, mediaHashes);\n\n  global = updateTabState(global, {\n    activeDownloads: newActiveDownloads,\n  }, tabId);\n\n  return global;\n}\n\nexport function updateUploadByMessageKey<T extends GlobalState>(\n  global: T,\n  messageKey: MessageKey,\n  progress: number | undefined,\n) {\n  return {\n    ...global,\n    fileUploads: {\n      byMessageKey: progress !== undefined\n        ? {\n          ...global.fileUploads.byMessageKey,\n          [messageKey]: { progress },\n        }\n        : omit(global.fileUploads.byMessageKey, [messageKey]),\n    },\n  };\n}\n\nexport function updateQuickReplies<T extends GlobalState>(\n  global: T,\n  quickRepliesUpdate: Record<number, ApiQuickReply>,\n) {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      byId: {\n        ...global.quickReplies.byId,\n        ...quickRepliesUpdate,\n      },\n    },\n  };\n}\n\nexport function deleteQuickReply<T extends GlobalState>(\n  global: T,\n  quickReplyId: number,\n) {\n  return {\n    ...global,\n    quickReplies: {\n      ...global.quickReplies,\n      byId: omit(global.quickReplies.byId, [quickReplyId]),\n    },\n  };\n}\n\nexport function updateFullWebPage<T extends GlobalState>(\n  global: T,\n  webPageId: string,\n  update: Partial<ApiWebPageFull>,\n) {\n  const webpage = selectWebPage(global, webPageId);\n  const updatedWebpage = webpage?.webpageType === 'full'\n    ? { ...webpage, ...update }\n    : { webpageType: 'full', mediaType: 'webpage', ...update };\n\n  if (!updatedWebpage.id) {\n    return global;\n  }\n\n  return replaceWebPage(global, webPageId, updatedWebpage as ApiWebPageFull);\n}\n\nexport function replaceWebPage<T extends GlobalState>(\n  global: T,\n  webPageId: string,\n  webPage: ApiWebPage,\n) {\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      webPageById: {\n        ...global.messages.webPageById,\n        [webPageId]: webPage,\n      },\n    },\n  };\n}\n\nexport function updatePoll<T extends GlobalState>(\n  global: T,\n  pollId: string,\n  pollUpdate: Partial<ApiPoll>,\n) {\n  const poll = selectPoll(global, pollId);\n\n  const oldResults = poll?.results;\n  let newResults = oldResults || pollUpdate.results;\n  if (poll && pollUpdate.results?.results) {\n    if (!poll.results || !pollUpdate.results.isMin) {\n      newResults = pollUpdate.results;\n    } else if (oldResults.results) {\n      // Update voters counts, but keep local `isChosen` values\n      newResults = {\n        ...pollUpdate.results,\n        results: pollUpdate.results.results.map((result) => ({\n          ...result,\n          isChosen: oldResults.results!.find((r) => r.option === result.option)?.isChosen,\n        })),\n        isMin: undefined,\n      };\n    }\n  }\n\n  const updatedPoll = {\n    ...poll,\n    ...pollUpdate,\n    results: newResults,\n  } satisfies ApiPoll;\n  if (!updatedPoll.id) {\n    return global;\n  }\n\n  return {\n    ...global,\n    messages: {\n      ...global.messages,\n      pollById: {\n        ...global.messages.pollById,\n        [pollId]: updatedPoll,\n      },\n    },\n  };\n}\n\nexport function updatePollVote<T extends GlobalState>(\n  global: T,\n  pollId: string,\n  peerId: string,\n  options: string[],\n) {\n  const poll = selectPoll(global, pollId);\n  if (!poll) {\n    return global;\n  }\n\n  const { recentVoterIds, totalVoters, results } = poll.results;\n  const newRecentVoterIds = recentVoterIds ? [...recentVoterIds] : [];\n  const newTotalVoters = totalVoters ? totalVoters + 1 : 1;\n  const newResults = results ? [...results] : [];\n\n  newRecentVoterIds.push(peerId);\n\n  options.forEach((option) => {\n    const targetOptionIndex = newResults.findIndex((result) => result.option === option);\n    const targetOption = newResults[targetOptionIndex];\n    const updatedOption: ApiPollResult = targetOption ? { ...targetOption } : { option, votersCount: 0 };\n\n    updatedOption.votersCount += 1;\n    if (peerId === global.currentUserId) {\n      updatedOption.isChosen = true;\n    }\n\n    if (targetOptionIndex) {\n      newResults[targetOptionIndex] = updatedOption;\n    } else {\n      newResults.push(updatedOption);\n    }\n  });\n\n  return updatePoll(global, pollId, {\n    results: {\n      ...poll.results,\n      recentVoterIds: newRecentVoterIds,\n      totalVoters: newTotalVoters,\n      results: newResults,\n    },\n  });\n}\n\nexport function updateTypingDraft<T extends GlobalState>(\n  global: T,\n  chatId: string,\n  threadId: ThreadId | undefined = MAIN_THREAD_ID,\n  randomId: string,\n  text: ApiFormattedText,\n) {\n  const typingDraftStore = selectThreadParam(global, chatId, threadId, 'typingDraftIdByRandomId');\n  const messageId = typingDraftStore?.[randomId];\n  if (!messageId) {\n    return global;\n  }\n\n  global = updateChatMessage(global, chatId, messageId, {\n    content: {\n      text,\n    },\n  });\n  return global;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"thumb\":\"gYSfUe37\",\"thumb-opaque\":\"vbcXDDxa\",\"thumbOpaque\":\"vbcXDDxa\",\"no-transition\":\"AvU_FtMd\",\"noTransition\":\"AvU_FtMd\",\"media\":\"RrEzFxte\"};","import type { ElementRef, FC } from '../../lib/teact/teact';\nimport { memo, useMemo, useRef } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { ApiSticker } from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\n\nimport { getStickerMediaHash } from '../../global/helpers';\nimport { selectIsAlwaysHighPriorityEmoji } from '../../global/selectors';\nimport { IS_ANDROID, IS_IOS, IS_WEBM_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport * as mediaLoader from '../../util/mediaLoader';\n\nimport useThumbnail from '../../hooks/media/useThumbnail';\nimport useColorFilter from '../../hooks/stickers/useColorFilter';\nimport useCoordsInSharedCanvas from '../../hooks/useCoordsInSharedCanvas';\nimport useFlag from '../../hooks/useFlag';\nimport { useIsIntersecting } from '../../hooks/useIntersectionObserver';\nimport useMedia from '../../hooks/useMedia';\nimport useMediaTransition from '../../hooks/useMediaTransition';\nimport useMountAfterHeavyAnimation from '../../hooks/useMountAfterHeavyAnimation';\nimport useUniqueId from '../../hooks/useUniqueId';\nimport useDevicePixelRatio from '../../hooks/window/useDevicePixelRatio';\n\nimport OptimizedVideo from '../ui/OptimizedVideo';\nimport AnimatedSticker from './AnimatedSticker';\n\nimport styles from './StickerView.module.scss';\n\ntype OwnProps = {\n  containerRef: ElementRef<HTMLDivElement>;\n  sticker: ApiSticker;\n  thumbClassName?: string;\n  fullMediaHash?: string;\n  fullMediaClassName?: string;\n  isSmall?: boolean;\n  size?: number;\n  customColor?: string;\n  loopLimit?: number;\n  shouldLoop?: boolean;\n  shouldPreloadPreview?: boolean;\n  forceAlways?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  noLoad?: boolean;\n  noPlay?: boolean;\n  noVideoOnMobile?: boolean;\n  withSharedAnimation?: boolean;\n  sharedCanvasRef?: ElementRef<HTMLCanvasElement>;\n  withTranslucentThumb?: boolean; // With shared canvas thumbs are opaque by default to provide better transition effect\n  onVideoEnded?: AnyToVoidFunction;\n  onAnimatedStickerLoop?: AnyToVoidFunction;\n};\n\nconst SHARED_PREFIX = 'shared';\nconst STICKER_SIZE = 24;\n\nconst StickerView: FC<OwnProps> = ({\n  containerRef,\n  sticker,\n  thumbClassName,\n  fullMediaHash,\n  fullMediaClassName,\n  isSmall,\n  size = STICKER_SIZE,\n  customColor,\n  loopLimit,\n  shouldLoop = false,\n  shouldPreloadPreview,\n  forceAlways,\n  forceOnHeavyAnimation,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  noLoad,\n  noPlay,\n  noVideoOnMobile,\n  withSharedAnimation,\n  withTranslucentThumb,\n  sharedCanvasRef,\n  onVideoEnded,\n  onAnimatedStickerLoop,\n}) => {\n  const {\n    id, isLottie, stickerSetInfo, emoji,\n  } = sticker;\n  const [isVideoBroken, markVideoBroken] = useFlag();\n  const isUnsupportedVideo = sticker.isVideo && (\n    !IS_WEBM_SUPPORTED\n    || (noVideoOnMobile && (IS_IOS || IS_ANDROID))\n  );\n  const isVideo = sticker.isVideo;\n  const isStatic = !isLottie && !isVideo;\n  const previewMediaHash = getStickerMediaHash(sticker, 'preview');\n\n  const dpr = useDevicePixelRatio();\n\n  const filterStyle = useColorFilter(customColor);\n\n  const isIntersectingForLoading = useIsIntersecting(containerRef, observeIntersectionForLoading);\n  const shouldLoad = isIntersectingForLoading && !noLoad;\n  const isIntersectingForPlaying = (\n    useIsIntersecting(containerRef, observeIntersectionForPlaying)\n    && isIntersectingForLoading\n  );\n  const shouldPlay = isIntersectingForPlaying && !noPlay;\n  const hasIntersectedForPlayingRef = useRef(isIntersectingForPlaying);\n  if (!hasIntersectedForPlayingRef.current && isIntersectingForPlaying) {\n    hasIntersectedForPlayingRef.current = true;\n  }\n\n  const cachedPreview = mediaLoader.getFromMemory(previewMediaHash);\n  const isReadyToMountFullMedia = useMountAfterHeavyAnimation(hasIntersectedForPlayingRef.current);\n  const shouldForcePreview = isUnsupportedVideo || (isStatic ? isSmall : noPlay);\n  const shouldLoadPreview = !customColor && !cachedPreview && (!isReadyToMountFullMedia || shouldForcePreview);\n  const previewMediaData = useMedia(previewMediaHash, !shouldLoadPreview);\n  const withPreview = shouldLoadPreview || cachedPreview;\n\n  const shouldSkipLoadingFullMedia = Boolean(shouldForcePreview || (\n    fullMediaHash === previewMediaHash && (cachedPreview || previewMediaData)\n  ));\n  const fullMediaData = useMedia(fullMediaHash || `sticker${id}`, !shouldLoad || shouldSkipLoadingFullMedia);\n  const shouldRenderFullMedia = isReadyToMountFullMedia && Boolean(fullMediaData) && !isVideoBroken;\n  const [isPlayerReady, markPlayerReady] = useFlag();\n  const isFullMediaReady = shouldRenderFullMedia && (isStatic || isPlayerReady);\n\n  const thumbDataUri = useThumbnail(sticker.thumbnail);\n  const thumbData = cachedPreview || previewMediaData || thumbDataUri;\n  const isThumbOpaque = sharedCanvasRef && !withTranslucentThumb;\n\n  const noCrossTransition = Boolean(isLottie && withPreview);\n  const { ref: thumbRef } = useMediaTransition<HTMLImageElement>({\n    hasMediaData: Boolean(thumbData && !isFullMediaReady),\n    noCloseTransition: noCrossTransition,\n  });\n  const { ref: fullMediaRef } = useMediaTransition<HTMLElement>({\n    hasMediaData: isFullMediaReady,\n    noOpenTransition: noCrossTransition,\n  });\n\n  const coords = useCoordsInSharedCanvas(containerRef, sharedCanvasRef);\n\n  // Preload preview for Message Input and local message\n  useMedia(previewMediaHash, !shouldLoad || !shouldPreloadPreview);\n\n  const randomIdPrefix = useUniqueId();\n  const renderId = useMemo(() => ([\n    (withSharedAnimation ? SHARED_PREFIX : randomIdPrefix),\n    id,\n    size,\n    (withSharedAnimation ? customColor : undefined),\n    dpr,\n  ].filter(Boolean).join('_')\n  ), [id, size, customColor, dpr, withSharedAnimation, randomIdPrefix]);\n\n  return (\n    <>\n      <img\n        ref={thumbRef}\n        src={thumbData}\n        className={buildClassName(\n          styles.thumb,\n          noCrossTransition && styles.noTransition,\n          isThumbOpaque && styles.thumbOpaque,\n          thumbClassName,\n          'sticker-media',\n        )}\n        style={filterStyle}\n        alt=\"\"\n        draggable={false}\n      />\n      {shouldRenderFullMedia && (isLottie ? (\n        <AnimatedSticker\n          ref={fullMediaRef as ElementRef<HTMLDivElement>}\n          key={renderId}\n          renderId={renderId}\n          size={size}\n          className={buildClassName(\n            styles.media,\n            (noCrossTransition || isThumbOpaque) && styles.noTransition,\n            fullMediaClassName,\n          )}\n          tgsUrl={fullMediaData}\n          play={shouldPlay}\n          noLoop={!shouldLoop}\n          forceOnHeavyAnimation={forceAlways || forceOnHeavyAnimation}\n          forceAlways={forceAlways}\n          isLowPriority={isSmall && !selectIsAlwaysHighPriorityEmoji(getGlobal(), stickerSetInfo)}\n          sharedCanvas={sharedCanvasRef?.current || undefined}\n          sharedCanvasCoords={coords}\n          onLoad={markPlayerReady}\n          onLoop={onAnimatedStickerLoop}\n          onEnded={onAnimatedStickerLoop}\n          color={customColor}\n        />\n      ) : isVideo ? (\n        <OptimizedVideo\n          ref={fullMediaRef as ElementRef<HTMLVideoElement>}\n          canPlay={shouldPlay}\n          className={buildClassName(styles.media, fullMediaClassName, 'sticker-media')}\n          src={fullMediaData}\n          playsInline\n          muted\n          loop={shouldLoop && !loopLimit}\n          isPriority={forceAlways}\n          disablePictureInPicture\n          onReady={markPlayerReady}\n          onBroken={markVideoBroken}\n          onEnded={onVideoEnded}\n          style={filterStyle}\n        />\n      ) : (\n        <img\n          ref={fullMediaRef as ElementRef<HTMLImageElement>}\n          className={buildClassName(styles.media, fullMediaClassName, 'sticker-media')}\n          src={fullMediaData}\n          alt={emoji}\n          style={filterStyle}\n          draggable={false}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default memo(StickerView);\n","import { getIsHeavyAnimating, useEffect, useSignal } from '../lib/teact/teact';\n\nimport useDerivedState from './useDerivedState';\n\nexport default function useMountAfterHeavyAnimation(hasIntersected: boolean) {\n  const [getNoHeavyAnimation, setNoHeavyAnimation] = useSignal(false);\n\n  const $getIsHeavyAnimating = getIsHeavyAnimating;\n\n  // Animation is usually started right after the mount, so we use effect to check for it on the next frame\n  useEffect(() => {\n    if (!$getIsHeavyAnimating()) {\n      setNoHeavyAnimation(true);\n    }\n  }, [$getIsHeavyAnimating, setNoHeavyAnimation]);\n\n  return useDerivedState(() => (getNoHeavyAnimation() && hasIntersected), [getNoHeavyAnimation, hasIntersected]);\n}\n","import useShowTransitionDeprecated from './useShowTransitionDeprecated';\n\nexport default function useMediaTransitionDeprecated(mediaData?: unknown) {\n  const isMediaReady = Boolean(mediaData);\n  const { transitionClassNames } = useShowTransitionDeprecated(isMediaReady, undefined, isMediaReady, 'slow');\n\n  return transitionClassNames;\n}\n","import { useSignal } from '../lib/teact/teact';\n\nimport type { Signal } from '../util/signals';\n\nimport { useSignalEffect } from './useSignalEffect';\nimport { useStateRef } from './useStateRef';\nimport useSyncEffect from './useSyncEffect';\n\ntype SyncResolver<T> = () => T;\ntype AsyncResolver<T> = (setter: (newValue: T) => void) => void;\ntype Resolver<T> =\n  SyncResolver<T>\n  | AsyncResolver<T>;\n\nfunction useDerivedSignal<T>(resolver: SyncResolver<T>, dependencies: readonly any[]): Signal<T>;\nfunction useDerivedSignal<T>(resolver: AsyncResolver<T>, dependencies: readonly any[], isAsync: true): Signal<T>;\nfunction useDerivedSignal<T>(dependency: T): Signal<T>;\n\nfunction useDerivedSignal<T>(resolverOrDependency: Resolver<T> | T, dependencies?: readonly any[], isAsync = false) {\n  const resolver = dependencies ? resolverOrDependency as Resolver<T> : () => (resolverOrDependency as T);\n  dependencies ??= [resolverOrDependency];\n\n  const [getValue, setValue] = useSignal<T>();\n  const resolverRef = useStateRef(resolver);\n\n  function runCurrentResolver() {\n    const currentResolver = resolverRef.current;\n    if (isAsync) {\n      (currentResolver as AsyncResolver<T>)(setValue);\n    } else {\n      setValue((currentResolver as SyncResolver<T>)());\n    }\n  }\n\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  useSyncEffect(runCurrentResolver, dependencies);\n\n  useSignalEffect(runCurrentResolver, dependencies);\n\n  return getValue as Signal<T>;\n}\n\nexport default useDerivedSignal;\n","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiLanguage,\n  LangPackStringValue,\n  LangPackStringValueDeleted,\n  LangPackStringValuePlural,\n  LangPackStringValueRegular,\n} from '../../api/types';\nimport type { TextFilter } from '../../components/common/helpers/renderText';\nimport type {\n  LangPairPluralWithVariables,\n  LangPairWithVariables,\n  LangVariable,\n  PluralLangKey,\n  PluralLangKeyWithVariables,\n  RegularLangKey,\n  RegularLangKeyWithVariables,\n} from '../../types/language';\n\nexport interface LangFnOptionsRegular {\n  withNodes?: never;\n  withMarkdown?: never;\n  pluralValue?: never;\n}\n\nexport type LangFnOptionsWithPlural = Omit<LangFnOptionsRegular, 'pluralValue'> & {\n  pluralValue: number;\n};\n\nexport type LangFnOptions = LangFnOptionsRegular | LangFnOptionsWithPlural;\n\nexport interface AdvancedLangFnOptionsRegular {\n  withNodes: true;\n  withMarkdown?: boolean;\n  pluralValue?: never;\n  renderTextFilters?: TextFilter[];\n  specialReplacement?: Record<string, TeactNode>;\n}\n\nexport type AdvancedLangFnOptionsWithPlural = Omit<AdvancedLangFnOptionsRegular, 'pluralValue'> & {\n  pluralValue: number;\n};\n\nexport type AdvancedLangFnOptions = AdvancedLangFnOptionsRegular | AdvancedLangFnOptionsWithPlural;\n\ntype LangPairWithNodes = LangPairWithVariables<TeactNode | undefined>;\ntype LangPairPluralWithNodes = LangPairPluralWithVariables<TeactNode | undefined>;\n\ntype RegularLangFnParametersWithoutVariables = {\n  key: RegularLangKey;\n  variables?: undefined;\n  options?: LangFnOptions;\n};\n\ntype RegularLangFnParametersWithVariables<T = LangPairWithVariables> = {\n  [K in keyof T]: {\n    key: K;\n    variables: {\n      [key in keyof T[K]]: LangVariable | RegularLangFnParameters;\n    };\n    options?: LangFnOptions;\n  }\n}[keyof T];\n\ntype RegularLangFnPluralParameters = {\n  key: PluralLangKey;\n  variables?: undefined;\n  options: LangFnOptionsWithPlural;\n};\n\ntype RegularLangFnPluralParametersWithVariables<T = LangPairPluralWithVariables> = {\n  [K in keyof T]: {\n    key: K;\n    variables: {\n      [key in keyof T[K]]: LangVariable | RegularLangFnParameters;\n    };\n    options: LangFnOptionsWithPlural;\n  }\n}[keyof T];\n\nexport type RegularLangFnParameters =\n  | RegularLangFnParametersWithoutVariables\n  | RegularLangFnParametersWithVariables\n  | RegularLangFnPluralParameters\n  | RegularLangFnPluralParametersWithVariables;\n\ntype AdvancedLangFnParametersWithoutVariables = {\n  key: RegularLangKey;\n  variables?: undefined;\n  options: AdvancedLangFnOptions;\n};\n\ntype AdvancedLangFnParametersWithVariables<T = LangPairWithNodes> = {\n  [K in keyof T]: {\n    key: K;\n    variables: T[K];\n    options: AdvancedLangFnOptions;\n  }\n}[keyof T];\n\ntype AdvancedLangFnPluralParameters = {\n  key: PluralLangKey;\n  variables?: undefined;\n  options: AdvancedLangFnOptionsWithPlural;\n};\n\ntype AdvancedLangFnPluralParametersWithVariables<T = LangPairPluralWithNodes> = {\n  [K in keyof T]: {\n    key: K;\n    variables: T[K];\n    options: AdvancedLangFnOptionsWithPlural;\n  }\n}[keyof T];\n\nexport type AdvancedLangFnParameters =\n  | AdvancedLangFnParametersWithoutVariables\n  | AdvancedLangFnParametersWithVariables\n  | AdvancedLangFnPluralParameters\n  | AdvancedLangFnPluralParametersWithVariables;\n\nexport type LangFnParameters = RegularLangFnParameters | AdvancedLangFnParameters;\n\nexport type LangFn = {\n  <K extends RegularLangKey = RegularLangKey>(\n    key: K, variables?: undefined, options?: LangFnOptions,\n  ): string;\n  <K extends PluralLangKey = PluralLangKey>(\n    key: K, variables: undefined, options: LangFnOptionsWithPlural,\n  ): string;\n  <K extends RegularLangKeyWithVariables = RegularLangKeyWithVariables>(\n    key: K, variables: LangPairWithVariables[K], options?: LangFnOptions,\n  ): string;\n  <K extends PluralLangKeyWithVariables = PluralLangKeyWithVariables>(\n    key: K, variables: LangPairPluralWithVariables[K], options: LangFnOptionsWithPlural,\n  ): string;\n\n  <K extends RegularLangKey = RegularLangKey>(\n    key: K, variables?: undefined, options?: AdvancedLangFnOptions,\n  ): TeactNode;\n  <K extends PluralLangKey = PluralLangKey>(\n    key: K, variables: undefined, options: AdvancedLangFnOptionsWithPlural,\n  ): TeactNode;\n  <K extends RegularLangKeyWithVariables = RegularLangKeyWithVariables>(\n    key: K, variables: LangPairWithVariables<TeactNode | undefined>[K], options: AdvancedLangFnOptions,\n  ): TeactNode;\n  <K extends PluralLangKeyWithVariables = PluralLangKeyWithVariables>(\n    key: K, variables: LangPairPluralWithVariables<TeactNode | undefined>[K], options: AdvancedLangFnOptionsWithPlural,\n  ): TeactNode;\n\n  with: (params: LangFnParameters) => TeactNode;\n  withRegular: (params: RegularLangFnParameters) => string;\n  withAdvanced: (params: AdvancedLangFnParameters) => TeactNode;\n  region: (code: string) => string | undefined;\n  conjunction: (list: string[]) => string;\n  disjunction: (list: string[]) => string;\n  number: (value: number) => string;\n  preciseNumber: (value: number) => string;\n  internalFormatters: LangFormatters;\n  isRtl?: boolean;\n  rawCode: string;\n  code: string;\n  languageInfo: ApiLanguage;\n};\n\n// Allow basic polyfill\ntype ListFormat = Pick<Intl.ListFormat, 'format' | 'formatToParts'>;\n\nexport type LangFormatters = {\n  pluralRules: Intl.PluralRules;\n  region: Intl.DisplayNames;\n  conjunction: ListFormat;\n  disjunction: ListFormat;\n  number: Intl.NumberFormat;\n  preciseNumber: Intl.NumberFormat;\n};\n\n/* GUARDS */\n\nexport function isDeletedLangString(string: LangPackStringValue): string is LangPackStringValueDeleted {\n  return typeof string === 'object' && 'isDeleted' in string;\n}\n\nexport function isRegularLangString(string: LangPackStringValue): string is LangPackStringValueRegular {\n  return typeof string === 'string';\n}\n\nexport function isPluralLangString(string: LangPackStringValue): string is LangPackStringValuePlural {\n  return !isRegularLangString(string) && !isDeletedLangString(string);\n}\n\nexport function isLangFnParam(object: unknown): object is LangFnParameters {\n  return Boolean(object) && typeof object === 'object' && 'key' in object! && !('type' in object);\n}\n\nexport function areAdvancedLangFnOptions(\n  params: LangFnOptions | AdvancedLangFnOptions,\n): params is AdvancedLangFnOptions {\n  return 'withNodes' in params && Boolean(params.withNodes);\n}\n","import type React from '../lib/teact/teact';\n\nconst stopEvent = (e: React.UIEvent | Event | React.FormEvent) => {\n  e.stopPropagation();\n  e.preventDefault();\n};\n\nexport default stopEvent;\n","import { throttle } from './schedulers';\n\nconst KEYS_TO_IGNORE = new Set([\n  'TeactMemoWrapper renders',\n  'TeactNContainer renders',\n  'Button renders',\n]);\nconst MIN_RENDERS_TO_SHOW = 5;\nconst MIN_DURATION_TO_SHOW = 2;\nconst BG_GREEN = ' style=\"background: lightgreen\"';\n\nlet counters: Record<string, {\n  value: number;\n  lastUpdateAt: number;\n}> = {};\n\nconst renderCountersThrottled = throttle(renderCounters, 500, false);\n\nlet loggerEl: HTMLDivElement;\n\nexport function debugToOverlay(text: string) {\n  if (!loggerEl) {\n    setupOverlay();\n  }\n\n  const date = new Date();\n  const dateFormatted = `${date.toLocaleTimeString()}.${date.getMilliseconds()}`;\n  const wasAtBottom = loggerEl.scrollTop + 10 >= loggerEl.scrollHeight - loggerEl.offsetHeight;\n\n  loggerEl.innerHTML += `${dateFormatted}: ${text}<br/>`;\n\n  if (wasAtBottom) {\n    loggerEl.scrollTop = loggerEl.scrollHeight;\n  }\n}\n\nexport function incrementOverlayCounter(key: string, value = 1) {\n  const now = Date.now();\n  if (!counters[key]) {\n    counters[key] = { value, lastUpdateAt: now };\n  } else {\n    counters[key].value += value;\n    counters[key].lastUpdateAt = now;\n  }\n\n  renderCountersThrottled();\n}\n\nexport function renderCounters() {\n  if (!loggerEl) {\n    setupOverlay();\n  }\n\n  const halfSecondAgo = Date.now() - 500;\n  const [maxRenders, maxDuration] = Object.entries(counters).reduce((acc, [key, { value }]) => {\n    if (KEYS_TO_IGNORE.has(key)) {\n      return acc;\n    }\n\n    if (key.includes('renders') && value > acc[0]) {\n      acc[0] = value;\n    }\n\n    if (key.includes('duration') && value > acc[1]) {\n      acc[1] = value;\n    }\n\n    return acc;\n  }, [0, 0]);\n\n  loggerEl.innerHTML = Object\n    .entries(counters)\n    .filter(([key, { value }]) => (\n      (!KEYS_TO_IGNORE.has(key)) && (\n        (key.includes('renders') && value > MIN_RENDERS_TO_SHOW)\n        || (key.includes('duration') && value > MIN_DURATION_TO_SHOW)\n      )\n    ))\n    .sort((a, b) => (\n      b[1].lastUpdateAt - a[1].lastUpdateAt\n    ))\n    .map(([key, { value, lastUpdateAt }]) => ([\n      `<div style=\"background: #ff0000${factorToHex(value / (key.includes('renders') ? maxRenders : maxDuration))}\">`,\n      `  <span${lastUpdateAt > halfSecondAgo ? BG_GREEN : ''}>${key}: ${Math.round(value)}</span>`,\n      '</div>',\n    ].join('\\n')))\n    .join('\\n');\n}\n\nfunction setupOverlay() {\n  loggerEl = document.createElement('div');\n  loggerEl.style.cssText = 'position: absolute; left: 0; bottom: 25px; z-index: 9998; width: 260px; height: 200px;'\n    + ' border: 1px solid #555; background: rgba(255, 255, 255, 0.9); overflow: auto; font-size: 10px;';\n  document.body.appendChild(loggerEl);\n\n  const clearEl = document.createElement('a');\n  clearEl.style.cssText = 'position: absolute; left: 222px; bottom: 198px; z-index: 9999; font-size: 20px; '\n    + 'cursor: pointer;';\n  clearEl.innerText = '';\n  clearEl.addEventListener('click', () => {\n    counters = {};\n    renderCountersThrottled();\n  });\n  document.body.appendChild(clearEl);\n}\n\nfunction factorToHex(factor: number) {\n  return Math.round(255 * factor).toString(16).padStart(2, '0');\n}\n","import type { ReactElement } from 'react';\n\nimport { DEBUG, DEBUG_MORE } from '../../config';\nimport { logUnequalProps } from '../../util/arePropsShallowEqual';\nimport { incrementOverlayCounter } from '../../util/debugOverlay';\nimport { orderBy } from '../../util/iteratees';\nimport safeExec from '../../util/safeExec';\nimport { throttleWith } from '../../util/schedulers';\nimport { createSignal, isSignal, type Signal } from '../../util/signals';\nimport { requestMeasure, requestMutation } from '../fasterdom/fasterdom';\nimport { getIsBlockingAnimating } from './heavyAnimation';\n\nexport { getIsHeavyAnimating, beginHeavyAnimation, onFullyIdle } from './heavyAnimation';\n\nexport type Props = AnyLiteral;\nexport type FC<P extends Props = any> = (props: P) => any;\nexport type FC_withDebug =\n  FC\n  & { DEBUG_contentComponentName?: string };\n\nexport enum VirtualType {\n  Empty,\n  Text,\n  Tag,\n  Component,\n  Fragment,\n}\n\ninterface VirtualElementEmpty {\n  type: VirtualType.Empty;\n  target?: Node;\n}\n\ninterface VirtualElementText {\n  type: VirtualType.Text;\n  target?: Node;\n  value: string;\n}\n\nexport interface VirtualElementTag {\n  type: VirtualType.Tag;\n  target?: HTMLElement | SVGElement;\n  tag: string;\n  props: Props;\n  children: VirtualElementChildren;\n}\n\nexport interface VirtualElementComponent {\n  type: VirtualType.Component;\n  componentInstance: ComponentInstance;\n  props: Props;\n  children: VirtualElementChildren;\n}\n\nexport interface VirtualElementFragment {\n  type: VirtualType.Fragment;\n  children: VirtualElementChildren;\n  placeholderTarget?: Comment;\n}\n\nexport type StateHookSetter<T> = (newValue: ((current: T) => T) | T) => void;\n\nexport interface RefObject<T = unknown> {\n  current: T;\n  onChange?: NoneToVoidFunction;\n}\n\nexport type ElementRef<T = HTMLElement> = RefObject<T | undefined>;\n\nexport enum MountState {\n  Mounting,\n  Mounted,\n  Unmounted,\n}\n\ninterface ComponentInstance {\n  id: number;\n  $element: VirtualElementComponent;\n  Component: FC;\n  name: string;\n  props: Props;\n  renderedValue?: any;\n  mountState: MountState;\n  context?: Record<string, Signal<unknown>>;\n  hooks?: {\n    state?: {\n      cursor: number;\n      byCursor: {\n        value: any;\n        nextValue: any;\n        setter: StateHookSetter<any>;\n      }[];\n    };\n    effects?: {\n      cursor: number;\n      byCursor: {\n        dependencies?: readonly unknown[];\n        schedule?: NoneToVoidFunction;\n        cleanup?: NoneToVoidFunction;\n        releaseSignals?: NoneToVoidFunction;\n      }[];\n    };\n    memos?: {\n      cursor: number;\n      byCursor: {\n        value: any;\n        dependencies: readonly unknown[];\n      }[];\n    };\n    refs?: {\n      cursor: number;\n      byCursor: RefObject[];\n    };\n  };\n  prepareForFrame?: () => void;\n  forceUpdate?: () => void;\n  onUpdate?: () => void;\n}\n\nexport type VirtualElement =\n  VirtualElementEmpty\n  | VirtualElementText\n  | VirtualElementTag\n  | VirtualElementComponent\n  | VirtualElementFragment;\nexport type VirtualElementParent =\n  VirtualElementTag\n  | VirtualElementComponent\n  | VirtualElementFragment;\nexport type VirtualElementChildren = VirtualElement[];\nexport type VirtualElementReal = Exclude<VirtualElement, VirtualElementComponent | VirtualElementFragment>;\n\n// Compatibility with JSX types\nexport type TeactNode =\n  ReactElement\n  | string\n  | number\n  | boolean\n  | undefined\n  | TeactNode[];\n\ntype Effect = () => (NoneToVoidFunction | void);\ntype EffectCleanup = NoneToVoidFunction;\n\nexport type Context<T> = {\n  defaultValue?: T;\n  contextId: string;\n  Provider: FC<{ value: T; children: TeactNode }>;\n};\n\nconst Fragment = Symbol('Fragment') as unknown as FC<{ children: TeactNode }>;\n\nconst DEBUG_RENDER_THRESHOLD = 7;\nconst DEBUG_EFFECT_THRESHOLD = 7;\nconst DEBUG_SILENT_RENDERS_FOR = new Set(['TeactMemoWrapper', 'TeactNContainer', 'Button', 'ListItem', 'MenuItem']);\n\nlet contextCounter = 0;\n\nlet lastComponentId = 0;\nlet renderingInstance: ComponentInstance;\n\nexport function isParentElement($element: VirtualElement): $element is VirtualElementParent {\n  return (\n    $element.type === VirtualType.Tag\n    || $element.type === VirtualType.Component\n    || $element.type === VirtualType.Fragment\n  );\n}\n\nfunction createElement(\n  source: string | FC | typeof Fragment,\n  props: Props,\n  ...children: any[]\n): VirtualElementParent | VirtualElementChildren {\n  if (source === Fragment) {\n    return buildFragmentElement(children);\n  } else if (typeof source === 'function') {\n    return createComponentInstance(source, props || {}, children);\n  } else {\n    return buildTagElement(source, props || {}, children);\n  }\n}\n\nfunction buildFragmentElement(children: any[]): VirtualElementFragment {\n  return {\n    type: VirtualType.Fragment,\n    children: buildChildren(children, true),\n  };\n}\n\nfunction createComponentInstance(Component: FC, props: Props, children: any[]): VirtualElementComponent {\n  if (children?.length) {\n    props.children = children.length === 1 ? children[0] : children;\n  }\n\n  const componentInstance: ComponentInstance = {\n    id: -1,\n    $element: undefined as unknown as VirtualElementComponent,\n    Component,\n    name: Component.name,\n    props,\n    mountState: MountState.Unmounted,\n  };\n\n  componentInstance.$element = buildComponentElement(componentInstance);\n\n  return componentInstance.$element;\n}\n\nfunction buildComponentElement(\n  componentInstance: ComponentInstance,\n  children?: VirtualElementChildren,\n): VirtualElementComponent {\n  return {\n    type: VirtualType.Component,\n    componentInstance,\n    props: componentInstance.props,\n    children: children ? buildChildren(children, true) : [],\n  };\n}\n\nfunction buildTagElement(tag: string, props: Props, children: any[]): VirtualElementTag {\n  return {\n    type: VirtualType.Tag,\n    tag,\n    props,\n    children: buildChildren(children),\n  };\n}\n\nfunction buildChildren(children: any[], noEmpty = false): VirtualElement[] {\n  const cleanChildren = dropEmptyTail(children, noEmpty);\n  const newChildren = [];\n\n  for (let i = 0, l = cleanChildren.length; i < l; i++) {\n    const child = cleanChildren[i];\n    if (Array.isArray(child)) {\n      newChildren.push(...buildChildren(child, noEmpty));\n    } else {\n      newChildren.push(buildChildElement(child));\n    }\n  }\n\n  return newChildren;\n}\n\n// We only need placeholders in the middle of collection (to ensure other elements order).\nfunction dropEmptyTail(children: any[], noEmpty = false) {\n  let i = children.length - 1;\n\n  for (; i >= 0; i--) {\n    if (!isEmptyPlaceholder(children[i])) {\n      break;\n    }\n  }\n\n  if (i === children.length - 1) {\n    return children;\n  }\n\n  if (i === -1 && noEmpty) {\n    return children.slice(0, 1);\n  }\n\n  return children.slice(0, i + 1);\n}\n\nfunction isEmptyPlaceholder(child: any) {\n  return !child && child !== 0;\n}\n\nfunction buildChildElement(child: any): VirtualElement {\n  if (isEmptyPlaceholder(child)) {\n    return { type: VirtualType.Empty };\n  } else if (isParentElement(child)) {\n    return child;\n  } else {\n    return {\n      type: VirtualType.Text,\n      value: String(child),\n    };\n  }\n}\n\nconst DEBUG_components: AnyLiteral = { TOTAL: { name: 'TOTAL', renders: 0 } };\nconst DEBUG_memos: Record<string, { key: string; calls: number; misses: number; hitRate: number }> = {};\nconst DEBUG_MEMOS_CALLS_THRESHOLD = 20;\n\nif (DEBUG) {\n  document.addEventListener('dblclick', () => {\n    // eslint-disable-next-line no-console\n    console.warn('COMPONENTS', orderBy(\n      Object\n        .values(DEBUG_components)\n        .map(({ avgRenderTime, ...state }) => {\n          return { ...state, ...(avgRenderTime !== undefined && { avgRenderTime: Number(avgRenderTime.toFixed(2)) }) };\n        }),\n      'renders',\n      'desc',\n    ));\n\n    // eslint-disable-next-line no-console\n    console.warn('MEMOS', orderBy(\n      Object\n        .values(DEBUG_memos)\n        .filter(({ calls }) => calls >= DEBUG_MEMOS_CALLS_THRESHOLD)\n        .map((state) => ({ ...state, hitRate: Number(state.hitRate.toFixed(2)) })),\n      'hitRate',\n      'asc',\n    ));\n  });\n}\n\nlet instancesPendingUpdate = new Set<ComponentInstance>();\nlet idsToExcludeFromUpdate = new Set<number>();\nlet pendingEffects = new Map<string, Effect>();\nlet pendingCleanups = new Map<string, EffectCleanup>();\nlet pendingLayoutEffects = new Map<string, Effect>();\nlet pendingLayoutCleanups = new Map<string, EffectCleanup>();\nlet areImmediateEffectsCaptured = false;\n\n/*\n  Order:\n  - component effect cleanups\n  - component effects\n  - measure tasks\n  - mutation tasks\n  - component updates\n  - component layout effect cleanups\n  - component layout effects\n  - forced layout measure tasks\n  - forced layout mutation tasks\n */\n\nconst runUpdatePassOnRaf = throttleWith(requestMeasure, () => {\n  if (getIsBlockingAnimating()) {\n    getIsBlockingAnimating.once(runUpdatePassOnRaf);\n    return;\n  }\n\n  const runImmediateEffects = captureImmediateEffects();\n\n  idsToExcludeFromUpdate = new Set();\n  const instancesToUpdate = Array\n    .from(instancesPendingUpdate)\n    .sort((a, b) => a.id - b.id);\n  instancesPendingUpdate = new Set();\n\n  const currentCleanups = pendingCleanups;\n  pendingCleanups = new Map();\n  currentCleanups.forEach((cb) => cb());\n\n  const currentEffects = pendingEffects;\n  pendingEffects = new Map();\n  currentEffects.forEach((cb) => cb());\n\n  requestMutation(() => {\n    instancesToUpdate.forEach(prepareComponentForFrame);\n    instancesToUpdate.forEach((instance) => {\n      if (idsToExcludeFromUpdate.has(instance.id)) {\n        return;\n      }\n\n      forceUpdateComponent(instance);\n    });\n\n    runImmediateEffects?.();\n  });\n});\n\nexport function captureImmediateEffects() {\n  if (areImmediateEffectsCaptured) {\n    return undefined;\n  }\n\n  areImmediateEffectsCaptured = true;\n  return runCapturedImmediateEffects;\n}\n\nfunction runCapturedImmediateEffects() {\n  const currentLayoutCleanups = pendingLayoutCleanups;\n  pendingLayoutCleanups = new Map();\n  currentLayoutCleanups.forEach((cb) => cb());\n\n  const currentLayoutEffects = pendingLayoutEffects;\n  pendingLayoutEffects = new Map();\n  currentLayoutEffects.forEach((cb) => cb());\n\n  areImmediateEffectsCaptured = false;\n}\n\nexport function renderComponent(componentInstance: ComponentInstance) {\n  idsToExcludeFromUpdate.add(componentInstance.id);\n\n  const { Component, props } = componentInstance;\n  let newRenderedValue: unknown;\n\n  safeExec(() => {\n    renderingInstance = componentInstance;\n    if (componentInstance.hooks) {\n      if (componentInstance.hooks.state) {\n        componentInstance.hooks.state.cursor = 0;\n      }\n      if (componentInstance.hooks.effects) {\n        componentInstance.hooks.effects.cursor = 0;\n      }\n      if (componentInstance.hooks.memos) {\n        componentInstance.hooks.memos.cursor = 0;\n      }\n      if (componentInstance.hooks.refs) {\n        componentInstance.hooks.refs.cursor = 0;\n      }\n    }\n\n    let DEBUG_startAt: number | undefined;\n    if (DEBUG) {\n      const componentName = DEBUG_resolveComponentName(Component);\n      if (!DEBUG_components[componentName]) {\n        DEBUG_components[componentName] = {\n          name: componentName,\n          renders: 0,\n          avgRenderTime: 0,\n        };\n      }\n\n      if (DEBUG_MORE) {\n        if (!DEBUG_SILENT_RENDERS_FOR.has(componentName)) {\n          // eslint-disable-next-line no-console\n          console.log(`[Teact] Render ${componentName}`);\n        }\n      }\n\n      DEBUG_startAt = performance.now();\n    }\n\n    newRenderedValue = Component(props);\n\n    if (DEBUG) {\n      const duration = performance.now() - DEBUG_startAt!;\n      const componentName = DEBUG_resolveComponentName(Component);\n      if (duration > DEBUG_RENDER_THRESHOLD) {\n        // eslint-disable-next-line no-console\n        console.warn(`[Teact] Slow component render: ${componentName}, ${Math.round(duration)} ms`);\n      }\n\n      const { renders, avgRenderTime } = DEBUG_components[componentName];\n      DEBUG_components[componentName].avgRenderTime = (avgRenderTime * renders + duration) / (renders + 1);\n      DEBUG_components[componentName].renders++;\n      DEBUG_components.TOTAL.renders++;\n\n      if (DEBUG_MORE) {\n        incrementOverlayCounter(`${componentName} renders`);\n        incrementOverlayCounter(`${componentName} duration`, duration);\n      }\n    }\n  }, {\n    rescue: () => {\n      // eslint-disable-next-line no-console\n      console.error(`[Teact] Error while rendering component ${componentInstance.name}`, componentInstance);\n\n      newRenderedValue = componentInstance.renderedValue;\n    },\n  });\n\n  if (componentInstance.mountState === MountState.Mounted && newRenderedValue === componentInstance.renderedValue) {\n    return componentInstance.$element;\n  }\n\n  componentInstance.renderedValue = newRenderedValue;\n  const children = Array.isArray(newRenderedValue) ? newRenderedValue : [newRenderedValue];\n  componentInstance.$element = buildComponentElement(componentInstance, children);\n\n  return componentInstance.$element;\n}\n\nexport function hasElementChanged($old: VirtualElement, $new: VirtualElement) {\n  if (typeof $old !== typeof $new) {\n    return true;\n  } else if ($old.type !== $new.type) {\n    return true;\n  } else if ($old.type === VirtualType.Text && $new.type === VirtualType.Text) {\n    return $old.value !== $new.value;\n  } else if ($old.type === VirtualType.Tag && $new.type === VirtualType.Tag) {\n    return ($old.tag !== $new.tag) || ($old.props.key !== $new.props.key);\n  } else if ($old.type === VirtualType.Component && $new.type === VirtualType.Component) {\n    return (\n      $old.componentInstance.Component !== $new.componentInstance.Component\n    ) || (\n      $old.props.key !== $new.props.key\n    );\n  }\n\n  return false;\n}\n\nexport function mountComponent(componentInstance: ComponentInstance) {\n  componentInstance.id = ++lastComponentId;\n  componentInstance.mountState = MountState.Mounting;\n  renderComponent(componentInstance);\n  componentInstance.mountState = MountState.Mounted;\n  return componentInstance.$element;\n}\n\nexport function unmountComponent(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted) {\n    return;\n  }\n\n  idsToExcludeFromUpdate.add(componentInstance.id);\n\n  if (componentInstance.hooks?.effects) {\n    for (const effect of componentInstance.hooks.effects.byCursor) {\n      if (effect.cleanup) {\n        safeExec(effect.cleanup);\n      }\n\n      effect.cleanup = undefined;\n      effect.releaseSignals?.();\n    }\n  }\n\n  componentInstance.mountState = MountState.Unmounted;\n\n  helpGc(componentInstance);\n}\n\n// We need to remove all references to DOM objects. We also clean all other references, just in case\nfunction helpGc(componentInstance: ComponentInstance) {\n  const {\n    effects, state, memos, refs,\n  } = componentInstance.hooks || {};\n\n  if (effects) {\n    for (const hook of effects.byCursor) {\n      hook.schedule = undefined;\n      hook.cleanup = undefined;\n      hook.releaseSignals = undefined;\n      hook.dependencies = undefined;\n    }\n  }\n\n  if (state) {\n    for (const hook of state.byCursor) {\n      hook.value = undefined;\n      hook.nextValue = undefined;\n\n      hook.setter = undefined as any;\n    }\n  }\n\n  if (memos) {\n    for (const hook of memos.byCursor) {\n      hook.value = undefined;\n\n      hook.dependencies = undefined as any;\n    }\n  }\n\n  if (refs) {\n    for (const hook of refs.byCursor) {\n      hook.current = undefined;\n      hook.onChange = undefined;\n    }\n  }\n\n  componentInstance.hooks = undefined;\n\n  componentInstance.$element = undefined as any;\n  componentInstance.renderedValue = undefined;\n  componentInstance.onUpdate = undefined;\n}\n\nfunction prepareComponentForFrame(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted) {\n    return;\n  }\n\n  if (componentInstance.hooks?.state) {\n    for (const hook of componentInstance.hooks.state.byCursor) {\n      hook.value = hook.nextValue;\n    }\n  }\n}\n\nfunction forceUpdateComponent(componentInstance: ComponentInstance) {\n  if (componentInstance.mountState === MountState.Unmounted || !componentInstance.onUpdate) {\n    return;\n  }\n\n  const currentElement = componentInstance.$element;\n\n  renderComponent(componentInstance);\n\n  if (componentInstance.$element !== currentElement) {\n    componentInstance.onUpdate();\n  }\n}\n\nexport function useState<T>(): [T | undefined, StateHookSetter<T | undefined>];\nexport function useState<T>(initial: T | (() => T), debugKey?: string): [T, StateHookSetter<T>];\nexport function useState<T>(initial?: T | (() => T), debugKey?: string): [T, StateHookSetter<T>] {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.state) {\n    renderingInstance.hooks.state = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.state;\n  const componentInstance = renderingInstance;\n\n  if (byCursor[cursor] === undefined) {\n    const initValue = typeof initial === 'function' ? (initial as () => T)() : initial;\n    byCursor[cursor] = {\n      value: initValue,\n      nextValue: initValue,\n      setter: (newValue: ((current: T) => T) | T) => {\n        if (componentInstance.mountState === MountState.Unmounted) {\n          return;\n        }\n\n        if (typeof newValue === 'function') {\n          newValue = (newValue as (current: T) => T)(byCursor[cursor].nextValue);\n        }\n\n        if (byCursor[cursor].nextValue === newValue) {\n          return;\n        }\n\n        byCursor[cursor].nextValue = newValue;\n\n        instancesPendingUpdate.add(componentInstance);\n        runUpdatePassOnRaf();\n\n        if (DEBUG_MORE) {\n          // eslint-disable-next-line no-console\n          console.log(\n            '[Teact.useState]',\n            DEBUG_resolveComponentName(componentInstance.Component),\n            `State update at cursor #${cursor}${debugKey ? ` (${debugKey})` : ''}, next value: `,\n            byCursor[cursor].nextValue,\n          );\n        }\n      },\n    };\n  }\n\n  renderingInstance.hooks.state.cursor++;\n\n  return [\n    byCursor[cursor].value,\n    byCursor[cursor].setter,\n  ];\n}\n\nfunction useEffectBase(\n  isLayout: boolean,\n  effect: Effect,\n  dependencies?: readonly unknown[],\n  debugKey?: string,\n) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n\n  if (!renderingInstance.hooks.effects) {\n    renderingInstance.hooks.effects = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.effects;\n  const effectConfig = byCursor[cursor];\n  const componentInstance = renderingInstance;\n\n  function schedule() {\n    scheduleEffect(componentInstance, cursor, effect, isLayout);\n  }\n\n  if (dependencies && effectConfig?.dependencies) {\n    if (dependencies.some((dependency, i) => dependency !== effectConfig.dependencies![i])) {\n      if (DEBUG && debugKey) {\n        const causedBy = dependencies.reduce<string[]>((res, newValue, i) => {\n          const prevValue = effectConfig.dependencies![i];\n          if (newValue !== prevValue) {\n            res.push(`${i}: ${String(prevValue)} => ${String(newValue)}`);\n          }\n\n          return res;\n        }, []);\n\n        // eslint-disable-next-line no-console\n        console.log(`[Teact] Effect \"${debugKey}\" caused by dependencies.`, causedBy.join(', '));\n      }\n\n      schedule();\n    }\n  } else {\n    if (debugKey) {\n      // eslint-disable-next-line no-console\n      console.log(`[Teact] Effect \"${debugKey}\" caused by missing dependencies.`);\n    }\n\n    schedule();\n  }\n\n  function setupSignals() {\n    const cleanups = dependencies?.filter(isSignal).map((signal, i) => signal.subscribe(() => {\n      if (debugKey) {\n        // eslint-disable-next-line no-console\n        console.log(`[Teact] Effect \"${debugKey}\" caused by signal #${i} new value:`, signal());\n      }\n\n      byCursor[cursor].schedule!();\n    }));\n\n    if (!cleanups?.length) {\n      return undefined;\n    }\n\n    return () => {\n      for (const cleanup of cleanups) {\n        cleanup();\n      }\n    };\n  }\n\n  if (effectConfig) effectConfig.schedule = undefined; // Help GC\n\n  byCursor[cursor] = {\n    ...effectConfig,\n    dependencies,\n    schedule,\n  };\n\n  if (!effectConfig) {\n    byCursor[cursor].releaseSignals = setupSignals();\n  }\n\n  renderingInstance.hooks.effects.cursor++;\n}\n\nfunction scheduleEffect(\n  componentInstance: ComponentInstance,\n  cursor: number,\n  effect: Effect,\n  isLayout: boolean,\n) {\n  const { byCursor } = componentInstance.hooks!.effects!;\n  const cleanup = byCursor[cursor]?.cleanup;\n  const cleanupsContainer = isLayout ? pendingLayoutCleanups : pendingCleanups;\n  const effectsContainer = isLayout ? pendingLayoutEffects : pendingEffects;\n  const effectId = `${componentInstance.id}_${cursor}`;\n\n  if (cleanup) {\n    const runEffectCleanup = () => safeExec(() => {\n      if (componentInstance.mountState === MountState.Unmounted) {\n        return;\n      }\n\n      let DEBUG_startAt: number | undefined;\n      if (DEBUG) {\n        DEBUG_startAt = performance.now();\n      }\n\n      cleanup();\n\n      if (DEBUG) {\n        const duration = performance.now() - DEBUG_startAt!;\n        const componentName = DEBUG_resolveComponentName(componentInstance.Component);\n        if (duration > DEBUG_EFFECT_THRESHOLD) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `[Teact] Slow cleanup at effect cursor #${cursor}: ${componentName}, ${Math.round(duration)} ms`,\n          );\n        }\n      }\n    }, {\n      rescue: () => {\n        // eslint-disable-next-line no-console\n        console.error(`[Teact] Error in effect cleanup at cursor #${cursor} in ${componentInstance.name}`,\n          componentInstance);\n      },\n      always: () => {\n        byCursor[cursor].cleanup = undefined;\n      },\n    });\n\n    cleanupsContainer.set(effectId, runEffectCleanup);\n  }\n\n  const runEffect = () => safeExec(() => {\n    if (componentInstance.mountState === MountState.Unmounted) {\n      return;\n    }\n\n    let DEBUG_startAt: number | undefined;\n    if (DEBUG) {\n      DEBUG_startAt = performance.now();\n    }\n\n    const result = effect();\n    if (typeof result === 'function') {\n      byCursor[cursor].cleanup = result;\n    }\n\n    if (DEBUG) {\n      const duration = performance.now() - DEBUG_startAt!;\n      const componentName = DEBUG_resolveComponentName(componentInstance.Component);\n      if (duration > DEBUG_EFFECT_THRESHOLD) {\n        // eslint-disable-next-line no-console\n        console.warn(`[Teact] Slow effect at cursor #${cursor}: ${componentName}, ${Math.round(duration)} ms`);\n      }\n    }\n  }, {\n    rescue: () => {\n      // eslint-disable-next-line no-console\n      console.error(`[Teact] Error in effect at cursor #${cursor} in ${componentInstance.name}`, componentInstance);\n    },\n  });\n\n  effectsContainer.set(effectId, runEffect);\n\n  runUpdatePassOnRaf();\n}\n\nexport function useEffect(effect: Effect, dependencies?: readonly unknown[], debugKey?: string) {\n  return useEffectBase(false, effect, dependencies, debugKey);\n}\n\nexport function useLayoutEffect(effect: Effect, dependencies?: readonly unknown[], debugKey?: string) {\n  return useEffectBase(true, effect, dependencies, debugKey);\n}\n\nexport function useUnmountCleanup(cleanup: NoneToVoidFunction) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n\n  if (!renderingInstance.hooks.effects) {\n    renderingInstance.hooks.effects = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.effects;\n\n  if (!byCursor[cursor]) {\n    byCursor[cursor] = {\n      cleanup,\n    };\n  }\n\n  renderingInstance.hooks.effects.cursor++;\n}\n\nexport function useMemo<T>(\n  resolver: () => T,\n  dependencies: readonly unknown[],\n  debugKey?: string,\n  debugHitRateKey?: string,\n): T {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.memos) {\n    renderingInstance.hooks.memos = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.memos;\n  let { value } = byCursor[cursor] || {};\n\n  let DEBUG_state: typeof DEBUG_memos[string] | undefined;\n  if (DEBUG && debugHitRateKey) {\n    const instanceKey = `${debugHitRateKey}#${renderingInstance.id}`;\n\n    DEBUG_state = DEBUG_memos[instanceKey];\n    if (!DEBUG_state) {\n      DEBUG_state = {\n        key: instanceKey, calls: 0, misses: 0, hitRate: 0,\n      };\n      DEBUG_memos[instanceKey] = DEBUG_state;\n    }\n\n    DEBUG_state.calls++;\n    DEBUG_state.hitRate = (DEBUG_state.calls - DEBUG_state.misses) / DEBUG_state.calls;\n  }\n\n  if (\n    byCursor[cursor] === undefined\n    || dependencies.length !== byCursor[cursor].dependencies.length\n    || dependencies.some((dependency, i) => dependency !== byCursor[cursor].dependencies[i])\n  ) {\n    if (DEBUG) {\n      if (debugKey) {\n        const msg = `[Teact.useMemo] ${renderingInstance.name} (${debugKey}): Update is caused by:`;\n        if (!byCursor[cursor]) {\n          // eslint-disable-next-line no-console\n          console.log(`${msg} [first render]`);\n        } else {\n          logUnequalProps(byCursor[cursor].dependencies, dependencies, msg, debugKey);\n        }\n      }\n\n      if (DEBUG_state) {\n        DEBUG_state.misses++;\n        DEBUG_state.hitRate = (DEBUG_state.calls - DEBUG_state.misses) / DEBUG_state.calls;\n\n        if (\n          DEBUG_state.calls % 10 === 0\n          && DEBUG_state.calls >= DEBUG_MEMOS_CALLS_THRESHOLD\n          && DEBUG_state.hitRate < 0.25\n        ) {\n          // eslint-disable-next-line no-console\n          console.warn(\n\n            `[Teact] ${DEBUG_state.key}: Hit rate is ${DEBUG_state.hitRate.toFixed(2)} for ${DEBUG_state.calls} calls`,\n          );\n        }\n      }\n    }\n\n    value = resolver();\n  }\n\n  byCursor[cursor] = {\n    value,\n    dependencies,\n  };\n\n  renderingInstance.hooks.memos.cursor++;\n\n  return value;\n}\n\nexport function useCallback<F extends AnyFunction>(newCallback: F, dependencies: unknown[], debugKey?: string): F {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  return useMemo(() => newCallback, dependencies, debugKey);\n}\n\nexport function useRef<T>(initial: T): RefObject<T>;\nexport function useRef<T>(): RefObject<T | undefined>; // TT way (empty is `undefined`)\nexport function useRef<T>(initial?: T) {\n  if (!renderingInstance.hooks) {\n    renderingInstance.hooks = {};\n  }\n  if (!renderingInstance.hooks.refs) {\n    renderingInstance.hooks.refs = { cursor: 0, byCursor: [] };\n  }\n\n  const { cursor, byCursor } = renderingInstance.hooks.refs;\n  if (!byCursor[cursor]) {\n    byCursor[cursor] = {\n      current: initial,\n    };\n  }\n\n  renderingInstance.hooks.refs.cursor++;\n\n  return byCursor[cursor];\n}\n\nexport function createContext<T>(defaultValue?: T): Context<T> {\n  const contextId = String(contextCounter++);\n\n  function TeactContextProvider(props: { value: T; children: TeactNode }) {\n    const [getValue, setValue] = useSignal(props.value ?? defaultValue);\n    // Create a new object to avoid mutations in the parent context\n    renderingInstance.context = { ...renderingInstance.context };\n\n    renderingInstance.context[contextId] = getValue;\n    setValue(props.value);\n    return props.children;\n  }\n\n  TeactContextProvider.DEBUG_contentComponentName = contextId;\n\n  const context = {\n    defaultValue,\n    contextId,\n    Provider: TeactContextProvider,\n  };\n\n  return context;\n}\n\nexport function useContextSignal<T>(context: Context<T>) {\n  const [getDefaultValue] = useSignal(context.defaultValue);\n\n  return renderingInstance.context?.[context.contextId] as Signal<T> || getDefaultValue;\n}\n\nexport function useSignal<T>(initial?: T) {\n  const signalRef = useRef<ReturnType<typeof createSignal<T>>>();\n  signalRef.current ??= createSignal<T>(initial);\n  return signalRef.current;\n}\n\nexport function memo<T extends FC_withDebug>(Component: T, debugKey?: string) {\n  function TeactMemoWrapper(props: Props) {\n    return useMemo(\n      () => createElement(Component, props),\n      // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n      Object.values(props),\n      debugKey,\n      DEBUG_MORE ? DEBUG_resolveComponentName(renderingInstance.Component) : undefined,\n    );\n  }\n\n  TeactMemoWrapper.DEBUG_contentComponentName = DEBUG_resolveComponentName(Component);\n\n  return TeactMemoWrapper as T;\n}\n\nexport function DEBUG_resolveComponentName(Component: FC_withDebug) {\n  const { name, DEBUG_contentComponentName } = Component;\n\n  if (name === 'TeactNContainer') {\n    return `container>${DEBUG_contentComponentName}`;\n  }\n\n  if (name === 'TeactMemoWrapper') {\n    return `memo>${DEBUG_contentComponentName}`;\n  }\n\n  if (name === 'TeactContextProvider') {\n    return `context>id${DEBUG_contentComponentName}`;\n  }\n\n  return name + (DEBUG_contentComponentName ? `>${DEBUG_contentComponentName}` : '');\n}\n\nexport default {\n  createElement,\n  Fragment,\n};\n\nexport { createElement, Fragment };\n","import {\n  getIsHeavyAnimating,\n  useCallback, useEffect, useRef,\n} from '../lib/teact/teact';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport useLastCallback from './useLastCallback';\n\nexport const startCallbacks = createCallbackManager();\nexport const endCallbacks = createCallbackManager();\n\ngetIsHeavyAnimating.subscribe(() => {\n  if (getIsHeavyAnimating()) {\n    startCallbacks.runCallbacks();\n  } else {\n    endCallbacks.runCallbacks();\n  }\n});\n\nexport default function useHeavyAnimation(\n  onStart?: AnyToVoidFunction,\n  onEnd?: AnyToVoidFunction,\n  isDisabled = false,\n) {\n  const lastOnStart = useLastCallback(onStart);\n  const lastOnEnd = useLastCallback(onEnd);\n\n  useEffect(() => {\n    if (isDisabled) {\n      return undefined;\n    }\n\n    if (getIsHeavyAnimating()) {\n      lastOnStart();\n    }\n\n    startCallbacks.addCallback(lastOnStart);\n    endCallbacks.addCallback(lastOnEnd);\n\n    return () => {\n      endCallbacks.removeCallback(lastOnEnd);\n      startCallbacks.removeCallback(lastOnStart);\n    };\n  }, [isDisabled, lastOnEnd, lastOnStart]);\n}\n\n// TODO  `onFullyIdle`?\nexport function useThrottleForHeavyAnimation<T extends AnyToVoidFunction>(afterHeavyAnimation: T, deps: unknown[]) {\n  // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  const fnMemo = useCallback(afterHeavyAnimation, deps);\n  const pendingCallRef = useRef<AnyToVoidFunction>();\n\n  useEffect(() => {\n    return () => {\n      if (pendingCallRef.current) {\n        endCallbacks.removeCallback(pendingCallRef.current);\n        pendingCallRef.current = undefined;\n      }\n    };\n  }, [fnMemo]);\n\n  return useCallback((...args: Parameters<T>) => {\n    if (pendingCallRef.current) {\n      endCallbacks.removeCallback(pendingCallRef.current);\n    }\n\n    const wrappedCallback = () => {\n      pendingCallRef.current = undefined;\n      fnMemo(...args);\n    };\n\n    if (getIsHeavyAnimating()) {\n      pendingCallRef.current = wrappedCallback;\n      endCallbacks.addCallback(wrappedCallback);\n    } else {\n      wrappedCallback();\n    }\n  }, [fnMemo]) as T;\n}\n","import type { ThemeKey } from '../types';\n\nlet systemThemeCache: ThemeKey = (\n  window.matchMedia?.('(prefers-color-scheme: dark)').matches\n) ? 'dark' : 'light';\n\nlet themeChangeCallback: ((newTheme: ThemeKey) => void) | undefined;\n\nexport function getSystemTheme() {\n  return systemThemeCache;\n}\n\nfunction handleSystemThemeChange(e: MediaQueryListEventMap['change']) {\n  systemThemeCache = e.matches ? 'dark' : 'light';\n\n  themeChangeCallback?.(systemThemeCache);\n}\n\nexport function setSystemThemeChangeCallback(callback: (newTheme: ThemeKey) => void) {\n  themeChangeCallback = callback;\n}\n\nwindow.matchMedia('(prefers-color-scheme: dark)')\n  .addEventListener('change', handleSystemThemeChange);\n","import type { ThreadId, WebPageMediaSize } from '../../types';\nimport type {\n  ApiBotInlineMediaResult,\n  ApiBotInlineResult,\n  ApiWebDocument,\n} from './bots';\nimport type { ApiMessageAction } from './messageActions';\nimport type { ApiPeerNotifySettings, ApiRestrictionReason } from './misc';\nimport type {\n  ApiLabeledPrice,\n} from './payments';\nimport type { ApiTypePeerColor } from './peers';\nimport type { ApiStarGiftRegular, ApiStarGiftUnique, ApiTypeCurrencyAmount } from './stars';\nimport type {\n  ApiMessageStoryData, ApiStory, ApiWebPageStickerData, ApiWebPageStoryData,\n} from './stories';\nimport type { ApiInlineQueryPeerType } from './users';\n\nexport interface ApiDimensions {\n  width: number;\n  height: number;\n}\n\nexport interface ApiPhotoSize extends ApiDimensions {\n  type: 's' | 'm' | 'x' | 'y' | 'w';\n}\n\nexport interface ApiVideoSize extends ApiDimensions {\n  type: 'u' | 'v';\n  videoStartTs?: number;\n  size: number;\n}\n\nexport interface ApiThumbnail extends ApiDimensions {\n  dataUri: string;\n}\n\nexport interface ApiPhoto {\n  mediaType: 'photo';\n  id: string;\n  date: number;\n  thumbnail?: ApiThumbnail;\n  isVideo?: boolean;\n  sizes: ApiPhotoSize[];\n  videoSizes?: ApiVideoSize[];\n  blobUrl?: string;\n  isSpoiler?: boolean;\n}\n\nexport interface ApiSticker {\n  mediaType: 'sticker';\n  id: string;\n  stickerSetInfo: ApiStickerSetInfo;\n  emoji?: string;\n  isCustomEmoji?: boolean;\n  isLottie: boolean;\n  isVideo: boolean;\n  width?: number;\n  height?: number;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  isPreloadedGlobally?: boolean;\n  hasEffect?: boolean;\n  isFree?: boolean;\n  shouldUseTextColor?: boolean;\n}\n\nexport interface ApiStickerSet {\n  isArchived?: true;\n  isEmoji?: true;\n  installedDate?: number;\n  id: string;\n  accessHash: string;\n  title: string;\n  hasThumbnail?: boolean;\n  hasStaticThumb?: boolean;\n  hasAnimatedThumb?: boolean;\n  hasVideoThumb?: boolean;\n  thumbCustomEmojiId?: string;\n  count: number;\n  stickers?: ApiSticker[];\n  packs?: Record<string, ApiSticker[]>;\n  covers?: ApiSticker[];\n  shortName: string;\n}\n\ntype ApiStickerSetInfoShortName = {\n  shortName: string;\n};\n\ntype ApiStickerSetInfoId = {\n  id: string;\n  accessHash: string;\n};\n\ntype ApiStickerSetInfoMissing = {\n  isMissing: true;\n};\n\nexport type ApiStickerSetInfo = ApiStickerSetInfoShortName | ApiStickerSetInfoId | ApiStickerSetInfoMissing;\n\nexport interface ApiVideo {\n  mediaType: 'video';\n  id: string;\n  mimeType: string;\n  duration: number;\n  fileName: string;\n  width?: number;\n  height?: number;\n  supportsStreaming?: boolean;\n  isRound?: boolean;\n  isGif?: boolean;\n  hasVideoPreview?: boolean;\n  isSpoiler?: boolean;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  blobUrl?: string;\n  previewBlobUrl?: string;\n  size: number;\n  noSound?: boolean;\n  waveform?: number[];\n  timestamp?: number;\n}\n\nexport interface ApiAudio {\n  mediaType: 'audio';\n  id: string;\n  size: number;\n  mimeType: string;\n  fileName: string;\n  duration: number;\n  performer?: string;\n  title?: string;\n  thumbnailSizes?: ApiPhotoSize[];\n}\n\nexport interface ApiVoice {\n  mediaType: 'voice';\n  id: string;\n  duration: number;\n  waveform?: number[];\n  size: number;\n}\n\nexport interface ApiDocument {\n  mediaType: 'document';\n  id?: string;\n  fileName: string;\n  size: number;\n  timestamp?: number;\n  mimeType: string;\n  thumbnail?: ApiThumbnail;\n  previewPhotoSizes?: ApiPhotoSize[];\n  previewBlobUrl?: string;\n  innerMediaType?: 'photo' | 'video';\n  mediaSize?: ApiDimensions & { fromDocumentAttribute?: boolean; fromPreload?: true };\n}\n\nexport interface ApiContact {\n  mediaType: 'contact';\n  firstName: string;\n  lastName: string;\n  phoneNumber: string;\n  userId: string;\n}\n\nexport type ApiPaidMedia = {\n  mediaType: 'paidMedia';\n  starsAmount: number;\n} & ({\n  isBought?: true;\n  extendedMedia: BoughtPaidMedia[];\n} | {\n  isBought?: undefined;\n  extendedMedia: ApiMediaExtendedPreview[];\n});\n\nexport interface ApiPollAnswer {\n  text: ApiFormattedText;\n  option: string;\n}\n\nexport interface ApiPollResult {\n  isChosen?: true;\n  isCorrect?: true;\n  option: string;\n  votersCount: number;\n}\n\nexport interface ApiPoll {\n  mediaType: 'poll';\n  id: string;\n  summary: {\n    closed?: true;\n    isPublic?: true;\n    multipleChoice?: true;\n    quiz?: true;\n    question: ApiFormattedText;\n    answers: ApiPollAnswer[];\n    closePeriod?: number;\n    closeDate?: number;\n  };\n  results: {\n    isMin?: true;\n    results?: ApiPollResult[];\n    totalVoters?: number;\n    recentVoterIds?: string[];\n    solution?: string;\n    solutionEntities?: ApiMessageEntity[];\n  };\n}\n\nexport interface ApiInvoice {\n  prices: ApiLabeledPrice[];\n  totalAmount: number;\n  currency: string;\n  isTest?: boolean;\n  isRecurring?: boolean;\n  subscriptionPeriod?: number;\n  termsUrl?: string;\n  maxTipAmount?: number;\n  suggestedTipAmounts?: number[];\n  isNameRequested?: boolean;\n  isPhoneRequested?: boolean;\n  isEmailRequested?: boolean;\n  isShippingAddressRequested?: boolean;\n  isFlexible?: boolean;\n  isPhoneSentToProvider?: boolean;\n  isEmailSentToProvider?: boolean;\n}\n\nexport interface ApiMediaInvoice {\n  mediaType: 'invoice';\n  title: string;\n  description: string;\n  photo?: ApiWebDocument;\n  isTest?: boolean;\n  receiptMessageId?: number;\n  currency: string;\n  amount: number;\n  extendedMedia?: ApiMediaExtendedPreview;\n}\n\nexport interface ApiMediaExtendedPreview {\n  mediaType: 'extendedMediaPreview';\n  width?: number;\n  height?: number;\n  thumbnail?: ApiThumbnail;\n  duration?: number;\n}\n\nexport interface ApiPaymentCredentials {\n  id: string;\n  title: string;\n}\n\nexport interface ApiGeoPoint {\n  long: number;\n  lat: number;\n  accessHash: string;\n  accuracyRadius?: number;\n}\n\nexport interface ApiGeo {\n  mediaType: 'geo';\n  geo: ApiGeoPoint;\n}\n\nexport interface ApiVenue {\n  mediaType: 'venue';\n  geo: ApiGeoPoint;\n  title: string;\n  address: string;\n  provider: string;\n  venueId: string;\n  venueType: string;\n}\n\nexport interface ApiGeoLive {\n  mediaType: 'geoLive';\n  geo: ApiGeoPoint;\n  heading?: number;\n  period: number;\n}\n\nexport type ApiLocation = ApiGeo | ApiVenue | ApiGeoLive;\n\nexport type ApiGame = {\n  mediaType: 'game';\n  title: string;\n  description: string;\n  photo?: ApiPhoto;\n  shortName: string;\n  id: string;\n  accessHash: string;\n  document?: ApiDocument;\n};\n\nexport type ApiGiveaway = {\n  mediaType: 'giveaway';\n  quantity: number;\n  months?: number;\n  stars?: number;\n  untilDate: number;\n  isOnlyForNewSubscribers?: true;\n  countries?: string[];\n  channelIds: string[];\n  prizeDescription?: string;\n};\n\nexport type ApiGiveawayResults = {\n  mediaType: 'giveawayResults';\n  months?: number;\n  stars?: number;\n  untilDate: number;\n  isRefunded?: true;\n  isOnlyForNewSubscribers?: true;\n  channelId: string;\n  prizeDescription?: string;\n  winnersCount?: number;\n  winnerIds: string[];\n  additionalPeersCount?: number;\n  launchMessageId: number;\n  unclaimedCount: number;\n};\n\nexport type ApiNewPoll = {\n  summary: ApiPoll['summary'];\n  quiz?: {\n    correctAnswers: string[];\n    solution?: string;\n    solutionEntities?: ApiMessageEntity[];\n  };\n};\n\nexport interface ApiTodoItem {\n  id: number;\n  title: ApiFormattedText;\n}\n\nexport interface ApiTodoList {\n  title: ApiFormattedText;\n  items: ApiTodoItem[];\n  othersCanAppend?: boolean;\n  othersCanComplete?: boolean;\n}\n\nexport interface ApiTodoCompletion {\n  itemId: number;\n  completedBy: string;\n  completedAt: number;\n}\n\nexport interface ApiMediaTodo {\n  mediaType: 'todo';\n  todo: ApiTodoList;\n  completions?: ApiTodoCompletion[];\n}\n\nexport type ApiNewMediaTodo = {\n  todo: ApiTodoList;\n};\n\nexport interface ApiWebPagePending {\n  mediaType: 'webpage';\n  webpageType: 'pending';\n  id: string;\n  url?: string;\n  isSafe?: true;\n}\n\nexport interface ApiWebPageEmpty {\n  mediaType: 'webpage';\n  webpageType: 'empty';\n  id: string;\n  url?: string;\n  isSafe?: true;\n}\n\nexport interface ApiWebPageFull {\n  mediaType: 'webpage';\n  webpageType: 'full';\n  id: string;\n  url: string;\n  displayUrl: string;\n  type?: string;\n  siteName?: string;\n  title?: string;\n  description?: string;\n  photo?: ApiPhoto;\n  audio?: ApiAudio;\n  duration?: number;\n  document?: ApiDocument;\n  video?: ApiVideo;\n  story?: ApiWebPageStoryData;\n  gift?: ApiStarGiftUnique;\n  auction?: ApiWebPageAuctionData;\n  stickers?: ApiWebPageStickerData;\n  hasLargeMedia?: boolean;\n}\n\nexport type ApiWebPageAuctionData = {\n  gift: ApiStarGiftRegular;\n  endDate: number;\n};\n\nexport type ApiWebPage = ApiWebPagePending | ApiWebPageEmpty | ApiWebPageFull;\n\n/**\n * Wrapper with message-specific fields\n */\nexport interface ApiMessageWebPage {\n  id: string;\n  isSafe?: true;\n  mediaSize?: WebPageMediaSize;\n}\n\nexport type ApiReplyInfo = ApiMessageReplyInfo | ApiStoryReplyInfo;\n\nexport interface ApiMessageReplyInfo {\n  type: 'message';\n  replyToMsgId?: number;\n  replyToPeerId?: string;\n  replyFrom?: ApiMessageForwardInfo;\n  replyMedia?: MediaContent;\n  replyToTopId?: number;\n  isForumTopic?: true;\n  isQuote?: true;\n  quoteText?: ApiFormattedText;\n  quoteOffset?: number;\n}\n\nexport interface ApiStoryReplyInfo {\n  type: 'story';\n  peerId: string;\n  storyId: number;\n}\n\nexport interface ApiInputMessageReplyInfo {\n  type: 'message';\n  replyToMsgId: number;\n  replyToTopId?: number;\n  replyToPeerId?: string;\n  monoforumPeerId?: string;\n  quoteText?: ApiFormattedText;\n  quoteOffset?: number;\n}\n\nexport interface ApiSuggestedPost {\n  isAccepted?: true;\n  isRejected?: true;\n  price?: ApiTypeCurrencyAmount;\n  scheduleDate?: number;\n}\n\nexport interface ApiInputStoryReplyInfo {\n  type: 'story';\n  peerId: string;\n  storyId: number;\n}\n\nexport interface ApiInputSuggestedPostInfo {\n  price?: ApiTypeCurrencyAmount;\n  scheduleDate?: number;\n  isAccepted?: true;\n  isRejected?: true;\n}\n\nexport type ApiInputReplyInfo = ApiInputMessageReplyInfo | ApiInputStoryReplyInfo;\n\nexport interface ApiMessageForwardInfo {\n  date: number;\n  savedDate?: number;\n  isImported?: boolean;\n  isChannelPost: boolean;\n  channelPostId?: number;\n  isLinkedChannelPost?: boolean;\n  fromChatId?: string;\n  fromId?: string;\n  savedFromPeerId?: string;\n  isSavedOutgoing?: boolean;\n  fromMessageId?: number;\n  hiddenUserName?: string;\n  postAuthorTitle?: string;\n}\n\nexport interface ApiStoryForwardInfo {\n  fromPeerId?: string;\n  fromName?: string;\n  storyId?: number;\n  isModified?: boolean;\n}\n\nexport type ApiMessageEntityDefault = {\n  type: Exclude<\n  `${ApiMessageEntityTypes}`,\n  `${ApiMessageEntityTypes.Pre}` | `${ApiMessageEntityTypes.TextUrl}` | `${ApiMessageEntityTypes.MentionName}` |\n  `${ApiMessageEntityTypes.Blockquote}` | `${ApiMessageEntityTypes.CustomEmoji}` | `${ApiMessageEntityTypes.Timestamp}`\n  >;\n  offset: number;\n  length: number;\n};\n\nexport type ApiMessageEntityPre = {\n  type: ApiMessageEntityTypes.Pre;\n  offset: number;\n  length: number;\n  language?: string;\n};\n\nexport type ApiMessageEntityTextUrl = {\n  type: ApiMessageEntityTypes.TextUrl;\n  offset: number;\n  length: number;\n  url: string;\n};\n\nexport type ApiMessageEntityMentionName = {\n  type: ApiMessageEntityTypes.MentionName;\n  offset: number;\n  length: number;\n  userId: string;\n};\n\nexport type ApiMessageEntityBlockquote = {\n  type: ApiMessageEntityTypes.Blockquote;\n  offset: number;\n  length: number;\n  canCollapse?: boolean;\n};\n\nexport type ApiMessageEntityCustomEmoji = {\n  type: ApiMessageEntityTypes.CustomEmoji;\n  offset: number;\n  length: number;\n  documentId: string;\n};\n\n// Local entities\nexport type ApiMessageEntityTimestamp = {\n  type: ApiMessageEntityTypes.Timestamp;\n  offset: number;\n  length: number;\n  timestamp: number;\n};\n\nexport type ApiMessageEntity = ApiMessageEntityDefault | ApiMessageEntityPre | ApiMessageEntityTextUrl |\n  ApiMessageEntityMentionName | ApiMessageEntityCustomEmoji | ApiMessageEntityBlockquote | ApiMessageEntityTimestamp;\n\nexport enum ApiMessageEntityTypes {\n  Bold = 'MessageEntityBold',\n  Blockquote = 'MessageEntityBlockquote',\n  BotCommand = 'MessageEntityBotCommand',\n  Cashtag = 'MessageEntityCashtag',\n  Code = 'MessageEntityCode',\n  Email = 'MessageEntityEmail',\n  Hashtag = 'MessageEntityHashtag',\n  Italic = 'MessageEntityItalic',\n  MentionName = 'MessageEntityMentionName',\n  Mention = 'MessageEntityMention',\n  Phone = 'MessageEntityPhone',\n  Pre = 'MessageEntityPre',\n  Strike = 'MessageEntityStrike',\n  TextUrl = 'MessageEntityTextUrl',\n  Url = 'MessageEntityUrl',\n  Underline = 'MessageEntityUnderline',\n  Spoiler = 'MessageEntitySpoiler',\n  CustomEmoji = 'MessageEntityCustomEmoji',\n  Timestamp = 'MessageEntityTimestamp',\n  QuoteFocus = 'MessageEntityQuoteFocus',\n  Unknown = 'MessageEntityUnknown',\n}\n\nexport interface ApiFormattedText {\n  text: string;\n  entities?: ApiMessageEntity[];\n}\n\nexport interface ApiFormattedTextWithEmojiOnlyCount extends ApiFormattedText {\n  emojiOnlyCount?: number;\n}\n\nexport type MediaContent = {\n  text?: ApiFormattedTextWithEmojiOnlyCount;\n  photo?: ApiPhoto;\n  video?: ApiVideo;\n  altVideos?: ApiVideo[];\n  document?: ApiDocument;\n  sticker?: ApiSticker;\n  contact?: ApiContact;\n  pollId?: string;\n  todo?: ApiMediaTodo;\n  action?: ApiMessageAction;\n  webPage?: ApiMessageWebPage;\n  audio?: ApiAudio;\n  voice?: ApiVoice;\n  invoice?: ApiMediaInvoice;\n  location?: ApiLocation;\n  game?: ApiGame;\n  storyData?: ApiMessageStoryData;\n  giveaway?: ApiGiveaway;\n  giveawayResults?: ApiGiveawayResults;\n  paidMedia?: ApiPaidMedia;\n  ttlSeconds?: number;\n};\nexport type MediaContainer = {\n  content: MediaContent;\n};\n\nexport type StatefulMediaContent = {\n  poll?: ApiPoll;\n  story?: ApiStory;\n  webPage?: ApiWebPage;\n};\n\nexport type SizeTarget =\n  'micro'\n  | 'pictogram'\n  | 'inline'\n  | 'preview'\n  | 'full'\n  | 'download';\n\nexport type BoughtPaidMedia = Pick<MediaContent, 'photo' | 'video'>;\n\nexport interface ApiMessage {\n  id: number;\n  chatId: string;\n  content: MediaContent;\n  date: number;\n  isOutgoing: boolean;\n  senderId?: string;\n  replyInfo?: ApiReplyInfo;\n  suggestedPostInfo?: ApiInputSuggestedPostInfo;\n  sendingState?: 'messageSendingStatePending' | 'messageSendingStateFailed';\n  forwardInfo?: ApiMessageForwardInfo;\n  isDeleting?: boolean;\n  previousLocalId?: number;\n  viewsCount?: number;\n  forwardsCount?: number;\n  isEdited?: boolean;\n  editDate?: number;\n  isMentioned?: boolean;\n  isMediaUnread?: boolean;\n  groupedId?: string;\n  isInAlbum?: boolean;\n  hasUnreadMention?: boolean;\n  inlineButtons?: ApiKeyboardButtons;\n  keyboardButtons?: ApiKeyboardButtons;\n  keyboardPlaceholder?: string;\n  isKeyboardSingleUse?: boolean;\n  isKeyboardSelective?: boolean;\n  viaBotId?: string;\n  viaBusinessBotId?: string;\n  postAuthorTitle?: string;\n  isScheduled?: boolean;\n  scheduleRepeatPeriod?: number;\n  shouldHideKeyboardButtons?: boolean;\n  isHideKeyboardSelective?: boolean;\n  isFromScheduled?: boolean;\n  isSilent?: boolean;\n  isPinned?: boolean;\n  seenByDates?: Record<string, number>;\n  isProtected?: boolean;\n  isForwardingAllowed?: boolean;\n  transcriptionId?: string;\n  isTranscriptionError?: boolean;\n  reactors?: {\n    nextOffset?: string;\n    count: number;\n    reactions: ApiPeerReaction[];\n  };\n  reactions?: ApiReactions;\n  hasComments?: boolean;\n  readDate?: number;\n  savedPeerId?: string;\n  senderBoosts?: number;\n  factCheck?: ApiFactCheck;\n  effectId?: string;\n  isInvertedMedia?: true;\n  isVideoProcessingPending?: true;\n  areReactionsPossible?: true;\n  reportDeliveryUntilDate?: number;\n  paidMessageStars?: number;\n  restrictionReasons?: ApiRestrictionReason[];\n\n  isTypingDraft?: boolean; // Local field\n}\n\nexport interface ApiReactions {\n  canSeeList?: boolean;\n  areTags?: boolean;\n  results: ApiReactionCount[];\n  recentReactions?: ApiPeerReaction[];\n  topReactors?: ApiMessageReactor[];\n}\n\nexport interface ApiPeerReaction {\n  peerId: string;\n  reaction: ApiReaction;\n  isOwn?: boolean;\n  isBig?: boolean;\n  isUnread?: boolean;\n  addedDate: number;\n}\n\nexport interface ApiMessageReactor {\n  isTop?: true;\n  isMy?: true;\n  count: number;\n  isAnonymous?: true;\n  peerId?: string;\n}\n\nexport interface ApiReactionCount {\n  chosenOrder?: number;\n  count: number;\n  reaction: ApiReactionWithPaid;\n  localAmount?: number;\n  localIsPrivate?: boolean;\n  localPeerId?: string;\n  localPreviousChosenOrder?: number;\n}\n\nexport interface ApiAvailableReaction {\n  selectAnimation?: ApiDocument;\n  appearAnimation?: ApiDocument;\n  activateAnimation?: ApiDocument;\n  effectAnimation?: ApiDocument;\n  staticIcon?: ApiDocument;\n  centerIcon?: ApiDocument;\n  aroundAnimation?: ApiDocument;\n  reaction: ApiReactionEmoji;\n  title: string;\n  isInactive?: boolean;\n  isPremium?: boolean;\n}\n\nexport interface ApiAvailableEffect {\n  id: string;\n  emoticon: string;\n  staticIconId?: string;\n  effectAnimationId?: string;\n  effectStickerId: string;\n  isPremium?: boolean;\n}\n\ntype ApiChatReactionsAll = {\n  type: 'all';\n  areCustomAllowed?: true;\n};\n\ntype ApiChatReactionsSome = {\n  type: 'some';\n  allowed: ApiReaction[];\n};\n\nexport type ApiChatReactions = ApiChatReactionsAll | ApiChatReactionsSome;\n\nexport type ApiReactionEmoji = {\n  type: 'emoji';\n  emoticon: string;\n};\n\nexport type ApiReactionCustomEmoji = {\n  type: 'custom';\n  documentId: string;\n};\n\nexport type ApiReactionPaid = {\n  type: 'paid';\n};\n\nexport type ApiReaction = ApiReactionEmoji | ApiReactionCustomEmoji;\nexport type ApiReactionWithPaid = ApiReaction | ApiReactionPaid;\n\nexport type ApiReactionKey = `${string}-${string}` | 'paid' | 'unsupported';\n\nexport type ApiSavedReactionTag = {\n  reaction: ApiReaction;\n  title?: string;\n  count: number;\n};\n\nexport type ApiPaidReactionPrivacyType = ApiPaidReactionPrivacyDefault |\n  ApiPaidReactionPrivacyAnonymous | PaidReactionPrivacyPeer;\n\nexport type ApiPaidReactionPrivacyDefault = {\n  type: 'default';\n};\n\nexport type ApiPaidReactionPrivacyAnonymous = {\n  type: 'anonymous';\n};\n\nexport type PaidReactionPrivacyPeer = {\n  type: 'peer';\n  peerId: string;\n};\n\ninterface ApiBaseThreadInfo {\n  chatId: string;\n  messagesCount: number;\n  lastMessageId?: number;\n  lastReadInboxMessageId?: number;\n  recentReplierIds?: string[];\n}\n\nexport interface ApiCommentsInfo extends ApiBaseThreadInfo {\n  isCommentsInfo: true;\n  threadId?: never;\n  originChannelId: string;\n  originMessageId: number;\n}\n\nexport interface ApiMessageThreadInfo extends ApiBaseThreadInfo {\n  isCommentsInfo: false;\n  threadId: ThreadId;\n  // For linked messages in discussion\n  fromChannelId?: string;\n  fromMessageId?: number;\n}\n\nexport type ApiThreadInfo = ApiCommentsInfo | ApiMessageThreadInfo;\n\nexport type ApiMessageReportResult = {\n  type: 'reported';\n} | {\n  type: 'comment';\n  isOptional?: boolean;\n  option: string;\n} | {\n  type: 'selectOption';\n  title: string;\n  options: {\n    text: string;\n    option: string;\n  }[];\n};\n\nexport type ApiMessageOutgoingStatus = 'read' | 'succeeded' | 'pending' | 'failed';\n\nexport type ApiSponsoredMessage = {\n  chatId: string;\n  randomId: string;\n  isRecommended?: true;\n  expiresAt: number;\n  sponsorInfo?: string;\n  additionalInfo?: string;\n  buttonText?: string;\n  canReport?: true;\n  title: string;\n  url: string;\n  photo?: ApiPhoto;\n  content: MediaContent;\n  peerColor?: ApiTypePeerColor;\n};\n\n// KeyboardButtons\n\ninterface ApiKeyboardButtonSimple {\n  type: 'unsupported' | 'buy' | 'command' | 'requestPhone' | 'game';\n  text: string;\n}\n\ninterface ApiKeyboardButtonReceipt {\n  type: 'receipt';\n  receiptMessageId: number;\n}\n\ninterface ApiKeyboardButtonUrl {\n  type: 'url';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonSimpleWebView {\n  type: 'simpleWebView';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonWebView {\n  type: 'webView';\n  text: string;\n  url: string;\n}\n\ninterface ApiKeyboardButtonCallback {\n  type: 'callback';\n  text: string;\n  data: string;\n}\n\ninterface ApiKeyboardButtonRequestPoll {\n  type: 'requestPoll';\n  text: string;\n  isQuiz?: boolean;\n}\n\ninterface ApiKeyboardButtonSwitchBotInline {\n  type: 'switchBotInline';\n  text: string;\n  query: string;\n  isSamePeer?: boolean;\n}\n\ninterface ApiKeyboardButtonUserProfile {\n  type: 'userProfile';\n  text: string;\n  userId: string;\n}\n\ninterface ApiKeyboardButtonUrlAuth {\n  type: 'urlAuth';\n  text: string;\n  url: string;\n  buttonId: number;\n}\n\ninterface ApiKeyboardButtonCopy {\n  type: 'copy';\n  text: string;\n  copyText: string;\n}\n\nexport interface KeyboardButtonSuggestedMessage {\n  type: 'suggestedMessage';\n  text: string;\n  buttonType: 'approve' | 'decline' | 'suggestChanges';\n  disabled?: boolean;\n}\n\nexport interface KeyboardButtonOpenThread {\n  type: 'openThread';\n  text: string;\n}\n\nexport type ApiKeyboardButton = (\n  ApiKeyboardButtonSimple\n  | ApiKeyboardButtonReceipt\n  | ApiKeyboardButtonUrl\n  | ApiKeyboardButtonCallback\n  | ApiKeyboardButtonRequestPoll\n  | ApiKeyboardButtonSwitchBotInline\n  | ApiKeyboardButtonUserProfile\n  | ApiKeyboardButtonWebView\n  | ApiKeyboardButtonSimpleWebView\n  | ApiKeyboardButtonUrlAuth\n  | ApiKeyboardButtonCopy\n  | KeyboardButtonSuggestedMessage\n  | KeyboardButtonOpenThread\n);\n\nexport type ApiKeyboardButtons = ApiKeyboardButton[][];\nexport type ApiReplyKeyboard = {\n  keyboardPlaceholder?: string;\n  isKeyboardSingleUse?: boolean;\n  isKeyboardSelective?: boolean;\n} & Partial<Record<'inlineButtons' | 'keyboardButtons', ApiKeyboardButtons>>;\n\nexport type ApiTranscription = {\n  text: string;\n  isPending?: boolean;\n  transcriptionId: string;\n};\n\nexport type ApiMessageSearchType = 'text' | 'media' | 'documents' | 'links' | 'audio' | 'voice' | 'gif'\n  | 'profilePhoto';\nexport type ApiGlobalMessageSearchType = 'text' |\n  'channels' | 'media' | 'documents' | 'links' | 'audio' | 'voice' | 'publicPosts';\nexport type ApiMessageSearchContext = 'all' | 'users' | 'groups' | 'channels';\n\nexport type ApiReportReason = 'spam' | 'violence' | 'pornography' | 'childAbuse'\n  | 'copyright' | 'geoIrrelevant' | 'fake' | 'illegalDrugs' | 'personalDetails' | 'other';\n\nexport type ApiSendMessageAction = {\n  type: 'cancel' | 'typing' | 'recordAudio' | 'chooseSticker' | 'playingGame';\n};\n\nexport type ApiThemeParameters = {\n  bg_color: string;\n  text_color: string;\n  hint_color: string;\n  link_color: string;\n  button_color: string;\n  button_text_color: string;\n  secondary_bg_color: string;\n  header_bg_color: string;\n  accent_text_color: string;\n  section_bg_color: string;\n  section_header_text_color: string;\n  subtitle_text_color: string;\n  destructive_text_color: string;\n  section_separator_color: string;\n};\n\nexport type ApiBotApp = {\n  id: string;\n  accessHash: string;\n  title: string;\n  shortName: string;\n  description: string;\n  photo?: ApiPhoto;\n  document?: ApiDocument;\n};\n\nexport type ApiMessagesBotApp = ApiBotApp & {\n  isInactive?: boolean;\n  shouldRequestWriteAccess?: boolean;\n};\n\nexport type ApiQuickReply = {\n  id: number;\n  shortcut: string;\n  topMessageId: number;\n};\n\nexport type ApiFactCheck = {\n  shouldFetch?: true;\n  hash: string;\n  countryCode?: string;\n  text?: ApiFormattedText;\n};\n\nexport type ApiSponsoredMessageReportResult = {\n  type: 'reported' | 'hidden' | 'premiumRequired';\n} | {\n  type: 'selectOption';\n  title: string;\n  options: {\n    text: string;\n    option: string;\n  }[];\n};\n\nexport type ApiPreparedInlineMessage = {\n  queryId: string;\n  result: ApiBotInlineResult | ApiBotInlineMediaResult;\n  peerTypes: ApiInlineQueryPeerType[];\n  cacheTime: number;\n};\n\nexport type ApiSearchPostsFlood = {\n  query?: string;\n  queryIsFree?: boolean;\n  totalDaily: number;\n  remains: number;\n  waitTill?: number;\n  starsAmount: number;\n};\n\nexport type LinkContext = {\n  type: 'message';\n  threadId?: ThreadId;\n  chatId: string;\n  messageId: number;\n};\n\nexport interface ApiTopic {\n  id: number;\n  isClosed?: boolean;\n  isPinned?: boolean;\n  isHidden?: boolean;\n  isOwner?: boolean;\n\n  // TODO[forums] https://github.com/telegramdesktop/tdesktop/blob/1aece79a471d99a8b63d826b1bce1f36a04d7293/Telegram/SourceFiles/data/data_forum_topic.cpp#L318\n  isMin?: boolean;\n  date: number;\n  title: string;\n  iconColor: number;\n  iconEmojiId?: string;\n  lastMessageId: number;\n  unreadCount: number;\n  unreadMentionsCount: number;\n  unreadReactionsCount: number;\n  fromId: string;\n  notifySettings: ApiPeerNotifySettings;\n  isTitleMissing?: boolean;\n}\n\nexport const MAIN_THREAD_ID = -1;\n\n// `Symbol` can not be transferred from worker\nexport const MESSAGE_DELETED = 'MESSAGE_DELETED';\n","import { getGlobal } from '../global';\n\nimport {\n  APP_CODE_NAME,\n  DEBUG, IS_MOCKED_CLIENT,\n} from '../config';\nimport { IS_TAURI } from './browser/globalEnvironment';\nimport { hasStoredSession } from './sessions';\n\nconst WEBSYNC_URLS = [\n  't.me',\n  'telegram.me',\n].map((domain) => `https://${domain}/_websync_?`);\nconst WEBSYNC_VERSION = `${APP_VERSION} ${APP_CODE_NAME}`;\nconst WEBSYNC_KEY = 'tgme_sync';\nconst WEBSYNC_TIMEOUT = 86400;\n\nconst getTs = () => {\n  return Math.floor(Number(new Date()) / 1000);\n};\n\nconst saveSync = (authed: boolean) => {\n  const ts = getTs();\n  localStorage.setItem(WEBSYNC_KEY, JSON.stringify({\n    canRedirect: authed,\n    ts,\n  }));\n};\n\nlet lastTimeout: NodeJS.Timeout | undefined;\n\nexport const forceWebsync = (authed: boolean) => {\n  if (IS_MOCKED_CLIENT || IS_TAURI) return undefined;\n  const currentTs = getTs();\n\n  const { canRedirect, ts } = JSON.parse(localStorage.getItem(WEBSYNC_KEY) || '{}');\n\n  if (canRedirect !== authed || ts + WEBSYNC_TIMEOUT <= currentTs) {\n    return Promise.all(WEBSYNC_URLS.map((url) => {\n      return new Promise<void>((resolve, reject) => {\n        const script = document.createElement('script');\n\n        const removeElement = () => Boolean(document.body.removeChild(script));\n\n        script.src = url + new URLSearchParams({\n          authed: Number(authed).toString(),\n          version: WEBSYNC_VERSION,\n        }).toString();\n\n        document.body.appendChild(script);\n\n        script.onload = () => {\n          saveSync(authed);\n          removeElement();\n          if (lastTimeout) {\n            clearTimeout(lastTimeout);\n            lastTimeout = undefined;\n          }\n          startWebsync();\n          resolve();\n        };\n\n        script.onerror = () => {\n          removeElement();\n          reject();\n        };\n      });\n    }));\n  } else {\n    return Promise.resolve();\n  }\n};\n\nexport function stopWebsync() {\n  if (DEBUG || IS_TAURI) return;\n\n  if (lastTimeout) clearTimeout(lastTimeout);\n}\n\nexport function startWebsync() {\n  if (DEBUG || IS_TAURI) {\n    return;\n  }\n\n  if (lastTimeout !== undefined) return;\n  const currentTs = getTs();\n\n  const { ts } = JSON.parse(localStorage.getItem(WEBSYNC_KEY) || '{}');\n\n  const timeout = WEBSYNC_TIMEOUT - (currentTs - ts);\n\n  lastTimeout = setTimeout(() => {\n    const { auth } = getGlobal();\n\n    const authed = auth.state === 'authorizationStateReady' || hasStoredSession();\n    forceWebsync(authed);\n  }, Math.max(0, timeout * 1000));\n}\n\nexport function clearWebsync() {\n  localStorage.removeItem(WEBSYNC_KEY);\n}\n","import type { TeactNode } from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ThreadId } from '../../types';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport { ensureProtocol, getUnicodeUrl, isMixedScriptUrl } from '../../util/browser/url';\nimport buildClassName from '../../util/buildClassName';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\ntype OwnProps = {\n  url?: string;\n  text: string;\n  className?: string;\n  children?: TeactNode;\n  isRtl?: boolean;\n  shouldSkipModal?: boolean;\n  chatId?: string;\n  messageId?: number;\n  threadId?: ThreadId;\n  entityType?: ApiMessageEntityTypes.Url | ApiMessageEntityTypes.TextUrl |\n    `${ApiMessageEntityTypes.TextUrl}` | `${ApiMessageEntityTypes.Url}`;\n};\n\nconst SafeLink = ({\n  url,\n  text,\n  className,\n  children,\n  isRtl,\n  shouldSkipModal,\n  chatId,\n  messageId,\n  threadId,\n  entityType = ApiMessageEntityTypes.Url,\n}: OwnProps) => {\n  const { openUrl } = getActions();\n\n  const content = children || text;\n  const isRegularLink = url === text;\n\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\n    if (!url) return true;\n\n    e.preventDefault();\n\n    const isTrustedLink = isRegularLink && !isMixedScriptUrl(url);\n    openUrl({\n      url,\n      shouldSkipModal: shouldSkipModal || isTrustedLink,\n      ...(chatId && messageId && {\n        linkContext: { type: 'message', chatId, threadId, messageId },\n      }),\n    });\n\n    return false;\n  });\n\n  if (!url) {\n    return undefined;\n  }\n\n  const classNames = buildClassName(\n    className || 'text-entity-link',\n    isRegularLink && 'word-break-all',\n  );\n\n  return (\n    <a\n      href={ensureProtocol(url)}\n      title={getUnicodeUrl(url)}\n      target={IS_TAURI ? '_self' : '_blank'}\n      rel=\"noopener noreferrer\"\n      className={classNames}\n      onClick={handleClick}\n      dir={isRtl ? 'rtl' : 'auto'}\n      data-entity-type={entityType}\n    >\n      {content}\n    </a>\n  );\n};\n\nexport default SafeLink;\n","import type {\n  AlphahumanThread,\n  GetMeResponse,\n  Highlight,\n} from '../../lib/alphahuman/rest';\nimport type { AlphahumanThreadMessage } from '../../lib/alphahuman/types';\nimport type { GlobalState } from '../types';\n\nimport { log } from '../../lib/alphahuman/logger';\nimport {\n  createThreadRest,\n  getHighlightsRest,\n  getMeRest,\n  getThreadMessagesRest,\n  getThreadsRest,\n} from '../../lib/alphahuman/rest';\nimport { addActionHandler, getGlobal, setGlobal } from '../index';\n\ntype AlphahumanState = GlobalState['alphahuman'];\n\n/**\n * Update alphahuman state\n */\nexport function updateAlphahuman<T extends GlobalState>(\n  global: T,\n  update: Partial<NonNullable<AlphahumanState>>,\n): T {\n  return {\n    ...global,\n    alphahuman: {\n      ...(global.alphahuman || {}),\n      ...update,\n    },\n  };\n}\n\n/**\n * Set user data (me)\n */\nexport function setAlphahumanMe<T extends GlobalState>(\n  global: T,\n  me: GetMeResponse | undefined,\n): T {\n  return updateAlphahuman(global, {\n    me,\n    meError: undefined,\n  });\n}\n\n/**\n * Set me loading state\n */\nexport function setAlphahumanMeLoading<T extends GlobalState>(\n  global: T,\n  meLoading: boolean,\n): T {\n  return updateAlphahuman(global, { meLoading });\n}\n\n/**\n * Set me error\n */\nexport function setAlphahumanMeError<T extends GlobalState>(\n  global: T,\n  meError: Error | undefined,\n): T {\n  return updateAlphahuman(global, {\n    meError,\n    meLoading: false,\n  });\n}\n\n/**\n * Set threads data\n */\nexport function setAlphahumanThreads<T extends GlobalState>(\n  global: T,\n  threads: AlphahumanThread [],\n  count: number,\n): T {\n  return updateAlphahuman(global, {\n    threads,\n    threadsCount: count,\n    threadsError: undefined,\n  });\n}\n\n/**\n * Set threads loading state\n */\nexport function setAlphahumanThreadsLoading<T extends GlobalState>(\n  global: T,\n  threadsLoading: boolean,\n): T {\n  return updateAlphahuman(global, { threadsLoading });\n}\n\n/**\n * Set threads error\n */\nexport function setAlphahumanThreadsError<T extends GlobalState>(\n  global: T,\n  threadsError: Error | undefined,\n): T {\n  return updateAlphahuman(global, {\n    threadsError,\n    threadsLoading: false,\n  });\n}\n\n/**\n * Set thread messages for a specific thread\n */\nexport function setAlphahumanThreadMessages<T extends GlobalState>(\n  global: T,\n  threadId: string,\n  messages: AlphahumanThreadMessage[],\n  count: number,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    threadMessages: {\n      ...currentState.threadMessages,\n      [threadId]: { messages, count },\n    },\n    threadMessagesError: {\n      ...currentState.threadMessagesError,\n      [threadId]: undefined,\n    },\n  });\n}\n\n/**\n * Set thread messages loading state\n */\nexport function setAlphahumanThreadMessagesLoading<T extends GlobalState>(\n  global: T,\n  threadId: string,\n  loading: boolean,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    threadMessagesLoading: {\n      ...currentState.threadMessagesLoading,\n      [threadId]: loading,\n    },\n  });\n}\n\n/**\n * Set thread messages error\n */\nexport function setAlphahumanThreadMessagesError<T extends GlobalState>(\n  global: T,\n  threadId: string,\n  error: Error | undefined,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    threadMessagesError: {\n      ...currentState.threadMessagesError,\n      [threadId]: error,\n    },\n    threadMessagesLoading: {\n      ...currentState.threadMessagesLoading,\n      [threadId]: false,\n    },\n  });\n}\n\n/**\n * Set highlights for a timeframe\n */\nexport function setAlphahumanHighlights<T extends GlobalState>(\n  global: T,\n  timeframe: 'daily' | 'weekly',\n  highlights: Highlight[],\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    highlights: {\n      daily: currentState.highlights?.daily || [],\n      weekly: currentState.highlights?.weekly || [],\n      [timeframe]: highlights,\n    },\n    highlightsError: {\n      daily: currentState.highlightsError?.daily || undefined,\n      weekly: currentState.highlightsError?.weekly || undefined,\n      [timeframe]: undefined,\n    },\n  });\n}\n\n/**\n * Set highlights loading state\n */\nexport function setAlphahumanHighlightsLoading<T extends GlobalState>(\n  global: T,\n  timeframe: 'daily' | 'weekly',\n  loading: boolean,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    highlightsLoading: {\n      daily: currentState.highlightsLoading?.daily || false,\n      weekly: currentState.highlightsLoading?.weekly || false,\n      [timeframe]: loading,\n    },\n  });\n}\n\n/**\n * Set highlights error\n */\nexport function setAlphahumanHighlightsError<T extends GlobalState>(\n  global: T,\n  timeframe: 'daily' | 'weekly',\n  error: Error | undefined,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    highlightsError: {\n      daily: currentState.highlightsError?.daily || undefined,\n      weekly: currentState.highlightsError?.weekly || undefined,\n      [timeframe]: error,\n    },\n    highlightsLoading: {\n      daily: currentState.highlightsLoading?.daily || false,\n      weekly: currentState.highlightsLoading?.weekly || false,\n      [timeframe]: false,\n    },\n  });\n}\n\n/**\n * Clear thread messages for a specific thread\n */\nexport function clearAlphahumanThreadMessages<T extends GlobalState>(\n  global: T,\n  threadId: string,\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  const newThreadMessages = { ...currentState.threadMessages };\n  const newThreadMessagesLoading = { ...currentState.threadMessagesLoading };\n  const newThreadMessagesError = { ...currentState.threadMessagesError };\n\n  delete newThreadMessages[threadId];\n  delete newThreadMessagesLoading[threadId];\n  delete newThreadMessagesError[threadId];\n\n  return updateAlphahuman(global, {\n    threadMessages: newThreadMessages,\n    threadMessagesLoading: newThreadMessagesLoading,\n    threadMessagesError: newThreadMessagesError,\n  });\n}\n\n/**\n * Clear highlights for a timeframe\n */\nexport function clearAlphahumanHighlights<T extends GlobalState>(\n  global: T,\n  timeframe: 'daily' | 'weekly',\n): T {\n  const currentState = global.alphahuman;\n  if (!currentState) {\n    return global;\n  }\n\n  return updateAlphahuman(global, {\n    highlights: {\n      daily: currentState.highlights?.daily || [],\n      weekly: currentState.highlights?.weekly || [],\n      [timeframe]: [],\n    },\n    highlightsError: {\n      daily: currentState.highlightsError?.daily || undefined,\n      weekly: currentState.highlightsError?.weekly || undefined,\n      [timeframe]: undefined,\n    },\n  });\n}\n\n/**\n * Set active thread ID\n */\nexport function setAlphahumanActiveThreadId<T extends GlobalState>(\n  global: T,\n  threadId: string | undefined,\n): T {\n  return updateAlphahuman(global, {\n    activeThreadId: threadId,\n  });\n}\n\n// Action handlers for API calls\n\naddActionHandler('loadAlphahumanMe', async (global, actions): Promise<void> => {\n  global = setAlphahumanMeLoading(global, true);\n  setGlobal(global);\n  global = getGlobal();\n\n  try {\n    const me = await getMeRest();\n    global = getGlobal();\n    global = setAlphahumanMe(global, me);\n    setGlobal(global);\n  } catch (error) {\n    log('BACKEND ERROR', 'Failed to load alphahuman me:', error);\n    global = getGlobal();\n    global = setAlphahumanMeError(\n      global,\n      error instanceof Error ? error : new Error('Failed to fetch user data'),\n    );\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadAlphahumanThreads', async (global, actions): Promise<void> => {\n  global = setAlphahumanThreadsLoading(global, true);\n  setGlobal(global);\n  global = getGlobal();\n\n  try {\n    const { threads, count } = await getThreadsRest();\n    global = getGlobal();\n    global = setAlphahumanThreads(global, threads, count);\n    global = setAlphahumanThreadsLoading(global, false);\n    setGlobal(global);\n  } catch (error) {\n    log('BACKEND ERROR', 'Failed to load alphahuman threads:', error);\n    global = getGlobal();\n    global = setAlphahumanThreadsError(\n      global,\n      error instanceof Error ? error : new Error('Failed to fetch threads'),\n    );\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadAlphahumanThreadMessages', async (global, actions, payload): Promise<void> => {\n  const { threadId } = payload;\n\n  global = setAlphahumanThreadMessagesLoading(global, threadId, true);\n  setGlobal(global);\n  global = getGlobal();\n\n  try {\n    const { messages, count } = await getThreadMessagesRest(threadId);\n    global = getGlobal();\n    global = setAlphahumanThreadMessages(global, threadId, messages, count);\n    setGlobal(global);\n  } catch (error) {\n    log('BACKEND ERROR', `Failed to load thread messages for ${threadId}:`, error);\n    global = getGlobal();\n    global = setAlphahumanThreadMessagesError(\n      global,\n      threadId,\n      error instanceof Error ? error : new Error('Failed to fetch thread messages'),\n    );\n    setGlobal(global);\n  }\n});\n\naddActionHandler('loadAlphahumanHighlights', async (global, actions, payload): Promise<void> => {\n  const { timeframe } = payload;\n\n  global = setAlphahumanHighlightsLoading(global, timeframe, true);\n  setGlobal(global);\n  global = getGlobal();\n\n  try {\n    const highlights = await getHighlightsRest(timeframe);\n    global = getGlobal();\n    global = setAlphahumanHighlights(global, timeframe, highlights);\n    setGlobal(global);\n  } catch (error) {\n    log('BACKEND ERROR', `Failed to load highlights for ${timeframe}:`, error);\n    global = getGlobal();\n    global = setAlphahumanHighlightsError(\n      global,\n      timeframe,\n      error instanceof Error ? error : new Error('Failed to fetch highlights'),\n    );\n    setGlobal(global);\n  }\n});\n\naddActionHandler('createAlphahumanThread', async (global, actions): Promise<void> => {\n  try {\n    const response = await createThreadRest();\n    const threadId = response.id;\n    global = getGlobal();\n    global = setAlphahumanActiveThreadId(global, threadId);\n\n    // Also set it in aiSocket threads for websocket compatibility\n    const { ensureThreadsInitialized, selectAlphahumanThreadById } = await import('./socket');\n    global = getGlobal();\n    global = ensureThreadsInitialized(global);\n    global = getGlobal();\n    global = selectAlphahumanThreadById(global, threadId);\n\n    setGlobal(global);\n  } catch (error) {\n    log('BACKEND ERROR', 'Failed to create alphahuman thread:', error);\n    // Don't set error state here, let the caller handle it\n  }\n});\n","/**\n * A Map that has a limited size. When the limit is reached, the oldest entry is removed.\n * Ignores last access time, only cares about insertion order.\n */\nexport default class LimitedMap<K, V> {\n  private map: Map<K, V>;\n\n  private insertionQueue: Set<K>;\n\n  constructor(private limit: number) {\n    this.map = new Map();\n    this.insertionQueue = new Set<K>();\n  }\n\n  public get(key: K): V | undefined {\n    return this.map.get(key);\n  }\n\n  public set(key: K, value: V): this {\n    if (this.map.size === this.limit) {\n      const keyToRemove = Array.from(this.insertionQueue).shift();\n      if (keyToRemove) {\n        this.map.delete(keyToRemove);\n        this.insertionQueue.delete(keyToRemove);\n      }\n    }\n\n    this.map.set(key, value);\n    this.insertionQueue.add(key);\n\n    return this;\n  }\n\n  public has(key: K): boolean {\n    return this.map.has(key);\n  }\n\n  public delete(key: K): boolean {\n    const result = this.map.delete(key);\n    if (result) {\n      this.insertionQueue.delete(key);\n    }\n    return result;\n  }\n\n  public clear(): void {\n    this.map.clear();\n    this.insertionQueue.clear();\n  }\n\n  public forEach(callbackfn: (value: V, key: K, map: Map<K, V>) => void, thisArg?: unknown): void {\n    this.map.forEach(callbackfn, thisArg);\n  }\n\n  public get size(): number {\n    return this.map.size;\n  }\n\n  public get [Symbol.toStringTag](): string {\n    return this.map[Symbol.toStringTag];\n  }\n\n  public [Symbol.iterator](): IterableIterator<[K, V]> {\n    return this.map[Symbol.iterator]();\n  }\n\n  public entries(): IterableIterator<[K, V]> {\n    return this.map.entries();\n  }\n\n  public keys(): IterableIterator<K> {\n    return this.map.keys();\n  }\n\n  public values(): IterableIterator<V> {\n    return this.map.values();\n  }\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"fWE9Tkfe\",\"progress\":\"F0JPgXgb\",\"button\":\"B94KQ3c0\",\"symbol\":\"wapdILU7\",\"sparkle\":\"AS3Scly3\",\"noAnimation\":\"caUR_u_a\"};","import { memo, useRef } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport buildStyle from '../../util/buildStyle';\n\nimport styles from './Sparkles.module.scss';\n\ntype ButtonParameters = {\n  preset: 'button';\n};\n\ntype ProgressParameters = {\n  preset: 'progress';\n};\n\ntype PresetParameters = ButtonParameters | ProgressParameters;\n\ntype OwnProps = {\n  className?: string;\n  style?: string;\n  noAnimation?: boolean;\n} & PresetParameters;\n\nconst SYMBOL = '';\nconst ANIMATION_DURATION = 5;\n\n// Values are in percents\nconst BUTTON_POSITIONS = [{\n  x: 20,\n  y: 0,\n  size: 100,\n  durationShift: 10,\n}, {\n  x: 15,\n  y: 15,\n  size: 75,\n  durationShift: 70,\n}, {\n  x: 10,\n  y: 35,\n  size: 75,\n  durationShift: 90,\n}, {\n  x: 20,\n  y: 70,\n  size: 125,\n  durationShift: 30,\n}, {\n  x: 40,\n  y: 10,\n  size: 125,\n  durationShift: 0,\n}, {\n  x: 45,\n  y: 60,\n  size: 75,\n  durationShift: 60,\n}, {\n  x: 60,\n  y: -10,\n  size: 100,\n  durationShift: 20,\n}, {\n  x: 55,\n  y: 40,\n  size: 75,\n  durationShift: 60,\n}, {\n  x: 70,\n  y: 65,\n  size: 100,\n  durationShift: 90,\n}, {\n  x: 80,\n  y: 10,\n  size: 75,\n  durationShift: 30,\n}, {\n  x: 80,\n  y: 45,\n  size: 125,\n  durationShift: 0,\n}];\nconst PROGRESS_POSITIONS = generateRandomProgressPositions(100);\n\nconst Sparkles = ({\n  className,\n  style,\n  noAnimation,\n  ...presetSettings\n}: OwnProps) => {\n  const ref = useRef<HTMLDivElement>();\n\n  if (presetSettings.preset === 'button') {\n    return (\n      <div\n        ref={ref}\n        className={buildClassName(styles.root, styles.button, className, noAnimation && styles.noAnimation)}\n        style={style}\n      >\n        {BUTTON_POSITIONS.map((position) => {\n          const shiftX = Math.cos(Math.atan2(-50 + position.y, -50 + position.x)) * 100;\n          const shiftY = Math.sin(Math.atan2(-50 + position.y, -50 + position.x)) * 100;\n          return (\n            <div\n              className={styles.symbol}\n              style={buildStyle(\n                `top: ${position.y}%`,\n                `left: ${position.x}%`,\n                `--_duration-shift: ${(-position.durationShift / 100) * ANIMATION_DURATION}s`,\n                `--_shift-x: ${shiftX}%`,\n                `--_shift-y: ${shiftY}%`,\n                `scale: ${position.size}%`,\n              )}\n              aria-hidden=\"true\"\n            >\n              {SYMBOL}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  if (presetSettings.preset === 'progress') {\n    return (\n      <div ref={ref} className={buildClassName(styles.root, styles.progress, className)} style={style}>\n        {PROGRESS_POSITIONS.map((position) => {\n          return (\n            <div\n              className={styles.symbol}\n              style={buildStyle(\n                `top: ${position.y}%`,\n                `left: ${position.x}%`,\n                `--_shift-x: ${position.velocityX}%`,\n                `--_shift-y: ${position.velocityY}%`,\n                `scale: ${position.scale}%`,\n                `--_duration-shift: ${(-position.durationShift / 100) * ANIMATION_DURATION}s`,\n              )}\n              aria-hidden=\"true\"\n            >\n              {SYMBOL}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n\n  return undefined;\n};\n\nfunction generateRandomProgressPositions(count: number) {\n  const positions = [];\n  for (let i = 0; i < count; i++) {\n    positions.push({\n      x: Math.random() * 100,\n      y: Math.random() * 100,\n      velocityX: (Math.random() * 5 + 15) * 100,\n      velocityY: (Math.random() * 10 - 5) * 100,\n      scale: (Math.random() * 0.5 + 0.5) * 100,\n      durationShift: Math.random() * 100,\n    });\n  }\n  return positions;\n}\n\nexport default memo(Sparkles);\n","import { DEBUG } from '../config';\n\nexport const CLIPBOARD_ITEM_SUPPORTED = window.navigator.clipboard && window.ClipboardItem;\n\nconst textCopyEl = document.createElement('textarea');\ntextCopyEl.setAttribute('readonly', '');\ntextCopyEl.tabIndex = -1;\ntextCopyEl.className = 'visually-hidden';\n\nexport const copyTextToClipboard = (str: string): void => {\n  textCopyEl.value = str;\n  document.body.appendChild(textCopyEl);\n  const selection = document.getSelection();\n\n  if (selection) {\n    // Store previous selection\n    const rangeToRestore = selection.rangeCount > 0 && selection.getRangeAt(0);\n    textCopyEl.select();\n    document.execCommand('copy');\n    // Restore the original selection\n    if (rangeToRestore) {\n      selection.removeAllRanges();\n      selection.addRange(rangeToRestore);\n    }\n  }\n\n  document.body.removeChild(textCopyEl);\n};\n\nexport const copyHtmlToClipboard = (html: string, text: string): void => {\n  if (!window.navigator.clipboard?.write) {\n    copyTextToClipboard(text);\n    return;\n  }\n\n  window.navigator.clipboard.write([\n    new ClipboardItem({\n      'text/plain': new Blob([text], { type: 'text/plain' }),\n      'text/html': new Blob([html], { type: 'text/html' }),\n    }),\n  ]);\n};\n\nexport const copyImageToClipboard = (imageUrl?: string) => {\n  if (!imageUrl) return;\n  const canvas = document.createElement('canvas');\n  const ctx = canvas.getContext('2d');\n  const imageEl = new Image();\n  imageEl.onload = (e: Event) => {\n    if (ctx && e.currentTarget) {\n      const img = e.currentTarget as HTMLImageElement;\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0, 0, img.width, img.height);\n      canvas.toBlob(copyBlobToClipboard, 'image/png', 1);\n    }\n  };\n\n  imageEl.src = imageUrl;\n};\n\nexport const copyTextToClipboardFromPromise = async (\n  getTextPromise: Promise<string | undefined>,\n  onSuccess: NoneToVoidFunction,\n  onFailure: NoneToVoidFunction,\n) => {\n  const copyTextToClipboardFallback = async () => {\n    try {\n      const text = await getTextPromise;\n      if (text) {\n        copyTextToClipboard(text);\n      } else {\n        onFailure();\n      }\n      return Boolean(text);\n    } catch {\n      onFailure();\n      return false;\n    }\n  };\n  if (!CLIPBOARD_ITEM_SUPPORTED || !navigator.clipboard.write) {\n    if (await copyTextToClipboardFallback()) onSuccess();\n    return;\n  }\n  try {\n    let hasGetDataError = false;\n    const rejectGetDataError = () => Promise.reject(new Error('GET_DATA_ERROR'));\n\n    const clipboardTextItem = new ClipboardItem({\n      'text/plain': getTextPromise.then((text) => text || rejectGetDataError()).catch(() => {\n        hasGetDataError = true;\n        return '';\n      }),\n    });\n    await navigator.clipboard.write([clipboardTextItem]);\n    if (hasGetDataError) {\n      onFailure();\n      return;\n    }\n  } catch {\n    // Promises in ClipboardItem aren't supported in older Chrome versions\n    if (!await copyTextToClipboardFallback()) return;\n  }\n  onSuccess();\n};\n\nasync function copyBlobToClipboard(pngBlob: Blob | null) {\n  if (!pngBlob || !CLIPBOARD_ITEM_SUPPORTED) {\n    return;\n  }\n\n  try {\n    await window.navigator.clipboard.write?.([\n      new ClipboardItem({\n        [pngBlob.type]: pngBlob,\n      }),\n    ]);\n  } catch (error) {\n    if (DEBUG) {\n      // eslint-disable-next-line no-console\n      console.error(error);\n    }\n  }\n}\n","import type { ElementRef } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { memo } from '../../lib/teact/teact';\n\nimport type { ApiPeer, ApiTypePeerColor } from '../../api/types';\n\nimport { selectTheme } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { REM } from './helpers/mediaDimensions';\n\nimport useSelector from '../../hooks/data/useSelector';\nimport usePeerColor from '../../hooks/usePeerColor';\n\nimport CustomEmoji from './CustomEmoji';\nimport EmojiIconBackground from './embedded/EmojiIconBackground';\n\nimport styles from './PeerColorWrapper.module.scss';\n\ninterface OwnProps extends React.HTMLAttributes<HTMLDivElement> {\n  ref?: ElementRef<HTMLDivElement>;\n  peer?: ApiPeer;\n  peerColor?: ApiTypePeerColor;\n  isReply?: boolean;\n  noBar?: boolean;\n  noUserColors?: boolean;\n  shouldReset?: boolean;\n  className?: string;\n  emojiIconClassName?: string;\n  children: React.ReactNode;\n}\n\nconst GIFT_EMOJI_SIZE = 1.25 * REM;\n\nfunction PeerColorWrapper({\n  ref,\n  peer,\n  peerColor,\n  isReply,\n  noBar,\n  noUserColors,\n  shouldReset,\n  className,\n  emojiIconClassName,\n  children,\n  ...otherProps\n}: OwnProps) {\n  const color = peerColor || peer?.color;\n  const theme = useSelector(selectTheme);\n\n  const {\n    style,\n    className: peerColorClassName,\n    backgroundEmojiId,\n    giftEmojiId,\n  } = usePeerColor({ peer, color, noUserColors, shouldReset, theme });\n  const hasGiftEmoji = isReply && Boolean(giftEmojiId);\n\n  return (\n    <div\n      ref={ref}\n      className={buildClassName(\n        styles.root,\n        peerColorClassName,\n        hasGiftEmoji && styles.hasGiftEmoji,\n        !noBar && styles.withBar,\n        className,\n      )}\n      style={style}\n      {...otherProps}\n    >\n      {backgroundEmojiId && (\n        <EmojiIconBackground\n          className={emojiIconClassName}\n          emojiDocumentId={backgroundEmojiId}\n          withEmojiSpace={hasGiftEmoji}\n        />\n      )}\n      {hasGiftEmoji && (\n        <CustomEmoji\n          className={styles.giftEmoji}\n          documentId={giftEmojiId}\n          size={GIFT_EMOJI_SIZE}\n          noPlay\n        />\n      )}\n      {children}\n    </div>\n  );\n}\n\nexport default memo(PeerColorWrapper);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"nRjVJOQv\",\"withBar\":\"_9jsufX2y\",\"hasGiftEmoji\":\"nsd0qT3V\",\"giftEmoji\":\"UAOeEYzU\"};","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type {\n  ApiAttachment,\n  ApiMessage,\n  ApiMessageEntityTextUrl,\n  ApiPeer,\n  ApiStory,\n  ApiTypeStory,\n} from '../../api/types';\nimport type {\n  ApiFormattedText,\n  ApiPoll, ApiReplyInfo, ApiWebPage, MediaContainer, StatefulMediaContent,\n} from '../../api/types/messages';\nimport type { ThreadId } from '../../types';\nimport type { LangFn } from '../../util/localization';\nimport type { GlobalState } from '../types';\nimport { ApiMessageEntityTypes, MAIN_THREAD_ID } from '../../api/types';\n\nimport {\n  LOCAL_MESSAGES_LIMIT,\n  LOTTIE_STICKER_MIME_TYPE,\n  RE_LINK_TEMPLATE,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  SUPPORTED_AUDIO_CONTENT_TYPES,\n  SUPPORTED_PHOTO_CONTENT_TYPES,\n  SUPPORTED_VIDEO_CONTENT_TYPES,\n  TME_LINK_PREFIX,\n  VERIFICATION_CODES_USER_ID,\n  VIDEO_STICKER_MIME_TYPE,\n} from '../../config';\nimport { areDeepEqual } from '../../util/areDeepEqual';\nimport { getRawPeerId, isUserId } from '../../util/entities/ids';\nimport { areSortedArraysIntersecting, unique } from '../../util/iteratees';\nimport { isLocalMessageId } from '../../util/keys/messageKey';\nimport { getServerTime } from '../../util/serverTime';\nimport { getGlobal } from '../index';\nimport { selectPollFromMessage, selectWebPageFromMessage } from '../selectors';\nimport { getMainUsername } from './users';\n\nconst RE_LINK = new RegExp(RE_LINK_TEMPLATE, 'i');\n\nlet uiLocalMessageCounter = 0;\nfunction getNextLocalMessageId(lastMessageId = 0) {\n  return lastMessageId + (++uiLocalMessageCounter / LOCAL_MESSAGES_LIMIT);\n}\n\nexport function getMessageHtmlId(messageId: number, index?: number) {\n  const parts = ['message', messageId.toString().replace('.', '-'), index].filter(Boolean);\n  return parts.join('-');\n}\n\nexport function getMessageOriginalId(message: ApiMessage) {\n  return message.previousLocalId || message.id;\n}\n\nexport function getMessageTranscription(message: ApiMessage) {\n  const { transcriptionId } = message;\n  const global = getGlobal();\n\n  return transcriptionId && global.transcriptions[transcriptionId]?.text;\n}\n\nexport function hasMessageText(message: MediaContainer) {\n  const {\n    action, text, sticker, photo, video, audio, voice, document, pollId, todo,\n    webPage, contact, invoice, location, game, storyData, giveaway, giveawayResults, paidMedia,\n  } = message.content;\n\n  return Boolean(text) || !(\n    sticker || photo || video || audio || voice || document || contact || pollId || todo || webPage\n    || invoice || location || game || storyData || giveaway || giveawayResults\n    || paidMedia || action?.type === 'phoneCall'\n  );\n}\n\nexport function getMessageStatefulContent(global: GlobalState, message: ApiMessage): StatefulMediaContent {\n  const poll = selectPollFromMessage(global, message);\n  const webPage = selectWebPageFromMessage(global, message);\n\n  const { peerId: storyPeerId, id: storyId } = message.content.storyData || {};\n  const story = storyId && storyPeerId ? global.stories.byPeerId[storyPeerId]?.byId[storyId] : undefined;\n\n  return groupStatefulContent({ poll, story, webPage });\n}\n\nexport function groupStatefulContent({\n  poll,\n  story,\n  webPage,\n}: {\n  poll?: ApiPoll;\n  story?: ApiTypeStory;\n  webPage?: ApiWebPage;\n}) {\n  return {\n    poll,\n    story: story && 'content' in story ? story : undefined,\n    webPage,\n  };\n}\n\nexport function getMessageText(message: MediaContainer) {\n  return hasMessageText(message) ? message.content.text : undefined;\n}\n\nexport function getMessageTextWithFallback(lang: LangFn, message: MediaContainer) {\n  return hasMessageText(message) ? message.content.text || { text: lang('MessageUnsupported') } : undefined;\n}\n\nexport function getMessageCustomShape(message: ApiMessage): boolean {\n  const {\n    text, sticker, photo, video, audio, voice,\n    document, pollId, webPage, contact, action,\n    game, invoice, location, storyData,\n  } = message.content;\n\n  if (sticker || (video?.isRound)) {\n    return true;\n  }\n\n  if (!text || photo || video || audio || voice || document || pollId || webPage || contact || action || game\n    || invoice || location || storyData) {\n    return false;\n  }\n\n  const hasOtherFormatting = text?.entities?.some((entity) => entity.type !== ApiMessageEntityTypes.CustomEmoji);\n\n  return Boolean(text.emojiOnlyCount && !hasOtherFormatting);\n}\n\nexport function getMessageSingleRegularEmoji(message: MediaContainer) {\n  const { text } = message.content;\n\n  if (!text || text.entities?.length || text.emojiOnlyCount !== 1) {\n    return undefined;\n  }\n\n  return text.text;\n}\n\nexport function getMessageSingleCustomEmoji(message: MediaContainer): string | undefined {\n  const { text } = message.content;\n\n  const firstEntity = text?.entities?.[0];\n  if (text?.entities?.length !== 1\n    || firstEntity?.type !== ApiMessageEntityTypes.CustomEmoji\n    || firstEntity.offset !== 0\n    || firstEntity.length !== text.text.length) {\n    return undefined;\n  }\n\n  return firstEntity.documentId;\n}\n\nexport function getFirstLinkInMessage(message: ApiMessage) {\n  const { text } = message.content;\n\n  let match: RegExpMatchArray | null | undefined;\n  if (text?.entities) {\n    const firstTextUrl = text.entities.find((entity): entity is ApiMessageEntityTextUrl => (\n      entity.type === ApiMessageEntityTypes.TextUrl\n    ));\n    if (firstTextUrl) {\n      match = firstTextUrl.url.match(RE_LINK);\n    }\n\n    if (!match) {\n      const firstUrl = text.entities.find((entity) => entity.type === ApiMessageEntityTypes.Url);\n      if (firstUrl) {\n        const { offset, length } = firstUrl;\n        match = text.text.substring(offset, offset + length).match(RE_LINK);\n      }\n    }\n  }\n\n  if (!match && text) {\n    match = text.text.match(RE_LINK);\n  }\n\n  if (!match) {\n    return undefined;\n  }\n\n  return {\n    url: match[0],\n    domain: match[3],\n  };\n}\n\nexport function matchLinkInMessageText(message: ApiMessage) {\n  const { text } = message.content;\n  const match = text && text.text.match(RE_LINK);\n\n  if (!match) {\n    return undefined;\n  }\n\n  return {\n    url: match[0],\n    domain: match[3],\n  };\n}\n\nexport function isOwnMessage(message: ApiMessage) {\n  return message.isOutgoing;\n}\n\nexport function isReplyToMessage(message: ApiMessage) {\n  return Boolean(message.replyInfo?.type === 'message');\n}\n\nexport function isForwardedMessage(message: ApiMessage) {\n  return Boolean(message.forwardInfo || message.content.storyData);\n}\n\nexport function isActionMessage(message: ApiMessage) {\n  return Boolean(message.content.action);\n}\n\nexport function isServiceNotificationMessage(message: ApiMessage) {\n  return message.chatId === SERVICE_NOTIFICATIONS_USER_ID && Math.round(message.id) !== message.id;\n}\n\nexport function isAnonymousOwnMessage(message: ApiMessage) {\n  return Boolean(message.senderId) && !isUserId(message.senderId) && isOwnMessage(message);\n}\n\nexport function getSendingState(message: ApiMessage) {\n  if (!message.sendingState) {\n    return 'succeeded';\n  }\n\n  return message.sendingState === 'messageSendingStateFailed' ? 'failed' : 'pending';\n}\n\nexport function isMessageLocal(message: ApiMessage) {\n  return isLocalMessageId(message.id);\n}\n\nexport function isMessageFailed(message: ApiMessage) {\n  return message.sendingState === 'messageSendingStateFailed';\n}\n\nexport function isHistoryClearMessage(message: ApiMessage) {\n  return message.content.action && message.content.action.type === 'historyClear';\n}\n\nexport function isGeoLiveExpired(message: ApiMessage) {\n  const { location } = message.content;\n  if (location?.mediaType !== 'geoLive') return false;\n  return getServerTime() - (message.date || 0) >= location.period;\n}\n\nexport function isMessageTranslatable(message: ApiMessage, allowOutgoing?: boolean) {\n  const { text, game } = message.content;\n\n  const isLocal = isMessageLocal(message);\n  const isServiceNotification = isServiceNotificationMessage(message);\n  const isAction = isActionMessage(message);\n\n  return Boolean(text?.text.length && !text.emojiOnlyCount && !game && (allowOutgoing || !message.isOutgoing)\n    && !isLocal && !isServiceNotification && !isAction && !message.isScheduled);\n}\n\nexport function getMessageSingleInlineButton(message: ApiMessage) {\n  return message.inlineButtons?.length === 1\n    && message.inlineButtons[0].length === 1\n    && message.inlineButtons[0][0];\n}\n\nexport function orderHistoryIds(listedIds: number[]) {\n  return listedIds.sort((a, b) => a - b);\n}\n\nexport function orderPinnedIds(pinnedIds: number[]) {\n  return pinnedIds.sort((a, b) => b - a);\n}\n\nexport function mergeIdRanges(ranges: number[][], idsUpdate: number[]): number[][] {\n  let hasIntersection = false;\n  let newOutlyingLists = ranges.length ? ranges.map((list) => {\n    if (areSortedArraysIntersecting(list, idsUpdate) && !hasIntersection) {\n      hasIntersection = true;\n      return orderHistoryIds(unique(list.concat(idsUpdate)));\n    }\n    return list;\n  }) : [idsUpdate];\n\n  if (!hasIntersection) {\n    newOutlyingLists = newOutlyingLists.concat([idsUpdate]);\n  }\n\n  newOutlyingLists.sort((a, b) => a[0] - b[0]);\n\n  let length = newOutlyingLists.length;\n  for (let i = 0; i < length; i++) {\n    const array = newOutlyingLists[i];\n    const prevArray = newOutlyingLists[i - 1];\n\n    if (prevArray && (prevArray.includes(array[0]) || prevArray.includes(array[0] - 1))) {\n      newOutlyingLists[i - 1] = orderHistoryIds(unique(array.concat(prevArray)));\n      newOutlyingLists.splice(i, 1);\n\n      length--;\n      i--;\n    }\n  }\n\n  return newOutlyingLists;\n}\n\nexport function extractMessageText(message: ApiMessage | ApiStory, inChatList = false) {\n  const contentText = message.content.text;\n  if (!contentText) return undefined;\n\n  const { text } = contentText;\n  let { entities } = contentText;\n\n  if (text && 'chatId' in message) {\n    if (message.chatId === SERVICE_NOTIFICATIONS_USER_ID) {\n      const authCode = text.match(/^\\D*([\\d-]{5,7})\\D/)?.[1];\n      if (authCode) {\n        entities = [\n          ...entities || [],\n          {\n            type: inChatList ? ApiMessageEntityTypes.Spoiler : ApiMessageEntityTypes.Code,\n            offset: text.indexOf(authCode),\n            length: authCode.length,\n          },\n        ];\n        entities.sort((a, b) => (a.offset > b.offset ? 1 : -1));\n      }\n    }\n\n    if (inChatList && message.chatId === VERIFICATION_CODES_USER_ID && entities) {\n      // Wrap code entities in spoiler\n      const hasCodeEntities = entities.some((entity) => entity.type === ApiMessageEntityTypes.Code);\n      if (hasCodeEntities) {\n        const oldEntities = entities;\n        entities = [];\n\n        for (let i = 0; i < oldEntities.length; i++) {\n          const entity = oldEntities[i];\n          if (entity.type === ApiMessageEntityTypes.Code) {\n            entities.push({\n              type: ApiMessageEntityTypes.Spoiler,\n              offset: entity.offset,\n              length: entity.length,\n            });\n          }\n          entities.push(entity);\n        }\n      }\n    }\n  }\n\n  return { text, entities };\n}\n\nexport function isExpiredMessage(message: ApiMessage) {\n  return message.content.action?.type === 'expired';\n}\n\nexport function hasMessageTtl(message: ApiMessage) {\n  return message.content?.ttlSeconds !== undefined;\n}\n\nexport function getAttachmentMediaType(attachment: ApiAttachment) {\n  if (SUPPORTED_AUDIO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'audio';\n  }\n\n  if (attachment.shouldSendAsFile) return 'file';\n\n  if (SUPPORTED_PHOTO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'photo';\n  }\n\n  if (SUPPORTED_VIDEO_CONTENT_TYPES.has(attachment.mimeType)) {\n    return 'video';\n  }\n\n  return 'file';\n}\n\nexport function isUploadingFileSticker(attachment: ApiAttachment) {\n  return attachment ? (attachment.mimeType === 'image/webp' || attachment.mimeType === LOTTIE_STICKER_MIME_TYPE\n    || attachment.mimeType === VIDEO_STICKER_MIME_TYPE) : undefined;\n}\n\nexport function getMessageLink(peer: ApiPeer, topicId?: ThreadId, messageId?: number) {\n  const chatUsername = getMainUsername(peer);\n\n  const normalizedId = getRawPeerId(peer.id).toString();\n\n  const chatPart = chatUsername || `c/${normalizedId}`;\n  const topicPart = topicId && topicId !== MAIN_THREAD_ID ? `/${topicId}` : '';\n  const messagePart = messageId ? `/${messageId}` : '';\n  return `${TME_LINK_PREFIX}${chatPart}${topicPart}${messagePart}`;\n}\n\nexport function splitMessagesForForwarding(messages: ApiMessage[], limit: number): ApiMessage[][] {\n  const result: ApiMessage[][] = [];\n  let currentArr: ApiMessage[] = [];\n\n  // Group messages by `groupedId`\n  messages.reduce<ApiMessage[][]>((acc, message) => {\n    const lastGroup = acc[acc.length - 1];\n    if (message.groupedId && lastGroup?.[0]?.groupedId === message.groupedId) {\n      lastGroup.push(message);\n      return acc;\n    }\n\n    acc.push([message]);\n    return acc;\n  }, []).forEach((batch) => {\n    // Fit them into `limit` size\n    if (currentArr.length + batch.length > limit) {\n      result.push(currentArr);\n      currentArr = [];\n    }\n\n    currentArr.push(...batch);\n  });\n\n  if (currentArr.length) {\n    result.push(currentArr);\n  }\n\n  return result;\n}\n\nexport interface SuggestedChangesInfo {\n  isNewText: boolean;\n  isNewPrice: boolean;\n  isNewTime: boolean;\n  isNewMedia: boolean;\n}\n\nexport function getSuggestedChangesInfo(\n  message: ApiMessage,\n  originalMessage?: ApiMessage,\n): SuggestedChangesInfo | undefined {\n  if (!message.suggestedPostInfo || message.replyInfo?.type !== 'message'\n    || !message.replyInfo?.replyToMsgId || !originalMessage) {\n    return undefined;\n  }\n\n  if (!originalMessage.suggestedPostInfo) {\n    return undefined;\n  }\n\n  const original = originalMessage.suggestedPostInfo;\n  const suggested = message.suggestedPostInfo;\n\n  const originalContent = originalMessage.content;\n  const suggestedContent = message.content;\n  const { text: originalText, ...originalMediaContent } = originalContent;\n  const { text: suggestedText, ...suggestedMediaContent } = suggestedContent;\n\n  const isNewText = !areDeepEqual(originalText, suggestedText);\n  const isNewMedia = !areDeepEqual(originalMediaContent, suggestedMediaContent);\n\n  const originalPrice = original.price?.amount;\n  const suggestedPrice = suggested.price?.amount;\n  const isNewPrice = originalPrice !== suggestedPrice;\n\n  const originalTime = original.scheduleDate;\n  const suggestedTime = suggested.scheduleDate;\n  const isNewTime = originalTime !== suggestedTime;\n\n  if (!isNewText && !isNewPrice && !isNewTime && !isNewMedia) {\n    return undefined;\n  }\n\n  return {\n    isNewText,\n    isNewPrice,\n    isNewTime,\n    isNewMedia,\n  };\n}\n\nexport function getSuggestedChangesActionText(\n  lang: LangFn,\n  message: ApiMessage,\n  originalMessage?: ApiMessage,\n  isOutgoing?: boolean,\n  senderLink?: TeactNode,\n): TeactNode | undefined {\n  const changesInfo = getSuggestedChangesInfo(message, originalMessage);\n  if (!changesInfo) {\n    return undefined;\n  }\n\n  const changesParts: string[] = [];\n  if (changesInfo.isNewPrice) changesParts.push(lang('ActionSuggestedChangesPrice'));\n  if (changesInfo.isNewTime) changesParts.push(lang('ActionSuggestedChangesTime'));\n  if (changesInfo.isNewText) changesParts.push(lang('ActionSuggestedChangesText'));\n  if (changesInfo.isNewMedia) changesParts.push(lang('ActionSuggestedChangesMedia'));\n\n  const changesText = lang.conjunction(changesParts);\n\n  const langKey = isOutgoing ? 'ActionSuggestedChangesOutgoing' : 'ActionSuggestedChangesIncoming';\n  return lang(langKey, {\n    changes: changesText,\n    user: senderLink,\n  }, {\n    withNodes: true,\n    withMarkdown: true,\n  });\n}\n\nexport function createApiMessageFromTypingDraft({\n  lastMessageId,\n  chatId,\n  threadId,\n  text,\n}: {\n  lastMessageId: number;\n  chatId: string;\n  threadId: ThreadId;\n  text: ApiFormattedText;\n}): ApiMessage {\n  const localId = getNextLocalMessageId(lastMessageId);\n\n  const replyInfo: ApiReplyInfo | undefined = typeof threadId === 'number' && threadId !== MAIN_THREAD_ID ? {\n    type: 'message',\n    replyToMsgId: threadId,\n    replyToTopId: threadId,\n    isForumTopic: true,\n  } : undefined;\n\n  return {\n    id: localId,\n    chatId,\n    replyInfo,\n    isOutgoing: false,\n    date: getServerTime(),\n    content: {\n      text,\n    },\n    isSilent: true,\n    isTypingDraft: true,\n    editDate: getServerTime(),\n  };\n}\n","import type { ElementRef } from '../../lib/teact/teact';\nimport { useMemo } from '../../lib/teact/teact';\n\nimport { prepareHexColor } from '../../util/themeStyle';\nimport useStyleObserver from '../element/useStyleObserver';\n\nconst DEBOUNCE = 50; // ms\n\n// Style observer that returns hex color value of the property\nexport default function useDynamicColorListener(\n  ref: ElementRef<HTMLElement>,\n  property = 'color',\n  isDisabled?: boolean,\n) {\n  const value = useStyleObserver(ref, property, DEBOUNCE, isDisabled);\n  const hexColor = useMemo(() => (value ? prepareHexColor(value) : undefined), [value]);\n\n  return hexColor;\n}\n","import type { ElementRef } from '../../lib/teact/teact';\nimport { useEffect, useLayoutEffect, useState } from '../../lib/teact/teact';\n\nimport useLastCallback from '../useLastCallback';\nimport useResizeObserver from '../useResizeObserver';\n\nconst UPDATE_DEBOUNCE = 50; // ms\n\n/**\n * @param property animateable property\n */\nexport default function useStyleObserver(\n  ref: ElementRef<HTMLElement>,\n  property: string,\n  debounce = UPDATE_DEBOUNCE,\n  isDisabled?: boolean,\n) {\n  const [value, setValue] = useState<string | undefined>();\n\n  const updateValue = useLastCallback(() => {\n    if (!ref.current || isDisabled) {\n      setValue(undefined);\n      return;\n    }\n\n    const computedValue = getComputedStyle(ref.current).getPropertyValue(property).trim();\n    setValue(computedValue);\n  });\n\n  // Element does not receive `transitionend` event if parent has `display: none`.\n  // We will receive `resize` event when parent is shown again.\n  useResizeObserver(ref, updateValue, isDisabled);\n\n  useLayoutEffect(() => {\n    const el = ref.current;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    el.style.setProperty('transition', `${debounce}ms ${property} linear`, 'important');\n\n    return () => {\n      el.style.removeProperty('transition');\n    };\n  }, [debounce, isDisabled, property, ref]);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      return undefined;\n    }\n\n    updateValue();\n\n    if (isDisabled) {\n      return undefined;\n    }\n\n    function handleTransitionEnd(e: TransitionEvent) {\n      if (e.propertyName !== property) return;\n      updateValue();\n    }\n\n    el.addEventListener('transitionend', handleTransitionEnd);\n\n    return () => {\n      el.removeEventListener('transitionend', handleTransitionEnd);\n    };\n  }, [isDisabled, property, ref, updateValue]);\n\n  return value;\n}\n","type Parts = (string | false | undefined)[];\ntype PartsWithGlobals = (string | false | undefined | string[])[];\ntype ClassNameBuilder =\n  ((elementName: string, ...modifiers: PartsWithGlobals) => string)\n  & Record<string, string>;\n\nexport default function buildClassName(...parts: Parts) {\n  return parts.filter(Boolean).join(' ');\n}\n\nexport function createClassNameBuilder(componentName: string) {\n  return ((elementName: string, ...modifiers: PartsWithGlobals) => {\n    const baseName = elementName === '&' ? componentName : `${componentName}__${elementName}`;\n\n    return modifiers.reduce<string[]>((acc, modifier) => {\n      if (modifier) {\n        // A bit hacky way to pass global class names\n        if (Array.isArray(modifier)) {\n          acc.push(...modifier);\n        } else {\n          acc.push(`${baseName}--${modifier}`);\n        }\n      }\n\n      return acc;\n    }, [baseName]).join(' ');\n  }) as ClassNameBuilder;\n}\n","import type { ElementRef, FC } from '../../lib/teact/teact';\nimport { memo, useRef, useState } from '../../lib/teact/teact';\nimport { getGlobal } from '../../global';\n\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport { ApiMessageEntityTypes } from '../../api/types';\n\nimport { selectIsAlwaysHighPriorityEmoji } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport safePlay from '../../util/safePlay';\n\nimport useDynamicColorListener from '../../hooks/stickers/useDynamicColorListener';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useCustomEmoji from './hooks/useCustomEmoji';\n\nimport StickerView from './StickerView';\n\nimport styles from './CustomEmoji.module.scss';\n\nimport blankImg from '../../assets/blank.png';\n\ntype OwnProps = {\n  ref?: ElementRef<HTMLDivElement>;\n  documentId: string;\n  className?: string;\n  style?: string;\n  size?: number;\n  isBig?: boolean;\n  noPlay?: boolean;\n  noVideoOnMobile?: boolean;\n  loopLimit?: number;\n  shouldNotLoop?: boolean;\n  isSelectable?: boolean;\n  withSharedAnimation?: boolean;\n  sharedCanvasRef?: ElementRef<HTMLCanvasElement>;\n  sharedCanvasHqRef?: ElementRef<HTMLCanvasElement>;\n  withTranslucentThumb?: boolean;\n  shouldPreloadPreview?: boolean;\n  forceOnHeavyAnimation?: boolean;\n  forceAlways?: boolean;\n  observeIntersectionForLoading?: ObserveFn;\n  observeIntersectionForPlaying?: ObserveFn;\n  onClick?: NoneToVoidFunction;\n  onAnimationEnd?: NoneToVoidFunction;\n};\n\nconst STICKER_SIZE = 20;\n\nconst CustomEmoji: FC<OwnProps> = ({\n  ref,\n  documentId,\n  className,\n  style,\n  size = STICKER_SIZE,\n  isBig,\n  noPlay,\n  noVideoOnMobile,\n  loopLimit,\n  shouldNotLoop,\n  isSelectable,\n  withSharedAnimation,\n  sharedCanvasRef,\n  sharedCanvasHqRef,\n  withTranslucentThumb,\n  shouldPreloadPreview,\n  forceAlways,\n  forceOnHeavyAnimation,\n  observeIntersectionForLoading,\n  observeIntersectionForPlaying,\n  onClick,\n  onAnimationEnd,\n}) => {\n  let containerRef = useRef<HTMLDivElement>();\n  if (ref) {\n    containerRef = ref;\n  }\n\n  // An alternative to `withGlobal` to avoid adding numerous global containers\n  const { customEmoji, canPlay } = useCustomEmoji(documentId);\n\n  const loopCountRef = useRef(0);\n  const [shouldPlay, setShouldPlay] = useState(true);\n\n  const hasCustomColor = customEmoji?.shouldUseTextColor;\n  const customColor = useDynamicColorListener(containerRef, undefined, !hasCustomColor);\n\n  const handleVideoEnded = useLastCallback((e) => {\n    if (!loopLimit) return;\n\n    loopCountRef.current += 1;\n\n    if (loopCountRef.current >= loopLimit) {\n      setShouldPlay(false);\n      e.currentTarget.currentTime = 0;\n    } else {\n      // Loop manually\n      safePlay(e.currentTarget);\n    }\n  });\n\n  const handleStickerLoop = useLastCallback(() => {\n    if (!loopLimit) return;\n\n    loopCountRef.current += 1;\n\n    if (loopCountRef.current >= loopLimit) {\n      setShouldPlay(false);\n    }\n  });\n\n  const isHq = customEmoji?.stickerSetInfo && selectIsAlwaysHighPriorityEmoji(getGlobal(), customEmoji.stickerSetInfo);\n\n  return (\n    <div\n      ref={containerRef}\n      className={buildClassName(\n        styles.root,\n        className,\n        'custom-emoji',\n        'emoji',\n      )}\n      onClick={onClick}\n      onAnimationEnd={onAnimationEnd}\n      data-entity-type={ApiMessageEntityTypes.CustomEmoji}\n      data-document-id={documentId}\n      data-alt={customEmoji?.emoji}\n      style={style}\n    >\n      {isSelectable && (\n        <img\n          className={styles.highlightCatch}\n          src={blankImg}\n          alt={customEmoji?.emoji}\n          data-entity-type={ApiMessageEntityTypes.CustomEmoji}\n          data-document-id={documentId}\n          draggable={false}\n        />\n      )}\n      {!customEmoji ? (\n        <div className={buildClassName(styles.placeholder)} draggable={false} />\n      ) : (\n        <StickerView\n          containerRef={containerRef}\n          sticker={customEmoji}\n          isSmall={!isBig}\n          size={size}\n          noPlay={noPlay || !(shouldPlay && canPlay)}\n          noVideoOnMobile={noVideoOnMobile}\n          thumbClassName={styles.thumb}\n          fullMediaClassName={styles.media}\n          shouldLoop={!shouldNotLoop}\n          loopLimit={loopLimit}\n          shouldPreloadPreview={shouldPreloadPreview || noPlay || !canPlay}\n          forceOnHeavyAnimation={forceOnHeavyAnimation}\n          forceAlways={forceAlways}\n          observeIntersectionForLoading={observeIntersectionForLoading}\n          observeIntersectionForPlaying={observeIntersectionForPlaying}\n          withSharedAnimation={withSharedAnimation}\n          sharedCanvasRef={isHq ? sharedCanvasHqRef : sharedCanvasRef}\n          withTranslucentThumb={withTranslucentThumb}\n          onVideoEnded={handleVideoEnded}\n          onAnimatedStickerLoop={handleStickerLoop}\n          customColor={customColor}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default memo(CustomEmoji);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"CEFe1FhH\",\"placeholder\":\"DKi1177s\",\"thumb\":\"O_TaDxWg\",\"media\":\"wqju02hR\",\"highlight-catch\":\"a8dMNkh3\",\"highlightCatch\":\"a8dMNkh3\"};","import { CONTENT_TYPES_WITH_PREVIEW } from '../config';\nimport { pause } from './schedulers';\n\n// Polyfill for Safari: `File` is not available in web worker\nif (typeof File === 'undefined') {\n  self.File = class extends Blob {\n    name: string;\n\n    constructor(fileBits: BlobPart[], fileName: string, options?: FilePropertyBag) {\n      if (options) {\n        const { type, ...rest } = options;\n        super(fileBits, { type });\n        Object.assign(this, rest);\n      } else {\n        super(fileBits);\n      }\n\n      this.name = fileName;\n    }\n  } as typeof File;\n}\n\nexport function blobToDataUri(blob: Blob): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n\n    reader.onload = (e: ProgressEvent<FileReader>) => {\n      const { result } = e.target || {};\n      if (typeof result === 'string') {\n        resolve(result);\n      }\n\n      reject(new Error('Failed to read blob'));\n    };\n\n    reader.onerror = reject;\n    reader.readAsDataURL(blob);\n  });\n}\n\nexport function blobToFile(blob: Blob, fileName: string) {\n  return new File([blob], fileName, {\n    lastModified: Date.now(),\n    type: blob.type,\n  });\n}\n\nexport function preloadImage(url: string): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = reject;\n    img.src = url;\n  });\n}\n\nexport function preloadVideo(url: string): Promise<HTMLVideoElement> {\n  return new Promise((resolve, reject) => {\n    const video = document.createElement('video');\n    video.volume = 0;\n    video.onloadedmetadata = () => resolve(video);\n    video.onerror = reject;\n    video.src = url;\n  });\n}\n\nexport async function createPosterForVideo(url: string): Promise<string | undefined> {\n  try {\n    const video = await preloadVideo(url);\n\n    return await Promise.race([\n      pause(2000) as Promise<undefined>,\n      new Promise<string | undefined>((resolve, reject) => {\n        video.onseeked = () => {\n          if (!video.videoWidth || !video.videoHeight) {\n            resolve(undefined);\n          }\n\n          const canvas = document.createElement('canvas');\n          canvas.width = video.videoWidth;\n          canvas.height = video.videoHeight;\n          const ctx = canvas.getContext('2d')!;\n          ctx.drawImage(video, 0, 0);\n\n          canvas.toBlob((blob) => {\n            resolve(blob ? URL.createObjectURL(blob) : undefined);\n          });\n        };\n        video.onerror = reject;\n        video.currentTime = Math.min(video.duration, 1);\n      }),\n    ]);\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport async function fetchBlob(blobUrl: string) {\n  const response = await fetch(blobUrl);\n  return response.blob();\n}\n\nexport async function fetchFile(blobUrl: string, fileName: string) {\n  const blob = await fetchBlob(blobUrl);\n  return blobToFile(blob, fileName);\n}\n\nexport function imgToCanvas(img: HTMLImageElement) {\n  const canvas = document.createElement('canvas');\n  canvas.width = img.width;\n  canvas.height = img.height;\n\n  const ctx = canvas.getContext('2d')!;\n  ctx.drawImage(img, 0, 0);\n\n  return canvas;\n}\n\nexport function hasPreview(file: File) {\n  return CONTENT_TYPES_WITH_PREVIEW.has(file.type);\n}\n\nexport function validateFiles(files: File[] | FileList | null): File[] | undefined {\n  if (!files?.length) {\n    return undefined;\n  }\n  return Array.from(files).map(fixMovMime).filter((file) => file.size);\n}\n\n// .mov MIME type not reported sometimes https://developer.mozilla.org/en-US/docs/Web/API/File/type#sect1\nfunction fixMovMime(file: File) {\n  const ext = file.name.split('.').pop()!;\n  if (!file.type && ext.toLowerCase() === 'mov') {\n    return new File([file], file.name, { type: 'video/quicktime' });\n  }\n  return file;\n}\n","\n/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.pako = {}));\n})(this, (function (exports) { 'use strict';\n\n  // Note: adler32 takes 12% for level 0 and 2% for level 6.\n  // It isn't worth it to make additional optimizations as in original.\n  // Small size is preferable.\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  const adler32 = (adler, buf, len, pos) => {\n    let s1 = (adler & 0xffff) |0,\n        s2 = ((adler >>> 16) & 0xffff) |0,\n        n = 0;\n\n    while (len !== 0) {\n      // Set limit ~ twice less than 5552, to keep\n      // s2 in 31-bits, because we force signed ints.\n      // in other case %= will fail.\n      n = len > 2000 ? 2000 : len;\n      len -= n;\n\n      do {\n        s1 = (s1 + buf[pos++]) |0;\n        s2 = (s2 + s1) |0;\n      } while (--n);\n\n      s1 %= 65521;\n      s2 %= 65521;\n    }\n\n    return (s1 | (s2 << 16)) |0;\n  };\n\n\n  var adler32_1 = adler32;\n\n  // Note: we can't get significant speed boost here.\n  // So write code to minimize size - no pregenerated tables\n  // and array tools dependencies.\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  // Use ordinary array, since untyped makes no boost here\n  const makeTable = () => {\n    let c, table = [];\n\n    for (var n = 0; n < 256; n++) {\n      c = n;\n      for (var k = 0; k < 8; k++) {\n        c = ((c & 1) ? (0xEDB88320 ^ (c >>> 1)) : (c >>> 1));\n      }\n      table[n] = c;\n    }\n\n    return table;\n  };\n\n  // Create table on load. Just 255 signed longs. Not a problem.\n  const crcTable = new Uint32Array(makeTable());\n\n\n  const crc32 = (crc, buf, len, pos) => {\n    const t = crcTable;\n    const end = pos + len;\n\n    crc ^= -1;\n\n    for (let i = pos; i < end; i++) {\n      crc = (crc >>> 8) ^ t[(crc ^ buf[i]) & 0xFF];\n    }\n\n    return (crc ^ (-1)); // >>> 0;\n  };\n\n\n  var crc32_1 = crc32;\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  // See state defs from inflate.js\n  const BAD$1 = 16209;       /* got a data error -- remain here until reset */\n  const TYPE$1 = 16191;      /* i: waiting for type bits, including last-flag bit */\n\n  /*\n     Decode literal, length, and distance codes and write out the resulting\n     literal and match bytes until either not enough input or output is\n     available, an end-of-block is encountered, or a data error is encountered.\n     When large enough input and output buffers are supplied to inflate(), for\n     example, a 16K input buffer and a 64K output buffer, more than 95% of the\n     inflate execution time is spent in this routine.\n\n     Entry assumptions:\n\n          state.mode === LEN\n          strm.avail_in >= 6\n          strm.avail_out >= 258\n          start >= strm.avail_out\n          state.bits < 8\n\n     On return, state.mode is one of:\n\n          LEN -- ran out of enough output space or enough available input\n          TYPE -- reached end of block code, inflate() to interpret next block\n          BAD -- error in block data\n\n     Notes:\n\n      - The maximum input bits used by a length/distance pair is 15 bits for the\n        length code, 5 bits for the length extra, 15 bits for the distance code,\n        and 13 bits for the distance extra.  This totals 48 bits, or six bytes.\n        Therefore if strm.avail_in >= 6, then there is enough input to avoid\n        checking for available input while decoding.\n\n      - The maximum bytes that a single length/distance pair can output is 258\n        bytes, which is the maximum length that can be coded.  inflate_fast()\n        requires strm.avail_out >= 258 for each loop to avoid checking for\n        output space.\n   */\n  var inffast = function inflate_fast(strm, start) {\n    let _in;                    /* local strm.input */\n    let last;                   /* have enough input while in < last */\n    let _out;                   /* local strm.output */\n    let beg;                    /* inflate()'s initial strm.output */\n    let end;                    /* while out < end, enough space available */\n  //#ifdef INFLATE_STRICT\n    let dmax;                   /* maximum distance from zlib header */\n  //#endif\n    let wsize;                  /* window size or zero if not using window */\n    let whave;                  /* valid bytes in the window */\n    let wnext;                  /* window write index */\n    // Use `s_window` instead `window`, avoid conflict with instrumentation tools\n    let s_window;               /* allocated sliding window, if wsize != 0 */\n    let hold;                   /* local strm.hold */\n    let bits;                   /* local strm.bits */\n    let lcode;                  /* local strm.lencode */\n    let dcode;                  /* local strm.distcode */\n    let lmask;                  /* mask for first level of length codes */\n    let dmask;                  /* mask for first level of distance codes */\n    let here;                   /* retrieved table entry */\n    let op;                     /* code bits, operation, extra bits, or */\n                                /*  window position, window bytes to copy */\n    let len;                    /* match length, unused bytes */\n    let dist;                   /* match distance */\n    let from;                   /* where to copy match from */\n    let from_source;\n\n\n    let input, output; // JS specific, because we have no pointers\n\n    /* copy state to local variables */\n    const state = strm.state;\n    //here = state.here;\n    _in = strm.next_in;\n    input = strm.input;\n    last = _in + (strm.avail_in - 5);\n    _out = strm.next_out;\n    output = strm.output;\n    beg = _out - (start - strm.avail_out);\n    end = _out + (strm.avail_out - 257);\n  //#ifdef INFLATE_STRICT\n    dmax = state.dmax;\n  //#endif\n    wsize = state.wsize;\n    whave = state.whave;\n    wnext = state.wnext;\n    s_window = state.window;\n    hold = state.hold;\n    bits = state.bits;\n    lcode = state.lencode;\n    dcode = state.distcode;\n    lmask = (1 << state.lenbits) - 1;\n    dmask = (1 << state.distbits) - 1;\n\n\n    /* decode literals and length/distances until end-of-block or not enough\n       input data or output space */\n\n    top:\n    do {\n      if (bits < 15) {\n        hold += input[_in++] << bits;\n        bits += 8;\n        hold += input[_in++] << bits;\n        bits += 8;\n      }\n\n      here = lcode[hold & lmask];\n\n      dolen:\n      for (;;) { // Goto emulation\n        op = here >>> 24/*here.bits*/;\n        hold >>>= op;\n        bits -= op;\n        op = (here >>> 16) & 0xff/*here.op*/;\n        if (op === 0) {                          /* literal */\n          //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n          //        \"inflate:         literal '%c'\\n\" :\n          //        \"inflate:         literal 0x%02x\\n\", here.val));\n          output[_out++] = here & 0xffff/*here.val*/;\n        }\n        else if (op & 16) {                     /* length base */\n          len = here & 0xffff/*here.val*/;\n          op &= 15;                           /* number of extra bits */\n          if (op) {\n            if (bits < op) {\n              hold += input[_in++] << bits;\n              bits += 8;\n            }\n            len += hold & ((1 << op) - 1);\n            hold >>>= op;\n            bits -= op;\n          }\n          //Tracevv((stderr, \"inflate:         length %u\\n\", len));\n          if (bits < 15) {\n            hold += input[_in++] << bits;\n            bits += 8;\n            hold += input[_in++] << bits;\n            bits += 8;\n          }\n          here = dcode[hold & dmask];\n\n          dodist:\n          for (;;) { // goto emulation\n            op = here >>> 24/*here.bits*/;\n            hold >>>= op;\n            bits -= op;\n            op = (here >>> 16) & 0xff/*here.op*/;\n\n            if (op & 16) {                      /* distance base */\n              dist = here & 0xffff/*here.val*/;\n              op &= 15;                       /* number of extra bits */\n              if (bits < op) {\n                hold += input[_in++] << bits;\n                bits += 8;\n                if (bits < op) {\n                  hold += input[_in++] << bits;\n                  bits += 8;\n                }\n              }\n              dist += hold & ((1 << op) - 1);\n  //#ifdef INFLATE_STRICT\n              if (dist > dmax) {\n                strm.msg = 'invalid distance too far back';\n                state.mode = BAD$1;\n                break top;\n              }\n  //#endif\n              hold >>>= op;\n              bits -= op;\n              //Tracevv((stderr, \"inflate:         distance %u\\n\", dist));\n              op = _out - beg;                /* max distance in output */\n              if (dist > op) {                /* see if copy from window */\n                op = dist - op;               /* distance back in window */\n                if (op > whave) {\n                  if (state.sane) {\n                    strm.msg = 'invalid distance too far back';\n                    state.mode = BAD$1;\n                    break top;\n                  }\n\n  // (!) This block is disabled in zlib defaults,\n  // don't enable it for binary compatibility\n  //#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n  //                if (len <= op - whave) {\n  //                  do {\n  //                    output[_out++] = 0;\n  //                  } while (--len);\n  //                  continue top;\n  //                }\n  //                len -= op - whave;\n  //                do {\n  //                  output[_out++] = 0;\n  //                } while (--op > whave);\n  //                if (op === 0) {\n  //                  from = _out - dist;\n  //                  do {\n  //                    output[_out++] = output[from++];\n  //                  } while (--len);\n  //                  continue top;\n  //                }\n  //#endif\n                }\n                from = 0; // window index\n                from_source = s_window;\n                if (wnext === 0) {           /* very common case */\n                  from += wsize - op;\n                  if (op < len) {         /* some from window */\n                    len -= op;\n                    do {\n                      output[_out++] = s_window[from++];\n                    } while (--op);\n                    from = _out - dist;  /* rest from output */\n                    from_source = output;\n                  }\n                }\n                else if (wnext < op) {      /* wrap around window */\n                  from += wsize + wnext - op;\n                  op -= wnext;\n                  if (op < len) {         /* some from end of window */\n                    len -= op;\n                    do {\n                      output[_out++] = s_window[from++];\n                    } while (--op);\n                    from = 0;\n                    if (wnext < len) {  /* some from start of window */\n                      op = wnext;\n                      len -= op;\n                      do {\n                        output[_out++] = s_window[from++];\n                      } while (--op);\n                      from = _out - dist;      /* rest from output */\n                      from_source = output;\n                    }\n                  }\n                }\n                else {                      /* contiguous in window */\n                  from += wnext - op;\n                  if (op < len) {         /* some from window */\n                    len -= op;\n                    do {\n                      output[_out++] = s_window[from++];\n                    } while (--op);\n                    from = _out - dist;  /* rest from output */\n                    from_source = output;\n                  }\n                }\n                while (len > 2) {\n                  output[_out++] = from_source[from++];\n                  output[_out++] = from_source[from++];\n                  output[_out++] = from_source[from++];\n                  len -= 3;\n                }\n                if (len) {\n                  output[_out++] = from_source[from++];\n                  if (len > 1) {\n                    output[_out++] = from_source[from++];\n                  }\n                }\n              }\n              else {\n                from = _out - dist;          /* copy direct from output */\n                do {                        /* minimum length is three */\n                  output[_out++] = output[from++];\n                  output[_out++] = output[from++];\n                  output[_out++] = output[from++];\n                  len -= 3;\n                } while (len > 2);\n                if (len) {\n                  output[_out++] = output[from++];\n                  if (len > 1) {\n                    output[_out++] = output[from++];\n                  }\n                }\n              }\n            }\n            else if ((op & 64) === 0) {          /* 2nd level distance code */\n              here = dcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n              continue dodist;\n            }\n            else {\n              strm.msg = 'invalid distance code';\n              state.mode = BAD$1;\n              break top;\n            }\n\n            break; // need to emulate goto via \"continue\"\n          }\n        }\n        else if ((op & 64) === 0) {              /* 2nd level length code */\n          here = lcode[(here & 0xffff)/*here.val*/ + (hold & ((1 << op) - 1))];\n          continue dolen;\n        }\n        else if (op & 32) {                     /* end-of-block */\n          //Tracevv((stderr, \"inflate:         end of block\\n\"));\n          state.mode = TYPE$1;\n          break top;\n        }\n        else {\n          strm.msg = 'invalid literal/length code';\n          state.mode = BAD$1;\n          break top;\n        }\n\n        break; // need to emulate goto via \"continue\"\n      }\n    } while (_in < last && _out < end);\n\n    /* return unused bytes (on entry, bits < 8, so in won't go too far back) */\n    len = bits >> 3;\n    _in -= len;\n    bits -= len << 3;\n    hold &= (1 << bits) - 1;\n\n    /* update state and return */\n    strm.next_in = _in;\n    strm.next_out = _out;\n    strm.avail_in = (_in < last ? 5 + (last - _in) : 5 - (_in - last));\n    strm.avail_out = (_out < end ? 257 + (end - _out) : 257 - (_out - end));\n    state.hold = hold;\n    state.bits = bits;\n    return;\n  };\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  const MAXBITS = 15;\n  const ENOUGH_LENS$1 = 852;\n  const ENOUGH_DISTS$1 = 592;\n  //const ENOUGH = (ENOUGH_LENS+ENOUGH_DISTS);\n\n  const CODES$1 = 0;\n  const LENS$1 = 1;\n  const DISTS$1 = 2;\n\n  const lbase = new Uint16Array([ /* Length codes 257..285 base */\n    3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31,\n    35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0\n  ]);\n\n  const lext = new Uint8Array([ /* Length codes 257..285 extra */\n    16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18,\n    19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78\n  ]);\n\n  const dbase = new Uint16Array([ /* Distance codes 0..29 base */\n    1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193,\n    257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145,\n    8193, 12289, 16385, 24577, 0, 0\n  ]);\n\n  const dext = new Uint8Array([ /* Distance codes 0..29 extra */\n    16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22,\n    23, 23, 24, 24, 25, 25, 26, 26, 27, 27,\n    28, 28, 29, 29, 64, 64\n  ]);\n\n  const inflate_table = (type, lens, lens_index, codes, table, table_index, work, opts) =>\n  {\n    const bits = opts.bits;\n        //here = opts.here; /* table entry for duplication */\n\n    let len = 0;               /* a code's length in bits */\n    let sym = 0;               /* index of code symbols */\n    let min = 0, max = 0;          /* minimum and maximum code lengths */\n    let root = 0;              /* number of index bits for root table */\n    let curr = 0;              /* number of index bits for current table */\n    let drop = 0;              /* code bits to drop for sub-table */\n    let left = 0;                   /* number of prefix codes available */\n    let used = 0;              /* code entries in table used */\n    let huff = 0;              /* Huffman code */\n    let incr;              /* for incrementing code, index */\n    let fill;              /* index for replicating entries */\n    let low;               /* low bits for current root entry */\n    let mask;              /* mask for low root bits */\n    let next;             /* next available space in table */\n    let base = null;     /* base value table to use */\n  //  let shoextra;    /* extra bits table to use */\n    let match;                  /* use base and extra for symbol >= match */\n    const count = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];    /* number of codes of each length */\n    const offs = new Uint16Array(MAXBITS + 1); //[MAXBITS+1];     /* offsets in table for each length */\n    let extra = null;\n\n    let here_bits, here_op, here_val;\n\n    /*\n     Process a set of code lengths to create a canonical Huffman code.  The\n     code lengths are lens[0..codes-1].  Each length corresponds to the\n     symbols 0..codes-1.  The Huffman code is generated by first sorting the\n     symbols by length from short to long, and retaining the symbol order\n     for codes with equal lengths.  Then the code starts with all zero bits\n     for the first code of the shortest length, and the codes are integer\n     increments for the same length, and zeros are appended as the length\n     increases.  For the deflate format, these bits are stored backwards\n     from their more natural integer increment ordering, and so when the\n     decoding tables are built in the large loop below, the integer codes\n     are incremented backwards.\n\n     This routine assumes, but does not check, that all of the entries in\n     lens[] are in the range 0..MAXBITS.  The caller must assure this.\n     1..MAXBITS is interpreted as that code length.  zero means that that\n     symbol does not occur in this code.\n\n     The codes are sorted by computing a count of codes for each length,\n     creating from that a table of starting indices for each length in the\n     sorted table, and then entering the symbols in order in the sorted\n     table.  The sorted table is work[], with that space being provided by\n     the caller.\n\n     The length counts are used for other purposes as well, i.e. finding\n     the minimum and maximum length codes, determining if there are any\n     codes at all, checking for a valid set of lengths, and looking ahead\n     at length counts to determine sub-table sizes when building the\n     decoding tables.\n     */\n\n    /* accumulate lengths for codes (assumes lens[] all in 0..MAXBITS) */\n    for (len = 0; len <= MAXBITS; len++) {\n      count[len] = 0;\n    }\n    for (sym = 0; sym < codes; sym++) {\n      count[lens[lens_index + sym]]++;\n    }\n\n    /* bound code lengths, force root to be within code lengths */\n    root = bits;\n    for (max = MAXBITS; max >= 1; max--) {\n      if (count[max] !== 0) { break; }\n    }\n    if (root > max) {\n      root = max;\n    }\n    if (max === 0) {                     /* no symbols to code at all */\n      //table.op[opts.table_index] = 64;  //here.op = (var char)64;    /* invalid code marker */\n      //table.bits[opts.table_index] = 1;   //here.bits = (var char)1;\n      //table.val[opts.table_index++] = 0;   //here.val = (var short)0;\n      table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n\n      //table.op[opts.table_index] = 64;\n      //table.bits[opts.table_index] = 1;\n      //table.val[opts.table_index++] = 0;\n      table[table_index++] = (1 << 24) | (64 << 16) | 0;\n\n      opts.bits = 1;\n      return 0;     /* no symbols, but wait for decoding to report error */\n    }\n    for (min = 1; min < max; min++) {\n      if (count[min] !== 0) { break; }\n    }\n    if (root < min) {\n      root = min;\n    }\n\n    /* check for an over-subscribed or incomplete set of lengths */\n    left = 1;\n    for (len = 1; len <= MAXBITS; len++) {\n      left <<= 1;\n      left -= count[len];\n      if (left < 0) {\n        return -1;\n      }        /* over-subscribed */\n    }\n    if (left > 0 && (type === CODES$1 || max !== 1)) {\n      return -1;                      /* incomplete set */\n    }\n\n    /* generate offsets into symbol table for each length for sorting */\n    offs[1] = 0;\n    for (len = 1; len < MAXBITS; len++) {\n      offs[len + 1] = offs[len] + count[len];\n    }\n\n    /* sort symbols by length, by symbol order within each length */\n    for (sym = 0; sym < codes; sym++) {\n      if (lens[lens_index + sym] !== 0) {\n        work[offs[lens[lens_index + sym]]++] = sym;\n      }\n    }\n\n    /*\n     Create and fill in decoding tables.  In this loop, the table being\n     filled is at next and has curr index bits.  The code being used is huff\n     with length len.  That code is converted to an index by dropping drop\n     bits off of the bottom.  For codes where len is less than drop + curr,\n     those top drop + curr - len bits are incremented through all values to\n     fill the table with replicated entries.\n\n     root is the number of index bits for the root table.  When len exceeds\n     root, sub-tables are created pointed to by the root entry with an index\n     of the low root bits of huff.  This is saved in low to check for when a\n     new sub-table should be started.  drop is zero when the root table is\n     being filled, and drop is root when sub-tables are being filled.\n\n     When a new sub-table is needed, it is necessary to look ahead in the\n     code lengths to determine what size sub-table is needed.  The length\n     counts are used for this, and so count[] is decremented as codes are\n     entered in the tables.\n\n     used keeps track of how many table entries have been allocated from the\n     provided *table space.  It is checked for LENS and DIST tables against\n     the constants ENOUGH_LENS and ENOUGH_DISTS to guard against changes in\n     the initial root table size constants.  See the comments in inftrees.h\n     for more information.\n\n     sym increments through all symbols, and the loop terminates when\n     all codes of length max, i.e. all codes, have been processed.  This\n     routine permits incomplete codes, so another loop after this one fills\n     in the rest of the decoding tables with invalid code markers.\n     */\n\n    /* set up for code type */\n    // poor man optimization - use if-else instead of switch,\n    // to avoid deopts in old v8\n    if (type === CODES$1) {\n      base = extra = work;    /* dummy value--not used */\n      match = 20;\n\n    } else if (type === LENS$1) {\n      base = lbase;\n      extra = lext;\n      match = 257;\n\n    } else {                    /* DISTS */\n      base = dbase;\n      extra = dext;\n      match = 0;\n    }\n\n    /* initialize opts for loop */\n    huff = 0;                   /* starting code */\n    sym = 0;                    /* starting code symbol */\n    len = min;                  /* starting code length */\n    next = table_index;              /* current table to fill in */\n    curr = root;                /* current table index bits */\n    drop = 0;                   /* current bits to drop from code for index */\n    low = -1;                   /* trigger new sub-table when len > root */\n    used = 1 << root;          /* use root table entries */\n    mask = used - 1;            /* mask for comparing low */\n\n    /* check available table space */\n    if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n      (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n      return 1;\n    }\n\n    /* process all codes and make table entries */\n    for (;;) {\n      /* create table entry */\n      here_bits = len - drop;\n      if (work[sym] + 1 < match) {\n        here_op = 0;\n        here_val = work[sym];\n      }\n      else if (work[sym] >= match) {\n        here_op = extra[work[sym] - match];\n        here_val = base[work[sym] - match];\n      }\n      else {\n        here_op = 32 + 64;         /* end of block */\n        here_val = 0;\n      }\n\n      /* replicate for those indices with low len bits equal to huff */\n      incr = 1 << (len - drop);\n      fill = 1 << curr;\n      min = fill;                 /* save offset to next table */\n      do {\n        fill -= incr;\n        table[next + (huff >> drop) + fill] = (here_bits << 24) | (here_op << 16) | here_val |0;\n      } while (fill !== 0);\n\n      /* backwards increment the len-bit code huff */\n      incr = 1 << (len - 1);\n      while (huff & incr) {\n        incr >>= 1;\n      }\n      if (incr !== 0) {\n        huff &= incr - 1;\n        huff += incr;\n      } else {\n        huff = 0;\n      }\n\n      /* go to next symbol, update count, len */\n      sym++;\n      if (--count[len] === 0) {\n        if (len === max) { break; }\n        len = lens[lens_index + work[sym]];\n      }\n\n      /* create new sub-table if needed */\n      if (len > root && (huff & mask) !== low) {\n        /* if first time, transition to sub-tables */\n        if (drop === 0) {\n          drop = root;\n        }\n\n        /* increment past last table */\n        next += min;            /* here min is 1 << curr */\n\n        /* determine length of next table */\n        curr = len - drop;\n        left = 1 << curr;\n        while (curr + drop < max) {\n          left -= count[curr + drop];\n          if (left <= 0) { break; }\n          curr++;\n          left <<= 1;\n        }\n\n        /* check for enough space */\n        used += 1 << curr;\n        if ((type === LENS$1 && used > ENOUGH_LENS$1) ||\n          (type === DISTS$1 && used > ENOUGH_DISTS$1)) {\n          return 1;\n        }\n\n        /* point entry in root table to sub-table */\n        low = huff & mask;\n        /*table.op[low] = curr;\n        table.bits[low] = root;\n        table.val[low] = next - opts.table_index;*/\n        table[low] = (root << 24) | (curr << 16) | (next - table_index) |0;\n      }\n    }\n\n    /* fill in remaining table entry if code is incomplete (guaranteed to have\n     at most one remaining entry, since if the code is incomplete, the\n     maximum code length that was allowed to get this far is one bit) */\n    if (huff !== 0) {\n      //table.op[next + huff] = 64;            /* invalid code marker */\n      //table.bits[next + huff] = len - drop;\n      //table.val[next + huff] = 0;\n      table[next + huff] = ((len - drop) << 24) | (64 << 16) |0;\n    }\n\n    /* set return parameters */\n    //opts.table_index += used;\n    opts.bits = root;\n    return 0;\n  };\n\n\n  var inftrees = inflate_table;\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  var constants$1 = {\n\n    /* Allowed flush values; see deflate() and inflate() below for details */\n    Z_NO_FLUSH:         0,\n    Z_PARTIAL_FLUSH:    1,\n    Z_SYNC_FLUSH:       2,\n    Z_FULL_FLUSH:       3,\n    Z_FINISH:           4,\n    Z_BLOCK:            5,\n    Z_TREES:            6,\n\n    /* Return codes for the compression/decompression functions. Negative values\n    * are errors, positive values are used for special but normal events.\n    */\n    Z_OK:               0,\n    Z_STREAM_END:       1,\n    Z_NEED_DICT:        2,\n    Z_ERRNO:           -1,\n    Z_STREAM_ERROR:    -2,\n    Z_DATA_ERROR:      -3,\n    Z_MEM_ERROR:       -4,\n    Z_BUF_ERROR:       -5,\n    //Z_VERSION_ERROR: -6,\n\n    /* compression levels */\n    Z_NO_COMPRESSION:         0,\n    Z_BEST_SPEED:             1,\n    Z_BEST_COMPRESSION:       9,\n    Z_DEFAULT_COMPRESSION:   -1,\n\n\n    Z_FILTERED:               1,\n    Z_HUFFMAN_ONLY:           2,\n    Z_RLE:                    3,\n    Z_FIXED:                  4,\n    Z_DEFAULT_STRATEGY:       0,\n\n    /* Possible values of the data_type field (though see inflate()) */\n    Z_BINARY:                 0,\n    Z_TEXT:                   1,\n    //Z_ASCII:                1, // = Z_TEXT (deprecated)\n    Z_UNKNOWN:                2,\n\n    /* The deflate compression method */\n    Z_DEFLATED:               8\n    //Z_NULL:                 null // Use -1 or null inline, depending on var type\n  };\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n\n\n\n\n\n  const CODES = 0;\n  const LENS = 1;\n  const DISTS = 2;\n\n  /* Public constants ==========================================================*/\n  /* ===========================================================================*/\n\n  const {\n    Z_FINISH: Z_FINISH$1, Z_BLOCK, Z_TREES,\n    Z_OK: Z_OK$1, Z_STREAM_END: Z_STREAM_END$1, Z_NEED_DICT: Z_NEED_DICT$1, Z_STREAM_ERROR: Z_STREAM_ERROR$1, Z_DATA_ERROR: Z_DATA_ERROR$1, Z_MEM_ERROR: Z_MEM_ERROR$1, Z_BUF_ERROR,\n    Z_DEFLATED\n  } = constants$1;\n\n\n  /* STATES ====================================================================*/\n  /* ===========================================================================*/\n\n\n  const    HEAD = 16180;       /* i: waiting for magic header */\n  const    FLAGS = 16181;      /* i: waiting for method and flags (gzip) */\n  const    TIME = 16182;       /* i: waiting for modification time (gzip) */\n  const    OS = 16183;         /* i: waiting for extra flags and operating system (gzip) */\n  const    EXLEN = 16184;      /* i: waiting for extra length (gzip) */\n  const    EXTRA = 16185;      /* i: waiting for extra bytes (gzip) */\n  const    NAME = 16186;       /* i: waiting for end of file name (gzip) */\n  const    COMMENT = 16187;    /* i: waiting for end of comment (gzip) */\n  const    HCRC = 16188;       /* i: waiting for header crc (gzip) */\n  const    DICTID = 16189;    /* i: waiting for dictionary check value */\n  const    DICT = 16190;      /* waiting for inflateSetDictionary() call */\n  const        TYPE = 16191;      /* i: waiting for type bits, including last-flag bit */\n  const        TYPEDO = 16192;    /* i: same, but skip check to exit inflate on new block */\n  const        STORED = 16193;    /* i: waiting for stored size (length and complement) */\n  const        COPY_ = 16194;     /* i/o: same as COPY below, but only first time in */\n  const        COPY = 16195;      /* i/o: waiting for input or output to copy stored block */\n  const        TABLE = 16196;     /* i: waiting for dynamic block table lengths */\n  const        LENLENS = 16197;   /* i: waiting for code length code lengths */\n  const        CODELENS = 16198;  /* i: waiting for length/lit and distance code lengths */\n  const            LEN_ = 16199;      /* i: same as LEN below, but only first time in */\n  const            LEN = 16200;       /* i: waiting for length/lit/eob code */\n  const            LENEXT = 16201;    /* i: waiting for length extra bits */\n  const            DIST = 16202;      /* i: waiting for distance code */\n  const            DISTEXT = 16203;   /* i: waiting for distance extra bits */\n  const            MATCH = 16204;     /* o: waiting for output space to copy string */\n  const            LIT = 16205;       /* o: waiting for output space to write literal */\n  const    CHECK = 16206;     /* i: waiting for 32-bit check value */\n  const    LENGTH = 16207;    /* i: waiting for 32-bit length (gzip) */\n  const    DONE = 16208;      /* finished check, done -- remain here until reset */\n  const    BAD = 16209;       /* got a data error -- remain here until reset */\n  const    MEM = 16210;       /* got an inflate() memory error -- remain here until reset */\n  const    SYNC = 16211;      /* looking for synchronization bytes to restart inflate() */\n\n  /* ===========================================================================*/\n\n\n\n  const ENOUGH_LENS = 852;\n  const ENOUGH_DISTS = 592;\n  //const ENOUGH =  (ENOUGH_LENS+ENOUGH_DISTS);\n\n  const MAX_WBITS = 15;\n  /* 32K LZ77 window */\n  const DEF_WBITS = MAX_WBITS;\n\n\n  const zswap32 = (q) => {\n\n    return  (((q >>> 24) & 0xff) +\n            ((q >>> 8) & 0xff00) +\n            ((q & 0xff00) << 8) +\n            ((q & 0xff) << 24));\n  };\n\n\n  function InflateState() {\n    this.strm = null;           /* pointer back to this zlib stream */\n    this.mode = 0;              /* current inflate mode */\n    this.last = false;          /* true if processing last block */\n    this.wrap = 0;              /* bit 0 true for zlib, bit 1 true for gzip,\n                                   bit 2 true to validate check value */\n    this.havedict = false;      /* true if dictionary provided */\n    this.flags = 0;             /* gzip header method and flags (0 if zlib), or\n                                   -1 if raw or no header yet */\n    this.dmax = 0;              /* zlib header max distance (INFLATE_STRICT) */\n    this.check = 0;             /* protected copy of check value */\n    this.total = 0;             /* protected copy of output count */\n    // TODO: may be {}\n    this.head = null;           /* where to save gzip header information */\n\n    /* sliding window */\n    this.wbits = 0;             /* log base 2 of requested window size */\n    this.wsize = 0;             /* window size or zero if not using window */\n    this.whave = 0;             /* valid bytes in the window */\n    this.wnext = 0;             /* window write index */\n    this.window = null;         /* allocated sliding window, if needed */\n\n    /* bit accumulator */\n    this.hold = 0;              /* input bit accumulator */\n    this.bits = 0;              /* number of bits in \"in\" */\n\n    /* for string and stored block copying */\n    this.length = 0;            /* literal or length of data to copy */\n    this.offset = 0;            /* distance back to copy string from */\n\n    /* for table and code decoding */\n    this.extra = 0;             /* extra bits needed */\n\n    /* fixed and dynamic code tables */\n    this.lencode = null;          /* starting table for length/literal codes */\n    this.distcode = null;         /* starting table for distance codes */\n    this.lenbits = 0;           /* index bits for lencode */\n    this.distbits = 0;          /* index bits for distcode */\n\n    /* dynamic table building */\n    this.ncode = 0;             /* number of code length code lengths */\n    this.nlen = 0;              /* number of length code lengths */\n    this.ndist = 0;             /* number of distance code lengths */\n    this.have = 0;              /* number of code lengths in lens[] */\n    this.next = null;              /* next available space in codes[] */\n\n    this.lens = new Uint16Array(320); /* temporary storage for code lengths */\n    this.work = new Uint16Array(288); /* work area for code table building */\n\n    /*\n     because we don't have pointers in js, we use lencode and distcode directly\n     as buffers so we don't need codes\n    */\n    //this.codes = new Int32Array(ENOUGH);       /* space for code tables */\n    this.lendyn = null;              /* dynamic table for length/literal codes (JS specific) */\n    this.distdyn = null;             /* dynamic table for distance codes (JS specific) */\n    this.sane = 0;                   /* if false, allow invalid distance too far */\n    this.back = 0;                   /* bits back of last unprocessed length/lit */\n    this.was = 0;                    /* initial length of match */\n  }\n\n\n  const inflateStateCheck = (strm) => {\n\n    if (!strm) {\n      return 1;\n    }\n    const state = strm.state;\n    if (!state || state.strm !== strm ||\n      state.mode < HEAD || state.mode > SYNC) {\n      return 1;\n    }\n    return 0;\n  };\n\n\n  const inflateResetKeep = (strm) => {\n\n    if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n    const state = strm.state;\n    strm.total_in = strm.total_out = state.total = 0;\n    strm.msg = ''; /*Z_NULL*/\n    if (state.wrap) {       /* to support ill-conceived Java test suite */\n      strm.adler = state.wrap & 1;\n    }\n    state.mode = HEAD;\n    state.last = 0;\n    state.havedict = 0;\n    state.flags = -1;\n    state.dmax = 32768;\n    state.head = null/*Z_NULL*/;\n    state.hold = 0;\n    state.bits = 0;\n    //state.lencode = state.distcode = state.next = state.codes;\n    state.lencode = state.lendyn = new Int32Array(ENOUGH_LENS);\n    state.distcode = state.distdyn = new Int32Array(ENOUGH_DISTS);\n\n    state.sane = 1;\n    state.back = -1;\n    //Tracev((stderr, \"inflate: reset\\n\"));\n    return Z_OK$1;\n  };\n\n\n  const inflateReset = (strm) => {\n\n    if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n    const state = strm.state;\n    state.wsize = 0;\n    state.whave = 0;\n    state.wnext = 0;\n    return inflateResetKeep(strm);\n\n  };\n\n\n  const inflateReset2 = (strm, windowBits) => {\n    let wrap;\n\n    /* get the state */\n    if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n    const state = strm.state;\n\n    /* extract wrap request from windowBits parameter */\n    if (windowBits < 0) {\n      wrap = 0;\n      windowBits = -windowBits;\n    }\n    else {\n      wrap = (windowBits >> 4) + 5;\n      if (windowBits < 48) {\n        windowBits &= 15;\n      }\n    }\n\n    /* set number of window bits, free window if different */\n    if (windowBits && (windowBits < 8 || windowBits > 15)) {\n      return Z_STREAM_ERROR$1;\n    }\n    if (state.window !== null && state.wbits !== windowBits) {\n      state.window = null;\n    }\n\n    /* update state and reset the rest of it */\n    state.wrap = wrap;\n    state.wbits = windowBits;\n    return inflateReset(strm);\n  };\n\n\n  const inflateInit2 = (strm, windowBits) => {\n\n    if (!strm) { return Z_STREAM_ERROR$1; }\n    //strm.msg = Z_NULL;                 /* in case we return an error */\n\n    const state = new InflateState();\n\n    //if (state === Z_NULL) return Z_MEM_ERROR;\n    //Tracev((stderr, \"inflate: allocated\\n\"));\n    strm.state = state;\n    state.strm = strm;\n    state.window = null/*Z_NULL*/;\n    state.mode = HEAD;     /* to pass state test in inflateReset2() */\n    const ret = inflateReset2(strm, windowBits);\n    if (ret !== Z_OK$1) {\n      strm.state = null/*Z_NULL*/;\n    }\n    return ret;\n  };\n\n\n  const inflateInit = (strm) => {\n\n    return inflateInit2(strm, DEF_WBITS);\n  };\n\n\n  /*\n   Return state with length and distance decoding tables and index sizes set to\n   fixed code decoding.  Normally this returns fixed tables from inffixed.h.\n   If BUILDFIXED is defined, then instead this routine builds the tables the\n   first time it's called, and returns those tables the first time and\n   thereafter.  This reduces the size of the code by about 2K bytes, in\n   exchange for a little execution time.  However, BUILDFIXED should not be\n   used for threaded applications, since the rewriting of the tables and virgin\n   may not be thread-safe.\n   */\n  let virgin = true;\n\n  let lenfix, distfix; // We have no pointers in JS, so keep tables separate\n\n\n  const fixedtables = (state) => {\n\n    /* build fixed huffman tables if first call (may not be thread safe) */\n    if (virgin) {\n      lenfix = new Int32Array(512);\n      distfix = new Int32Array(32);\n\n      /* literal/length table */\n      let sym = 0;\n      while (sym < 144) { state.lens[sym++] = 8; }\n      while (sym < 256) { state.lens[sym++] = 9; }\n      while (sym < 280) { state.lens[sym++] = 7; }\n      while (sym < 288) { state.lens[sym++] = 8; }\n\n      inftrees(LENS,  state.lens, 0, 288, lenfix,   0, state.work, { bits: 9 });\n\n      /* distance table */\n      sym = 0;\n      while (sym < 32) { state.lens[sym++] = 5; }\n\n      inftrees(DISTS, state.lens, 0, 32,   distfix, 0, state.work, { bits: 5 });\n\n      /* do this just once */\n      virgin = false;\n    }\n\n    state.lencode = lenfix;\n    state.lenbits = 9;\n    state.distcode = distfix;\n    state.distbits = 5;\n  };\n\n\n  /*\n   Update the window with the last wsize (normally 32K) bytes written before\n   returning.  If window does not exist yet, create it.  This is only called\n   when a window is already in use, or when output has been written during this\n   inflate call, but the end of the deflate stream has not been reached yet.\n   It is also called to create a window for dictionary data when a dictionary\n   is loaded.\n\n   Providing output buffers larger than 32K to inflate() should provide a speed\n   advantage, since only the last 32K of output is copied to the sliding window\n   upon return from inflate(), and since all distances after the first 32K of\n   output will fall in the output data, making match copies simpler and faster.\n   The advantage may be dependent on the size of the processor's data caches.\n   */\n  const updatewindow = (strm, src, end, copy) => {\n\n    let dist;\n    const state = strm.state;\n\n    /* if it hasn't been done already, allocate space for the window */\n    if (state.window === null) {\n      state.wsize = 1 << state.wbits;\n      state.wnext = 0;\n      state.whave = 0;\n\n      state.window = new Uint8Array(state.wsize);\n    }\n\n    /* copy state->wsize or less output bytes into the circular window */\n    if (copy >= state.wsize) {\n      state.window.set(src.subarray(end - state.wsize, end), 0);\n      state.wnext = 0;\n      state.whave = state.wsize;\n    }\n    else {\n      dist = state.wsize - state.wnext;\n      if (dist > copy) {\n        dist = copy;\n      }\n      //zmemcpy(state->window + state->wnext, end - copy, dist);\n      state.window.set(src.subarray(end - copy, end - copy + dist), state.wnext);\n      copy -= dist;\n      if (copy) {\n        //zmemcpy(state->window, end - copy, copy);\n        state.window.set(src.subarray(end - copy, end), 0);\n        state.wnext = copy;\n        state.whave = state.wsize;\n      }\n      else {\n        state.wnext += dist;\n        if (state.wnext === state.wsize) { state.wnext = 0; }\n        if (state.whave < state.wsize) { state.whave += dist; }\n      }\n    }\n    return 0;\n  };\n\n\n  const inflate$1 = (strm, flush) => {\n\n    let state;\n    let input, output;          // input/output buffers\n    let next;                   /* next input INDEX */\n    let put;                    /* next output INDEX */\n    let have, left;             /* available input and output */\n    let hold;                   /* bit buffer */\n    let bits;                   /* bits in bit buffer */\n    let _in, _out;              /* save starting available input and output */\n    let copy;                   /* number of stored or match bytes to copy */\n    let from;                   /* where to copy match bytes from */\n    let from_source;\n    let here = 0;               /* current decoding table entry */\n    let here_bits, here_op, here_val; // paked \"here\" denormalized (JS specific)\n    //let last;                   /* parent table entry */\n    let last_bits, last_op, last_val; // paked \"last\" denormalized (JS specific)\n    let len;                    /* length to copy for repeats, bits to drop */\n    let ret;                    /* return code */\n    const hbuf = new Uint8Array(4);    /* buffer for gzip header crc calculation */\n    let opts;\n\n    let n; // temporary variable for NEED_BITS\n\n    const order = /* permutation of code lengths */\n      new Uint8Array([ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ]);\n\n\n    if (inflateStateCheck(strm) || !strm.output ||\n        (!strm.input && strm.avail_in !== 0)) {\n      return Z_STREAM_ERROR$1;\n    }\n\n    state = strm.state;\n    if (state.mode === TYPE) { state.mode = TYPEDO; }    /* skip check */\n\n\n    //--- LOAD() ---\n    put = strm.next_out;\n    output = strm.output;\n    left = strm.avail_out;\n    next = strm.next_in;\n    input = strm.input;\n    have = strm.avail_in;\n    hold = state.hold;\n    bits = state.bits;\n    //---\n\n    _in = have;\n    _out = left;\n    ret = Z_OK$1;\n\n    inf_leave: // goto emulation\n    for (;;) {\n      switch (state.mode) {\n        case HEAD:\n          if (state.wrap === 0) {\n            state.mode = TYPEDO;\n            break;\n          }\n          //=== NEEDBITS(16);\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((state.wrap & 2) && hold === 0x8b1f) {  /* gzip header */\n            if (state.wbits === 0) {\n              state.wbits = 15;\n            }\n            state.check = 0/*crc32(0L, Z_NULL, 0)*/;\n            //=== CRC2(state.check, hold);\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 2, 0);\n            //===//\n\n            //=== INITBITS();\n            hold = 0;\n            bits = 0;\n            //===//\n            state.mode = FLAGS;\n            break;\n          }\n          if (state.head) {\n            state.head.done = false;\n          }\n          if (!(state.wrap & 1) ||   /* check if zlib header allowed */\n            (((hold & 0xff)/*BITS(8)*/ << 8) + (hold >> 8)) % 31) {\n            strm.msg = 'incorrect header check';\n            state.mode = BAD;\n            break;\n          }\n          if ((hold & 0x0f)/*BITS(4)*/ !== Z_DEFLATED) {\n            strm.msg = 'unknown compression method';\n            state.mode = BAD;\n            break;\n          }\n          //--- DROPBITS(4) ---//\n          hold >>>= 4;\n          bits -= 4;\n          //---//\n          len = (hold & 0x0f)/*BITS(4)*/ + 8;\n          if (state.wbits === 0) {\n            state.wbits = len;\n          }\n          if (len > 15 || len > state.wbits) {\n            strm.msg = 'invalid window size';\n            state.mode = BAD;\n            break;\n          }\n\n          // !!! pako patch. Force use `options.windowBits` if passed.\n          // Required to always use max window size by default.\n          state.dmax = 1 << state.wbits;\n          //state.dmax = 1 << len;\n\n          state.flags = 0;               /* indicate zlib header */\n          //Tracev((stderr, \"inflate:   zlib header ok\\n\"));\n          strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n          state.mode = hold & 0x200 ? DICTID : TYPE;\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          break;\n        case FLAGS:\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.flags = hold;\n          if ((state.flags & 0xff) !== Z_DEFLATED) {\n            strm.msg = 'unknown compression method';\n            state.mode = BAD;\n            break;\n          }\n          if (state.flags & 0xe000) {\n            strm.msg = 'unknown header flags set';\n            state.mode = BAD;\n            break;\n          }\n          if (state.head) {\n            state.head.text = ((hold >> 8) & 1);\n          }\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            //=== CRC2(state.check, hold);\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 2, 0);\n            //===//\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = TIME;\n          /* falls through */\n        case TIME:\n          //=== NEEDBITS(32); */\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if (state.head) {\n            state.head.time = hold;\n          }\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            //=== CRC4(state.check, hold)\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            hbuf[2] = (hold >>> 16) & 0xff;\n            hbuf[3] = (hold >>> 24) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 4, 0);\n            //===\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = OS;\n          /* falls through */\n        case OS:\n          //=== NEEDBITS(16); */\n          while (bits < 16) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if (state.head) {\n            state.head.xflags = (hold & 0xff);\n            state.head.os = (hold >> 8);\n          }\n          if ((state.flags & 0x0200) && (state.wrap & 4)) {\n            //=== CRC2(state.check, hold);\n            hbuf[0] = hold & 0xff;\n            hbuf[1] = (hold >>> 8) & 0xff;\n            state.check = crc32_1(state.check, hbuf, 2, 0);\n            //===//\n          }\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = EXLEN;\n          /* falls through */\n        case EXLEN:\n          if (state.flags & 0x0400) {\n            //=== NEEDBITS(16); */\n            while (bits < 16) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            state.length = hold;\n            if (state.head) {\n              state.head.extra_len = hold;\n            }\n            if ((state.flags & 0x0200) && (state.wrap & 4)) {\n              //=== CRC2(state.check, hold);\n              hbuf[0] = hold & 0xff;\n              hbuf[1] = (hold >>> 8) & 0xff;\n              state.check = crc32_1(state.check, hbuf, 2, 0);\n              //===//\n            }\n            //=== INITBITS();\n            hold = 0;\n            bits = 0;\n            //===//\n          }\n          else if (state.head) {\n            state.head.extra = null/*Z_NULL*/;\n          }\n          state.mode = EXTRA;\n          /* falls through */\n        case EXTRA:\n          if (state.flags & 0x0400) {\n            copy = state.length;\n            if (copy > have) { copy = have; }\n            if (copy) {\n              if (state.head) {\n                len = state.head.extra_len - state.length;\n                if (!state.head.extra) {\n                  // Use untyped array for more convenient processing later\n                  state.head.extra = new Uint8Array(state.head.extra_len);\n                }\n                state.head.extra.set(\n                  input.subarray(\n                    next,\n                    // extra field is limited to 65536 bytes\n                    // - no need for additional size check\n                    next + copy\n                  ),\n                  /*len + copy > state.head.extra_max - len ? state.head.extra_max : copy,*/\n                  len\n                );\n                //zmemcpy(state.head.extra + len, next,\n                //        len + copy > state.head.extra_max ?\n                //        state.head.extra_max - len : copy);\n              }\n              if ((state.flags & 0x0200) && (state.wrap & 4)) {\n                state.check = crc32_1(state.check, input, copy, next);\n              }\n              have -= copy;\n              next += copy;\n              state.length -= copy;\n            }\n            if (state.length) { break inf_leave; }\n          }\n          state.length = 0;\n          state.mode = NAME;\n          /* falls through */\n        case NAME:\n          if (state.flags & 0x0800) {\n            if (have === 0) { break inf_leave; }\n            copy = 0;\n            do {\n              // TODO: 2 or 1 bytes?\n              len = input[next + copy++];\n              /* use constant limit because in js we should not preallocate memory */\n              if (state.head && len &&\n                  (state.length < 65536 /*state.head.name_max*/)) {\n                state.head.name += String.fromCharCode(len);\n              }\n            } while (len && copy < have);\n\n            if ((state.flags & 0x0200) && (state.wrap & 4)) {\n              state.check = crc32_1(state.check, input, copy, next);\n            }\n            have -= copy;\n            next += copy;\n            if (len) { break inf_leave; }\n          }\n          else if (state.head) {\n            state.head.name = null;\n          }\n          state.length = 0;\n          state.mode = COMMENT;\n          /* falls through */\n        case COMMENT:\n          if (state.flags & 0x1000) {\n            if (have === 0) { break inf_leave; }\n            copy = 0;\n            do {\n              len = input[next + copy++];\n              /* use constant limit because in js we should not preallocate memory */\n              if (state.head && len &&\n                  (state.length < 65536 /*state.head.comm_max*/)) {\n                state.head.comment += String.fromCharCode(len);\n              }\n            } while (len && copy < have);\n            if ((state.flags & 0x0200) && (state.wrap & 4)) {\n              state.check = crc32_1(state.check, input, copy, next);\n            }\n            have -= copy;\n            next += copy;\n            if (len) { break inf_leave; }\n          }\n          else if (state.head) {\n            state.head.comment = null;\n          }\n          state.mode = HCRC;\n          /* falls through */\n        case HCRC:\n          if (state.flags & 0x0200) {\n            //=== NEEDBITS(16); */\n            while (bits < 16) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            if ((state.wrap & 4) && hold !== (state.check & 0xffff)) {\n              strm.msg = 'header crc mismatch';\n              state.mode = BAD;\n              break;\n            }\n            //=== INITBITS();\n            hold = 0;\n            bits = 0;\n            //===//\n          }\n          if (state.head) {\n            state.head.hcrc = ((state.flags >> 9) & 1);\n            state.head.done = true;\n          }\n          strm.adler = state.check = 0;\n          state.mode = TYPE;\n          break;\n        case DICTID:\n          //=== NEEDBITS(32); */\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          strm.adler = state.check = zswap32(hold);\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = DICT;\n          /* falls through */\n        case DICT:\n          if (state.havedict === 0) {\n            //--- RESTORE() ---\n            strm.next_out = put;\n            strm.avail_out = left;\n            strm.next_in = next;\n            strm.avail_in = have;\n            state.hold = hold;\n            state.bits = bits;\n            //---\n            return Z_NEED_DICT$1;\n          }\n          strm.adler = state.check = 1/*adler32(0L, Z_NULL, 0)*/;\n          state.mode = TYPE;\n          /* falls through */\n        case TYPE:\n          if (flush === Z_BLOCK || flush === Z_TREES) { break inf_leave; }\n          /* falls through */\n        case TYPEDO:\n          if (state.last) {\n            //--- BYTEBITS() ---//\n            hold >>>= bits & 7;\n            bits -= bits & 7;\n            //---//\n            state.mode = CHECK;\n            break;\n          }\n          //=== NEEDBITS(3); */\n          while (bits < 3) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.last = (hold & 0x01)/*BITS(1)*/;\n          //--- DROPBITS(1) ---//\n          hold >>>= 1;\n          bits -= 1;\n          //---//\n\n          switch ((hold & 0x03)/*BITS(2)*/) {\n            case 0:                             /* stored block */\n              //Tracev((stderr, \"inflate:     stored block%s\\n\",\n              //        state.last ? \" (last)\" : \"\"));\n              state.mode = STORED;\n              break;\n            case 1:                             /* fixed block */\n              fixedtables(state);\n              //Tracev((stderr, \"inflate:     fixed codes block%s\\n\",\n              //        state.last ? \" (last)\" : \"\"));\n              state.mode = LEN_;             /* decode codes */\n              if (flush === Z_TREES) {\n                //--- DROPBITS(2) ---//\n                hold >>>= 2;\n                bits -= 2;\n                //---//\n                break inf_leave;\n              }\n              break;\n            case 2:                             /* dynamic block */\n              //Tracev((stderr, \"inflate:     dynamic codes block%s\\n\",\n              //        state.last ? \" (last)\" : \"\"));\n              state.mode = TABLE;\n              break;\n            case 3:\n              strm.msg = 'invalid block type';\n              state.mode = BAD;\n          }\n          //--- DROPBITS(2) ---//\n          hold >>>= 2;\n          bits -= 2;\n          //---//\n          break;\n        case STORED:\n          //--- BYTEBITS() ---// /* go to byte boundary */\n          hold >>>= bits & 7;\n          bits -= bits & 7;\n          //---//\n          //=== NEEDBITS(32); */\n          while (bits < 32) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          if ((hold & 0xffff) !== ((hold >>> 16) ^ 0xffff)) {\n            strm.msg = 'invalid stored block lengths';\n            state.mode = BAD;\n            break;\n          }\n          state.length = hold & 0xffff;\n          //Tracev((stderr, \"inflate:       stored length %u\\n\",\n          //        state.length));\n          //=== INITBITS();\n          hold = 0;\n          bits = 0;\n          //===//\n          state.mode = COPY_;\n          if (flush === Z_TREES) { break inf_leave; }\n          /* falls through */\n        case COPY_:\n          state.mode = COPY;\n          /* falls through */\n        case COPY:\n          copy = state.length;\n          if (copy) {\n            if (copy > have) { copy = have; }\n            if (copy > left) { copy = left; }\n            if (copy === 0) { break inf_leave; }\n            //--- zmemcpy(put, next, copy); ---\n            output.set(input.subarray(next, next + copy), put);\n            //---//\n            have -= copy;\n            next += copy;\n            left -= copy;\n            put += copy;\n            state.length -= copy;\n            break;\n          }\n          //Tracev((stderr, \"inflate:       stored end\\n\"));\n          state.mode = TYPE;\n          break;\n        case TABLE:\n          //=== NEEDBITS(14); */\n          while (bits < 14) {\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n          }\n          //===//\n          state.nlen = (hold & 0x1f)/*BITS(5)*/ + 257;\n          //--- DROPBITS(5) ---//\n          hold >>>= 5;\n          bits -= 5;\n          //---//\n          state.ndist = (hold & 0x1f)/*BITS(5)*/ + 1;\n          //--- DROPBITS(5) ---//\n          hold >>>= 5;\n          bits -= 5;\n          //---//\n          state.ncode = (hold & 0x0f)/*BITS(4)*/ + 4;\n          //--- DROPBITS(4) ---//\n          hold >>>= 4;\n          bits -= 4;\n          //---//\n  //#ifndef PKZIP_BUG_WORKAROUND\n          if (state.nlen > 286 || state.ndist > 30) {\n            strm.msg = 'too many length or distance symbols';\n            state.mode = BAD;\n            break;\n          }\n  //#endif\n          //Tracev((stderr, \"inflate:       table sizes ok\\n\"));\n          state.have = 0;\n          state.mode = LENLENS;\n          /* falls through */\n        case LENLENS:\n          while (state.have < state.ncode) {\n            //=== NEEDBITS(3);\n            while (bits < 3) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            state.lens[order[state.have++]] = (hold & 0x07);//BITS(3);\n            //--- DROPBITS(3) ---//\n            hold >>>= 3;\n            bits -= 3;\n            //---//\n          }\n          while (state.have < 19) {\n            state.lens[order[state.have++]] = 0;\n          }\n          // We have separate tables & no pointers. 2 commented lines below not needed.\n          //state.next = state.codes;\n          //state.lencode = state.next;\n          // Switch to use dynamic table\n          state.lencode = state.lendyn;\n          state.lenbits = 7;\n\n          opts = { bits: state.lenbits };\n          ret = inftrees(CODES, state.lens, 0, 19, state.lencode, 0, state.work, opts);\n          state.lenbits = opts.bits;\n\n          if (ret) {\n            strm.msg = 'invalid code lengths set';\n            state.mode = BAD;\n            break;\n          }\n          //Tracev((stderr, \"inflate:       code lengths ok\\n\"));\n          state.have = 0;\n          state.mode = CODELENS;\n          /* falls through */\n        case CODELENS:\n          while (state.have < state.nlen + state.ndist) {\n            for (;;) {\n              here = state.lencode[hold & ((1 << state.lenbits) - 1)];/*BITS(state.lenbits)*/\n              here_bits = here >>> 24;\n              here_op = (here >>> 16) & 0xff;\n              here_val = here & 0xffff;\n\n              if ((here_bits) <= bits) { break; }\n              //--- PULLBYTE() ---//\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n              //---//\n            }\n            if (here_val < 16) {\n              //--- DROPBITS(here.bits) ---//\n              hold >>>= here_bits;\n              bits -= here_bits;\n              //---//\n              state.lens[state.have++] = here_val;\n            }\n            else {\n              if (here_val === 16) {\n                //=== NEEDBITS(here.bits + 2);\n                n = here_bits + 2;\n                while (bits < n) {\n                  if (have === 0) { break inf_leave; }\n                  have--;\n                  hold += input[next++] << bits;\n                  bits += 8;\n                }\n                //===//\n                //--- DROPBITS(here.bits) ---//\n                hold >>>= here_bits;\n                bits -= here_bits;\n                //---//\n                if (state.have === 0) {\n                  strm.msg = 'invalid bit length repeat';\n                  state.mode = BAD;\n                  break;\n                }\n                len = state.lens[state.have - 1];\n                copy = 3 + (hold & 0x03);//BITS(2);\n                //--- DROPBITS(2) ---//\n                hold >>>= 2;\n                bits -= 2;\n                //---//\n              }\n              else if (here_val === 17) {\n                //=== NEEDBITS(here.bits + 3);\n                n = here_bits + 3;\n                while (bits < n) {\n                  if (have === 0) { break inf_leave; }\n                  have--;\n                  hold += input[next++] << bits;\n                  bits += 8;\n                }\n                //===//\n                //--- DROPBITS(here.bits) ---//\n                hold >>>= here_bits;\n                bits -= here_bits;\n                //---//\n                len = 0;\n                copy = 3 + (hold & 0x07);//BITS(3);\n                //--- DROPBITS(3) ---//\n                hold >>>= 3;\n                bits -= 3;\n                //---//\n              }\n              else {\n                //=== NEEDBITS(here.bits + 7);\n                n = here_bits + 7;\n                while (bits < n) {\n                  if (have === 0) { break inf_leave; }\n                  have--;\n                  hold += input[next++] << bits;\n                  bits += 8;\n                }\n                //===//\n                //--- DROPBITS(here.bits) ---//\n                hold >>>= here_bits;\n                bits -= here_bits;\n                //---//\n                len = 0;\n                copy = 11 + (hold & 0x7f);//BITS(7);\n                //--- DROPBITS(7) ---//\n                hold >>>= 7;\n                bits -= 7;\n                //---//\n              }\n              if (state.have + copy > state.nlen + state.ndist) {\n                strm.msg = 'invalid bit length repeat';\n                state.mode = BAD;\n                break;\n              }\n              while (copy--) {\n                state.lens[state.have++] = len;\n              }\n            }\n          }\n\n          /* handle error breaks in while */\n          if (state.mode === BAD) { break; }\n\n          /* check for end-of-block code (better have one) */\n          if (state.lens[256] === 0) {\n            strm.msg = 'invalid code -- missing end-of-block';\n            state.mode = BAD;\n            break;\n          }\n\n          /* build code tables -- note: do not change the lenbits or distbits\n             values here (9 and 6) without reading the comments in inftrees.h\n             concerning the ENOUGH constants, which depend on those values */\n          state.lenbits = 9;\n\n          opts = { bits: state.lenbits };\n          ret = inftrees(LENS, state.lens, 0, state.nlen, state.lencode, 0, state.work, opts);\n          // We have separate tables & no pointers. 2 commented lines below not needed.\n          // state.next_index = opts.table_index;\n          state.lenbits = opts.bits;\n          // state.lencode = state.next;\n\n          if (ret) {\n            strm.msg = 'invalid literal/lengths set';\n            state.mode = BAD;\n            break;\n          }\n\n          state.distbits = 6;\n          //state.distcode.copy(state.codes);\n          // Switch to use dynamic table\n          state.distcode = state.distdyn;\n          opts = { bits: state.distbits };\n          ret = inftrees(DISTS, state.lens, state.nlen, state.ndist, state.distcode, 0, state.work, opts);\n          // We have separate tables & no pointers. 2 commented lines below not needed.\n          // state.next_index = opts.table_index;\n          state.distbits = opts.bits;\n          // state.distcode = state.next;\n\n          if (ret) {\n            strm.msg = 'invalid distances set';\n            state.mode = BAD;\n            break;\n          }\n          //Tracev((stderr, 'inflate:       codes ok\\n'));\n          state.mode = LEN_;\n          if (flush === Z_TREES) { break inf_leave; }\n          /* falls through */\n        case LEN_:\n          state.mode = LEN;\n          /* falls through */\n        case LEN:\n          if (have >= 6 && left >= 258) {\n            //--- RESTORE() ---\n            strm.next_out = put;\n            strm.avail_out = left;\n            strm.next_in = next;\n            strm.avail_in = have;\n            state.hold = hold;\n            state.bits = bits;\n            //---\n            inffast(strm, _out);\n            //--- LOAD() ---\n            put = strm.next_out;\n            output = strm.output;\n            left = strm.avail_out;\n            next = strm.next_in;\n            input = strm.input;\n            have = strm.avail_in;\n            hold = state.hold;\n            bits = state.bits;\n            //---\n\n            if (state.mode === TYPE) {\n              state.back = -1;\n            }\n            break;\n          }\n          state.back = 0;\n          for (;;) {\n            here = state.lencode[hold & ((1 << state.lenbits) - 1)];  /*BITS(state.lenbits)*/\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if (here_bits <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          if (here_op && (here_op & 0xf0) === 0) {\n            last_bits = here_bits;\n            last_op = here_op;\n            last_val = here_val;\n            for (;;) {\n              here = state.lencode[last_val +\n                      ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n              here_bits = here >>> 24;\n              here_op = (here >>> 16) & 0xff;\n              here_val = here & 0xffff;\n\n              if ((last_bits + here_bits) <= bits) { break; }\n              //--- PULLBYTE() ---//\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n              //---//\n            }\n            //--- DROPBITS(last.bits) ---//\n            hold >>>= last_bits;\n            bits -= last_bits;\n            //---//\n            state.back += last_bits;\n          }\n          //--- DROPBITS(here.bits) ---//\n          hold >>>= here_bits;\n          bits -= here_bits;\n          //---//\n          state.back += here_bits;\n          state.length = here_val;\n          if (here_op === 0) {\n            //Tracevv((stderr, here.val >= 0x20 && here.val < 0x7f ?\n            //        \"inflate:         literal '%c'\\n\" :\n            //        \"inflate:         literal 0x%02x\\n\", here.val));\n            state.mode = LIT;\n            break;\n          }\n          if (here_op & 32) {\n            //Tracevv((stderr, \"inflate:         end of block\\n\"));\n            state.back = -1;\n            state.mode = TYPE;\n            break;\n          }\n          if (here_op & 64) {\n            strm.msg = 'invalid literal/length code';\n            state.mode = BAD;\n            break;\n          }\n          state.extra = here_op & 15;\n          state.mode = LENEXT;\n          /* falls through */\n        case LENEXT:\n          if (state.extra) {\n            //=== NEEDBITS(state.extra);\n            n = state.extra;\n            while (bits < n) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            state.length += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n            //--- DROPBITS(state.extra) ---//\n            hold >>>= state.extra;\n            bits -= state.extra;\n            //---//\n            state.back += state.extra;\n          }\n          //Tracevv((stderr, \"inflate:         length %u\\n\", state.length));\n          state.was = state.length;\n          state.mode = DIST;\n          /* falls through */\n        case DIST:\n          for (;;) {\n            here = state.distcode[hold & ((1 << state.distbits) - 1)];/*BITS(state.distbits)*/\n            here_bits = here >>> 24;\n            here_op = (here >>> 16) & 0xff;\n            here_val = here & 0xffff;\n\n            if ((here_bits) <= bits) { break; }\n            //--- PULLBYTE() ---//\n            if (have === 0) { break inf_leave; }\n            have--;\n            hold += input[next++] << bits;\n            bits += 8;\n            //---//\n          }\n          if ((here_op & 0xf0) === 0) {\n            last_bits = here_bits;\n            last_op = here_op;\n            last_val = here_val;\n            for (;;) {\n              here = state.distcode[last_val +\n                      ((hold & ((1 << (last_bits + last_op)) - 1))/*BITS(last.bits + last.op)*/ >> last_bits)];\n              here_bits = here >>> 24;\n              here_op = (here >>> 16) & 0xff;\n              here_val = here & 0xffff;\n\n              if ((last_bits + here_bits) <= bits) { break; }\n              //--- PULLBYTE() ---//\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n              //---//\n            }\n            //--- DROPBITS(last.bits) ---//\n            hold >>>= last_bits;\n            bits -= last_bits;\n            //---//\n            state.back += last_bits;\n          }\n          //--- DROPBITS(here.bits) ---//\n          hold >>>= here_bits;\n          bits -= here_bits;\n          //---//\n          state.back += here_bits;\n          if (here_op & 64) {\n            strm.msg = 'invalid distance code';\n            state.mode = BAD;\n            break;\n          }\n          state.offset = here_val;\n          state.extra = (here_op) & 15;\n          state.mode = DISTEXT;\n          /* falls through */\n        case DISTEXT:\n          if (state.extra) {\n            //=== NEEDBITS(state.extra);\n            n = state.extra;\n            while (bits < n) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            state.offset += hold & ((1 << state.extra) - 1)/*BITS(state.extra)*/;\n            //--- DROPBITS(state.extra) ---//\n            hold >>>= state.extra;\n            bits -= state.extra;\n            //---//\n            state.back += state.extra;\n          }\n  //#ifdef INFLATE_STRICT\n          if (state.offset > state.dmax) {\n            strm.msg = 'invalid distance too far back';\n            state.mode = BAD;\n            break;\n          }\n  //#endif\n          //Tracevv((stderr, \"inflate:         distance %u\\n\", state.offset));\n          state.mode = MATCH;\n          /* falls through */\n        case MATCH:\n          if (left === 0) { break inf_leave; }\n          copy = _out - left;\n          if (state.offset > copy) {         /* copy from window */\n            copy = state.offset - copy;\n            if (copy > state.whave) {\n              if (state.sane) {\n                strm.msg = 'invalid distance too far back';\n                state.mode = BAD;\n                break;\n              }\n  // (!) This block is disabled in zlib defaults,\n  // don't enable it for binary compatibility\n  //#ifdef INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR\n  //          Trace((stderr, \"inflate.c too far\\n\"));\n  //          copy -= state.whave;\n  //          if (copy > state.length) { copy = state.length; }\n  //          if (copy > left) { copy = left; }\n  //          left -= copy;\n  //          state.length -= copy;\n  //          do {\n  //            output[put++] = 0;\n  //          } while (--copy);\n  //          if (state.length === 0) { state.mode = LEN; }\n  //          break;\n  //#endif\n            }\n            if (copy > state.wnext) {\n              copy -= state.wnext;\n              from = state.wsize - copy;\n            }\n            else {\n              from = state.wnext - copy;\n            }\n            if (copy > state.length) { copy = state.length; }\n            from_source = state.window;\n          }\n          else {                              /* copy from output */\n            from_source = output;\n            from = put - state.offset;\n            copy = state.length;\n          }\n          if (copy > left) { copy = left; }\n          left -= copy;\n          state.length -= copy;\n          do {\n            output[put++] = from_source[from++];\n          } while (--copy);\n          if (state.length === 0) { state.mode = LEN; }\n          break;\n        case LIT:\n          if (left === 0) { break inf_leave; }\n          output[put++] = state.length;\n          left--;\n          state.mode = LEN;\n          break;\n        case CHECK:\n          if (state.wrap) {\n            //=== NEEDBITS(32);\n            while (bits < 32) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              // Use '|' instead of '+' to make sure that result is signed\n              hold |= input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            _out -= left;\n            strm.total_out += _out;\n            state.total += _out;\n            if ((state.wrap & 4) && _out) {\n              strm.adler = state.check =\n                  /*UPDATE_CHECK(state.check, put - _out, _out);*/\n                  (state.flags ? crc32_1(state.check, output, _out, put - _out) : adler32_1(state.check, output, _out, put - _out));\n\n            }\n            _out = left;\n            // NB: crc32 stored as signed 32-bit int, zswap32 returns signed too\n            if ((state.wrap & 4) && (state.flags ? hold : zswap32(hold)) !== state.check) {\n              strm.msg = 'incorrect data check';\n              state.mode = BAD;\n              break;\n            }\n            //=== INITBITS();\n            hold = 0;\n            bits = 0;\n            //===//\n            //Tracev((stderr, \"inflate:   check matches trailer\\n\"));\n          }\n          state.mode = LENGTH;\n          /* falls through */\n        case LENGTH:\n          if (state.wrap && state.flags) {\n            //=== NEEDBITS(32);\n            while (bits < 32) {\n              if (have === 0) { break inf_leave; }\n              have--;\n              hold += input[next++] << bits;\n              bits += 8;\n            }\n            //===//\n            if ((state.wrap & 4) && hold !== (state.total & 0xffffffff)) {\n              strm.msg = 'incorrect length check';\n              state.mode = BAD;\n              break;\n            }\n            //=== INITBITS();\n            hold = 0;\n            bits = 0;\n            //===//\n            //Tracev((stderr, \"inflate:   length matches trailer\\n\"));\n          }\n          state.mode = DONE;\n          /* falls through */\n        case DONE:\n          ret = Z_STREAM_END$1;\n          break inf_leave;\n        case BAD:\n          ret = Z_DATA_ERROR$1;\n          break inf_leave;\n        case MEM:\n          return Z_MEM_ERROR$1;\n        case SYNC:\n          /* falls through */\n        default:\n          return Z_STREAM_ERROR$1;\n      }\n    }\n\n    // inf_leave <- here is real place for \"goto inf_leave\", emulated via \"break inf_leave\"\n\n    /*\n       Return from inflate(), updating the total counts and the check value.\n       If there was no progress during the inflate() call, return a buffer\n       error.  Call updatewindow() to create and/or update the window state.\n       Note: a memory error from inflate() is non-recoverable.\n     */\n\n    //--- RESTORE() ---\n    strm.next_out = put;\n    strm.avail_out = left;\n    strm.next_in = next;\n    strm.avail_in = have;\n    state.hold = hold;\n    state.bits = bits;\n    //---\n\n    if (state.wsize || (_out !== strm.avail_out && state.mode < BAD &&\n                        (state.mode < CHECK || flush !== Z_FINISH$1))) {\n      if (updatewindow(strm, strm.output, strm.next_out, _out - strm.avail_out)) ;\n    }\n    _in -= strm.avail_in;\n    _out -= strm.avail_out;\n    strm.total_in += _in;\n    strm.total_out += _out;\n    state.total += _out;\n    if ((state.wrap & 4) && _out) {\n      strm.adler = state.check = /*UPDATE_CHECK(state.check, strm.next_out - _out, _out);*/\n        (state.flags ? crc32_1(state.check, output, _out, strm.next_out - _out) : adler32_1(state.check, output, _out, strm.next_out - _out));\n    }\n    strm.data_type = state.bits + (state.last ? 64 : 0) +\n                      (state.mode === TYPE ? 128 : 0) +\n                      (state.mode === LEN_ || state.mode === COPY_ ? 256 : 0);\n    if (((_in === 0 && _out === 0) || flush === Z_FINISH$1) && ret === Z_OK$1) {\n      ret = Z_BUF_ERROR;\n    }\n    return ret;\n  };\n\n\n  const inflateEnd = (strm) => {\n\n    if (inflateStateCheck(strm)) {\n      return Z_STREAM_ERROR$1;\n    }\n\n    let state = strm.state;\n    if (state.window) {\n      state.window = null;\n    }\n    strm.state = null;\n    return Z_OK$1;\n  };\n\n\n  const inflateGetHeader = (strm, head) => {\n\n    /* check state */\n    if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n    const state = strm.state;\n    if ((state.wrap & 2) === 0) { return Z_STREAM_ERROR$1; }\n\n    /* save header structure */\n    state.head = head;\n    head.done = false;\n    return Z_OK$1;\n  };\n\n\n  const inflateSetDictionary = (strm, dictionary) => {\n    const dictLength = dictionary.length;\n\n    let state;\n    let dictid;\n    let ret;\n\n    /* check state */\n    if (inflateStateCheck(strm)) { return Z_STREAM_ERROR$1; }\n    state = strm.state;\n\n    if (state.wrap !== 0 && state.mode !== DICT) {\n      return Z_STREAM_ERROR$1;\n    }\n\n    /* check for correct dictionary identifier */\n    if (state.mode === DICT) {\n      dictid = 1; /* adler32(0, null, 0)*/\n      /* dictid = adler32(dictid, dictionary, dictLength); */\n      dictid = adler32_1(dictid, dictionary, dictLength, 0);\n      if (dictid !== state.check) {\n        return Z_DATA_ERROR$1;\n      }\n    }\n    /* copy dictionary to window using updatewindow(), which will amend the\n     existing dictionary if appropriate */\n    ret = updatewindow(strm, dictionary, dictLength, dictLength);\n    if (ret) {\n      state.mode = MEM;\n      return Z_MEM_ERROR$1;\n    }\n    state.havedict = 1;\n    // Tracev((stderr, \"inflate:   dictionary set\\n\"));\n    return Z_OK$1;\n  };\n\n\n  var inflateReset_1 = inflateReset;\n  var inflateReset2_1 = inflateReset2;\n  var inflateResetKeep_1 = inflateResetKeep;\n  var inflateInit_1 = inflateInit;\n  var inflateInit2_1 = inflateInit2;\n  var inflate_2$1 = inflate$1;\n  var inflateEnd_1 = inflateEnd;\n  var inflateGetHeader_1 = inflateGetHeader;\n  var inflateSetDictionary_1 = inflateSetDictionary;\n  var inflateInfo = 'pako inflate (from Nodeca project)';\n\n  /* Not implemented\n  module.exports.inflateCodesUsed = inflateCodesUsed;\n  module.exports.inflateCopy = inflateCopy;\n  module.exports.inflateGetDictionary = inflateGetDictionary;\n  module.exports.inflateMark = inflateMark;\n  module.exports.inflatePrime = inflatePrime;\n  module.exports.inflateSync = inflateSync;\n  module.exports.inflateSyncPoint = inflateSyncPoint;\n  module.exports.inflateUndermine = inflateUndermine;\n  module.exports.inflateValidate = inflateValidate;\n  */\n\n  var inflate_1$1 = {\n  \tinflateReset: inflateReset_1,\n  \tinflateReset2: inflateReset2_1,\n  \tinflateResetKeep: inflateResetKeep_1,\n  \tinflateInit: inflateInit_1,\n  \tinflateInit2: inflateInit2_1,\n  \tinflate: inflate_2$1,\n  \tinflateEnd: inflateEnd_1,\n  \tinflateGetHeader: inflateGetHeader_1,\n  \tinflateSetDictionary: inflateSetDictionary_1,\n  \tinflateInfo: inflateInfo\n  };\n\n  const _has = (obj, key) => {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n  };\n\n  var assign = function (obj /*from1, from2, from3, ...*/) {\n    const sources = Array.prototype.slice.call(arguments, 1);\n    while (sources.length) {\n      const source = sources.shift();\n      if (!source) { continue; }\n\n      if (typeof source !== 'object') {\n        throw new TypeError(source + 'must be non-object');\n      }\n\n      for (const p in source) {\n        if (_has(source, p)) {\n          obj[p] = source[p];\n        }\n      }\n    }\n\n    return obj;\n  };\n\n\n  // Join array of chunks to single array.\n  var flattenChunks = (chunks) => {\n    // calculate data length\n    let len = 0;\n\n    for (let i = 0, l = chunks.length; i < l; i++) {\n      len += chunks[i].length;\n    }\n\n    // join chunks\n    const result = new Uint8Array(len);\n\n    for (let i = 0, pos = 0, l = chunks.length; i < l; i++) {\n      let chunk = chunks[i];\n      result.set(chunk, pos);\n      pos += chunk.length;\n    }\n\n    return result;\n  };\n\n  var common = {\n  \tassign: assign,\n  \tflattenChunks: flattenChunks\n  };\n\n  // String encode/decode helpers\n\n\n  // Quick check if we can use fast array to bin string conversion\n  //\n  // - apply(Array) can fail on Android 2.2\n  // - apply(Uint8Array) can fail on iOS 5.1 Safari\n  //\n  let STR_APPLY_UIA_OK = true;\n\n  try { String.fromCharCode.apply(null, new Uint8Array(1)); } catch (__) { STR_APPLY_UIA_OK = false; }\n\n\n  // Table with utf8 lengths (calculated by first byte of sequence)\n  // Note, that 5 & 6-byte values and some 4-byte values can not be represented in JS,\n  // because max possible codepoint is 0x10ffff\n  const _utf8len = new Uint8Array(256);\n  for (let q = 0; q < 256; q++) {\n    _utf8len[q] = (q >= 252 ? 6 : q >= 248 ? 5 : q >= 240 ? 4 : q >= 224 ? 3 : q >= 192 ? 2 : 1);\n  }\n  _utf8len[254] = _utf8len[254] = 1; // Invalid sequence start\n\n\n  // convert string to array (typed, when possible)\n  var string2buf = (str) => {\n    if (typeof TextEncoder === 'function' && TextEncoder.prototype.encode) {\n      return new TextEncoder().encode(str);\n    }\n\n    let buf, c, c2, m_pos, i, str_len = str.length, buf_len = 0;\n\n    // count binary size\n    for (m_pos = 0; m_pos < str_len; m_pos++) {\n      c = str.charCodeAt(m_pos);\n      if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n        c2 = str.charCodeAt(m_pos + 1);\n        if ((c2 & 0xfc00) === 0xdc00) {\n          c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n          m_pos++;\n        }\n      }\n      buf_len += c < 0x80 ? 1 : c < 0x800 ? 2 : c < 0x10000 ? 3 : 4;\n    }\n\n    // allocate buffer\n    buf = new Uint8Array(buf_len);\n\n    // convert\n    for (i = 0, m_pos = 0; i < buf_len; m_pos++) {\n      c = str.charCodeAt(m_pos);\n      if ((c & 0xfc00) === 0xd800 && (m_pos + 1 < str_len)) {\n        c2 = str.charCodeAt(m_pos + 1);\n        if ((c2 & 0xfc00) === 0xdc00) {\n          c = 0x10000 + ((c - 0xd800) << 10) + (c2 - 0xdc00);\n          m_pos++;\n        }\n      }\n      if (c < 0x80) {\n        /* one byte */\n        buf[i++] = c;\n      } else if (c < 0x800) {\n        /* two bytes */\n        buf[i++] = 0xC0 | (c >>> 6);\n        buf[i++] = 0x80 | (c & 0x3f);\n      } else if (c < 0x10000) {\n        /* three bytes */\n        buf[i++] = 0xE0 | (c >>> 12);\n        buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n        buf[i++] = 0x80 | (c & 0x3f);\n      } else {\n        /* four bytes */\n        buf[i++] = 0xf0 | (c >>> 18);\n        buf[i++] = 0x80 | (c >>> 12 & 0x3f);\n        buf[i++] = 0x80 | (c >>> 6 & 0x3f);\n        buf[i++] = 0x80 | (c & 0x3f);\n      }\n    }\n\n    return buf;\n  };\n\n  // Helper\n  const buf2binstring = (buf, len) => {\n    // On Chrome, the arguments in a function call that are allowed is `65534`.\n    // If the length of the buffer is smaller than that, we can use this optimization,\n    // otherwise we will take a slower path.\n    if (len < 65534) {\n      if (buf.subarray && STR_APPLY_UIA_OK) {\n        return String.fromCharCode.apply(null, buf.length === len ? buf : buf.subarray(0, len));\n      }\n    }\n\n    let result = '';\n    for (let i = 0; i < len; i++) {\n      result += String.fromCharCode(buf[i]);\n    }\n    return result;\n  };\n\n\n  // convert array to string\n  var buf2string = (buf, max) => {\n    const len = max || buf.length;\n\n    if (typeof TextDecoder === 'function' && TextDecoder.prototype.decode) {\n      return new TextDecoder().decode(buf.subarray(0, max));\n    }\n\n    let i, out;\n\n    // Reserve max possible length (2 words per char)\n    // NB: by unknown reasons, Array is significantly faster for\n    //     String.fromCharCode.apply than Uint16Array.\n    const utf16buf = new Array(len * 2);\n\n    for (out = 0, i = 0; i < len;) {\n      let c = buf[i++];\n      // quick process ascii\n      if (c < 0x80) { utf16buf[out++] = c; continue; }\n\n      let c_len = _utf8len[c];\n      // skip 5 & 6 byte codes\n      if (c_len > 4) { utf16buf[out++] = 0xfffd; i += c_len - 1; continue; }\n\n      // apply mask on first byte\n      c &= c_len === 2 ? 0x1f : c_len === 3 ? 0x0f : 0x07;\n      // join the rest\n      while (c_len > 1 && i < len) {\n        c = (c << 6) | (buf[i++] & 0x3f);\n        c_len--;\n      }\n\n      // terminated by end of string?\n      if (c_len > 1) { utf16buf[out++] = 0xfffd; continue; }\n\n      if (c < 0x10000) {\n        utf16buf[out++] = c;\n      } else {\n        c -= 0x10000;\n        utf16buf[out++] = 0xd800 | ((c >> 10) & 0x3ff);\n        utf16buf[out++] = 0xdc00 | (c & 0x3ff);\n      }\n    }\n\n    return buf2binstring(utf16buf, out);\n  };\n\n\n  // Calculate max possible position in utf8 buffer,\n  // that will not break sequence. If that's not possible\n  // - (very small limits) return max size as is.\n  //\n  // buf[] - utf8 bytes array\n  // max   - length limit (mandatory);\n  var utf8border = (buf, max) => {\n\n    max = max || buf.length;\n    if (max > buf.length) { max = buf.length; }\n\n    // go back from last position, until start of sequence found\n    let pos = max - 1;\n    while (pos >= 0 && (buf[pos] & 0xC0) === 0x80) { pos--; }\n\n    // Very small and broken sequence,\n    // return max, because we should return something anyway.\n    if (pos < 0) { return max; }\n\n    // If we came to start of buffer - that means buffer is too small,\n    // return max too.\n    if (pos === 0) { return max; }\n\n    return (pos + _utf8len[buf[pos]] > max) ? pos : max;\n  };\n\n  var strings = {\n  \tstring2buf: string2buf,\n  \tbuf2string: buf2string,\n  \tutf8border: utf8border\n  };\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  var messages = {\n    2:      'need dictionary',     /* Z_NEED_DICT       2  */\n    1:      'stream end',          /* Z_STREAM_END      1  */\n    0:      '',                    /* Z_OK              0  */\n    '-1':   'file error',          /* Z_ERRNO         (-1) */\n    '-2':   'stream error',        /* Z_STREAM_ERROR  (-2) */\n    '-3':   'data error',          /* Z_DATA_ERROR    (-3) */\n    '-4':   'insufficient memory', /* Z_MEM_ERROR     (-4) */\n    '-5':   'buffer error',        /* Z_BUF_ERROR     (-5) */\n    '-6':   'incompatible version' /* Z_VERSION_ERROR (-6) */\n  };\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  function ZStream() {\n    /* next input byte */\n    this.input = null; // JS specific, because we have no pointers\n    this.next_in = 0;\n    /* number of bytes available at input */\n    this.avail_in = 0;\n    /* total number of input bytes read so far */\n    this.total_in = 0;\n    /* next output byte should be put there */\n    this.output = null; // JS specific, because we have no pointers\n    this.next_out = 0;\n    /* remaining free space at output */\n    this.avail_out = 0;\n    /* total number of bytes output so far */\n    this.total_out = 0;\n    /* last error message, NULL if no error */\n    this.msg = ''/*Z_NULL*/;\n    /* not visible by applications */\n    this.state = null;\n    /* best guess about the data type: binary or text */\n    this.data_type = 2/*Z_UNKNOWN*/;\n    /* adler32 value of the uncompressed data */\n    this.adler = 0;\n  }\n\n  var zstream = ZStream;\n\n  // (C) 1995-2013 Jean-loup Gailly and Mark Adler\n  // (C) 2014-2017 Vitaly Puzrin and Andrey Tupitsin\n  //\n  // This software is provided 'as-is', without any express or implied\n  // warranty. In no event will the authors be held liable for any damages\n  // arising from the use of this software.\n  //\n  // Permission is granted to anyone to use this software for any purpose,\n  // including commercial applications, and to alter it and redistribute it\n  // freely, subject to the following restrictions:\n  //\n  // 1. The origin of this software must not be misrepresented; you must not\n  //   claim that you wrote the original software. If you use this software\n  //   in a product, an acknowledgment in the product documentation would be\n  //   appreciated but is not required.\n  // 2. Altered source versions must be plainly marked as such, and must not be\n  //   misrepresented as being the original software.\n  // 3. This notice may not be removed or altered from any source distribution.\n\n  function GZheader() {\n    /* true if compressed data believed to be text */\n    this.text       = 0;\n    /* modification time */\n    this.time       = 0;\n    /* extra flags (not used when writing a gzip file) */\n    this.xflags     = 0;\n    /* operating system */\n    this.os         = 0;\n    /* pointer to extra field or Z_NULL if none */\n    this.extra      = null;\n    /* extra field length (valid if extra != Z_NULL) */\n    this.extra_len  = 0; // Actually, we don't need it in JS,\n                         // but leave for few code modifications\n\n    //\n    // Setup limits is not necessary because in js we should not preallocate memory\n    // for inflate use constant limit in 65536 bytes\n    //\n\n    /* space at extra (only when reading header) */\n    // this.extra_max  = 0;\n    /* pointer to zero-terminated file name or Z_NULL */\n    this.name       = '';\n    /* space at name (only when reading header) */\n    // this.name_max   = 0;\n    /* pointer to zero-terminated comment or Z_NULL */\n    this.comment    = '';\n    /* space at comment (only when reading header) */\n    // this.comm_max   = 0;\n    /* true if there was or will be a header crc */\n    this.hcrc       = 0;\n    /* true when done reading gzip header (not used when writing a gzip file) */\n    this.done       = false;\n  }\n\n  var gzheader = GZheader;\n\n  const toString = Object.prototype.toString;\n\n  /* Public constants ==========================================================*/\n  /* ===========================================================================*/\n\n  const {\n    Z_NO_FLUSH, Z_FINISH,\n    Z_OK, Z_STREAM_END, Z_NEED_DICT, Z_STREAM_ERROR, Z_DATA_ERROR, Z_MEM_ERROR\n  } = constants$1;\n\n  /* ===========================================================================*/\n\n\n  /**\n   * class Inflate\n   *\n   * Generic JS-style wrapper for zlib calls. If you don't need\n   * streaming behaviour - use more simple functions: [[inflate]]\n   * and [[inflateRaw]].\n   **/\n\n  /* internal\n   * inflate.chunks -> Array\n   *\n   * Chunks of output data, if [[Inflate#onData]] not overridden.\n   **/\n\n  /**\n   * Inflate.result -> Uint8Array|String\n   *\n   * Uncompressed result, generated by default [[Inflate#onData]]\n   * and [[Inflate#onEnd]] handlers. Filled after you push last chunk\n   * (call [[Inflate#push]] with `Z_FINISH` / `true` param).\n   **/\n\n  /**\n   * Inflate.err -> Number\n   *\n   * Error code after inflate finished. 0 (Z_OK) on success.\n   * Should be checked if broken data possible.\n   **/\n\n  /**\n   * Inflate.msg -> String\n   *\n   * Error message, if [[Inflate.err]] != 0\n   **/\n\n\n  /**\n   * new Inflate(options)\n   * - options (Object): zlib inflate options.\n   *\n   * Creates new inflator instance with specified params. Throws exception\n   * on bad params. Supported options:\n   *\n   * - `windowBits`\n   * - `dictionary`\n   *\n   * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n   * for more information on these.\n   *\n   * Additional options, for internal needs:\n   *\n   * - `chunkSize` - size of generated data chunks (16K by default)\n   * - `raw` (Boolean) - do raw inflate\n   * - `to` (String) - if equal to 'string', then result will be converted\n   *   from utf8 to utf16 (javascript) string. When string output requested,\n   *   chunk length can differ from `chunkSize`, depending on content.\n   *\n   * By default, when no options set, autodetect deflate/gzip data format via\n   * wrapper header.\n   *\n   * ##### Example:\n   *\n   * ```javascript\n   * const pako = require('pako')\n   * const chunk1 = new Uint8Array([1,2,3,4,5,6,7,8,9])\n   * const chunk2 = new Uint8Array([10,11,12,13,14,15,16,17,18,19]);\n   *\n   * const inflate = new pako.Inflate({ level: 3});\n   *\n   * inflate.push(chunk1, false);\n   * inflate.push(chunk2, true);  // true -> last chunk\n   *\n   * if (inflate.err) { throw new Error(inflate.err); }\n   *\n   * console.log(inflate.result);\n   * ```\n   **/\n  function Inflate(options) {\n    this.options = common.assign({\n      chunkSize: 1024 * 64,\n      windowBits: 15,\n      to: ''\n    }, options || {});\n\n    const opt = this.options;\n\n    // Force window size for `raw` data, if not set directly,\n    // because we have no header for autodetect.\n    if (opt.raw && (opt.windowBits >= 0) && (opt.windowBits < 16)) {\n      opt.windowBits = -opt.windowBits;\n      if (opt.windowBits === 0) { opt.windowBits = -15; }\n    }\n\n    // If `windowBits` not defined (and mode not raw) - set autodetect flag for gzip/deflate\n    if ((opt.windowBits >= 0) && (opt.windowBits < 16) &&\n        !(options && options.windowBits)) {\n      opt.windowBits += 32;\n    }\n\n    // Gzip header has no info about windows size, we can do autodetect only\n    // for deflate. So, if window size not set, force it to max when gzip possible\n    if ((opt.windowBits > 15) && (opt.windowBits < 48)) {\n      // bit 3 (16) -> gzipped data\n      // bit 4 (32) -> autodetect gzip/deflate\n      if ((opt.windowBits & 15) === 0) {\n        opt.windowBits |= 15;\n      }\n    }\n\n    this.err    = 0;      // error code, if happens (0 = Z_OK)\n    this.msg    = '';     // error message\n    this.ended  = false;  // used to avoid multiple onEnd() calls\n    this.chunks = [];     // chunks of compressed data\n\n    this.strm   = new zstream();\n    this.strm.avail_out = 0;\n\n    let status  = inflate_1$1.inflateInit2(\n      this.strm,\n      opt.windowBits\n    );\n\n    if (status !== Z_OK) {\n      throw new Error(messages[status]);\n    }\n\n    this.header = new gzheader();\n\n    inflate_1$1.inflateGetHeader(this.strm, this.header);\n\n    // Setup dictionary\n    if (opt.dictionary) {\n      // Convert data if needed\n      if (typeof opt.dictionary === 'string') {\n        opt.dictionary = strings.string2buf(opt.dictionary);\n      } else if (toString.call(opt.dictionary) === '[object ArrayBuffer]') {\n        opt.dictionary = new Uint8Array(opt.dictionary);\n      }\n      if (opt.raw) { //In raw mode we need to set the dictionary early\n        status = inflate_1$1.inflateSetDictionary(this.strm, opt.dictionary);\n        if (status !== Z_OK) {\n          throw new Error(messages[status]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Inflate#push(data[, flush_mode]) -> Boolean\n   * - data (Uint8Array|ArrayBuffer): input data\n   * - flush_mode (Number|Boolean): 0..6 for corresponding Z_NO_FLUSH..Z_TREE\n   *   flush modes. See constants. Skipped or `false` means Z_NO_FLUSH,\n   *   `true` means Z_FINISH.\n   *\n   * Sends input data to inflate pipe, generating [[Inflate#onData]] calls with\n   * new output chunks. Returns `true` on success. If end of stream detected,\n   * [[Inflate#onEnd]] will be called.\n   *\n   * `flush_mode` is not needed for normal operation, because end of stream\n   * detected automatically. You may try to use it for advanced things, but\n   * this functionality was not tested.\n   *\n   * On fail call [[Inflate#onEnd]] with error code and return false.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * push(chunk, false); // push one of data chunks\n   * ...\n   * push(chunk, true);  // push last chunk\n   * ```\n   **/\n  Inflate.prototype.push = function (data, flush_mode) {\n    const strm = this.strm;\n    const chunkSize = this.options.chunkSize;\n    const dictionary = this.options.dictionary;\n    let status, _flush_mode, last_avail_out;\n\n    if (this.ended) return false;\n\n    if (flush_mode === ~~flush_mode) _flush_mode = flush_mode;\n    else _flush_mode = flush_mode === true ? Z_FINISH : Z_NO_FLUSH;\n\n    // Convert data if needed\n    if (toString.call(data) === '[object ArrayBuffer]') {\n      strm.input = new Uint8Array(data);\n    } else {\n      strm.input = data;\n    }\n\n    strm.next_in = 0;\n    strm.avail_in = strm.input.length;\n\n    for (;;) {\n      if (strm.avail_out === 0) {\n        strm.output = new Uint8Array(chunkSize);\n        strm.next_out = 0;\n        strm.avail_out = chunkSize;\n      }\n\n      status = inflate_1$1.inflate(strm, _flush_mode);\n\n      if (status === Z_NEED_DICT && dictionary) {\n        status = inflate_1$1.inflateSetDictionary(strm, dictionary);\n\n        if (status === Z_OK) {\n          status = inflate_1$1.inflate(strm, _flush_mode);\n        } else if (status === Z_DATA_ERROR) {\n          // Replace code with more verbose\n          status = Z_NEED_DICT;\n        }\n      }\n\n      // Skip snyc markers if more data follows and not raw mode\n      while (strm.avail_in > 0 &&\n             status === Z_STREAM_END &&\n             strm.state.wrap > 0 &&\n             data[strm.next_in] !== 0)\n      {\n        inflate_1$1.inflateReset(strm);\n        status = inflate_1$1.inflate(strm, _flush_mode);\n      }\n\n      switch (status) {\n        case Z_STREAM_ERROR:\n        case Z_DATA_ERROR:\n        case Z_NEED_DICT:\n        case Z_MEM_ERROR:\n          this.onEnd(status);\n          this.ended = true;\n          return false;\n      }\n\n      // Remember real `avail_out` value, because we may patch out buffer content\n      // to align utf8 strings boundaries.\n      last_avail_out = strm.avail_out;\n\n      if (strm.next_out) {\n        if (strm.avail_out === 0 || status === Z_STREAM_END) {\n\n          if (this.options.to === 'string') {\n\n            let next_out_utf8 = strings.utf8border(strm.output, strm.next_out);\n\n            let tail = strm.next_out - next_out_utf8;\n            let utf8str = strings.buf2string(strm.output, next_out_utf8);\n\n            // move tail & realign counters\n            strm.next_out = tail;\n            strm.avail_out = chunkSize - tail;\n            if (tail) strm.output.set(strm.output.subarray(next_out_utf8, next_out_utf8 + tail), 0);\n\n            this.onData(utf8str);\n\n          } else {\n            this.onData(strm.output.length === strm.next_out ? strm.output : strm.output.subarray(0, strm.next_out));\n          }\n        }\n      }\n\n      // Must repeat iteration if out buffer is full\n      if (status === Z_OK && last_avail_out === 0) continue;\n\n      // Finalize if end of stream reached.\n      if (status === Z_STREAM_END) {\n        status = inflate_1$1.inflateEnd(this.strm);\n        this.onEnd(status);\n        this.ended = true;\n        return true;\n      }\n\n      if (strm.avail_in === 0) break;\n    }\n\n    return true;\n  };\n\n\n  /**\n   * Inflate#onData(chunk) -> Void\n   * - chunk (Uint8Array|String): output data. When string output requested,\n   *   each chunk will be string.\n   *\n   * By default, stores data blocks in `chunks[]` property and glue\n   * those in `onEnd`. Override this handler, if you need another behaviour.\n   **/\n  Inflate.prototype.onData = function (chunk) {\n    this.chunks.push(chunk);\n  };\n\n\n  /**\n   * Inflate#onEnd(status) -> Void\n   * - status (Number): inflate status. 0 (Z_OK) on success,\n   *   other if not.\n   *\n   * Called either after you tell inflate that the input stream is\n   * complete (Z_FINISH). By default - join collected chunks,\n   * free memory and fill `results` / `err` properties.\n   **/\n  Inflate.prototype.onEnd = function (status) {\n    // On success - join\n    if (status === Z_OK) {\n      if (this.options.to === 'string') {\n        this.result = this.chunks.join('');\n      } else {\n        this.result = common.flattenChunks(this.chunks);\n      }\n    }\n    this.chunks = [];\n    this.err = status;\n    this.msg = this.strm.msg;\n  };\n\n\n  /**\n   * inflate(data[, options]) -> Uint8Array|String\n   * - data (Uint8Array|ArrayBuffer): input data to decompress.\n   * - options (Object): zlib inflate options.\n   *\n   * Decompress `data` with inflate/ungzip and `options`. Autodetect\n   * format via wrapper header by default. That's why we don't provide\n   * separate `ungzip` method.\n   *\n   * Supported options are:\n   *\n   * - windowBits\n   *\n   * [http://zlib.net/manual.html#Advanced](http://zlib.net/manual.html#Advanced)\n   * for more information.\n   *\n   * Sugar (options):\n   *\n   * - `raw` (Boolean) - say that we work with raw stream, if you don't wish to specify\n   *   negative windowBits implicitly.\n   * - `to` (String) - if equal to 'string', then result will be converted\n   *   from utf8 to utf16 (javascript) string. When string output requested,\n   *   chunk length can differ from `chunkSize`, depending on content.\n   *\n   *\n   * ##### Example:\n   *\n   * ```javascript\n   * const pako = require('pako');\n   * const input = pako.deflate(new Uint8Array([1,2,3,4,5,6,7,8,9]));\n   * let output;\n   *\n   * try {\n   *   output = pako.inflate(input);\n   * } catch (err) {\n   *   console.log(err);\n   * }\n   * ```\n   **/\n  function inflate(input, options) {\n    const inflator = new Inflate(options);\n\n    inflator.push(input);\n\n    // That will never happens, if you don't cheat with options :)\n    if (inflator.err) throw inflator.msg || messages[inflator.err];\n\n    return inflator.result;\n  }\n\n\n  /**\n   * inflateRaw(data[, options]) -> Uint8Array|String\n   * - data (Uint8Array|ArrayBuffer): input data to decompress.\n   * - options (Object): zlib inflate options.\n   *\n   * The same as [[inflate]], but creates raw data, without wrapper\n   * (header and adler32 crc).\n   **/\n  function inflateRaw(input, options) {\n    options = options || {};\n    options.raw = true;\n    return inflate(input, options);\n  }\n\n\n  /**\n   * ungzip(data[, options]) -> Uint8Array|String\n   * - data (Uint8Array|ArrayBuffer): input data to decompress.\n   * - options (Object): zlib inflate options.\n   *\n   * Just shortcut to [[inflate]], because it autodetects format\n   * by header.content. Done for convenience.\n   **/\n\n\n  var Inflate_1 = Inflate;\n  var inflate_2 = inflate;\n  var inflateRaw_1 = inflateRaw;\n  var ungzip = inflate;\n  var constants = constants$1;\n\n  var inflate_1 = {\n  \tInflate: Inflate_1,\n  \tinflate: inflate_2,\n  \tinflateRaw: inflateRaw_1,\n  \tungzip: ungzip,\n  \tconstants: constants\n  };\n\n  exports.Inflate = Inflate_1;\n  exports.constants = constants;\n  exports[\"default\"] = inflate_1;\n  exports.inflate = inflate_2;\n  exports.inflateRaw = inflateRaw_1;\n  exports.ungzip = ungzip;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n","type CollectionByKey<Member> = Record<number | string, Member>;\n\ntype OrderDirection =\n  'asc'\n  | 'desc';\n\ntype OrderCallback<T> = (member: T) => unknown;\n\nexport function buildCollectionByKey<T extends AnyLiteral>(collection: T[], key: keyof T) {\n  return collection.reduce((byKey: CollectionByKey<T>, member: T) => {\n    byKey[member[key]] = member;\n\n    return byKey;\n  }, {});\n}\n\nexport function buildCollectionByCallback<T extends AnyLiteral, K extends number | string, R>(\n  collection: T[],\n  callback: (member: T) => [K, R],\n) {\n  return collection.reduce((byKey: Record<K, R>, member: T) => {\n    const [key, value] = callback(member);\n    byKey[key] = value;\n\n    return byKey;\n  }, {} as Record<K, R>);\n}\n\nexport function mapValues<R, M>(\n  byKey: CollectionByKey<M>,\n  callback: (member: M, key: string, index: number, originalByKey: CollectionByKey<M>) => R,\n): CollectionByKey<R> {\n  return Object.keys(byKey).reduce((newByKey: CollectionByKey<R>, key, index) => {\n    newByKey[key] = callback(byKey[key], key, index, byKey);\n    return newByKey;\n  }, {});\n}\n\nexport function pick<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    result[key] = object[key];\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function pickTruthy<T, K extends keyof T>(object: T, keys: K[]) {\n  return keys.reduce((result, key) => {\n    if (object[key]) {\n      result[key] = object[key];\n    }\n\n    return result;\n  }, {} as Pick<T, K>);\n}\n\nexport function omit<T extends object, K extends keyof T>(object: T, keys: K[]): Omit<T, K> {\n  const stringKeys = new Set(keys.map(String));\n  const savedKeys = Object.keys(object)\n    .filter((key) => !stringKeys.has(key)) as Array<Exclude<keyof T, K>>;\n\n  return pick(object, savedKeys);\n}\n\nexport function omitUndefined<T extends object>(object: T): T {\n  return Object.keys(object).reduce((result, stringKey) => {\n    const key = stringKey as keyof T;\n    if (object[key] !== undefined) {\n      result[key] = object[key];\n    }\n    return result;\n  }, {} as T);\n}\n\nexport function orderBy<T>(\n  collection: T[],\n  orderRule: (keyof T) | OrderCallback<T> | ((keyof T) | OrderCallback<T>)[],\n  mode: OrderDirection | [OrderDirection, OrderDirection] = 'asc',\n): T[] {\n  function compareValues(a: T, b: T, currentOrderRule: (keyof T) | OrderCallback<T>, isAsc: boolean) {\n    const aValue = (typeof currentOrderRule === 'function' ? currentOrderRule(a) : a[currentOrderRule]) || 0;\n    const bValue = (typeof currentOrderRule === 'function' ? currentOrderRule(b) : b[currentOrderRule]) || 0;\n\n    // @ts-expect-error Rely on the JS to handle the comparison\n    return isAsc ? aValue - bValue : bValue - aValue;\n  }\n\n  if (Array.isArray(orderRule)) {\n    const [mode1, mode2] = Array.isArray(mode) ? mode : [mode, mode];\n    const [orderRule1, orderRule2] = orderRule;\n    const isAsc1 = mode1 === 'asc';\n    const isAsc2 = mode2 === 'asc';\n\n    return collection.sort((a, b) => {\n      return compareValues(a, b, orderRule1, isAsc1) || compareValues(a, b, orderRule2, isAsc2);\n    });\n  }\n\n  const isAsc = mode === 'asc';\n  return collection.sort((a, b) => {\n    return compareValues(a, b, orderRule, isAsc);\n  });\n}\n\nexport function unique<T>(array: T[]): T[] {\n  return Array.from(new Set(array));\n}\n\nexport function uniqueByField<T>(array: T[], field: keyof T): T[] {\n  return [...new Map(array.map((item) => [item[field], item])).values()];\n}\n\nexport function compact<T>(array: T[]) {\n  return array.filter(Boolean);\n}\n\nexport function areSortedArraysEqual(array1: any[], array2: any[]) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => item === array2[i]);\n}\n\nexport function areSortedArraysIntersecting(array1: any[], array2: any[]) {\n  return array1[0] <= array2[array2.length - 1] && array1[array1.length - 1] >= array2[0];\n}\nexport function isInsideSortedArrayRange(value: any, array: any[]) {\n  return array[0] <= value && value <= array[array.length - 1];\n}\n\nexport function findIntersectionWithSet<T>(array: T[], set: Set<T>): T[] {\n  return array.filter((a) => set.has(a));\n}\n/**\n * Exlude elements from base array. Both arrays should be sorted in same order\n * @param base\n * @param toExclude\n * @returns New array without excluded elements\n */\nexport function excludeSortedArray<T>(base: T[], toExclude: T[]) {\n  if (!base?.length) return base;\n\n  const result: T[] = [];\n\n  let excludeIndex = 0;\n\n  for (let i = 0; i < base.length; i++) {\n    if (toExclude[excludeIndex] === base[i]) {\n      excludeIndex += 1;\n    } else {\n      result.push(base[i]);\n    }\n  }\n\n  return result;\n}\n\nexport function split<T>(array: T[], chunkSize: number) {\n  const result: T[][] = [];\n  for (let i = 0; i < array.length; i += chunkSize) {\n    result.push(array.slice(i, i + chunkSize));\n  }\n\n  return result;\n}\n\nexport function partition<T>(\n  array: T[], filter: (value: T, index: number, array: T[]) => boolean | undefined,\n): [T[], T[]] {\n  const pass: T[] = [];\n  const fail: T[] = [];\n\n  array.forEach((e, idx, arr) => (filter(e, idx, arr) ? pass : fail).push(e));\n\n  return [pass, fail];\n}\n\nexport function cloneDeep<T>(value: T): T {\n  if (!isObject(value)) {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return value.map(cloneDeep) as typeof value;\n  }\n\n  return Object.keys(value).reduce((acc, key) => {\n    acc[key as keyof T] = cloneDeep(value[key as keyof T]);\n    return acc;\n  }, {} as T);\n}\n\nexport function isLiteralObject(value: any): value is AnyLiteral {\n  return isObject(value) && !Array.isArray(value);\n}\n\nfunction isObject(value: any): value is object {\n  // eslint-disable-next-line no-null/no-null\n  return typeof value === 'object' && value !== null;\n}\n\nexport function findLast<T>(array: Array<T>, predicate: (value: T, index: number, obj: T[]) => boolean): T | undefined {\n  let cursor = array.length;\n\n  while (cursor--) {\n    if (predicate(array[cursor], cursor, array)) {\n      return array[cursor];\n    }\n  }\n\n  return undefined;\n}\n\nexport function compareFields<T>(a: T, b: T) {\n  return Number(b) - Number(a);\n}\n","import type { ThreadId, TopicsInfo } from '../../types';\nimport type { GlobalState } from '../types';\n\nexport function selectTopicsInfo<T extends GlobalState>(global: T, chatId: string): TopicsInfo | undefined {\n  return global.chats.topicsInfoById[chatId];\n}\n\nexport function selectTopics<T extends GlobalState>(global: T, chatId: string) {\n  return selectTopicsInfo(global, chatId)?.topicsById;\n}\n\nexport function selectTopic<T extends GlobalState>(global: T, chatId: string, threadId: ThreadId) {\n  return selectTopicsInfo(global, chatId)?.topicsById?.[threadId];\n}\n","type RLottieClass = typeof import('./RLottie').default;\n\nlet promise: Promise<RLottieClass> | undefined;\nlet RLottie: RLottieClass;\n\n// Time for the main interface to completely load\nconst LOTTIE_LOAD_DELAY = 3000;\n\nexport async function ensureRLottie() {\n  if (!promise) {\n    promise = import('./RLottie').then((module) => module.default);\n    RLottie = await promise;\n  }\n\n  return promise;\n}\n\nexport function getRLottie() {\n  return RLottie;\n}\n\nsetTimeout(ensureRLottie, LOTTIE_LOAD_DELAY);\n","import {\n  memo, useLayoutEffect, useMemo, useRef,\n} from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiTypeStory } from '../../api/types';\nimport type { ThemeKey } from '../../types';\n\nimport { selectPeerStories, selectTheme } from '../../global/selectors';\nimport buildClassName from '../../util/buildClassName';\nimport { REM } from './helpers/mediaDimensions';\n\nimport useDevicePixelRatio from '../../hooks/window/useDevicePixelRatio';\n\ninterface OwnProps {\n  peerId: string;\n  className?: string;\n  size: number;\n  withExtraGap?: boolean;\n  colors?: string[];\n}\n\ninterface StateProps {\n  peerStories?: Record<number, ApiTypeStory>;\n  storyIds?: number[];\n  lastReadId?: number;\n  appTheme: ThemeKey;\n}\n\nconst BLUE = ['#34C578', '#3CA3F3'];\nconst GREEN = ['#C9EB38', '#09C167'];\nconst GRAY = '#C4C9CC';\nconst DARK_GRAY = '#737373';\nconst STROKE_WIDTH = 0.125 * REM;\nconst STROKE_WIDTH_LARGE = 0.25 * REM;\nconst GAP_PERCENT = 2;\nconst SEGMENTS_MAX = 45; // More than this breaks rendering in Safari and Chrome\nconst LARGE_SIZE = 4 * REM;\n\nconst GAP_PERCENT_EXTRA = 10;\nconst EXTRA_GAP_ANGLE = Math.PI / 4;\nconst EXTRA_GAP_SIZE = (GAP_PERCENT_EXTRA / 100) * (2 * Math.PI);\nconst EXTRA_GAP_START = EXTRA_GAP_ANGLE - EXTRA_GAP_SIZE / 2;\nconst EXTRA_GAP_END = EXTRA_GAP_ANGLE + EXTRA_GAP_SIZE / 2;\n\nfunction AvatarStoryCircle({\n  size,\n  className,\n  peerStories,\n  storyIds,\n  lastReadId,\n  withExtraGap,\n  appTheme,\n  colors,\n}: OwnProps & StateProps) {\n  const ref = useRef<HTMLCanvasElement>();\n\n  const dpr = useDevicePixelRatio();\n\n  const isLarge = size > LARGE_SIZE;\n  const strokeWidth = isLarge ? STROKE_WIDTH_LARGE : STROKE_WIDTH;\n  const adaptedSize = size + strokeWidth + (isLarge ? 0.25 * REM : 0); // Add extra gap space for large avatars\n\n  const values = useMemo(() => {\n    return (storyIds || []).reduce((acc, id) => {\n      acc.total += 1;\n      if (lastReadId && id <= lastReadId) {\n        acc.read += 1;\n      }\n\n      return acc;\n    }, { total: 0, read: 0 });\n  }, [lastReadId, storyIds]);\n\n  const isCloseFriend = useMemo(() => {\n    if (!peerStories || !storyIds?.length) {\n      return false;\n    }\n\n    return storyIds.some((id) => {\n      const story = peerStories[id];\n      if (!story || !('isForCloseFriends' in story)) {\n        return false;\n      }\n      const isRead = lastReadId && story.id <= lastReadId;\n      return story.isForCloseFriends && !isRead;\n    });\n  }, [lastReadId, peerStories, storyIds]);\n\n  useLayoutEffect(() => {\n    if (!ref.current) {\n      return;\n    }\n\n    drawGradientCircle({\n      canvas: ref.current,\n      size: adaptedSize,\n      strokeWidth,\n      segmentsCount: values.total,\n      colorStops: colors || (isCloseFriend ? GREEN : BLUE),\n      readSegmentsCount: values.read,\n      withExtraGap,\n      readSegmentColor: appTheme === 'dark' ? DARK_GRAY : GRAY,\n      dpr,\n    });\n  }, [appTheme, isCloseFriend, adaptedSize, values.read, values.total, withExtraGap, dpr, colors, size, strokeWidth]);\n\n  if (!values.total) {\n    return undefined;\n  }\n\n  return (\n    <canvas\n      ref={ref}\n      className={buildClassName('story-circle', className)}\n      style={`max-width: ${adaptedSize}px; max-height: ${adaptedSize}px;`}\n    />\n  );\n}\n\nexport default memo(withGlobal<OwnProps>((global, { peerId }): Complete<StateProps> => {\n  const peerStories = selectPeerStories(global, peerId);\n  const appTheme = selectTheme(global);\n\n  return {\n    peerStories: peerStories?.byId,\n    storyIds: peerStories?.orderedIds,\n    lastReadId: peerStories?.lastReadId,\n    appTheme,\n  };\n})(AvatarStoryCircle));\n\nexport function drawGradientCircle({\n  canvas,\n  size,\n  strokeWidth: strokeWidthPx = STROKE_WIDTH,\n  colorStops,\n  segmentsCount,\n  readSegmentsCount = 0,\n  withExtraGap = false,\n  readSegmentColor,\n  dpr,\n}: {\n  canvas: HTMLCanvasElement;\n  strokeWidth?: number;\n  size: number;\n  colorStops: string[];\n  segmentsCount: number;\n  readSegmentsCount?: number;\n  withExtraGap?: boolean;\n  readSegmentColor: string;\n  dpr: number;\n}) {\n  if (segmentsCount > SEGMENTS_MAX) {\n    readSegmentsCount = Math.round(readSegmentsCount * (SEGMENTS_MAX / segmentsCount));\n\n    segmentsCount = SEGMENTS_MAX;\n  }\n\n  const sizeModifier = dpr;\n  const strokeModifier = dpr;\n\n  const ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return;\n  }\n\n  const canvasSize = size * sizeModifier;\n  const strokeWidth = strokeWidthPx * strokeModifier;\n\n  canvas.width = canvasSize;\n  canvas.height = canvasSize;\n  const centerCoordinate = canvasSize / 2;\n  const radius = (canvasSize - strokeWidth) / 2;\n  const segmentAngle = (2 * Math.PI) / segmentsCount;\n  const gapSize = (GAP_PERCENT / 100) * (2 * Math.PI);\n  const gradient = ctx.createLinearGradient(\n    0,\n    0,\n    Math.ceil(canvasSize * Math.cos(Math.PI / 2)),\n    Math.ceil(canvasSize * Math.sin(Math.PI / 2)),\n  );\n\n  if (colorStops.length === 1) {\n    gradient.addColorStop(0, colorStops[0]);\n    gradient.addColorStop(1, colorStops[0]);\n  } else {\n    colorStops.forEach((colorStop, index) => {\n      gradient.addColorStop(index / (colorStops.length - 1), colorStop);\n    });\n  }\n\n  ctx.lineCap = 'round';\n  ctx.clearRect(0, 0, canvasSize, canvasSize);\n\n  Array.from({ length: segmentsCount }).forEach((_, i) => {\n    const isRead = i < readSegmentsCount;\n    let startAngle = i * segmentAngle - Math.PI / 2 + gapSize / 2;\n    let endAngle = startAngle + segmentAngle - (segmentsCount > 1 ? gapSize : 0);\n\n    ctx.strokeStyle = isRead ? readSegmentColor : gradient;\n    ctx.lineWidth = strokeWidth * (isRead ? 0.5 : 1);\n\n    if (withExtraGap) {\n      if (startAngle >= EXTRA_GAP_START && endAngle <= EXTRA_GAP_END) { // Segment is inside extra gap\n        return;\n      } else if (startAngle < EXTRA_GAP_START && endAngle > EXTRA_GAP_END) { // Extra gap is inside segment\n        ctx.beginPath();\n        ctx.arc(centerCoordinate, centerCoordinate, radius, EXTRA_GAP_END, endAngle);\n        ctx.stroke();\n\n        endAngle = EXTRA_GAP_START;\n      } else if (startAngle < EXTRA_GAP_START && endAngle > EXTRA_GAP_START) { // Segment ends in extra gap\n        endAngle = EXTRA_GAP_START;\n      } else if (startAngle < EXTRA_GAP_END && endAngle > EXTRA_GAP_END) { // Segment starts in extra gap\n        startAngle = EXTRA_GAP_END;\n      }\n    }\n\n    ctx.beginPath();\n    ctx.arc(centerCoordinate, centerCoordinate, radius, startAngle, endAngle);\n    ctx.stroke();\n  });\n}\n","import { addCallback } from '../../../lib/teact/teactn';\n\nimport type { ApiNotification } from '../../../api/types';\nimport type { LangCode } from '../../../types';\nimport type { ActionReturnType, GlobalState } from '../../types';\n\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { IS_ELECTRON, IS_MULTIACCOUNT_SUPPORTED, IS_TAURI } from '../../../util/browser/globalEnvironment';\nimport {\n  IS_ANDROID, IS_IOS, IS_LINUX,\n  IS_MAC_OS, IS_SAFARI, IS_TOUCH_ENV, IS_WINDOWS,\n} from '../../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport generateUniqueId from '../../../util/generateUniqueId';\nimport { subscribe, unsubscribe } from '../../../util/notifications';\nimport { oldSetLanguage } from '../../../util/oldLangProvider';\nimport { decryptSessionByCurrentHash } from '../../../util/passcode';\nimport { applyPerformanceSettings } from '../../../util/perfomanceSettings';\nimport { hasStoredSession, storeSession } from '../../../util/sessions';\nimport switchTheme from '../../../util/switchTheme';\nimport { getSystemTheme, setSystemThemeChangeCallback } from '../../../util/systemTheme';\nimport { startWebsync, stopWebsync } from '../../../util/websync';\nimport { callApi } from '../../../api/gramjs';\nimport { clearCaching, setupCaching } from '../../cache';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport { updateSharedSettings } from '../../reducers';\nimport { updateAuth } from '../../reducers/auth';\nimport { updateTabState } from '../../reducers/tabs';\nimport {\n  selectCanAnimateInterface,\n  selectPerformanceSettings,\n  selectSettingsKeys,\n  selectTabState,\n  selectTheme,\n} from '../../selectors';\nimport { selectSharedSettings } from '../../selectors/sharedState';\nimport { destroySharedStatePort, initSharedState } from '../../shared/sharedStateConnector';\n\nconst HISTORY_ANIMATION_DURATION = 450;\n\nsetSystemThemeChangeCallback((theme) => {\n  let global = getGlobal();\n\n  if (!global.isInited || !selectSharedSettings(global).shouldUseSystemTheme) return;\n\n  global = updateSharedSettings(global, { theme });\n  setGlobal(global);\n});\n\naddActionHandler('switchMultitabRole', async (global, actions, payload): Promise<void> => {\n  const { isMasterTab, tabId = getCurrentTabId() } = payload;\n\n  if (isMasterTab === selectTabState(global, tabId).isMasterTab) {\n    callApi('broadcastLocalDbUpdateFull');\n    return;\n  }\n\n  global = updateTabState(global, {\n    isMasterTab,\n  }, tabId);\n  setGlobal(global, { forceSyncOnIOs: true });\n\n  if (!isMasterTab) {\n    void unsubscribe();\n    actions.destroyConnection();\n    stopWebsync();\n    destroySharedStatePort();\n    clearCaching();\n    actions.onSomeTabSwitchedMultitabRole();\n  } else {\n    if (global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n      const { sessionJson } = await decryptSessionByCurrentHash();\n      const session = JSON.parse(sessionJson);\n      storeSession(session);\n    }\n\n    if (hasStoredSession()) {\n      setupCaching();\n    }\n\n    global = getGlobal();\n    if (!global.passcode.hasPasscode || !global.passcode.isScreenLocked) {\n      if (global.connectionState === 'connectionStateReady') {\n        global = {\n          ...global,\n          connectionState: 'connectionStateConnecting',\n        };\n        setGlobal(global);\n      }\n      actions.initApi();\n    }\n\n    startWebsync();\n    if (IS_MULTIACCOUNT_SUPPORTED) {\n      initSharedState(global.sharedState);\n    }\n  }\n});\n\naddActionHandler('onSomeTabSwitchedMultitabRole', async (global): Promise<void> => {\n  if (global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n    const { sessionJson } = await decryptSessionByCurrentHash();\n    const session = JSON.parse(sessionJson);\n    storeSession(session);\n  }\n\n  callApi('broadcastLocalDbUpdateFull');\n});\n\naddActionHandler('initShared', (): ActionReturnType => {\n  startWebsync();\n});\n\naddActionHandler('initMain', (global): ActionReturnType => {\n  const { hasWebNotifications, hasPushNotifications } = selectSettingsKeys(global);\n  if (hasWebNotifications && hasPushNotifications) {\n    // Most of the browsers only show the notifications permission prompt after the first user gesture.\n    const events = ['click', 'keypress'];\n    const subscribeAfterUserGesture = () => {\n      void subscribe();\n      events.forEach((event) => {\n        document.removeEventListener(event, subscribeAfterUserGesture);\n      });\n    };\n    events.forEach((event) => {\n      document.addEventListener(event, subscribeAfterUserGesture, { once: true });\n    });\n  }\n});\n\naddCallback((global: GlobalState) => {\n  let isUpdated = false;\n  const tabState = selectTabState(global, getCurrentTabId());\n  if (!tabState?.shouldInit) return;\n\n  global = getGlobal();\n\n  global = updateTabState(global, {\n    shouldInit: false,\n  }, tabState.id);\n\n  const { messageTextSize, language, shouldUseSystemTheme } = selectSharedSettings(global);\n\n  const globalTheme = selectTheme(global);\n  const systemTheme = getSystemTheme();\n  const theme = shouldUseSystemTheme ? systemTheme : globalTheme;\n\n  const performanceType = selectPerformanceSettings(global);\n\n  void oldSetLanguage(language as LangCode, undefined, true);\n\n  requestMutation(() => {\n    document.documentElement.style.setProperty(\n      '--composer-text-size', `${Math.max(messageTextSize, IS_IOS ? 16 : 15)}px`,\n    );\n    document.documentElement.style.setProperty('--message-meta-height', `${Math.floor(messageTextSize * 1.3125)}px`);\n    document.documentElement.style.setProperty('--message-text-size', `${messageTextSize}px`);\n    document.documentElement.setAttribute('data-message-text-size', messageTextSize.toString());\n    document.body.classList.add('initial');\n    document.body.classList.add(IS_TOUCH_ENV ? 'is-touch-env' : 'is-pointer-env');\n    applyPerformanceSettings(performanceType);\n\n    if (IS_IOS) {\n      document.body.classList.add('is-ios');\n    } else if (IS_ANDROID) {\n      document.body.classList.add('is-android');\n    } else if (IS_MAC_OS) {\n      document.body.classList.add('is-macos');\n    } else if (IS_WINDOWS) {\n      document.body.classList.add('is-windows');\n    } else if (IS_LINUX) {\n      document.body.classList.add('is-linux');\n    }\n    if (IS_SAFARI) {\n      document.body.classList.add('is-safari');\n    }\n    if (IS_TAURI) {\n      document.body.classList.add('is-tauri');\n    }\n    if (IS_ELECTRON) { // Legacy, pretend to be Tauri\n      document.body.classList.add('is-tauri');\n    }\n  });\n\n  const canAnimate = selectCanAnimateInterface(global);\n\n  switchTheme(theme, canAnimate);\n  // Make sure global has the latest theme. Will cause `switchTheme` on change\n  global = updateSharedSettings(global, { theme });\n\n  startWebsync();\n\n  isUpdated = true;\n\n  if (isUpdated) setGlobal(global);\n});\n\naddActionHandler('setInstallPrompt', (global, actions, payload): ActionReturnType => {\n  const { canInstall, tabId = getCurrentTabId() } = payload;\n  return updateTabState(global, {\n    canInstall,\n  }, tabId);\n});\n\naddActionHandler('setIsUiReady', (global, actions, payload): ActionReturnType => {\n  const { uiReadyState, tabId = getCurrentTabId() } = payload;\n\n  if (uiReadyState === 2) {\n    requestMutation(() => {\n      document.body.classList.remove('initial');\n    });\n  }\n\n  return updateTabState(global, {\n    uiReadyState,\n  }, tabId);\n});\n\naddActionHandler('setAuthPhoneNumber', (global, actions, payload): ActionReturnType => {\n  const { phoneNumber } = payload;\n\n  return updateAuth(global, {\n    phoneNumber,\n  });\n});\n\naddActionHandler('setAuthRememberMe', (global, actions, payload): ActionReturnType => {\n  return updateAuth(global, {\n    rememberMe: Boolean(payload.value),\n  });\n});\n\naddActionHandler('clearAuthErrorKey', (global): ActionReturnType => {\n  return updateAuth(global, {\n    errorKey: undefined,\n  });\n});\n\naddActionHandler('disableHistoryAnimations', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = updateTabState(global, {\n      shouldSkipHistoryAnimations: false,\n    }, tabId);\n    setGlobal(global);\n\n    requestMutation(() => {\n      document.body.classList.remove('no-animate');\n    });\n  }, HISTORY_ANIMATION_DURATION);\n\n  global = updateTabState(global, {\n    shouldSkipHistoryAnimations: true,\n  }, tabId);\n  setGlobal(global, { forceSyncOnIOs: true });\n});\n\naddActionHandler('showNotification', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId(), ...notification } = payload;\n  const hasLocalId = notification.localId;\n  notification.localId ||= generateUniqueId();\n\n  const newNotifications = [...selectTabState(global, tabId).notifications];\n  const existingNotificationIndex = newNotifications.findIndex((n) => (\n    hasLocalId ? n.localId === notification.localId : n.message === notification.message\n  ));\n  if (existingNotificationIndex !== -1) {\n    newNotifications.splice(existingNotificationIndex, 1);\n  }\n\n  newNotifications.push(notification as ApiNotification);\n\n  return updateTabState(global, {\n    notifications: newNotifications,\n  }, tabId);\n});\n\naddActionHandler('dismissNotification', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload;\n  const newNotifications = selectTabState(global, tabId)\n    .notifications.filter(({ localId }) => localId !== payload.localId);\n\n  return updateTabState(global, {\n    notifications: newNotifications,\n  }, tabId);\n});\n","import type { TeactNode } from '../lib/teact/teact';\n\nimport type {\n  ApiAttachment,\n  ApiBotInlineMediaResult,\n  ApiBotInlineResult,\n  ApiBotInlineSwitchPm,\n  ApiBotInlineSwitchWebview,\n  ApiChat,\n  ApiChatInviteImporter,\n  ApiContact,\n  ApiDisallowedGiftsSettings,\n  ApiDocument,\n  ApiDraft,\n  ApiExportedInvite,\n  ApiFakeType,\n  ApiFormattedText,\n  ApiInputReplyInfo,\n  ApiInputSuggestedPostInfo,\n  ApiLabeledPrice,\n  ApiMediaFormat,\n  ApiMessage,\n  ApiMessageEntity,\n  ApiNewMediaTodo,\n  ApiNewPoll,\n  ApiPeer,\n  ApiPhoto,\n  ApiReaction,\n  ApiReactionWithPaid,\n  ApiStarGiftAttributeIdBackdrop,\n  ApiStarGiftAttributeIdPattern,\n  ApiStarGiftRegular,\n  ApiStarsSubscription,\n  ApiStarsTransaction,\n  ApiSticker,\n  ApiStickerSet,\n  ApiStory,\n  ApiStorySkipped,\n  ApiThreadInfo,\n  ApiTopic,\n  ApiTypingStatus,\n  ApiVideo,\n  MediaContent,\n  StarGiftAttributeIdModel,\n} from '../api/types';\nimport type { DC_IDS } from '../config';\nimport type { SearchResultKey } from '../util/keys/searchResultKey';\nimport type { IconName } from './icons';\n\nexport type TextPart = TeactNode;\n\nexport type DcId = typeof DC_IDS[number];\n\nexport type SessionUserInfo = {\n  userId?: string;\n  firstName?: string;\n  lastName?: string;\n  phone?: string;\n  avatarUri?: string;\n  color?: number;\n  isPremium?: boolean;\n  emojiStatusId?: string;\n};\n\nexport type SharedSessionData = {\n  date?: number;\n  dcId: number;\n  isTest?: true;\n} & Partial<Record<`dc${DcId}_${'auth_key' | 'server_salt'}`, string>> & SessionUserInfo;\n\nexport type AccountInfo = {\n  isTest?: true;\n} & SessionUserInfo;\n\nexport enum LoadMoreDirection {\n  Backwards,\n  Forwards,\n  Around,\n}\n\nexport enum FocusDirection {\n  Up,\n  Down,\n  Static,\n}\n\nexport type ScrollTargetPosition = ScrollLogicalPosition | 'centerOrTop';\n\nexport interface IAlbum {\n  albumId: string;\n  messages: ApiMessage[];\n  isPaidMedia?: boolean;\n  mainMessage: ApiMessage;\n  captionMessage?: ApiMessage;\n  hasMultipleCaptions: boolean;\n  commentsMessage?: ApiMessage;\n}\n\nexport type ThreadId = string | number;\n\nexport type ThemeKey = 'light' | 'dark';\nexport type AnimationLevel = 0 | 1 | 2;\nexport type FoldersPosition = 'top' | 'left';\nexport type PerformanceTypeKey = (\n  'pageTransitions' | 'messageSendingAnimations' | 'mediaViewerAnimations'\n  | 'messageComposerAnimations' | 'contextMenuAnimations' | 'contextMenuBlur' | 'rightColumnAnimations'\n  | 'animatedEmoji' | 'loopAnimatedStickers' | 'reactionEffects' | 'stickerEffects' | 'autoplayGifs' | 'autoplayVideos'\n  | 'storyRibbonAnimations' | 'snapEffect'\n);\nexport type PerformanceType = Record<PerformanceTypeKey, boolean>;\n\nexport interface IThemeSettings {\n  background?: string;\n  backgroundColor?: string;\n  patternColor?: string;\n  isBlurred?: boolean;\n}\n\nexport type LangCode = (\n  'en' | 'ar' | 'be' | 'ca' | 'nl' | 'fr' | 'de' | 'id' | 'it' | 'ko' | 'ms' | 'fa' | 'pl' | 'pt-br' | 'ru' | 'es'\n  | 'tr' | 'uk' | 'uz'\n);\n\nexport type TimeFormat = '24h' | '12h';\n\nexport interface AccountSettings {\n  hasWebNotifications: boolean;\n  hasPushNotifications: boolean;\n  hasContactJoinedNotifications?: boolean;\n  notificationSoundVolume: number;\n  canAutoLoadPhotoFromContacts: boolean;\n  canAutoLoadPhotoInPrivateChats: boolean;\n  canAutoLoadPhotoInGroups: boolean;\n  canAutoLoadPhotoInChannels: boolean;\n  canAutoLoadVideoFromContacts: boolean;\n  canAutoLoadVideoInPrivateChats: boolean;\n  canAutoLoadVideoInGroups: boolean;\n  canAutoLoadVideoInChannels: boolean;\n  canAutoLoadFileFromContacts: boolean;\n  canAutoLoadFileInPrivateChats: boolean;\n  canAutoLoadFileInGroups: boolean;\n  canAutoLoadFileInChannels: boolean;\n  autoLoadFileMaxSizeMb: number;\n  shouldSuggestStickers: boolean;\n  shouldSuggestCustomEmoji: boolean;\n  shouldUpdateStickerSetOrder: boolean;\n  hasPassword?: boolean;\n  isSensitiveEnabled?: boolean;\n  canChangeSensitive?: boolean;\n  shouldArchiveAndMuteNewNonContact?: boolean;\n  shouldNewNonContactPeersRequirePremium?: boolean;\n  nonContactPeersPaidStars?: number;\n  shouldDisplayGiftsButton?: boolean;\n  disallowedGifts?: ApiDisallowedGiftsSettings;\n  shouldHideReadMarks?: boolean;\n  canTranslate: boolean;\n  canTranslateChats: boolean;\n  translationLanguage?: string;\n  doNotTranslate: string[];\n  shouldPaidMessageAutoApprove: boolean;\n}\n\nexport type IAnchorPosition = {\n  x: number;\n  y: number;\n};\n\nexport interface ShippingOption {\n  id: string;\n  title: string;\n  amount: number;\n  prices: ApiLabeledPrice[];\n}\n\nexport enum SettingsScreens {\n  Main,\n  EditProfile,\n  Notifications,\n  DataStorage,\n  Language,\n  ActiveSessions,\n  General,\n  GeneralChatBackground,\n  GeneralChatBackgroundColor,\n  Privacy,\n  PrivacyPhoneNumber,\n  PrivacyAddByPhone,\n  PrivacyLastSeen,\n  PrivacyProfilePhoto,\n  PrivacyBio,\n  PrivacyBirthday,\n  PrivacyGifts,\n  PrivacyPhoneCall,\n  PrivacyPhoneP2P,\n  PrivacyForwarding,\n  PrivacyVoiceMessages,\n  PrivacyMessages,\n  PrivacyGroupChats,\n  PrivacyPhoneNumberAllowedContacts,\n  PrivacyPhoneNumberDeniedContacts,\n  PrivacyLastSeenAllowedContacts,\n  PrivacyLastSeenDeniedContacts,\n  PrivacyProfilePhotoAllowedContacts,\n  PrivacyProfilePhotoDeniedContacts,\n  PrivacyBioAllowedContacts,\n  PrivacyBioDeniedContacts,\n  PrivacyBirthdayAllowedContacts,\n  PrivacyBirthdayDeniedContacts,\n  PrivacyGiftsAllowedContacts,\n  PrivacyGiftsDeniedContacts,\n  PrivacyPhoneCallAllowedContacts,\n  PrivacyPhoneCallDeniedContacts,\n  PrivacyPhoneP2PAllowedContacts,\n  PrivacyPhoneP2PDeniedContacts,\n  PrivacyForwardingAllowedContacts,\n  PrivacyForwardingDeniedContacts,\n  PrivacyVoiceMessagesAllowedContacts,\n  PrivacyVoiceMessagesDeniedContacts,\n  PrivacyGroupChatsAllowedContacts,\n  PrivacyGroupChatsDeniedContacts,\n  PrivacyBlockedUsers,\n  PrivacyNoPaidMessages,\n  Performance,\n  Folders,\n  FoldersCreateFolder,\n  FoldersEditFolder,\n  FoldersEditFolderFromChatList,\n  FoldersEditFolderInvites,\n  FoldersIncludedChats,\n  FoldersIncludedChatsFromChatList,\n  FoldersExcludedChats,\n  FoldersExcludedChatsFromChatList,\n  TwoFaDisabled,\n  TwoFaNewPassword,\n  TwoFaNewPasswordConfirm,\n  TwoFaNewPasswordHint,\n  TwoFaNewPasswordEmail,\n  TwoFaNewPasswordEmailCode,\n  TwoFaEnabled,\n  TwoFaChangePasswordCurrent,\n  TwoFaChangePasswordNew,\n  TwoFaChangePasswordConfirm,\n  TwoFaChangePasswordHint,\n  TwoFaTurnOff,\n  TwoFaRecoveryEmailCurrentPassword,\n  TwoFaRecoveryEmail,\n  TwoFaRecoveryEmailCode,\n  TwoFaCongratulations,\n  ActiveWebsites,\n  PasscodeDisabled,\n  PasscodeNewPasscode,\n  PasscodeNewPasscodeConfirm,\n  PasscodeEnabled,\n  PasscodeChangePasscodeCurrent,\n  PasscodeChangePasscodeNew,\n  PasscodeChangePasscodeConfirm,\n  PasscodeTurnOff,\n  PasscodeCongratulations,\n  Experimental,\n  Stickers,\n  QuickReaction,\n  CustomEmoji,\n  DoNotTranslate,\n  FoldersShare,\n  Passkeys,\n}\n\nexport type StickerSetOrReactionsSetOrRecent = Pick<ApiStickerSet, (\n  'id' | 'accessHash' | 'title' | 'count' | 'stickers' | 'isEmoji' | 'installedDate' | 'isArchived' |\n  'hasThumbnail' | 'hasStaticThumb' | 'hasAnimatedThumb' | 'hasVideoThumb' | 'thumbCustomEmojiId'\n)> & { reactions?: ApiReactionWithPaid[] };\n\nexport enum LeftColumnContent {\n  ChatList,\n  GlobalSearch,\n  Settings,\n  Contacts,\n  Archived,\n  Threads,\n  NewChannelStep1,\n  NewChannelStep2,\n  NewGroupStep1,\n  NewGroupStep2,\n  AlphahumanSidebar,\n}\n\nexport enum GlobalSearchContent {\n  ChatList,\n  ChannelList,\n  BotApps,\n  PublicPosts,\n  Media,\n  Links,\n  Files,\n  Music,\n  Voice,\n}\n\nexport enum RightColumnContent {\n  ChatInfo,\n  Management,\n  Statistics,\n  BoostStatistics,\n  MessageStatistics,\n  StoryStatistics,\n  StickerSearch,\n  GifSearch,\n  PollResults,\n  AddingMembers,\n  CreateTopic,\n  EditTopic,\n  MonetizationStatistics,\n  NewGroup,\n  AgentChat,\n  ThreadHistory,\n}\n\nexport type MediaViewerMedia = ApiPhoto | ApiVideo | ApiDocument;\n\nexport enum MediaViewerOrigin {\n  Inline,\n  ScheduledInline,\n  SharedMedia,\n  ProfileAvatar,\n  SettingsAvatar,\n  MiddleHeaderAvatar,\n  Album,\n  ScheduledAlbum,\n  SearchResult,\n  ChannelAvatar,\n  SuggestedAvatar,\n  StarsTransaction,\n  PreviewMedia,\n  SponsoredMessage,\n}\n\nexport enum StoryViewerOrigin {\n  StoryRibbon,\n  MiddleHeaderAvatar,\n  ChatList,\n  SearchResult,\n}\n\nexport enum AudioOrigin {\n  Inline,\n  SharedMedia,\n  Search,\n  OneTimeModal,\n}\n\nexport enum ChatCreationProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport enum ProfileEditProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport enum ManagementProgress {\n  Idle,\n  InProgress,\n  Complete,\n  Error,\n}\n\nexport interface ManagementState {\n  isActive: boolean;\n  nextScreen?: ManagementScreens;\n  checkedUsername?: string;\n  isUsernameAvailable?: boolean;\n  error?: string;\n  invites?: ApiExportedInvite[];\n  revokedInvites?: ApiExportedInvite[];\n  editingInvite?: ApiExportedInvite;\n  inviteInfo?: {\n    invite: ApiExportedInvite;\n    importers?: ApiChatInviteImporter[];\n    requesters?: ApiChatInviteImporter[];\n  };\n}\n\nexport enum NewChatMembersProgress {\n  Closed,\n  InProgress,\n  Loading,\n}\n\nexport type ProfileTabType =\n  | 'members'\n  | 'commonChats'\n  | 'media'\n  | 'previewMedia'\n  | 'documents'\n  | 'links'\n  | 'audio'\n  | 'voice'\n  | 'gif'\n  | 'stories'\n  | 'storiesArchive'\n  | 'similarChannels'\n  | 'similarBots'\n  | 'dialogs'\n  | 'gifts';\nexport type SharedMediaType = 'media' | 'documents' | 'links' | 'audio' | 'voice' | 'gif';\nexport type MiddleSearchType = 'chat' | 'myChats' | 'channels';\nexport type MiddleSearchParams = {\n  requestedQuery?: string;\n  savedTag?: ApiReaction;\n  isHashtag?: boolean;\n  fetchingQuery?: string;\n  type: MiddleSearchType;\n  results?: MiddleSearchResults;\n};\nexport type MiddleSearchResults = {\n  query: string;\n  totalCount?: number;\n  nextOffsetId?: number;\n  nextOffsetPeerId?: string;\n  nextOffsetRate?: number;\n  foundIds?: SearchResultKey[];\n};\n\nexport type SummarizeChatInfo = {\n  chatId: string;\n  messageCount: number;\n  lastMessageDate?: number;\n};\n\nexport type SummarizeMessageLink = {\n  text: string;\n  chatId: string;\n  messageId: number;\n};\n\nexport type SummarizeContent = {\n  paragraphs: string[];\n  actionItems?: string[];\n  messageLinks?: SummarizeMessageLink[];\n};\n\nexport type ChatSummary = {\n  chatId: string;\n  date: number;\n  content: SummarizeContent;\n  isRead?: boolean;\n};\n\nexport type SummarizeState = {\n  selectedDate?: number; // Unix timestamp for the selected date\n  isOpen?: boolean;\n  isSetupComplete: boolean;\n  selectedChatIds: string[];\n  busiestChats?: SummarizeChatInfo[];\n  isLoadingBusiestChats?: boolean;\n  summaries: ChatSummary[];\n  isLoadingSummaries?: boolean;\n  searchQuery?: string;\n  includeArchived?: boolean;\n};\n\nexport interface LoadingState {\n  areAllItemsLoadedForwards: boolean;\n  areAllItemsLoadedBackwards: boolean;\n}\n\nexport interface ChatMediaSearchSegment {\n  foundIds: number[];\n  loadingState: LoadingState;\n}\n\nexport interface ChatMediaSearchParams {\n  currentSegment: ChatMediaSearchSegment;\n  segments: ChatMediaSearchSegment[];\n  isLoading: boolean;\n}\n\nexport enum ProfileState {\n  Profile,\n  SharedMedia,\n  MemberList,\n  GiftList,\n  StoryList,\n  SavedDialogs,\n}\n\nexport enum PaymentStep {\n  Checkout,\n  SavedPayments,\n  ConfirmPassword,\n  PaymentInfo,\n  ShippingInfo,\n  Shipping,\n  ConfirmPayment,\n}\n\nexport const UPLOADING_WALLPAPER_SLUG = 'UPLOADING_WALLPAPER_SLUG';\n\nexport enum ManagementScreens {\n  Initial,\n  ChatPrivacyType,\n  Discussion,\n  ChannelSubscribers,\n  GroupType,\n  GroupPermissions,\n  GroupRemovedUsers,\n  ChannelRemovedUsers,\n  GroupUserPermissionsCreate,\n  GroupUserPermissions,\n  ChatAdministrators,\n  GroupRecentActions,\n  ChatAdminRights,\n  ChatNewAdminRights,\n  GroupMembers,\n  GroupAddAdmins,\n  Invites,\n  EditInvite,\n  Reactions,\n  InviteInfo,\n  JoinRequests,\n  NewDiscussionGroup,\n}\n\nexport type ManagementType = 'user' | 'group' | 'channel' | 'bot';\n\nexport type EmojiKeywords = {\n  isLoading?: boolean;\n  version?: number;\n  keywords?: Record<string, string[]>;\n};\n\nexport type InlineBotSettings = {\n  id: string;\n  help?: string;\n  query?: string;\n  offset?: string;\n  canLoadMore?: boolean;\n  results?: (ApiBotInlineResult | ApiBotInlineMediaResult)[];\n  isGallery?: boolean;\n  switchPm?: ApiBotInlineSwitchPm;\n  switchWebview?: ApiBotInlineSwitchWebview;\n  cacheTime: number;\n};\n\nexport type CustomPeerType = 'premium' | 'toBeDistributed' | 'contacts' | 'nonContacts'\n  | 'groups' | 'channels' | 'bots' | 'excludeMuted' | 'excludeArchived' | 'excludeRead' | 'stars';\n\nexport type CustomPeer = {\n  isCustomPeer: true;\n  key?: string | number;\n  subtitleKey?: string;\n  avatarIcon?: IconName;\n  isAvatarSquare?: boolean;\n  peerColorId?: number;\n  isVerified?: boolean;\n  fakeType?: ApiFakeType;\n  emojiStatusId?: string;\n  customPeerAvatarColor?: string;\n  withPremiumGradient?: boolean;\n  isPremium?: boolean;\n} & ({\n  titleKey: string;\n  title?: undefined;\n} | {\n  title: string;\n  titleKey?: undefined;\n});\n\nexport type UniqueCustomPeer<T = CustomPeerType> = CustomPeer & {\n  type: T;\n};\n\nexport type MessageListType =\n  'thread'\n  | 'pinned'\n  | 'scheduled';\n\nexport type ChatListType = 'active' | 'archived' | 'saved';\n\nexport interface MessageList {\n  chatId: string;\n  threadId: ThreadId;\n  type: MessageListType;\n}\n\nexport interface ActiveEmojiInteraction {\n  id: number;\n  x: number;\n  y: number;\n  messageId?: number;\n  startSize?: number;\n  animatedEffect?: string;\n  isReversed?: boolean;\n}\n\nexport type ActiveDownloads = Record<string, {\n  format: ApiMediaFormat;\n  filename: string;\n  size: number;\n  originChatId?: string;\n  originMessageId?: number;\n}>;\n\nexport type IDimensions = {\n  width: number;\n  height: number;\n};\n\nexport type StarsTransactionType = 'all' | 'inbound' | 'outbound';\nexport type StarsTransactionHistory = Record<StarsTransactionType, {\n  transactions: ApiStarsTransaction[];\n  nextOffset?: string;\n} | undefined>;\nexport type StarsSubscriptions = {\n  list: ApiStarsSubscription[];\n  nextOffset?: string;\n  isLoading?: boolean;\n};\n\nexport type ConfettiStyle = 'poppers' | 'top-down';\n\nexport type StarGiftInfo = {\n  peerId: string;\n  gift: ApiStarGiftRegular;\n  shouldHideName?: boolean;\n  message?: ApiFormattedText;\n  shouldUpgrade?: boolean;\n};\n\nexport type TypingDraft = {\n  senderId: string;\n  id: string;\n  date: number;\n  text: ApiFormattedText;\n};\n\nexport interface TabThread {\n  scrollOffset?: number;\n  replyStack?: number[];\n  viewportIds?: number[];\n}\n\nexport interface Thread {\n  lastScrollOffset?: number;\n  lastViewportIds?: number[];\n  listedIds?: number[];\n  outlyingLists?: number[][];\n  pinnedIds?: number[];\n  scheduledIds?: number[];\n  editingId?: number;\n  editingScheduledId?: number;\n  editingDraft?: ApiFormattedText;\n  editingScheduledDraft?: ApiFormattedText;\n  draft?: ApiDraft;\n  noWebPage?: boolean;\n  threadInfo?: ApiThreadInfo;\n  firstMessageId?: number;\n  typingStatus?: ApiTypingStatus;\n  typingDraftIdByRandomId?: Record<string, number>;\n}\n\nexport interface ServiceNotification {\n  id: number;\n  message: ApiMessage;\n  version?: string;\n  isUnread?: boolean;\n  isDeleted?: boolean;\n}\n\nexport interface TopicsInfo {\n  totalCount: number;\n  topicsById: Record<ThreadId, ApiTopic>;\n  listedTopicIds?: number[];\n  orderedPinnedTopicIds?: number[];\n}\n\nexport type TranslatedMessage = {\n  isPending?: boolean;\n  text?: ApiFormattedText;\n};\n\nexport type ChatTranslatedMessages = {\n  byLangCode: Record<string, Record<number, TranslatedMessage>>;\n};\n\nexport type ChatRequestedTranslations = {\n  toLanguage?: string;\n  manualMessages?: Record<number, string>;\n};\n\nexport type SimilarBotsInfo = {\n  similarBotsIds?: string[];\n  count: number;\n};\n\nexport type ConfettiParams = OptionalCombine<{\n  style?: ConfettiStyle;\n  withStars?: boolean;\n}, {\n  top?: number;\n  left?: number;\n  width?: number;\n  height?: number;\n}>;\n\nexport interface Size {\n  width: number;\n  height: number;\n}\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport type WebPageMediaSize = 'large' | 'small';\n\nexport type AttachmentCompression = 'compress' | 'original';\n\nexport type StarGiftCategory = 'all' | 'myUnique' | 'collectible';\n\nexport type CallSound = (\n  'join' | 'allowTalk' | 'leave' | 'connecting' | 'incoming' | 'end' | 'connect' | 'busy' | 'ringing'\n);\n\nexport type BotAppPermissions = {\n  geolocation?: boolean;\n};\n\nexport type GiftProfileFilterOptions = {\n  sortType: 'byDate' | 'byValue';\n  shouldIncludeUnlimited: boolean;\n  shouldIncludeLimited: boolean;\n  shouldIncludeUpgradable: boolean;\n  shouldIncludeUnique: boolean;\n  shouldIncludeDisplayed: boolean;\n  shouldIncludeHidden: boolean;\n};\nexport type ResaleGiftsSortType = 'byDate' | 'byPrice' | 'byNumber';\nexport type ResaleGiftsFilterOptions = {\n  sortType: ResaleGiftsSortType;\n  modelAttributes?: StarGiftAttributeIdModel[];\n  patternAttributes?: ApiStarGiftAttributeIdPattern[];\n  backdropAttributes?: ApiStarGiftAttributeIdBackdrop[];\n};\n\nexport type SendMessageParams = {\n  chat?: ApiChat;\n  attachments?: ApiAttachment[];\n  lastMessageId?: number;\n  text?: string;\n  entities?: ApiMessageEntity[];\n  replyInfo?: ApiInputReplyInfo;\n  suggestedPostInfo?: ApiInputSuggestedPostInfo;\n  attachment?: ApiAttachment;\n  sticker?: ApiSticker;\n  story?: ApiStory | ApiStorySkipped;\n  gif?: ApiVideo;\n  poll?: ApiNewPoll;\n  todo?: ApiNewMediaTodo;\n  contact?: ApiContact;\n  isSilent?: boolean;\n  scheduledAt?: number;\n  scheduleRepeatPeriod?: number;\n  groupedId?: string;\n  noWebPage?: boolean;\n  sendAs?: ApiPeer;\n  shouldGroupMessages?: boolean;\n  shouldUpdateStickerSetOrder?: boolean;\n  wasDrafted?: boolean;\n  isInvertedMedia?: true;\n  effectId?: string;\n  webPageMediaSize?: WebPageMediaSize;\n  webPageUrl?: string;\n  starsAmount?: number;\n  isPending?: true;\n  messageList?: MessageList;\n  isReaction?: true; // Reaction to the story are sent in the form of a message\n  messagePriceInStars?: number;\n  localMessage?: ApiMessage;\n  forwardedLocalMessagesSlice?: ForwardedLocalMessagesSlice;\n  isForwarding?: boolean;\n  forwardParams?: ForwardMessagesParams;\n  isStoryReply?: boolean;\n  suggestedMedia?: MediaContent;\n};\n\nexport type ForwardedLocalMessagesSlice = {\n  messageIds: number[];\n  localMessages: ApiMessage[];\n};\n\nexport type ForwardMessagesParams = {\n  fromChat: ApiChat;\n  toChat: ApiChat;\n  toThreadId?: ThreadId;\n  messages: ApiMessage[];\n  isSilent?: boolean;\n  scheduledAt?: number;\n  scheduleRepeatPeriod?: number;\n  sendAs?: ApiPeer;\n  withMyScore?: boolean;\n  noAuthors?: boolean;\n  noCaptions?: boolean;\n  isCurrentUserPremium?: boolean;\n  wasDrafted?: boolean;\n  lastMessageId?: number;\n  forwardedLocalMessagesSlice?: ForwardedLocalMessagesSlice;\n  messagePriceInStars?: number;\n  effectId?: string;\n};\n","import blue from '../assets/icons/forumTopic/blue.svg';\nimport green from '../assets/icons/forumTopic/green.svg';\nimport grey from '../assets/icons/forumTopic/grey.svg';\nimport red from '../assets/icons/forumTopic/red.svg';\nimport rose from '../assets/icons/forumTopic/rose.svg';\nimport violet from '../assets/icons/forumTopic/violet.svg';\nimport yellow from '../assets/icons/forumTopic/yellow.svg';\n\n// https://github.com/telegramdesktop/tdesktop/blob/1aece79a471d99a8b63d826b1bce1f36a04d7293/Telegram/SourceFiles/data/data_forum_topic.cpp#L50\nconst TOPIC_MAPPING: Record<number, [string, string]> = {\n  0x6FB9F0: [blue, 'blue'],\n  0xFFD67E: [yellow, 'yellow'],\n  0xCB86DB: [violet, 'violet'],\n  0x8EEE98: [green, 'green'],\n  0xFF93B2: [rose, 'rose'],\n  0xFB6F5F: [red, 'red'],\n};\n\nexport function getTopicColors() {\n  return Object.keys(TOPIC_MAPPING).map((key) => parseInt(key, 10));\n}\n\nexport function getTopicDefaultIcon(iconColor?: number) {\n  return (iconColor && TOPIC_MAPPING[iconColor][0]) || grey;\n}\n\nexport function getTopicColorCssVariable(iconColor?: number) {\n  const color = (iconColor && TOPIC_MAPPING[iconColor][1]) || 'grey';\n  return `--color-topic-${color}`;\n}\n","import type {\n  ApiAvailableReaction,\n  ApiChatReactions,\n  ApiMessage,\n  ApiReactionCount,\n  ApiReactionKey,\n  ApiReactions,\n  ApiReactionWithPaid,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nexport function getMessageRecentReaction(message: Partial<ApiMessage>) {\n  return message.isOutgoing ? message.reactions?.recentReactions?.[0] : undefined;\n}\nexport function checkIfHasUnreadReactions(global: GlobalState, reactions: ApiReactions) {\n  const { currentUserId } = global;\n  return reactions?.recentReactions?.some(\n    ({ isUnread, isOwn, peerId }) => isUnread && !isOwn && currentUserId !== peerId,\n  );\n}\n\nexport function areReactionsEmpty(reactions: ApiReactions) {\n  return !reactions.results.some(({ count, localAmount }) => count || localAmount);\n}\n\nexport function getReactionKey(reaction: ApiReactionWithPaid): ApiReactionKey {\n  switch (reaction.type) {\n    case 'emoji':\n      return `emoji-${reaction.emoticon}`;\n    case 'custom':\n      return `document-${reaction.documentId}`;\n    case 'paid':\n      return 'paid';\n    default: {\n      // Legacy reactions\n      const uniqueValue = (reaction as any).emoticon || (reaction as any).documentId;\n      return `unsupported-${uniqueValue}`;\n    }\n  }\n}\n\nexport function isSameReaction(first?: ApiReactionWithPaid, second?: ApiReactionWithPaid) {\n  if (first === second) {\n    return true;\n  }\n\n  if (!first || !second) {\n    return false;\n  }\n\n  return getReactionKey(first) === getReactionKey(second);\n}\n\nexport function canSendReaction(reaction: ApiReactionWithPaid, chatReactions: ApiChatReactions) {\n  if (chatReactions.type === 'all') {\n    return reaction.type === 'emoji' || chatReactions.areCustomAllowed;\n  }\n\n  if (chatReactions.type === 'some') {\n    return chatReactions.allowed.some((r) => isSameReaction(r, reaction));\n  }\n\n  return false;\n}\n\nexport function sortReactions<T extends ApiAvailableReaction | ApiReactionWithPaid>(\n  reactions: T[],\n  topReactions?: ApiReactionWithPaid[],\n): T[] {\n  return reactions.slice().sort((left, right) => {\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion -- TS Bug?\n    const reactionOne = left ? ('reaction' in left ? left.reaction : left as ApiReactionWithPaid) : undefined;\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion -- TS Bug?\n    const reactionTwo = right ? ('reaction' in right ? right.reaction : right as ApiReactionWithPaid) : undefined;\n\n    if (reactionOne?.type === 'paid') return -1;\n    if (reactionTwo?.type === 'paid') return 1;\n\n    const indexOne = topReactions?.findIndex((reaction) => isSameReaction(reaction, reactionOne)) || 0;\n    const indexTwo = topReactions?.findIndex((reaction) => isSameReaction(reaction, reactionTwo)) || 0;\n    return (\n      (indexOne > -1 ? indexOne : Infinity) - (indexTwo > -1 ? indexTwo : Infinity)\n    );\n  });\n}\n\nexport function getUserReactions(message: ApiMessage): ApiReactionWithPaid[] {\n  return message.reactions?.results?.filter((r): r is Required<ApiReactionCount> => isReactionChosen(r))\n    .sort((a, b) => a.chosenOrder - b.chosenOrder)\n    .map((r) => r.reaction) || [];\n}\n\nexport function isReactionChosen(reaction: ApiReactionCount) {\n  return reaction.chosenOrder !== undefined;\n}\n\nexport function updateReactionCount(reactionCount: ApiReactionCount[], newReactions: ApiReactionWithPaid[]) {\n  const results = reactionCount.map((current) => (\n    isReactionChosen(current) ? {\n      ...current,\n      chosenOrder: undefined,\n      count: current.count - 1,\n    } : current\n  )).filter(({ count }) => count > 0);\n\n  newReactions.forEach((reaction, i) => {\n    const existingIndex = results.findIndex((r) => isSameReaction(r.reaction, reaction));\n    if (existingIndex > -1) {\n      results[existingIndex] = {\n        ...results[existingIndex],\n        chosenOrder: i,\n        count: results[existingIndex].count + 1,\n      };\n    } else {\n      results.push({\n        reaction,\n        chosenOrder: i,\n        count: 1,\n      });\n    }\n  });\n\n  return results;\n}\n\nexport function addPaidReaction(\n  reactionCount: ApiReactionCount[], count: number, isAnonymous?: boolean, peerId?: string,\n): ApiReactionCount[] {\n  const results: ApiReactionCount[] = [];\n  const hasPaid = reactionCount.some((current) => current.reaction.type === 'paid');\n  if (hasPaid) {\n    reactionCount.forEach((current) => {\n      if (current.reaction.type === 'paid') {\n        results.push({\n          ...current,\n          localAmount: (current.localAmount || 0) + count,\n          chosenOrder: -1,\n          localIsPrivate: isAnonymous !== undefined ? isAnonymous : current.localIsPrivate,\n          localPeerId: peerId || current.localPeerId,\n          localPreviousChosenOrder: current.chosenOrder,\n        });\n        return;\n      }\n\n      results.push(current);\n    });\n\n    return results;\n  }\n\n  return [\n    {\n      reaction: { type: 'paid' },\n      count: 0,\n      chosenOrder: -1,\n      localAmount: count,\n      localIsPrivate: isAnonymous,\n      localPeerId: peerId,\n    },\n    ...reactionCount,\n  ];\n}\n","import type { ApiStory, ApiVideo } from '../../api/types';\n\nimport { getPhotoMediaHash, getVideoMediaHash } from './messageMedia';\n\ntype StorySize = 'pictogram' | 'preview' | 'full' | 'download';\nconst STORY_ALT_VIDEO_WIDTH = 480;\n\nexport function getStoryMediaHash(\n  story: ApiStory, size: StorySize, isAlt: true,\n): string | undefined;\nexport function getStoryMediaHash(story: ApiStory): string;\nexport function getStoryMediaHash(story: ApiStory, size: StorySize): string;\nexport function getStoryMediaHash(\n  story: ApiStory, size: StorySize = 'preview', isAlt?: boolean,\n) {\n  const isVideo = Boolean(story.content.video);\n  const isPhoto = Boolean(story.content.photo);\n\n  if (isVideo) {\n    if (isAlt && !story.content.altVideos) return undefined;\n    const media = isAlt ? getPreferredAlt(story.content.altVideos!) : story.content.video!;\n    return getVideoMediaHash(media, size);\n  }\n\n  if (isPhoto) {\n    return getPhotoMediaHash(story.content.photo!, size);\n  }\n\n  return undefined;\n}\n\nfunction getPreferredAlt(alts: ApiVideo[]) {\n  const alt = alts.reduce((prev, curr) => (\n    Math.abs((curr.width || 0) - STORY_ALT_VIDEO_WIDTH) < Math.abs((prev.width || 0) - STORY_ALT_VIDEO_WIDTH)\n      ? curr : prev\n  ));\n  return alt;\n}\n\nexport function getStoryKey(chatId: string, storyId: number) {\n  return `story${chatId}-${storyId}`;\n}\n","import type {\n  ApiInputPrivacyRules,\n  BotsPrivacyType,\n  PrivacyVisibility,\n} from '../../api/types';\nimport type { GlobalState } from '../types';\n\nimport { isUserId } from '../../util/entities/ids';\nimport { partition } from '../../util/iteratees';\nimport { clamp } from '../../util/math';\nimport { getAccountsInfo } from '../../util/multiaccount';\nimport { DEFAULT_LIMITS } from '../../limits';\nimport { getGlobal } from '..';\n\nexport function buildApiInputPrivacyRules(global: GlobalState, {\n  visibility,\n  isUnspecified,\n  allowedIds,\n  blockedIds,\n  shouldAllowPremium,\n  botsPrivacy,\n}: {\n  visibility: PrivacyVisibility;\n  isUnspecified?: boolean;\n  allowedIds: string[];\n  blockedIds: string[];\n  shouldAllowPremium?: true;\n  botsPrivacy: BotsPrivacyType;\n}): ApiInputPrivacyRules {\n  const {\n    users: { byId: usersById },\n    chats: { byId: chatsById },\n  } = global;\n\n  const [allowedUserIds, allowedChatIds] = partition(allowedIds, isUserId);\n  const [blockedUserIds, blockedChatIds] = partition(blockedIds, isUserId);\n\n  const rules: ApiInputPrivacyRules = {\n    visibility,\n    isUnspecified,\n    allowedUsers: allowedUserIds.map((userId) => usersById[userId]).filter(Boolean),\n    allowedChats: allowedChatIds.map((chatId) => chatsById[chatId]).filter(Boolean),\n    blockedUsers: blockedUserIds.map((userId) => usersById[userId]).filter(Boolean),\n    blockedChats: blockedChatIds.map((chatId) => chatsById[chatId]).filter(Boolean),\n    shouldAllowPremium,\n    botsPrivacy,\n  };\n\n  return rules;\n}\n\nexport function getCurrentMaxAccountCount() {\n  const global = getGlobal();\n  const limit = global.appConfig.limits?.moreAccounts || DEFAULT_LIMITS.moreAccounts;\n  const accounts = getAccountsInfo();\n  const premiumCount = Object.values(accounts).filter((account) => account.isPremium).length;\n  // Each premium account increases the base limit by 1, up to the maximum limit.\n  const currentMaxCount = limit[0] + premiumCount;\n  return clamp(currentMaxCount, limit[0], limit[1]);\n}\n\nexport function getCurrentProdAccountCount() {\n  return Object.values(getAccountsInfo()).filter((account) => !account.isTest).length;\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { isUserId } from '../../util/entities/ids';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport {\n  getCanAddContact,\n  isAnonymousForwardsChat,\n  isChatAdmin, isChatGroup, isUserBot,\n} from '../helpers';\nimport { selectChat, selectIsChatRestricted, selectIsChatWithSelf } from './chats';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\nimport { selectBot, selectUser } from './users';\n\nexport function selectManagement<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).management.byChatId[chatId];\n}\n\nexport function selectCurrentManagement<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const currentManagement = selectTabState(global, tabId).management.byChatId[chatId];\n  if (!currentManagement?.isActive) {\n    return undefined;\n  }\n\n  return currentManagement;\n}\n\nexport function selectCurrentManagementType<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatBot = selectBot(global, chatId);\n  if (chatBot) {\n    return 'bot';\n  }\n\n  if (isUserId(chatId)) {\n    return 'user';\n  }\n\n  const chat = selectChat(global, chatId);\n  if (!chat) {\n    return undefined;\n  }\n\n  if (isChatGroup(chat)) {\n    return 'group';\n  }\n\n  return 'channel';\n}\n\nexport function selectCanManage<T extends GlobalState>(\n  global: T,\n  chatId: string,\n) {\n  const chat = selectChat(global, chatId);\n  const isRestricted = selectIsChatRestricted(global, chatId);\n  if (!chat || isRestricted || chat.isMonoforum) return false;\n\n  const isPrivate = isUserId(chat.id);\n  const user = isPrivate ? selectUser(global, chatId) : undefined;\n  const canAddContact = user && getCanAddContact(user);\n\n  const isBot = user && isUserBot(user);\n  return Boolean(\n    !canAddContact\n    && chat\n    && !selectIsChatWithSelf(global, chat.id)\n    && !isAnonymousForwardsChat(chat.id)\n    // chat.isCreator is for Basic Groups\n    && (isUserId(chat.id) || ((isChatAdmin(chat) || chat.isCreator) && !chat.isNotJoined))\n    && !isBot,\n  );\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectChatFullInfo } from './chats';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\n\nexport function selectStatistics<T extends GlobalState>(\n  global: T, chatId: string,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).statistics.byChatId[chatId];\n}\n\nexport function selectIsStatisticsShown<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (!selectTabState(global, tabId).isStatisticsShown) {\n    return false;\n  }\n\n  const { chatId: currentChatId } = selectCurrentMessageList(global, tabId) || {};\n\n  return currentChatId ? selectChatFullInfo(global, currentChatId)?.canViewStatistics : undefined;\n}\n","import type { ApiMessage, ApiPeer, ApiSponsoredMessage } from '../../api/types';\nimport type { CustomPeer, PerformanceTypeKey, ThemeKey } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\nimport { NewChatMembersProgress, RightColumnContent } from '../../types';\n\nimport { IS_SNAP_EFFECT_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { getMessageVideo, getWebPageVideo } from '../helpers/messageMedia';\nimport { selectCurrentManagement } from './management';\nimport { selectWebPageFromMessage } from './messages';\nimport { selectSharedSettings } from './sharedState';\nimport { selectIsStatisticsShown } from './statistics';\nimport { selectTabState } from './tabs';\n\nexport function selectIsMediaViewerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const {\n    mediaViewer: {\n      chatId,\n      messageId,\n      isAvatarView,\n      standaloneMedia,\n      isSponsoredMessage,\n    },\n  } = selectTabState(global, tabId);\n  return Boolean(standaloneMedia || (chatId && (isAvatarView || messageId || isSponsoredMessage)));\n}\n\nexport function selectRightColumnContentKey<T extends GlobalState>(\n  global: T,\n  isMobile?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  return tabState.editTopicPanel ? (\n    RightColumnContent.EditTopic\n  ) : tabState.createTopicPanel ? (\n    RightColumnContent.CreateTopic\n  ) : tabState.pollResults.messageId ? (\n    RightColumnContent.PollResults\n  ) : selectCurrentManagement(global, tabId) ? (\n    RightColumnContent.Management\n  ) : tabState.isStatisticsShown && tabState.statistics.currentMessageId ? (\n    RightColumnContent.MessageStatistics\n  ) : tabState.isStatisticsShown && tabState.statistics.currentStoryId ? (\n    RightColumnContent.StoryStatistics\n  ) : selectIsStatisticsShown(global, tabId) ? (\n    RightColumnContent.Statistics\n  ) : tabState.boostStatistics ? (\n    RightColumnContent.BoostStatistics\n  ) : tabState.monetizationStatistics ? (\n    RightColumnContent.MonetizationStatistics\n  ) : tabState.stickerSearch.query !== undefined ? (\n    RightColumnContent.StickerSearch\n  ) : tabState.gifSearch.query !== undefined ? (\n    RightColumnContent.GifSearch\n  ) : tabState.newChatMembersProgress !== NewChatMembersProgress.Closed ? (\n    RightColumnContent.AddingMembers\n  ) : tabState.agentChat.isOpen ? (\n    RightColumnContent.AgentChat\n  ) : tabState.threadHistory.isOpen ? (\n    RightColumnContent.ThreadHistory\n  ) : tabState.chatInfo.isOpen && tabState.messageLists.length ? (\n    RightColumnContent.ChatInfo\n  ) : undefined;\n}\n\nexport function selectIsRightColumnShown<T extends GlobalState>(\n  global: T,\n  isMobile?: boolean,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectRightColumnContentKey(global, isMobile, tabId) !== undefined;\n}\n\nexport function selectTheme<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).theme;\n}\n\nexport function selectThemeValues<T extends GlobalState>(global: T, themeKey: ThemeKey) {\n  return global.settings.themes[themeKey];\n}\n\nexport function selectActionMessageBg<T extends GlobalState>(global: T) {\n  const theme = selectTheme(global);\n  return global.settings.themes[theme]?.patternColor;\n}\n\nexport function selectIsForumPanelOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  return Boolean(tabState.forumPanelChatId) && (\n    tabState.globalSearch.query === undefined || Boolean(tabState.globalSearch.isClosing)\n  );\n}\n\nexport function selectIsForumPanelClosed<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return !selectIsForumPanelOpen(global, tabId);\n}\n\nexport function selectIsReactionPickerOpen<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { reactionPicker } = selectTabState(global, tabId);\n  return Boolean(reactionPicker?.position);\n}\n\nexport function selectPerformanceSettings<T extends GlobalState>(global: T) {\n  return selectSharedSettings(global).performance;\n}\n\nexport function selectPerformanceSettingsValue<T extends GlobalState>(\n  global: T,\n  key: PerformanceTypeKey,\n) {\n  return selectPerformanceSettings(global)[key];\n}\n\nexport function selectCanAutoPlayMedia<T extends GlobalState>(global: T, message: ApiMessage | ApiSponsoredMessage) {\n  const webPage = selectWebPageFromMessage(global, message);\n  const video = getMessageVideo(message) || getWebPageVideo(webPage);\n  if (!video) {\n    return undefined;\n  }\n\n  const canAutoPlayVideos = selectPerformanceSettingsValue(global, 'autoplayVideos');\n  const canAutoPlayGifs = selectPerformanceSettingsValue(global, 'autoplayGifs');\n\n  const asGif = video.isGif || video.isRound;\n\n  return (canAutoPlayVideos && !asGif) || (canAutoPlayGifs && asGif);\n}\n\nexport function selectShouldLoopStickers<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'loopAnimatedStickers');\n}\n\nexport function selectCanPlayAnimatedEmojis<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'animatedEmoji');\n}\n\nexport function selectCanAnimateInterface<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'pageTransitions');\n}\n\nexport function selectCanAnimateRightColumn<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'rightColumnAnimations');\n}\n\nexport function selectCanAnimateSnapEffect<T extends GlobalState>(global: T) {\n  return IS_SNAP_EFFECT_SUPPORTED && selectPerformanceSettingsValue(global, 'snapEffect');\n}\n\nexport function selectIsContextMenuTranslucent<T extends GlobalState>(global: T) {\n  return selectPerformanceSettingsValue(global, 'contextMenuBlur');\n}\n\nexport function selectIsSynced<T extends GlobalState>(global: T) {\n  return global.isSynced;\n}\n\nexport function selectWebApp<T extends GlobalState>(\n  global: T, key: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).webApps.openedWebApps[key];\n}\n\nexport function selectActiveWebApp<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const activeWebAppKey = selectTabState(global, tabId).webApps.activeWebAppKey;\n  if (!activeWebAppKey) return undefined;\n\n  return selectWebApp(global, activeWebAppKey, tabId);\n}\n\nexport function selectLeftColumnContentKey<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).leftColumn.contentKey;\n}\n\nexport function selectSettingsScreen<T extends GlobalState>(\n  global: T, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).leftColumn.settingsScreen;\n}\n\nexport function selectPeerProfileColor<T extends GlobalState>(global: T, peer: ApiPeer | CustomPeer) {\n  const isCustomPeer = 'isCustomPeer' in peer;\n  const peerColorId = isCustomPeer ? peer.peerColorId : undefined;\n  const profileColor = !isCustomPeer ? peer.profileColor : undefined;\n  if (profileColor?.type === 'collectible') return undefined;\n\n  const key = profileColor?.color ?? peerColorId;\n  if (key === undefined) return undefined;\n  return global.peerColors?.profile?.[key];\n}\n","import type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentGlobalSearchQuery<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  return selectTabState(global, tabId).globalSearch.query;\n}\n","import type { ApiDocument } from '../../../api/types';\n\nexport function getDocumentExtension(document: ApiDocument) {\n  const { fileName, mimeType } = document;\n\n  return getFileExtension(fileName, mimeType);\n}\n\nexport function getFileExtension(fileName: string, mimeType: string) {\n  if (fileName && fileName.indexOf('.') !== -1) {\n    return fileName.split('.').pop();\n  } else {\n    return mimeType.split('/').pop();\n  }\n}\n\nexport function getColorFromExtension(extension: string) {\n  switch (extension) {\n    case 'apk':\n    case 'xls':\n    case 'xlsx':\n    case 'ods':\n      return 'green';\n    case 'zip':\n    case 'rar':\n    case '7z':\n    case 'tar':\n    case 'gz':\n    case 'bz2':\n    case 'liz':\n    case 'lz4':\n    case 'lz5':\n    case 'xz':\n    case 'zst':\n    case 'wim':\n    case 'ppt':\n    case 'pptx':\n    case 'odp':\n      return 'orange';\n    case 'pdf':\n    case 'xps':\n      return 'red';\n    default:\n      return 'default';\n  }\n}\n\nexport function getDocumentHasPreview(document: ApiDocument) {\n  return Boolean(document.previewBlobUrl || document.thumbnail);\n}\n","export default function calcTextLineHeightAndCount(textContainer: HTMLElement) {\n  const lineHeight = parseInt(getComputedStyle(textContainer).lineHeight, 10);\n\n  const totalLines = textContainer.scrollHeight / lineHeight;\n\n  return {\n    totalLines,\n    lineHeight,\n  };\n}\n","import { type ElementRef, useEffect } from '../lib/teact/teact';\n\nimport type { CallbackManager } from '../util/callbacks';\n\nimport { createCallbackManager } from '../util/callbacks';\nimport { useStateRef } from './useStateRef';\n\nconst elementObserverMap = new Map<HTMLElement, [ResizeObserver, CallbackManager]>();\n\nexport default function useResizeObserver(\n  ref: ElementRef<HTMLElement> | undefined,\n  onResize: (entry: ResizeObserverEntry) => void,\n  isDisabled = false,\n) {\n  const onResizeRef = useStateRef(onResize);\n\n  useEffect(() => {\n    const el = ref?.current;\n    if (!el || isDisabled) {\n      return undefined;\n    }\n\n    const callback: ResizeObserverCallback = ([entry]) => {\n      // Ignore updates when element is not properly mounted (`display: none`)\n      if (entry.contentRect.width === 0 && entry.contentRect.height === 0) {\n        return;\n      }\n\n      onResizeRef.current(entry);\n    };\n\n    let [observer, callbackManager] = elementObserverMap.get(el) || [undefined, undefined];\n    if (!observer) {\n      callbackManager = createCallbackManager();\n      observer = new ResizeObserver(callbackManager.runCallbacks);\n      elementObserverMap.set(el, [observer, callbackManager]);\n      observer.observe(el);\n    }\n    callbackManager!.addCallback(callback);\n\n    return () => {\n      callbackManager!.removeCallback(callback);\n      if (!callbackManager!.hasCallbacks()) {\n        observer.unobserve(el);\n        observer.disconnect();\n        elementObserverMap.delete(el);\n      }\n    };\n  }, [isDisabled, onResizeRef, ref]);\n}\n","import { useEffect, useState } from '../lib/teact/teact';\nimport { getGlobal } from '../global';\n\nimport type { ApiUser } from '../api/types';\n\nimport { SESSION_ACCOUNT_PREFIX } from '../config';\nimport { getChatAvatarHash } from '../global/helpers';\nimport { selectIsSynced } from '../global/selectors';\nimport { preloadImage } from '../util/files';\nimport { resizeImage } from '../util/imageResize';\nimport { ACCOUNT_SLOT, getAccountsInfo, storeAccountData } from '../util/multiaccount';\nimport useSelector from './data/useSelector';\nimport useInterval from './schedulers/useInterval';\nimport useLastCallback from './useLastCallback';\nimport useMedia from './useMedia';\nimport useThrottledCallback from './useThrottledCallback';\n\nconst LOCAL_STORAGE_LISTENING_THROTTLE = 1000;\nconst REFRESH_INTERVAL = 1000 * 60;\nconst PREVIEW_SIZE = 72;\n\nexport default function useMultiaccountInfo(currentUser?: ApiUser) {\n  const isUpdater = Boolean(currentUser) && getGlobal().auth.rememberMe;\n  const isSynced = useSelector(selectIsSynced);\n\n  const [accountsInfo, setAccountsInfo] = useState(() => getAccountsInfo());\n\n  const avatarHash = currentUser && getChatAvatarHash(currentUser);\n  const avatarUrl = useMedia(avatarHash, !isUpdater);\n\n  const refresh = useThrottledCallback(() => {\n    setAccountsInfo(getAccountsInfo());\n  }, [], LOCAL_STORAGE_LISTENING_THROTTLE);\n\n  useEffect(() => {\n    if (!isUpdater || !isSynced) return;\n    const color = currentUser.color?.type === 'regular' ? currentUser.color.color : undefined;\n    storeAccountData(ACCOUNT_SLOT, {\n      userId: currentUser.id,\n      firstName: currentUser.firstName,\n      lastName: currentUser.lastName,\n      emojiStatusId: currentUser.emojiStatus?.documentId,\n      color,\n      isPremium: currentUser.isPremium,\n      phone: currentUser.phoneNumber,\n    });\n\n    refresh();\n  }, [\n    isUpdater, currentUser?.emojiStatus?.documentId, currentUser?.firstName, currentUser?.id, currentUser?.lastName,\n    currentUser?.color, currentUser?.isPremium, currentUser?.phoneNumber, refresh, isSynced,\n  ]);\n\n  const updateAvatar = useLastCallback(async (url: string, abortSignal?: AbortSignal) => {\n    const resizedAvatar = await resizeImage(url, PREVIEW_SIZE, PREVIEW_SIZE);\n    const img = await preloadImage(resizedAvatar);\n    if (abortSignal?.aborted) return;\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d')!;\n    canvas.width = img.width;\n    canvas.height = img.height;\n    ctx.drawImage(img, 0, 0);\n    const dataUrl = canvas.toDataURL('image/png');\n    storeAccountData(ACCOUNT_SLOT, { avatarUri: dataUrl });\n\n    refresh();\n  });\n\n  useEffect(() => {\n    if (!avatarUrl || !isUpdater || !isSynced) return undefined;\n    const controller = new AbortController();\n    updateAvatar(avatarUrl, controller.signal);\n\n    return () => {\n      controller.abort();\n    };\n  }, [avatarUrl, isSynced, isUpdater]);\n\n  // Storage event only thrown when other tabs change the storage\n  useInterval(refresh, REFRESH_INTERVAL);\n  useEffect(() => {\n    function handleStorageChange(e: StorageEvent) {\n      if (!e.key?.startsWith(SESSION_ACCOUNT_PREFIX)) return;\n      refresh();\n    }\n\n    window.addEventListener('storage', handleStorageChange);\n\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n    };\n  }, [refresh]);\n\n  return accountsInfo;\n}\n","import type { ThreadId } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { buildChatThreadKey } from '../helpers/middleSearch';\nimport { selectCurrentMessageList } from './messages';\nimport { selectTabState } from './tabs';\n\nexport function selectCurrentMiddleSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).middleSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectCurrentSharedMediaSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).sharedMediaSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectCurrentChatMediaSearch<T extends GlobalState>(\n  global: T,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const { chatId, threadId } = selectCurrentMessageList(global, tabId) || {};\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n}\n\nexport function selectChatMediaSearch<T extends GlobalState>(\n  global: T, chatId?: string, threadId?: ThreadId,\n  ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  if (!chatId || !threadId) {\n    return undefined;\n  }\n\n  const chatThreadKey = buildChatThreadKey(chatId, threadId);\n\n  return selectTabState(global, tabId).chatMediaSearch.byChatThreadKey[chatThreadKey];\n}\n","import type {\n  ElementRef } from '../lib/teact/teact';\nimport {\n  useEffect, useMemo, useState,\n} from '../lib/teact/teact';\n\nimport { round } from '../util/math';\nimport getOffsetToContainer from '../util/visibility/getOffsetToContainer';\nimport useLastCallback from './useLastCallback';\nimport useResizeObserver from './useResizeObserver';\nimport useSharedIntersectionObserver from './useSharedIntersectionObserver';\nimport useThrottledCallback from './useThrottledCallback';\n\nconst THROTTLE_MS = 150;\n\nexport default function useCoordsInSharedCanvas(\n  containerRef: ElementRef<HTMLDivElement>,\n  sharedCanvasRef?: ElementRef<HTMLCanvasElement>,\n) {\n  const [x, setX] = useState<number>();\n  const [y, setY] = useState<number>();\n\n  const recalculate = useLastCallback(() => {\n    const container = containerRef.current;\n    const canvas = sharedCanvasRef?.current;\n    if (!container || !canvas) {\n      return;\n    }\n\n    // Wait until elements are properly mounted\n    if (!canvas.offsetWidth || !canvas.offsetHeight) {\n      return;\n    }\n\n    const target = container.classList.contains('sticker-set-cover') || container.classList.contains('sticker-reaction')\n      ? container\n      : container.querySelector('img')!;\n    if (!target) {\n      return;\n    }\n\n    const { left: targetLeftOffset, top: targetTopOffset } = getOffsetToContainer(target, canvas.parentElement!);\n    const { left: canvasLeftOffset, top: canvasTopOffset } = getOffsetToContainer(canvas, canvas.parentElement!);\n\n    const left = targetLeftOffset - canvasLeftOffset;\n    const top = targetTopOffset - canvasTopOffset;\n\n    // Factor coords are used to support rendering while being rescaled (e.g. message appearance animation)\n    setX(round(left / canvas.clientWidth, 4) || 0);\n    setY(round(top / canvas.clientHeight, 4) || 0);\n  });\n\n  useEffect(recalculate, [recalculate]);\n\n  const throttledRecalculate = useThrottledCallback(recalculate, [recalculate], THROTTLE_MS);\n  useResizeObserver(sharedCanvasRef, throttledRecalculate);\n  useSharedIntersectionObserver(sharedCanvasRef, throttledRecalculate);\n\n  return useMemo(() => (x !== undefined && y !== undefined ? { x, y } : undefined), [x, y]);\n}\n","import { isLiteralObject, unique } from './iteratees';\n\nconst EQUAL = Symbol('EQUAL');\nconst DELETE = { __delete: true };\nconst DELETE_ALL_CHILDREN = { __deleteAllChildren: true };\n\ntype NestedDiff<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> | typeof DELETE_ALL_CHILDREN | typeof DELETE | null } : T;\n\nexport type DiffObject<T> = T extends object\n  ? { [K in keyof T]?: NestedDiff<T[K]> } | typeof DELETE_ALL_CHILDREN\n  : T;\n\nexport function deepDiff<T>(value1: T, value2: T): Partial<T> | typeof EQUAL | typeof DELETE_ALL_CHILDREN {\n  if (value1 === value2) {\n    return EQUAL;\n  }\n\n  const type1 = typeof value1;\n  const type2 = typeof value2;\n\n  if (type1 !== type2) {\n    return value2;\n  }\n\n  if (Array.isArray(value1) && Array.isArray(value2) && areSortedArraysDeepEqual(value1, value2)) {\n    return EQUAL;\n  }\n\n  if (!isLiteralObject(value1) || !isLiteralObject(value2)) {\n    return value2;\n  }\n\n  const object1 = value1 as AnyLiteral;\n  const object2 = value2 as AnyLiteral;\n  const keys1 = Object.keys(object1);\n  const keys2 = Object.keys(object2);\n\n  if (!keys2.length) {\n    return !keys1.length ? EQUAL : DELETE_ALL_CHILDREN;\n  }\n\n  const allKeys = unique(keys1.concat(keys2));\n\n  const diff = allKeys.reduce((acc: any, key) => {\n    const subValue1 = object1[key];\n    const subValue2 = object2[key];\n\n    if (!object2.hasOwnProperty(key)) {\n      acc[key] = DELETE;\n      return acc;\n    }\n\n    if (!object1.hasOwnProperty(key)) {\n      acc[key] = subValue2;\n      return acc;\n    }\n\n    const subDiff = deepDiff(subValue1, subValue2);\n    if (subDiff !== EQUAL) {\n      acc[key] = subDiff;\n    }\n\n    return acc;\n  }, {});\n\n  if (Object.keys(diff).length === 0) {\n    return EQUAL;\n  }\n\n  return diff;\n}\n\nfunction areSortedArraysDeepEqual<T extends Array<any>>(array1: T, array2: T) {\n  if (array1.length !== array2.length) {\n    return false;\n  }\n\n  return array1.every((item, i) => deepDiff(item, array2[i]) === EQUAL);\n}\n","import type { ApiFormattedText } from '../../api/types';\nimport type { TranslatedMessage } from '../../types';\nimport type { GlobalState, TabArgs } from '../types';\n\nimport { getCurrentTabId } from '../../util/establishMultitabRole';\nimport { omit } from '../../util/iteratees';\nimport { selectMessageTranslations, selectTabState } from '../selectors';\nimport { updateTabState } from './tabs';\n\nexport function updateMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, toLanguageCode: string, translation: Partial<TranslatedMessage>,\n) {\n  const translatedMessages = selectMessageTranslations(global, chatId, toLanguageCode);\n\n  return {\n    ...global,\n    translations: {\n      ...global.translations,\n      byChatId: {\n        ...global.translations.byChatId,\n        [chatId]: {\n          ...global.translations.byChatId[chatId],\n          byLangCode: {\n            ...global.translations.byChatId[chatId]?.byLangCode,\n            [toLanguageCode]: {\n              ...translatedMessages,\n              [messageId]: {\n                ...translatedMessages[messageId],\n                ...translation,\n              },\n            },\n          },\n        },\n      },\n    },\n  };\n}\n\nexport function clearMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number,\n) {\n  const chatTranslations = global.translations.byChatId[chatId];\n  if (!chatTranslations) return global;\n\n  const { byLangCode } = chatTranslations;\n  const newByLangCode = Object.keys(byLangCode).reduce((acc, langCode) => {\n    const newTranslatedMessages = omit(byLangCode[langCode], [messageId]);\n    if (Object.keys(newTranslatedMessages).length) {\n      acc[langCode] = newTranslatedMessages;\n    }\n\n    return acc;\n  }, {} as Record<string, Record<number, TranslatedMessage>>);\n\n  return {\n    ...global,\n    translations: {\n      ...global.translations,\n      byChatId: {\n        ...global.translations.byChatId,\n        [chatId]: {\n          ...chatTranslations,\n          byLangCode: newByLangCode,\n        },\n      },\n    },\n  };\n}\n\nexport function updateMessageTranslations<T extends GlobalState>(\n  global: T, chatId: string, messageIds: number[], toLanguageCode: string, translations: ApiFormattedText[],\n) {\n  messageIds.forEach((messageId, index) => {\n    global = updateMessageTranslation(global, chatId, messageId, toLanguageCode, {\n      text: translations[index],\n      isPending: false,\n    });\n  });\n\n  return global;\n}\n\nexport function updateRequestedChatTranslation<T extends GlobalState>(\n  global: T, chatId: string, toLanguageCode?: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          toLanguage: toLanguageCode,\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function removeRequestedChatTranslation<T extends GlobalState>(\n  global: T, chatId: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: omit(tabState.requestedTranslations.byChatId, [chatId]),\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function updateRequestedMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, toLanguageCode: string, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          ...tabState.requestedTranslations.byChatId[chatId],\n          manualMessages: {\n            ...tabState.requestedTranslations.byChatId[chatId]?.manualMessages,\n            [messageId]: toLanguageCode,\n          },\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n\nexport function removeRequestedMessageTranslation<T extends GlobalState>(\n  global: T, chatId: string, messageId: number, ...[tabId = getCurrentTabId()]: TabArgs<T>\n) {\n  const tabState = selectTabState(global, tabId);\n\n  const manualMessages = tabState.requestedTranslations.byChatId[chatId]?.manualMessages;\n  if (!manualMessages) return global;\n\n  const newManualMessages = omit(manualMessages, [messageId]);\n\n  global = updateTabState(global, {\n    requestedTranslations: {\n      ...tabState.requestedTranslations,\n      byChatId: {\n        ...tabState.requestedTranslations.byChatId,\n        [chatId]: {\n          ...tabState.requestedTranslations.byChatId[chatId],\n          manualMessages: newManualMessages,\n        },\n      },\n    },\n  }, tabId);\n\n  return global;\n}\n","type Parts = (string | false | undefined)[];\n\nexport default function buildStyle(...parts: Parts) {\n  return parts.filter(Boolean).join(';');\n}\n","import { IS_TEST, PRODUCTION_HOSTNAME } from '../../config';\nimport { IS_TAURI } from './globalEnvironment';\n\nexport function getPlatform() {\n  const { userAgent, platform } = window.navigator;\n\n  const iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  if (\n    iosPlatforms.indexOf(platform) !== -1\n    // For new IPads with M1 chip and IPadOS platform returns \"MacIntel\"\n    || (platform === 'MacIntel' && ('maxTouchPoints' in navigator && navigator.maxTouchPoints > 2))\n  ) return 'iOS';\n\n  const macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  if (macosPlatforms.indexOf(platform) !== -1) return 'macOS';\n\n  const windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  if (windowsPlatforms.indexOf(platform) !== -1) return 'Windows';\n\n  if (/Android/.test(userAgent)) return 'Android';\n\n  if (/Linux/.test(platform)) return 'Linux';\n\n  return undefined;\n}\n\nexport const IS_PRODUCTION_HOST = window.location.host === PRODUCTION_HOSTNAME;\nexport const PLATFORM_ENV = getPlatform();\nexport const IS_MAC_OS = PLATFORM_ENV === 'macOS';\nexport const IS_WINDOWS = PLATFORM_ENV === 'Windows';\nexport const IS_LINUX = PLATFORM_ENV === 'Linux';\nexport const IS_IOS = PLATFORM_ENV === 'iOS';\nexport const IS_ANDROID = PLATFORM_ENV === 'Android';\nexport const IS_MOBILE = IS_IOS || IS_ANDROID;\nexport const IS_CHROMIUM = navigator.userAgentData?.brands.some((data) => data.brand === 'Chromium')\n  || /Chrom(e|ium)\\//.test(navigator.userAgent);\nexport const IS_SAFARI = !IS_CHROMIUM && /applewebkit/i.test(navigator.userAgent);\nexport const IS_YA_BROWSER = navigator.userAgent.includes('YaBrowser');\nexport const IS_FIREFOX = navigator.userAgent.toLowerCase().includes('firefox')\n  || navigator.userAgent.toLowerCase().includes('iceweasel')\n  || navigator.userAgent.toLowerCase().includes('icecat');\n\nexport const MouseButton = {\n  Main: 0,\n  Auxiliary: 1,\n  Secondary: 2,\n  Fourth: 3,\n  Fifth: 4,\n};\n\nexport const IS_PWA = (\n  window.matchMedia('(display-mode: standalone)').matches\n  || (window.navigator as any).standalone\n  || document.referrer.includes('android-app://')\n);\n\nexport const IS_APP = IS_PWA || IS_TAURI;\n\nexport const IS_TOUCH_ENV = window.matchMedia('(pointer: coarse)').matches;\nexport const IS_VOICE_RECORDING_SUPPORTED = Boolean(\n  window.navigator.mediaDevices && 'getUserMedia' in window.navigator.mediaDevices && (\n    window.AudioContext || (window as any).webkitAudioContext\n  ),\n);\nexport const IS_EMOJI_SUPPORTED = PLATFORM_ENV && (IS_MAC_OS || IS_IOS) && isLastEmojiVersionSupported();\n\nexport const IS_SERVICE_WORKER_SUPPORTED = 'serviceWorker' in navigator;\n\n// Remove in mid-late 2025 when Chromium 132 is no longer a problem\n// https://issues.chromium.org/issues/390581541\nconst chromeVersion = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./)?.[2];\nconst hasBrokenServiceWorkerStreaming = chromeVersion && Number(chromeVersion) === 132;\n// TODO Consider failed service worker\nexport const IS_PROGRESSIVE_SUPPORTED = IS_SERVICE_WORKER_SUPPORTED && !hasBrokenServiceWorkerStreaming;\nexport const IS_OPUS_SUPPORTED = Boolean((new Audio()).canPlayType('audio/ogg; codecs=opus'));\nexport const IS_CANVAS_FILTER_SUPPORTED = (\n  !IS_TEST && 'filter' in (document.createElement('canvas').getContext('2d') || {})\n);\nexport const IS_REQUEST_FULLSCREEN_SUPPORTED = 'requestFullscreen' in document.createElement('div');\nexport const ARE_CALLS_SUPPORTED = true;\n\nexport const IS_WAVE_TRANSFORM_SUPPORTED = !IS_MOBILE\n  && !IS_FIREFOX // https://bugzilla.mozilla.org/show_bug.cgi?id=1961378\n  && !IS_SAFARI; // https://bugs.webkit.org/show_bug.cgi?id=245510\nexport const IS_SNAP_EFFECT_SUPPORTED = !IS_MOBILE\n  && !IS_FIREFOX // https://bugzilla.mozilla.org/show_bug.cgi?id=1896504\n  && !IS_SAFARI;\nexport const IS_FLUID_BACKGROUND_SUPPORTED = !IS_FIREFOX;\n\nconst TEST_VIDEO = document.createElement('video');\n\nexport const IS_WEBM_SUPPORTED = Boolean(TEST_VIDEO.canPlayType('video/webm; codecs=\"vp9\"').replace('no', ''));\n\nexport const MASK_IMAGE_DISABLED = true;\nexport const IS_OPFS_SUPPORTED = Boolean(navigator.storage?.getDirectory);\nif (IS_OPFS_SUPPORTED) {\n  // Clear old contents\n  (async () => {\n    try {\n      const directory = await navigator.storage.getDirectory();\n      await directory.removeEntry('downloads', { recursive: true });\n    } catch {\n      // Ignore\n    }\n  })();\n}\n\nexport const IS_OFFSET_PATH_SUPPORTED = CSS.supports('offset-rotate: 0deg');\nexport const IS_BACKDROP_BLUR_SUPPORTED = CSS.supports('backdrop-filter: blur()')\n  || CSS.supports('-webkit-backdrop-filter: blur()');\nexport const IS_INSTALL_PROMPT_SUPPORTED = 'onbeforeinstallprompt' in window;\nexport const IS_OPEN_IN_NEW_TAB_SUPPORTED = !(IS_PWA && IS_MOBILE);\nexport const IS_TRANSLATION_SUPPORTED = !IS_TEST;\nexport const IS_TRANSLATION_DETECTOR_SUPPORTED = 'LanguageDetector' in window;\nexport const IS_VIEW_TRANSITION_SUPPORTED = CSS.supports('view-transition-class: test')\n  && !IS_FIREFOX; // https://bugzilla.mozilla.org/show_bug.cgi?id=1994547\nexport const IS_WEBAUTHN_SUPPORTED = navigator.credentials && window.PublicKeyCredential\n  && 'parseCreationOptionsFromJSON' in PublicKeyCredential;\n\nexport const MESSAGE_LIST_SENSITIVE_AREA = 750;\n\nexport const SCROLLBAR_WIDTH = (() => {\n  const el = document.createElement('div');\n  el.style.cssText = 'overflow:scroll; visibility:hidden; position:absolute;';\n  el.classList.add('custom-scroll');\n  document.body.appendChild(el);\n  const width = el.offsetWidth - el.clientWidth;\n  el.remove();\n\n  document.documentElement.style.setProperty('--scrollbar-width', `${width}px`);\n\n  return width;\n})();\n\nexport const MAX_BUFFER_SIZE = (IS_MOBILE ? 512 : 2000) * 1024 ** 2; // 512 OR 2000 MB\n\nfunction isLastEmojiVersionSupported() {\n  const ALLOWABLE_CALCULATION_ERROR_SIZE = 5;\n  const inlineEl = document.createElement('span');\n  inlineEl.classList.add('emoji-test-element');\n  document.body.appendChild(inlineEl);\n\n  inlineEl.innerText = ''; // Emoji from 16.0 version\n  const newEmojiWidth = inlineEl.offsetWidth;\n  inlineEl.innerText = ''; // Emoji from 1.0 version\n  const legacyEmojiWidth = inlineEl.offsetWidth;\n\n  document.body.removeChild(inlineEl);\n\n  return Math.abs(newEmojiWidth - legacyEmojiWidth) < ALLOWABLE_CALCULATION_ERROR_SIZE;\n}\n\nexport const IS_GEOLOCATION_SUPPORTED = 'geolocation' in navigator;\n\nexport const getGeolocationStatus = async () => {\n  try {\n    const permissionStatus = await navigator.permissions.query({ name: 'geolocation' });\n\n    if (permissionStatus.state === 'granted' || permissionStatus.state === 'prompt') {\n      const geolocation = await new Promise<GeolocationCoordinates>((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(\n          (position) => resolve(position.coords),\n          (error) => reject(error),\n        );\n      });\n      return { accessRequested: true, accessGranted: true, geolocation };\n    }\n    if (permissionStatus.state === 'denied') {\n      return { accessRequested: true, accessGranted: false };\n    }\n  } catch (error) {\n    return { accessRequested: false, accessGranted: false };\n  }\n\n  return { accessRequested: false, accessGranted: false };\n};\n","import type { FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport styles from './Link.module.scss';\n\ntype OwnProps = {\n  children: React.ReactNode;\n  className?: string;\n  isRtl?: boolean;\n  isPrimary?: boolean;\n  withMultilineFix?: boolean;\n  onClick?: (e: React.MouseEvent<HTMLAnchorElement>) => void;\n};\n\nconst Link: FC<OwnProps> = ({\n  children, isPrimary, className, isRtl, withMultilineFix, onClick,\n}) => {\n  const handleClick = useLastCallback((e: React.MouseEvent<HTMLAnchorElement>) => {\n    e.preventDefault();\n    onClick!(e);\n  });\n\n  return (\n    <a\n      href=\"#\"\n      className={buildClassName('Link', styles.link, className, isPrimary && styles.isPrimary)}\n      dir={!withMultilineFix ? (isRtl ? 'rtl' : 'auto') : undefined}\n      onClick={onClick ? handleClick : undefined}\n    >\n      {children}\n    </a>\n  );\n};\n\nexport default Link;\n","// extracted by mini-css-extract-plugin\nexport default {\"link\":\"swBnOk1h\",\"isPrimary\":\"Jz1SC8nz\"};","import type { TeactNode } from '../../lib/teact/teact';\n\nimport type { LangFn } from './types';\n\nconst UNIQUE_PLACEHOLDER_PREFIX = '$PLACEHOLDER-';\n\nexport function conjuctionWithNodes(langFn: LangFn, nodes: TeactNode[]) {\n  const placeholders = nodes.map((node, i) => `${UNIQUE_PLACEHOLDER_PREFIX}${i}`);\n  const replaced = langFn.internalFormatters.conjunction.formatToParts(placeholders);\n  const result: TeactNode[] = [];\n  replaced.forEach((part) => {\n    if (part.type === 'literal') {\n      result.push(part.value);\n      return;\n    }\n\n    const index = Number(part.value.slice(UNIQUE_PLACEHOLDER_PREFIX.length));\n    result.push(nodes[index]);\n  });\n\n  return result;\n}\n\nexport function disjunctionWithNodes(langFn: LangFn, nodes: TeactNode[]) {\n  const placeholders = nodes.map((node, i) => `${UNIQUE_PLACEHOLDER_PREFIX}${i}`);\n  const replaced = langFn.internalFormatters.disjunction.formatToParts(placeholders);\n  const result: TeactNode[] = [];\n  replaced.forEach((part) => {\n    if (part.type === 'literal') {\n      result.push(part.value);\n      return;\n    }\n\n    const index = Number(part.value.slice(UNIQUE_PLACEHOLDER_PREFIX.length));\n    result.push(nodes[index]);\n  });\n\n  return result;\n}\n","import { memo, type TeactNode } from '../../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../../global';\n\nimport type { ApiChat, ApiMessage, ApiPeer } from '../../../api/types';\n\nimport {\n  GENERAL_TOPIC_ID,\n  SERVICE_NOTIFICATIONS_USER_ID,\n  STARS_CURRENCY_CODE,\n  TME_LINK_PREFIX,\n  TON_CURRENCY_CODE,\n} from '../../../config';\nimport {\n  getMainUsername,\n  getMessageInvoice, getMessageTextWithFallback, isChatChannel,\n} from '../../../global/helpers';\nimport { getMessageContent } from '../../../global/helpers';\nimport { getPeerTitle } from '../../../global/helpers/peers';\nimport { getMessageReplyInfo } from '../../../global/helpers/replies';\nimport {\n  selectChat,\n  selectChatMessage,\n  selectMonoforumChannel,\n  selectPeer,\n  selectSender,\n  selectThreadIdFromMessage,\n  selectTopic,\n} from '../../../global/selectors';\nimport { ensureProtocol } from '../../../util/browser/url';\nimport { formatDateTimeToString, formatScheduledDateTime, formatShortDuration } from '../../../util/dates/dateFormat';\nimport { formatCurrency } from '../../../util/formatCurrency';\nimport { convertTonFromNanos } from '../../../util/formatCurrency';\nimport { formatStarsAsText, formatTonAsText } from '../../../util/localization/format';\nimport { conjuctionWithNodes } from '../../../util/localization/utils';\nimport { getServerTime } from '../../../util/serverTime';\nimport renderText from '../../common/helpers/renderText';\nimport { renderTextWithEntities } from '../../common/helpers/renderTextWithEntities';\nimport {\n  getCallMessageKey,\n  getPinnedMediaValue,\n  renderMessageLink,\n  renderPeerLink,\n  renderTopicLink,\n  translateWithYou,\n} from './helpers/messageActions';\n\nimport useLang from '../../../hooks/useLang';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport CustomEmoji from '../../common/CustomEmoji';\nimport TopicDefaultIcon from '../../common/TopicDefaultIcon';\nimport Link from '../../ui/Link';\n\nimport styles from './ActionMessage.module.scss';\n\ntype OwnProps = {\n  message: ApiMessage;\n  isInsideTopic?: boolean;\n  asPreview?: boolean;\n};\n\ntype StateProps = {\n  currentUserId?: string;\n  sender?: ApiPeer;\n  replyMessage?: ApiMessage;\n  chat?: ApiChat;\n};\n\nconst NBSP = '\\u00A0';\nconst DEFAULT_TOPIC_ICON_ID = '0';\n\nconst UNSUPPORTED_LANG_KEY = 'ActionUnsupported';\n\nconst ActionMessageText = ({\n  message,\n  currentUserId,\n  sender,\n  chat,\n  replyMessage,\n  isInsideTopic,\n  asPreview,\n}: OwnProps & StateProps) => {\n  const {\n    openTelegramLink,\n    openUrl,\n  } = getActions();\n  const { chatId, isOutgoing } = message;\n  const action = message.content.action!;\n\n  const lang = useLang();\n  const oldLang = useOldLang();\n\n  function renderStrong(text: TeactNode) {\n    if (asPreview) return text;\n    return <span className={styles.strong}>{text}</span>;\n  }\n\n  const renderActionText = useLastCallback(() => {\n    const global = getGlobal();\n\n    const isServiceNotificationsChat = chatId === SERVICE_NOTIFICATIONS_USER_ID;\n    const isSavedMessages = chatId === currentUserId;\n\n    const isChannel = chat && isChatChannel(chat);\n    const senderTitle = sender && getPeerTitle(lang, sender);\n    const chatTitle = chat && getPeerTitle(lang, chat);\n\n    const userFallbackText = lang('ActionFallbackUser');\n    const chatFallbackText = lang('ActionFallbackChat');\n    const channelFallbackText = lang('ActionFallbackChannel');\n\n    const senderLink = renderPeerLink(sender?.id, senderTitle || userFallbackText, asPreview);\n    const chatLink = renderPeerLink(chat?.id, chatTitle || chatFallbackText, asPreview);\n\n    switch (action.type) {\n      case 'pinMessage': {\n        if (replyMessage) {\n          const formattedText = getMessageTextWithFallback(lang, replyMessage);\n          if (formattedText) {\n            const textLink = renderMessageLink(\n              replyMessage,\n              renderTextWithEntities({\n                text: formattedText.text,\n                entities: formattedText.entities,\n                asPreview: true,\n              }),\n              asPreview,\n            );\n\n            return translateWithYou(\n              lang, 'ActionPinnedText', isOutgoing, { text: textLink, from: senderLink },\n            );\n          }\n\n          const mediaValue = getPinnedMediaValue(lang, replyMessage);\n          if (mediaValue) {\n            const messageLink = renderMessageLink(replyMessage, mediaValue, asPreview);\n            return translateWithYou(\n              lang, 'ActionPinnedMedia', isOutgoing, { from: senderLink, media: messageLink },\n            );\n          }\n        }\n\n        return translateWithYou(\n          lang,\n          'ActionPinnedNotFound',\n          isOutgoing,\n          { from: senderLink },\n        );\n      }\n\n      case 'gameScore': {\n        const { score } = action;\n\n        const gameTitle = replyMessage?.content.game?.title;\n        const gameLink = gameTitle && renderMessageLink(replyMessage, renderText(gameTitle), asPreview);\n\n        if (gameLink) {\n          return translateWithYou(\n            lang,\n            'ActionGameScore',\n            isOutgoing,\n            { from: senderLink, count: score, game: gameLink },\n            { pluralValue: score },\n          );\n        }\n\n        return translateWithYou(\n          lang, 'ActionGameScoreNoGame', isOutgoing, { from: senderLink, count: score }, { pluralValue: score },\n        );\n      }\n\n      case 'chatJoinedByLink':\n        return lang('ActionUserJoinedByLink', { from: senderLink }, { withNodes: true });\n\n      case 'chatJoinedByRequest':\n        return translateWithYou(lang, 'ActionJoinedByRequest', isOutgoing, { from: senderLink });\n\n      case 'channelJoined': {\n        const { isViaRequest, inviterId } = action;\n        const inviter = inviterId ? selectPeer(global, inviterId) : undefined;\n        if (inviter && inviterId !== currentUserId) {\n          const inviterLink = renderPeerLink(inviterId, getPeerTitle(lang, inviter) || userFallbackText, asPreview);\n          return lang('ActionAddYou', { from: inviterLink }, { withNodes: true });\n        }\n\n        return lang(isViaRequest ? 'ActionChannelJoinedByRequestChannelYou' : 'ActionChannelJoinedYou');\n      }\n\n      case 'chatEditTitle': {\n        const { title } = action;\n        if (isChannel) return lang('ActionChangedTitleChannel', { title });\n        return translateWithYou(lang, 'ActionChangedTitle', isOutgoing, { title, from: senderLink });\n      }\n\n      case 'chatDeletePhoto':\n        return isChannel ? lang('ActionRemovedPhotoChannel')\n          : translateWithYou(lang, 'ActionRemovedPhoto', isOutgoing, { from: senderLink });\n\n      case 'chatEditPhoto':\n        return isChannel ? lang('ActionChangedPhotoChannel')\n          : translateWithYou(lang, 'ActionChangedPhoto', isOutgoing, { from: senderLink });\n\n      case 'chatCreate': {\n        const { title } = action;\n        return lang('ActionCreatedChat', { title, from: senderLink }, { withNodes: true });\n      }\n\n      case 'channelCreate': {\n        const { title } = action;\n        return isChannel ? lang('ActionCreatedChannel')\n          : translateWithYou(lang, 'ActionCreatedChat', isOutgoing, { title, from: senderLink });\n      }\n\n      case 'chatMigrateTo': {\n        const { channelId } = action;\n        const channel = selectChat(global, channelId)!;\n        const channelLink = renderPeerLink(channelId, getPeerTitle(lang, channel)!, asPreview);\n        return lang('ActionMigratedTo', { chat: channelLink }, { withNodes: true });\n      }\n\n      case 'channelMigrateFrom': {\n        const { chatId: originalChatId, title } = action;\n        const originalChatLink = renderPeerLink(originalChatId, title || chatFallbackText, asPreview);\n        return lang('ActionMigratedFrom', { chat: originalChatLink }, { withNodes: true });\n      }\n\n      case 'topicCreate': {\n        const { title, iconColor, iconEmojiId } = action;\n\n        const topicId = selectThreadIdFromMessage(global, message);\n\n        const topicLinkContent = (\n          <>\n            {iconEmojiId ? <CustomEmoji documentId={iconEmojiId} isSelectable />\n              : <TopicDefaultIcon topicId={topicId} title={title} iconColor={iconColor} />}\n            {NBSP}\n            {renderText(title)}\n          </>\n        );\n        const topicLink = renderTopicLink(chatId, Number(topicId), topicLinkContent, asPreview);\n        return lang('ActionTopicCreated', { topic: topicLink }, { withNodes: true });\n      }\n\n      case 'topicEdit': {\n        const {\n          iconEmojiId, isClosed, isHidden, title,\n        } = action;\n\n        const topicId = selectThreadIdFromMessage(global, message);\n        const currentTopic = selectTopic(global, chatId, topicId);\n        const topicLinkContent = (\n          <>\n            {iconEmojiId && iconEmojiId !== DEFAULT_TOPIC_ICON_ID\n              ? <CustomEmoji documentId={iconEmojiId} isSelectable />\n              : (\n                <TopicDefaultIcon\n                  topicId={topicId}\n                  title={title || currentTopic?.title || lang('ActionTopicPlaceholder')}\n                  iconColor={currentTopic?.iconColor}\n                />\n              )}\n            {topicId !== GENERAL_TOPIC_ID && NBSP}\n            {renderText(title || currentTopic?.title || lang('ActionTopicPlaceholder'))}\n          </>\n        );\n        const topicLink = renderTopicLink(chatId, Number(topicId), topicLinkContent, asPreview);\n\n        const topicPlaceholderLink = renderTopicLink(\n          chatId, Number(topicId), lang('ActionTopicPlaceholder'), asPreview,\n        );\n\n        if (isClosed !== undefined) {\n          if (isInsideTopic) {\n            return lang(isClosed ? 'ActionTopicClosedInside' : 'ActionTopicReopenedInside');\n          }\n\n          return lang(\n            isClosed ? 'ActionTopicClosed' : 'ActionTopicReopened',\n            { from: senderLink, topic: topicLink },\n            { withNodes: true },\n          );\n        }\n\n        if (isHidden !== undefined) {\n          if (isInsideTopic) {\n            return lang(isHidden ? 'ActionTopicHiddenInside' : 'ActionTopicUnhiddenInside');\n          }\n          return lang(\n            isHidden ? 'ActionTopicHidden' : 'ActionTopicUnhidden',\n            { topic: topicLink },\n            { withNodes: true },\n          );\n        }\n\n        if (title && iconEmojiId) {\n          return lang(\n            'ActionTopicIconAndRenamed',\n            {\n              from: senderLink,\n              link: topicPlaceholderLink,\n              topic: topicLink,\n            },\n            { withNodes: true },\n          );\n        }\n\n        if (title === undefined) {\n          if (!iconEmojiId || iconEmojiId === DEFAULT_TOPIC_ICON_ID) {\n            return lang(\n              'ActionTopicIconRemoved', { from: senderLink, link: topicPlaceholderLink }, { withNodes: true },\n            );\n          }\n          return lang(\n            'ActionTopicIconChanged',\n            {\n              from: senderLink,\n              link: topicPlaceholderLink,\n              emoji: <CustomEmoji documentId={iconEmojiId} loopLimit={2} />,\n            },\n            { withNodes: true },\n          );\n        }\n\n        return lang('ActionTopicRenamed', { from: senderLink, link: topicPlaceholderLink, title }, { withNodes: true });\n      }\n\n      case 'boostApply':\n        return translateWithYou(\n          lang,\n          'ActionBoostApply',\n          isOutgoing,\n          { from: senderLink, count: action.boosts },\n          { pluralValue: action.boosts },\n        );\n\n      case 'chatAddUser': {\n        const { userIds } = action;\n\n        if (sender?.id === userIds[0]) {\n          return translateWithYou(lang, 'ActionUserJoined', isOutgoing, { from: senderLink });\n        }\n\n        if (userIds.length === 1) {\n          const user = selectPeer(global, userIds[0]);\n          const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n          const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n          return translateWithYou(lang, 'ActionAddUser', isOutgoing, { from: senderLink, user: userLink });\n        }\n\n        const users = userIds.map((userId) => selectPeer(global, userId)).filter(Boolean);\n\n        if (!users.length) {\n          return translateWithYou(lang, 'ActionAddUser', isOutgoing, { from: senderLink, user: userFallbackText });\n        }\n\n        const userLinks = users.map((user) => (\n          renderPeerLink(user.id, getPeerTitle(lang, user) || userFallbackText, asPreview)\n        ));\n\n        return translateWithYou(\n          lang, 'ActionAddUsersMany', isOutgoing, { from: senderLink, users: conjuctionWithNodes(lang, userLinks) },\n        );\n      }\n\n      case 'chatDeleteUser': {\n        const { userId } = action;\n        if (sender?.id === userId) {\n          return translateWithYou(lang, 'ActionUserLeft', isOutgoing, { from: senderLink });\n        }\n\n        const user = selectPeer(global, userId);\n        const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n        const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n        return translateWithYou(lang, 'ActionKickUser', isOutgoing, { from: senderLink, user: userLink });\n      }\n\n      case 'botAllowed': {\n        const {\n          app, domain, isAttachMenu, isFromRequest,\n        } = action;\n        if (isAttachMenu) return lang('ActionAttachMenuBotAllowed');\n        if (isFromRequest) return lang('ActionWebappBotAllowed');\n        if (app) {\n          const senderUsername = sender && getMainUsername(sender);\n          const link = senderUsername && `${TME_LINK_PREFIX + senderUsername}/${app.shortName}`;\n          const appLink = link\n            ? <Link onClick={() => openTelegramLink({ url: link })}>{app.title}</Link>\n            : lang('ActionBotAppPlaceholder');\n          return lang('ActionBotAllowedFromApp', { app: appLink }, { withNodes: true });\n        }\n\n        if (!domain) return lang(UNSUPPORTED_LANG_KEY);\n\n        const url = ensureProtocol(domain);\n\n        const link = <Link onClick={() => openUrl({ url })}>{domain}</Link>;\n        return lang('ActionBotAllowedFromDomain', { domain: link }, { withNodes: true });\n      }\n\n      case 'giveawayLaunch': {\n        const { stars } = action;\n\n        if (stars) {\n          return lang(\n            isChannel ? 'ActionGiveawayStarsStarted' : 'ActionGiveawayStarsStartedGroup',\n            { from: senderLink, amount: renderStrong(formatStarsAsText(lang, stars)) },\n            { withNodes: true },\n          );\n        }\n\n        return lang(\n          isChannel ? 'ActionGiveawayStarted' : 'ActionGiveawayStartedGroup',\n          { from: senderLink },\n          { withNodes: true },\n        );\n      }\n\n      case 'giveawayResults': {\n        const { winnersCount, isStars, unclaimedCount } = action;\n        if (!winnersCount) return lang('ActionGiveawayResultsNone');\n        if (unclaimedCount) {\n          return lang(isStars ? 'ActionGiveawayResultsStarsSome' : 'ActionGiveawayResultsSome');\n        }\n\n        return lang(\n          isStars ? 'ActionGiveawayResultsStars' : 'ActionGiveawayResults',\n          { count: winnersCount },\n          { pluralValue: winnersCount },\n        );\n      }\n\n      case 'giftStars':\n      case 'giftPremium':\n      case 'giftTon': {\n        const {\n          amount, currency, cryptoAmount, cryptoCurrency, type,\n        } = action;\n\n        const price = formatCurrency(lang, amount, currency, { asFontIcon: true });\n        const cryptoPrice = cryptoAmount && type !== 'giftTon'\n          ? formatCurrency(lang, cryptoAmount, cryptoCurrency!) : undefined;\n\n        const cost = cryptoPrice ? lang('ActionGiftCostCrypto', { price, cryptoPrice }, { withNodes: true }) : price;\n\n        if (isServiceNotificationsChat) {\n          return lang('ActionGiftTextCostAnonymous', { cost }, { withNodes: true });\n        }\n        return translateWithYou(\n          lang, 'ActionGiftTextCost', isOutgoing, { from: senderLink, cost: renderStrong(cost) },\n        );\n      }\n\n      case 'prizeStars':\n      case 'giftCode': {\n        return translateWithYou(lang, 'ActionGiftTextUnknown', isOutgoing, undefined);\n      }\n\n      case 'groupCall': {\n        const { duration } = action;\n        const durationText = duration ? formatShortDuration(lang, duration) : undefined;\n        if (durationText) {\n          if (isChannel) {\n            return lang('ActionGroupCallFinishedChannel', { duration: durationText });\n          }\n          return lang(\n            'ActionGroupCallFinishedGroup', { from: senderLink, duration: durationText }, { withNodes: true },\n          );\n        }\n\n        if (isChannel) return lang('ActionGroupCallStartedChannel');\n        return lang('ActionGroupCallStartedGroup', { from: senderLink }, { withNodes: true });\n      }\n\n      case 'groupCallScheduled': {\n        const { scheduleDate } = action;\n        const formattedDate = formatDateTimeToString(scheduleDate * 1000, lang.code, true);\n\n        if (isChannel) return lang('ActionGroupCallScheduledChannel', { date: formattedDate });\n        return lang('ActionGroupCallScheduledGroup', { from: senderLink, date: formattedDate }, { withNodes: true });\n      }\n\n      case 'inviteToGroupCall': {\n        const { userIds } = action;\n\n        if (userIds.length === 1) {\n          const user = selectPeer(global, userIds[0]);\n          const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n          const userLink = renderPeerLink(user?.id, userTitle, asPreview);\n          return translateWithYou(lang, 'ActionVideoInvited', isOutgoing, { from: senderLink, user: userLink });\n        }\n\n        const users = userIds.map((userId) => selectPeer(global, userId)).filter(Boolean);\n\n        if (!users.length) {\n          return translateWithYou(\n            lang, 'ActionVideoInvited', isOutgoing, { from: senderLink, user: userFallbackText },\n          );\n        }\n\n        const userLinks = users.map((user) => (\n          renderPeerLink(user.id, getPeerTitle(lang, user) || userFallbackText, asPreview)\n        ));\n\n        return translateWithYou(\n          lang, 'ActionVideoInvitedMany', isOutgoing, { from: senderLink, users: conjuctionWithNodes(lang, userLinks) },\n        );\n      }\n\n      case 'paymentSent': {\n        const {\n          currency, totalAmount, isRecurringInit, isRecurringUsed,\n        } = action;\n\n        const cost = renderStrong(formatCurrency(lang, totalAmount, currency, { asFontIcon: true }));\n        const invoice = replyMessage && getMessageInvoice(replyMessage);\n        const invoiceTitle = invoice?.title;\n\n        if (isRecurringUsed) {\n          return lang('ActionPaymentUsedRecurring', { amount: cost }, { withNodes: true });\n        }\n\n        if (!invoiceTitle) {\n          if (isRecurringInit) {\n            return lang('ActionPaymentInitRecurring', { amount: cost, user: chatLink }, { withNodes: true });\n          }\n\n          return lang('ActionPaymentDone', { amount: cost, user: chatLink }, { withNodes: true });\n        }\n\n        if (isRecurringInit) {\n          return lang(\n            'ActionPaymentInitRecurringFor',\n            { amount: cost, user: chatLink, invoice: renderMessageLink(replyMessage, invoiceTitle, asPreview) },\n            { withNodes: true },\n          );\n        }\n\n        return lang(\n          'ActionPaymentDoneFor',\n          { amount: cost, user: chatLink, invoice: renderMessageLink(replyMessage, invoiceTitle, asPreview) },\n          { withNodes: true },\n        );\n      }\n\n      case 'paymentRefunded': {\n        const { currency, totalAmount, peerId } = action;\n        const peer = selectPeer(global, peerId);\n        const peerTitle = (peer && getPeerTitle(lang, peer)) || userFallbackText;\n        const peerLink = renderPeerLink(peer?.id, peerTitle, asPreview);\n        const amount = formatCurrency(lang, totalAmount, currency, { asFontIcon: true });\n\n        return lang('ActionPaymentRefunded', { peer: peerLink, amount }, { withNodes: true });\n      }\n\n      case 'starGift': {\n        const {\n          gift, alreadyPaidUpgradeStars, peerId, savedId, fromId, isPrepaidUpgrade, isAuctionAcquired,\n        } = action;\n        const isToChannel = Boolean(peerId && savedId);\n\n        const fromPeer = fromId ? selectPeer(global, fromId) : sender;\n        const fromTitle = (fromPeer && getPeerTitle(lang, fromPeer)) || userFallbackText;\n        const fromLink = renderPeerLink(fromPeer?.id, fromTitle, asPreview);\n\n        const toPeer = peerId ? selectPeer(global, peerId) : undefined;\n        const toTitle = (toPeer && getPeerTitle(lang, toPeer))\n          || (isToChannel ? channelFallbackText : userFallbackText);\n        const toLink = renderPeerLink(toPeer?.id, toTitle, asPreview);\n\n        const starsAmount = gift.stars + (alreadyPaidUpgradeStars || 0);\n        const cost = renderStrong(formatStarsAsText(lang, starsAmount));\n\n        if (isAuctionAcquired) {\n          return lang('ActionStarGiftAuctionWon', { cost }, { withNodes: true });\n        }\n\n        if (isPrepaidUpgrade && gift.upgradeStars) {\n          const upgradeCost = renderStrong(formatStarsAsText(lang, gift.upgradeStars));\n\n          return translateWithYou(\n            lang, 'ActionStarGiftPrepaidUpgrade', isOutgoing, {\n              peer: isOutgoing ? toLink : senderLink,\n              cost: upgradeCost,\n            },\n          );\n        }\n\n        if (isToChannel) {\n          const channelPeer = selectPeer(global, peerId!);\n          const isYou = fromPeer?.id === currentUserId;\n\n          const channelTitle = (channelPeer && getPeerTitle(lang, channelPeer)) || channelFallbackText;\n          const channelLink = renderPeerLink(peerId, channelTitle, asPreview);\n          return translateWithYou(\n            lang, 'ActionStarGiftSentChannel', isYou, { user: fromLink, channel: channelLink, cost },\n          );\n        }\n\n        if (isServiceNotificationsChat) {\n          return lang('ActionStarGiftReceivedAnonymous', { cost }, { withNodes: true });\n        }\n\n        if (isSavedMessages) {\n          return lang('ActionStarGiftSelfBought', { cost }, { withNodes: true });\n        }\n\n        if (isOutgoing) {\n          return lang('ActionStarGiftSent', { cost }, { withNodes: true });\n        }\n\n        return lang('ActionStarGiftReceived', { user: senderLink, cost }, { withNodes: true });\n      }\n\n      case 'starGiftUnique': {\n        const {\n          isTransferred, isUpgrade, savedId, peerId, fromId, resaleAmount, gift, transferStars, isPrepaidUpgrade,\n        } = action;\n\n        const isToChannel = Boolean(peerId && savedId);\n\n        const fromPeer = fromId ? selectPeer(global, fromId) : sender;\n        const fromTitle = (fromPeer && getPeerTitle(lang, fromPeer)) || userFallbackText;\n        const fromLink = renderPeerLink(fromPeer?.id, fromTitle, asPreview);\n\n        const toPeer = peerId ? selectPeer(global, peerId) : undefined;\n        const toTitle = (toPeer && getPeerTitle(lang, toPeer))\n          || (isToChannel ? channelFallbackText : userFallbackText);\n        const toLink = renderPeerLink(toPeer?.id, toTitle, asPreview);\n\n        if (isPrepaidUpgrade) {\n          if (isOutgoing) {\n            return lang('ActionStarGiftPrepaidUpgradedYou');\n          }\n          return lang('ActionStarGiftPrepaidUpgraded', { user: toLink }, { withNodes: true });\n        }\n\n        if (resaleAmount && !transferStars) {\n          const amountText = resaleAmount.currency === TON_CURRENCY_CODE\n            ? formatTonAsText(lang, convertTonFromNanos(resaleAmount.amount))\n            : formatStarsAsText(lang, resaleAmount.amount);\n\n          return lang(\n            isOutgoing\n              ? 'ApiMessageMessageActionResaleStarGiftUniqueOutgoing'\n              : 'ApiMessageMessageActionResaleStarGiftUniqueIncoming',\n            {\n              gift: lang('GiftUnique', { title: gift.title, number: gift.number }),\n              stars: renderStrong(amountText),\n            },\n            { withNodes: true },\n          );\n        }\n\n        if (isToChannel) {\n          const channelPeer = selectPeer(global, peerId!);\n          const isYou = fromPeer?.id === currentUserId;\n          const isAnonymous = fromPeer?.id === SERVICE_NOTIFICATIONS_USER_ID;\n\n          const channelTitle = (channelPeer && getPeerTitle(lang, channelPeer)) || channelFallbackText;\n          const channelLink = renderPeerLink(peerId, channelTitle, asPreview);\n\n          if (isUpgrade) {\n            return translateWithYou(\n              lang, 'ActionStarGiftUpgradedChannel', isYou, { user: fromLink, channel: channelLink },\n            );\n          }\n\n          if (isTransferred) {\n            if (isAnonymous) {\n              return lang('ActionStarGiftTransferredUnknownChannel', { channel: channelLink }, { withNodes: true });\n            }\n\n            return translateWithYou(\n              lang, 'ActionStarGiftTransferredChannel', isYou, { user: fromLink, channel: channelLink },\n            );\n          }\n        }\n\n        if (isSavedMessages) {\n          if (isUpgrade) return lang('ActionStarGiftUpgradedSelf');\n          if (isTransferred) return lang('ActionStarGiftTransferredSelf');\n        }\n\n        if (isUpgrade) {\n          if (isOutgoing) {\n            return lang('ActionStarGiftUpgradedMine', { user: chatLink }, { withNodes: true });\n          }\n\n          if (isSavedMessages) {\n            return lang('ActionStarGiftUpgradedSelf');\n          }\n\n          return lang('ActionStarGiftUpgradedUser', { user: senderLink }, { withNodes: true });\n        }\n\n        if ((isTransferred || transferStars) && !resaleAmount) {\n          if (sender?.id === SERVICE_NOTIFICATIONS_USER_ID) {\n            return lang('ActionStarGiftTransferredUnknown');\n          }\n\n          if (isSavedMessages) {\n            return lang('ActionStarGiftTransferredSelf');\n          }\n\n          if (isOutgoing) {\n            return lang('ActionStarGiftTransferredMine', { user: chatLink }, { withNodes: true });\n          }\n\n          return lang('ActionStarGiftTransferred', { user: senderLink }, { withNodes: true });\n        }\n\n        if (isOutgoing) {\n          return lang('ActionGiftUniqueSent');\n        }\n\n        return lang('ActionGiftUniqueReceived', { user: senderLink }, { withNodes: true });\n      }\n\n      case 'suggestProfilePhoto': {\n        const actionPeer = (isOutgoing ? chat : sender)!;\n        const actionPeerLink = renderPeerLink(\n          actionPeer.id, getPeerTitle(lang, actionPeer) || userFallbackText, asPreview,\n        );\n\n        return translateWithYou(lang, 'ActionSuggestedPhoto', isOutgoing, { user: actionPeerLink });\n      }\n\n      case 'webViewDataSent':\n        return lang('ActionWebviewDataDone', { text: action.text });\n\n      case 'expired': {\n        const { isRoundVideo, isVoice } = action;\n        if (isVoice) return lang('ActionExpiredVoice');\n        if (isRoundVideo) return lang('ActionExpiredVideo');\n\n        return lang(UNSUPPORTED_LANG_KEY);\n      }\n\n      case 'historyClear':\n        return lang('ActionHistoryCleared');\n\n      case 'screenshotTaken':\n        return translateWithYou(lang, 'ActionScreenshotTaken', isOutgoing, { from: senderLink });\n\n      case 'contactSignUp':\n        return lang('ActionUserRegistered', { from: senderLink }, { withNodes: true });\n\n      case 'customAction':\n        return action.message;\n\n      case 'paidMessagesPrice': {\n        const { stars, isAllowedInChannel } = action;\n        if (stars === 0) {\n          if (isChannel) {\n            return lang(\n              isAllowedInChannel ? 'ActionMessageChannelFree' : 'ActionMessageChannelDisabled',\n              { peer: chatLink },\n              { withNodes: true },\n            );\n          }\n          return translateWithYou(lang, 'ActionPaidMessagePriceFree', isOutgoing, { peer: senderLink });\n        }\n        return translateWithYou(lang, 'ActionPaidMessagePrice', isOutgoing, {\n          peer: senderLink,\n          amount: formatStarsAsText(lang, stars),\n        }, { withMarkdown: true });\n      }\n\n      case 'paidMessagesRefunded': {\n        const { stars } = action;\n        const user = selectPeer(global, chatId);\n        const userTitle = (user && getPeerTitle(lang, user)) || userFallbackText;\n\n        const key = isOutgoing\n          ? 'ApiMessageActionPaidMessagesRefundedOutgoing'\n          : 'ApiMessageActionPaidMessagesRefundedIncoming';\n\n        return lang(key, {\n          stars: formatStarsAsText(lang, stars),\n          user: renderPeerLink(user?.id, userTitle),\n        }, { withNodes: true, withMarkdown: true });\n      }\n\n      case 'suggestedPostSuccess': {\n        const { amount: price } = action;\n        const currency = price?.currency || STARS_CURRENCY_CODE;\n        const amount = price?.amount || 0;\n\n        const channel = chat?.isMonoforum ? selectMonoforumChannel(global, chatId) : chat;\n        const channelTitle = channel && getPeerTitle(lang, channel);\n        const channelLink = renderPeerLink(channel?.id, channelTitle || channelFallbackText, asPreview);\n\n        const formattedAmount = currency === TON_CURRENCY_CODE\n          ? formatTonAsText(lang, convertTonFromNanos(amount))\n          : formatStarsAsText(lang, amount);\n\n        return lang('ActionSuggestedPostSuccess', {\n          channel: channelLink,\n          amount: formattedAmount,\n        }, { withNodes: true });\n      }\n      case 'suggestedPostRefund': {\n        const { payerInitiated } = action;\n\n        const postSender = replyMessage ? selectSender(global, replyMessage) : sender;\n        const postSenderTitle = postSender && getPeerTitle(lang, postSender);\n        const postSenderLink = renderPeerLink(postSender?.id, postSenderTitle || userFallbackText, asPreview);\n\n        const price = replyMessage?.suggestedPostInfo?.price;\n        const currency = price?.currency || STARS_CURRENCY_CODE;\n        const amount = price?.amount || 0;\n\n        const channel = chat?.isMonoforum ? selectMonoforumChannel(global, chatId) : chat;\n        const channelTitle = channel && getPeerTitle(lang, channel);\n        const channelLink = renderPeerLink(channel?.id, channelTitle || channelFallbackText, asPreview);\n\n        const formattedAmount = currency === TON_CURRENCY_CODE\n          ? formatTonAsText(lang, convertTonFromNanos(amount))\n          : formatStarsAsText(lang, amount);\n\n        if (payerInitiated) {\n          return lang('SuggestedPostRefundedByUser', {\n            amount: formattedAmount,\n            user: postSenderLink,\n            channel: channelLink,\n          }, { withNodes: true, withMarkdown: true });\n        }\n\n        return lang('SuggestedPostRefundedByChannel', {\n          amount: formattedAmount,\n          peer: postSenderLink,\n          channel: channelLink,\n        }, { withNodes: true, withMarkdown: true });\n      }\n      case 'suggestedPostApproval': {\n        const { isRejected, isBalanceTooLow, rejectComment } = action;\n\n        if (isRejected) {\n          return translateWithYou(\n            lang,\n            rejectComment ? 'SuggestedPostRejectedWithReason' : 'SuggestedPostRejected',\n            isOutgoing,\n            { peer: senderLink },\n            { withMarkdown: true },\n          );\n        }\n\n        if (isBalanceTooLow) {\n          const replyMessageSender = replyMessage ? selectSender(global, replyMessage) : sender;\n          const replyPeerTitle = replyMessageSender && getPeerTitle(lang, replyMessageSender);\n          const userLink = renderPeerLink(replyMessageSender?.id, replyPeerTitle || userFallbackText, asPreview);\n\n          const currency = replyMessage?.suggestedPostInfo?.price?.currency || STARS_CURRENCY_CODE;\n          const currencyName = currency === TON_CURRENCY_CODE ? lang('CurrencyTon') : lang('CurrencyStars');\n\n          return lang('SuggestedPostBalanceTooLow', {\n            peer: userLink,\n            currency: currencyName,\n          }, { withNodes: true, withMarkdown: true });\n        }\n\n        const channel = chat?.isMonoforum ? selectMonoforumChannel(global, chatId) : chat;\n        const channelTitle = channel && getPeerTitle(lang, channel);\n        const channelLink = renderPeerLink(channel?.id, channelTitle || channelFallbackText, asPreview);\n\n        const { scheduleDate } = action;\n        if (scheduleDate) {\n          const publishDate = formatScheduledDateTime(scheduleDate, lang, oldLang);\n          const isPostPublished = scheduleDate <= getServerTime();\n\n          return translateWithYou(\n            lang,\n            isPostPublished ? 'SuggestedPostPublished' : 'SuggestedPostPublishSchedule',\n            isOutgoing,\n            { peer: channelLink, date: publishDate },\n            { withMarkdown: true },\n          );\n        }\n\n        return lang(UNSUPPORTED_LANG_KEY);\n      }\n      case 'todoCompletions': {\n        const { completedIds, incompletedIds } = action;\n\n        let completedItem;\n        let incompletedItem;\n        const { todo } = replyMessage ? getMessageContent(replyMessage) : {};\n        if (todo) {\n          const todoItems = todo.todo.items;\n          completedItem = todoItems.find((item) => completedIds.includes(item.id));\n          incompletedItem = todoItems.find((item) => incompletedIds.includes(item.id));\n        }\n\n        if (incompletedItem) {\n          const incompletedTaskTitle = incompletedItem.title;\n\n          const incompletedTaskLink = renderMessageLink(\n            replyMessage,\n            renderTextWithEntities({\n              text: incompletedTaskTitle.text,\n              entities: incompletedTaskTitle.entities,\n              asPreview: true,\n            }),\n            asPreview,\n          );\n\n          return translateWithYou(lang, 'MessageActionTodoCompletionsAsNotDone', isOutgoing, {\n            peer: senderLink,\n            task: incompletedTaskLink,\n          });\n        }\n\n        if (completedItem) {\n          const completedTaskTitle = completedItem.title;\n          const completedTaskLink = renderMessageLink(\n            replyMessage,\n            renderTextWithEntities({\n              text: completedTaskTitle.text,\n              entities: completedTaskTitle.entities,\n              asPreview: true,\n            }),\n            asPreview,\n          );\n\n          return translateWithYou(lang, 'MessageActionTodoCompletionsAsDone', isOutgoing, {\n            peer: senderLink,\n            task: completedTaskLink,\n          });\n        }\n\n        if (completedIds) {\n          const completedText = lang('MessageActionTodoTaskCount', {\n            count: completedIds.length,\n          }, { pluralValue: completedIds.length });\n          const completedLink = renderMessageLink(\n            replyMessage,\n            renderTextWithEntities({\n              text: completedText,\n              asPreview: true,\n            }),\n            asPreview,\n            { noEllipsis: true },\n          );\n          return translateWithYou(lang, 'MessageActionTodoCompletionsAsDone', isOutgoing, {\n            peer: senderLink,\n            task: completedLink,\n          });\n        }\n\n        const incompletedText = lang('MessageActionTodoTaskCount', {\n          count: incompletedIds.length,\n        }, { pluralValue: incompletedIds.length });\n        const incompletedLink = renderMessageLink(\n          replyMessage,\n          renderTextWithEntities({\n            text: incompletedText,\n            asPreview: true,\n          }),\n          asPreview,\n          { noEllipsis: true },\n        );\n\n        return translateWithYou(lang, 'MessageActionTodoCompletionsAsNotDone', isOutgoing, {\n          peer: senderLink,\n          task: incompletedLink,\n        });\n      }\n\n      case 'todoAppendTasks': {\n        const { items } = action;\n        const { todo } = replyMessage ? getMessageContent(replyMessage) : {};\n\n        const listTitle = todo?.todo.title.text || '';\n        const listLink = renderMessageLink(\n          replyMessage,\n          renderTextWithEntities({\n            text: listTitle,\n            asPreview: true,\n          }),\n          asPreview,\n        );\n\n        if (items.length === 1) {\n          const taskTitle = items[0].title;\n          const taskLink = renderMessageLink(\n            replyMessage,\n            renderTextWithEntities({\n              text: taskTitle.text,\n              entities: taskTitle.entities,\n              asPreview: true,\n            }),\n            asPreview,\n          );\n\n          return translateWithYou(lang, 'MessageActionAppendTodo', isOutgoing, {\n            peer: senderLink,\n            task: taskLink,\n            list: listLink,\n          });\n        }\n\n        const tasksText = lang('MessageActionTodoTaskCount', {\n          count: items.length,\n        }, { pluralValue: items.length });\n        const tasksLink = renderMessageLink(\n          replyMessage,\n          renderTextWithEntities({\n            text: tasksText,\n            asPreview: true,\n          }),\n          asPreview,\n          { noEllipsis: true },\n        );\n\n        return translateWithYou(lang, 'MessageActionAppendTodoMultiple', isOutgoing, {\n          peer: senderLink,\n          tasks: tasksLink,\n          list: listLink,\n        });\n      }\n\n      case 'phoneCall': // Rendered as a regular message, but considered an action for the summary\n        return lang(getCallMessageKey(action, isOutgoing));\n      default:\n        return lang(UNSUPPORTED_LANG_KEY);\n    }\n  });\n\n  return renderActionText();\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { message }): Complete<StateProps> => {\n    const chat = selectChat(global, message.chatId);\n    const sender = selectSender(global, message);\n\n    const { replyToMsgId, replyToPeerId } = getMessageReplyInfo(message) || {};\n    const replyMessage = replyToMsgId\n      ? selectChatMessage(global, replyToPeerId || message.chatId, replyToMsgId) : undefined;\n\n    return {\n      currentUserId: global.currentUserId,\n      replyMessage,\n      chat,\n      sender,\n    };\n  },\n)(ActionMessageText));\n","import { addCallback } from '../../lib/teact/teactn';\nimport { getGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\nimport type { Signal, SignalSetter } from '../../util/signals';\n\nimport { createSignal } from '../../util/signals';\nimport useSyncEffect from '../useSyncEffect';\n\n/*\n  This hook is a more performant variation of the standard React `useSelector` hook. It allows to:\n  a) Avoid multiple subscriptions to global updates by leveraging a single selector reference.\n  b) Return a signal instead of forcing a component update right away.\n */\n\ntype Selector<T> = (global: GlobalState) => T;\n\ninterface State<T> {\n  clientsCount: number;\n  getter: Signal<T>;\n  setter: SignalSetter<T>;\n}\n\nconst bySelector = new Map<Selector<unknown>, State<unknown>>();\n\naddCallback((global: GlobalState) => {\n  for (const [selector, { setter }] of bySelector) {\n    setter(selector(global));\n  }\n});\n\nfunction useSelectorSignal<T>(selector: Selector<T>): Signal<T> {\n  let state = bySelector.get(selector) as State<T> | undefined;\n  if (!state) {\n    const [getter, setter] = createSignal(selector(getGlobal()));\n    state = { clientsCount: 0, getter, setter };\n    bySelector.set(selector, state as State<unknown>);\n  }\n\n  useSyncEffect(() => {\n    const state2 = bySelector.get(selector)!;\n\n    state2.clientsCount++;\n\n    return () => {\n      state2.clientsCount--;\n\n      if (!state2.clientsCount) {\n        bySelector.delete(selector);\n      }\n    };\n  }, [selector]);\n\n  return state.getter;\n}\n\nexport default useSelectorSignal;\n","import { type TeactNode } from '../lib/teact/teact';\n\nexport function replaceWithTeact(\n  input: string, searchValue: string | RegExp, replaceValue: TeactNode,\n) {\n  const parts = input.split(searchValue);\n  const [firstElement, ...rest] = parts;\n\n  return rest.reduce((acc: TeactNode[], curr: string): TeactNode[] => (\n    acc.concat(replaceValue, curr)\n  ), [firstElement]).filter(Boolean);\n}\n\nexport function replaceInStringsWithTeact(\n  input: TeactNode, searchValue: string | RegExp, replaceValue: TeactNode,\n): TeactNode {\n  if (typeof input === 'string') return replaceWithTeact(input, searchValue, replaceValue);\n  if (!input || !Array.isArray(input)) return input;\n\n  return input.flatMap((curr: TeactNode) => {\n    if (typeof curr === 'string') return replaceWithTeact(curr, searchValue, replaceValue);\n    if (Array.isArray(curr)) return replaceInStringsWithTeact(curr, searchValue, replaceValue);\n    return curr;\n  });\n}\n","import type { ApiError, ApiFieldError } from '../api/types';\n\nimport { DEBUG } from '../config';\n\nconst READABLE_ERROR_MESSAGES: Record<string, string> = {\n  CHAT_RESTRICTED: 'You can\\'t send messages in this chat, you were restricted',\n  CHAT_SEND_POLL_FORBIDDEN: 'You can\\'t create polls in this chat',\n  CHAT_SEND_STICKERS_FORBIDDEN: 'You can\\'t send stickers in this chat',\n  CHAT_SEND_GIFS_FORBIDDEN: 'You can\\'t send gifs in this chat',\n  CHAT_SEND_MEDIA_FORBIDDEN: 'You can\\'t send media in this chat',\n  CHAT_LINK_EXISTS: 'The chat is public, you can\\'t hide the history to new users',\n  // eslint-disable-next-line @stylistic/max-len\n  SLOWMODE_WAIT_X: 'Slowmode is enabled in this chat: you must wait for the specified number of seconds before sending another message to the chat.',\n  USER_BANNED_IN_CHANNEL: 'You\\'re banned from sending messages in supergroups / channels',\n  USER_IS_BLOCKED: 'You were blocked by this user',\n  YOU_BLOCKED_USER: 'You blocked this user',\n  IMAGE_PROCESS_FAILED: 'Failure while processing image',\n  MEDIA_EMPTY: 'The provided media object is invalid',\n  MEDIA_GROUPED_INVALID: 'Failed to replace album media',\n  MEDIA_NEW_INVALID: 'Failed to replace new media',\n  MESSAGE_NOT_MODIFIED: 'Message not modified. The new content is identical to the current one.',\n  MEDIA_INVALID: 'Media invalid',\n  PASSWORD_HASH_INVALID: 'Incorrect password',\n  PHOTO_EXT_INVALID: 'The extension of the photo is invalid',\n  PHOTO_INVALID_DIMENSIONS: 'The photo dimensions are invalid',\n  PHOTO_SAVE_FILE_INVALID: 'Internal issues, try again later',\n  // eslint-disable-next-line @stylistic/max-len\n  MESSAGE_DELETE_FORBIDDEN: 'You can\\'t delete one of the messages you tried to delete, most likely because it is a service message.',\n  MESSAGE_POLL_CLOSED: 'Poll closed',\n  MESSAGE_EDIT_TIME_EXPIRED: 'You can\\'t edit this message anymore.',\n  PINNED_DIALOGS_TOO_MUCH: 'Sorry, you can only pin 5 chats to the top',\n  CHANNEL_PRIVATE: 'This channel is private',\n  MEDIA_CAPTION_TOO_LONG: 'The provided caption is too long',\n  ADDRESS_STREET_LINE1_INVALID: 'The address you provided is not valid',\n  ADDRESS_STREET_LINE2_INVALID: 'The address you provided is not valid',\n  ADDRESS_CITY_INVALID: 'The city you provided is not valid',\n  ADDRESS_COUNTRY_INVALID: 'The country you provided is not valid',\n  ADDRESS_POSTCODE_INVALID: 'The postcode you provided is not valid',\n  ADDRESS_STATE_INVALID: 'The state you provided is not valid',\n  REQ_INFO_NAME_INVALID: 'The name you provided is not valid',\n  REQ_INFO_PHONE_INVALID: 'The phone you provided is not valid',\n  REQ_INFO_EMAIL_INVALID: 'The email you provided is not valid',\n  // TODO Bring back after fixing the weird bug\n  // CHANNEL_INVALID: 'An error occurred. Please try again later',\n  LINK_NOT_MODIFIED: 'This discussion is already linked to the channel',\n  MESSAGE_TOO_LONG: 'Message is too long',\n\n  // Non-API errors\n  // eslint-disable-next-line @stylistic/max-len\n  SERVICE_WORKER_DISABLED: 'Service Worker is disabled. Streaming media may not be supported. Try reloading the page without holding <Shift> key',\n  // eslint-disable-next-line @stylistic/max-len\n  MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS: 'The provided message is too long. Please remove {EXTRA_CHARS_COUNT} character{PLURAL_S}.',\n  // eslint-disable-next-line @stylistic/max-len\n  FRESH_RESET_AUTHORISATION_FORBIDDEN: 'You cant logout other sessions if less than 24 hours have passed since you logged on the current session',\n\n  BOTS_TOO_MUCH: 'There are too many bots in this chat/channel',\n  BOT_GROUPS_BLOCKED: 'This bot can\\'t be added to groups',\n  USERS_TOO_MUCH: 'The maximum number of users has been exceeded',\n  USER_CHANNELS_TOO_MUCH: 'One of the users you tried to add is already in too many channels/supergroups',\n  USER_KICKED: 'This user was kicked from this supergroup/channel',\n  USER_NOT_MUTUAL_CONTACT: 'The provided user is not a mutual contact',\n  USER_PRIVACY_RESTRICTED: 'The user\\'s privacy settings do not allow you to do this',\n  INVITE_HASH_EMPTY: 'The invite hash is empty',\n  INVITE_HASH_EXPIRED: 'The invite link has expired',\n  INVITE_HASH_INVALID: 'The invite hash is invalid',\n  CHANNELS_TOO_MUCH: 'You have joined too many channels/supergroups',\n  USER_ALREADY_PARTICIPANT: 'You already in the group',\n  SCHEDULE_DATE_INVALID: 'Invalid schedule date provided',\n  WALLPAPER_DIMENSIONS_INVALID: 'The wallpaper dimensions are invalid, please select another file',\n  ADMINS_TOO_MUCH: 'There are too many admins',\n  ADMIN_RANK_EMOJI_NOT_ALLOWED: 'An admin rank cannot contain emojis',\n  ADMIN_RANK_INVALID: 'The specified admin rank is invalid',\n  FRESH_CHANGE_ADMINS_FORBIDDEN: 'You were just elected admin, you can\\'t add or modify other admins yet',\n  INPUT_USER_DEACTIVATED: 'Can\\'t do this action to a deleted account',\n  BOT_PRECHECKOUT_TIMEOUT: 'The request for payment has expired',\n  PROVIDER_ACCOUNT_TIMEOUT: 'Request to the payment provider has expired',\n\n  STARGIFT_CONVERT_TOO_OLD: 'This gift no longer can be converted to Stars',\n  SUBSCRIPTION_ALREADY_ACTIVE: 'You are already subscribed',\n\n  PEERS_LIST_EMPTY: 'No chats are added to the list',\n\n  PAID_MEDIA_FORBIDDEN: 'You can\\'t send paid media in this chat',\n\n  USER_DISALLOWED_STARGIFTS: 'User is not accepting gifts',\n};\n\nif (DEBUG) {\n  READABLE_ERROR_MESSAGES.CHAT_WRITE_FORBIDDEN = 'You can\\'t write in this chat';\n  READABLE_ERROR_MESSAGES.CHAT_ADMIN_REQUIRED = 'You must be an admin in this chat to do this';\n}\n\nexport const SHIPPING_ERRORS: Record<string, ApiFieldError> = {\n  ADDRESS_STREET_LINE1_INVALID: {\n    field: 'streetLine1',\n    message: 'Incorrect street address',\n  },\n  ADDRESS_STREET_LINE2_INVALID: {\n    field: 'streetLine2',\n    message: 'Incorrect street address',\n  },\n  ADDRESS_CITY_INVALID: {\n    field: 'city',\n    message: 'Incorrect city',\n  },\n  ADDRESS_COUNTRY_INVALID: {\n    field: 'countryIso2',\n    message: 'Incorrect country',\n  },\n  ADDRESS_POSTCODE_INVALID: {\n    field: 'postCode',\n    message: 'Incorrect post code',\n  },\n  ADDRESS_STATE_INVALID: {\n    field: 'state',\n    message: 'Incorrect state',\n  },\n  REQ_INFO_NAME_INVALID: {\n    field: 'fullName',\n    message: 'Incorrect name',\n  },\n  REQ_INFO_PHONE_INVALID: {\n    field: 'phone',\n    message: 'Incorrect phone',\n  },\n  REQ_INFO_EMAIL_INVALID: {\n    field: 'email',\n    message: 'Incorrect email',\n  },\n};\n\nconst FINAL_PAYMENT_ERRORS = new Set([\n  'BOT_PRECHECKOUT_FAILED',\n  'PAYMENT_FAILED',\n]);\n\nexport default function getReadableErrorText(error: ApiError) {\n  const { message, isSlowMode, textParams } = error;\n  // Currently, Telegram API doesn't return `SLOWMODE_WAIT_X` error as described in the docs\n  if (isSlowMode) {\n    const extraPartIndex = message.indexOf(' (caused by');\n    return extraPartIndex > 0 ? message.substring(0, extraPartIndex) : message;\n  }\n  let errorMessage = READABLE_ERROR_MESSAGES[message];\n  if (errorMessage && textParams) {\n    errorMessage = Object.keys(textParams).reduce((acc, current) => {\n      return acc.replace(current, textParams[current]);\n    }, errorMessage);\n  }\n  return errorMessage;\n}\n\nexport function getShippingError(error: ApiError): ApiFieldError | undefined {\n  return SHIPPING_ERRORS[error.message];\n}\n\nexport function shouldClosePaymentModal(error: ApiError): boolean {\n  return FINAL_PAYMENT_ERRORS.has(error.message);\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".\" + {\"26\":\"d42450dc56640b1ae27f\",\"46\":\"1f296786b4b7ec17dc01\",\"59\":\"dd88e76406cb6bb4ee99\",\"61\":\"90b18d7e14e7f2d2cd82\",\"69\":\"648f3f970f9aa8241dec\",\"90\":\"435e37d1050b83369f3b\",\"103\":\"94ca41907433e3a100f8\",\"131\":\"999fe102ea7b8b6e7bd6\",\"194\":\"fe29c004acd27b212485\",\"213\":\"346b7f1b29008340076b\",\"234\":\"254400d9d5a665605dea\",\"304\":\"eb789f69371d7b59d034\",\"313\":\"6762e1c8475c10546741\",\"356\":\"eac92228ab1fa5ea42d9\",\"373\":\"ad933aaace223551a687\",\"387\":\"b5d31d4916f1dc896736\",\"400\":\"5e15991358a64f489b61\",\"405\":\"9ebdcbf5d54ca4945947\",\"409\":\"fce16b7594bf808a473d\",\"433\":\"13d1679f9c71eb7b0f36\",\"453\":\"7aba01d64b7090c4168b\",\"482\":\"0f8c86fe53ed93e92c9f\",\"562\":\"62dc75e88882f2b75e18\",\"564\":\"bc969cef20e92ace67a5\",\"633\":\"c5af4556cf67949607d0\",\"676\":\"2f3586f227b3c3b92132\",\"683\":\"c49779dd9429d22fa76c\",\"695\":\"71b64cce9d8ef3bcd603\",\"748\":\"a116d1870cfe8fec11f4\",\"768\":\"9885ce4c6bf3e80444b8\",\"835\":\"360d591b755d21c69548\",\"947\":\"19f842ff6be2cf0629e6\",\"970\":\"68129826e3ac78ca5a60\",\"984\":\"1ac4466376847410440d\",\"996\":\"a8dbc41e71438a90c062\",\"1022\":\"b6b4c00395e0cb18c423\",\"1095\":\"b4d9bdc59cb3b059fc3f\",\"1105\":\"c487668b3b60b3a1f786\",\"1164\":\"39a91364139ba5d8f18b\",\"1168\":\"77f1915df3042db3064e\",\"1215\":\"47ef5a0e8e6dc9f8b23c\",\"1348\":\"4c77480922e7cbd8e9c9\",\"1387\":\"2b71d7eb62f2ca593645\",\"1401\":\"a39bfd55e8c996eab31c\",\"1465\":\"ffc487369f0c39aebf80\",\"1516\":\"a6f225def68398dfbc7c\",\"1567\":\"53ba58bb2e984748589c\",\"1575\":\"586213da1fea97f73c96\",\"1586\":\"f65e493a367f3ca64f9d\",\"1620\":\"d226904eba9b2b1da735\",\"1670\":\"77c75930e7534de19264\",\"1692\":\"56b9745648d8780718d4\",\"1700\":\"9be2d31666730b5cfa2f\",\"1775\":\"a6071b9d656415562335\",\"1780\":\"fdc64722ce7264f7ebc0\",\"1877\":\"2f7ecd05cc8d70f2fb0c\",\"1930\":\"c8f77a3a2fcea2c5a889\",\"2057\":\"82a2ad50fc4256dda39c\",\"2158\":\"ca0050108eb278545f98\",\"2164\":\"731a9ab06ab66bab1a1e\",\"2225\":\"fd69d6ba85906e47ca66\",\"2230\":\"47ed6feb510de3f040e9\",\"2263\":\"1faa54b4fae1f21c0a59\",\"2315\":\"bff46f469ef077822165\",\"2394\":\"165016e1af67fd6c90fa\",\"2448\":\"f1da7a47d88066772e84\",\"2465\":\"85c59f68fbe5089c0943\",\"2498\":\"c8e3e2c0da75d35c6608\",\"2651\":\"f0a1a6077f9afa7696ea\",\"2670\":\"9737a48998a6454a952f\",\"2729\":\"f4efba1f2bdd37e1a55c\",\"2800\":\"dfcb59f460e2c877fa7b\",\"2801\":\"8842236b5f5cbf0b2686\",\"2856\":\"03b0e7170e6a4e5a949a\",\"2857\":\"af05287e08cf1de9b645\",\"2859\":\"9238962a2121e18ab020\",\"2916\":\"0e6b8d785bcdfc90f1a1\",\"2990\":\"8495a179e74b9346cc6c\",\"3080\":\"3e651706c7dbc098692d\",\"3272\":\"a2344e3393361e80d864\",\"3325\":\"105eb88e6eab8c322f29\",\"3363\":\"895f47ffe0eac3d5eb7e\",\"3405\":\"e054fe83663ae1685277\",\"3499\":\"80ce013f263af659b3c8\",\"3524\":\"b5664be32ce063988e11\",\"3564\":\"1d0ed96c6ddae5bf0988\",\"3715\":\"600e1ca66cf1ce19ccae\",\"3731\":\"b4f101d92d77ffa435dc\",\"3745\":\"e57891f1228edf138c63\",\"3747\":\"8e7d7812644a6841d4b3\",\"3787\":\"03f30e547fb1d8deb163\",\"3813\":\"6bf21c8badc91bbc5610\",\"3892\":\"b32c5f1201212118610c\",\"3906\":\"f1eaa2fee0b5cdb8a766\",\"3981\":\"a4729e0a8cce6eafc3ab\",\"4008\":\"56ca101b055e6bacae40\",\"4019\":\"44332b4f8a8d17e5a967\",\"4020\":\"e63bde1a9241d23381c5\",\"4102\":\"41a654cbdb45e3b673bc\",\"4128\":\"26aa06652c577720dabe\",\"4134\":\"17d3297e3e035bd91029\",\"4180\":\"1b75a4448ceb719a3738\",\"4204\":\"71c2ea704dc4e4bdbc43\",\"4230\":\"75b03afd87ee1ebcafdf\",\"4326\":\"3e6197c047229ef234fd\",\"4336\":\"d832286a43072f2eee83\",\"4383\":\"1ae645a0406c1468c784\",\"4435\":\"31746bf937849884155c\",\"4448\":\"70e50622b95750be3b12\",\"4484\":\"2cc82a17fd7ffa38335c\",\"4550\":\"427508a76cecef16f3d4\",\"4765\":\"ace7b726252df58fece4\",\"4785\":\"183ec9a60842ac108984\",\"4810\":\"78271fa08dc08c5fbb10\",\"4917\":\"30c8b957edc77f09dda5\",\"4940\":\"7c0fadbf2503e12e1c0f\",\"5032\":\"55a2ee9510b3fb83a424\",\"5046\":\"48d3e5a91ae0b6083be8\",\"5060\":\"c297cbea45374f18cf73\",\"5073\":\"01039cbf84742b8b7329\",\"5116\":\"e519f174b099f8bd2236\",\"5148\":\"5361670bbbb75ffcf4bc\",\"5193\":\"6a726769b851069b3b2c\",\"5246\":\"73f6c3c8898da871776e\",\"5260\":\"802b59f8622032a9c98f\",\"5269\":\"7f001c3812fd5f2bcdc1\",\"5336\":\"589d193e8a74ec0d3fc5\",\"5345\":\"f3de6f81a1ea42d269b1\",\"5361\":\"c775137362e1e6513e43\",\"5408\":\"9d19e33f731fd5de5806\",\"5420\":\"4e58ec001503659d948a\",\"5429\":\"0cf14038bce0e59d5de5\",\"5434\":\"8ab4efc6401c88627921\",\"5438\":\"76ec714a86d7c0c94a68\",\"5499\":\"ef18f07a3242df97616a\",\"5525\":\"0f22975f288b08013bf2\",\"5628\":\"39b3258e394999a10721\",\"5719\":\"1f3acfc2b4f9a3c7c392\",\"5735\":\"514031621c6b44e7d3fe\",\"5819\":\"8519713404ec92a39e26\",\"5962\":\"6efdc7b1a77cf75bdd7b\",\"6005\":\"a4415670d3dd34f8784c\",\"6047\":\"d47862028c2efabe804a\",\"6058\":\"ae15a40167fea15ded8a\",\"6167\":\"eacaf5b55eb5216764db\",\"6168\":\"130393fdc4c19a638710\",\"6241\":\"bd8b64db3b3f38619f8a\",\"6265\":\"e78abddb57734c4e5621\",\"6272\":\"08ac6e205d1028a088f3\",\"6308\":\"7f64cc841a957ca784f4\",\"6314\":\"101ec08f51eb426fd42d\",\"6338\":\"322eca7147ac4cdd4a36\",\"6438\":\"98fd99285e3416d79179\",\"6441\":\"db3dbf9983dc0d880a7a\",\"6442\":\"39e3c09c0020ed6129bd\",\"6473\":\"f8e7c8d064ca8c529b6f\",\"6685\":\"e8765fa3bf4aee64ba1c\",\"6686\":\"39f110d8cc643acf8471\",\"6708\":\"e271a05126ecfc3dde97\",\"6726\":\"8ade1a6f82e7245828e7\",\"6802\":\"e224578d8ae8741c7a50\",\"6827\":\"54bb7c735a02f23944bc\",\"6854\":\"9e1049565abeb7f1b3d7\",\"6860\":\"7e8a1cf7576ef42884d0\",\"6869\":\"8e6bef3a51cb39cf0712\",\"6930\":\"d9f5fe18b10ff3c740cd\",\"6947\":\"203be054c3b22cd13dad\",\"7001\":\"8192d4cc113a712a48ac\",\"7120\":\"861921f79c28f1c99c72\",\"7244\":\"dc19cae3f028c5d34896\",\"7276\":\"2adbfe29cd62bb2a7d6a\",\"7283\":\"36e8612b60ce28140475\",\"7353\":\"f037a4ac95e76b584a34\",\"7357\":\"67b51dab94789e79dcba\",\"7405\":\"71f8f462c579227ba275\",\"7408\":\"2ef11f87352381caada9\",\"7424\":\"97b34d57a45ce61529a7\",\"7426\":\"92e65e80641806abe1c4\",\"7487\":\"b53eb606a7814d0c01f3\",\"7499\":\"849a11c540cf1eaa07fc\",\"7561\":\"5ece2de96ec98edaf60e\",\"7586\":\"be685801cd14a8982b1c\",\"7594\":\"0e0d0e81185165e876f2\",\"7612\":\"e31654890c52973e04eb\",\"7617\":\"67e3aae71e321040aaf6\",\"7688\":\"c6284aace709e94cf7a4\",\"7738\":\"e526facc521749ec8a89\",\"7768\":\"94f705b80b9b8e92879a\",\"7854\":\"299222fe8adb91ecb663\",\"7880\":\"bf5770eada6e868f8161\",\"7901\":\"1f0107f229f44fed1d82\",\"7939\":\"130465def73ddf4fabe9\",\"7972\":\"2fea24a83f85e313cb3e\",\"7978\":\"88546edfa1e867eab83e\",\"8043\":\"ab004f29c2e0cdcaab85\",\"8062\":\"0dd35623c010798b1ca4\",\"8100\":\"c343218f3f597a3bcea3\",\"8114\":\"58f75a1159e1d944cb88\",\"8142\":\"56d5bbe37a61443cefb8\",\"8150\":\"b830be2e1a53ff5c6e53\",\"8169\":\"10a89a24f091ddb760a3\",\"8201\":\"670ad37dfc5197daa429\",\"8213\":\"f31131ac825f51f3e9f7\",\"8214\":\"6c56767a4d14bbddc617\",\"8233\":\"85844c42d58a0b47be5f\",\"8308\":\"906b15ca617589b77e13\",\"8349\":\"15fe46cdbbdc710c6098\",\"8393\":\"70032037c7d8cff1533c\",\"8409\":\"4cded9bb3a97c03bd70b\",\"8590\":\"593b1ba777e0785f3e22\",\"8602\":\"a575d509b15e427646be\",\"8764\":\"b3a515e969ad88f6402e\",\"8790\":\"d73185342608912e14c7\",\"8804\":\"4825e6ccd94f2a381b6c\",\"8843\":\"06c64d7c9b1cfbb6a7a2\",\"8924\":\"6982ce0da62e3829ffac\",\"8925\":\"64f4ee0df28d228251b6\",\"8967\":\"f48e81b01da8e66a89f8\",\"8980\":\"0359186057d5162dac41\",\"9004\":\"4df0f376ddfbc4139e71\",\"9030\":\"5c93da0f8ceafe3ded4f\",\"9072\":\"081b1224b5aa200a9e2b\",\"9141\":\"80248a79109eb2afdaed\",\"9183\":\"682c16bcd0bdd6c092fc\",\"9238\":\"d341475c2a03f92bdd35\",\"9250\":\"ccb33e6f99d2c24f8505\",\"9287\":\"0270f3c92e13fa843854\",\"9295\":\"1fb093c32ab899d98c4e\",\"9359\":\"3c935654a35e6a605e0a\",\"9375\":\"a7c825230b63cb5dec7c\",\"9443\":\"11006935fc43e7191e4c\",\"9451\":\"ea7f8857125e717fe211\",\"9549\":\"2e2f20615f2170938b7b\",\"9623\":\"6c12ccd0b80b6a493ad0\",\"9677\":\"237a35a8b60262b25bb2\",\"9710\":\"47d283cf5e57a2f137a9\",\"9753\":\"532bc8683f96283b76d3\",\"9761\":\"098fd276d6878c0bb5a8\",\"9849\":\"8d7bc011da08cbb6b000\",\"9869\":\"9b25ddc987874f7569f4\",\"9998\":\"3a242cc4249d72179c0a\"}[chunkId] + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + ({\"2394\":\"BundleCalls\",\"4765\":\"shared-components\",\"6930\":\"BundleStars\",\"7405\":\"BundleAuth\",\"7768\":\"BundleMain\",\"9451\":\"BundleExtra\"}[chunkId] || chunkId) + \".\" + {\"1670\":\"77c75930e7534de19264\",\"2394\":\"165016e1af67fd6c90fa\",\"3892\":\"b32c5f1201212118610c\",\"4765\":\"ace7b726252df58fece4\",\"4810\":\"78271fa08dc08c5fbb10\",\"6930\":\"d9f5fe18b10ff3c740cd\",\"7405\":\"71f8f462c579227ba275\",\"7768\":\"94f705b80b9b8e92879a\",\"9451\":\"ea7f8857125e717fe211\"}[chunkId] + \".css\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","if (typeof document === \"undefined\") return;\nvar createStylesheet = (chunkId, fullhref, oldTag, resolve, reject) => {\n\tvar linkTag = document.createElement(\"link\");\n\n\tlinkTag.rel = \"stylesheet\";\n\tlinkTag.type = \"text/css\";\n\tif (__webpack_require__.nc) {\n\t\tlinkTag.nonce = __webpack_require__.nc;\n\t}\n\tvar onLinkComplete = (event) => {\n\t\t// avoid mem leaks.\n\t\tlinkTag.onerror = linkTag.onload = null;\n\t\tif (event.type === 'load') {\n\t\t\tresolve();\n\t\t} else {\n\t\t\tvar errorType = event && event.type;\n\t\t\tvar realHref = event && event.target && event.target.href || fullhref;\n\t\t\tvar err = new Error(\"Loading CSS chunk \" + chunkId + \" failed.\\n(\" + errorType + \": \" + realHref + \")\");\n\t\t\terr.name = \"ChunkLoadError\";\n\t\t\terr.code = \"CSS_CHUNK_LOAD_FAILED\";\n\t\t\terr.type = errorType;\n\t\t\terr.request = realHref;\n\t\t\tif (linkTag.parentNode) linkTag.parentNode.removeChild(linkTag)\n\t\t\treject(err);\n\t\t}\n\t}\n\tlinkTag.onerror = linkTag.onload = onLinkComplete;\n\tlinkTag.href = fullhref;\n\n\n\tif (oldTag) {\n\t\toldTag.parentNode.insertBefore(linkTag, oldTag.nextSibling);\n\t} else {\n\t\tdocument.head.appendChild(linkTag);\n\t}\n\treturn linkTag;\n};\nvar findStylesheet = (href, fullhref) => {\n\tvar existingLinkTags = document.getElementsByTagName(\"link\");\n\tfor(var i = 0; i < existingLinkTags.length; i++) {\n\t\tvar tag = existingLinkTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\") || tag.getAttribute(\"href\");\n\t\tif(tag.rel === \"stylesheet\" && (dataHref === href || dataHref === fullhref)) return tag;\n\t}\n\tvar existingStyleTags = document.getElementsByTagName(\"style\");\n\tfor(var i = 0; i < existingStyleTags.length; i++) {\n\t\tvar tag = existingStyleTags[i];\n\t\tvar dataHref = tag.getAttribute(\"data-href\");\n\t\tif(dataHref === href || dataHref === fullhref) return tag;\n\t}\n};\nvar loadStylesheet = (chunkId) => {\n\treturn new Promise((resolve, reject) => {\n\t\tvar href = __webpack_require__.miniCssF(chunkId);\n\t\tvar fullhref = __webpack_require__.p + href;\n\t\tif(findStylesheet(href, fullhref)) return resolve();\n\t\tcreateStylesheet(chunkId, fullhref, null, resolve, reject);\n\t});\n}\n// object to store loaded CSS chunks\nvar installedCssChunks = {\n\t7784: 0,\n\t8287: 0,\n\t8792: 0\n};\n\n__webpack_require__.f.miniCss = (chunkId, promises) => {\n\tvar cssChunks = {\"1670\":1,\"2394\":1,\"3892\":1,\"4765\":1,\"4810\":1,\"6930\":1,\"7405\":1,\"7768\":1,\"9451\":1};\n\tif(installedCssChunks[chunkId]) promises.push(installedCssChunks[chunkId]);\n\telse if(installedCssChunks[chunkId] !== 0 && cssChunks[chunkId]) {\n\t\tpromises.push(installedCssChunks[chunkId] = loadStylesheet(chunkId).then(() => {\n\t\t\tinstalledCssChunks[chunkId] = 0;\n\t\t}, (e) => {\n\t\t\tdelete installedCssChunks[chunkId];\n\t\t\tthrow e;\n\t\t}));\n\t}\n};\n\n// no hmr\n\n// no prefetching\n\n// no preloaded","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t7784: 0,\n\t8287: 0,\n\t8792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkalphahuman_telegram\"] = self[\"webpackChunkalphahuman_telegram\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","import { getActions } from '../global';\n\nimport { DEBUG, DEBUG_MORE, IS_TEST } from '../config';\nimport { IS_ANDROID, IS_IOS, IS_SERVICE_WORKER_SUPPORTED } from './browser/windowEnvironment';\nimport { formatShareText } from './deeplink';\nimport { validateFiles } from './files';\nimport { notifyClientReady, playNotifySoundDebounced } from './notifications';\n\ntype WorkerAction = {\n  type: string;\n  payload: Record<string, any>;\n};\n\nconst IGNORE_WORKER_PATH = '/k/';\n\nfunction handleWorkerMessage(e: MessageEvent) {\n  const action: WorkerAction = e.data;\n  if (DEBUG_MORE) {\n    // eslint-disable-next-line no-console\n    console.log('[SW] Message from worker', action);\n  }\n  if (!action.type) return;\n  const dispatch = getActions();\n  const payload = action.payload;\n  switch (action.type) {\n    case 'focusMessage':\n      dispatch.focusMessage?.(payload as any);\n      break;\n    case 'playNotificationSound':\n      playNotifySoundDebounced(action.payload.id);\n      break;\n    case 'share':\n      dispatch.openChatWithDraft({\n        text: formatShareText(payload.url, payload.text, payload.title),\n        files: validateFiles(payload.files),\n      });\n      break;\n  }\n}\n\nfunction subscribeToWorker() {\n  navigator.serviceWorker.removeEventListener('message', handleWorkerMessage);\n  navigator.serviceWorker.addEventListener('message', handleWorkerMessage);\n  // Notify web worker that client is ready to receive messages\n  notifyClientReady();\n}\n\nif (IS_SERVICE_WORKER_SUPPORTED) {\n  window.addEventListener('load', async () => {\n    try {\n      const controller = navigator.serviceWorker.controller;\n      if (!controller || controller.scriptURL.includes(IGNORE_WORKER_PATH)) {\n        const registrations = await navigator.serviceWorker.getRegistrations();\n        const ourRegistrations = registrations.filter((r) => !r.scope.includes(IGNORE_WORKER_PATH));\n        if (ourRegistrations.length) {\n          if (DEBUG) {\n            // eslint-disable-next-line no-console\n            console.log('[SW] Hard reload detected, re-enabling Service Worker');\n          }\n          await Promise.all(ourRegistrations.map((r) => r.unregister()));\n        }\n      }\n\n      await navigator.serviceWorker.register(new URL('../serviceWorker', import.meta.url));\n\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.log('[SW] ServiceWorker registered');\n      }\n\n      await navigator.serviceWorker.ready;\n\n      // Wait for registration to be available\n      await navigator.serviceWorker.getRegistration();\n\n      if (navigator.serviceWorker.controller) {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.log('[SW] ServiceWorker ready');\n        }\n        subscribeToWorker();\n      } else {\n        if (DEBUG) {\n          // eslint-disable-next-line no-console\n          console.error('[SW] ServiceWorker not available');\n        }\n\n        if (!IS_IOS && !IS_ANDROID && !IS_TEST) {\n          getActions().showDialog?.({ data: { message: 'SERVICE_WORKER_DISABLED', hasErrorKey: true } });\n        }\n      }\n    } catch (err) {\n      if (DEBUG) {\n        // eslint-disable-next-line no-console\n        console.error('[SW] ServiceWorker registration failed: ', err);\n      }\n    }\n  });\n  window.addEventListener('focus', async () => {\n    await navigator.serviceWorker.ready;\n    subscribeToWorker();\n  });\n}\n","import { addCallback } from '../lib/teact/teactn';\n\nimport type { GlobalState } from './types';\n\nimport { getServerTime } from '../util/serverTime';\nimport { removePeerStory } from './reducers';\nimport { selectTabState } from './selectors';\nimport { getGlobal, setGlobal } from '.';\n\nconst STORY_EXPIRATION_INTERVAL = 2 * 60 * 1000; // 2 min\n\nlet intervals: number[] = [];\n\nlet prevGlobal: GlobalState | undefined;\n\naddCallback((global: GlobalState) => {\n  const previousGlobal = prevGlobal;\n  prevGlobal = global;\n\n  const isCurrentMaster = selectTabState(global)?.isMasterTab;\n  const isPreviousMaster = previousGlobal && selectTabState(previousGlobal)?.isMasterTab;\n  if (isCurrentMaster === isPreviousMaster) return;\n\n  if (isCurrentMaster && !isPreviousMaster) {\n    startIntervals();\n  } else {\n    stopIntervals();\n  }\n});\n\nfunction startIntervals() {\n  if (intervals.length) return;\n  intervals.push(window.setInterval(checkStoryExpiration, STORY_EXPIRATION_INTERVAL));\n}\n\nfunction stopIntervals() {\n  intervals.forEach((interval) => clearInterval(interval));\n  intervals = [];\n}\n\nfunction checkStoryExpiration() {\n  let global = getGlobal();\n  if (!global.isInited) return;\n\n  const serverTime = getServerTime();\n\n  Object.values(global.stories.byPeerId).forEach((peerStories) => {\n    const stories = Object.values(peerStories.byId);\n    stories.forEach((story) => {\n      if (story['@type'] !== 'story') return;\n      if (story.expireDate > serverTime) return;\n      if (story.isInProfile) return;\n\n      global = removePeerStory(global, story.peerId, story.id);\n    });\n  });\n\n  setGlobal(global);\n}\n","import type { GlobalState } from '../global/types';\n\nimport { IS_MOCKED_CLIENT } from '../config';\nimport { loadCache, loadCachedSharedState } from '../global/cache';\nimport {\n  getGlobal, setGlobal,\n} from '../global/index';\nimport { INITIAL_GLOBAL_STATE } from '../global/initialState';\nimport { updatePasscodeSettings } from '../global/reducers';\nimport { cloneDeep } from './iteratees';\nimport { clearStoredSession } from './sessions';\n\nexport async function initGlobal(force: boolean = false, prevGlobal?: GlobalState) {\n  prevGlobal = prevGlobal || getGlobal();\n  if (!force && 'byTabId' in prevGlobal) {\n    return;\n  }\n\n  const initial = cloneDeep(INITIAL_GLOBAL_STATE);\n  const cache = await loadCache(initial);\n  let global = cache || initial;\n  if (IS_MOCKED_CLIENT) global.auth.state = 'authorizationStateReady';\n\n  const { hasPasscode, isScreenLocked } = global.passcode;\n  if (hasPasscode && !isScreenLocked) {\n    global = updatePasscodeSettings(global, {\n      isScreenLocked: true,\n    });\n\n    clearStoredSession();\n  }\n\n  if (force) {\n    global.byTabId = prevGlobal.byTabId;\n  }\n\n  if (!cache) { // Try loading shared state separately\n    const storedSharedState = await loadCachedSharedState();\n    if (storedSharedState) {\n      global.sharedState = storedSharedState;\n    }\n  }\n\n  setGlobal(global);\n}\n","import './intervals';\n\nimport type { ActionReturnType, GlobalState } from './types';\nimport type { MessageList } from '../types';\n\nimport { IS_MULTIACCOUNT_SUPPORTED } from '../util/browser/globalEnvironment';\nimport { isCacheApiSupported } from '../util/cacheApi';\nimport { getCurrentTabId, reestablishMasterToSelf } from '../util/establishMultitabRole';\nimport { initGlobal } from '../util/init';\nimport { cloneDeep } from '../util/iteratees';\nimport { isLocalMessageId } from '../util/keys/messageKey';\nimport { Bundles, loadBundle } from '../util/moduleLoader';\nimport { parseLocationHash } from '../util/routing';\nimport { updatePeerColors } from '../util/theme';\nimport { initializeChatMediaSearchResults } from './reducers/middleSearch';\nimport { updateTabState } from './reducers/tabs';\nimport { initSharedState } from './shared/sharedStateConnector';\nimport { initCache } from './cache';\nimport {\n  addActionHandler, getGlobal, setGlobal,\n} from './index';\nimport { INITIAL_TAB_STATE } from './initialState';\nimport { replaceTabThreadParam, replaceThreadParam } from './reducers';\nimport { selectTabState, selectThreadParam } from './selectors';\n\ninitCache();\n\naddActionHandler('initShared', async (prevGlobal, actions, payload): Promise<void> => {\n  const { force } = payload || {};\n  await initGlobal(force, prevGlobal);\n});\n\naddActionHandler('init', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId(), isMasterTab } = payload || {};\n\n  const initialTabState = cloneDeep(INITIAL_TAB_STATE);\n  initialTabState.id = tabId;\n  initialTabState.audioPlayer.playbackRate = global.audioPlayer.lastPlaybackRate;\n  initialTabState.audioPlayer.isPlaybackRateActive = global.audioPlayer.isLastPlaybackRateActive;\n  initialTabState.mediaViewer.playbackRate = global.mediaViewer.lastPlaybackRate;\n  if (global.lastIsChatInfoShown) {\n    initialTabState.chatInfo = {\n      isOpen: true,\n    };\n  }\n\n  global = {\n    ...global,\n    byTabId: {\n      ...global.byTabId,\n      [tabId]: initialTabState,\n    },\n  };\n\n  if (isMasterTab) {\n    initialTabState.isMasterTab = true;\n  }\n\n  if (IS_MULTIACCOUNT_SUPPORTED && initialTabState.isMasterTab) {\n    initSharedState(global.sharedState);\n  }\n\n  Object.keys(global.messages.byChatId).forEach((chatId) => {\n    const threadsById = global.messages.byChatId[chatId].threadsById;\n    Object.keys(threadsById).forEach((thread) => {\n      const threadId = Number(thread);\n      const lastViewportIds = selectThreadParam(global, chatId, threadId, 'lastViewportIds');\n      // Check if migration from previous version is faulty\n      if (!lastViewportIds?.every((id) => isLocalMessageId(id) || global.messages.byChatId[chatId]?.byId[id])) {\n        global = replaceThreadParam(global, chatId, threadId, 'lastViewportIds', undefined);\n        return;\n      }\n      global = initializeChatMediaSearchResults(global, chatId, threadId, tabId);\n      global = replaceTabThreadParam(\n        global,\n        chatId,\n        threadId,\n        'viewportIds',\n        lastViewportIds,\n        tabId,\n      );\n    });\n  });\n\n  // Temporary state fix\n  Object.keys(global.messages.byChatId).forEach((chatId) => {\n    const threadsById = global.messages.byChatId[chatId].threadsById;\n    const fixedThreadsById = Object.keys(threadsById).reduce((acc, key) => {\n      const t = threadsById[Number(key)];\n      acc[Number(key)] = {\n        ...t,\n        listedIds: t.lastViewportIds,\n      };\n      return acc;\n    }, {} as GlobalState['messages']['byChatId'][string]['threadsById']);\n\n    global = {\n      ...global,\n      messages: {\n        ...global.messages,\n        byChatId: {\n          ...global.messages.byChatId,\n          [chatId]: {\n            ...global.messages.byChatId[chatId],\n            threadsById: fixedThreadsById,\n          },\n        },\n      },\n    };\n  });\n\n  const parsedLocationHash = parseLocationHash(global.currentUserId);\n\n  if (global.auth.state !== 'authorizationStateReady'\n    && !global.passcode.hasPasscode && !global.passcode.isScreenLocked) {\n    Object.values(global.byTabId).forEach(({ id: otherTabId }) => {\n      if (otherTabId === tabId) return;\n      global = updateTabState(global, {\n        inactiveReason: 'auth',\n      }, otherTabId);\n    });\n  }\n\n  isCacheApiSupported().then((isSupported) => {\n    global = getGlobal();\n    global.isCacheApiSupported = isSupported;\n    setGlobal(global);\n  });\n\n  if (global.peerColors) {\n    updatePeerColors(global.peerColors.general);\n  }\n\n  // Only set messageLists if it's a valid chat (not summarize page)\n  const messageLists = parsedLocationHash && 'chatId' in parsedLocationHash\n    ? [parsedLocationHash as MessageList]\n    : initialTabState.messageLists;\n\n  return updateTabState(global, {\n    messageLists,\n  }, tabId);\n});\n\naddActionHandler('requestMasterAndCallAction', async (\n  global, actions, payload,\n): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload;\n\n  if (selectTabState(global, tabId).isMasterTab) {\n    const { action, payload: actionPayload } = payload;\n    // @ts-ignore\n    actions[action](actionPayload);\n    return;\n  }\n\n  if (global.phoneCall || global.groupCalls.activeGroupCallId) {\n    await loadBundle(Bundles.Calls);\n    if ('hangUp' in actions) actions.hangUp({ tabId });\n    if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId });\n  } else {\n    reestablishMasterToSelf();\n  }\n\n  global = getGlobal();\n  global = updateTabState(global, {\n    multitabNextAction: payload,\n  }, tabId);\n  setGlobal(global);\n});\n\naddActionHandler('clearMultitabNextAction', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n\n  return updateTabState(global, {\n    multitabNextAction: undefined,\n  }, tabId);\n});\n","import { IS_IOS } from './browser/windowEnvironment';\nimport { animate } from './animation';\nimport { fastRaf } from './schedulers';\n\nconst TEST_INTERVAL = 5000; // 5 sec\nconst FRAMES_TO_TEST = 10;\nconst REDUCED_FPS = 35;\n\nlet isImproved = false;\n\nexport function betterView() {\n  if (!IS_IOS) return;\n\n  let interval: number | undefined;\n  let lastFocusAt = Date.now();\n\n  function setupInterval() {\n    if (interval || isImproved) return;\n\n    interval = window.setInterval(testAndImprove, TEST_INTERVAL);\n  }\n\n  window.addEventListener('focus', () => {\n    const now = Date.now();\n    if (now - lastFocusAt < 100) return; // iOS triggers two `focus` events for some reason\n    lastFocusAt = now;\n\n    setupInterval();\n    testAndImprove();\n  });\n\n  window.addEventListener('blur', () => {\n    clearInterval(interval);\n    interval = undefined;\n  });\n\n  if (document.hasFocus()) {\n    setupInterval();\n    testAndImprove();\n  }\n}\n\nasync function testAndImprove() {\n  const fps = await testFps();\n  if (fps <= REDUCED_FPS) {\n    improveView();\n  }\n}\n\nfunction testFps() {\n  return new Promise<number>((resolve) => {\n    const frames: number[] = [];\n    let lastFrameAt = performance.now();\n\n    animate(() => {\n      const now = performance.now();\n      frames.push(now - lastFrameAt);\n      lastFrameAt = now;\n\n      if (frames.length === FRAMES_TO_TEST) {\n        const mean = frames.sort()[Math.floor(frames.length / 2)];\n        resolve(Math.round(1000 / mean));\n        return false;\n      }\n\n      return true;\n    }, fastRaf);\n  });\n}\n\nfunction improveView() {\n  isImproved = true;\n\n  const containerEl = document.createElement('div');\n  containerEl.style.cssText = 'position: absolute; top: 0; left: 0; width: 0; height: 100%; overflow: hidden;';\n\n  const boosterEl = document.createElement('div');\n  const height = window.screen.height * 1.5;\n  boosterEl.style.cssText = `width: 0; height: ${height}px; transform: translateX(100%); transition: transform 100ms;`;\n  boosterEl.innerHTML = '&nbsp;';\n\n  containerEl.appendChild(boosterEl);\n  document.body.appendChild(containerEl);\n\n  requestAnimationFrame(() => {\n    boosterEl.addEventListener('transitionend', () => {\n      containerEl.remove();\n    });\n\n    boosterEl.style.transform = '';\n  });\n}\n","import { getActions } from '../../global';\n\nimport { DEBUG } from '../../config';\nimport { MouseButton } from '../browser/windowEnvironment';\n\ntype DownloadFinishedEvent = {\n  success: boolean;\n  url: string;\n};\n\nlet isSetup = false;\nexport default function setupTauriListeners() {\n  if (isSetup) return;\n  isSetup = true;\n\n  // Disable default tauri context menu in production build\n  if (!DEBUG) {\n    document.addEventListener('contextmenu', (event) => {\n      event.preventDefault();\n    });\n  }\n\n  const eventPromise = import('@tauri-apps/api/event');\n  eventPromise.then(({ listen }) => {\n    listen<DownloadFinishedEvent>('download-finished', (event) => {\n      if (event.payload.success) return;\n\n      getActions().showNotification({\n        message: { key: 'NativeDownloadFailed' },\n      });\n    });\n  });\n\n  // Disable Backspace handling as back navigation\n  document.addEventListener('keydown', (event: KeyboardEvent) => {\n    if (event.key === 'Backspace' || event.code === 'Backspace') {\n      const target = event.target as HTMLElement | null;\n      const isInputField = target?.tagName === 'INPUT'\n        || target?.tagName === 'TEXTAREA'\n        || target?.isContentEditable;\n\n      if (!isInputField) {\n        event.preventDefault();\n      }\n    }\n  }, true);\n\n  window.open = (url: string | URL | undefined, target?: string, features?: string) => {\n    if (url) openLink(url);\n    // eslint-disable-next-line no-null/no-null\n    return null;\n  };\n\n  function handleClick(event: MouseEvent) {\n    const target = event.target as HTMLElement | null;\n    const anchor = target?.closest<HTMLAnchorElement>('a[href]');\n\n    if (!anchor) return;\n\n    if (anchor.target === '_blank'\n      || event.ctrlKey\n      || event.metaKey\n      || event.button === MouseButton.Auxiliary\n    ) {\n      event.preventDefault();\n\n      const href = anchor.getAttribute('href')!;\n      openLink(href);\n    }\n  }\n\n  document.addEventListener('click', handleClick);\n  document.addEventListener('auxclick', handleClick);\n}\n\nasync function openLink(url: string | URL) {\n  try {\n    const urlObject = url instanceof URL ? url : new URL(url, window.location.href);\n    if (window.location.origin === urlObject.origin) {\n      await window.tauri.openNewWindow(urlObject.toString());\n    } else {\n      const shellPlugin = await import('@tauri-apps/plugin-shell');\n      await shellPlugin.open(urlObject.toString());\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error('Failed to open link:', url, e);\n  }\n}\n","import { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthCodeAsync = () => {\n  const AuthCode = useModuleLoader(Bundles.Auth, 'AuthCode');\n\n  return AuthCode ? <AuthCode /> : <Loading />;\n};\n\nexport default AuthCodeAsync;\n","import { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthPasswordAsync = () => {\n  const AuthPassword = useModuleLoader(Bundles.Auth, 'AuthPassword');\n\n  return AuthPassword ? <AuthPassword /> : <Loading />;\n};\n\nexport default AuthPasswordAsync;\n","const SITE_FONTS = ['400 1em Roboto', '500 1em Roboto', '500 1em \\'Numbers Rounded\\''];\n\nexport default function preloadFonts() {\n  if ('fonts' in document) {\n    return Promise.all(SITE_FONTS.map((font) => document.fonts.load(font)));\n  }\n\n  return undefined;\n}\n","import { getAccountSlotUrl } from '../../../util/multiaccount';\n\nexport function navigateBack() {\n  const currentUrl = new URL(window.location.href);\n  const referrer = document.referrer ? new URL(document.referrer) : undefined;\n  if (referrer?.origin === currentUrl.origin && referrer.pathname === currentUrl.pathname\n    && referrer.searchParams.get('account') !== currentUrl.searchParams.get('account')) {\n    window.location.assign(referrer); // Return to previous account with it's state\n    return;\n  }\n\n  const url = getAccountSlotUrl(1);\n  window.location.href = url;\n}\n","import type { LangCode } from '../../../types';\n\nexport function getSuggestedLanguage() {\n  let suggestedLanguage = navigator.language.toLowerCase();\n\n  if (suggestedLanguage && suggestedLanguage !== 'pt-br') {\n    suggestedLanguage = suggestedLanguage.substr(0, 2);\n  }\n\n  return suggestedLanguage as LangCode;\n}\n","import { useEffect, useState } from '../lib/teact/teact';\n\nimport type { RegularLangKey } from '../types/language';\n\nimport { LANG_PACK } from '../config';\nimport { callApi } from '../api/gramjs';\nimport useLastCallback from './useLastCallback';\n\nexport default function useLangString(key: RegularLangKey, langCode?: string) {\n  const [value, setValue] = useState<string | undefined>(undefined);\n\n  const fetchLangString = useLastCallback(async () => {\n    if (!langCode) return undefined;\n\n    const result = await callApi('fetchLangStrings', {\n      langCode,\n      langPack: LANG_PACK,\n      keys: [key],\n    });\n    const langString = result?.strings[key];\n    if (!langString || typeof langString !== 'string') return undefined;\n    return langString;\n  });\n\n  useEffect(() => {\n    fetchLangString().then(setValue);\n  }, [key, langCode]);\n\n  return value;\n}\n","import type { FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport {\n  memo, useCallback, useRef, useState,\n} from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiCountryCode } from '../../api/types';\n\nimport { ANIMATION_END_DELAY } from '../../config';\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport { IS_EMOJI_SUPPORTED } from '../../util/browser/windowEnvironment';\nimport buildClassName from '../../util/buildClassName';\nimport { isoToEmoji } from '../../util/emoji/emoji';\nimport { prepareSearchWordsForNeedle } from '../../util/searchWords';\nimport renderText from '../common/helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\nimport useSyncEffect from '../../hooks/useSyncEffect';\n\nimport DropdownMenu from '../ui/DropdownMenu';\nimport MenuItem from '../ui/MenuItem';\nimport Spinner from '../ui/Spinner';\n\nimport './CountryCodeInput.scss';\n\ntype StateProps = {\n  phoneCodeList: ApiCountryCode[];\n};\n\ntype OwnProps = {\n  id: string;\n  value?: ApiCountryCode;\n  isLoading?: boolean;\n  onChange: (value: ApiCountryCode) => void;\n};\n\nconst MENU_HIDING_DURATION = 200 + ANIMATION_END_DELAY;\nconst SELECT_TIMEOUT = 50;\n\nconst CountryCodeInput: FC<OwnProps & StateProps> = ({\n  id,\n  value,\n  isLoading,\n  onChange,\n  phoneCodeList,\n}) => {\n  const lang = useLang();\n  const inputRef = useRef<HTMLInputElement>();\n\n  const [filter, setFilter] = useState<string | undefined>();\n  const [filteredList, setFilteredList] = useState<ApiCountryCode[]>([]);\n\n  const updateFilter = useCallback((filterValue?: string) => {\n    setFilter(filterValue);\n    setFilteredList(getFilteredList(phoneCodeList, filterValue));\n  }, [phoneCodeList]);\n\n  useSyncEffect(([prevPhoneCodeList]) => {\n    if (!prevPhoneCodeList?.length && phoneCodeList.length) {\n      setFilteredList(getFilteredList(phoneCodeList, filter));\n    }\n  }, [phoneCodeList, filter]);\n\n  const handleChange = useCallback((country: ApiCountryCode) => {\n    onChange(country);\n\n    setTimeout(() => updateFilter(undefined), MENU_HIDING_DURATION);\n  }, [onChange, updateFilter]);\n\n  const handleInput = useCallback((e: React.FormEvent<HTMLInputElement>) => {\n    updateFilter(e.currentTarget.value);\n  }, [updateFilter]);\n\n  const handleInputKeyDown = useCallback((e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.keyCode !== 8) {\n      return;\n    }\n\n    const target = e.currentTarget;\n    if (value && filter === undefined) {\n      target.value = '';\n    }\n\n    updateFilter(target.value);\n  }, [filter, updateFilter, value]);\n\n  const CodeInput: FC<{ onTrigger: () => void; isOpen?: boolean }> = useCallback(({ onTrigger, isOpen }) => {\n    const handleTrigger = () => {\n      if (isOpen) {\n        return;\n      }\n\n      setTimeout(() => {\n        inputRef.current!.select();\n      }, SELECT_TIMEOUT);\n\n      onTrigger();\n\n      const formEl = document.getElementById('auth-phone-number-form')!;\n      formEl.scrollTo({ top: formEl.scrollHeight, behavior: 'smooth' });\n    };\n\n    const handleCodeInput = (e: React.FormEvent<HTMLInputElement>) => {\n      handleInput(e);\n      handleTrigger();\n    };\n\n    const emoji = value && IS_EMOJI_SUPPORTED && isoToEmoji(value.iso2);\n    const name = value?.name || value?.defaultName || '';\n    const inputValue = filter ?? [emoji, name].filter(Boolean).join(' ');\n\n    return (\n      <div className={buildClassName('input-group', value && 'touched')}>\n        <input\n          ref={inputRef}\n          className={buildClassName('form-control', isOpen && 'focus')}\n          type=\"text\"\n          id={id}\n          value={inputValue}\n          autoComplete=\"off\"\n          spellCheck={IS_TAURI ? false : undefined}\n          onClick={handleTrigger}\n          onFocus={handleTrigger}\n          onInput={handleCodeInput}\n          onKeyDown={handleInputKeyDown}\n        />\n        <label>{lang('LoginSelectCountryTitle')}</label>\n        {isLoading ? (\n          <Spinner color=\"black\" />\n        ) : (\n          <i onClick={handleTrigger} className={buildClassName('css-icon-down', isOpen && 'open')} />\n        )}\n      </div>\n    );\n  }, [filter, handleInput, handleInputKeyDown, id, isLoading, lang, value]);\n\n  return (\n    <DropdownMenu\n      className=\"CountryCodeInput\"\n      trigger={CodeInput}\n    >\n      {filteredList\n        .map((country: ApiCountryCode) => (\n          <MenuItem\n            key={`${country.iso2}-${country.countryCode}`}\n            className={value && country.iso2 === value.iso2 ? 'selected' : ''}\n\n            onClick={() => handleChange(country)}\n          >\n            <span className=\"country-flag\">{renderText(isoToEmoji(country.iso2), ['hq_emoji'])}</span>\n            <span className=\"country-name\">{country.name || country.defaultName}</span>\n            <span className=\"country-code\">\n              +\n              {country.countryCode}\n            </span>\n          </MenuItem>\n        ))}\n      {!filteredList.length && (\n        <MenuItem\n          key=\"no-results\"\n          className=\"no-results\"\n          disabled\n        >\n          <span>{lang('CountryNone')}</span>\n        </MenuItem>\n      )}\n    </DropdownMenu>\n  );\n};\n\nfunction getFilteredList(countryList: ApiCountryCode[], filter = ''): ApiCountryCode[] {\n  if (!filter.length) {\n    return countryList;\n  }\n\n  const searchWords = prepareSearchWordsForNeedle(filter);\n\n  return countryList.filter((country) => (\n    searchWords(country.defaultName) || (country.name && searchWords(country.name))\n  ));\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const { countryList: { phoneCodes: phoneCodeList } } = global;\n    return {\n      phoneCodeList,\n    };\n  },\n)(CountryCodeInput));\n","import {\n  memo, useEffect, useLayoutEffect, useMemo, useRef, useState,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiCountryCode } from '../../api/types';\nimport type { GlobalState } from '../../global/types';\n\nimport { requestMeasure } from '../../lib/fasterdom/fasterdom';\nimport { IS_SAFARI, IS_TOUCH_ENV } from '../../util/browser/windowEnvironment';\nimport { preloadImage } from '../../util/files';\nimport preloadFonts from '../../util/fonts';\nimport { getAccountSlotUrl } from '../../util/multiaccount';\nimport { oldSetLanguage } from '../../util/oldLangProvider';\nimport { formatPhoneNumber, getCountryCodeByIso, getCountryFromPhoneNumber } from '../../util/phoneNumber';\nimport { navigateBack } from './helpers/backNavigation';\nimport { getSuggestedLanguage } from './helpers/getSuggestedLanguage';\n\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\nimport useLangString from '../../hooks/useLangString';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMultiaccountInfo from '../../hooks/useMultiaccountInfo';\n\nimport Button from '../ui/Button';\nimport Checkbox from '../ui/Checkbox';\nimport InputText from '../ui/InputText';\nimport Loading from '../ui/Loading';\nimport CountryCodeInput from './CountryCodeInput';\n\nimport monkeyPath from '../../assets/monkey.svg';\n\ntype StateProps = {\n  auth: GlobalState['auth'];\n  connectionState: GlobalState['connectionState'];\n  language?: string;\n  phoneCodeList: ApiCountryCode[];\n  isTestServer?: boolean;\n};\n\nconst MIN_NUMBER_LENGTH = 7;\n\nlet isPreloadInitiated = false;\n\nconst AuthPhoneNumber = ({\n  auth,\n  connectionState,\n  phoneCodeList,\n  language,\n  isTestServer,\n}: StateProps) => {\n  const {\n    setAuthPhoneNumber,\n    setAuthRememberMe,\n    loadNearestCountry,\n    loadCountryList,\n    clearAuthErrorKey,\n    goToAuthQrCode,\n    setSharedSettingOption,\n    loginWithPasskey,\n  } = getActions();\n\n  const {\n    state,\n    phoneNumber: authPhoneNumber,\n    nearestCountry,\n    isLoading: authIsLoading,\n    errorKey,\n    rememberMe,\n    isLoadingQrCode,\n    passkeyOption,\n  } = auth;\n\n  const lang = useLang();\n  const inputRef = useRef<HTMLInputElement>();\n  const suggestedLanguage = getSuggestedLanguage();\n\n  const isConnected = connectionState === 'connectionStateReady';\n  const continueText = useLangString('AuthContinueOnThisLanguage', suggestedLanguage);\n  const [country, setCountry] = useState<ApiCountryCode | undefined>();\n  const [phoneNumber, setPhoneNumber] = useState<string | undefined>();\n  const [isTouched, setIsTouched] = useState(false);\n  const [lastSelection, setLastSelection] = useState<[number, number] | undefined>();\n  const [isLoading, markIsLoading, unmarkIsLoading] = useFlag();\n\n  const accountsInfo = useMultiaccountInfo();\n  const hasActiveAccount = Object.values(accountsInfo).length > 0;\n  const phoneNumberSlots = useMemo(() => (\n    Object.entries(accountsInfo)\n      .filter(([, info]) => info.isTest === isTestServer)\n      .reduce((acc, [key, { phone }]) => {\n        if (phone) acc[phone] = Number(key);\n        return acc;\n      }, {} as Record<string, number>)\n  ), [accountsInfo, isTestServer]);\n\n  const fullNumber = country ? `+${country.countryCode} ${phoneNumber || ''}` : phoneNumber;\n  const canSubmit = fullNumber && fullNumber.replace(/[^\\d]+/g, '').length >= MIN_NUMBER_LENGTH;\n\n  useEffect(() => {\n    if (!IS_TOUCH_ENV) {\n      inputRef.current!.focus();\n    }\n  }, [country]);\n\n  useEffect(() => {\n    if (isConnected && !nearestCountry) {\n      loadNearestCountry();\n    }\n  }, [isConnected, nearestCountry]);\n\n  useEffect(() => {\n    if (isConnected) {\n      loadCountryList({ langCode: language });\n    }\n  }, [isConnected, language]);\n\n  useEffect(() => {\n    if (nearestCountry && phoneCodeList && !country && !isTouched) {\n      setCountry(getCountryCodeByIso(phoneCodeList, nearestCountry));\n    }\n  }, [country, nearestCountry, isTouched, phoneCodeList]);\n\n  const parseFullNumber = useLastCallback((newFullNumber: string) => {\n    if (!newFullNumber.length) {\n      setPhoneNumber('');\n    }\n\n    const suggestedCountry = phoneCodeList && getCountryFromPhoneNumber(phoneCodeList, newFullNumber);\n\n    // Any phone numbers should be allowed, in some cases ignoring formatting\n    const selectedCountry = !country\n      || (suggestedCountry && suggestedCountry.iso2 !== country.iso2)\n      || (!suggestedCountry && newFullNumber.length)\n      ? suggestedCountry\n      : country;\n\n    if (!country || !selectedCountry || (selectedCountry && selectedCountry.iso2 !== country.iso2)) {\n      setCountry(selectedCountry);\n    }\n    setPhoneNumber(formatPhoneNumber(newFullNumber, selectedCountry));\n  });\n\n  const handleLangChange = useLastCallback(() => {\n    markIsLoading();\n\n    void oldSetLanguage(suggestedLanguage, () => {\n      unmarkIsLoading();\n\n      setSharedSettingOption({ language: suggestedLanguage });\n    });\n  });\n\n  useEffect(() => {\n    if (phoneNumber === undefined && authPhoneNumber) {\n      parseFullNumber(authPhoneNumber);\n    }\n  }, [authPhoneNumber, phoneNumber, parseFullNumber]);\n\n  useLayoutEffect(() => {\n    if (inputRef.current && lastSelection) {\n      inputRef.current.setSelectionRange(...lastSelection);\n    }\n  }, [lastSelection]);\n\n  const isJustPastedRef = useRef(false);\n  const handlePaste = useLastCallback(() => {\n    isJustPastedRef.current = true;\n    requestMeasure(() => {\n      isJustPastedRef.current = false;\n    });\n  });\n\n  const handleBackNavigation = useLastCallback(() => {\n    navigateBack();\n  });\n\n  const handleCountryChange = useLastCallback((value: ApiCountryCode) => {\n    setCountry(value);\n    setPhoneNumber('');\n  });\n\n  const handlePhoneNumberChange = useLastCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    if (errorKey) {\n      clearAuthErrorKey();\n    }\n\n    // This is for further screens. We delay it until user input to speed up the initial loading.\n    if (!isPreloadInitiated) {\n      isPreloadInitiated = true;\n      preloadFonts();\n      void preloadImage(monkeyPath);\n    }\n\n    const { value, selectionStart, selectionEnd } = e.target;\n    setLastSelection(\n      selectionStart && selectionEnd && selectionEnd < value.length\n        ? [selectionStart, selectionEnd]\n        : undefined,\n    );\n\n    setIsTouched(true);\n\n    const shouldFixSafariAutoComplete = (\n      IS_SAFARI && country && fullNumber !== undefined\n      && value.length - fullNumber.length > 1 && !isJustPastedRef.current\n    );\n    parseFullNumber(shouldFixSafariAutoComplete ? `${country.countryCode} ${value}` : value);\n  });\n\n  const handleKeepSessionChange = useLastCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    setAuthRememberMe({ value: e.target.checked });\n  });\n\n  function handleSubmit(event: React.FormEvent<HTMLFormElement>) {\n    event.preventDefault();\n\n    if (authIsLoading) {\n      return;\n    }\n\n    const adaptedPhoneNumber = fullNumber?.replace(/[^\\d]/g, '');\n    if (adaptedPhoneNumber && phoneNumberSlots[adaptedPhoneNumber]) {\n      window.location.replace(getAccountSlotUrl(phoneNumberSlots[adaptedPhoneNumber]));\n      return;\n    }\n\n    if (canSubmit) {\n      setAuthPhoneNumber({ phoneNumber: fullNumber });\n    }\n  }\n\n  const handleGoToAuthQrCode = useLastCallback(() => {\n    goToAuthQrCode();\n  });\n\n  const handleLoginWithPasskey = useLastCallback(() => {\n    loginWithPasskey();\n  });\n\n  const isAuthReady = state === 'authorizationStateWaitPhoneNumber';\n\n  return (\n    <div id=\"auth-phone-number-form\" className=\"custom-scroll\">\n      {hasActiveAccount && (\n        <Button\n          size=\"smaller\"\n          round\n          color=\"translucent\"\n          className=\"auth-close\"\n          iconName=\"close\"\n          onClick={handleBackNavigation}\n        />\n      )}\n      <div className=\"auth-form\">\n        <div id=\"logo\" />\n        <h1>{lang('AuthTitle')}</h1>\n        <p className=\"note\">{lang('StartText')}</p>\n        <form className=\"form\" action=\"\" onSubmit={handleSubmit}>\n          <CountryCodeInput\n            id=\"sign-in-phone-code\"\n            value={country}\n            isLoading={!nearestCountry && !country}\n            onChange={handleCountryChange}\n          />\n          <InputText\n            ref={inputRef}\n            id=\"sign-in-phone-number\"\n            label={lang('LoginPhonePlaceholder')}\n            value={fullNumber}\n            error={errorKey && lang.withRegular(errorKey)}\n            inputMode=\"tel\"\n            onChange={handlePhoneNumberChange}\n            onPaste={IS_SAFARI ? handlePaste : undefined}\n          />\n          <Checkbox\n            id=\"sign-in-keep-session\"\n            label={lang('AuthKeepSignedIn')}\n            checked={Boolean(rememberMe)}\n            onChange={handleKeepSessionChange}\n          />\n          {canSubmit && (\n            isAuthReady ? (\n              <Button\n                className=\"auth-button\"\n                type=\"submit\"\n                ripple\n                isLoading={authIsLoading}\n              >\n                {lang('LoginNext')}\n              </Button>\n            ) : (\n              <Loading />\n            )\n          )}\n          {isAuthReady && (\n            <Button\n              className=\"auth-button\"\n              isText\n              ripple\n              isLoading={isLoadingQrCode}\n              onClick={handleGoToAuthQrCode}\n            >\n              {lang('LoginQRLogin')}\n            </Button>\n          )}\n          {passkeyOption && (\n            <Button className=\"auth-button\" isText onClick={handleLoginWithPasskey}>\n              {lang('LoginPasskey')}\n            </Button>\n          )}\n          {suggestedLanguage && suggestedLanguage !== language && continueText && (\n            <Button\n              className=\"auth-button\"\n              isText\n              isLoading={isLoading}\n              onClick={handleLangChange}\n            >\n              {continueText}\n            </Button>\n          )}\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    const {\n      sharedState: { settings: { language } },\n      countryList: { phoneCodes: phoneCodeList },\n      config,\n      auth,\n      connectionState,\n    } = global;\n\n    return {\n      auth,\n      connectionState,\n      language,\n      phoneCodeList,\n      isTestServer: config?.isTestServer,\n    };\n  },\n)(AuthPhoneNumber));\n","import {\n  memo, useLayoutEffect, useRef,\n} from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\n\nimport { STRICTERDOM_ENABLED } from '../../config';\nimport { disableStrict, enableStrict } from '../../lib/fasterdom/stricterdom';\nimport { selectSharedSettings } from '../../global/selectors/sharedState';\nimport buildClassName from '../../util/buildClassName';\nimport { oldSetLanguage } from '../../util/oldLangProvider';\nimport { LOCAL_TGS_URLS } from '../common/helpers/animatedAssets';\nimport { navigateBack } from './helpers/backNavigation';\nimport { getSuggestedLanguage } from './helpers/getSuggestedLanguage';\n\nimport useAsync from '../../hooks/useAsync';\nimport useFlag from '../../hooks/useFlag';\nimport useLang from '../../hooks/useLang';\nimport useLangString from '../../hooks/useLangString';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useMediaTransitionDeprecated from '../../hooks/useMediaTransitionDeprecated';\nimport useMultiaccountInfo from '../../hooks/useMultiaccountInfo';\n\nimport AnimatedIcon from '../common/AnimatedIcon';\nimport Button from '../ui/Button';\nimport Loading from '../ui/Loading';\n\nimport blankUrl from '../../assets/blank.png';\n\ntype StateProps = {\n  auth: GlobalState['auth'];\n  connectionState: GlobalState['connectionState'];\n  language?: string;\n};\n\nconst DATA_PREFIX = 'tg://login?token=';\nconst QR_SIZE = 280;\nconst QR_PLANE_SIZE = 54;\nconst QR_CODE_MUTATION_DURATION = 50; // The library is asynchronous and we need to wait for its mutation code\n\nlet qrCodeStylingPromise: Promise<typeof import('qr-code-styling')> | undefined;\n\nfunction ensureQrCodeStyling() {\n  if (!qrCodeStylingPromise) {\n    qrCodeStylingPromise = import('qr-code-styling');\n  }\n  return qrCodeStylingPromise;\n}\n\nconst AuthCode = ({\n  connectionState,\n  auth,\n  language,\n}: StateProps) => {\n  const {\n    returnToAuthPhoneNumber,\n    setSharedSettingOption,\n    loginWithPasskey,\n  } = getActions();\n\n  const { state, qrCode: authQrCode, passkeyOption } = auth;\n\n  const suggestedLanguage = getSuggestedLanguage();\n  const lang = useLang();\n  const qrCodeRef = useRef<HTMLDivElement>();\n\n  const isConnected = connectionState === 'connectionStateReady';\n  const continueText = useLangString('AuthContinueOnThisLanguage', suggestedLanguage);\n  const [isLoading, markIsLoading, unmarkIsLoading] = useFlag();\n  const [isQrMounted, markQrMounted, unmarkQrMounted] = useFlag();\n\n  const accountsInfo = useMultiaccountInfo();\n  const hasActiveAccount = Object.values(accountsInfo).length > 0;\n\n  const { result: qrCode } = useAsync(async () => {\n    const QrCodeStyling = (await ensureQrCodeStyling()).default;\n    return new QrCodeStyling({\n      width: QR_SIZE,\n      height: QR_SIZE,\n      image: blankUrl,\n      margin: 10,\n      type: 'svg',\n      dotsOptions: {\n        type: 'rounded',\n      },\n      cornersSquareOptions: {\n        type: 'extra-rounded',\n      },\n      imageOptions: {\n        imageSize: 0.4,\n        margin: 8,\n      },\n      qrOptions: {\n        errorCorrectionLevel: 'M',\n      },\n    });\n  }, []);\n\n  const transitionClassNames = useMediaTransitionDeprecated(isQrMounted);\n\n  useLayoutEffect(() => {\n    if (!authQrCode || !qrCode) {\n      return () => {\n        unmarkQrMounted();\n      };\n    }\n\n    if (!isConnected) {\n      return undefined;\n    }\n\n    const container = qrCodeRef.current!;\n    const data = `${DATA_PREFIX}${authQrCode.token}`;\n\n    if (STRICTERDOM_ENABLED) {\n      disableStrict();\n    }\n\n    qrCode.update({\n      data,\n    });\n\n    if (!isQrMounted) {\n      qrCode.append(container);\n      markQrMounted();\n    }\n\n    if (STRICTERDOM_ENABLED) {\n      setTimeout(() => {\n        enableStrict();\n      }, QR_CODE_MUTATION_DURATION);\n    }\n\n    return undefined;\n  }, [isConnected, authQrCode, isQrMounted, qrCode]);\n\n  const handleBackNavigation = useLastCallback(() => {\n    navigateBack();\n  });\n\n  const handleLangChange = useLastCallback(() => {\n    markIsLoading();\n\n    void oldSetLanguage(suggestedLanguage, () => {\n      unmarkIsLoading();\n\n      setSharedSettingOption({ language: suggestedLanguage });\n    });\n  });\n\n  const handleReturnToAuthPhoneNumber = useLastCallback(() => {\n    returnToAuthPhoneNumber();\n  });\n\n  const handleLoginWithPasskey = useLastCallback(() => {\n    loginWithPasskey();\n  });\n\n  const isAuthReady = state === 'authorizationStateWaitQrCode';\n\n  return (\n    <div id=\"auth-qr-form\" className=\"custom-scroll\">\n      {hasActiveAccount && (\n        <Button\n          size=\"smaller\"\n          round\n          color=\"translucent\"\n          className=\"auth-close\"\n          iconName=\"close\"\n          onClick={handleBackNavigation}\n        />\n      )}\n      <div className=\"auth-form qr\">\n        <div className=\"qr-outer\">\n          <div\n            className={buildClassName('qr-inner', transitionClassNames)}\n            key=\"qr-inner\"\n          >\n            <div\n              key=\"qr-container\"\n              className=\"qr-container\"\n              ref={qrCodeRef}\n              style={`width: ${QR_SIZE}px; height: ${QR_SIZE}px`}\n            />\n            <AnimatedIcon\n              tgsUrl={LOCAL_TGS_URLS.QrPlane}\n              size={QR_PLANE_SIZE}\n              className=\"qr-plane\"\n              nonInteractive\n              noLoop={false}\n            />\n          </div>\n          {!isQrMounted && <div className=\"qr-loading\"><Loading /></div>}\n        </div>\n        <h1>{lang('LoginQRTitle')}</h1>\n        <ol>\n          <li><span>{lang('LoginQRHelp1')}</span></li>\n          <li><span>{lang('LoginQRHelp2', undefined, { withNodes: true, withMarkdown: true })}</span></li>\n          <li><span>{lang('LoginQRHelp3')}</span></li>\n        </ol>\n        {isAuthReady && (\n          <Button className=\"auth-button\" isText onClick={handleReturnToAuthPhoneNumber}>\n            {lang('LoginQRCancel')}\n          </Button>\n        )}\n        {passkeyOption && (\n          <Button className=\"auth-button\" isText onClick={handleLoginWithPasskey}>\n            {lang('LoginPasskey')}\n          </Button>\n        )}\n        {suggestedLanguage && suggestedLanguage !== language && continueText && (\n          <Button className=\"auth-button\" isText isLoading={isLoading} onClick={handleLangChange}>\n            {continueText}\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    const {\n      connectionState, auth,\n    } = global;\n\n    const { language } = selectSharedSettings(global);\n\n    return {\n      connectionState,\n      auth,\n      language,\n    };\n  },\n)(AuthCode));\n","import { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nimport Loading from '../ui/Loading';\n\nconst AuthRegisterAsync = () => {\n  const AuthRegister = useModuleLoader(Bundles.Auth, 'AuthRegister');\n\n  return AuthRegister ? <AuthRegister /> : <Loading />;\n};\n\nexport default AuthRegisterAsync;\n","import '../../global/actions/initial';\n\nimport { memo } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { GlobalState } from '../../global/types';\n\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport { IS_MAC_OS, PLATFORM_ENV } from '../../util/browser/windowEnvironment';\n\nimport useCurrentOrPrev from '../../hooks/useCurrentOrPrev';\nimport useHistoryBack from '../../hooks/useHistoryBack';\n\nimport Transition from '../ui/Transition';\nimport AuthCode from './AuthCode.async';\nimport AuthPassword from './AuthPassword.async';\nimport AuthPhoneNumber from './AuthPhoneNumber';\nimport AuthQrCode from './AuthQrCode';\nimport AuthRegister from './AuthRegister.async';\n\nimport './Auth.scss';\n\ntype StateProps = {\n  authState: GlobalState['auth']['state'];\n};\n\nconst Auth = ({\n  authState,\n}: StateProps) => {\n  const {\n    returnToAuthPhoneNumber, goToAuthQrCode,\n  } = getActions();\n\n  const isMobile = PLATFORM_ENV === 'iOS' || PLATFORM_ENV === 'Android';\n\n  const handleChangeAuthorizationMethod = () => {\n    if (!isMobile) {\n      goToAuthQrCode();\n    } else {\n      returnToAuthPhoneNumber();\n    }\n  };\n\n  useHistoryBack({\n    isActive: (!isMobile && authState === 'authorizationStateWaitPhoneNumber')\n      || (isMobile && authState === 'authorizationStateWaitQrCode'),\n    onBack: handleChangeAuthorizationMethod,\n  });\n\n  // For animation purposes\n  const renderingAuthState = useCurrentOrPrev(\n    authState !== 'authorizationStateReady' ? authState : undefined,\n    true,\n  );\n\n  function getScreen() {\n    switch (renderingAuthState) {\n      case 'authorizationStateWaitCode':\n        return <AuthCode />;\n      case 'authorizationStateWaitPassword':\n        return <AuthPassword />;\n      case 'authorizationStateWaitRegistration':\n        return <AuthRegister />;\n      case 'authorizationStateWaitPhoneNumber':\n        return <AuthPhoneNumber />;\n      case 'authorizationStateWaitQrCode':\n        return <AuthQrCode />;\n      default:\n        return isMobile ? <AuthPhoneNumber /> : <AuthQrCode />;\n    }\n  }\n\n  function getActiveKey() {\n    switch (renderingAuthState) {\n      case 'authorizationStateWaitCode':\n        return 0;\n      case 'authorizationStateWaitPassword':\n        return 1;\n      case 'authorizationStateWaitRegistration':\n        return 2;\n      case 'authorizationStateWaitPhoneNumber':\n        return 3;\n      case 'authorizationStateWaitQrCode':\n        return 4;\n      default:\n        return isMobile ? 3 : 4;\n    }\n  }\n\n  return (\n    <Transition\n      activeKey={getActiveKey()}\n      name=\"fade\"\n      className=\"Auth\"\n      data-tauri-drag-region={IS_TAURI && IS_MAC_OS ? true : undefined}\n    >\n      {getScreen()}\n    </Transition>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    return {\n      authState: global.auth.state,\n    };\n  },\n)(Auth));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"eldglPwL\",\"svg\":\"xhUfxjkV\",\"circle\":\"hsaty2zA\"};","import { memo, useEffect, useState } from '../../lib/teact/teact';\n\nimport buildClassName from '../../util/buildClassName';\nimport { formatCountdownShort } from '../../util/dates/dateFormat';\n\nimport useInterval from '../../hooks/schedulers/useInterval';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport AnimatedCounter from '../common/AnimatedCounter';\n\nimport styles from './RoundTimer.module.scss';\n\ntype OwnProps = {\n  duration: number;\n  className?: string;\n  onEnd?: NoneToVoidFunction;\n};\n\nconst UPDATE_FREQUENCY = 1000;\nconst TIMER_RADIUS = 14;\n\nconst RoundTimer = ({ duration, className, onEnd }: OwnProps) => {\n  const [timeLeft, setTimeLeft] = useState(duration);\n  const lang = useOldLang();\n\n  useInterval(\n    () => setTimeLeft((prev) => prev - 1),\n    timeLeft > 0 ? UPDATE_FREQUENCY : undefined,\n  );\n\n  useEffect(() => {\n    if (timeLeft <= 0) {\n      onEnd?.();\n    }\n  }, [timeLeft, onEnd]);\n\n  useEffect(() => {\n    setTimeLeft(duration);\n  }, [duration]);\n\n  return (\n    <div className={buildClassName(styles.root, className)}>\n      <svg className={styles.svg} width=\"32px\" height=\"32px\">\n        <circle\n          cx=\"16\"\n          cy=\"16\"\n          r={TIMER_RADIUS}\n          transform=\"rotate(-90, 16, 16)\"\n          pathLength=\"100\"\n          stroke-dasharray=\"100\"\n          stroke-dashoffset={100 - ((timeLeft - 1) / duration) * 100} // Show it one step further due to animation\n          className={styles.circle}\n        />\n      </svg>\n      <AnimatedCounter className={styles.text} text={formatCountdownShort(lang, timeLeft * 1000)} />\n    </div>\n  );\n};\n\nexport default memo(RoundTimer);\n","import type { FC } from '../../lib/teact/teact';\nimport {\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type { ApiNotification } from '../../api/types';\nimport { isLangFnParam } from '../../util/localization/types';\n\nimport { ANIMATION_END_DELAY } from '../../config';\nimport buildClassName from '../../util/buildClassName';\nimport captureEscKeyListener from '../../util/captureEscKeyListener';\nimport { REM } from '../common/helpers/mediaDimensions';\nimport renderText from '../common/helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useShowTransitionDeprecated from '../../hooks/useShowTransitionDeprecated';\n\nimport CustomEmoji from '../common/CustomEmoji';\nimport Icon from '../common/icons/Icon';\nimport StarIcon from '../common/icons/StarIcon';\nimport Button from './Button';\nimport Portal from './Portal';\nimport RoundTimer from './RoundTimer';\n\nimport './Notification.scss';\n\ntype OwnProps = {\n  notification: ApiNotification;\n};\n\nconst DEFAULT_DURATION = 3000;\nconst ANIMATION_DURATION = 150;\nconst CUSTOM_EMOJI_SIZE = 1.75 * REM;\n\nconst Notification: FC<OwnProps> = ({\n  notification,\n}) => {\n  const actions = getActions();\n\n  const lang = useLang();\n\n  const {\n    localId,\n    message,\n    action,\n    actionText,\n    cacheBreaker,\n    className,\n    disableClickDismiss,\n    dismissAction,\n    duration = DEFAULT_DURATION,\n    icon,\n    shouldUseCustomIcon,\n    customEmojiIconId,\n    shouldShowTimer,\n    title,\n    containerSelector,\n  } = notification;\n\n  const [isOpen, setIsOpen] = useState(true);\n  const timerRef = useRef<number | undefined>();\n  const { transitionClassNames } = useShowTransitionDeprecated(isOpen);\n\n  const handleDismiss = useLastCallback(() => {\n    actions.dismissNotification({ localId });\n  });\n\n  const closeAndDismiss = useLastCallback((force?: boolean) => {\n    if (!force && disableClickDismiss) return;\n    setIsOpen(false);\n    setTimeout(handleDismiss, ANIMATION_DURATION + ANIMATION_END_DELAY);\n    if (dismissAction) {\n      // @ts-ignore\n      actions[dismissAction.action](dismissAction.payload);\n    }\n  });\n\n  const handleActionClick = useLastCallback(() => {\n    if (action) {\n      if (Array.isArray(action)) {\n        // @ts-ignore\n        action.forEach((cb) => actions[cb.action](cb.payload));\n      } else {\n        // @ts-ignore\n        actions[action.action](action.payload);\n      }\n    }\n    if (disableClickDismiss) {\n      setIsOpen(false);\n      setTimeout(handleDismiss, ANIMATION_DURATION + ANIMATION_END_DELAY);\n    }\n    closeAndDismiss();\n  });\n\n  const handleClick = useLastCallback(() => {\n    if (action) {\n      if (Array.isArray(action)) {\n        // @ts-ignore\n        action.forEach((cb) => actions[cb.action](cb.payload));\n      } else {\n        // @ts-ignore\n        actions[action.action](action.payload);\n      }\n    }\n    closeAndDismiss();\n  });\n\n  useEffect(() => (isOpen ? captureEscKeyListener(closeAndDismiss) : undefined), [isOpen, closeAndDismiss]);\n\n  useEffect(() => {\n    timerRef.current = window.setTimeout(() => closeAndDismiss(true), duration);\n\n    return () => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        timerRef.current = undefined;\n      }\n    };\n  }, [duration, cacheBreaker]); // Reset timer if `cacheBreaker` changes\n\n  const handleMouseEnter = useLastCallback(() => {\n    if (disableClickDismiss) return;\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = undefined;\n    }\n  });\n\n  const handleMouseLeave = useLastCallback(() => {\n    if (disableClickDismiss) return;\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n    }\n    timerRef.current = window.setTimeout(closeAndDismiss, duration);\n  });\n\n  const renderedTitle = useMemo(() => {\n    if (!title) return undefined;\n    if (isLangFnParam(title)) {\n      return lang.with(title);\n    }\n\n    return renderText(title, ['simple_markdown', 'emoji', 'br', 'links']);\n  }, [lang, title]);\n\n  const renderedMessage = useMemo(() => {\n    if (isLangFnParam(message)) {\n      return lang.with(message);\n    }\n\n    if (typeof message === 'string') {\n      return renderText(message, ['simple_markdown', 'emoji', 'br', 'links']);\n    }\n\n    return message;\n  }, [lang, message]);\n\n  const renderedActionText = useMemo(() => {\n    if (!actionText) return undefined;\n    if (isLangFnParam(actionText)) {\n      return lang.with(actionText);\n    }\n\n    return actionText;\n  }, [lang, actionText]);\n\n  const renderedIcon = useMemo(() => {\n    if (customEmojiIconId) {\n      return (\n        <CustomEmoji\n          className=\"notification-emoji-icon\"\n          forceAlways\n          size={CUSTOM_EMOJI_SIZE}\n          documentId={customEmojiIconId}\n        />\n      );\n    }\n\n    if (shouldUseCustomIcon) {\n      if (icon === 'star') {\n        return (\n          <StarIcon type=\"gold\" className={buildClassName('notification-icon')} size=\"adaptive\" />\n        );\n      }\n    }\n    return <Icon name={icon || 'info-filled'} className=\"notification-icon\" />;\n  }, [customEmojiIconId, icon, shouldUseCustomIcon]);\n\n  return (\n    <Portal className=\"Notification-container\" containerSelector={containerSelector}>\n      <div\n        className={buildClassName('Notification', transitionClassNames, className)}\n        onClick={handleClick}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n      >\n        {renderedIcon}\n        <div className=\"content\">\n          {Boolean(renderedTitle) && (\n            <div className=\"notification-title\">{renderedTitle}</div>\n          )}\n          {renderedMessage}\n        </div>\n        {Boolean(renderedActionText) && (\n          <Button\n            color=\"translucent-white\"\n            onClick={handleActionClick}\n            className=\"notification-button\"\n          >\n            {renderedActionText}\n          </Button>\n        )}\n        {shouldShowTimer && (\n          <RoundTimer className=\"notification-timer\" key={cacheBreaker} duration={Math.ceil(duration / 1000)} />\n        )}\n      </div>\n    </Portal>\n  );\n};\n\nexport default Notification;\n","import { memo } from '../../lib/teact/teact';\nimport { withGlobal } from '../../global';\n\nimport type { ApiNotification } from '../../api/types';\n\nimport { selectTabState } from '../../global/selectors';\nimport { pick } from '../../util/iteratees';\n\nimport Notification from '../ui/Notification';\n\ntype StateProps = {\n  notifications: ApiNotification[];\n};\n\nconst Notifications = ({ notifications }: StateProps) => {\n  if (!notifications.length) {\n    return undefined;\n  }\n\n  return (\n    <div id=\"Notifications\">\n      {notifications.map((notification) => (\n        <Notification key={notification.localId} notification={notification} />\n      ))}\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => pick(selectTabState(global), ['notifications']),\n)(Notifications));\n","// extracted by mini-css-extract-plugin\nexport default {\"bg\":\"ThfRMqwq\"};","// extracted by mini-css-extract-plugin\nexport default {\"mask\":\"U9MowLv_\",\"main\":\"RcG6eRZw\",\"foldersSidebarVisible\":\"oHY8tVQC\",\"foldersSidebar\":\"HjZ2pMig\",\"left\":\"oL7XcRwI\",\"middle\":\"LYe7IaQO\",\"right\":\"wYSGQZXX\",\"blank\":\"kN2M6u9m\"};","import type { FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { getActions, getGlobal, withGlobal } from '../../global';\n\nimport type { TabState } from '../../global/types';\nimport { ApiMediaFormat } from '../../api/types';\n\nimport { FOLDERS_POSITION_LEFT } from '../../config';\nimport { getChatAvatarHash } from '../../global/helpers/chats'; // Direct import for better module splitting\nimport { selectAreFoldersPresent, selectIsRightColumnShown, selectTabState } from '../../global/selectors';\nimport { selectSharedSettings } from '../../global/selectors/sharedState';\nimport buildClassName from '../../util/buildClassName';\nimport { preloadImage } from '../../util/files';\nimport preloadFonts from '../../util/fonts';\nimport { localizationReadyPromise } from '../../util/localization';\nimport * as mediaLoader from '../../util/mediaLoader';\nimport { Bundles, loadModule } from '../../util/moduleLoader';\nimport { pause } from '../../util/schedulers';\n\nimport useEffectOnce from '../../hooks/useEffectOnce';\nimport useFlag from '../../hooks/useFlag';\nimport useShowTransitionDeprecated from '../../hooks/useShowTransitionDeprecated';\n\n// Workaround for incorrect bundling by Webpack: force including in the main chunk\nimport '../ui/Modal.scss';\nimport './Avatar.scss';\nimport appStyles from '../App.module.scss';\nimport styles from './UiLoader.module.scss';\n\nimport lockPreviewPath from '../../assets/lock.png';\nimport monkeyPath from '../../assets/monkey.svg';\nimport spoilerMaskPath from '../../assets/spoilers/mask.svg';\nimport telegramLogoPath from '../../assets/telegram-logo.svg';\n\nexport type UiLoaderPage =\n  'welcome'\n  | 'main'\n  | 'lock'\n  | 'inactive'\n  | 'authCode'\n  | 'authPassword'\n  | 'authPhoneNumber'\n  | 'authQrCode';\n\ntype OwnProps = {\n  page?: UiLoaderPage;\n  children: React.ReactNode;\n  isMobile?: boolean;\n};\n\ntype StateProps = Pick<TabState, 'uiReadyState' | 'shouldSkipHistoryAnimations'> & {\n  isRightColumnShown?: boolean;\n  leftColumnWidth?: number;\n  isFoldersSidebarShown?: boolean;\n};\n\nconst MAX_PRELOAD_DELAY = 700;\nconst SECOND_STATE_DELAY = 1000;\nconst AVATARS_TO_PRELOAD = 10;\n\nfunction preloadAvatars() {\n  const { listIds, byId } = getGlobal().chats;\n  if (!listIds.active) {\n    return undefined;\n  }\n\n  return Promise.all(listIds.active.slice(0, AVATARS_TO_PRELOAD).map(async (chatId) => {\n    const chat = byId[chatId];\n    if (!chat) {\n      return undefined;\n    }\n\n    const avatarHash = getChatAvatarHash(chat);\n    if (!avatarHash) {\n      return undefined;\n    }\n\n    return mediaLoader.fetch(avatarHash, ApiMediaFormat.BlobUrl);\n  }));\n}\n\nconst preloadTasks = {\n  main: () => Promise.all([\n    loadModule(Bundles.Main)\n      .then(preloadFonts),\n    preloadAvatars(),\n    preloadImage(spoilerMaskPath),\n    localizationReadyPromise,\n  ]),\n  authPhoneNumber: () => Promise.all([\n    preloadFonts(),\n    preloadImage(telegramLogoPath),\n  ]),\n  authCode: () => preloadImage(monkeyPath),\n  authPassword: () => preloadImage(monkeyPath),\n  authQrCode: preloadFonts,\n  lock: () => Promise.all([\n    preloadFonts(),\n    preloadImage(lockPreviewPath),\n  ]),\n  inactive: () => {\n  },\n};\n\nconst UiLoader: FC<OwnProps & StateProps> = ({\n  page,\n  children,\n  isRightColumnShown,\n  shouldSkipHistoryAnimations,\n  leftColumnWidth,\n  isFoldersSidebarShown,\n}) => {\n  const { setIsUiReady } = getActions();\n\n  const [isReady, markReady] = useFlag();\n  const {\n    shouldRender: shouldRenderMask, transitionClassNames,\n  } = useShowTransitionDeprecated(!isReady, undefined, true);\n\n  useEffectOnce(() => {\n    let timeout: number | undefined;\n\n    const safePreload = async () => {\n      try {\n        await preloadTasks[page!]();\n      } catch (err) {\n        // Do nothing\n      }\n    };\n\n    Promise.race([\n      pause(MAX_PRELOAD_DELAY),\n      page ? safePreload() : Promise.resolve(),\n    ]).then(() => {\n      markReady();\n      setIsUiReady({ uiReadyState: 1 });\n\n      timeout = window.setTimeout(() => {\n        setIsUiReady({ uiReadyState: 2 });\n      }, SECOND_STATE_DELAY);\n    });\n\n    return () => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = undefined;\n      }\n\n      setIsUiReady({ uiReadyState: 0 });\n    };\n  });\n\n  return (\n    <>\n      {children}\n      {shouldRenderMask && !shouldSkipHistoryAnimations && Boolean(page) && (\n        <div className={buildClassName(styles.mask, transitionClassNames)}>\n          {page === 'main' ? (\n            <div className={buildClassName(styles.main, isFoldersSidebarShown && styles.foldersSidebarVisible)}>\n              {isFoldersSidebarShown && <div className={styles.foldersSidebar} />}\n              <div\n                className={styles.left}\n                style={leftColumnWidth ? `width: ${leftColumnWidth}px` : undefined}\n              />\n              <div className={buildClassName(styles.middle, appStyles.bg)} />\n              {isRightColumnShown && <div className={styles.right} />}\n            </div>\n          ) : (page === 'inactive' || page === 'lock') ? (\n            <div className={buildClassName(styles.blank, appStyles.bg)} />\n          ) : (\n            <div className={styles.blank} />\n          )}\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default withGlobal<OwnProps>(\n  (global, { isMobile }): Complete<StateProps> => {\n    const tabState = selectTabState(global);\n\n    const { foldersPosition } = selectSharedSettings(global);\n\n    return {\n      shouldSkipHistoryAnimations: tabState.shouldSkipHistoryAnimations,\n      uiReadyState: tabState.uiReadyState,\n      isRightColumnShown: selectIsRightColumnShown(global, isMobile),\n      leftColumnWidth: global.leftColumnWidth,\n      isFoldersSidebarShown: foldersPosition === FOLDERS_POSITION_LEFT && !isMobile && selectAreFoldersPresent(global),\n    };\n  },\n)(UiLoader);\n","import renderText from '../common/helpers/renderText';\n\nimport useHistoryBack from '../../hooks/useHistoryBack';\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Button from '../ui/Button';\n\nimport './AppInactive.scss';\n\nimport appInactivePath from '../../assets/app-inactive.png';\n\ntype OwnProps = {\n  inactiveReason: 'auth' | 'otherClient';\n};\n\nconst AppInactive = ({ inactiveReason }: OwnProps) => {\n  const lang = useLang();\n\n  const handleReload = useLastCallback(() => {\n    window.location.reload();\n  });\n\n  useHistoryBack({\n    isActive: true,\n    onBack: handleReload,\n    shouldResetUrlHash: true,\n  });\n\n  return (\n    <div id=\"AppInactive\">\n      <div className=\"content\">\n        <img src={appInactivePath} alt=\"\" />\n        <h3 className=\"title\">\n          {inactiveReason === 'auth' ? lang('AppInactiveAuthTitle') : lang('AppInactiveOtherClientTitle')}\n        </h3>\n        <div className=\"description\">\n          {renderText(\n            lang(inactiveReason === 'auth' ? 'AppInactiveAuthDescription' : 'AppInactiveOtherClientDescription'),\n            ['br'],\n          )}\n        </div>\n        <div className=\"actions\">\n          <Button isText ripple onClick={handleReload}>\n            {lang('AppInactiveReload')}\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AppInactive;\n","import type { OwnProps } from './LockScreen';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst LockScreenAsync = (props: OwnProps) => {\n  const { isLocked } = props;\n  const LockScreen = useModuleLoader(Bundles.Main, 'LockScreen', !isLocked);\n\n  return LockScreen ? <LockScreen {...props} /> : undefined;\n};\n\nexport default LockScreenAsync;\n","import type { OwnProps } from './Main';\n\nimport { Bundles } from '../../util/moduleLoader';\n\nimport useModuleLoader from '../../hooks/useModuleLoader';\n\nconst MainAsync = (props: OwnProps) => {\n  const Main = useModuleLoader(Bundles.Main, 'Main');\n\n  return Main ? <Main {...props} /> : undefined;\n};\n\nexport default MainAsync;\n","import { memo, useState } from '@teact';\n\nimport { HAS_COMPLETED_WELCOME_KEY } from '../../config';\n\nimport useLastCallback from '../../hooks/useLastCallback';\n\nimport Button from '../ui/Button';\n\nimport './Welcome.scss';\n\nconst Welcome = () => {\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleGetStarted = useLastCallback(() => {\n    // Mark welcome as completed (device-specific)\n    localStorage.setItem(HAS_COMPLETED_WELCOME_KEY, 'true');\n    setIsLoading(true);\n  });\n\n  return (\n    <div id=\"welcome-form\" className=\"custom-scroll\">\n      <div className=\"welcome-form\">\n        <div className=\"welcome-lottie\">\n          <img src=\"/icon-square-192x192.png\" alt=\"AlphaHuman Logo\" />\n          {/* <AnimatedSticker\n            tgsUrl={LOCAL_TGS_URLS.HealthyStar}\n            size={300}\n            play\n            noLoop={false}\n            forceAlways\n          /> */}\n        </div>\n        <h1>Welcome to AlphaHuman</h1>\n        <p className=\"note\">\n          Summarize your busiest chats, execute human-like tasks in seconds, and connect your\n          favorite tools to get more done, faster. All on Telegram.\n          <br />\n          <br />\n          Are you ready to get AI superpowers?\n          <br />\n          <br />\n          <small>\n            (This is a telegram client so all your credentials are stored in\n            your device and never passed onto any servers)\n          </small>\n        </p>\n        <Button\n          className=\"auth-button welcome-button\"\n          onClick={handleGetStarted}\n          isLoading={isLoading}\n          disabled={isLoading}\n        >\n          Let&apos;s Cook \n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default memo(Welcome);\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"R4QrqW5I\",\"content\":\"QlxeWA0E\",\"spinner\":\"wxHs5sjQ\",\"spin\":\"MKGEz9UN\",\"icon\":\"B5uX29gR\",\"title\":\"Yphd6w3h\",\"message\":\"vLjLWJ5_\",\"actions\":\"kl34uAW2\",\"countdown\":\"kQ0qCKVq\",\"homeButton\":\"bIzV_NoA\"};","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"onYr0umE\",\"content\":\"vnO4SUh2\",\"spinner\":\"OQJDRPRw\",\"spin\":\"Rh67bG5q\",\"icon\":\"LaWrwWyv\",\"title\":\"iSe4TLLh\",\"message\":\"GfYGCbG9\",\"actions\":\"jv3pO0cg\",\"countdown\":\"P8reD1qX\",\"homeButton\":\"ZX2ZXEF7\"};","import { useEffect, useLayoutEffect, useState } from '../lib/teact/teact';\nimport { withGlobal } from '../global';\n\nimport type { GlobalState } from '../global/types';\nimport type { ThemeKey } from '../types';\nimport type { UiLoaderPage } from './common/UiLoader';\n\nimport { DARK_THEME_BG_COLOR, INACTIVE_MARKER, LIGHT_THEME_BG_COLOR, PAGE_TITLE, PAGE_TITLE_TAURI } from '../config';\nimport { HAS_COMPLETED_WELCOME_KEY } from '../config';\nimport { forceMutation } from '../lib/fasterdom/stricterdom.ts';\nimport { selectActionMessageBg, selectTabState, selectTheme } from '../global/selectors';\nimport { IS_TAURI } from '../util/browser/globalEnvironment';\nimport { IS_INSTALL_PROMPT_SUPPORTED, PLATFORM_ENV } from '../util/browser/windowEnvironment';\nimport buildClassName from '../util/buildClassName';\nimport { setupBeforeInstallPrompt } from '../util/installPrompt';\nimport { ACCOUNT_SLOT, getAccountsInfo, getAccountSlotUrl } from '../util/multiaccount';\nimport { hasEncryptedSession } from '../util/passcode';\nimport { getInitialLocationHash, isNotionOAuthCallback, isGoogleOAuthCallback, parseInitialLocationHash } from '../util/routing';\nimport { checkSessionLocked, hasStoredSession } from '../util/sessions';\nimport { updateSizes } from '../util/windowSize';\n\nimport useTauriDrag from '../hooks/tauri/useTauriDrag';\nimport useAppLayout from '../hooks/useAppLayout';\nimport usePrevious from '../hooks/usePrevious';\nimport { useSignalEffect } from '../hooks/useSignalEffect';\nimport { getIsInBackground } from '../hooks/window/useBackgroundMode';\n\n// import Test from './test/TestLocale';\nimport Auth from './auth/Auth';\nimport Notifications from './common/Notifications';\nimport UiLoader from './common/UiLoader';\nimport AppInactive from './main/AppInactive';\nimport LockScreen from './main/LockScreen.async';\nimport Main from './main/Main.async';\nimport Transition from './ui/Transition';\nimport Welcome from './welcome/Welcome';\nimport NotionOAuthCallback from './auth/NotionOAuthCallback';\nimport GoogleOAuthCallback from './auth/GoogleOAuthCallback';\n\n// OAuth Provider Components Mapping\nconst OAUTH_COMPONENTS = {\n  notion: NotionOAuthCallback,\n  google: GoogleOAuthCallback,\n  // Future providers can be easily added here:\n  // github: GitHubOAuthCallback,\n  // slack: SlackOAuthCallback,\n  // discord: DiscordOAuthCallback,\n} as const;\n\nimport styles from './App.module.scss';\n\ntype StateProps = {\n  authState: GlobalState['auth']['state'];\n  isScreenLocked?: boolean;\n  hasPasscode?: boolean;\n  inactiveReason?: 'auth' | 'otherClient';\n  hasWebAuthTokenFailed?: boolean;\n  isTestServer?: boolean;\n  theme: ThemeKey;\n  actionMessageBg?: string;\n};\n\nenum AppScreens {\n  welcome,\n  auth,\n  main,\n  lock,\n  inactive,\n  oauthCallback,\n}\n\nconst TRANSITION_RENDER_COUNT = Object.keys(AppScreens).length / 2;\nconst ACTIVE_PAGE_TITLE = IS_TAURI ? PAGE_TITLE_TAURI : PAGE_TITLE;\nconst INACTIVE_PAGE_TITLE = `${ACTIVE_PAGE_TITLE} ${INACTIVE_MARKER}`;\n\nconst App = ({\n  authState,\n  isScreenLocked,\n  hasPasscode,\n  inactiveReason,\n  hasWebAuthTokenFailed,\n  isTestServer,\n  theme,\n  actionMessageBg,\n}: StateProps) => {\n  const { isMobile } = useAppLayout();\n  const isMobileOs = PLATFORM_ENV === 'iOS' || PLATFORM_ENV === 'Android';\n\n  useEffect(() => {\n    if (IS_INSTALL_PROMPT_SUPPORTED) {\n      setupBeforeInstallPrompt();\n    }\n  }, []);\n\n  useEffect(() => {\n    const hash = getInitialLocationHash();\n    // If there is no stored session on first slot, navigate to any other slot with stored session\n    if (!hasStoredSession() && !ACCOUNT_SLOT && !hash) {\n      const accounts = getAccountsInfo();\n      Object.keys(accounts)\n        .map(Number)\n        .sort((a, b) => b - a)\n        .forEach((key) => {\n          const slot = Number(key);\n          const account = accounts[slot];\n          if (account) {\n            const url = getAccountSlotUrl(slot);\n            window.location.href = `${url}#${hash || 'login'}`;\n          }\n        });\n    }\n\n    // TODO[Passcode]: Remove when multiacc passcode is implemented\n    const checkMultiaccPasscode = async () => {\n      if (checkSessionLocked() && ACCOUNT_SLOT && await hasEncryptedSession()) {\n        const url = getAccountSlotUrl(1);\n        window.location.href = url;\n      }\n    };\n    checkMultiaccPasscode();\n  }, []);\n\n  // Prevent drop on elements that do not accept it\n  useEffect(() => {\n    const body = document.body;\n    const handleDrag = (e: DragEvent) => {\n      e.preventDefault();\n      if (!e.dataTransfer) return;\n      if (!(e.target as HTMLElement).dataset.dropzone) {\n        e.dataTransfer.dropEffect = 'none';\n      } else {\n        e.dataTransfer.dropEffect = 'copy';\n      }\n    };\n    const handleDrop = (e: DragEvent) => {\n      e.preventDefault();\n    };\n    body.addEventListener('drop', handleDrop);\n    body.addEventListener('dragover', handleDrag);\n    body.addEventListener('dragenter', handleDrag);\n\n    return () => {\n      body.removeEventListener('drop', handleDrop);\n      body.removeEventListener('dragover', handleDrag);\n      body.removeEventListener('dragenter', handleDrag);\n    };\n  }, []);\n\n  // Check if welcome has been completed every second.\n  const [hasCompletedWelcome, setHasCompletedWelcome] = useState(true);\n  useEffect(() => {\n    const timerId = setInterval(() => {\n      const state = localStorage.getItem(HAS_COMPLETED_WELCOME_KEY) === 'true';\n      if (state !== hasCompletedWelcome) setHasCompletedWelcome(state);\n      if (state) clearInterval(timerId);\n    }, 1000);\n\n    return () => clearInterval(timerId);\n  }, [hasCompletedWelcome]);\n\n  // return <Test />;\n\n  let activeKey: AppScreens = AppScreens.auth;\n  let page: UiLoaderPage | undefined;\n\n  // Check for OAuth callback first - scalable for multiple providers\n  const oauthCheckers = [\n    { provider: 'notion', checker: isNotionOAuthCallback },\n    { provider: 'google', checker: isGoogleOAuthCallback },\n    // Future providers can be easily added here:\n    // { provider: 'github', checker: isGitHubOAuthCallback },\n    // { provider: 'slack', checker: isSlackOAuthCallback },\n  ];\n\n  let oauthProvider: string | null = null;\n  for (const { provider, checker } of oauthCheckers) {\n    if (checker()) {\n      activeKey = AppScreens.oauthCallback;\n      oauthProvider = provider;\n      page = undefined;\n      break;\n    }\n  }\n\n  // Only proceed with other logic if NOT an OAuth callback\n  if (!oauthProvider) {\n    if (!hasCompletedWelcome) {\n      page = 'welcome';\n      activeKey = AppScreens.welcome;\n    } else if (inactiveReason) {\n      page = undefined;\n      activeKey = AppScreens.inactive;\n    } else if (isScreenLocked) {\n      page = 'lock';\n      activeKey = AppScreens.lock;\n    } else if (authState) {\n      switch (authState) {\n        case 'authorizationStateWaitPhoneNumber':\n          page = 'authPhoneNumber';\n          activeKey = AppScreens.auth;\n          break;\n        case 'authorizationStateWaitCode':\n          page = 'authCode';\n          activeKey = AppScreens.auth;\n          break;\n        case 'authorizationStateWaitPassword':\n          page = 'authPassword';\n          activeKey = AppScreens.auth;\n          break;\n        case 'authorizationStateWaitRegistration':\n          activeKey = AppScreens.auth;\n          break;\n        case 'authorizationStateWaitQrCode':\n          page = 'authQrCode';\n          activeKey = AppScreens.auth;\n          break;\n        case 'authorizationStateClosed':\n        case 'authorizationStateClosing':\n        case 'authorizationStateLoggingOut':\n        case 'authorizationStateReady':\n          page = 'main';\n          activeKey = AppScreens.main;\n          break;\n      }\n    } else if (hasStoredSession()) {\n      page = 'main';\n      activeKey = AppScreens.main;\n    } else if (hasPasscode) {\n      activeKey = AppScreens.lock;\n    } else {\n      page = isMobileOs ? 'authPhoneNumber' : 'authQrCode';\n      activeKey = AppScreens.auth;\n    }\n\n    // Check for tgWebAuthToken only if not OAuth callback\n    if (activeKey !== AppScreens.lock\n      && activeKey !== AppScreens.inactive\n      && activeKey !== AppScreens.main\n      && parseInitialLocationHash()?.tgWebAuthToken\n      && !hasWebAuthTokenFailed) {\n      page = 'main';\n      activeKey = AppScreens.main;\n    }\n  }\n\n  useEffect(() => {\n    updateSizes();\n  }, []);\n\n  useEffect(() => {\n    if (inactiveReason) {\n      document.title = INACTIVE_PAGE_TITLE;\n    } else {\n      document.title = ACTIVE_PAGE_TITLE;\n    }\n  }, [inactiveReason]);\n\n  const prevActiveKey = usePrevious(activeKey);\n\n  function renderContent() {\n    switch (activeKey) {\n      case AppScreens.welcome:\n        return <Welcome />;\n      case AppScreens.auth:\n        return <Auth />;\n      case AppScreens.main:\n        return <Main isMobile={isMobile} />;\n      case AppScreens.lock:\n        return <LockScreen isLocked={isScreenLocked} />;\n      case AppScreens.inactive:\n        return <AppInactive inactiveReason={inactiveReason!} />;\n      case AppScreens.oauthCallback: {\n        const OAuthComponent = oauthProvider ? OAUTH_COMPONENTS[oauthProvider as keyof typeof OAUTH_COMPONENTS] : undefined;\n        return OAuthComponent ? <OAuthComponent /> : <div>Unknown OAuth provider</div>;\n      }\n    }\n  }\n\n  useTauriDrag();\n\n  useLayoutEffect(() => {\n    document.body.classList.add(styles.bg);\n  }, []);\n\n  useLayoutEffect(() => {\n    document.body.style.setProperty(\n      '--theme-background-color',\n      theme === 'dark' ? DARK_THEME_BG_COLOR : LIGHT_THEME_BG_COLOR,\n    );\n  }, [theme]);\n\n  useLayoutEffect(() => {\n    if (actionMessageBg) {\n      document.body.style.setProperty('--action-message-bg', actionMessageBg);\n    }\n  }, [actionMessageBg]);\n\n  const getIsInBackgroundLocal = getIsInBackground;\n  useSignalEffect(() => {\n    // Mutation forced to avoid RAF throttling in background\n    forceMutation(() => {\n      document.body.classList.toggle('in-background', getIsInBackgroundLocal());\n    }, document.body);\n  }, [getIsInBackgroundLocal]);\n\n  return (\n    <UiLoader page={page} isMobile={isMobile}>\n      <Transition\n        name=\"fade\"\n        activeKey={activeKey}\n        shouldCleanup\n        className={buildClassName(\n          'full-height',\n          (activeKey === AppScreens.auth || prevActiveKey === AppScreens.auth) && 'is-auth',\n        )}\n        renderCount={TRANSITION_RENDER_COUNT}\n      >\n        {renderContent}\n      </Transition>\n      <Notifications />\n    </UiLoader>\n  );\n};\n\nexport default withGlobal(\n  (global): Complete<StateProps> => {\n    const { state: authState, hasWebAuthTokenFailed, hasWebAuthTokenPasswordRequired } = global.auth;\n    return {\n      authState,\n      isScreenLocked: global.passcode?.isScreenLocked,\n      hasPasscode: global.passcode?.hasPasscode,\n      inactiveReason: selectTabState(global).inactiveReason,\n      hasWebAuthTokenFailed: hasWebAuthTokenFailed || hasWebAuthTokenPasswordRequired,\n      theme: selectTheme(global),\n      isTestServer: global.config?.isTestServer,\n      actionMessageBg: selectActionMessageBg(global),\n    };\n  },\n)(App);\n","import { useEffect, useState } from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport { parseNotionOAuthCallback } from '../../util/routing';\nimport useLastCallback from '../../hooks/useLastCallback';\n\n// Ensure notionAuth actions are loaded\nimport '../../global/actions/ui/notionAuth';\n\nimport styles from './NotionOAuthCallback.module.scss';\n\nconst REDIRECT_DELAY = 10; // 10 seconds\n\nconst NotionOAuthCallback = () => {\n  const { completeNotionOAuthSuccess, completeNotionOAuthError } = getActions();\n  const [countdown, setCountdown] = useState<number | null>(null);\n  const [callbackResult, setCallbackResult] = useState<{\n    type: 'success' | 'error';\n    message: string;\n  } | null>(null);\n\n  const handleGoHome = useLastCallback(() => {\n    window.location.href = '/';\n  });\n\n  useEffect(() => {\n    const callbackData = parseNotionOAuthCallback();\n\n    if (!callbackData) {\n      // Fallback: redirect to home if not a valid OAuth callback\n      setTimeout(() => {\n        window.location.href = '/';\n      }, 1000);\n      return;\n    }\n\n    if (callbackData.type === 'success') {\n      const workspace = callbackData.workspace || 'Unknown Workspace';\n      setCallbackResult({\n        type: 'success',\n        message: `Successfully connected to Notion workspace: ${workspace}`,\n      });\n      completeNotionOAuthSuccess({ workspace });\n    } else if (callbackData.type === 'error') {\n      const error = callbackData.error || 'Unknown error occurred';\n      setCallbackResult({\n        type: 'error',\n        message: `Failed to connect to Notion: ${error}`,\n      });\n      completeNotionOAuthError({ error });\n    }\n\n    // Start countdown\n    setCountdown(REDIRECT_DELAY);\n    const countdownInterval = setInterval(() => {\n      setCountdown((prev) => {\n        if (prev === null || prev <= 1) {\n          clearInterval(countdownInterval);\n          window.location.href = '/';\n          return null;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(countdownInterval);\n  }, [completeNotionOAuthSuccess, completeNotionOAuthError]);\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.content}>\n        {callbackResult ? (\n          <>\n            <div className={styles.icon}>\n              <i className={callbackResult.type === 'success' ? 'icon icon-check' : 'icon icon-close'} />\n            </div>\n            <h2 className={styles.title}>\n              {callbackResult.type === 'success' ? 'Connection Successful!' : 'Connection Failed'}\n            </h2>\n            <p className={styles.message}>{callbackResult.message}</p>\n            <div className={styles.actions}>\n              <p className={styles.countdown}>\n                {countdown !== null ? `Redirecting in ${countdown} seconds` : 'Redirecting...'}\n              </p>\n              <button className={styles.homeButton} onClick={handleGoHome}>\n                Go Home Now\n              </button>\n            </div>\n          </>\n        ) : (\n          <>\n            <div className={styles.spinner}>\n              <i className=\"icon icon-spinner\" />\n            </div>\n            <p className={styles.message}>Processing Notion connection...</p>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default NotionOAuthCallback;","import { useEffect, useState } from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport { parseGoogleOAuthCallback } from '../../util/routing';\nimport useLastCallback from '../../hooks/useLastCallback';\n\n// Ensure googleAuth actions are loaded\nimport '../../global/actions/ui/googleAuth';\n\nimport styles from './GoogleOAuthCallback.module.scss';\n\nconst REDIRECT_DELAY = 10; // 10 seconds\n\nconst GoogleOAuthCallback = () => {\n  const { completeGoogleOAuthSuccess, completeGoogleOAuthError } = getActions();\n  const [countdown, setCountdown] = useState<number | null>(null);\n  const [callbackResult, setCallbackResult] = useState<{\n    type: 'success' | 'error';\n    message: string;\n  } | null>(null);\n\n  const handleGoHome = useLastCallback(() => {\n    window.location.href = '/';\n  });\n\n  useEffect(() => {\n    const callbackData = parseGoogleOAuthCallback();\n\n    if (!callbackData) {\n      // Fallback: redirect to home if not a valid OAuth callback\n      setTimeout(() => {\n        window.location.href = '/';\n      }, 1000);\n      return;\n    }\n\n    if (callbackData.type === 'success') {\n      setCallbackResult({\n        type: 'success',\n        message: 'Successfully connected to Google',\n      });\n      completeGoogleOAuthSuccess();\n    } else if (callbackData.type === 'error') {\n      const error = callbackData.error || 'Unknown error occurred';\n      setCallbackResult({\n        type: 'error',\n        message: `Failed to connect to Google: ${error}`,\n      });\n      completeGoogleOAuthError({ error });\n    }\n\n    // Start countdown\n    setCountdown(REDIRECT_DELAY);\n    const countdownInterval = setInterval(() => {\n      setCountdown((prev) => {\n        if (prev === null || prev <= 1) {\n          clearInterval(countdownInterval);\n          window.location.href = '/';\n          return null;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(countdownInterval);\n  }, [completeGoogleOAuthSuccess, completeGoogleOAuthError]);\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.content}>\n        {callbackResult ? (\n          <>\n            <div className={styles.icon}>\n              <i className={callbackResult.type === 'success' ? 'icon icon-check' : 'icon icon-close'} />\n            </div>\n            <h2 className={styles.title}>\n              {callbackResult.type === 'success' ? 'Connection Successful!' : 'Connection Failed'}\n            </h2>\n            <p className={styles.message}>{callbackResult.message}</p>\n            <div className={styles.actions}>\n              <p className={styles.countdown}>\n                {countdown !== null ? `Redirecting in ${countdown} seconds` : 'Redirecting...'}\n              </p>\n              <button className={styles.homeButton} onClick={handleGoHome}>\n                Go Home Now\n              </button>\n            </div>\n          </>\n        ) : (\n          <>\n            <div className={styles.spinner}>\n              <i className=\"icon icon-spinner\" />\n            </div>\n            <p className={styles.message}>Processing Google connection...</p>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default GoogleOAuthCallback;","import { useCallback, useEffect } from '../../lib/teact/teact';\n\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport { IS_MAC_OS } from '../../util/browser/windowEnvironment';\n\nconst NO_DRAG_ELEMENTS = 'input, a, button';\n\nconst useTauriDrag = () => {\n  const handleMouseDown = useCallback(async (event: MouseEvent) => {\n    if (!(event.target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (event.target?.closest(NO_DRAG_ELEMENTS)) {\n      return;\n    }\n\n    if (event.target?.closest('[data-tauri-drag-region]')) {\n      const tauriWindow = await window.tauri?.getCurrentWindow();\n      tauriWindow?.startDragging();\n    }\n  }, []);\n\n  useEffect(() => {\n    if (!(IS_TAURI && IS_MAC_OS)) return undefined;\n\n    document.addEventListener('mousedown', handleMouseDown);\n\n    return () => {\n      document.removeEventListener('mousedown', handleMouseDown);\n    };\n  }, [handleMouseDown]);\n};\n\nexport default useTauriDrag;\n","import './util/handleError';\nimport './util/setupServiceWorker';\nimport './global/init';\n\nimport TeactDOM from './lib/teact/teact-dom';\nimport {\n  getActions, getGlobal,\n} from './global';\n\nimport {\n  DEBUG, STRICTERDOM_ENABLED,\n} from './config';\nimport { enableStrict, requestMutation } from './lib/fasterdom/fasterdom';\nimport { selectTabState } from './global/selectors';\nimport { selectSharedSettings } from './global/selectors/sharedState';\nimport { betterView } from './util/betterView';\nimport { IS_TAURI } from './util/browser/globalEnvironment';\nimport listenOtherClients from './util/browser/listenOtherClients';\nimport { requestGlobal, subscribeToMultitabBroadcastChannel } from './util/browser/multitab';\nimport { establishMultitabRole, subscribeToMasterChange } from './util/establishMultitabRole';\nimport { initGlobal } from './util/init';\nimport { initLocalization } from './util/localization';\nimport { MULTITAB_STORAGE_KEY } from './util/multiaccount';\nimport { checkAndAssignPermanentWebVersion } from './util/permanentWebVersion';\nimport { onBeforeUnload } from './util/schedulers';\nimport initTauriApi from './util/tauri/initTauriApi';\nimport setupTauriListeners from './util/tauri/setupTauriListeners';\nimport updateWebmanifest from './util/updateWebmanifest';\n\nimport App from './components/App';\n\nimport './assets/fonts/roboto.css';\nimport './styles/index.scss';\n\nif (STRICTERDOM_ENABLED) {\n  enableStrict();\n}\n\nif (IS_TAURI) {\n  initTauriApi();\n  setupTauriListeners();\n}\n\ninit();\n\nasync function init() {\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> INIT');\n  }\n\n  if (!(window as any).isCompatTestPassed) return;\n\n  checkAndAssignPermanentWebVersion();\n  listenOtherClients();\n\n  subscribeToMultitabBroadcastChannel();\n  await requestGlobal(APP_VERSION);\n  localStorage.setItem(MULTITAB_STORAGE_KEY, '1');\n  onBeforeUnload(() => {\n    const global = getGlobal();\n    if (Object.keys(global.byTabId).length === 1) {\n      localStorage.removeItem(MULTITAB_STORAGE_KEY);\n    }\n  });\n\n  await initGlobal();\n  getActions().init();\n\n  getActions().updateShouldEnableDebugLog();\n  getActions().updateShouldDebugExportedSenders();\n\n  const global = getGlobal();\n\n  initLocalization(selectSharedSettings(global).language, true);\n\n  subscribeToMasterChange((isMasterTab) => {\n    getActions()\n      .switchMultitabRole({ isMasterTab }, { forceSyncOnIOs: true });\n  });\n  const shouldReestablishMasterToSelf = getGlobal().auth.state !== 'authorizationStateReady';\n  establishMultitabRole(shouldReestablishMasterToSelf);\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> START INITIAL RENDER');\n  }\n\n  requestMutation(() => {\n    updateWebmanifest();\n\n    TeactDOM.render(\n      <App />,\n      document.getElementById('root')!,\n    );\n\n    betterView();\n  });\n\n  if (DEBUG) {\n    // eslint-disable-next-line no-console\n    console.log('>>> FINISH INITIAL RENDER');\n  }\n\n  if (DEBUG) {\n    document.addEventListener('dblclick', () => {\n      // eslint-disable-next-line no-console\n      console.warn('TAB STATE', selectTabState(getGlobal()));\n      // eslint-disable-next-line no-console\n      console.warn('GLOBAL STATE', getGlobal());\n    });\n  }\n}\n\nonBeforeUnload(() => {\n  const actions = getActions();\n  actions.leaveGroupCall?.({ isPageUnload: true });\n  actions.hangUp?.({ isPageUnload: true });\n});\n","import { IS_MAC_OS } from '../browser/windowEnvironment';\n\nexport default function initTauriApi() {\n  const corePromise = import('@tauri-apps/api/core');\n  async function markTitleBarOverlay(isOverlay: boolean) {\n    if (!IS_MAC_OS) return;\n    const core = await corePromise;\n    return core.invoke<void>('mark_title_bar_overlay', { isOverlay });\n  }\n\n  async function setNotificationsCount(amount: number, isMuted = false) {\n    const core = await corePromise;\n    return core.invoke<void>('set_notifications_count', { amount, isMuted });\n  }\n\n  async function openNewWindow(url: string) {\n    const core = await corePromise;\n    return core.invoke<boolean>('open_new_window_cmd', { url });\n  }\n\n  async function setWindowTitle(title: string) {\n    const core = await corePromise;\n    return core.invoke<void>('set_window_title', { title });\n  }\n\n  // @ts-expect-error\n  window.tauri ??= {};\n  Object.assign(window.tauri, {\n    markTitleBarOverlay,\n    setNotificationsCount,\n    openNewWindow,\n    relaunch: () => import('@tauri-apps/plugin-process').then(({ relaunch }) => relaunch()),\n    checkUpdate: () => import('@tauri-apps/plugin-updater').then(({ check }) => check()),\n    getCurrentWindow: () => import('@tauri-apps/api/window').then(({ getCurrentWindow }) => getCurrentWindow()),\n    setWindowTitle,\n  });\n}\n","import { getGlobal, setGlobal } from '../../global';\n\nimport { APP_CODE_NAME, INTERCLIENT_BROADCAST_CHANNEL } from '../../config';\nimport { updateTabState } from '../../global/reducers/tabs';\nimport { selectTabState } from '../../global/selectors';\n\nexport default function listenOtherClients() {\n  const channel = new BroadcastChannel(INTERCLIENT_BROADCAST_CHANNEL);\n\n  channel.addEventListener('message', (event) => {\n    if (event.data !== APP_CODE_NAME) {\n      let global = getGlobal();\n      const tabState = selectTabState(global);\n      global = updateTabState(global, {\n        inactiveReason: 'otherClient',\n      }, tabState.id);\n      setGlobal(global);\n    }\n  });\n\n  channel.postMessage(APP_CODE_NAME);\n}\n","// Original idea was found here\n// https://medium.com/@alshakero/how-to-setup-your-web-app-manifest-dynamically-using-javascript-f7fbee899a61\n\nimport { DEBUG } from '../config';\nimport { IS_MAC_OS } from './browser/windowEnvironment';\n\nexport default function updateWebmanifest() {\n  if (!IS_MAC_OS) {\n    return;\n  }\n\n  const manifest = document.getElementById('the-manifest-placeholder');\n  if (!manifest) {\n    return;\n  }\n\n  const url = `site_apple${DEBUG ? '_dev' : ''}.webmanifest`;\n  manifest.setAttribute('href', url);\n}\n"],"names":["leafPrototypes","getProto","inProgress","dataWebpackPrefix","useCurrentOrPrev","current","shouldSkipUndefined","shouldForceCurrent","prev","usePreviousDeprecated","toCredentialCreationOptions","option","publicKey","PublicKeyCredential","parseCreationOptionsFromJSON","toCredentialRequestOptions","parseRequestOptionsFromJSON","addTabStateResetterAction","name","key","addActionHandler","global","actions","payload","tabId","getCurrentTabId","updateTabState","undefined","exports","read","buffer","offset","isLE","mLen","nBytes","e","m","eLen","eMax","eBias","nBits","i","d","s","NaN","Infinity","Math","pow","write","value","c","rt","abs","isNaN","floor","log","LN2","RE_NOT_LETTER","searchWords","haystack","needle","needleWords","toLowerCase","split","haystackLower","length","includes","haystackWords","every","needleWord","some","haystackWord","startsWith","prepareSearchWordsForNeedle","useThrottledCallback","fn","deps","msOrSchedulerFn","noFirst","fnMemo","useCallback","useMemo","throttle","throttleWith","selectCurrentViewedStory","storyViewer","peerId","storyId","selectTabState","selectIsStoryViewerOpen","Boolean","selectPeerStories","stories","byPeerId","selectPeerStory","byId","selectPinnedStories","pinnedIds","map","id","filter","isInProfile","selectPeerFirstUnreadStoryId","peerStories","lastReadId","orderedIds","lastReadIndex","findIndex","selectPeerFirstStoryId","selectStoryListForViewer","isSingleStory","isSinglePeer","isPrivate","isArchive","currentStoryId","peerIds","storyIdsByPeerId","peer","selectPeer","story","isUnread","storyIds","getPeerStoryIdsForViewer","orderedPeerIds","active","archived","areStoriesHidden","currentPeerId","push","storySourceProp","slice","indexOf","selectActiveStoriesCollectionId","selectedStoryAlbumId","error","showError","window","addEventListener","handleErrorEvent","DEBUG","isCurrentTabMaster","throttleError","err","console","handleError","ErrorEvent","message","preventDefault","reason","useThumbnail","media","isMediaContainer","getGlobal","thumbDataUri","selectMessageMediaThumbDataUri","dataUri","theme","selectTheme","uri","replace","Portal","containerSelector","className","children","elementRef","useRef","document","createElement","useLayoutEffect","container","querySelector","element","classList","add","appendChild","TeactDOM","render","removeChild","SPOILER_CHARS","TRUNCATED_SUMMARY_LENGTH","getMessageSummaryText","lang","statefulContent","noEmoji","truncateLength","isExtended","emoji","getMessageSummaryEmoji","getMessageSummaryDescription","trimText","getMessageTextWithSpoilers","transcription","getMessageTranscription","textWithoutTranscription","getMessageTextWithFallback","text","entities","content","reduce","accText","type","ApiMessageEntityTypes","Spoiler","spoiler","Array","fill","random","join","generateBrailleSpoiler","photo","video","audio","voice","sticker","pollId","paidMedia","todo","groupedId","getMediaContentTypeDescription","getSummaryDescription","truncatedText","mediaContent","contact","invoice","location","game","storyData","giveaway","giveawayResults","poll","summary","hasUsedTruncatedText","boughtExtendedMedia","isBought","extendedMedia","previewExtendedMedia","isPaidMediaAlbum","isPaidMediaSingleVideo","duration","isPaidMediaSinglePhoto","isGif","trim","title","performer","getMessageAudioCaption","fileName","renderTextWithEntities","question","asPreview","description","mediaType","promptInstall","setupBeforeInstallPrompt","async","prompt","userChoice","outcome","getActions","setInstallPrompt","canInstall","getPromptInstall","translateWithYou","isYou","variables","options","pluralValue","asText","withMarkdown","renderTextFilters","withNodes","getPinnedMediaValue","getMessageContent","isRound","renderPeerLink","renderText","_jsx","Link","buildClassName","styles","peerLink","strong","onClick","stopPropagation","openChat","withMultilineFix","IS_SAFARI","renderMessageLink","targetMessage","params","noEllipsis","messageLink","focusMessage","chatId","messageId","renderTopicLink","topicId","topicLink","openThread","threadId","getCallMessageKey","action","isOutgoing","isMissed","isCancelled","isVideo","WORKER_NAME","WorkerGlobalScope","globalThis","self","ACCOUNT_SLOT","Number","URLSearchParams","get","ACCOUNT_QUERY","IS_MULTIACCOUNT_SUPPORTED","url","slot","URL","searchParams","slotNumber","getAccountSlot","href","DATA_BROADCAST_CHANNEL_NAME","DATA_BROADCAST_CHANNEL_PREFIX","ESTABLISH_BROADCAST_CHANNEL_NAME","ESTABLISH_BROADCAST_CHANNEL_PREFIX","MULTITAB_STORAGE_KEY","MULTITAB_LOCALSTORAGE_KEY_PREFIX","GLOBAL_STATE_CACHE_KEY","GLOBAL_STATE_CACHE_PREFIX","getAccountsInfo","allSlots","Object","keys","localStorage","SESSION_ACCOUNT_PREFIX","accountInfo","info","getAccountInfo","sessionData","loadSlotSession","userId","avatarUri","color","emojiStatusId","firstName","lastName","isPremium","isTest","phone","data","JSON","parse","getItem","dcId","storeAccountData","currentSlotData","updatedSharedData","writeSlotSession","setItem","stringify","getAccountSlotUrl","forLogin","set","String","delete","hash","toString","versionChannel","BroadcastChannel","postMessage","version","APP_VERSION","event","semverCompare","reload","a","b","localeCompare","numeric","sensitivity","caseFirst","DEFAULT_SIZE","memo","props","size","play","noLoop","noTransition","nonInteractive","onLoad","otherProps","isAnimationLoaded","markAnimationLoaded","useFlag","transitionClassNames","useMediaTransitionDeprecated","handleLoad","useLastCallback","playKey","setPlayKey","useState","handleClick","AnimatedSticker","SIMPLE_MARKDOWN_REGEX","part","filters","compact","textParts","postProcessor","postProcess","divEl","result","innerText","innerHTML","escapeHtml","markdownPostProcessor","EMOJI_REGEX","lastIndex","replaceEmojis","addLineBreaks","highlight","queryPosition","newParts","substring","addHighlight","addLinks","replaceSimpleMarkdown","IS_EMOJI_SUPPORTED","parts","fixNonStandardEmoji","emojis","match","emojiResult","code","nativeToUnifiedExtendedWithCache","src","isLoaded","LOADED_EMOJIS","has","alt","draggable","handleEmojiLoad","index","splittenParts","line","source","trimmedLine","trimStart","indentLength","fromCharCode","repeat","RE_LINK","RegExp","RE_LINK_TEMPLATE","RE_MENTION_TEMPLATE","allowOnlyTgLinks","links","nextLink","shift","MentionLink","username","endsWith","isDeepLink","SafeLink","entityResult","entity","areLinesWrapping","lines","lineHeight","getComputedStyle","lineHeightParsed","parseFloat","clientHeight","onUpdateConnectionState","update","connectionState","tabState","isMasterTab","multitabNextAction","clearMultitabNextAction","setGlobal","isSynced","channelStackIds","values","byTabId","flatMap","tab","messageLists","messageList","chat","chats","isChatChannel","isChatSuperGroup","unique","forEach","requestChannelDifference","signOut","forceInitApi","oldSetLanguage","selectSharedSettings","language","onUpdateApiReady","wasAuthReady","auth","state","authState","authorizationState","updateAuth","isLoading","forceWebsync","isLoggingOut","isCodeViaApp","hint","noReset","hasWebAuthTokenPasswordRequired","isLoadingQrCode","qrCode","inactiveReason","onUpdateAuthorizationState","errorCode","errorKey","showNotification","onUpdateAuthorizationError","currentUserId","accounts","entries","find","_","onUpdateUserAlreadyAuthorized","clearWebTokenAuth","hasWebAuthTokenFailed","onUpdateWebAuthTokenFailed","passkeyOption","onUpdatePasskeyOption","rememberMe","isEmpty","mainDcId","config","isTestServer","saveSession","onUpdateSession","setServerTimeOffset","serverTimeOffset","onUpdateServerTimeOffset","currentUser","currentUserFullInfo","updateUser","updateUserFullInfo","updateSessionUserId","onUpdateCurrentUser","initApi","sync","isFetchingDifference","isFetching","paymentShippingError","getShippingError","addPaymentError","shouldClosePaymentModal","closePaymentModal","showDialog","getDeviceToken","subscription","toJSON","endpoint","checkIfPushSupported","IS_SERVICE_WORKER_SUPPORTED","IS_TAURI","ServiceWorkerRegistration","prototype","Notification","permission","warn","checkIfNotificationsSupported","soundPlayedIds","Set","notificationSound","Audio","playNotifySound","volume","notificationSoundVolume","selectSettingsKeys","currentVolume","once","setTimeout","setAttribute","playNotifySoundDebounced","debounce","requestPermission","tauriPlugin","isPermissionGranted","unsubscribeFromPush","deleteDeviceToken","deviceToken","callApi","unsubscribe","serviceWorkerRegistration","navigator","serviceWorker","ready","pushManager","getSubscription","isSubscriptionFailed","checkIfOfflinePushFailed","subscribe","setDeviceToken","updateWebNotificationSettings","hasWebNotifications","hasPushNotifications","Date","now","subscribedAt","checkIfShouldResubscribe","userVisibleOnly","token","DOMException","ABORT_ERR","NOT_SUPPORTED_ERR","getAvatar","imageHash","getChatAvatarHash","mediaData","mediaLoader","ApiMediaFormat","BlobUrl","notifyAboutCall","call","user","hasFocus","icon","body","getUserFullName","badge","tag","vibrate","notification","oldTranslate","onclick","close","focus","notifyAboutMessage","isReaction","isChatMuted","getIsChatMuted","selectNotifyDefaults","selectNotifyException","topic","selectTopicFromMessage","topicMutedUntil","notifySettings","mutedUntil","isMuted","getServerTime","shouldIgnoreMute","isMentioned","shouldNotifyAboutMessage","isNotJoined","isListed","selectIsChatWithSelf","IS_TOUCH_ENV","selectCurrentMessageList","checkIfShouldNotify","isChatSilent","getIsChatSilent","isSilent","hasSound","areNotificationsSupported","activeReaction","getMessageRecentReaction","reaction","selectCustomEmoji","customEmoji","documentId","customEmojis","buildCollectionByKey","loadCustomEmoji","sender","selectSender","hasReaction","isScreenLocked","passcode","isSelf","getPrivateChatUserId","getShouldShowMessagePreview","senderName","getMessageSenderName","getTranslationFn","jsxToHtml","MessageSummary","textContent","emoticon","getReactionEmoji","APP_NAME","getChatTitle","getNotificationContent","controller","shouldReplaceHistory","dispatch","onshow","closeMessageNotifications","IS_TEST","notifyClientReady","useSignalEffect","effect","dependencies","isFirstRun","dependency","isSignal","useUnmountCleanup","cleanupEffect","useIntersectionObserver","rootRef","throttleMs","throttleScheduler","debounceMs","shouldSkipFirst","margin","threshold","isDisabled","rootCallback","controllerRef","rootCallbackRef","freezeFlagsRef","onUnfreezeRef","freeze","unfreeze","useHeavyAnimation","useEffect","observer","disconnect","destroy","observe","target","targetCallback","callbacks","Map","entriesAccumulator","observerCallback","observerCallbackSync","from","entry","callbackManager","runCallbacks","clear","IntersectionObserver","root","rootMargin","addCallback","callback","createCallbackManager","removeCallback","hasCallbacks","initController","unobserve","useOnIntersect","targetRef","lastCallback","useIsIntersecting","isIntersecting","setIsIntersecting","arePropsShallowEqual","currentProps","newProps","currentKeys","currentKeysLength","prop","logUnequalProps","msg","debugKey","jsx","fragment","toJSNumber","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","tryParseBigInt","BigInt","counter","counterBlocking","getIsAnimating","setIsAnimating","createSignal","getIsBlockingAnimating","setIsBlockingAnimating","getIsHeavyAnimating","beginHeavyAnimation","isBlocking","timeout","onEnd","hasEnded","clearTimeout","onFullyIdle","cb","onIdle","requestMeasure","throttleWithFullyIdle","STAR_PATH","GoldStarIcon","randomId","mask1Id","mask2Id","gradient1Id","gradient2Id","gradient3Id","_jsxs","svg","width","height","viewBox","style","maskUnits","x","y","mask","x1","y1","x2","y2","gradientUnits","PremiumStarIcon","RegularStarIcon","StarIcon","validSvgRandomId","useUniqueId","clickable","renderIcon","Deferred","constructor","this","promise","Promise","resolve","reject","resolved","deferred","isUserId","entityId","toChannelId","mtpId","n","CHANNEL_ID_BASE","getRawPeerId","getPeerIdDividend","NON_BUBBLEABLE_EVENTS","documentEventCounters","delegationRegistryByEventType","delegatedEventTypesByElement","propName","handler","asCapture","eventType","resolveEventType","canUseEventDelegation","handleEvent","resolveDelegationRegistry","existing","newSet","resolveDelegatedEventTypes","addDelegatedListener","removeEventListener","removeDelegatedListener","tagName","realEventType","removeAllDelegatedListeners","eventTypes","realEvent","events","furtherCallsPrevented","Proxy","p","Reflect","parentNode","documentListenersCount","delegatedHandlersCount1","acc","delegationRegistriesCount","delegatedHandlersCount2","delegationRegistry","delegationElementsCount","delegatedEventTypesCount","UNSAFE_MIME_TYPES","UNSAFE_EXTENSIONS","SVG_EXTENSIONS","isIpRevealingMedia","mimeType","extension","useKeyboardListNavigation","isOpen","onSelectWithEnter","itemSelector","noCaptureFocus","focusedIndex","setFocusedIndex","requestMutation","tabIndex","keyCode","focusedElement","activeElement","elementChildren","querySelectorAll","newIndex","item","MIN_UPDATE_USERNAME_LENGTH","MAX_USERNAME_LENGTH","USERNAME_REGEX","isUsernameValid","isUpdating","minUsernameLength","test","prevGlobal","updatePageTitle","updateShouldDebugExportedSenders","updateShouldEnableDebugLog","oldGlobal","oldSharedSettings","sharedSettings","performance","prevPerformance","peerColors","prevPeerColors","updatePeerColors","general","applyPerformanceSettings","withAnimation","selectCanAnimateInterface","switchTheme","timeFormat","setTimeFormat","messageTextSize","documentElement","setProperty","max","IS_IOS","canDisplayChatInTitle","shouldForceHttpTransport","shouldAllowHttpTransport","updateSharedSettings","shouldDebugExportedSenders","shouldCollectDebugLogs","setShouldEnableDebugLog","initDebugConsole","disableDebugConsole","settings","replaceSettings","wasAnimationLevelSetManually","updateThemeSettings","foldersAction","nextFoldersAction","contentKey","LeftColumnContent","ChatList","leftColumn","screen","loadPrivacySettings","skipIfCached","openLeftColumnContent","Settings","settingsScreen","SettingsScreens","Main","folderId","isOnlyInvites","chatFolder","selectChatFolder","openSettingsScreen","FoldersEditFolderInvites","FoldersEditFolderFromChatList","requestNextFoldersAction","noRequestNextScreen","isChatList","FoldersShare","shareFolderScreen","isFromSettings","openEditChatFolder","isPasskeyModalOpen","useFastClick","button","MouseButton","handleMouseDown","captureEscKeyListener","captureKeyboardListener","onEsc","API_GENERAL_ID_LIMIT","RESALE_GIFTS_LIMIT","DEFAULT_LIMITS","uploadMaxFileparts","stickersFaved","savedGifs","dialogFiltersChats","dialogFilters","dialogFolderPinned","captionLength","channels","channelsPublic","aboutLength","chatlistInvites","chatlistJoined","recommendedChannels","savedDialogsPinned","maxReactions","moreAccounts","MULTIACCOUNT_MAX_SLOTS","DEFAULT_MAX_MESSAGE_LENGTH","DEFAULT_MAX_NOTE_LENGTH","DEFAULT_APP_CONFIG","limits","autologinDomains","channelLevelMax","boostsPerSentGift","channelRestrictAdsLevelMin","seenByExpiresAt","seenByMaxChatMembers","defaultEmojiStatusesStickerSetId","emojiSounds","giveawayAddPeersMax","giveawayBoostsPerPremium","giveawayCountriesMax","isGiveawayGiftsPurchaseAvailable","groupTranscribeLevelMin","hiddenMembersMinCount","ignoreRestrictionReasons","canLimitNewMessagesWithoutPremium","readDateExpiresAt","premiumBotUsername","premiumPromoOrder","isPremiumPurchaseBlocked","maxUniqueReactions","starGiftMaxConvertPeriod","starGiftMaxMessageLength","starRefStartPrefixes","isStarsGiftEnabled","paidReactionMaxAmount","starsUsdWithdrawRateX1000","storyChangelogUserId","maxPinnedStoriesCount","starsSuggestedPostAmountMax","starsSuggestedPostAmountMin","starsSuggestedPostAgeMin","starsSuggestedPostFutureMin","starsSuggestedPostFutureMax","starsSuggestedPostCommissionPermille","tonSuggestedPostCommissionPermille","todoItemLengthMax","todoItemsMax","todoTitleLengthMax","tonSuggestedPostAmountMax","tonSuggestedPostAmountMin","tonTopupUrl","storyViewersExpirePeriod","topicsPinnedLimit","bandwidthPremiumDownloadSpeedup","bandwidthPremiumNotifyPeriod","bandwidthPremiumUploadSpeedup","urlAuthDomains","whitelistedDomains","typingDraftTtl","arePasskeysAvailable","passkeysMaxCount","typed","typify","getPromiseActions","execAfterActions","withGlobal","generateUniqueId","generateUniqueNumberId","formatInteger","formatIntegerCompact","views","number","formatPercent","fractionDigits","isInteger","toFixed","getFirstLetters","withCache","phrase","count","word","toUpperCase","FILE_SIZE_UNITS","formatFileSize","bytes","decimals","v","addCallbackTokenDied","runCallbacksTokenDied","collectedTokens","channel","isEstablished","initialEstablishment","masterToken","reestablishToken","isWaitingForMaster","isChannelClosed","handleMessage","currentPasscodeHash","setPasscodeHash","hasGaveUpMaster","shouldGiveUpMaster","getPasscodeHash","tokenDied","prevLength","l","establishMultitabRole","shouldReestablishMasterToSelf","reestablishMasterToSelf","signalTokenDead","signalPasscodeHash","getAllMultitabTokens","subscribeToTokenDied","subscribeToMasterChange","initialEstablishmentPromise","idRef","vs16RegExp","zeroWidthJoiner","removeVS16s","rawEmoji","DEFAULT_CHAT_LISTS","replaceChatListIds","newIds","listIds","replaceChatListLoadingParameters","nextOffsetId","nextOffsetPeerId","nextOffsetDate","loadingParameters","updateChatLastMessageId","lastMessageId","listType","lastMessageIds","updateChatsLastMessageId","messageIds","addChatListIds","idsUpdate","replaceChats","newById","addUnreadMentions","ids","shouldUpdateCount","prevChatUnreadMentions","unreadMentions","updatedUnreadMentions","sort","updateChat","unreadMentionsCount","removeUnreadMentions","removedCount","chatUpdate","noOmitUnreadReactionCount","withDeepCheck","updateKeys","areDeepEqual","pick","updatedChat","getUpdatedChat","updateChatFullInfo","fullInfoUpdate","currentFullInfo","selectChatFullInfo","updatedFullInfo","fullInfoById","replaceChatFullInfo","fullInfo","updateChats","updatedById","addChats","isUpdated","addedById","existingChat","newChat","membersCountChanged","membersCount","isMin","accessHash","omitProps","usernames","omit","omitUndefined","updateChatListType","ARCHIVED_FOLDER_ID","currentListIds","listTypeKey","currentFolderList","updateChatListSecondaryInfo","totalCountKey","orderedPinnedIds","totalCount","totalChatCount","leaveChat","leftChatId","removeChatFromChatLists","joinInfo","addChatMembers","membersToAdd","currentMembers","members","newMemberIds","updatedMembers","currentIds","updatedIds","areSortedArraysEqual","adminMembers","isAdmin","isOwner","adminMembersById","replaceSimilarChannels","similarChannelIds","similarChannelsById","toggleSimilarChannels","similarChannels","isExpanded","addSimilarBots","similarBotsIds","similarBotsById","getOffsetToContainer","offsetTop","offsetLeft","contains","offsetParent","clientTop","clientLeft","top","left","useDebouncedCallback","ms","noLast","makeRestRequest","method","path","queryParams","jwtToken","getAlpahHumanSocketManager","getJwtToken","Error","backendUrl","BACKEND_API_URL","append","headers","Authorization","pathname","search","response","fetch","ok","errorText","errorMessage","status","statusText","errorJson","saveJwtTokenToSession","deleteJwtToken","json","success","getMeRest","getHighlightsRest","timeframe","getThreadsRest","threads","createThreadRest","getThreadMessagesRest","encodeURIComponent","messages","makeUnauthenticatedRequest","createLoginTokenRest","consumeLoginTokenRest","connectNotionRest","connectGoogleRest","convertCurrencyFromBaseUnit","amount","currency","getCurrencyExp","convertTonFromNanos","nanos","TON_CURRENCY_CODE","convertTonToNanos","ton","formatCurrency","totalPrice","price","STARS_CURRENCY_CODE","formatStarsAsIcon","asFont","asFontIcon","iconClassName","formatTonAsIcon","formatCurrencyAsString","convertTonToUsd","usdRate","isInNanos","locale","shouldOmitFractions","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","format","parseEmojiOnlyString","textWithoutNewlines","DETECT_UP_TO","countIfEmojiOnly","iterator","matchAll","currentIndex","WEEKDAYS_FULL","MONTHS_FULL_LOWERCASE","month","MILLISECONDS_IN_DAY","isToday","date","getDayStartAt","getDayStart","datetime","setHours","getTime","toYearMonth","timestamp","getFullYear","getMonth","toIsoString","getDate","formatTime","hours","getHours","marker","padStart","getMinutes","formatPastTimeShort","alwaysShowTime","time","today","weekAgo","setDate","weekday","getDay","noYear","formattedDate","formatDateToString","formatFullDate","formatMonthAndYear","isShort","formatCountdown","secondsLeft","days","getDays","formatMediaDuration","formatCountdownDays","formatCountdownShort","msLeft","ceil","formatLocationLastUpdate","currentTime","lastUpdated","seconds","formatRelativePastTime","lastUpdatedDate","yesterday","formatPastDatetime","pastTime","minutes","formatTimeDuration","showLast","durationRecords","labels","multiplier","t","label","idx","modulus","out","reverse","splice","formatScheduledDateTime","scheduleDateTimestamp","oldLang","formatHumanDate","noWeekdays","isUpperFirst","upperFirst","lowerFirst","limitBefore","limitAhead","formatWeekday","day","weekDay","formatMediaDateTime","maxValue","maxHours","maxMinutes","string","formatVoiceRecordDuration","durationInMs","milliseconds","formatDayToStringWithCache","dayStartAt","monthFormat","noDay","toLocaleString","year","formatDateTimeToString","noSeconds","hour","minute","second","hourCycle","formatDateAtTime","formatShortDuration","hoursPriority","isValidDate","MAX_MONTH_IN_YEAR","parseDateString","query","matchStringDate","matchEuropeStringDate","matchNumberDate","dateParts","monthIndex","timestampPlusDay","str","formatRegistrationMonth","dateString","DateTimeFormat","ref","useStateRef","args","renderId","tgsUrl","playSegment","speed","quality","isLowPriority","forceAlways","forceOnHeavyAnimation","sharedCanvas","sharedCanvasCoords","onMouseEnter","onMouseLeave","onEnded","onLoop","containerRef","viewId","animation","setAnimation","animationRef","isFirstRender","shouldUseColorFilter","colorFilter","useColorFilter","playRef","playSegmentRef","rgbColor","shouldForceOnHeavyAnimation","canInitialize","markCanInitialize","unmarkCanInitialize","useSyncEffect","r","g","hex2rgbaObj","isUnmountedRef","init","offsetWidth","offsetHeight","newAnimation","getRLottie","coords","setSpeed","ensureRLottie","then","throttledInit","useSharedIntersectionObserver","setColor","removeView","playAnimation","shouldRestart","isFrozen","playAnimationOnRaf","pauseAnimation","isPlaying","pause","useEffectWithPrevDeps","prevNoLoop","setNoLoop","prevSharedCanvasCoords","setSharedCanvasCoords","changeData","usePriorityPlaybackCheck","useBackgroundMode","buildStyle","isPriorityPlaybackActive","isBackgroundModeActive","Icon","role","ariaLabel","character","Blockquote","canBeCollapsible","isToggleDisabled","isCollapsed","isCollapsible","setIsCollapsed","useCollapsibleLines","canExpand","handleExpand","handleToggle","PRETTY_BY_ALIAS","js","javascript","ts","typescript","python","py","go","rust","func","cpp","fortran","f90","f","java","sql","swift","kotlin","ruby","rb","php","perl","bash","sh","markdown","cs","yaml","yml","solidity","sol","tl","CodeOverlay","noCopy","onWordWrapToggle","windowSize","useWindowSize","useOldLang","isWordWrap","setIsWordWrap","withWordWrapButton","setWithWordWrapButton","checkWordWrap","isWrap","parentElement","handleCopy","copyTextToClipboard","handleWordWrapClick","contentClass","overlayClass","wrapClass","CodeBlock","setWordWrap","highlighted","useAsync","lib","default","handleWordWrapToggle","wrap","blockClass","PeerColorWrapper","codeLanguage","Pre","revealByContainerId","createClassNameBuilder","containerId","contentRef","isRevealed","revealSpoiler","stopEvent","reveal","emojiSize","shouldRenderAsHtml","isProtected","observeIntersectionForLoading","observeIntersectionForPlaying","withTranslucentThumbs","sharedCanvasRef","sharedCanvasHqRef","cacheBuster","forcePlayback","noCustomEmojiPlayback","isInSelectMode","maxTimestamp","renderMessagePart","deleteLineBreakAfterPre","organizedEntities","organizedEntityIndexes","organizedEntity","organizeEntity","organizedIndexes","organizedIndex","organizeEntities","renderEntity","textPartStart","textPartEnd","isLastEntity","renderResult","nestedEntities","textBefore","textBeforeLength","substr","entityStartIndex","entityEndIndex","entityContent","nestedEntityContent","nestedIndex","nestedEntity","nestedEntityIndex","nestedResult","nestedEntityEndIndex","newEntity","rawEntityText","trimEnd","renderedContent","Bold","Italic","Underline","Code","Strike","MentionName","Url","TextUrl","getLinkUrl","CustomEmoji","buildCustomEmojiHtmlFromEntity","processEntityAsHtml","entityText","renderNestedMessagePart","isSelectable","withSharedAnimation","withTranslucentThumb","noPlay","canCollapse","BotCommand","handleBotCommandClick","dir","Hashtag","handleHashtagClick","Cashtag","handleCodeClick","Email","rel","Mention","Phone","entityType","Timestamp","openMediaFromTimestamp","handleTimecodeClick","QuoteFocus","processEntity","isArray","textAfter","arrayIndex","getTextWithEntitiesAsHtml","formattedText","focusedQuote","insertTextEntity","resultEntities","newEntityStart","newEntityEnd","existingEntity","existingEntityStart","existingEntityEnd","parsedEntity","isChanged","sendBotCommand","command","currentTarget","hashtag","openChatByUsername","onChatChanged","searchHashtag","selectPollFromMessage","webPage","selectWebPageFromMessage","translatedText","inChatList","useLang","extractedText","extractMessageText","hasPoll","getMessagePollId","isAction","isActionMessage","groupStatefulContent","summaryText","trimmedText","_Fragment","ActionMessageText","MessageText","messageOrStory","flat","resolverOrSignal","isAsync","resolver","valueRef","forceUpdate","useForceUpdate","resolverRef","runCurrentResolver","isSync","currentResolver","newValue","cache","WeakMap","fnCache","cacheKey","cached","selectCurrentChat","selectChat","selectChatMessages","byChatId","selectChatScheduledMessages","scheduledMessages","selectTabThreadParam","tabThreads","selectThreadParam","selectThread","messageInfo","threadsById","selectListedIds","selectChatThreads","selectOutlyingListByMessageId","outlyingLists","selectOutlyingLists","list","selectCurrentMessageIds","messageListType","selectViewportIds","selectPinnedIds","selectScheduledIds","selectScrollOffset","selectLastScrollOffset","selectEditingId","selectEditingDraft","selectEditingScheduledId","MAIN_THREAD_ID","selectEditingScheduledDraft","selectDraft","selectNoWebPage","selectThreadInfo","selectFirstMessageId","selectReplyStack","selectThreadMessagesCount","threadInfo","messagesCount","isForum","GENERAL_TOPIC_ID","selectThreadByMessage","selectThreadIdFromMessage","selectIsMessageInCurrentMessageList","currentMessageList","selectIsViewportNewest","viewportIds","isSavedDialog","getIsSavedDialog","selectChatLastMessageId","isLocalMessageId","selectChatMessage","chatMessages","selectScheduledMessage","selectQuickReplyMessage","quickReplies","messagesById","selectEditingMessage","selectFocusedMessageId","focusedChatId","focusedMessage","selectIsMessageFocused","currentThreadId","focusedId","previousLocalId","selectIsMessageUnread","lastReadOutboxMessageId","isMessageLocal","selectOutgoingStatus","isScheduledList","getSendingState","senderId","selectUser","areProfilesShown","getSendersFromSelectedMessages","selectSenderFromMessage","selectSenderFromHeader","header","fromId","selectForwardedSender","forwardInfo","isChannelPost","fromChatId","hiddenUserName","savedFromPeerId","selectPoll","pollById","selectWebPage","webPageId","webPageById","selectFullWebPageFromMessage","webpageType","selectFullWebPage","selectTopic","selectCanDeleteTopic","isBotForum","isCreator","getHasAdminRight","thread","listedIds","selectCanDeleteOwnerTopic","selectSavedDialogIdFromMessage","savedPeerId","ANONYMOUS_USER_ID","savedDialogId","replyToMsgId","replyToTopId","isForumTopic","getMessageReplyInfo","isChatBasicGroup","selectCanReplyToMessage","isRestricted","selectIsChatRestricted","isForbidden","isLocal","isServiceNotification","isServiceNotificationMessage","isMessageThread","isCommentsInfo","fromChannelId","chatFullInfo","getCanPostInChat","messageTopic","isClosed","selectCanForwardMessage","hasTtl","hasMessageTtl","isChatProtected","selectIsChatProtected","isStoryForwardForbidden","noForwards","isForwardingAllowed","selectAllowedMessageActionsSlow","isChatWithSelf","isBasicGroup","isSuperGroup","isChannel","isBotChat","selectBot","isFailed","isMessageFailed","isOwn","isOwnMessage","isForwarded","isForwardedMessage","isDocumentSticker","isMessageDocumentSticker","isBoostMessage","isMonoforum","canPinMessage","hasPinMessageRight","isPinMessageRightBanned","isUserRightBanned","hasUsernameOrGeo","hasUsername","hasGeo","isMessageEditable","editTimeLimit","viaBotId","canReply","canReplyGlobally","canPin","canUnpin","pinnedMessageIds","canNotDeleteBoostMessage","canDelete","canReport","canDeleteForAll","hasMessageEditRight","canEdit","hasSticker","hasFavoriteSticker","selectIsStickerFavorite","canFaveSticker","canUnfaveSticker","canCopy","canCopyLink","canSelect","canDownload","selectMessageDownloadableMedia","canSaveGif","canRevote","closed","quiz","results","isChosen","canClosePoll","noOptions","ability","selectCanDeleteSelectedMessages","selectedMessageIds","selectedMessages","messageIdList","messageActions","selectCanDeleteMessages","selectCanReportSelectedMessages","selectCanDownloadSelectedMessages","selectActiveDownloads","activeDownloads","selectUploadProgress","fileUploads","byMessageKey","getMessageKey","progress","selectRealLastReadId","lastReadInboxMessageId","unreadCount","min","selectFirstUnreadId","lastReadServiceNotificationId","SERVICE_NOTIFICATIONS_USER_ID","serviceNotifications","findAfterLastReadId","isFromScheduled","found","selectIsForwardModalOpen","isShareMessageModalShown","selectCommonBoxChatId","fromLastMessage","isCommonBoxChat","selectIsInSelectMode","selectIsMessageSelected","selectForwardedMessageIdsByGroupId","fromMessageId","selectMessageIdsByGroupId","selectIsDocumentGroupSelected","selectedIds","groupIds","selectSelectedMessagesCount","selectNewestMessageWithBotKeyboardButtons","findLast","keyboardButtons","shouldHideKeyboardButtons","isKeyboardSelective","replyToMessageId","replyMessage","selectShouldDisplayReplyKeyboard","replyHideMessageId","isHideKeyboardSelective","selectShouldHideReplyKeyboard","selectCanAutoLoadMedia","isPhoto","getMessagePhoto","getWebPagePhoto","getMessageVideo","getWebPageVideo","isFile","getMessageAudio","getMessageVoice","getMessageDocument","canAutoLoadPhotoFromContacts","canAutoLoadPhotoInPrivateChats","canAutoLoadPhotoInGroups","canAutoLoadPhotoInChannels","canAutoLoadVideoFromContacts","canAutoLoadVideoInPrivateChats","canAutoLoadVideoInGroups","canAutoLoadVideoInChannels","canAutoLoadFileFromContacts","canAutoLoadFileInPrivateChats","canAutoLoadFileInGroups","canAutoLoadFileInChannels","byKey","canAutoLoadMedia","canAutoLoadMediaFromContacts","canAutoLoadMediaInPrivateChats","canAutoLoadMediaInGroups","canAutoLoadMediaInChannels","isMediaFromContact","isContact","isChatGroup","selectLastServiceNotification","maxId","isDeleted","selectIsMessageProtected","getMessagePaidMedia","selectHasProtectedMessage","selectCanForwardMessages","selectHasIpRevealingMedia","getDocumentExtension","selectSponsoredMessage","sponsoredByChatId","expiresAt","round","selectDefaultReaction","defaultReaction","chatReactions","enabledReactions","canSendReaction","selectMaxUserReactions","selectCurrentLimit","selectVisibleUsers","selectShouldSchedule","selectCanScheduleUntilOnline","chatBot","paidMessagesStars","selectPeerPaidMessagesStars","selectUserStatus","wasOnline","selectMessageCustomEmojiSets","selectCustomEmojis","MEMO_EMPTY_ARRAY","documents","doc","stickerSetInfo","shortName","selectForwardsContainVoiceMessages","forwardMessages","selectChatTranslations","translations","selectMessageTranslations","toLanguageCode","byLangCode","selectRequestedMessageTranslationLanguage","requestedInChat","requestedTranslations","toLanguage","manualMessages","selectReplyCanBeSentToChat","toChatId","replyInfo","fromRealChatId","replyToPeerId","isExpiredMessage","selectForwardsCanBeSentToChat","isSavedMessages","isChatWithBot","selectIsChatWithBot","getAllowedAttachmentOptions","isVoice","isRoundVideo","isAudio","isDocument","isSticker","isPlainText","canSendVoices","canSendRoundVideos","canSendStickers","canSendDocuments","canSendAudios","canSendVideos","canSendPhotos","canSendGifs","canSendPlainText","heckMessageSendingDenied","selectCanTranslateMessage","detectedLanguage","canTranslate","isTranslationEnabled","doNotTranslate","canTranslateLanguage","isTranslatable","isMessageTranslatable","chatRequestedLanguage","selectRequestedChatTranslationLanguage","IS_TRANSLATION_SUPPORTED","selectTopicLink","getMessageLink","selectMessageReplyInfo","additionalReplyInfo","isMainThread","selectReplyMessage","selectActiveRestrictionReasons","restrictionReasons","appConfig","platform","WEB_APP_PLATFORM","shouldIgnore","SEARCH_ENGINE_REGEX","PERMANENT_VERSION_KEY","setPermanentWebVersion","switchPermanentWebVersion","clearWebsync","skipLockOnUnload","assign","WEB_VERSION_BASE","checkAndAssignPermanentWebVersion","hostname","PRODUCTION_HOSTNAME","referrer","host","currentVersion","getPermanentWebVersion","hasTest","shouldRedirect","AVATAR_SIZE","REM","Checkbox","labelText","subLabel","checked","disabled","withIcon","blocking","permissionGroup","rightIcon","onlyInput","nestedCheckbox","nestedCheckboxCount","nestedOptionList","leftElement","onChange","onCheck","onClickLabel","labelRef","showNested","setShowNested","renderingPeer","handleChange","toggleNested","labelClassName","isRtl","Avatar","Button","Spinner","nestedOption","currentInstance","animateSingle","tick","schedulerFn","instance","cancelSingleAnimation","dumbCb","animate","animateInstantly","timingFunctions","linear","easeIn","easeOut","easeInOut","sin","PI","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animateNumber","timing","onUpdate","to","t0","isCanceled","t1","applyStyles","css","users","statusesById","selectUserFullInfo","selectUserCommonChats","commonChatsById","selectIsUserBlocked","isBlocked","selectIsCurrentUserPremium","selectIsCurrentUserFrozen","freezeUntilDate","selectIsPremiumPurchaseBlocked","selectIsGiveawayGiftsPurchaseAvailable","selectUserByPhoneNumber","phoneNumber","phoneNumberCleaned","isUserBot","selectBotAppPermissions","botAppPermissionsById","Fragment","Teact","create","jsxs","getBotCoverMediaHash","convertToApiChatType","getWebAppKey","webApp","requestUrl","appName","botId","isSystemBot","REPLIES_USER_ID","VERIFICATION_CODES_USER_ID","INITIAL_PERFORMANCE_STATE_MAX","animatedEmoji","autoplayGifs","autoplayVideos","contextMenuAnimations","contextMenuBlur","loopAnimatedStickers","mediaViewerAnimations","messageComposerAnimations","messageSendingAnimations","pageTransitions","reactionEffects","rightColumnAnimations","stickerEffects","storyRibbonAnimations","snapEffect","INITIAL_PERFORMANCE_STATE_MED","INITIAL_PERFORMANCE_STATE_MIN","INITIAL_SHARED_STATE","shouldUseSystemTheme","IOS_DEFAULT_MESSAGE_TEXT_SIZE_PX","IS_MAC_OS","MACOS_DEFAULT_MESSAGE_TEXT_SIZE_PX","DEFAULT_MESSAGE_TEXT_SIZE_PX","animationLevel","ANIMATION_LEVEL_DEFAULT","foldersPosition","FOLDERS_POSITION_DEFAULT","messageSendKeyCombo","shouldSkipWebAppCloseConfirmation","wasTimeFormatSetManually","isConnectionStatusMinimized","shouldWarnAboutFiles","isInitial","INITIAL_GLOBAL_STATE","cacheVersion","isInited","attachMenu","bots","twoFaSettings","isAppUpdateAvailable","shouldShowContextMenuHint","audioPlayer","DEFAULT_VOLUME","lastPlaybackRate","DEFAULT_PLAYBACK_RATE","mediaViewer","countryList","phoneCodes","blocked","previewMediaByBotId","peers","profilePhotosById","isFullyLoaded","topicsInfoById","notifyExceptionById","saved","playbackByChatId","albumsByPeerId","hasNext","hasNextInArchive","stealthMode","groupCalls","attachmentSettings","shouldCompress","defaultAttachmentCompression","shouldSendGrouped","isInvertedMedia","webPageMediaSize","shouldSendInHighQuality","chatFolders","invites","areTagsEnabled","recentEmojis","recentCustomEmojis","reactions","defaultTags","topReactions","recentReactions","effectReactions","availableEffectById","stickers","setsById","added","recent","favorite","greeting","premium","featured","setIds","forEmoji","lastRendered","statusRecent","emojiKeywords","gifs","topPeers","topInlineBots","topBotApps","activeSessions","byHash","orderedHashes","activeWebSessions","autoLoadFileMaxSizeMb","shouldSuggestStickers","shouldSuggestCustomEmoji","shouldPaidMessageAutoApprove","shouldUpdateStickerSetOrder","shouldArchiveAndMuteNewNonContact","shouldNewNonContactPeersRequirePremium","disallowedGifts","nonContactPeersPaidStars","shouldHideReadMarks","canTranslateChats","privacy","botVerificationShownPeerIds","themes","light","isBlurred","patternColor","DEFAULT_PATTERN_COLOR","dark","DARK_THEME_PATTERN_COLOR","accountDaysTtl","trustedBotIds","transcriptions","sharedState","archiveSettings","isMinimized","isHidden","layout","agentColumnState","agentColumnWidth","contentMode","isPinned","alphahuman","isThreadsSidebarOpen","socketState","lastAgentUpdate","streamingContent","isStreaming","isLoggingIn","INITIAL_TAB_STATE","isLeftColumnShown","newChatMembersProgress","NewChatMembersProgress","Closed","uiReadyState","shouldInit","gifSearch","stickerSearch","activeChatFolder","inlineBots","byUsername","webApps","openedWebApps","openedOrderedKeys","sessionKeys","modalState","isModalOpen","isMoreAppsTabActive","globalSearch","userSearch","middleSearch","byChatThreadKey","sharedMediaSearch","chatMediaSearch","management","chatInfo","agentChat","threadHistory","savedGifts","DEFAULT_GIFT_PROFILE_FILTER_OPTIONS","collectionsByPeerId","activeCollectionByPeerId","resaleGifts","gifts","updateIteration","DEFAULT_RESALE_GIFTS_FILTER_OPTIONS","isRibbonShown","playbackRate","isWebAppsCloseConfirmationModalOpen","replyingMessage","pollResults","payment","starsPayment","notifications","dialogs","activeReactions","statistics","pollModal","isPaymentMessageConfirmDialogOpen","selectPeerFullInfo","selectChatListLoadingParameters","selectChatUser","selectSupportChat","isSupport","selectChatOnlineCount","MEMBERS_LOAD_SLICE","onlineCount","isUserOnline","selectIsTrustedBot","whitelistedBotIds","selectChatType","selectIsChatBotNotStarted","lastMessage","selectChatLastMessage","isHistoryClearMessage","selectAreActiveChatsLoaded","selectIsChatListed","targetList","selectChatListType","selectIsChatPinned","ALL_FOLDER_ID","SAVED_FOLDER_ID","chatFoldersById","pinnedChatIds","selectChatByUsername","usernameLowered","selectIsServiceChatReady","selectSendAs","sendAsId","selectRequestedDraft","requestedDraft","files","selectRequestedDraftFiles","filterChatIdsByType","chatIds","selectCanInviteToChat","migratedTo","isChatPublic","isJoinRequest","selectCanShareFolder","folder","groups","contacts","nonContacts","includedChatIds","excludeArchived","excludeMuted","excludeRead","excludedChatIds","concat","selectShouldDetectChatLanguage","hasAutoTranslation","selectCanTranslateChat","isLanguageDetectable","selectSimilarChannelIds","selectSimilarBotsIds","realChatId","selectIsMonoforumAdmin","selectMonoforumChannel","adminRights","linkedMonoforumId","selectAreFoldersPresent","MINUTE","HOUR","DAY","WEEK","MONTH","roundDown","getSeconds","performanceType","toggle","AVATAR_SIZES","micro","mini","tiny","small","medium","large","giant","jumbo","cn","webPhoto","previewUrl","withVideo","withStory","forPremiumPromo","withStoryGap","withStorySolid","storyColors","forceFriendStorySolid","forceUnreadStorySolid","storyViewerOrigin","storyViewerMode","loopIndefinitely","noPersonalPhoto","asMessageBubble","onContextMenu","onMouseMove","openStoryViewer","videoLoopCountRef","isCustomPeer","realPeer","isApiPeerUser","isApiPeerChat","isDeletedUser","isReplies","isChatWithRepliesBot","isAnonymousForwards","isAnonymousForwardsChat","peerColorKey","getPeerColorKey","peerColorClass","getPeerColorClass","isStoryClickable","hasStories","videoHash","pxSize","shouldLoadVideo","isBig","getVideoProfilePhotoMediaHash","getWebDocumentHash","specialIcon","avatarIcon","imgBlobUrl","useMedia","videoBlobUrl","imgUrl","hasBlobUrl","shouldPlayVideo","mediaRef","useMediaTransition","hasMediaData","handleVideoEnded","display","author","decoding","OptimizedVideo","canPlay","muted","loop","autoPlay","disablePictureInPicture","playsInline","userFullName","titleKey","isRoundedRect","isAvatarSquare","isPremiumGradient","withPremiumGradient","customColor","customPeerAvatarColor","fullClassName","hasUnreadStories","fullStyle","hasMedia","origin","getPeerStoryHtmlId","onMouseDown","AvatarStoryCircle","withExtraGap","colors","SIGNAL_MARK","Symbol","obj","unsubscribesByEffect","defaultValue","effects","unsubscribes","unsub","DropdownMenu","trigger","bubbleClassName","transformOriginX","transformOriginY","positionX","positionY","footer","forceOpen","onOpen","onClose","onTransitionEnd","onMouseEnterBackdrop","onHide","autoClose","menuRef","setIsOpen","handleClose","triggerComponent","onTrigger","isMenuOpen","iconName","onKeyDown","menu","toggleIsOpen","Menu","onCloseAnimationEnd","useVirtualBackdrop","ignoreRightClick","excludedClosestSelector","hasActiveViewTransition","matches","closest","value1","value2","type1","isArray1","array1","array2","member1","object1","object2","keys1","key1","EMOJI_EXCEPTIONS","regex","replacement","isCharIcon","customIcon","download","destructive","withWrap","withPreventDefaultOnMouseDown","clickArg","isTouchScreen","useAppLayout","handleKeyDown","base","maxint","decode_digit","cp","adapt","delta","numpoints","firsttime","k","decode","input","preserveCase","output","case_flags","input_length","bias","basic","j","ic","oldi","w","digit","len","lastIndexOf","charCodeAt","RangeError","utf16","domain","domain_array","PROTOCOL_WHITELIST","FALLBACK_PREFIX","ensureProtocol","parsedUrl","protocol","getUnicodeUrl","unicodeDomain","convertPunycode","decodeURI","isMixedScriptUrl","hasLatin","hasNonLatin","char","buildChatThreadKey","scaleImage","image","ratio","outputType","Blob","createObjectURL","img","Image","onload","scale","blob","finally","revokeObjectURL","resizeImage","steppedScale","bitmap","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","averageColor","getAverageColor","fillColor","getColorLuma","res","canvas","ctx2D","getContext","fillStyle","fillRect","ctx","transferFromImageBitmap","drawImage","toBlob","step","oc","octx","mul","cur","globalCompositeOperation","waitForTransitionEnd","node","propertyName","fallbackMs","waitForEndEvent","waitForAnimationEnd","animationName","detailedName","isHandled","cleanup","handleAnimationEnd","TransitionEvent","AnimationEvent","PATH_BASE","historyUniqueSessionId","historyState","historyCursor","isAlteringHistory","deferredHistoryOperations","deferredPopstateOperations","isSafariGestureAnimation","handleTouchEnd","applyDeferredHistoryOperations","goOperations","op","stateOperations","goCount","history","processStateOperations","deferHistoryOperation","historyOperation","resetHistory","onBack","back","replaceState","cleanupClosed","alreadyClosedCount","countClosed","cleanupTrashedState","isAnimationDisabled","disableHistoryAnimations","useHistoryBack","isActive","shouldBeReplaced","shouldResetUrlHash","lastOnBack","indexRef","wasReplaced","pushState","forceReplace","shouldReplace","previousRecord","markReplaced","processBack","useEffectOnce","prevIsActive","TEST_getHistoryState","TEST_getHistoryCursor","touches","pageX","innerWidth","previousUniqueSessionId","updateAppBadge","tauri","setNotificationsCount","setAppBadge","catch","getStoryReplyInfo","bio","about","profileEdit","ProfileEditProgress","InProgress","shouldUsernameUpdate","u","isEditable","Complete","loadFullUser","withPhotos","birthday","isFallback","avatarPhotoId","profilePhoto","deletePeerPhoto","Idle","checkedUsername","isUsernameAvailable","loadedWallpapers","wallpapers","file","previewBlobUrl","slug","UPLOADING_WALLPAPER_SLUG","wallpaper","firstWallpaper","withLocalMedia","blockedIds","isOnlyStories","addBlockedUser","removeBlockedUser","addNotifyExceptions","signUpNotification","notifyDefaults","all","hasContactJoinedNotifications","peerType","shouldShowPreviews","updateNotifyDefaults","MUTE_INDEFINITE_TIMESTAMP","UNMUTE_TIMESTAMP","oldSettings","languages","phoneNumberSettings","addByPhoneSettings","lastSeenSettings","profilePhotoSettings","forwardsSettings","chatInviteSettings","phoneCallSettings","phoneP2PSettings","voiceMessagesSettings","bioSettings","birthdaySettings","giftsSettings","noPaidMessagesSettings","rules","addByPhone","lastSeen","forwards","chatInvite","phoneCall","phoneP2P","voiceMessages","noPaidMessages","privacyKey","visibility","onSuccess","buildApiInputPrivacyRules","allowedIds","allowUserIds","allowChatIds","blockUserIds","blockChatIds","botsPrivacy","isAllowList","isPremiumAllowed","isUnspecified","shouldAllowPremium","isOnline","isSensitiveEnabled","langCode","nearestCountry","COUNTRIES_WITH_12H_TIME_FORMAT","setSharedSettingOption","nearestCountryCode","requestActionTimeout","APP_CONFIG_REFETCH_INTERVAL","isAppConfigLoaded","promoData","expires","suggestion","loadPromoData","generalHash","profileHash","generalResult","profileResult","currentPeerColors","profile","timezones","globalSettings","shouldDisplayGiftsButton","shouldUpdateUsersSettings","loadFullChat","loadUser","prevUsernames","sortedUsernames","currentUsername","passkeys","preparedOptions","credential","credentials","publicKeyCredential","loadPasskeys","Passkeys","filteredPasskeys","passkey","notifyException","getChatNotifySettings","defaults","getNotificationPeerType","DEFINITION_MAP","defs","addSvgDefinition","htmlElement","createElementNS","SVG_NAMESPACE","appendElement","removeSvgDefinition","remove","usePrevious","prevRef","lastRef","QUARTER_YEAR","HALF_YEAR","YEAR","TWO_YEARS","DURATION_EMOTICON","STAR_EMOTICON","TON_EMOTICON","selectCurrentStickerSearch","selectCurrentGifSearch","selectStickerSet","selectStickersForEmoji","addedSets","stickersForEmoji","packs","cleanEmoji","selectCustomEmojiForEmoji","isCurrentUserPremium","addedCustomSets","customEmojiForEmoji","isFree","selectCustomEmojiForEmojis","selectIsSetPremium","stickerSet","isEmoji","selectAnimatedEmoji","animatedEmojis","cleanedEmoji","selectRestrictedEmoji","restrictedEmoji","selectAnimatedEmojiEffect","animatedEmojiEffects","selectAnimatedEmojiSound","selectIsAlwaysHighPriorityEmoji","RESTRICTED_EMOJI_SET_ID","selectGiftStickerForDuration","premiumGifts","findDurationEmoji","selectGiftStickerForStars","starCount","selectGiftStickerForTon","tonGifts","convertedAmount","selectSharedState","selectAnimationLevel","selectLanguageCode","selectCanSetPasscode","selectTranslationLanguage","translationLanguage","selectNewNoncontactPeersRequirePremium","selectNonContactPeersPaidStars","selectShouldHideReadMarks","setTrigger","APP_CODE_NAME","IS_MOCKED_CLIENT","process","IS_BETA","PAID_MESSAGES_PURPOSE","DEBUG_MORE","DEBUG_LOG_FILENAME","STRICTERDOM_ENABLED","FORCE_FALLBACK_LANG","BETA_CHANGELOG_URL","PAGE_TITLE","PAGE_TITLE_TAURI","INACTIVE_MARKER","DEBUG_PAYMENT_SMART_GLOCAL","SESSION_LEGACY_USER_KEY","LEGACY_PASSCODE_CACHE_NAME","GLOBAL_STATE_CACHE_DISABLED","SHARED_STATE_CACHE_KEY","GLOBAL_STATE_CACHE_USER_LIST_LIMIT","GLOBAL_STATE_CACHE_CHAT_LIST_LIMIT","GLOBAL_STATE_CACHE_ARCHIVED_CHAT_LIST_LIMIT","GLOBAL_STATE_CACHE_CUSTOM_EMOJI_LIMIT","IS_SCREEN_LOCKED_CACHE_KEY","HAS_COMPLETED_WELCOME_KEY","MEDIA_CACHE_DISABLED","MEDIA_CACHE_NAME","MEDIA_CACHE_NAME_AVATARS","MEDIA_PROGRESSIVE_CACHE_NAME","CUSTOM_BG_CACHE_NAME","LANG_CACHE_NAME","AUTODOWNLOAD_FILESIZE_MB_LIMITS","INTERCLIENT_BROADCAST_CHANNEL","DC_IDS","isBigScreen","innerHeight","MIN_PASSWORD_LENGTH","MESSAGE_LIST_SLICE","MESSAGE_LIST_VIEWPORT_LIMIT","ARCHIVE_MINIMIZED_HEIGHT","CHAT_HEIGHT_PX","TOPIC_HEIGHT_PX","PEER_PICKER_ITEM_HEIGHT_PX","CHAT_LIST_SLICE","CHAT_LIST_LOAD_SLICE","SHARED_MEDIA_SLICE","CHAT_MEDIA_SLICE","MESSAGE_SEARCH_SLICE","GLOBAL_SEARCH_SLICE","GLOBAL_TOPIC_SEARCH_SLICE","MEMBERS_SLICE","PROFILE_SENSITIVE_AREA","TOPIC_LIST_SENSITIVE_AREA","PUBLIC_POSTS_SEARCH_DEFAULT_STARS_AMOUNT","PUBLIC_POSTS_SEARCH_DEFAULT_TOTAL_DAILY","VERIFY_AGE_MIN_DEFAULT","STORY_VIEWS_MIN_SEARCH","STORY_MIN_REACTIONS_SORT","STORY_VIEWS_MIN_CONTACTS_FILTER","MEDIA_TIMESTAMP_SAVE_MINIMUM_DURATION","GLOBAL_SUGGESTED_CHANNELS_ID","TOPICS_SLICE","TOPICS_SLICE_SECOND_LOAD","TOP_CHAT_MESSAGES_PRELOAD_LIMIT","DEFAULT_CHARGE_FOR_MESSAGES","MINIMUM_CHARGE_FOR_MESSAGES","DEFAULT_MAXIMUM_CHARGE_FOR_MESSAGES","PLAYBACK_RATE_FOR_AUDIO_MIN_DURATION","ANIMATION_LEVEL_CUSTOM","ANIMATION_LEVEL_MIN","ANIMATION_LEVEL_MED","ANIMATION_LEVEL_MAX","FOLDERS_POSITION_TOP","FOLDERS_POSITION_LEFT","PREVIEW_AVATAR_COUNT","DRAFT_DEBOUNCE","SEND_MESSAGE_ACTION_INTERVAL","GENERAL_REFETCH_INTERVAL","EDITABLE_INPUT_ID","EDITABLE_INPUT_MODAL_ID","EDITABLE_STORY_INPUT_ID","EDITABLE_INPUT_CSS_SELECTOR","EDITABLE_INPUT_MODAL_CSS_SELECTOR","EDITABLE_STORY_INPUT_CSS_SELECTOR","CUSTOM_APPENDIX_ATTRIBUTE","MESSAGE_CONTENT_CLASS_NAME","MESSAGE_CONTENT_SELECTOR","VT_CLASS_NAME","VT_TYPE_CLASS_PREFIX","RESIZE_HANDLE_CLASS_NAME","RESIZE_HANDLE_SELECTOR","SNAP_EFFECT_CONTAINER_ID","SNAP_EFFECT_ID","STARS_ICON_PLACEHOLDER","MIN_SCREEN_WIDTH_FOR_STATIC_RIGHT_COLUMN","MIN_SCREEN_WIDTH_FOR_STATIC_LEFT_COLUMN","MOBILE_SCREEN_MAX_WIDTH","MOBILE_SCREEN_LANDSCAPE_MAX_WIDTH","MOBILE_SCREEN_LANDSCAPE_MAX_HEIGHT","MAX_INT_32","TMP_CHAT_ID","ANIMATION_END_DELAY","ANIMATION_WAVE_MIN_INTERVAL","MESSAGE_APPEARANCE_DELAY","SCROLL_MIN_DURATION","SCROLL_MAX_DURATION","SCROLL_MAX_DISTANCE","SCROLL_SHORT_TRANSITION_MAX_DISTANCE","LOCK_SCREEN_ANIMATION_DURATION_MS","STICKER_SIZE_INLINE_DESKTOP_FACTOR","STICKER_SIZE_INLINE_MOBILE_FACTOR","STICKER_SIZE_AUTH","STICKER_SIZE_AUTH_MOBILE","STICKER_SIZE_PICKER","EMOJI_SIZE_PICKER","COMPOSER_EMOJI_SIZE_PICKER","STICKER_SIZE_GENERAL_SETTINGS","STICKER_SIZE_PICKER_HEADER","STICKER_PICKER_MAX_SHARED_COVERS","STICKER_SIZE_SEARCH","STICKER_SIZE_MODAL","EMOJI_SIZE_MODAL","STICKER_SIZE_TWO_FA","STICKER_SIZE_PASSCODE","STICKER_SIZE_DISCUSSION_GROUPS","STICKER_SIZE_FOLDER_SETTINGS","STICKER_SIZE_INLINE_BOT_RESULT","STICKER_SIZE_JOIN_REQUESTS","STICKER_SIZE_INVITES","EMOJI_STATUS_LOOP_LIMIT","EMOJI_SIZES","TOP_SYMBOL_SET_ID","POPULAR_SYMBOL_SET_ID","RECENT_SYMBOL_SET_ID","COLLECTIBLE_STATUS_SET_ID","FAVORITE_SYMBOL_SET_ID","EFFECT_STICKERS_SET_ID","EFFECT_EMOJIS_SET_ID","CHAT_STICKER_SET_ID","DEFAULT_TOPIC_ICON_STICKER_ID","DEFAULT_STATUS_ICON_ID","EMOJI_IMG_REGEX","BASE_EMOJI_KEYWORD_LANG","MENU_TRANSITION_DURATION","SLIDE_TRANSITION_DURATION","BIRTHDAY_NUMBERS_SET","RESTRICTED_EMOJI_SET","GIF_MIME_TYPE","LOTTIE_STICKER_MIME_TYPE","VIDEO_STICKER_MIME_TYPE","SUPPORTED_PHOTO_CONTENT_TYPES","SUPPORTED_VIDEO_CONTENT_TYPES","SUPPORTED_AUDIO_CONTENT_TYPES","CONTENT_TYPES_WITH_PREVIEW","SUPPORTED_TRANSLATION_LANGUAGES","RE_TG_LINK","RE_TME_LINK","RE_TELEGRAM_LINK","TME_LINK_PREFIX","BOT_FATHER_USERNAME","USERNAME_PURCHASE_ERROR","MESSAGE_ID_REQUIRED_ERROR","PURCHASE_USERNAME","TME_WEB_DOMAINS","LANG_PACK","NSFW_RESTRICTION_REASON","API_CHAT_TYPES","HEART_REACTION","LOCAL_MESSAGES_LIMIT","FOLDER_TITLE_MAX_LENGTH","MAX_MEDIA_FILES_FOR_ALBUM","MAX_ACTIVE_PINNED_CHATS","SCHEDULED_WHEN_ONLINE","LANG_PACKS","FEEDBACK_URL","FAQ_URL","PRIVACY_URL","MINI_APP_TOS_URL","FRESH_AUTH_PERIOD","GIVEAWAY_BOOST_PER_PREMIUM","GIVEAWAY_MAX_ADDITIONAL_CHANNELS","GIVEAWAY_MAX_ADDITIONAL_USERS","GIVEAWAY_MAX_ADDITIONAL_COUNTRIES","FRAGMENT_PHONE_CODE","FRAGMENT_PHONE_LENGTH","BOT_VERIFICATION_PEERS_LIMIT","LIGHT_THEME_BG_COLOR","DARK_THEME_BG_COLOR","PEER_COLOR_BG_OPACITY","PEER_COLOR_BG_ACTIVE_OPACITY","PEER_COLOR_GRADIENT_STEP","MAX_UPLOAD_FILEPART_SIZE","IGNORE_UNHANDLED_ERRORS","GROUP_CALL_VOLUME_MULTIPLIER","GROUP_CALL_DEFAULT_VOLUME","ONE_TIME_MEDIA_TTL_SECONDS","PREMIUM_FEATURE_SECTIONS","PREMIUM_BOTTOM_VIDEOS","PREMIUM_LIMITS_ORDER","sortType","shouldIncludeUnlimited","shouldIncludeLimited","shouldIncludeUnique","shouldIncludeDisplayed","shouldIncludeHidden","shouldIncludeUpgradable","ACCOUNT_TTL_OPTIONS","ALPHAHUMAN_BOT_USERNAME","ALPHAHUMAN_BOT_ID","delay","savedCallback","setInterval","clearInterval","tabStatePartial","timerId","deepMerge","isLiteralObject","oldValue","hasOwnProperty","__delete","reduceDiff","diff","__deleteAllChildren","CLOSE_DURATION","useShowTransition","noMountTransition","noOpenTransition","noCloseTransition","closeDuration","prefix","shouldForceOpen","localRef","closingTimeoutRef","getState","setState","useSignal","optionsRef","onCloseEndLast","useSyncEffectWithPrevDeps","prevIsOpen","applyClassNames","addExtraClass","shouldRender","hasOpenClass","isClosing","toggleExtraClass","withShouldRender","useDerivedState","getIsClosing","useDerivedSignal","startCallbacks","endCallbacks","dispatchPriorityPlaybackEvent","onStart","lastOnStart","lastOnEnd","getSavedGiftKey","gift","withoutTag","localTag","prevDeps","cleanupRef","LOCAL_TGS_PREVIEW_URLS","DuckNothingFound","Search","LOCAL_TGS_URLS","MonkeyIdle","MonkeyTracking","MonkeyClose","MonkeyPeek","FoldersAll","FoldersNew","DiscussionGroups","Lock","CameraFlip","HandFilled","HandOutline","Speaker","VoiceAllowTalk","VoiceMini","VoiceMuted","VoiceOutlined","JoinRequest","Invite","QrPlane","Congratulations","Experimental","PartyPopper","Flame","ReadTime","Unlock","LastSeen","StarReactionEffect","StarReaction","HealthyStar","Report","SearchingDuck","BannedDuck","Diamond","DuckCake","SVG_MAP","SvgColorFilter","referenceCount","filterId","xmlns","getFilterId","removeReference","isUsed","asValue","prepareStyle","initial","setValue","shouldRunFirst","shouldRunLast","waitingTimeout","interval","isPending","_args","throttleWithTickEnd","onTickEnd","waiting","rafPromise","fastRaf","fastRafCallbacks","fastRafFallbackCallbacks","fastRafFallbackTimeout","onTickEndCallbacks","onIdleCallbacks","beforeUnloadCallbacks","withTimeoutFallback","requestAnimationFrame","currentCallbacks","currentTimeoutCallbacks","requestIdleCallback","deadline","timeRemaining","onBeforeUnload","isLast","unshift","DEBUG_currentRandomId","currentGlobal","DEBUG_invalidateGlobalOnTickEnd","actionHandlers","DEBUG_startAt","containers","mapStateToProps","ownProps","mappedProps","activateContainer","newMappedProps","DEBUG_componentName","DEBUG_updates","updateTime","runCallbacksThrottled","setUntypedGlobal","newGlobal","forceOutdated","DEBUG_randomId","forceSyncOnIOs","getUntypedGlobal","getUntypedActions","actionQueue","afterActionQueue","addUntypedActionHandler","handleAction","withUntypedGlobal","activationFn","Component","TeactNContainer","DEBUG_contentComponentName","DEBUG_resolveComponentName","stuckTo","stickTo","orderBy","createListener","matchMedia","devicePixelRatio","useDevicePixelRatio","dpr","setDpr","addLocalizationCallback","initialWidth","initialHeight","setWidth","setHeight","isResizing","setIsResizing","setIsResizingDebounced","throttledSetIsResizing","throttledSetSize","newWidth","newHeight","handleResize","unloadVideo","removeAttribute","firstChild","load","ICON_POSITIONS","inline","block","opacity","EMOJI_SIZE","EMOJI_SPACE","EmojiIconBackground","emojiDocumentId","withEmojiSpace","canvasRef","emojiImage","setEmojiImage","useCustomEmoji","previewMediaHash","getStickerMediaHash","useDynamicColorListener","preloadAfterHeavyAnimation","useThrottleForHeavyAnimation","preloadImage","updateCanvas","context","clearRect","xShift","save","globalAlpha","translate","restore","tintColor","isLottie","updateCanvasAfterHeavyAnimation","updateCanvasSize","parentWidth","parentHeight","contentRect","useResizeObserver","getBoundingClientRect","usePeerColor","noUserColors","shouldReset","propertiesRef","getPeerColorCountClass","peerColorId","peerColor","isCollectible","colorCountClass","getPeerColorCount","getPeerColorCollectibleColorCount","accentColor","darkAccentColor","darkColors","gradient","generatePeerColorGradient","bg","bgActive","generateColorVariations","backgroundEmojiId","giftEmojiId","colorIndex","colorCount","InputText","readOnly","placeholder","autoComplete","inputMode","maxLength","teactExperimentControlled","onInput","onKeyPress","onBlur","onPaste","spellCheck","htmlFor","CLASSES","ACTIVE_SLIDE_CLASS_NAME","TO_SLIDE_CLASS_NAME","DISABLEABLE_ANIMATIONS","activeKey","nextKey","direction","renderCount","shouldRestoreHeight","shouldCleanup","cleanupExceptionKey","cleanupOnlyKey","shouldWrap","wrapExceptionKey","slideClassName","withSwipeControl","isBlockingAnimation","dataTauriDragRegion","contentSelector","restoreHeightKey","onStop","onScroll","onWheel","currentKeyRef","shouldDisableAnimation","rendersRef","prevActiveKey","isAnimatingRef","isSwipeJustCancelledRef","hasActiveKeyChanged","prevName","prevIsSliceOptimized","isSlideOptimized","removeExtraClass","isBackwards","prevActiveIndex","activeIndex","childNodes","childElements","el","childElement","setExtraStyles","transition","transform","toSlide","fromSlide","HTMLElement","endHeavyAnimation","requestForcedReflow","forceReflow","performSlideOptimized","onAnimationEnd","watchedNode","giveUpAnimationEnd","allowSwipeControlForTransition","contentElement","clientWidth","flexBasis","asFastList","renders","contents","rendered","teactOrderKey","teactFastList","getIsVideoPlaying","paused","ended","readyState","mediaEl","PACKET_TYPES","PACKET_TYPES_REVERSE","ERROR_PACKET","withNativeBlob","withNativeArrayBuffer","ArrayBuffer","isView","encodePacket","supportsBinary","encodeBlobAsBase64","fileReader","FileReader","readAsDataURL","toArray","Uint8Array","byteOffset","byteLength","TEXT_ENCODER","lookup","chars","decodePacket","encodedPacket","binaryType","mapBinary","charAt","decodeBase64Packet","decoded","base64","encoded1","encoded2","encoded3","encoded4","bufferLength","arraybuffer","SEPARATOR","TEXT_DECODER","totalLength","chunks","chunk","concatChunks","Emitter","mixin","on","_callbacks","off","apply","arguments","removeListener","removeAllListeners","emit","emitReserved","listeners","hasListeners","nextTick","setTimeoutFn","globalThisShim","Function","attr","NATIVE_SET_TIMEOUT","NATIVE_CLEAR_TIMEOUT","installTimerFunctions","opts","useNativeTimers","bind","clearTimeoutFn","utf8Length","randomString","TransportError","super","Transport","writable","socket","forceBase64","onError","open","doOpen","doClose","send","packets","onData","packet","onPacket","details","onPause","createUri","schema","_hostname","_port","_query","port","secure","encodedQuery","_polling","_poll","total","doPoll","encodedPayload","encodedPackets","decodedPacket","decodePayload","encodePayload","doWrite","timestampRequests","timestampParam","sid","b64","XMLHttpRequest","hasCORS","empty","BaseXHR","isSSL","xd","req","request","xhrStatus","pollXhr","Request","createRequest","_opts","_method","_uri","_data","_create","_a","xdomain","xhr","_xhr","extraHeaders","setDisableHeaderCheck","setRequestHeader","cookieJar","addCookies","withCredentials","requestTimeout","onreadystatechange","parseCookies","getResponseHeader","_onLoad","_onError","_index","requestsCount","requests","_cleanup","fromError","abort","responseText","unloadHandler","attachEvent","hasXHR2","newRequest","responseType","isReactNative","product","BaseWS","protocols","ws","createSocket","addEventListeners","onopen","autoUnref","_socket","unref","onclose","closeEvent","onmessage","ev","onerror","lastPacket","WebSocketCtor","WebSocket","MozWebSocket","transports","websocket","_packet","webtransport","_transport","WebTransport","transportOptions","createBidirectionalStream","stream","decoderStream","maxPayload","TextDecoder","expectedLength","isBinary","TransformStream","headerArray","DataView","getUint16","view","getUint32","enqueue","createPacketDecoderStream","reader","readable","pipeThrough","getReader","encoderStream","arrayBuffer","encoded","TextEncoder","encode","encodePacketToBinary","payloadLength","setUint8","setUint16","setBigUint64","pipeTo","_writer","getWriter","done","polling","re","exec","authority","ipv6uri","pathNames","names","queryKey","$0","$1","$2","withEventListeners","OFFLINE_EVENT_LISTENERS","listener","SocketWithoutUpgrade","writeBuffer","_prevBufferLen","_pingInterval","_pingTimeout","_maxPayload","_pingTimeoutTime","parsedUri","_transportsByName","transportName","agent","upgrade","rememberUpgrade","addTrailingSlash","rejectUnauthorized","perMessageDeflate","closeOnBeforeunload","qs","qry","pairs","pair","decodeURIComponent","_beforeunloadEventListener","transport","_offlineEventListener","_onClose","_cookieJar","createCookieJar","_open","createTransport","EIO","priorWebsocketSuccess","setTransport","_onDrain","_onPacket","flush","onHandshake","_sendPacket","_resetPingTimeout","pingInterval","pingTimeout","_pingTimeoutTimer","upgrading","_getWritablePackets","payloadSize","_hasPingExpired","hasExpired","compress","cleanupAndClose","waitForUpgrade","tryAllTransports","SocketWithUpgrade","_upgrades","_probe","failed","onTransportOpen","freezeTransport","onTransportClose","onupgrade","_filterUpgrades","upgrades","filteredUpgrades","Socket","o","withNativeFile","File","hasBinary","deconstructPacket","buffers","packetData","pack","_deconstructPacket","attachments","_placeholder","num","newData","reconstructPacket","_reconstructPacket","RESERVED_EVENTS","PacketType","Encoder","replacer","EVENT","ACK","encodeAsString","encodeAsBinary","BINARY_EVENT","BINARY_ACK","nsp","deconstruction","Decoder","reviver","reconstructor","decodeString","isBinaryEvent","BinaryReconstructor","takeBinaryData","start","buf","next","tryParse","isPayloadValid","CONNECT","isObject","DISCONNECT","CONNECT_ERROR","finishedReconstruction","reconPack","binData","isFinite","isPacketValid","isDataValid","connect","connect_error","disconnecting","newListener","io","connected","recovered","receiveBuffer","sendBuffer","_queue","_queueSeq","acks","flags","_autoConnect","disconnected","subEvents","subs","onpacket","_readyState","_b","_c","retries","fromQueue","volatile","_addToQueue","ack","pop","_registerAckCallback","isTransportWritable","engine","isConnected","notifyOutgoingListeners","ackTimeout","timer","withError","emitWithAck","arg1","arg2","tryCount","pending","responseArgs","_drainQueue","force","_sendConnectPacket","_pid","pid","_lastOffset","_clearAcks","onconnect","onevent","onack","ondisconnect","emitEvent","_anyListeners","sent","emitBuffered","subDestroy","onAny","prependAny","offAny","listenersAny","onAnyOutgoing","_anyOutgoingListeners","prependAnyOutgoing","offAnyOutgoing","listenersAnyOutgoing","Backoff","factor","jitter","attempts","rand","deviation","reset","setMin","setMax","setJitter","Manager","nsps","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","_parser","parser","encoder","decoder","autoConnect","_reconnection","skipReconnect","_reconnectionAttempts","_reconnectionDelay","_randomizationFactor","_reconnectionDelayMax","_timeout","maybeReconnectOnOpen","_reconnecting","reconnect","openSubDestroy","errorSub","onping","ondata","ondecoded","_destroy","_close","onreconnect","attempt","parsed","loc","sameNamespace","forceNew","multiplex","ValidationError","validateId","paramName","intValue","parseInt","ErrorCategory","logAndFormatError","functionName","category","VALIDATION","generateErrorCode","contextStr","isError","getChatById","chatIdStr","getUserById","userIdStr","getMessages","limit","offsetId","getChats","getCurrentUser","formatEntity","formatMessage","toISOString","from_id","has_media","media_type","tool","inputSchema","properties","page","page_size","pageSize","paginatedChats","getChatsApi","CHAT","chat_type","enum","toHumanReadableAction","listChats","chatType","contentItems","chat_id","required","getChat","messageText","user_ids","items","createGroup","validatedId","GROUP","group_id","inviteToGroup","groupId","megagroup","createChannel","isMegagroup","isBroadcast","editChatTitle","deleteChatPhoto","channelId","getParticipants","memberFilter","member","getAdmins","customTitle","ADMIN","getBannedUsers","kickedBy","kickedByUserId","user_id","promoteAdmin","changeInfo","postMessages","editMessages","deleteMessages","banUsers","inviteUsers","pinMessages","demoteAdmin","banUser","bannedRights","viewMessages","sendMessages","sendMedia","sendStickers","sendGifs","sendGames","sendInline","embedLinks","sendPolls","unbanUser","getInviteLink","inviteLink","newLink","link","exportChatInvite","importChatInvite","joinChatByLink","subscribePublicChannel","searchResult","muteChat","unmuteChat","archiveChat","unarchiveChat","getMessagesApi","formatted","replyInfoStr","msgText","dateStr","MSG","search_query","from_date","to_date","listMessages","filteredMessages","msgDate","toDate","offset_topic","listTopics","offsetTopic","searchQuery","offsetTopicId","topics","messageCount","sendMessage","sendMessageApi","message_id","replyToMessage","new_text","editMessage","messageResult","deleteMessage","from_chat_id","to_chat_id","forwardMessage","fromChat","toChat","pinMessage","isUnpin","unpinMessage","markAsRead","context_size","getMessageContext","centralResult","allMessages","centralIndex","startIndex","endIndex","contextMessages","getHistory","getPinnedMessages","pinnedMessages","big","sendReaction","shouldAddToRecent","removeReaction","getMessageReactions","listInlineButtons","buttons","inlineButtons","row","rowIndex","colIndex","column","button_text","button_index","pressInlineButton","targetButton","reply_to_msg_id","no_webpage","saveDraft","draft","getDrafts","drafts","clearDraft","listContacts","chatsResult","contactChats","contactInfo","CONTACT","searchContacts","allResultIds","accountResultIds","globalResultIds","first_name","last_name","addContact","deleteContact","blockUser","unblockUser","getBlockedUsers","getMe","PROFILE","updateProfile","getUserPhotos","photos","getUserStatus","searchPublicChats","searchChats","SEARCH","searchMessages","resolveUsername","cleanUsername","userEntity","getMediaInfo","MESSAGE_DELETED","mediaInfo","sizes","MEDIA","S","Si","T1","Uint32Array","T2","T3","T4","T5","T6","T7","T8","s2i","pos","getWords","xor","right","x4","tEnc","tDec","xInv","computeTables","AES","_key","encKey","decKey","tmp","rcon","encrypt","_message","a2","b2","c2","rounds","decrypt","AES_IGE","iv","blockSize","cipher","cipherText","prevX","subarray","prevY","yXOR","incrementCounter","carry","toSignedLittleBuffer","Buffer","allocUnsafe","writeBigInt64LE","CRC32_TABLE","crcTable","crc32","isBuffer","crc","byte","variableSnakeToCamelCase","group","CORE_TYPES","AUTH_KEY_TYPES","findAll","fromLine","isFunction","argsMatch","currentConfig","constructorId","argsConfig","subclassOfId","namespace","hexId","arg","representation","brace","argType","buildArgConfig","isVector","isFlag","skipConstructorId","flagGroup","flagIndex","flagIndicator","useVectorId","flagMatch","vectorMatch","serializeBytes","padding","alloc","CACHING_SUPPORTED","CACHE_KEY","extractParams","fileContent","methods","ignoreIds","objAll","objByName","objByType","commentIndex","followingTypes","parseTl","constructors","functions","argToBytes","writeInt32LE","writeDoubleLE","dt","serializeDate","getBytes","getArgFromReader","readInt","temp","readLong","readLargeInt","readDouble","tgReadString","tgReadBool","tgReadBytes","tgReadDate","tgReadObject","createClasses","classesType","classes","classParams","fullName","VirtualClass","static","CONSTRUCTOR_ID","SUBCLASS_OF_ID","classType","argName","fromReader","flagValue","idForBytes","writeUInt32LE","flagCalculate","firstChar","readResult","definitions","fromCache","jsonCache","loadFromCache","constructorParamsApi","functionParamsApi","constructorParamsSchema","functionParamsSchema","loadFromTlSchemas","obj1","obj2","mergeWithNamespaces","buildApiFromTlSchema","RPCError","_fmtRequest","InvalidDCError","BadRequestError","FloodError","FloodWaitError","capture","newDc","codeLength","GZIPPacked","gzipIfSmaller","contentRelated","gzipped","toBytes","gzip","ungzip","inflate","TLMessage","msgId","seqNo","MessageContainer","before","tellPosition","setPosition","tlMessage","RPCResult","reqMsgId","innerCode","Api","RpcError","seek","tlobjects","sub","AbortSignal","ctrl","AbortController","signal","E_CANCELED","Semaphore","_value","_cancelError","_weightedWaiters","acquire","weight","priority","task","findIndexFromEnd","other","_dispatchItem","runExclusive","callback_1","thisArg","_arguments","generator","release","P","fulfilled","rejected","adopt","waitForUnlock","_couldLockImmediately","insertSorted","isLocked","getValue","_dispatchQueue","cancel","_drainUnlockWaiters","previousValue","_newReleaser","called","waiters","waiter","queuedPriority","predicate","cancelError","_semaphore","releaser","fingerprint","keyInfo","batchedUpdates","throttledLocalDbUpdate","convertToVirtualClass","field","GramJs","valueOmited","rest","omitVirtualClassFields","localDb","convertedValue","acc2","key2","typedValue","buildMtpPeerId","getLocalDb","dcManagers","getDcManagers","getRecentActions","InputChannel","InputChannelEmpty","GetAdminLog","q","eventsFilter","admins","minId","multiple_choice","quiz_mode","public_votes","close_date","createPoll","closeDate","answers","multipleChoice","isPublic","bot_username","getBotInfo","resolvedPeer","fullUser","botInfo","isBot","isVerified","commands","bot_info","setBotCommands","bot","getPrivacySettings","allow_users","disallow_users","setPrivacySettings","apiKey","profile_photo","file_path","setProfilePhoto","fetchError","deleteProfilePhoto","editChatPhoto","getStickerSets","sets","stickerSets","getGifSearch","gifIds","gif","getContactIds","contactIds","importContacts","importedCount","exportContacts","contact_query","getDirectChatByContact","queryLower","foundContacts","contactName","contact_id","getContactChats","contactId","common","getLastInteraction","chatResult","addOffset","SocketIOMCPTransportImpl","requestHandlers","eventPrefix","setupEventHandlers","fullEvent","timeoutMs","updateSocket","handleResponse","MCPServer","setupHandlers","updateGlobal","handleToolCallRequest","requestId","toolsList","listTools","tools","toolCall","handleToolCall","errorResult","toolHandler","findToolHandler","get_chats","list_chats","get_chat","create_group","invite_to_group","create_channel","edit_chat_title","delete_chat_photo","leave_chat","get_participants","get_admins","get_banned_users","promote_admin","demote_admin","ban_user","unban_user","get_invite_link","export_chat_invite","import_chat_invite","join_chat_by_link","subscribe_public_channel","get_messages","list_messages","list_topics","send_message","reply_to_message","edit_message","delete_message","forward_message","pin_message","unpin_message","mark_as_read","get_message_context","get_history","get_pinned_messages","send_reaction","remove_reaction","get_message_reactions","list_contacts","search_contacts","add_contact","delete_contact","block_user","unblock_user","get_blocked_users","get_me","update_profile","get_user_photos","get_user_status","mute_chat","unmute_chat","archive_chat","unarchive_chat","get_privacy_settings","set_privacy_settings","list_inline_buttons","press_inline_button","save_draft","get_drafts","clear_draft","search_public_chats","search_messages","resolve_username","get_media_info","get_recent_actions","create_poll","get_bot_info","set_bot_commands","set_profile_photo","delete_profile_photo","edit_chat_photo","get_sticker_sets","get_gif_search","get_contact_ids","import_contacts","export_contacts","get_direct_chat_by_contact","get_contact_chats","get_last_interaction","mcpServerInstance","socketManagerInstance","AlphaHumanManager","getBackendUrl","reconnectAttempts","maxReconnectAttempts","reconnectDelay","newState","oldState","updateAlphaHumanSocketState","login","updateJwtAndLogin","validateJwtToken","tokenPreview","atob","tgUserId","exp","iat","requestIdText","onAlphaHumanBackendError","onAlphaHumanAgentStreamingUpdate","initMCPServer","streamMessageForUser","crypto","randomUUID","isResolved","onComplete","timeoutId","loadJwtTokenLocally","isAuthenticated","globalToken","updateAlphahuman","updateCacheThrottled","updateCache","updateCacheForced","unsubscribeFromBeforeUnload","isCaching","isRemovingCache","cacheUpdateSuspensionTimestamp","cacheGlobal","MAIN_IDB_STORE","cacheSharedState","loadCachedSharedState","removeGlobalFromCache","del","removeSharedStateFromCache","cacheIsScreenLocked","initCache","setupCaching","resetCache","removeItem","clearCaching","loadCache","initialState","cachedFromLocalStorage","timeEnd","migrateCache","readCache","hasPasscode","hasStoredSession","untypedCached","darkPeerColors","miniAppsCachedPosition","miniAppsCachedSize","cachedSharedSettings","shouldWarnAboutSvg","unsafeMigrateCache","forceUpdateCache","temporarilySuspendCacheUpdate","noEncrypt","serializedGlobal","serializeGlobal","encryptSession","clearGlobalForLockScreen","clearSharedStateForLockScreen","reduceGlobal","availableReactions","lastIsChatInfoShown","getIsMobile","reduceCustomEmojis","reduceUsers","reduceChats","reduceMessages","reduceSettings","reduceChatFolders","reduceGroupCalls","reduceAlphahuman","folderEmojiIds","idsToSave","currentChatIds","visibleUserIds","chatStoriesUserIds","attachBotIds","userIds","recentlyFoundChatIds","getOrderedIds","contactList","pickTruthy","messagesChatIds","replyPeer","unlinkedIdsToSave","forumPanelChatIds","forumPanelChatId","chatIdsToSave","openedChatThreadIds","tabChatId","pollIdsToSave","webPageIdsToSave","chatLastMessageId","openedThreadIds","commentThreadIds","originMessageId","threadIds","threadsToSave","viewportIdsToSave","lastViewportIds","selectTopics","topicLastMessageIds","savedLastMessageIds","lastMessageIdsToSave","typingStatus","cleanedById","isTypingDraft","cleanedMessage","blobUrl","isPreloadedGlobally","omitLocalMedia","localAmount","omitLocalPaidReactions","lastPremiumBandwithNotificationDate","activeGroupCallId","RippleEffect","ripples","setRipples","cleanUpDebounced","position","rippleSize","clientX","clientY","parseLine","separatorIndex","isEscaped","isInsideString","FALLBACK_LANG_CODE","LANGPACK_STORE_PREFIX","FORMATTERS_FALLBACK_LANG","TRANSLATION_CACHE","LimitedMap","formatters","langPack","fallbackLangPack","translationFn","createTranslationFn","areCallbacksScheduled","scheduleCallbacks","localizationReady","loadCachedLangData","cacheLangData","notifyLangpackUpdate","fallbackLoadPromise","loadFallbackPack","forLocalScript","fileData","readFileSync","rawStrings","readStrings","strings","clearKey","pluralSuffix","knownValue","stringsCount","nativeName","pluralCode","translatedCount","translationsUrl","readFallbackStrings","fallbackData","updateLanguage","fetchDifference","fromVersion","applyLangPackDifference","keysToRemove","newLangPack","updateLangPack","newLang","createFormatters","listFormatFallback","formatToParts","createListFormat","IS_INTL_LIST_FORMAT_SUPPORTED","ListFormat","pluralRules","PluralRules","region","DisplayNames","conjunction","disjunction","preciseNumber","initLocalization","canLoadFromServer","cachedData","loadAndChangeLanguage","refreshFromCache","shouldCheckCache","changeLanguage","remoteLanguage","requestLangPackDifference","newLanguage","remoteLangPack","baseLangCode","areAdvancedLangFnOptions","processTranslationAdvanced","processTranslation","rawCode","with","withRegular","withAdvanced","of","internalFormatters","languageInfo","getString","langKey","langPackStringValue","initialStrings","isDeletedLangString","select","isPluralLangString","finalString","valueAsString","replaceAll","variableEntries","tempResult","specialReplacement","replaceInStringsWithTeact","withRenderText","initialFilters","curr","preparedValue","localizationReadyPromise","clamp","isBetween","lerp","end","interpolationRatio","roundToNearestEven","currentWindowSize","updateSizes","handleOrientationChange","visualViewport","pageTop","vh","getIsKeyboardVisible","NO_QUEUE_BEFORE_INIT","worker","requestStates","requestStatesByCallback","pendingPayloads","savedLocalDb","webDocuments","commonBoxState","channelPtsById","isMasterTabNew","postMessagesOnTickEnd","payloads","postMessageOnTickEnd","updateCallback","localApiRequestsQueue","apiRequestsQueue","initialArgs","initApiOnMasterTab","Worker","updates","handleMethodResponse","handleMethodCallback","sendBeacon","logDebugMessage","level","subscribeToWorker","ensureWorkerPing","makeRequest","fnName","callApiLocal","updateLocalDb","updateFullLocalDb","isEnabled","requestState","withCallback","callApiOnMasterTab","makeRequestToMaster","cancelApiProgress","progressCallback","cancelApiProgressMaster","callbackArgs","DEBUG_payload","startedAt","race","terminate","mediaQueryCache","isMobile","isTablet","isLandscape","getIsTablet","getIsWebAppsFullscreenSupported","handleMediaQueryChange","isDesktop","mobileQuery","tabletQuery","landscapeQuery","isTouchScreenQuery","initMediaQueryCache","LOAD_QUEUE","RENDER_HISTORY","loadFromQueue","queue","queueToLoad","otherQueue","loadCustomEmojis","updateLastRendered","updateLastRenderedCustomEmojis","notifyCustomEmojiRender","emojiId","addCustomEmojiInputRenderCallback","setCustomEmoji","setCanPlay","selectCanPlayAnimatedEmojis","handleGlobalChange","addCustomEmojiCallback","removeCustomEmojiCallback","selectPeerPhotos","selectCanGift","areStarGiftsAvailable","selectPeerCollectionSavedGifts","collectionId","selectPeerSavedGifts","isChatWithUser","userFullInfo","isChatAdmin","selectPeerHasProfileBackground","profileColor","emojiStatus","selectCanUpdateMainTab","ELIGIBLE_HOSTNAMES","tryParseDeepLink","correctUrl","getQueryParams","pathParams","getPathParams","boost","isNumber","getHttpDeepLinkType","single","comment","buildPublicMessageLink","commentId","buildPrivateMessageLink","buildShareLink","buildChatFolderLink","buildLoginCodeLink","buildPublicUsernameOrBotLink","startApp","startapp","mode","startAttach","startattach","attach","choose","direct","buildPrivateChannelLink","buildBusinessChatLink","buildChatBoostLink","isPrivateChannel","buildGiftUniqueLink","buildGiftAuctionLink","parseHttpLink","urlToParse","IS_BAD_URL_PARSER","post","bot_id","scope","public_key","nonce","getTgDeepLinkType","callbackUrl","buildTelegramPassportLink","callback_url","appname","buildPremiumReferrerLink","buildPremiumMultigiftLink","buildSettingsScreen","buildSettingsScreenLink","parseTgLink","parseDeepLink","getUsernameFromDeepLink","deepLink","isSingle","parseTimestampDuration","isDirect","screenParam","fromEntries","__classPrivateFieldGet","receiver","kind","TypeError","__classPrivateFieldSet","SuppressedError","elementObserverMap","refOrElement","onIntersectionChange","onIntersectionChangeLast","googleOAuth","isConnecting","updatedGlobal","oauthUrl","oauthState","ieee754","customInspectSymbol","K_MAX_LENGTH","createBuffer","setPrototypeOf","encodingOrOffset","encoding","isEncoding","actual","fromString","arrayView","isInstance","copy","fromArrayBuffer","fromArrayLike","fromArrayView","SharedArrayBuffer","valueOf","numberIsNaN","fromObject","toPrimitive","assertSize","array","mustMatch","loweredCase","utf8ToBytes","base64ToBytes","slowToString","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","val","arrayIndexOf","arr","indexSize","arrLength","valLength","readUInt16BE","foundIndex","hexWrite","remaining","strLen","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","firstByte","codePoint","bytesPerSequence","secondByte","thirdByte","fourthByte","tempCodePoint","codePoints","MAX_ARGUMENTS_LENGTH","decodeCodePointsArray","TYPED_ARRAY_SUPPORT","proto","foo","typedArraySupport","defineProperty","enumerable","poolSize","allocUnsafeSlow","_isBuffer","compare","swap16","swap32","swap64","equals","inspect","thisStart","thisEnd","thisCopy","targetCopy","_arr","ret","hexSliceLookupTable","checkOffset","ext","checkInt","wrtBigUInt64LE","checkIntBI","wrtBigUInt64BE","checkIEEE754","writeFloat","littleEndian","noAssert","writeDouble","newBuf","readUintLE","readUIntLE","readUintBE","readUIntBE","readUint8","readUInt8","readUint16LE","readUInt16LE","readUint16BE","readUint32LE","readUInt32LE","readUint32BE","readUInt32BE","readBigUInt64LE","defineBigIntMethod","validateNumber","first","last","boundsError","readBigUInt64BE","readIntLE","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readBigInt64LE","readBigInt64BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUintLE","writeUIntLE","writeUintBE","writeUIntBE","writeUint8","writeUInt8","writeUint16LE","writeUInt16LE","writeUint16BE","writeUInt16BE","writeUint32LE","writeUint32BE","writeUInt32BE","writeBigUInt64LE","writeBigUInt64BE","writeIntLE","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32BE","writeBigInt64BE","writeFloatLE","writeFloatBE","writeDoubleBE","targetStart","copyWithin","errors","E","sym","getMessage","Base","configurable","stack","addNumericalSeparator","range","ERR_OUT_OF_RANGE","checkBounds","ERR_INVALID_ARG_TYPE","ERR_BUFFER_OUT_OF_BOUNDS","received","INVALID_BASE64_RE","leadSurrogate","toByteArray","base64clean","dst","alphabet","table","i16","BufferBigIntNotDefined","notionOAuth","workspace","initialLocationHash","parseInitialLocationHash","hasTestParam","tgWebAuthTest","accountsInfo","accountIds","apiUpdate","userAgent","PLATFORM_ENV","loadStoredSession","isWebmSupported","IS_WEBM_SUPPORTED","maxBufferSize","MAX_BUFFER_SIZE","webAuthToken","tgWebAuthToken","tgWebAuthDcId","mockScenario","isTestServerRequested","hasPasskeySupport","IS_WEBAUTHN_SUPPORTED","password","videoTs","updateManagementProgress","ManagementProgress","storeSession","clearStoredSession","hangUp","leaveGroupCall","disconnectAlphaHumanSocket","resetInitialLocationHash","resetLocationHash","clearEncryptedSession","cacheApi","destroySharedStatePort","PASSCODE_IDB_STORE","langCachePrefix","langCacheVersion","initShared","otherTabId","authNearestCountry","sessionJson","globalJson","forgetPasscode","updatePasscodeSettings","invalidAttemptsCount","timeoutUntil","formatStarsAsText","formatTonAsText","shouldConvertFromNanos","formattedAmount","containerClassName","clearHex","hex","hex2rgb","cleanHex","hex2rgba","rgb2hex","rgba2hex","rgb2hsv","h","hsv2rgb","black","rgb","naturalHeight","naturalWidth","getImageData","getPatternColor","hsv","int2cssRgba","getTextColor","lerpRgbaObj","adjustHsv","satDelta","valDelta","hsva","rgba2hsva","hsva2rgba","initials","buildInitials","prepared","DEBUG_getFolderManager","updateFolderManagerThrottled","updateFolderManager","inited","updateFolders","orderedIdsByFolderId","getPinnedChatsCount","pinnedCountByFolderId","getChatsCount","chatsCountByFolderId","getUnreadCounters","unreadCountersByFolderId","getUnreadChatsByFolderId","unreadChatIdsByFolderId","getAllNotificationsCount","notificationsCount","getOrderKey","isForSaved","chatSummariesById","orderInSaved","orderInAll","getChatFolderIds","folderIdsByChatId","addOrderedIdsCallback","addChatsCountCallback","addUnreadChatsByFolderIdCallback","addUnreadCountersCallback","DEBUG_startedAt","isAllFolderChanged","isMainFolderChanged","isArchivedFolderChanged","isSavedFolderChanged","isAllFullyLoadedChanged","isAllFolderFullyLoaded","isArchivedFullyLoadedChanged","isArchivedFolderFullyLoaded","isSavedFolderFullyLoadedChanged","isSavedFolderFullyLoaded","areFoldersChanged","foldersById","areChatsChanged","chatsById","areSavedLastMessageIdsChanged","lastSavedMessageIds","areAllLastMessageIdsChanged","lastAllMessageIds","areTopicsChanged","areUsersChanged","usersById","areNotifyDefaultsChanged","areNotifyExceptionsChanged","notifyExceptions","affectedFolderIds","emptyFolderIds","folderSummariesById","updateFullyLoaded","updateResults","prevAllFolderListIds","allFolderListIds","prevArchivedFolderListIds","archivedFolderListIds","prevSavedFolderListIds","savedFolderListIds","newChatsById","newUsersById","newAllLastMessageIds","newSavedLastMessageIds","newNotifyDefaults","newNotifyExceptions","folderSummaries","newAllFolderListIds","newArchivedFolderListIds","newSavedFolderListIds","newGeneralIds","allIds","newFolderIds","currentSummary","isRemovedFromAll","isRemovedFromSaved","newSummary","chatUnreadCount","chatUnreadMentionsCount","hasUnreadMark","userInfo","shouldHideServiceChat","creationDate","draftDate","lastMessageInSaved","isListedInAll","isListedInSaved","isArchived","isUserContact","buildChatSummary","chatSummary","folderSummary","isChatInFolder","buildChatFolderIds","currentFolderIds","deletedFolderIds","currentFolderIdsSet","newFolderIdsSet","currentFolderOrderedIds","chatIdsByFolderId","isOrderedListJustPatched","updateListsForChat","newListIds","newPinnedIds","currentPinnedIds","allFolderPinnedIds","savedFolderPinnedIds","archivedFolderPinnedIds","changedFolders","buildFolderSummaryFromMainList","newFoldersById","buildFolderSummary","wasUnreadCountersChanged","wasChatsCountChanged","wasUnreadChatsChanged","pinnedCount","newPinnedCount","newOrderedIds","prevOrderedIds","isSavedFolder","sortedPinnedIds","allListIds","sortedNotPinnedIds","chatId1","chatId2","buildFolderOrderedIds","currentOrderedIds","currentPinnedCount","currentChatsCount","newChatsCount","currentUnreadCounters","newUnreadCounters","chatsCount","buildFolderUnreadCounters","currentUnreadChats","newUnreadChats","buildFolderByUnreadChats","newInitials","SAFE_EXEC_ENABLED","safeExec","rescue","always","shouldIgnoreError","SwipeDirection","IOS_SCREEN_EDGE_THRESHOLD","SWIPE_DIRECTION_THRESHOLD","SWIPE_DIRECTION_TOLERANCE","getDistance","hypot","pageY","getTouchCenter","lastClickTime","lethargy","stability","tolerance","lastUpDeltas","lastDownDeltas","deltasTimestamp","check","lastDelta","originalEvent","wheelDelta","deltaY","detail","isInertia","lastDeltas","lastDeltasOld","lastDeltasNew","oldSum","newSum","oldAverage","newAverage","IS_WINDOWS","captureEvents","captureEvent","hasMoved","hasSwiped","isZooming","initialDistance","wheelZoom","initialZoom","initialDragOffset","isDragCanceled","initialSwipeAxis","initialTouchCenter","minZoom","maxZoom","isNearEdge","onCapture","includedClosestSelector","withNativeDrag","withCursor","onDrag","onMove","onRelease","passive","selectorToPreventScroll","scrollable","overflow","onDoubleClick","centerX","centerY","newWindowSize","onZoom","endDistance","touchCenter","dragOffsetX","dragOffsetY","zoomFactor","initialCenterX","initialCenterY","currentCenterX","currentCenterY","shouldPreventScroll","onSwipe","xAbs","yAbs","swipeThreshold","axis","currentSwipeAxis","offsets","Left","Right","Up","Down","processSwipe","releaseWheelDrag","releaseWheelZoom","onWheelCapture","doubleTapZoom","is","deltaX","ctrlKey","metaKeyPressed","metaKey","shiftKey","zoom","onWheelZoom","isUserEvent","sign","dx","dy","onWheelDrag","withWheelDrag","isNotPassive","useShowTransitionDeprecated","onCloseTransitionEnd","noFirstOpenTransition","setIsClosed","closeTimeoutRef","hasOpenClassName","setHasOpenClassName","shouldHaveOpenClassName","hasShownClass","endianness","loadavg","uptime","freemem","MAX_VALUE","totalmem","cpus","appVersion","networkInterfaces","getNetworkInterfaces","arch","tmpdir","tmpDir","EOL","homedir","EXCLUDE_EMOJIS","unifiedToNative","unified","fromCodePoint","dataset","nativeToUnified","uncompressEmoji","emojiData","categories","emojiRaw","native","isoToEmoji","iso","codePointAt","keyToHandlerName","Enter","Backspace","Delete","Esc","Escape","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","handlers","onEnter","onDelete","onBackspace","onUp","onDown","onLeft","onRight","onTab","captureKeyboardListeners","hasActiveHandlers","handlerName","currentEventHandlers","releaseKeyboardListener","keyHandlers","hasActiveHandler","Loading","backgroundColor","preventMessageInputBlur","withBubbling","preventMessageInputBlurWithBubbling","processDeepLink","linkContext","parsedLink","openPrivateChannel","parseChooseParameter","startParam","originalParts","resolveBusinessChatLink","openPremiumModal","openGiftRecipientPicker","processBoostParameters","usernameOrId","openUniqueGiftBySlug","openGiftAuctionBySlug","EditProfile","Language","ActiveSessions","Privacy","Folders","General","openStarsBalanceModal","checkChatInvite","openChatByPhoneNumber","openStickerSet","joinVoiceChatByLink","openInvoice","openChatWithDraft","checkChatlistInvite","openStoryViewerByUsername","checkGiftCode","voicechat","livestream","inviteHash","invite","urlParam","formatShareText","balance","purpose","balanceNeeded","topup","sharedWorker","synced","lastSharedState","initSharedState","localState","SharedWorker","onMessage","sendToWorker","onGlobalChange","deepDiff","updateSharedState","scheduledEvents","sendOnTickEnd","selectPaymentInputInvoice","inputInvoice","selectStarsPayment","selectPaymentRequestId","selectProviderPublishableKey","form","nativeParams","publishableKey","selectProviderPublicToken","publicToken","selectStripeCredentials","stripeCredentials","selectSmartGlocalCredentials","smartGlocalCredentials","selectCanUseGiftProfileAdminFilter","selectCanUseGiftProfileFilter","selectGiftProfileFilter","selectActiveGiftsCollectionId","_Channel_onmessage","_Channel_nextMessageIndex","_Channel_pendingMessages","_Channel_messageEndIndex","_Resource_rid","SERIALIZE_TO_IPC_FN","transformCallback","__TAURI_INTERNALS__","Channel","rawMessage","cleanupCallback","unregisterCallback","PluginListener","plugin","unregister","invoke","addPluginListener","checkPermissions","requestPermissions","cmd","convertFileSrc","filePath","Resource","rid","isTauri","INERTIA_EASING","swipeOffsets","cancelCurrentReleaseAnimation","isSwipeActive","captureControlledSwipe","onSwipeLeftStart","onSwipeRightStart","onCancel","currentSlide","nextSlide","onCancelForTransition","targetPosition","getAnimations","KeyframeEffect","keyframe","getKeyframes","extractPositionFromTransform","extractAnimationEndPosition","currentDirection","animationTimingFunction","initialPositionPx","distance","dragOffset","newProgress","updateAnimationProgress","onCancelForClient","isRevertSwipe","releaseProgress","elements","getTiming","transformRule","userOrChat","closeStoryViewer","setShouldCloseRightColumn","selectIsMediaNsfw","chatActiveRestrictions","messageActiveRestrictions","singleEmoji","getMessageSingleRegularEmoji","animatedCustomEmojiId","getMessageSingleCustomEmoji","getMessageSticker","getWebPageAudio","thumbnail","getMessageInvoice","selectMessageMediaThumbnail","selectMessageMediaDuration","selectTimestampableMedia","selectMessageTimestampableDuration","noReplies","timestampableMedia","replyTimestampableMedia","selectMessageLastPlaybackTimestamp","setIsLoading","setError","setResult","wasCancelled","MIN_TIMEOUT_DURATION","TypingWrapper","getCurrentTextLength","setCurrentTextLength","intervalRef","msPerSymbol","timeoutDuration","nextSymbolBatchLength","isForAnimation","focusedQuoteOffset","canBeEmpty","shouldAnimateTyping","textCacheBusterRef","adaptedFormattedText","stripCustomEmoji","entitiesWithFocusedQuote","offsetIndex","lendth","withSharedCanvas","hasSpoilers","textToRender","getSearchResultKey","parseSearchResultKey","maxLinesBeforeCollapse","cutoutRef","isFirstRenderRef","cutoutHeightRef","fullHeightRef","setIsCollapsible","shouldUseStyleInExpand","maxHeight","recalculateTextLines","totalLines","calcTextLineHeightAndCount","scrollHeight","debouncedRecalcTextLines","windowWidth","checkSessionLocked","slotData","legacyAuthJson","userAuth","dcID","newSlotData","storeLegacySession","loadStoredLegacySession","LOG_BACKGROUND","LOG_SUFFIX","CONNECTING","CONNECTED","DISCONNECTED","STATE","REQUEST","RESPONSE","UPDATE","WARN","suffix","SAMPLE_RATE","oggToWav","opusData","Response","typedArray","decoderWorker","wavWorker","wavBitDepth","wavSampleRate","decoderSampleRate","outputBufferSampleRate","pages","asCacheApiType","Type","Text","DownloadUrl","Progressive","memoryCache","fetchPromises","progressCallbacks","cancellableCallbacks","mediaFormat","isHtmlAllowed","onProgress","callbackUniqueId","IS_PROGRESSIVE_SUPPORTED","getProgressiveUrl","getDownloadUrl","fetchFromCacheOrRemote","activeCallbacks","getFromMemory","cancelProgress","parentCallback","retryNumber","cacheName","IS_OPUS_SUPPORTED","prepareMedia","makeOnProgress","remote","getRetryTimeout","debug","dataBlob","fetchBlob","downloadWithRetry","fullSize","INPUT_CUSTOM_EMOJI_SELECTOR","buildCustomEmojiHtml","isPlaceholder","uniqueId","getInputCustomEmojiParams","shouldUseTextColor","rawText","getCustomEmojiSize","maxEmojisInLine","langProvider","resolveGlobalPromise","isFirstGlobalResolved","lastBroadcastDiffGlobal","isBroadcastDiffScheduled","subscribeToMultitabBroadcastChannel","argsWithCallback","refreshLangPackFromCache","requestGlobal","resolveWithoutGlobal","extractCurrentThemeParams","getPropertyHexColor","secondaryTextColor","bgColor","textColor","buttonColor","buttonTextColor","linkColor","hintColor","secondaryBgColor","sectionSeparatorColor","bg_color","text_color","hint_color","link_color","button_color","button_text_color","secondary_bg_color","header_bg_color","accent_text_color","section_bg_color","section_header_text_color","subtitle_text_color","destructive_text_color","section_separator_color","validateHexColor","property","getPropertyValue","prepareHexColor","SUBSTITUTION_REGEX","PLURAL_OPTIONS","PLURAL_RULES","en","ar","be","n10","n100","ca","v0","de","es","fa","fi","fr","it","hr","i10","i100","f10","f100","hu","ko","nb","nl","pl","ru","sk","sr","tr","uk","uz","currentLangCode","currentTimeFormat","createLangFn","cacheValue","importFallbackLangPack","langString","preferredPluralOption","optionIndex","getPluralOption","template","otherValue","translationSlices","initialValue","processTemplate","withFallback","Json","sourceLangPacks","fetchRemote","langInfo","langName","INPUT_WAITING_CUSTOM_EMOJI_IDS","renderCallbacks","loaded","processMessageInputForCustomEmoji","checkInputCustomEmojiLoad","callInputRenderHandlers","getCustomEmojiMediaDataForInput","isPreview","mediaHash","getStickerHashById","fetchAndProcess","placeholderSrc","shouldUseStaticFallback","blankSrc","buildMessageKey","getMessageServerKey","parseMessageKey","getIsInBackgroundLocal","setIsInBackground","getIsInBackground","onFocus","lastOnBlur","lastOnFocus","DEBUG_LEVELS","ORIGINAL_FUNCTIONS","DEBUG_LOGS","getDebugLogs","FILTERED_ATTRIBUTES","HTML_ATTRIBUTES","CONTROLLABLE_TAGS","MAPPED_ATTRIBUTES","autoCapitalize","autoCorrect","INDEX_KEY_PREFIX","SELECTION_STATE_ATTRIBUTE","headsByElement","extraClasses","extraStyles","uniqueChildKeysCache","renderWithVirtual","parentEl","$current","$new","$parent","currentContext","skipComponentUpdate","nextSibling","isCurrentComponent","VirtualType","isNewComponent","$newAsReal","isCurrentFragment","isNewFragment","Tag","hasElementChanged","componentInstance","renderComponent","updateComponent","mountState","MountState","Mounted","setupComponentUpdateListener","newTarget","initComponent","mountChildren","createNode","insertBefore","setElementRef","remount","getNextSibling","renderChildren","forceMoveToEnd","$currentAsReal","$newAsTag","processControlled","currentEntries","newEntries","currentValue","updateAttributes","$element","Unmounted","mountComponent","fragmentEl","placeholderTarget","createComment","$child","$renderedChild","Empty","createTextNode","defaultChecked","processUncontrolledOnMount","componentNextSibling","isComponent","isFragment","unmountComponent","unmountChildren","replaceChild","unmountRealTree","currentEl","currentChildren","newChildren","currentKeysByIndex","getChildKeysByIndex","newKeysByIndex","newKeys","$newChild","currentRemainingIndex","remainingByKey","$currentChild","orderKey","fragmentIndex","fragmentSize","currentPreservedIndex","currentChildInfo","renderFragment","newOrderKey","shouldMoveNode","isMovingDown","renderFastListChildren","currentFragment","newFragment","siblingAfterFragment","currentChildrenLength","newChildrenLength","createDocumentFragment","lastCurrentChild","fragmentNextSibling","isValueControlled","isCheckedControlled","selectionStart","selectionEnd","isCaretAtEnd","setSelectionRange","selectionState","updateClassName","inputEl","selectionStateJson","updateStyle","__html","extra","extraArray","cssText","applyExtraStyles","standardStyles","uniqueKeysByIndex","seenKeys","DEBUG_duplicatedKeys","isParentElement","runImmediateEffects","captureImmediateEffects","$head","formatId","truncateText","toolName","toolParsers","userCount","new_title","mute_for","phone_number","invite_hash","invite_link","setting","FOREVER_BANNED_DATE","isChatMonoforum","isChatWithVerificationCodesBot","getChatTypeString","getChatLink","activeUsername","getMainUsername","owner","getCanManageTopic","unrestrictedByBoosts","boostsToUnrestrict","boostsApplied","currentUserBannedRights","defaultBannedRights","isStoryReply","isInScheduledList","canAttachMedia","canAttachPolls","canAttachEmbedLinks","canAttachToDoLists","getMessageSendingRestrictionReason","untilDate","getForumComposerPlaceholder","isReplying","isChatArchived","getCanDeleteChat","getFolderDescriptionText","getOrderedTopics","pinnedOrder","shouldSortByLastMessage","pinned","ordered","hidden","isForAvatar","getGroupStatus","chatTypeString","getCustomPeerFromInvite","isFake","isScam","fakeType","getMockPreparedMessageFromResult","preparedMessage","replyMarkup","selectSummarizeState","summarize","selectIsSummarizeSetupComplete","isSetupComplete","selectBusiestChats","busiestChats","selectIsLoadingBusiestChats","isLoadingBusiestChats","selectSelectedChatIds","selectedChatIds","selectFilteredSummaries","summaries","chatTitle","contentText","paragraphs","selectIsLoadingSummaries","isLoadingSummaries","selectSummarizeSearchQuery","selectIncludeArchived","includeArchived","selectIsSummarizePageOpen","middleColumnView","selectSummarizeSelectedDate","selectedDate","noLoad","useSelector","selectIsSynced","spentTime","ARE_WEBCODECS_SUPPORTED","IS_ELECTRON","electron","selector","selectorSignal","useSelectorSignal","backgroundImage","pill","fluid","isText","isShiny","withSparkleEffect","noSparkleAnimation","ariaControls","hasPopup","allowDisabledClick","noFastClick","ripple","faded","isRectangular","noPreventDefault","shouldStopPropagation","noForcedUpperCase","iconAlignment","onMouseUp","isClicked","setIsClicked","isNotInteractive","Sparkles","preset","noAnimation","renderContent","selectPremiumLimit","AgentMessageSender","selectAlphaHumanThreadId","activeThreadId","selectIsAlphaHumanThreadOpen","selectAlphahumanThreadsCache","threadMessages","formattedMessages","USER","createdAt","PATTERN_PLACEHOLDER","DEFAULT_PATTERN","getCountryCodeByIso","phoneCodeList","country","iso2","getCountryFromPhoneNumber","bestMatches","countryCode","prefixes","formatPhoneNumber","pattern","numberWithoutCode","patterns","defaultPattern","stripped","getBestPattern","formatPhoneNumberWithCode","numberWithPlus","isPriority","onReady","onBroken","onTimeUpdate","restProps","handlePlaying","handlePlayingForAutoPause","playerRef","canPlayRef","shouldPauseRef","isLoadingPlayRef","usePlayPause","unfreezePlaying","unfreezePlayingOnRaf","useVideoAutoPause","isReadyRef","handleReady","isBuffered","bufferingHandlers","useBuffering","onPlaying","handlePlayingForBuffering","otherBufferingHandlers","prevIsBuffered","mergedOtherBufferingHandlers","mergedHandlers","keyString","useVideoCleanup","useLayoutEffectWithPrevDeps","prevDepsRef","parsedInitialLocationHash","messageHash","isAlreadyParsed","createLocationHash","displayType","parseLocationHash","isSummarize","isAlphaHumanThread","isType","createMessageHashUrl","locationHash","getInitialLocationHash","parsedHash","isNotionOAuthCallback","parseNotionOAuthCallback","isGoogleOAuthCallback","parseGoogleOAuthCallback","pendingMeasureTasks","pendingMutationTasks","pendingForceReflowTasks","runUpdatePassOnRaf","currentMeasureTasks","setPhase","currentMutationTasks","pendingForceReflowMutationTasks","mutationTask","throttledFn","requestNextMutation","lens","getLens","validLen","placeHoldersLen","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","maxChunkLength","len2","encodeChunk","tripletToBase64","scheduledAnimationsCounter","resetCounterOnTickEnd","AnimatedCounter","prevText","shouldAnimate","characters","textLength","prevTextLength","charIndex","prevTextCharIndex","renderAnimatedCharacters","hasActiveTransition","useViewTransition","parameters","transitionState","setTransitionState","domUpdateCallback","types","onHeavyAnimationEnd","startViewTransition","getTypes","finished","cleanUp","isReady","skipTransition","minimumAnimationLevel","IS_VIEW_TRANSITION_SUPPORTED","replaceMiddleSearch","chatThreadKey","updateMiddleSearch","currentSearch","updated","isHashtag","savedTag","resetMiddleSearch","replaceMiddleSearchResults","fetchingQuery","updateMiddleSearchResults","prevQuery","prevFoundIds","foundIds","newFoundIds","nextOffsetRate","closeMiddleSearch","replaceSharedMediaSearch","updateSharedMediaSearchType","currentType","updateSharedMediaSearchResults","resultsByType","replaceSharedMediaSearchResults","mergeWithChatMediaSearchSegment","loadingState","segment","mergedFoundIds","mergedLoadingState","areAllItemsLoadedForwards","areAllItemsLoadedBackwards","updateChatMediaSearchResults","currentSegment","segments","areSortedArraysIntersecting","mergeChatMediaSearchSegments","replaceChatMediaSearch","replaceChatMediaSearchResults","removeIdFromSegment","foundId","removeIdFromSearchResults","selectChatMediaSearch","updatedSearchParams","removeIdsFromChatMediaSearchParams","updateChatMediaLoadingState","newMessage","isMediaLoadableInViewer","resetForwardsLoadingStateInParams","initializeChatMediaSearchResults","setChatMediaSearchLoading","updateStickerSearch","resultIds","updateStickerSets","updatedSets","regularSetIds","updateCustomEmojiSets","addedSetIds","updateStickerSet","stickerSetId","currentStickerSet","isCustomEmoji","installedDate","customEmojiById","updateGifSearch","isNew","nextOffset","currentResults","newResults","replaceAnimatedEmojis","updateStickersForEmoji","remoteStickers","allStickers","uniqueIds","updateCustomEmojiForEmoji","localStickers","updateRecentStatusCustomEmojis","rebuildStickersForEmoji","replaceUsers","updateContactList","updatedUsers","contactUserIds","contactUserIdsFromUpdate","userUpdate","updatedUser","getUpdatedUser","updateUsers","addUsers","existingUser","newUser","updateUserSearch","searchStatePartial","updateUserSearchFetchingStatus","fetchingStatus","updateUserBlockedState","replaceUserStatuses","updateUserCommonChats","commonChats","addUserStatuses","closeNewContactDialog","newContact","updateMissingInvitedUsers","missingUsers","inviteViaLinkModal","updateBotAppPermissions","permissions","replacePeerSavedGifts","keyCounts","activeCollectionId","updatePeerStarGiftCollections","collections","starGiftCollections","updateGlobalSearch","updateGlobalSearchContent","currentContent","updateGlobalSearchResults","newFoundMessages","searchFlood","newFoundMessagesById","foundIdsForType","newId","updateGlobalSearchFetchingStatus","publicPosts","foundOrPrevFoundIds","updateManagement","newSettings","replaceNotifyExceptions","addNotifyException","updateTwoFaSettings","clearPasscodeSettings","withTabState","updatePayment","updateStarsPayment","starPayment","updateShippingOptions","shippingOptions","setRequestInfoId","setPaymentStep","setStripeCardInfo","cardInfo","setSmartGlocalCardInfo","setConfirmPaymentUrl","confirmPaymentUrl","setReceipt","receipt","clearPayment","clearStarPayment","closeInvoice","isPaymentModalOpen","isExtendedMedia","updateStarsBalance","stars","appendStarsTransactions","transactions","isTon","newTypeObject","appendStarsSubscriptions","subscriptions","newObject","updateStarsSubscriptionLoading","openStarsTransactionModal","transaction","starsTransactionModal","openStarsTransactionFromReceipt","transactionId","totalAmount","updateStatistics","updateMessageStatistics","currentMessage","currentStory","updateStoryStatistics","updateStatisticsGraph","updateChannelMonetizationStatistics","monetization","updateVerifyMonetizationModal","monetizationVerificationModal","updatePeer","peerUpdate","updatePeerFullInfo","peerFullInfoUpdate","updatePeerPhotosIsLoading","profilePhotos","replacePeerPhotos","updatePeerPhotos","newPhotos","shouldInvalidateCache","currentPhotos","fallbackPhoto","personalPhoto","currentPhotoArray","at","uniqueByField","photoId","isFromActionMessage","isAvatar","nextAvatarPhoto","newProfilePhoto","addStories","newStoriesByPeerId","updatedByPeerId","newPeerStories","profileIds","lastUpdatedAt","updateOrderedStoriesPeerIds","addStoriesForPeer","newStories","addToArchive","albumId","archiveIds","idsByAlbumId","deletedIds","updatedOrderedIds","updatedArchiveIds","updatedProfileIds","expireDate","updatedIdsByAlbumId","newAlbumStoryIds","existingAlbumData","existingIds","updatePeerLastUpdatedAt","updatePeerStoriesFullyLoaded","updateLastReadStoryForPeer","updateLastViewedStoryForPeer","lastViewedId","lastViewedByPeerId","updatePeersWithStories","storiesByPeerId","maxStoryId","updateStoryViews","viewModal","newViews","updateStoryViewsLoading","removePeerStory","newProfileIds","lastStoryId","previousStoryId","newLastReadId","updateStoriesForPeer","updateSentStoryReaction","reactionsCount","chosenOrder","updateReactionCount","newReactionsCount","updatePeerStory","sentReaction","storyUpdate","updatePeerStoryViews","viewsUpdate","updatePeerProfileStory","updatePeerStoriesHidden","areHidden","updatePeerIds","newOrderedPeerIds","peerIdA","peerIdB","peerA","peerB","diffCurrentUser","compareFields","luaA","orderedA","lriA","hasUnreadA","luaB","orderedB","lriB","hasUnreadB","diffUnread","diffPremium","updateStealthMode","updateTopicsStore","updateListedTopicIds","topicIds","selectTopicsInfo","listedTopicIds","updateTopics","topicsCount","oldTopics","newTopics","topicsById","updateThread","firstMessageId","updateThreadInfo","updateTopic","updatedTopic","deleteTopic","replacePinnedTopicIds","pinnedTopicIds","orderedPinnedTopicIds","removeGiftInfoOriginalDetails","giftInfoModal","typeGift","savedGift","innerGift","updatedInnerGift","attributes","updatedGift","dropOriginalDetailsStars","getAuctionStateVersion","updateActiveGiftAuction","auctionState","currentAuction","activeGiftAuction","updateActiveGiftAuctionState","giftId","activeAuction","updateActiveGiftAuctionUserState","userState","DEFAULT_LAYOUT","updateLayout","layoutUpdate","currentLayout","setAgentColumnState","setAgentColumnWidth","setContentMode","setLayoutPinned","toggleAgentColumn","loadLayoutPreferences","savedAgentState","savedWidth","savedContentMode","savedPinned","initializeSummarizeState","updateSummarizeState","currentSummarize","setBusiestChats","setBusiestChatsLoading","selectChatsForSummarize","completeSummarizeSetup","resetSummarizeSetup","setSummarizeSelectedDate","setSummaries","setSummariesLoading","updateSummarizeSearchQuery","markSummaryAsRead","isRead","setIncludeArchived","filterPeersByQuery","selectorFn","localizedTitle","isFoundInLocalized","getPeerFullTitle","getPeerTypeKey","getPeerTitle","getUserFirstOrLastName","promisifyRequest","oncomplete","onsuccess","onabort","createStore","dbName","storeName","dbp","txMode","indexedDB","onupgradeneeded","createObjectStore","db","getDB","objectStore","defaultGetStoreFunc","defaultGetStore","eachCursor","store","openCursor","continue","IdbStore","customStore","put","setMany","getMany","delMany","getAll","getAllKeys","cursor","getEntries","getKeys","getValues","updater","TIMESTAMP_RE","addTimestampEntities","apiText","resultText","fullMatch","hourStr","minuteStr","secondStr","totalSeconds","overlaps","inserted","UnrecoverablePasscodeError","passcodeHash","setupPasscode","sha256","sessionEncrypted","aesEncrypt","globalEncrypted","decryptSessionByCurrentHash","aesDecrypt","decryptSession","plaintext","subtle","digest","asArray","hasEncryptedSession","pwHash","getRandomValues","alg","importKey","ptUint8","ctBuffer","ct","dataArray","plainBuffer","isInitialized","RGB_VARIABLES","themeColors","applyColorAnimationStep","propertyColors","roundedA","themeClassName","isDarkTheme","startAt","themeColorTag","uninjectCss","head","injectCss","EMPTY_RECT","applyStaticOptions","bubbleRef","bubbleStyle","containerEl","bubbleEl","transformOrigin","externalRef","shouldCloseFast","ariaLabelledBy","noCloseOnBackdrop","backdropExcludedSelector","noCompact","withPortal","positionOptions","options2","staticOptions","anchor","getRootElement","getMenuElement","getTriggerElement","getLayout","withMaxHeight","triggerEl","anchorX","anchorY","menuEl","rootEl","extraPaddingX","extraTopPadding","topShiftY","menuElMinWidth","shouldAvoidNegativePosition","isDense","marginTop","menuElWidth","menuElHeight","menuRect","rootRect","yWithTopShift","triggerRect","addedYForPortalPositioning","addedXForPortalPositioning","leftWithPossibleNegative","addedXForMenuPositioning","offsetX","offsetY","processDynamically","useMenuPosition","bubbleFullClassName","IS_BACKDROP_BLUR_SUPPORTED","noInitiallyBuffered","setIsBuffered","setIsReady","bufferedProgress","setBufferedProgress","bufferedRanges","setBufferedRanges","setIsBufferedDebounced","handleBuffering","isSafariPatchInProgress","buffered","ranges","getTimeRanges","bufferedLength","currentRanges","onPLay","onLoadedData","onLoadStart","checkBuffering","setAlphaHumanSocketState","setAlphaHumanLastAgentUpdate","setAlphaHumanSocketDisconnected","toggleThreadsSidebar","selectAlphahumanThreadById","ensureThreadsInitialized","addMessageToAlphahumanThread","currentState","targetThreadId","getTargetThreadId","currentThreadMessages","updatedMessages","updatedCount","addUserMessageToAlphahumanThread","extraMetadata","clearStreamingContent","setStreamingState","clearActiveTools","activeTools","videoRef","handlersRef","videoEl","handlers2","GENERAL_VARIABLES","LIGHT_VARIABLES","DARK_VARIABLES","setVariable","lightValueOrGeneral","darkValue","isUpdateScheduled","updateVariables","generalVariables","buildVariables","lightVariables","darkVariables","setPeerColor","mainLightColor","mainDarkColor","lightBgColor","lightBgActiveColor","darkBgColor","darkBgActiveColor","baseColor","caches","SUFFIX","isSupported","isCacheApiSupported","contentType","shouldRecreate","resolvedType","cacheData","Element","VisualViewport","Document","HTMLInputElement","MouseEvent","Range","nativeMethods","phase","isStrict","newPhase","enableStrict","LAYOUT_CAUSES","causes","nativeGetter","getOwnPropertyDescriptor","onMeasure","nativeMethod","MutationObserver","mutations","attributeName","forcedMutationAllowedFor","contentEditable","childList","subtree","characterData","disableStrict","forceMeasure","forceMutation","nodes","MEDIA_VIEWER_MEDIA_QUERY","fontSize","ROUND_VIDEO_DIMENSIONS_PX","AVATAR_FULL_DIMENSIONS","VIDEO_AVATAR_FULL_DIMENSIONS","LIKE_STICKER_ID","DEFAULT_MEDIA_DIMENSIONS","cachedMaxWidthOwn","cachedMaxWidth","cachedMaxWidthNoAvatar","getAvailableWidth","fromOwnMessage","isWebPageMedia","noAvatars","extraPaddingRem","availableWidthRem","getMaxMessageWidthRem","calculateDimensionsForMessageMedia","aspectRatio","availableWidth","availableHeight","getAvailableHeight","mediaWidth","calculateDimensions","getMediaViewerAvailableDimensions","withFooter","mql","windowHeight","occupiedHeightRem","calculateInlineImageDimensions","asForwarded","getPhotoInlineDimensions","calculateVideoDimensions","getVideoDimensions","calculateExtendedPreviewDimensions","preview","getPictogramDimensions","getDocumentThumbnailDimensions","smaller","getStickerDimensions","baseWidth","calculatedHeight","calculateMediaViewerDimensions","mediaHeight","calculatedWidth","TopicDefaultIcon","letterClassName","iconColor","iconSrc","getTopicDefaultIcon","hasMessageMedia","getMessageContact","getMessageTodo","getMessageAction","canEditMedia","otherMedia","getMessageRoundVideo","isDocumentPhoto","innerMediaType","isDocumentVideo","getMessageLocation","getMessageWebPage","getMessageDocumentPhoto","getWebPageDocument","getMessageDocumentVideo","getMediaThumbUri","getMessageIsSpoiler","invoiceMedia","isSpoiler","buildStaticMapHash","geo","long","lat","accuracyRadius","getPhotoMediaHash","hasMediaLocalBlobUrl","getProfilePhotoMediaHash","getVideoMediaHash","appendProgressiveQueryParameters","getVideoPreviewMediaHash","hasVideoPreview","getDocumentMediaHash","getDocumentHasPreview","getAudioMediaHash","getAudioHasCover","getVoiceMediaHash","webDocument","previewPhotoSizes","getMediaHash","getGamePreviewPhotoHash","getGamePreviewVideoHash","thumbnailSizes","getMediaFormat","hasInnerVideo","getMediaFileSize","IS_OPFS_SUPPORTED","getPhotoFullDimensions","getMediaTransferState","isLoadNeeded","isUploading","isTransferring","transferProgress","getMediaSearchType","getMessageContentIds","validator","matchLinkInMessageText","getMediaFilename","getIsDownloading","getMessageMediaHash","statefulMedia","messagePhoto","actionPhoto","getMessageActionPhoto","messageVideo","messageDocument","messageAudio","canReplaceMessageMedia","attachment","isPhotoOrVideo","fileType","getAttachmentMediaType","stickerId","containsCustomEmoji","userStatus","botActiveUsers","getServerTimeOffset","wasOnlineDate","withSelfOnline","getCanAddContact","sortUserIds","userStatusesById","priorityIds","Bundles","LOAD_PROMISES","MEMORY_CACHE","loadBundle","bundleName","Auth","Extra","Calls","Stars","bundle","loadModule","getModuleFromMemory","moduleName","addLoadListener","_serverTimeOffset","useModuleLoader","autoUpdate","module","patchSafariProgressiveAudio","audioEl","patchedForSafari","patchForSafariInProgress","preventPlayAfterPatch","getEmojiOnlyCountForMessage","updateCurrentMessageList","shouldReplaceLast","newMessageLists","previous","replaceChatMessages","updateMessageStore","threadUpdate","replaceTabThreadParam","replaceThreadParam","updateTabThread","addMessages","addedByChatId","messagesByChatId","addChatMessagesById","replaceMessages","updatedByChatId","updateChatMessage","messageUpdate","isMediaUnread","emojiOnlyCount","updatedMessage","updateScheduledMessage","updateScheduledMessages","updateQuickReplyMessage","updateQuickReplyMessages","deleteQuickReplyMessages","deleteChatMessages","orderHistoryIds","updatedThreads","mediaIdsToRemove","clearMessageTranslation","deletedForwardedPosts","isLinkedChannelPost","threadMessageIds","newMessageCount","excludeSortedArray","orderPinnedIds","nonLocalMessageCount","originChatId","cancelMessageMediaDownload","mediaId","newViewportIds","canDeleteCurrentThread","originalPost","deleteChatScheduledMessages","scheduledIds","newScheduledIds","updateListedIds","removeOutlyingList","updateOutlyingLists","mergeIdRanges","addViewportId","safeReplaceViewportIds","safeReplacePinnedIds","doNotUpdateLinked","newThreadInfo","linkedUpdate","updateThreadInfos","originChannelId","updateFocusedMessage","updateSponsoredMessage","deleteSponsoredMessage","enterMessageSelectMode","toggleMessageSelection","childMessageIds","withShift","oldSelectedMessages","newMessageIds","newSelectedMessageIds","prevIndex","exitMessageSelectMode","updateThreadUnreadFromForwardedMessage","originMessage","isDeleting","channelPostId","threadInfoOld","addActiveMediaDownload","metadata","mediaHashes","newActiveDownloads","updateUploadByMessageKey","messageKey","updateQuickReplies","quickRepliesUpdate","deleteQuickReply","quickReplyId","updateFullWebPage","webpage","updatedWebpage","replaceWebPage","updatePoll","pollUpdate","oldResults","updatedPoll","updatePollVote","recentVoterIds","totalVoters","newRecentVoterIds","newTotalVoters","targetOptionIndex","targetOption","updatedOption","votersCount","StickerView","thumbClassName","fullMediaHash","fullMediaClassName","isSmall","loopLimit","shouldLoop","shouldPreloadPreview","noVideoOnMobile","onVideoEnded","onAnimatedStickerLoop","isVideoBroken","markVideoBroken","isUnsupportedVideo","IS_ANDROID","isStatic","filterStyle","isIntersectingForLoading","shouldLoad","isIntersectingForPlaying","shouldPlay","hasIntersectedForPlayingRef","cachedPreview","isReadyToMountFullMedia","hasIntersected","getNoHeavyAnimation","setNoHeavyAnimation","$getIsHeavyAnimating","useMountAfterHeavyAnimation","shouldForcePreview","shouldLoadPreview","previewMediaData","withPreview","shouldSkipLoadingFullMedia","fullMediaData","shouldRenderFullMedia","isPlayerReady","markPlayerReady","isFullMediaReady","thumbData","isThumbOpaque","noCrossTransition","thumbRef","fullMediaRef","useCoordsInSharedCanvas","randomIdPrefix","isMediaReady","resolverOrDependency","isRegularLangString","isLangFnParam","object","KEYS_TO_IGNORE","counters","renderCountersThrottled","loggerEl","clearEl","setupOverlay","halfSecondAgo","maxRenders","maxDuration","lastUpdateAt","incrementOverlayCounter","DEBUG_SILENT_RENDERS_FOR","renderingInstance","lastComponentId","buildChildren","buildFragmentElement","buildComponentElement","createComponentInstance","buildTagElement","noEmpty","cleanChildren","isEmptyPlaceholder","dropEmptyTail","child","buildChildElement","DEBUG_components","TOTAL","DEBUG_memos","avgRenderTime","calls","hitRate","instancesPendingUpdate","idsToExcludeFromUpdate","pendingEffects","pendingCleanups","pendingLayoutEffects","pendingLayoutCleanups","areImmediateEffectsCaptured","instancesToUpdate","currentCleanups","currentEffects","prepareComponentForFrame","currentElement","forceUpdateComponent","runCapturedImmediateEffects","currentLayoutCleanups","currentLayoutEffects","newRenderedValue","hooks","memos","refs","componentName","renderedValue","$old","Mounting","byCursor","releaseSignals","hook","schedule","nextValue","setter","helpGc","initValue","useEffectBase","isLayout","effectConfig","cleanupsContainer","effectsContainer","effectId","runEffectCleanup","runEffect","scheduleEffect","causedBy","prevValue","cleanups","setupSignals","debugHitRateKey","DEBUG_state","instanceKey","misses","newCallback","signalRef","TeactMemoWrapper","afterHeavyAnimation","pendingCallRef","wrappedCallback","themeChangeCallback","systemThemeCache","getSystemTheme","setSystemThemeChangeCallback","WEBSYNC_URLS","WEBSYNC_VERSION","WEBSYNC_KEY","getTs","lastTimeout","authed","currentTs","canRedirect","script","removeElement","saveSync","startWebsync","stopWebsync","shouldSkipModal","openUrl","isRegularLink","isTrustedLink","classNames","setAlphahumanThreadsLoading","threadsLoading","setAlphahumanActiveThreadId","meLoading","setAlphahumanMeLoading","me","meError","setAlphahumanMe","setAlphahumanMeError","threadsCount","threadsError","setAlphahumanThreads","setAlphahumanThreadsError","threadMessagesLoading","setAlphahumanThreadMessagesLoading","threadMessagesError","setAlphahumanThreadMessages","setAlphahumanThreadMessagesError","highlightsLoading","daily","weekly","setAlphahumanHighlightsLoading","highlights","highlightsError","setAlphahumanHighlights","setAlphahumanHighlightsError","insertionQueue","keyToRemove","callbackfn","toStringTag","BUTTON_POSITIONS","durationShift","PROGRESS_POSITIONS","positions","velocityX","velocityY","generateRandomProgressPositions","presetSettings","shiftX","cos","atan2","shiftY","CLIPBOARD_ITEM_SUPPORTED","clipboard","ClipboardItem","textCopyEl","selection","getSelection","rangeToRestore","rangeCount","getRangeAt","execCommand","removeAllRanges","addRange","copyHtmlToClipboard","html","copyImageToClipboard","imageUrl","imageEl","copyBlobToClipboard","copyTextToClipboardFromPromise","getTextPromise","onFailure","copyTextToClipboardFallback","hasGetDataError","rejectGetDataError","clipboardTextItem","pngBlob","GIFT_EMOJI_SIZE","isReply","noBar","emojiIconClassName","peerColorClassName","hasGiftEmoji","uiLocalMessageCounter","getMessageHtmlId","getMessageOriginalId","transcriptionId","hasMessageText","getMessageStatefulContent","storyPeerId","getMessageText","getMessageCustomShape","hasOtherFormatting","firstEntity","getFirstLinkInMessage","firstTextUrl","firstUrl","isReplyToMessage","isAnonymousOwnMessage","sendingState","isGeoLiveExpired","period","allowOutgoing","isScheduled","getMessageSingleInlineButton","hasIntersection","newOutlyingLists","prevArray","authCode","oldEntities","ttlSeconds","shouldSendAsFile","isUploadingFileSticker","chatUsername","normalizedId","chatPart","topicPart","messagePart","splitMessagesForForwarding","currentArr","lastGroup","batch","getSuggestedChangesInfo","originalMessage","suggestedPostInfo","original","suggested","originalContent","suggestedContent","originalText","originalMediaContent","suggestedText","suggestedMediaContent","isNewText","isNewMedia","originalPrice","suggestedPrice","isNewPrice","isNewTime","scheduleDate","getSuggestedChangesActionText","senderLink","changesInfo","changesParts","changesText","changes","createApiMessageFromTypingDraft","localId","getNextLocalMessageId","editDate","updateValue","computedValue","removeProperty","handleTransitionEnd","useStyleObserver","elementName","modifiers","baseName","modifier","shouldNotLoop","loopCountRef","setShouldPlay","hasCustomColor","safePlay","handleStickerLoop","isHq","blankImg","blobToFile","lastModified","preloadVideo","onloadedmetadata","createPosterForVideo","onseeked","videoWidth","videoHeight","imgToCanvas","validateFiles","fixMovMime","fileBits","adler32_1","adler","s1","s2","makeTable","crc32_1","BAD$1","inffast","strm","_in","_out","beg","dmax","wsize","whave","wnext","s_window","hold","bits","lcode","dcode","lmask","dmask","here","dist","from_source","next_in","avail_in","next_out","avail_out","lencode","distcode","lenbits","distbits","dolen","sane","MAXBITS","lbase","Uint16Array","lext","dbase","dext","inftrees","lens_index","codes","table_index","work","incr","low","drop","used","huff","offs","here_bits","here_op","here_val","constants$1","Z_NO_FLUSH","Z_PARTIAL_FLUSH","Z_SYNC_FLUSH","Z_FULL_FLUSH","Z_FINISH","Z_BLOCK","Z_TREES","Z_OK","Z_STREAM_END","Z_NEED_DICT","Z_ERRNO","Z_STREAM_ERROR","Z_DATA_ERROR","Z_MEM_ERROR","Z_BUF_ERROR","Z_NO_COMPRESSION","Z_BEST_SPEED","Z_BEST_COMPRESSION","Z_DEFAULT_COMPRESSION","Z_FILTERED","Z_HUFFMAN_ONLY","Z_RLE","Z_FIXED","Z_DEFAULT_STRATEGY","Z_BINARY","Z_TEXT","Z_UNKNOWN","Z_DEFLATED","Z_FINISH$1","Z_OK$1","Z_STREAM_END$1","Z_NEED_DICT$1","Z_STREAM_ERROR$1","Z_DATA_ERROR$1","Z_MEM_ERROR$1","HEAD","DICT","TYPE","TYPEDO","COPY_","LEN_","LEN","CHECK","BAD","zswap32","InflateState","havedict","wbits","ncode","nlen","ndist","have","lendyn","distdyn","was","inflateStateCheck","inflateResetKeep","total_in","total_out","Int32Array","inflateReset","inflateReset2","windowBits","inflateInit2","lenfix","distfix","virgin","fixedtables","updatewindow","inflate_1$1","last_bits","last_op","last_val","hbuf","order","inf_leave","xflags","os","extra_len","hcrc","data_type","dictionary","dictLength","dictid","_has","sources","STR_APPLY_UIA_OK","__","_utf8len","m_pos","str_len","buf_len","utf16buf","c_len","buf2binstring","zstream","gzheader","Inflate","chunkSize","opt","raw","inflator","flush_mode","_flush_mode","last_avail_out","next_out_utf8","tail","utf8str","Inflate_1","inflate_2","inflateRaw_1","constants","inflate_1","inflateRaw","factory","collection","buildCollectionByCallback","mapValues","newByKey","stringKeys","stringKey","orderRule","compareValues","currentOrderRule","isAsc","aValue","bValue","mode1","mode2","orderRule1","orderRule2","isAsc1","isAsc2","isInsideSortedArrayRange","findIntersectionWithSet","toExclude","excludeIndex","partition","pass","fail","cloneDeep","RLottie","BLUE","GREEN","STROKE_WIDTH","STROKE_WIDTH_LARGE","LARGE_SIZE","EXTRA_GAP_ANGLE","EXTRA_GAP_SIZE","GAP_PERCENT_EXTRA","EXTRA_GAP_START","EXTRA_GAP_END","appTheme","isLarge","strokeWidth","adaptedSize","isCloseFriend","isForCloseFriends","drawGradientCircle","segmentsCount","colorStops","readSegmentsCount","readSegmentColor","strokeWidthPx","sizeModifier","strokeModifier","canvasSize","centerCoordinate","radius","segmentAngle","gapSize","GAP_PERCENT","createLinearGradient","addColorStop","colorStop","lineCap","startAngle","endAngle","strokeStyle","lineWidth","beginPath","arc","stroke","session","destroyConnection","onSomeTabSwitchedMultitabRole","subscribeAfterUserGesture","globalTheme","systemTheme","selectPerformanceSettings","IS_LINUX","canAnimate","shouldSkipHistoryAnimations","hasLocalId","newNotifications","existingNotificationIndex","LoadMoreDirection","FocusDirection","GlobalSearchContent","RightColumnContent","MediaViewerOrigin","StoryViewerOrigin","AudioOrigin","ChatCreationProgress","ProfileState","PaymentStep","ManagementScreens","TOPIC_MAPPING","blue","violet","green","rose","red","getTopicColors","grey","getTopicColorCssVariable","checkIfHasUnreadReactions","areReactionsEmpty","getReactionKey","isSameReaction","areCustomAllowed","allowed","sortReactions","reactionOne","reactionTwo","indexOne","indexTwo","getUserReactions","isReactionChosen","reactionCount","newReactions","existingIndex","addPaidReaction","isAnonymous","localIsPrivate","localPeerId","localPreviousChosenOrder","getStoryMediaHash","isAlt","altVideos","getStoryKey","allowedUserIds","allowedChatIds","blockedUserIds","blockedChatIds","allowedUsers","allowedChats","blockedUsers","blockedChats","getCurrentMaxAccountCount","premiumCount","account","currentMaxCount","getCurrentProdAccountCount","selectManagement","selectCurrentManagementType","selectCanManage","canAddContact","selectStatistics","selectIsMediaViewerOpen","isAvatarView","standaloneMedia","isSponsoredMessage","selectRightColumnContentKey","editTopicPanel","EditTopic","createTopicPanel","CreateTopic","PollResults","currentManagement","selectCurrentManagement","Management","isStatisticsShown","currentMessageId","MessageStatistics","StoryStatistics","currentChatId","canViewStatistics","selectIsStatisticsShown","Statistics","boostStatistics","BoostStatistics","monetizationStatistics","MonetizationStatistics","StickerSearch","GifSearch","AddingMembers","AgentChat","ThreadHistory","ChatInfo","selectIsRightColumnShown","selectThemeValues","themeKey","selectActionMessageBg","selectIsForumPanelOpen","selectIsForumPanelClosed","selectIsReactionPickerOpen","reactionPicker","selectPerformanceSettingsValue","selectCanAutoPlayMedia","canAutoPlayVideos","canAutoPlayGifs","asGif","selectShouldLoopStickers","selectCanAnimateRightColumn","selectCanAnimateSnapEffect","IS_SNAP_EFFECT_SUPPORTED","selectIsContextMenuTranslucent","selectWebApp","selectActiveWebApp","activeWebAppKey","selectPeerProfileColor","selectCurrentGlobalSearchQuery","getFileExtension","getColorFromExtension","textContainer","onResize","onResizeRef","ResizeObserver","useMultiaccountInfo","isUpdater","setAccountsInfo","avatarHash","avatarUrl","refresh","updateAvatar","abortSignal","resizedAvatar","aborted","dataUrl","toDataURL","useInterval","handleStorageChange","selectCurrentMiddleSearch","selectCurrentSharedMediaSearch","selectCurrentChatMediaSearch","setX","setY","recalculate","targetLeftOffset","targetTopOffset","canvasLeftOffset","canvasTopOffset","throttledRecalculate","EQUAL","DELETE","DELETE_ALL_CHILDREN","keys2","subValue1","subValue2","subDiff","updateMessageTranslation","translation","translatedMessages","chatTranslations","newByLangCode","newTranslatedMessages","updateMessageTranslations","updateRequestedChatTranslation","updateRequestedMessageTranslation","removeRequestedMessageTranslation","newManualMessages","maxTouchPoints","getPlatform","IS_MOBILE","userAgentData","brands","brand","IS_YA_BROWSER","IS_FIREFOX","Auxiliary","Secondary","Fourth","Fifth","IS_PWA","standalone","IS_APP","IS_VOICE_RECORDING_SUPPORTED","mediaDevices","AudioContext","webkitAudioContext","inlineEl","newEmojiWidth","legacyEmojiWidth","isLastEmojiVersionSupported","chromeVersion","hasBrokenServiceWorkerStreaming","canPlayType","IS_CANVAS_FILTER_SUPPORTED","IS_REQUEST_FULLSCREEN_SUPPORTED","ARE_CALLS_SUPPORTED","IS_WAVE_TRANSFORM_SUPPORTED","IS_FLUID_BACKGROUND_SUPPORTED","TEST_VIDEO","MASK_IMAGE_DISABLED","storage","getDirectory","directory","removeEntry","recursive","IS_OFFSET_PATH_SUPPORTED","CSS","supports","IS_INSTALL_PROMPT_SUPPORTED","IS_OPEN_IN_NEW_TAB_SUPPORTED","IS_TRANSLATION_DETECTOR_SUPPORTED","MESSAGE_LIST_SENSITIVE_AREA","IS_GEOLOCATION_SUPPORTED","getGeolocationStatus","permissionStatus","accessRequested","accessGranted","geolocation","getCurrentPosition","isPrimary","conjuctionWithNodes","langFn","placeholders","replaced","UNIQUE_PLACEHOLDER_PREFIX","UNSUPPORTED_LANG_KEY","isInsideTopic","openTelegramLink","renderStrong","isServiceNotificationsChat","senderTitle","userFallbackText","chatFallbackText","channelFallbackText","chatLink","textLink","mediaValue","score","gameTitle","gameLink","isViaRequest","inviterId","inviter","inviterLink","channelLink","originalChatId","originalChatLink","iconEmojiId","topicLinkContent","currentTopic","topicPlaceholderLink","boosts","userTitle","userLink","userLinks","app","isAttachMenu","isFromRequest","senderUsername","appLink","winnersCount","isStars","unclaimedCount","cryptoAmount","cryptoCurrency","cryptoPrice","cost","durationText","isRecurringInit","isRecurringUsed","invoiceTitle","peerTitle","alreadyPaidUpgradeStars","savedId","isPrepaidUpgrade","isAuctionAcquired","isToChannel","fromPeer","fromTitle","fromLink","toPeer","toTitle","toLink","starsAmount","upgradeStars","upgradeCost","channelPeer","channelTitle","isTransferred","isUpgrade","resaleAmount","transferStars","amountText","actionPeer","actionPeerLink","isAllowedInChannel","payerInitiated","postSender","postSenderTitle","postSenderLink","isRejected","isBalanceTooLow","rejectComment","replyMessageSender","replyPeerTitle","currencyName","publishDate","isPostPublished","completedIds","incompletedIds","completedItem","incompletedItem","todoItems","incompletedTaskTitle","incompletedTaskLink","completedTaskTitle","completedTaskLink","completedText","completedLink","incompletedText","incompletedLink","listTitle","listLink","taskTitle","taskLink","tasksText","tasksLink","tasks","renderActionText","bySelector","getter","clientsCount","state2","replaceWithTeact","searchValue","replaceValue","firstElement","READABLE_ERROR_MESSAGES","CHAT_RESTRICTED","CHAT_SEND_POLL_FORBIDDEN","CHAT_SEND_STICKERS_FORBIDDEN","CHAT_SEND_GIFS_FORBIDDEN","CHAT_SEND_MEDIA_FORBIDDEN","CHAT_LINK_EXISTS","SLOWMODE_WAIT_X","USER_BANNED_IN_CHANNEL","USER_IS_BLOCKED","YOU_BLOCKED_USER","IMAGE_PROCESS_FAILED","MEDIA_EMPTY","MEDIA_GROUPED_INVALID","MEDIA_NEW_INVALID","MESSAGE_NOT_MODIFIED","MEDIA_INVALID","PASSWORD_HASH_INVALID","PHOTO_EXT_INVALID","PHOTO_INVALID_DIMENSIONS","PHOTO_SAVE_FILE_INVALID","MESSAGE_DELETE_FORBIDDEN","MESSAGE_POLL_CLOSED","MESSAGE_EDIT_TIME_EXPIRED","PINNED_DIALOGS_TOO_MUCH","CHANNEL_PRIVATE","MEDIA_CAPTION_TOO_LONG","ADDRESS_STREET_LINE1_INVALID","ADDRESS_STREET_LINE2_INVALID","ADDRESS_CITY_INVALID","ADDRESS_COUNTRY_INVALID","ADDRESS_POSTCODE_INVALID","ADDRESS_STATE_INVALID","REQ_INFO_NAME_INVALID","REQ_INFO_PHONE_INVALID","REQ_INFO_EMAIL_INVALID","LINK_NOT_MODIFIED","MESSAGE_TOO_LONG","SERVICE_WORKER_DISABLED","MESSAGE_TOO_LONG_PLEASE_REMOVE_CHARACTERS","FRESH_RESET_AUTHORISATION_FORBIDDEN","BOTS_TOO_MUCH","BOT_GROUPS_BLOCKED","USERS_TOO_MUCH","USER_CHANNELS_TOO_MUCH","USER_KICKED","USER_NOT_MUTUAL_CONTACT","USER_PRIVACY_RESTRICTED","INVITE_HASH_EMPTY","INVITE_HASH_EXPIRED","INVITE_HASH_INVALID","CHANNELS_TOO_MUCH","USER_ALREADY_PARTICIPANT","SCHEDULE_DATE_INVALID","WALLPAPER_DIMENSIONS_INVALID","ADMINS_TOO_MUCH","ADMIN_RANK_EMOJI_NOT_ALLOWED","ADMIN_RANK_INVALID","FRESH_CHANGE_ADMINS_FORBIDDEN","INPUT_USER_DEACTIVATED","BOT_PRECHECKOUT_TIMEOUT","PROVIDER_ACCOUNT_TIMEOUT","STARGIFT_CONVERT_TOO_OLD","SUBSCRIPTION_ALREADY_ACTIVE","PEERS_LIST_EMPTY","PAID_MEDIA_FORBIDDEN","USER_DISALLOWED_STARGIFTS","CHAT_WRITE_FORBIDDEN","CHAT_ADMIN_REQUIRED","SHIPPING_ERRORS","FINAL_PAYMENT_ERRORS","getReadableErrorText","isSlowMode","textParams","extraPartIndex","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getPrototypeOf","__esModule","ns","def","getOwnPropertyNames","definition","chunkId","promises","miniCssF","needAttach","scripts","getElementsByTagName","getAttribute","charset","nc","onScriptComplete","doneFns","scriptUrl","importScripts","currentScript","installedCssChunks","miniCss","fullhref","existingLinkTags","dataHref","existingStyleTags","findStylesheet","oldTag","linkTag","errorType","realHref","createStylesheet","loadStylesheet","baseURI","installedChunks","installedChunkData","realSrc","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","handleWorkerMessage","scriptURL","ourRegistrations","getRegistrations","register","getRegistration","hasErrorKey","intervals","checkStoryExpiration","serverTime","previousGlobal","isCurrentMaster","isPreviousMaster","initGlobal","storedSharedState","initialTabState","isPlaybackRateActive","isLastPlaybackRateActive","fixedThreadsById","parsedLocationHash","actionPayload","isImproved","testAndImprove","frames","lastFrameAt","mean","boosterEl","improveView","isSetup","openLink","urlObject","openNewWindow","shellPlugin","AuthCodeAsync","AuthCode","AuthPasswordAsync","AuthPassword","SITE_FONTS","preloadFonts","font","fonts","navigateBack","currentUrl","getSuggestedLanguage","suggestedLanguage","useLangString","fetchLangString","MENU_HIDING_DURATION","getFilteredList","defaultName","CountryCodeInput","inputRef","setFilter","filteredList","setFilteredList","updateFilter","filterValue","prevPhoneCodeList","handleInput","handleInputKeyDown","CodeInput","handleTrigger","formEl","getElementById","scrollTo","behavior","inputValue","MenuItem","isPreloadInitiated","AuthPhoneNumber","setAuthPhoneNumber","setAuthRememberMe","loadNearestCountry","loadCountryList","clearAuthErrorKey","goToAuthQrCode","loginWithPasskey","authPhoneNumber","authIsLoading","continueText","setCountry","setPhoneNumber","isTouched","setIsTouched","lastSelection","setLastSelection","markIsLoading","unmarkIsLoading","hasActiveAccount","phoneNumberSlots","fullNumber","canSubmit","parseFullNumber","newFullNumber","suggestedCountry","selectedCountry","handleLangChange","isJustPastedRef","handlePaste","handleBackNavigation","handleCountryChange","handlePhoneNumberChange","monkeyPath","shouldFixSafariAutoComplete","handleKeepSessionChange","handleGoToAuthQrCode","handleLoginWithPasskey","isAuthReady","onSubmit","adaptedPhoneNumber","qrCodeStylingPromise","returnToAuthPhoneNumber","authQrCode","qrCodeRef","isQrMounted","markQrMounted","unmarkQrMounted","QrCodeStyling","blankUrl","dotsOptions","cornersSquareOptions","imageOptions","imageSize","qrOptions","errorCorrectionLevel","handleReturnToAuthPhoneNumber","AnimatedIcon","AuthRegisterAsync","AuthRegister","handleChangeAuthorizationMethod","renderingAuthState","Transition","getActiveKey","AuthQrCode","getScreen","RoundTimer","timeLeft","setTimeLeft","cx","cy","pathLength","circle","DEFAULT_DURATION","CUSTOM_EMOJI_SIZE","actionText","cacheBreaker","disableClickDismiss","dismissAction","shouldUseCustomIcon","customEmojiIconId","shouldShowTimer","timerRef","handleDismiss","dismissNotification","closeAndDismiss","handleActionClick","handleMouseEnter","handleMouseLeave","renderedTitle","renderedMessage","renderedActionText","renderedIcon","Notifications","preloadAvatars","preloadTasks","main","spoilerMaskPath","telegramLogoPath","authPassword","lock","lockPreviewPath","inactive","isRightColumnShown","leftColumnWidth","isFoldersSidebarShown","UiLoader","setIsUiReady","markReady","shouldRenderMask","safePreload","appStyles","AppInactive","handleReload","appInactivePath","LockScreen","Welcome","handleGetStarted","OAUTH_COMPONENTS","notion","NotionOAuthCallback","completeNotionOAuthSuccess","completeNotionOAuthError","countdown","setCountdown","callbackResult","setCallbackResult","handleGoHome","callbackData","countdownInterval","google","GoogleOAuthCallback","completeGoogleOAuthSuccess","completeGoogleOAuthError","AppScreens","TRANSITION_RENDER_COUNT","ACTIVE_PAGE_TITLE","INACTIVE_PAGE_TITLE","actionMessageBg","App","isMobileOs","checkMultiaccPasscode","handleDrag","dataTransfer","dropzone","dropEffect","handleDrop","hasCompletedWelcome","setHasCompletedWelcome","oauthCheckers","provider","checker","oauthProvider","oauthCallback","welcome","useTauriDrag","tauriWindow","getCurrentWindow","startDragging","OAuthComponent","corePromise","markTitleBarOverlay","isOverlay","relaunch","checkUpdate","setWindowTitle","initTauriApi","listen","isContentEditable","features","setupTauriListeners","isCompatTestPassed","listenOtherClients","switchMultitabRole","manifest","updateWebmanifest","lastFocusAt","setupInterval","betterView","isPageUnload"],"ignoreList":[],"sourceRoot":""}